import{e as pe}from"../chunks/index.B4BoCjpO.js";import{a as ge,g as Ce}from"../chunks/sign.DjOL18JW.js";import{A as be,e as j}from"../chunks/store.C807Sv48.js";import{s as xe,w as we,e as g,a as S,c as C,b,f as m,g as A,z as ee,v as n,i as N,h as d,Q as R,A as W,x as ye,F as $e,t as ve,d as Be,C as me,j as De,n as de,q as te,r as se}from"../chunks/scheduler.CIbz-4tf.js";import{S as Ee,i as Ie,b as Se,c as ae,d as re,m as ne,a as z,e as Ae,t as V,f as le,g as Ne}from"../chunks/index.gvaMc9LH.js";import{g as Oe}from"../chunks/entry.BlipmNmQ.js";import{H as Pe}from"../chunks/Header.D0Ely6jv.js";import{g as Te,u as qe}from"../chunks/photo.Cjp1ulaP.js";import{C as Fe}from"../chunks/CircleImage.CZpdYjea.js";import{s as he}from"../chunks/s32cloudfront.iC-vMcWe.js";import{g as _e}from"../chunks/color.C_Jm4JAr.js";import{A as Ue}from"../chunks/ActionSheetOpenApp.Hax2RVvs.js";const je=async({params:l,fetch:e,depends:t})=>{if(String(l.idx)!==String(ge()))throw pe(403,"Forbidden");const c=(await(await e(`${be}/auth/users/${l.idx}`,{headers:{Authorization:`Bearer ${Ce()}`}})).json()).data;if(!(c!=null&&c.idx))throw pe(404,"User not found");return{user:c}},nt=Object.freeze(Object.defineProperty({__proto__:null,load:je},Symbol.toStringTag,{value:"Module"}));function ze(l){let e;return{c(){e=ve("완료")},l(t){e=Be(t,"완료")},m(t,s){N(t,e,s)},d(t){t&&m(e)}}}function Ve(l){let e,t,s;return{c(){e=te("svg"),t=te("circle"),s=te("path"),this.h()},l(r){e=se(r,"svg",{class:!0,viewBox:!0});var c=b(e);t=se(c,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),b(t).forEach(m),s=se(c,"path",{class:!0,fill:!0,d:!0}),b(s).forEach(m),c.forEach(m),this.h()},h(){n(t,"class","opacity-25"),n(t,"cx","12"),n(t,"cy","12"),n(t,"r","10"),n(t,"stroke","currentColor"),n(t,"stroke-width","4"),n(t,"fill","none"),n(s,"class","opacity-75"),n(s,"fill","currentColor"),n(s,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),n(e,"class","animate-spin h-5 w-5 mr-3 text-white"),n(e,"viewBox","0 0 24 24")},m(r,c){N(r,e,c),d(e,t),d(e,s)},d(r){r&&m(e)}}}function He(l){let e,t,s,r,c;function f(o,p){return o[3]?Ve:ze}let u=f(l),i=u(l);return{c(){e=g("span"),t=g("button"),i.c(),this.h()},l(o){e=C(o,"SPAN",{slot:!0,class:!0});var p=b(e);t=C(p,"BUTTON",{});var y=b(t);i.l(y),y.forEach(m),p.forEach(m),this.h()},h(){t.disabled=l[3],n(e,"slot","right"),n(e,"class",s=`
        text-sm leading-[1.0625rem] font-medium 
        ${l[5]?"text-white":"text-[#3f3f3f]"}
      `)},m(o,p){N(o,e,p),d(e,t),i.m(t,null),r||(c=W(t,"click",l[6]),r=!0)},p(o,p){u!==(u=f(o))&&(i.d(1),i=u(o),i&&(i.c(),i.m(t,null))),p&8&&(t.disabled=o[3]),p&32&&s!==(s=`
        text-sm leading-[1.0625rem] font-medium 
        ${o[5]?"text-white":"text-[#3f3f3f]"}
      `)&&n(e,"class",s)},d(o){o&&m(e),i.d(),r=!1,c()}}}function Me(l){var c;let e,t,s=(((c=l[0])==null?void 0:c.at(0))??"")+"",r;return{c(){e=g("div"),t=g("span"),r=ve(s),this.h()},l(f){e=C(f,"DIV",{class:!0,style:!0});var u=b(e);t=C(u,"SPAN",{class:!0});var i=b(t);r=Be(i,s),i.forEach(m),u.forEach(m),this.h()},h(){n(t,"class","text-2xl font-semibold text-black"),n(e,"class","w-[76px] h-[76px] flex items-center justify-center rounded-full"),me(e,"background-color",_e(l[0]))},m(f,u){N(f,e,u),d(e,t),d(t,r)},p(f,u){var i;u&1&&s!==(s=(((i=f[0])==null?void 0:i.at(0))??"")+"")&&De(r,s),u&1&&me(e,"background-color",_e(f[0]))},i:de,o:de,d(f){f&&m(e)}}}function Je(l){let e,t;return e=new Fe({props:{src:he(l[1],500),width:"76px",strokeWidth:"0"}}),{c(){ae(e.$$.fragment)},l(s){re(e.$$.fragment,s)},m(s,r){ne(e,s,r),t=!0},p(s,r){const c={};r&2&&(c.src=he(s[1],500)),e.$set(c)},i(s){t||(V(e.$$.fragment,s),t=!0)},o(s){z(e.$$.fragment,s),t=!1},d(s){le(e,s)}}}function Le(l){let e,t,s,r,c,f,u,i,o,p,y,B,H='<svg class="w-3 h-2.5" fill="transparent" stroke="white" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',U,k,x,h,D="이메일(변경 불가)",q,v,K,E,O,ie="닉네임",X,w,M,$,Y,J,Z,oe;r=new Pe({props:{position:"static",leftBack:"white",centerTitle:"프로필 편집",$$slots:{right:[He]},$$scope:{ctx:l}}});const ue=[Je,Me],I=[];function ce(a,_){return a[1]?0:1}o=ce(l),p=I[o]=ue[o](l);function ke(a){l[11](a)}let fe={};return l[4]!==void 0&&(fe.isOpen=l[4]),$=new Ue({props:fe}),we.push(()=>Se($,"isOpen",ke)),{c(){e=g("div"),t=S(),s=g("div"),ae(r.$$.fragment),c=S(),f=g("main"),u=g("div"),i=g("div"),p.c(),y=S(),B=g("button"),B.innerHTML=H,U=S(),k=g("div"),x=g("div"),h=g("span"),h.textContent=D,q=S(),v=g("input"),K=S(),E=g("div"),O=g("span"),O.textContent=ie,X=S(),w=g("input"),M=S(),ae($.$$.fragment),this.h()},l(a){e=C(a,"DIV",{class:!0}),b(e).forEach(m),t=A(a),s=C(a,"DIV",{class:!0});var _=b(s);re(r.$$.fragment,_),c=A(_),f=C(_,"MAIN",{class:!0});var P=b(f);u=C(P,"DIV",{class:!0});var F=b(u);i=C(F,"DIV",{class:!0});var T=b(i);p.l(T),y=A(T),B=C(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(B)!=="svelte-qa1vtb"&&(B.innerHTML=H),T.forEach(m),F.forEach(m),U=A(P),k=C(P,"DIV",{class:!0});var L=b(k);x=C(L,"DIV",{class:!0});var G=b(x);h=C(G,"SPAN",{class:!0,"data-svelte-h":!0}),ee(h)!=="svelte-1gfnk3z"&&(h.textContent=D),q=A(G),v=C(G,"INPUT",{type:!0,class:!0}),G.forEach(m),K=A(L),E=C(L,"DIV",{class:!0});var Q=b(E);O=C(Q,"SPAN",{class:!0,"data-svelte-h":!0}),ee(O)!=="svelte-2npwwy"&&(O.textContent=ie),X=A(Q),w=C(Q,"INPUT",{type:!0,class:!0,placeholder:!0}),Q.forEach(m),L.forEach(m),P.forEach(m),_.forEach(m),M=A(a),re($.$$.fragment,a),this.h()},h(){n(e,"class","fixed w-full h-full bg-black -z-10"),n(B,"class","absolute bottom-0 right-0 bg-[#222222] rounded-full px-1.5 py-[7px] shadow-[1px_1px_6px_rgba(0,0,0,0.1)]"),n(i,"class","relative"),n(u,"class","flex justify-center my-3.5"),n(h,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),n(v,"type","text"),n(v,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),v.readOnly=!0,v.disabled=!0,n(x,"class","flex items-center gap-3"),n(O,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),n(w,"type","text"),n(w,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),n(w,"placeholder","mynickname"),n(E,"class","flex items-center gap-3"),n(k,"class","flex flex-col gap-2.5"),n(f,"class","flex-1 px-5"),n(s,"class","flex flex-col min-h-screen text-white")},m(a,_){N(a,e,_),N(a,t,_),N(a,s,_),ne(r,s,null),d(s,c),d(s,f),d(f,u),d(u,i),I[o].m(i,null),d(i,y),d(i,B),d(f,U),d(f,k),d(k,x),d(x,h),d(x,q),d(x,v),R(v,l[2].email),d(k,K),d(k,E),d(E,O),d(E,X),d(E,w),R(w,l[0]),N(a,M,_),ne($,a,_),J=!0,Z||(oe=[W(B,"click",l[7]),W(v,"input",l[9]),W(w,"input",l[10])],Z=!0)},p(a,[_]){const P={};_&16424&&(P.$$scope={dirty:_,ctx:a}),r.$set(P);let F=o;o=ce(a),o===F?I[o].p(a,_):(Ne(),z(I[F],1,1,()=>{I[F]=null}),Ae(),p=I[o],p?p.p(a,_):(p=I[o]=ue[o](a),p.c()),V(p,1),p.m(i,y)),_&4&&v.value!==a[2].email&&R(v,a[2].email),_&1&&w.value!==a[0]&&R(w,a[0]);const T={};!Y&&_&16&&(Y=!0,T.isOpen=a[4],ye(()=>Y=!1)),$.$set(T)},i(a){J||(V(r.$$.fragment,a),V(p),V($.$$.fragment,a),J=!0)},o(a){z(r.$$.fragment,a),z(p),z($.$$.fragment,a),J=!1},d(a){a&&(m(e),m(t),m(s),m(M)),le(r),I[o].d(),le($,a),Z=!1,$e(oe)}}}function Ge(l,e,t){let s,{data:r}=e,c=r.user,{user:f}=JSON.parse(JSON.stringify(r)),u=f.unique_name||"",i=f.profile_image_url||"",o=!1,p=!1;function y(){return s?u.trim()?/^[a-z0-9._]{1,30}$/.test(u)?!0:(j.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(j.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1):!1}async function B(){if(y())try{t(3,o=!0);const h=ge(),D=await fetch(`${be}/auth/users/${h}`,{method:"PATCH",headers:{Authorization:`Bearer ${Ce()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:u,profileImage:i})});if(D.ok)j.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),Oe(`/users/${h}`);else{const q=await D.json();console.error(q),j.emit("pushSnackbar",{message:q.message||"프로필 수정에 실패했습니다."})}}catch(h){console.error(h),j.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}finally{t(3,o=!1)}}async function H(){const h=await Te({limit:1}),D=await qe(h);D[0]&&t(1,i=D[0])}function U(){f.email=this.value,t(2,f)}function k(){u=this.value,t(0,u)}function x(h){p=h,t(4,p)}return l.$$set=h=>{"data"in h&&t(8,r=h.data)},l.$$.update=()=>{l.$$.dirty&3&&t(5,s=u!==c.unique_name||i!==c.profile_image_url)},[u,i,f,o,p,s,B,H,r,U,k,x]}class lt extends Ee{constructor(e){super(),Ie(this,e,Ge,Le,xe,{data:8})}}export{lt as component,nt as universal};
