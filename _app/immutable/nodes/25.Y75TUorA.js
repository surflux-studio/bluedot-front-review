import{e as ae}from"../chunks/index.BCvKykqq.js";import{a as ue,g as ce}from"../chunks/sign.Ct_yJkjS.js";import{A as fe}from"../chunks/store.BJaWoeSk.js";import{s as Ce,e as _,a as N,c as g,b as v,f as p,g as S,x as Q,v as a,i as P,h as d,R as H,y as M,F as ve,t as me,d as de,C as le,j as be,n as ne,q as X,r as Y}from"../chunks/scheduler.DH3jNSXp.js";import{S as Be,i as xe,c as pe,b as he,m as _e,a as J,d as ke,t as L,e as ge,g as ye}from"../chunks/index.DhGy8j-A.js";import{g as we}from"../chunks/entry.BhCHTBrT.js";import{e as q}from"../chunks/emitter.CkY1Q2mT.js";import{H as De}from"../chunks/Header.BJIqvESR.js";import{g as Ee,u as $e}from"../chunks/photo.FPUHzcsE.js";import{C as Ie}from"../chunks/CircleImage.Cv_5FGVd.js";import{s as oe}from"../chunks/s32cloudfront.CATw5Mi_.js";import{g as ie}from"../chunks/color.C_Jm4JAr.js";const Ne=async({params:n,fetch:e,depends:t})=>{if(String(n.idx)!==String(ue()))throw ae(403,"Forbidden");const u=(await(await e(`${fe}/auth/users/${n.idx}`,{headers:{Authorization:`Bearer ${ce()}`}})).json()).data;if(!(u!=null&&u.idx))throw ae(404,"User not found");return{user:u}},Qe=Object.freeze(Object.defineProperty({__proto__:null,load:Ne},Symbol.toStringTag,{value:"Module"}));function Se(n){let e;return{c(){e=me("완료")},l(t){e=de(t,"완료")},m(t,s){P(t,e,s)},d(t){t&&p(e)}}}function Pe(n){let e,t,s;return{c(){e=X("svg"),t=X("circle"),s=X("path"),this.h()},l(r){e=Y(r,"svg",{class:!0,viewBox:!0});var u=v(e);t=Y(u,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),v(t).forEach(p),s=Y(u,"path",{class:!0,fill:!0,d:!0}),v(s).forEach(p),u.forEach(p),this.h()},h(){a(t,"class","opacity-25"),a(t,"cx","12"),a(t,"cy","12"),a(t,"r","10"),a(t,"stroke","currentColor"),a(t,"stroke-width","4"),a(t,"fill","none"),a(s,"class","opacity-75"),a(s,"fill","currentColor"),a(s,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),a(e,"class","animate-spin h-5 w-5 mr-3 text-white"),a(e,"viewBox","0 0 24 24")},m(r,u){P(r,e,u),d(e,t),d(e,s)},d(r){r&&p(e)}}}function Ae(n){let e,t,s,r,u;function c(o,m){return o[3]?Pe:Se}let i=c(n),l=i(n);return{c(){e=_("span"),t=_("button"),l.c(),this.h()},l(o){e=g(o,"SPAN",{slot:!0,class:!0});var m=v(e);t=g(m,"BUTTON",{});var w=v(t);l.l(w),w.forEach(p),m.forEach(p),this.h()},h(){t.disabled=n[3],a(e,"slot","right"),a(e,"class",s=`
        text-sm leading-[1.0625rem] font-medium 
        ${n[4]?"text-white":"text-[#3f3f3f]"}
      `)},m(o,m){P(o,e,m),d(e,t),l.m(t,null),r||(u=M(t,"click",n[5]),r=!0)},p(o,m){i!==(i=c(o))&&(l.d(1),l=i(o),l&&(l.c(),l.m(t,null))),m&8&&(t.disabled=o[3]),m&16&&s!==(s=`
        text-sm leading-[1.0625rem] font-medium 
        ${o[4]?"text-white":"text-[#3f3f3f]"}
      `)&&a(e,"class",s)},d(o){o&&p(e),l.d(),r=!1,u()}}}function Te(n){var u;let e,t,s=(((u=n[0])==null?void 0:u.at(0))??"")+"",r;return{c(){e=_("div"),t=_("span"),r=me(s),this.h()},l(c){e=g(c,"DIV",{class:!0,style:!0});var i=v(e);t=g(i,"SPAN",{class:!0});var l=v(t);r=de(l,s),l.forEach(p),i.forEach(p),this.h()},h(){a(t,"class","text-2xl font-semibold text-black"),a(e,"class","w-[76px] h-[76px] flex items-center justify-center rounded-full"),le(e,"background-color",ie(n[0]))},m(c,i){P(c,e,i),d(e,t),d(t,r)},p(c,i){var l;i&1&&s!==(s=(((l=c[0])==null?void 0:l.at(0))??"")+"")&&be(r,s),i&1&&le(e,"background-color",ie(c[0]))},i:ne,o:ne,d(c){c&&p(e)}}}function qe(n){let e,t;return e=new Ie({props:{src:oe(n[1],500),width:"76px",strokeWidth:"0"}}),{c(){pe(e.$$.fragment)},l(s){he(e.$$.fragment,s)},m(s,r){_e(e,s,r),t=!0},p(s,r){const u={};r&2&&(u.src=oe(s[1],500)),e.$set(u)},i(s){t||(L(e.$$.fragment,s),t=!0)},o(s){J(e.$$.fragment,s),t=!1},d(s){ge(e,s)}}}function Fe(n){let e,t,s,r,u,c,i,l,o,m,w,x,F='<svg class="w-3 h-2.5" fill="transparent" stroke="white" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',T,h,b,k,Z="이메일(변경 불가)",R,B,G,D,$,ee="닉네임",W,y,U,K,te;r=new De({props:{position:"static",leftBack:"white",centerTitle:"프로필 편집",$$slots:{right:[Ae]},$$scope:{ctx:n}}});const se=[qe,Te],E=[];function re(f,C){return f[1]?0:1}return o=re(n),m=E[o]=se[o](n),{c(){e=_("div"),t=N(),s=_("div"),pe(r.$$.fragment),u=N(),c=_("main"),i=_("div"),l=_("div"),m.c(),w=N(),x=_("button"),x.innerHTML=F,T=N(),h=_("div"),b=_("div"),k=_("span"),k.textContent=Z,R=N(),B=_("input"),G=N(),D=_("div"),$=_("span"),$.textContent=ee,W=N(),y=_("input"),this.h()},l(f){e=g(f,"DIV",{class:!0}),v(e).forEach(p),t=S(f),s=g(f,"DIV",{class:!0});var C=v(s);he(r.$$.fragment,C),u=S(C),c=g(C,"MAIN",{class:!0});var I=v(c);i=g(I,"DIV",{class:!0});var A=v(i);l=g(A,"DIV",{class:!0});var j=v(l);m.l(j),w=S(j),x=g(j,"BUTTON",{class:!0,"data-svelte-h":!0}),Q(x)!=="svelte-qa1vtb"&&(x.innerHTML=F),j.forEach(p),A.forEach(p),T=S(I),h=g(I,"DIV",{class:!0});var O=v(h);b=g(O,"DIV",{class:!0});var V=v(b);k=g(V,"SPAN",{class:!0,"data-svelte-h":!0}),Q(k)!=="svelte-1gfnk3z"&&(k.textContent=Z),R=S(V),B=g(V,"INPUT",{type:!0,class:!0}),V.forEach(p),G=S(O),D=g(O,"DIV",{class:!0});var z=v(D);$=g(z,"SPAN",{class:!0,"data-svelte-h":!0}),Q($)!=="svelte-2npwwy"&&($.textContent=ee),W=S(z),y=g(z,"INPUT",{type:!0,class:!0,placeholder:!0}),z.forEach(p),O.forEach(p),I.forEach(p),C.forEach(p),this.h()},h(){a(e,"class","fixed w-full h-full bg-black -z-10"),a(x,"class","absolute bottom-0 right-0 bg-[#222222] rounded-full px-1.5 py-[7px] shadow-[1px_1px_6px_rgba(0,0,0,0.1)]"),a(l,"class","relative"),a(i,"class","flex justify-center my-3.5"),a(k,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),a(B,"type","text"),a(B,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),B.readOnly=!0,B.disabled=!0,a(b,"class","flex items-center gap-3"),a($,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),a(y,"type","text"),a(y,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),a(y,"placeholder","mynickname"),a(D,"class","flex items-center gap-3"),a(h,"class","flex flex-col gap-2.5"),a(c,"class","flex-1 px-5"),a(s,"class","flex flex-col min-h-screen text-white")},m(f,C){P(f,e,C),P(f,t,C),P(f,s,C),_e(r,s,null),d(s,u),d(s,c),d(c,i),d(i,l),E[o].m(l,null),d(l,w),d(l,x),d(c,T),d(c,h),d(h,b),d(b,k),d(b,R),d(b,B),H(B,n[2].email),d(h,G),d(h,D),d(D,$),d(D,W),d(D,y),H(y,n[0]),U=!0,K||(te=[M(x,"click",n[6]),M(B,"input",n[8]),M(y,"input",n[9])],K=!0)},p(f,[C]){const I={};C&4120&&(I.$$scope={dirty:C,ctx:f}),r.$set(I);let A=o;o=re(f),o===A?E[o].p(f,C):(ye(),J(E[A],1,1,()=>{E[A]=null}),ke(),m=E[o],m?m.p(f,C):(m=E[o]=se[o](f),m.c()),L(m,1),m.m(l,w)),C&4&&B.value!==f[2].email&&H(B,f[2].email),C&1&&y.value!==f[0]&&H(y,f[0])},i(f){U||(L(r.$$.fragment,f),L(m),U=!0)},o(f){J(r.$$.fragment,f),J(m),U=!1},d(f){f&&(p(e),p(t),p(s)),ge(r),E[o].d(),K=!1,ve(te)}}}function Ue(n,e,t){let s,{data:r}=e,u=r.user,{user:c}=JSON.parse(JSON.stringify(r)),i=c.unique_name||"",l=c.profile_image_url||"",o=!1;function m(){return s?i.trim()?/^[a-z0-9._]{1,30}$/.test(i)?!0:(q.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(q.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1):!1}async function w(){if(m())try{t(3,o=!0);const h=ue(),b=await fetch(`${fe}/auth/users/${h}`,{method:"PATCH",headers:{Authorization:`Bearer ${ce()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:i,profileImage:l})});if(b.ok)q.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),we(`/users/${h}`);else{const k=await b.json();console.error(k),q.emit("pushSnackbar",{message:k.message||"프로필 수정에 실패했습니다."})}}catch(h){console.error(h),q.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}finally{t(3,o=!1)}}async function x(){const h=await Ee({limit:1}),b=await $e(h);b[0]&&t(1,l=b[0])}function F(){c.email=this.value,t(2,c)}function T(){i=this.value,t(0,i)}return n.$$set=h=>{"data"in h&&t(7,r=h.data)},n.$$.update=()=>{n.$$.dirty&3&&t(4,s=i!==u.unique_name||l!==u.profile_image_url)},[i,l,c,o,s,w,x,r,F,T]}class Xe extends Be{constructor(e){super(),xe(this,e,Ue,Fe,Ce,{data:7})}}export{Xe as component,Qe as universal};
