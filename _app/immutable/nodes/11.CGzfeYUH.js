import{s as q,w as T,a as M,g as N,i as V,x as W,f as v,k as G,y as J,z as R,e as $,t as U,c as D,b as A,A as j,d as Q,v as y,h,B as X}from"../chunks/scheduler.ChiloVl_.js";import{S as Z,i as ee,b as z,c as E,d as w,m as O,t as x,a as Y,e as I}from"../chunks/index.CeuzkHdt.js";import{H as te}from"../chunks/Header.DMczSze-.js";import{M as oe}from"../chunks/Map.BzUwnLnR.js";import{s as L}from"../chunks/map.3uFgMiQG.js";import{p as se}from"../chunks/stores.qPVlOpU7.js";import{A as ne}from"../chunks/ActionSheet.eKJfdG_n.js";import{F as ae}from"../chunks/Field.BPO_b0rw.js";import{C as ie,e as B,i as re,A as ue}from"../chunks/sign.C_Srd8ra.js";import{g as le}from"../chunks/entry.CiRIqHzs.js";import{t as fe}from"../chunks/proj.DXH8zrwl.js";import{K}from"../chunks/index.RJjHHpk4.js";function me(a){let n,t,l="이 장소를 뭐라고 부를까요?",C,s,i,c,u,p,f,b,e,r,_,g;function F(m){a[7](m)}let P={clear:!0,clearColor:"#757475",padding:"pb-2.5",border:"border-b border-b-[#757475]",fontSize:"font-normal text-sm",fontColor:"text-white",limit:20,useCounter:!1,backgroundColor:"bg-transparent",placeholder:"장소 이름을 입력하세요",placeholderColor:"#757475"};return a[1]!==void 0&&(P.value=a[1]),i=new ae({props:P}),T.push(()=>z(i,"value",F)),{c(){n=$("div"),t=$("p"),t.textContent=l,C=M(),s=$("div"),E(i.$$.fragment),u=M(),p=$("div"),f=$("button"),b=U("장소 추가"),this.h()},l(m){n=D(m,"DIV",{class:!0});var d=A(n);t=D(d,"P",{class:!0,"data-svelte-h":!0}),j(t)!=="svelte-9vo44h"&&(t.textContent=l),C=N(d),s=D(d,"DIV",{class:!0});var o=A(s);w(i.$$.fragment,o),o.forEach(v),u=N(d),p=D(d,"DIV",{class:!0});var k=A(p);f=D(k,"BUTTON",{class:!0});var S=A(f);b=Q(S,"장소 추가"),S.forEach(v),k.forEach(v),d.forEach(v),this.h()},h(){y(t,"class","py-2.5 font-semibold text-sm leading-[17px] text-white"),y(s,"class","box-name flex flex-col gap-4 py-2.5"),y(f,"class","w-full p-2.5 rounded-[50px] font-medium text-sm leading-[17px] bg-[#0C79FE] text-white disabled:bg-[#383838]/70 disabled:text-[#757475]"),f.disabled=e=!a[1].trim(),y(p,"class","py-2.5"),y(n,"class","px-4")},m(m,d){V(m,n,d),h(n,t),h(n,C),h(n,s),O(i,s,null),h(n,u),h(n,p),h(p,f),h(f,b),r=!0,_||(g=X(f,"click",a[5]),_=!0)},p(m,d){const o={};!c&&d&2&&(c=!0,o.value=m[1],W(()=>c=!1)),i.$set(o),(!r||d&2&&e!==(e=!m[1].trim()))&&(f.disabled=e)},i(m){r||(x(i.$$.fragment,m),r=!0)},o(m){Y(i.$$.fragment,m),r=!1},d(m){m&&v(n),I(i),_=!1,g()}}}function pe(a){let n,t,l,C,s,i,c,u;n=new te({props:{position:"fixed",leftBack:"black"}}),l=new oe({props:{onSelect:a[4],mapY:a[3]}});function p(e){a[8](e)}function f(e){a[9](e)}let b={fixed:!0,noHandle:!0,$$slots:{default:[me]},$$scope:{ctx:a}};return a[0]!==void 0&&(b.isOpen=a[0]),a[2]!==void 0&&(b.movePositionY=a[2]),s=new ne({props:b}),T.push(()=>z(s,"isOpen",p)),T.push(()=>z(s,"movePositionY",f)),{c(){E(n.$$.fragment),t=M(),E(l.$$.fragment),C=M(),E(s.$$.fragment)},l(e){w(n.$$.fragment,e),t=N(e),w(l.$$.fragment,e),C=N(e),w(s.$$.fragment,e)},m(e,r){O(n,e,r),V(e,t,r),O(l,e,r),V(e,C,r),O(s,e,r),u=!0},p(e,[r]){const _={};r&8&&(_.mapY=e[3]),l.$set(_);const g={};r&131074&&(g.$$scope={dirty:r,ctx:e}),!i&&r&1&&(i=!0,g.isOpen=e[0],W(()=>i=!1)),!c&&r&4&&(c=!0,g.movePositionY=e[2],W(()=>c=!1)),s.$set(g)},i(e){u||(x(n.$$.fragment,e),x(l.$$.fragment,e),x(s.$$.fragment,e),u=!0)},o(e){Y(n.$$.fragment,e),Y(l.$$.fragment,e),Y(s.$$.fragment,e),u=!1},d(e){e&&(v(t),v(C)),I(n,e),I(l,e),I(s,e)}}}function de(a,n,t){let l;G(a,se,o=>t(12,l=o));const C=ie.isNativePlatform();let s=!1,i="",c=!1,u,p=0,f=0,b=0;function e(){K.addListener("keyboardWillShow",o=>{f===0&&(f=o.keyboardHeight),t(2,p=-f),t(3,b=-200)}),K.addListener("keyboardWillHide",()=>{t(2,p=f),t(3,b=0)})}function r(){K.removeAllListeners()}J(()=>{let o=l.url.searchParams.get("location");o&&(l.url.searchParams.delete("location"),t(6,u=o.split(",").map(Number)),le(l.url.toString(),{replaceState:!0,invalidateAll:!1})),C&&e()}),R(()=>{L.setPosition(void 0),C&&r()});function _(o){L.setPosition(o),t(0,s=o!==void 0)}function g(o){t(6,u=o),B.emit("flyTo",u)}function F(){if(!re())return B.emit("showSignInModal",{removable:!0});if(c)return B.emit("pushSnackbar",{message:"처리중입니다. 잠시 후 다시 시도해주세요"});c=!0;const o=i.trim();if(!o||u===void 0)return;const[k,S]=fe(u);fetch(`${ue}/places`,{method:"POST",body:JSON.stringify([{name:o,location:{lon:Number(k.toFixed(6)),lat:Number(S.toFixed(6))}}])}).then(async H=>{if(!H.ok)return B.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});t(6,u=void 0),B.emit("pushSnackbar",{message:`'${o}' 장소를 추가했습니다`})}).catch(H=>{console.log(H),B.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."})}).finally(()=>{c=!1})}function P(o){i=o,t(1,i),t(0,s)}function m(o){s=o,t(0,s)}function d(o){p=o,t(2,p)}return a.$$.update=()=>{a.$$.dirty&1&&(s||(t(1,i=""),c=!1,L.setPosition(void 0))),a.$$.dirty&64&&_(u)},[s,i,p,b,g,F,u,P,m,d]}class ke extends Z{constructor(n){super(),ee(this,n,de,pe,q,{})}}export{ke as component};
