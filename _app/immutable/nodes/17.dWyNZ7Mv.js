import{a as ie}from"../chunks/sign.DHe33_F7.js";import{A as L,e as W}from"../chunks/store.MRPWFVRT.js";import{s as J,F as z,G as H,b as P,f as _,q as c,i as $,h as I,n as B,m as X,a as y,g as E,p as Y,k as ae,e as q,c as C,u as D,r as U,D as ne,R as ee}from"../chunks/scheduler.BnheM4g2.js";import{r as le,H as re}from"../chunks/Header.CZKMtM4x.js";import"../chunks/index.DLxOzGXy.js";import{S as K,i as Q,e as te,c as j,a as N,m as A,b as S,f as oe,t as V,d as M,g as fe}from"../chunks/index.CP53dWnj.js";import{V as de}from"../chunks/Viewer.CQW60-Df.js";import{g as se}from"../chunks/entry.BT-YnksK.js";/* empty css                                                   */import"../chunks/heic2any.DLyIuazc.js";/* empty css                                                     */import{p as ce}from"../chunks/stores.CwFfa7fL.js";import{N as ue}from"../chunks/NavigationBar.DLCBEIBj.js";import{A as he}from"../chunks/ActionSheet.D9uPIZXg.js";/* empty css                                                   */import{M as me}from"../chunks/Modal.BP2sFmgM.js";function ge(i){let e,t;return{c(){e=z("svg"),t=z("path"),this.h()},l(s){e=H(s,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var n=P(e);t=H(n,"path",{d:!0}),P(t).forEach(_),n.forEach(_),this.h()},h(){c(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 -960 960 960"),c(e,"width",i[1]),c(e,"height",i[1]),c(e,"fill",i[0])},m(s,n){$(s,e,n),I(e,t)},p(s,[n]){n&2&&c(e,"width",s[1]),n&2&&c(e,"height",s[1]),n&1&&c(e,"fill",s[0])},i:B,o:B,d(s){s&&_(e)}}}function pe(i,e,t){let s,{fill:n="#5f6368"}=e,{length:a="1.75"}=e,{alt:d="Edit"}=e;return i.$$set=r=>{"fill"in r&&t(0,n=r.fill),"length"in r&&t(2,a=r.length),"alt"in r&&t(3,d=r.alt)},i.$$.update=()=>{i.$$.dirty&4&&t(1,s=le(a))},[n,s,a,d]}class _e extends K{constructor(e){super(),Q(this,e,pe,ge,J,{fill:0,length:2,alt:3})}}function be(i){let e,t;return{c(){e=z("svg"),t=z("path"),this.h()},l(s){e=H(s,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var n=P(e);t=H(n,"path",{d:!0}),P(t).forEach(_),n.forEach(_),this.h()},h(){c(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 -960 960 960"),c(e,"width",i[1]),c(e,"height",i[1]),c(e,"fill",i[0])},m(s,n){$(s,e,n),I(e,t)},p(s,[n]){n&2&&c(e,"width",s[1]),n&2&&c(e,"height",s[1]),n&1&&c(e,"fill",s[0])},i:B,o:B,d(s){s&&_(e)}}}function ve(i,e,t){let s,{fill:n="#5f6368"}=e,{length:a="1.75"}=e,{alt:d="Delete"}=e;return i.$$set=r=>{"fill"in r&&t(0,n=r.fill),"length"in r&&t(2,a=r.length),"alt"in r&&t(3,d=r.alt)},i.$$.update=()=>{i.$$.dirty&4&&t(1,s=le(a))},[n,s,a,d]}class xe extends K{constructor(e){super(),Q(this,e,ve,be,J,{fill:0,length:2,alt:3})}}function we(i){let e,t,s;return t=new de({props:{posts:i[0].posts,index:i[0].index}}),{c(){e=q("div"),j(t.$$.fragment),this.h()},l(n){e=C(n,"DIV",{class:!0});var a=P(e);N(t.$$.fragment,a),a.forEach(_),this.h()},h(){c(e,"class","fixed top-0 left-0 w-full h-full")},m(n,a){$(n,e,a),A(t,e,null),s=!0},p(n,a){const d={};a&1&&(d.posts=n[0].posts),a&1&&(d.index=n[0].index),t.$set(d)},i(n){s||(V(t.$$.fragment,n),s=!0)},o(n){S(t.$$.fragment,n),s=!1},d(n){n&&_(e),M(t)}}}function ke(i){let e;return{c(){e=q("div"),this.h()},l(t){e=C(t,"DIV",{class:!0}),P(e).forEach(_),this.h()},h(){c(e,"class","bg-black w-screen h-screen")},m(t,s){$(t,e,s)},p:B,i:B,o:B,d(t){t&&_(e)}}}function Ie(i){let e,t,s,n,a,d="수정",r,o,u,b,m,x="삭제",h,v,f;return s=new _e({props:{fill:"white",length:1.4}}),u=new xe({props:{fill:"red",length:1.4}}),{c(){e=q("div"),t=q("button"),j(s.$$.fragment),n=y(),a=q("span"),a.textContent=d,r=y(),o=q("button"),j(u.$$.fragment),b=y(),m=q("span"),m.textContent=x,this.h()},l(g){e=C(g,"DIV",{class:!0});var w=P(e);t=C(w,"BUTTON",{class:!0});var T=P(t);N(s.$$.fragment,T),n=E(T),a=C(T,"SPAN",{"data-svelte-h":!0}),D(a)!=="svelte-17aljrl"&&(a.textContent=d),T.forEach(_),r=E(w),o=C(w,"BUTTON",{class:!0});var O=P(o);N(u.$$.fragment,O),b=E(O),m=C(O,"SPAN",{"data-svelte-h":!0}),D(m)!=="svelte-1k1dgz"&&(m.textContent=x),O.forEach(_),w.forEach(_),this.h()},h(){c(t,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-white rounded-t-xl bg-[#3335] border-b border-[#333] border-collapse"),c(o,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-[red] rounded-b-xl bg-[#3336] border-t border-[#333] border-collapse"),c(e,"class","flex flex-col items-center px-6 py-4")},m(g,w){$(g,e,w),I(e,t),A(s,t,null),I(t,n),I(t,a),I(e,r),I(e,o),A(u,o,null),I(o,b),I(o,m),h=!0,v||(f=[U(t,"click",i[12]),U(o,"click",i[13])],v=!0)},p:B,i(g){h||(V(s.$$.fragment,g),V(u.$$.fragment,g),h=!0)},o(g){S(s.$$.fragment,g),S(u.$$.fragment,g),h=!1},d(g){g&&_(e),M(s),M(u),v=!1,ne(f)}}}function Te(i){let e,t,s="정말로 삭제하시겠습니까?",n,a,d="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",r,o,u,b="삭제",m,x,h="취소",v,f;return{c(){e=q("div"),t=q("h2"),t.textContent=s,n=y(),a=q("p"),a.textContent=d,r=y(),o=q("div"),u=q("button"),u.textContent=b,m=y(),x=q("button"),x.textContent=h,this.h()},l(g){e=C(g,"DIV",{class:!0});var w=P(e);t=C(w,"H2",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-1yzhdkj"&&(t.textContent=s),n=E(w),a=C(w,"P",{class:!0,"data-svelte-h":!0}),D(a)!=="svelte-26p028"&&(a.textContent=d),r=E(w),o=C(w,"DIV",{class:!0});var T=P(o);u=C(T,"BUTTON",{class:!0,"data-svelte-h":!0}),D(u)!=="svelte-1q4epan"&&(u.textContent=b),m=E(T),x=C(T,"BUTTON",{class:!0,"data-svelte-h":!0}),D(x)!=="svelte-1rzg9yy"&&(x.textContent=h),T.forEach(_),w.forEach(_),this.h()},h(){c(t,"class","text-lg font-semibold mb-2"),c(a,"class","text-gray-600 mb-4"),c(u,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),c(x,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),c(o,"class","flex justify-center space-x-4"),c(e,"class","text-center")},m(g,w){$(g,e,w),I(e,t),I(e,n),I(e,a),I(e,r),I(e,o),I(o,u),I(o,m),I(o,x),v||(f=[U(u,"click",i[15]),U(x,"click",i[16])],v=!0)},p:B,d(g){g&&_(e),v=!1,ne(f)}}}function qe(i){let e,t,s,n,a,d,r,o,u,b,m,x,h;e=new re({props:{position:"fixed",leftBack:i[5]?"":"white",rightSearch:"white",rightPostSetting:{visible:i[4],fill:"white",onClick:i[11]}}});const v=[ke,we],f=[];function g(l,p){return l[0].posts.length===0?0:1}s=g(i),n=f[s]=v[s](i),d=new ue({});function w(l){i[14](l)}let T={defaultHeight:16*16,maxHeight:16*16,$$slots:{default:[Ie]},$$scope:{ctx:i}};i[1]!==void 0&&(T.isOpen=i[1]),o=new he({props:T}),X.push(()=>te(o,"isOpen",w));function O(l){i[17](l)}let Z={$$slots:{default:[Te]},$$scope:{ctx:i}};return i[2]!==void 0&&(Z.modalVisible=i[2]),m=new me({props:Z}),X.push(()=>te(m,"modalVisible",O)),{c(){j(e.$$.fragment),t=y(),n.c(),a=y(),j(d.$$.fragment),r=y(),j(o.$$.fragment),b=y(),j(m.$$.fragment)},l(l){N(e.$$.fragment,l),t=E(l),n.l(l),a=E(l),N(d.$$.fragment,l),r=E(l),N(o.$$.fragment,l),b=E(l),N(m.$$.fragment,l)},m(l,p){A(e,l,p),$(l,t,p),f[s].m(l,p),$(l,a,p),A(d,l,p),$(l,r,p),A(o,l,p),$(l,b,p),A(m,l,p),h=!0},p(l,[p]){const k={};p&32&&(k.leftBack=l[5]?"":"white"),p&18&&(k.rightPostSetting={visible:l[4],fill:"white",onClick:l[11]}),e.$set(k);let G=s;s=g(l),s===G?f[s].p(l,p):(fe(),S(f[G],1,1,()=>{f[G]=null}),oe(),n=f[s],n?n.p(l,p):(n=f[s]=v[s](l),n.c()),V(n,1),n.m(a.parentNode,a));const R={};p&1048590&&(R.$$scope={dirty:p,ctx:l}),!u&&p&2&&(u=!0,R.isOpen=l[1],Y(()=>u=!1)),o.$set(R);const F={};p&1048580&&(F.$$scope={dirty:p,ctx:l}),!x&&p&4&&(x=!0,F.modalVisible=l[2],Y(()=>x=!1)),m.$set(F)},i(l){h||(V(e.$$.fragment,l),V(n),V(d.$$.fragment,l),V(o.$$.fragment,l),V(m.$$.fragment,l),h=!0)},o(l){S(e.$$.fragment,l),S(n),S(d.$$.fragment,l),S(o.$$.fragment,l),S(m.$$.fragment,l),h=!1},d(l){l&&(_(t),_(a),_(r),_(b)),M(e,l),f[s].d(l),M(d,l),M(o,l),M(m,l)}}}function Ce(i,e,t){let s,n,a,d,r,o,u;ae(i,ce,k=>t(10,u=k));let{data:b}=e,m=b.tokenIdx,x=b.token,h=!1,v=!1;function f(){fetch(`${L}/posts/${a}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`}}).then(k=>k.json()).then(()=>se(`/users/${m}`,{replaceState:!0,invalidateAll:!0}))}const g=()=>{t(1,h=!0)},w=()=>{t(1,h=!1),se(`/viewer/edit?type=patch&postIdx=${a}`,{replaceState:!1,invalidateAll:!1})},T=()=>{t(1,h=!1),t(2,v=!0)};function O(k){h=k,t(1,h)}const Z=()=>{f(),t(2,v=!1)},l=()=>{t(2,v=!1)};function p(k){v=k,t(2,v)}return i.$$set=k=>{"data"in k&&t(0,b=k.data)},i.$$.update=()=>{var k;i.$$.dirty&1024&&t(9,s=u.url.searchParams.get("placeIdx")),i.$$.dirty&1024&&t(8,n=u.url.searchParams.get("userIdx")),i.$$.dirty&1024&&t(3,a=u.url.searchParams.get("postIdx")),i.$$.dirty&1&&t(7,d=(k=b.posts[b.index])==null?void 0:k.user_idx),i.$$.dirty&768&&t(5,r=!s&&!n),i.$$.dirty&128&&t(4,o=String(m)===String(d))},[b,h,v,a,o,r,f,d,n,s,u,g,w,T,O,Z,l,p]}class Ge extends K{constructor(e){super(),Q(this,e,Ce,qe,J,{data:0})}}const Pe=async({fetch:i,url:e,data:t})=>{console.warn("viewer/+page.ts load");const s=sessionStorage.getItem("jwt"),n=ie(),a=e.searchParams.get("placeIdx"),d=e.searchParams.get("userIdx"),r=Number(e.searchParams.get("postIdx")||0),o=Number(e.searchParams.get("mediaIdx")||0),u=0,b=30,m=`&offset=${u}`,x=`&limit=${b}`;let h=[],v=0;return(d||a)&&ee(W).length>0?(h=ee(W).map(f=>f.idx===r?{...f,mediaIdx:o}:{...f,mediaIdx:0}),v=h.findIndex(f=>f.idx===String(r))):(r&&(h=[await i(`${L}/posts/${r}`,{method:"GET",headers:{Authorization:"Bearer "+s}}).then(f=>f.json()).then(f=>f.data)]),h=[...h,...await i(`${L}/posts?${m}${x}`,{method:"GET",headers:{Authorization:"Bearer "+s}}).then(f=>f.json()).then(f=>f.data.filter(g=>g.idx!==String(r)))||[]]),{index:v,posts:h,tokenIdx:n,token:s}},Re=Object.freeze(Object.defineProperty({__proto__:null,load:Pe},Symbol.toStringTag,{value:"Module"}));export{Ge as component,Re as universal};
