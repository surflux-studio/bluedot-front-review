import{g as w}from"../chunks/entry.NXM8Nk0h.js";import{s as j,a as y,g as I,i as k,f as c,k as E,A as F,B as O,e as B,t as q,c as M,b as N,d as C,q as S,h as D,n as H}from"../chunks/scheduler.Ds8JjPaX.js";import{S as L,i as R,c as p,b as $,m as g,t as x,a as _,d as h}from"../chunks/index.ucgEq-dW.js";import{I as V}from"../chunks/IconMaterialBoxRounded.BZOv-boE.js";import{F as z}from"../chunks/Footer.DHTO6IZQ.js";import{H as A}from"../chunks/Header.B6xjiHZa.js";import{M as T}from"../chunks/Map.B4-dyU7j.js";import{N as Z}from"../chunks/NavigationBar.BsBm8EET.js";import{a as d,v as G}from"../chunks/map.CAEdHBR4.js";import{p as J}from"../chunks/stores.D7XwZICj.js";import{e as K}from"../chunks/sign.a4oUh1_j.js";import{f as Q}from"../chunks/location.CLoGBdYB.js";import{s as U}from"../chunks/s32cloudfront.yu0ljD8J.js";const W=async({params:l,parent:e})=>{var a;if(l.idx==="-1")return w("/boxes");const r=await e();return r.error?w("/boxes"):(a=r.data)!=null&&a.hasPermission?r.data:w(`/boxes/${l.idx}/detail`)},pt=Object.freeze(Object.defineProperty({__proto__:null,load:W},Symbol.toStringTag,{value:"Module"}));function X(l){let e,s,r,a,f=(l[0].name??"")+"",u,m;return s=new V({props:{length:1.25}}),{c(){e=B("div"),p(s.$$.fragment),r=y(),a=B("div"),u=q(f),this.h()},l(n){e=M(n,"DIV",{class:!0});var t=N(e);$(s.$$.fragment,t),r=I(t),a=M(t,"DIV",{class:!0});var i=N(a);u=C(i,f),i.forEach(c),t.forEach(c),this.h()},h(){S(a,"class","typo-sub-h3 text-gray-900"),S(e,"class","flex flex-row justify-center items-center gap-1")},m(n,t){k(n,e,t),g(s,e,null),D(e,r),D(e,a),D(a,u),m=!0},p:H,i(n){m||(x(s.$$.fragment,n),m=!0)},o(n){_(s.$$.fragment,n),m=!1},d(n){n&&c(e),h(s)}}}function Y(l){let e,s,r,a,f,u,m,n;return e=new A({props:{position:"fixed",leftBack:"black",contentPosition:"items-center",rightBoxDetail:{visible:!0,fill:"black",onClick:l[1]},$$slots:{default:[X]},$$scope:{ctx:l}}}),r=new T({}),f=new z({props:{position:"fixed",leftReposition:!0}}),m=new Z({}),{c(){p(e.$$.fragment),s=y(),p(r.$$.fragment),a=y(),p(f.$$.fragment),u=y(),p(m.$$.fragment)},l(t){$(e.$$.fragment,t),s=I(t),$(r.$$.fragment,t),a=I(t),$(f.$$.fragment,t),u=I(t),$(m.$$.fragment,t)},m(t,i){g(e,t,i),k(t,s,i),g(r,t,i),k(t,a,i),g(f,t,i),k(t,u,i),g(m,t,i),n=!0},p(t,[i]){const b={};i&512&&(b.$$scope={dirty:i,ctx:t}),e.$set(b)},i(t){n||(x(e.$$.fragment,t),x(r.$$.fragment,t),x(f.$$.fragment,t),x(m.$$.fragment,t),n=!0)},o(t){_(e.$$.fragment,t),_(r.$$.fragment,t),_(f.$$.fragment,t),_(m.$$.fragment,t),n=!1},d(t){t&&(c(s),c(a),c(u)),h(e,t),h(r,t),h(f,t),h(m,t)}}}const v=60;function tt(l,e,s){let r;E(l,J,o=>s(4,r=o));let{data:a}=e,f=a.box,u=a.places;F(()=>{t()}),O(()=>{d.un("change",i)});const m=[];let n=[];function t(){u.length!==0&&(n=u.filter(o=>!o.longitude||!o.latitude||m.includes(o.idx)?!1:(m.push(o.idx),!0)),!r.url.searchParams.get("location")&&n.length>0&&d.on("change",i),K.emit("addIcons",n.map(o=>{var P;return{idx:Number(o.idx),coordinate:Q([o.longitude,o.latitude]),image:U(((P=o.media)==null?void 0:P.at(0))??"",500),shape:"waterdrop",type:"place",link:`/places/${o.idx}?boxIdx=${f.idx}`,rank:1,name:o.name,width:56,height:61}})))}function i(){if(d.getFeatures().length!==n.length)return;d.un("change",i);const o=d.getExtent();G.fit(o,{padding:[v,v,v,v],duration:500,maxZoom:16})}function b(){w(`/boxes/${f.idx}/detail`)}return l.$$set=o=>{"data"in o&&s(2,a=o.data)},[f,b,a]}class $t extends L{constructor(e){super(),R(this,e,tt,Y,j,{data:2})}}export{$t as component,pt as universal};
