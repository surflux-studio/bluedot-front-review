import{g as ie}from"../chunks/entry.NXM8Nk0h.js";import{g as Re,e as V,s as he}from"../chunks/sign.a4oUh1_j.js";import{s as Be,e as g,c as b,b as B,f as _,q as p,i as F,n as z,O as Ge,Z as Ie,v as Z,y as Ve,A as Je,t as ze,d as Fe,P as pe,h as d,j as Xe,z as Ke,_ as Qe,C as Ce,a as E,g as T,E as q,r as He,D as ve,k as We,H as $e,U as ye}from"../chunks/scheduler.Ds8JjPaX.js";import{S as ke,i as xe,e as we,c as se,b as ae,m as le,t as K,a as Q,d as ne}from"../chunks/index.ucgEq-dW.js";import{H as Ye}from"../chunks/Header.B6xjiHZa.js";import{F as et}from"../chunks/Field.CPsJTGgc.js";import{g as tt,c as st}from"../chunks/photo.DBsQXGlT.js";import{A as at}from"../chunks/constants.B40lR-wj.js";import{s as Le}from"../chunks/s32cloudfront.yu0ljD8J.js";import{e as je,u as lt,d as nt}from"../chunks/each.BmbOg1ua.js";import{A as it}from"../chunks/ActionSheet.CHExQTKZ.js";const ot="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.5339%204.27187L6.1839%205.62187H3.6V13.7219H14.4V5.62187H11.8161L10.4661%204.27187H7.5339ZM6.975%202.92188H11.025L12.375%204.27187H15.075C15.254%204.27187%2015.4257%204.34299%2015.5523%204.46958C15.6789%204.59616%2015.75%204.76785%2015.75%204.94687V14.3969C15.75%2014.5759%2015.6789%2014.7476%2015.5523%2014.8742C15.4257%2015.0008%2015.254%2015.0719%2015.075%2015.0719H2.925C2.74598%2015.0719%202.57429%2015.0008%202.4477%2014.8742C2.32112%2014.7476%202.25%2014.5759%202.25%2014.3969V4.94687C2.25%204.76785%202.32112%204.59616%202.4477%204.46958C2.57429%204.34299%202.74598%204.27187%202.925%204.27187H5.625L6.975%202.92188ZM9%2013.0469C8.01538%2013.0469%207.07109%2012.6557%206.37487%2011.9595C5.67864%2011.2633%205.2875%2010.319%205.2875%209.33437C5.2875%208.34976%205.67864%207.40547%206.37487%206.70924C7.07109%206.01301%208.01538%205.62187%209%205.62187C9.98462%205.62187%2010.9289%206.01301%2011.6251%206.70924C12.3214%207.40547%2012.7125%208.34976%2012.7125%209.33437C12.7125%2010.319%2012.3214%2011.2633%2011.6251%2011.9595C10.9289%2012.6557%209.98462%2013.0469%209%2013.0469ZM9%2011.6969C9.62657%2011.6969%2010.2275%2011.448%2010.6705%2011.0049C11.1136%2010.5619%2011.3625%209.96095%2011.3625%209.33437C11.3625%208.7078%2011.1136%208.10689%2010.6705%207.66384C10.2275%207.22078%209.62657%206.97187%209%206.97187C8.37343%206.97187%207.77251%207.22078%207.32946%207.66384C6.88641%208.10689%206.6375%208.7078%206.6375%209.33437C6.6375%209.96095%206.88641%2010.5619%207.32946%2011.0049C7.77251%2011.448%208.37343%2011.6969%209%2011.6969Z'%20fill='%234B5362'/%3e%3c/svg%3e",rt=async({params:a,parent:e})=>{var C;const t=a.idx,l=`/boxes/${t}/detail`,n=t==="-1",r=Re();if(r===null&&!n)return ie(l,{replaceState:!0});if(n)return{box:{idx:"-1",name:"",description:"",image:null,role:null},jwt:r,paramIdx:t};const u=await e();if(u.error)return V.emit("pushSnackbar",{message:"접근할 수 없습니다."}),ie(l,{replaceState:!0});const f=(C=u.data)==null?void 0:C.box;return(f==null?void 0:f.role)!=="owner"?(V.emit("pushSnackbar",{message:"접근할 수 없습니다."}),ie(l,{replaceState:!0})):{box:f,jwt:r,paramIdx:t}},St=Object.freeze(Object.defineProperty({__proto__:null,load:rt},Symbol.toStringTag,{value:"Module"}));function ut(a){let e;return{c(){e=g("div"),this.h()},l(t){e=b(t,"DIV",{class:!0}),B(e).forEach(_),this.h()},h(){p(e,"class","h-[1px] bg-gray-100")},m(t,l){F(t,e,l)},p:z,i:z,o:z,d(t){t&&_(e)}}}class ct extends ke{constructor(e){super(),xe(this,e,null,ut,Be,{})}}function Me(a,e,t){const l=a.slice();return l[6]=e[t],l[8]=t,l}function Ne(a,e){let t,l=e[6]+"",n,r;return{key:a,first:null,c(){t=g("option"),n=ze(l),this.h()},l(u){t=b(u,"OPTION",{});var f=B(t);n=Fe(f,l),f.forEach(_),this.h()},h(){t.__value=r=e[6],pe(t,t.__value),this.first=t},m(u,f){F(u,t,f),d(t,n)},p(u,f){e=u,f&4&&l!==(l=e[6]+"")&&Xe(n,l),f&4&&r!==(r=e[6])&&(t.__value=r,pe(t,t.__value))},d(u){u&&_(t)}}}function ft(a){let e,t=[],l=new Map,n,r,u,f=je(a[2]);const C=s=>s[8];for(let s=0;s<f.length;s+=1){let o=Me(a,f,s),i=C(o);l.set(i,t[s]=Ne(i,o))}return{c(){e=g("select");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=b(s,"SELECT",{class:!0});var o=B(e);for(let i=0;i<t.length;i+=1)t[i].l(o);o.forEach(_),this.h()},h(){p(e,"class",n=`border border-gray-200 rounded-[4.75rem] py-[0.38rem] px-[0.88rem] typo-body3 text-gray-900 bg-gray-100 ${a[1]}`),e.disabled=a[3],a[0]===void 0&&Ge(()=>a[5].call(e))},m(s,o){F(s,e,o);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null);Ie(e,a[0],!0),r||(u=[Z(e,"change",a[5]),Z(e,"change",a[4])],r=!0)},p(s,[o]){o&4&&(f=je(s[2]),t=lt(t,o,C,1,s,f,l,e,nt,Ne,null,Me)),o&2&&n!==(n=`border border-gray-200 rounded-[4.75rem] py-[0.38rem] px-[0.88rem] typo-body3 text-gray-900 bg-gray-100 ${s[1]}`)&&p(e,"class",n),o&8&&(e.disabled=s[3]),o&5&&Ie(e,s[0])},i:z,o:z,d(s){s&&_(e);for(let o=0;o<t.length;o+=1)t[o].d();r=!1,Ve(u)}}}function dt(a,e,t){let{width:l=""}=e,{selected:n=""}=e,{options:r=[]}=e,{disabled:u=!1}=e;Je(()=>{r.length>0&&!n&&t(0,n=r[0])});function f(s){Ke.call(this,a,s)}function C(){n=Qe(this),t(0,n),t(2,r)}return a.$$set=s=>{"width"in s&&t(1,l=s.width),"selected"in s&&t(0,n=s.selected),"options"in s&&t(2,r=s.options),"disabled"in s&&t(3,u=s.disabled)},[n,l,r,u,f,C]}class ht extends ke{constructor(e){super(),xe(this,e,dt,ft,Be,{width:1,selected:0,options:2,disabled:3})}}function pt(a){let e,t="설정";return{c(){e=g("div"),e.textContent=t,this.h()},l(l){e=b(l,"DIV",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-1lcayg1"&&(e.textContent=t),this.h()},h(){p(e,"class","typo-h3 text-gray-900")},m(l,n){F(l,e,n)},p:z,d(l){l&&_(e)}}}function Pe(a){let e,t;return{c(){e=g("img"),this.h()},l(l){e=b(l,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){p(e,"class","w-full h-full object-cover"),$e(e.src,t=Le(a[1].image))||p(e,"src",t),p(e,"alt","box_image")},m(l,n){F(l,e,n)},p(l,n){n&2&&!$e(e.src,t=Le(l[1].image))&&p(e,"src",t)},d(l){l&&_(e)}}}function mt(a){let e,t='박스 이름 <span class="text-red-500">*</span>';return{c(){e=g("p"),e.innerHTML=t,this.h()},l(l){e=b(l,"P",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-mxo9hb"&&(e.innerHTML=t),this.h()},h(){p(e,"class","pb-1 typo-sub-h3 text-gray-500")},m(l,n){F(l,e,n)},p:z,d(l){l&&_(e)}}}function gt(a){let e,t,l,n,r="박스 삭제",u,f,C;return t=new ct({}),{c(){e=g("section"),se(t.$$.fragment),l=E(),n=g("button"),n.textContent=r,this.h()},l(s){e=b(s,"SECTION",{class:!0});var o=B(e);ae(t.$$.fragment,o),l=T(o),n=b(o,"BUTTON",{class:!0,"data-svelte-h":!0}),q(n)!=="svelte-1u6m5al"&&(n.textContent=r),o.forEach(_),this.h()},h(){p(n,"class","py-3 typo-body3 text-red-500"),p(e,"class","w-full mb-28")},m(s,o){F(s,e,o),le(t,e,null),d(e,l),d(e,n),u=!0,f||(C=Z(n,"click",a[14]),f=!0)},p:z,i(s){u||(K(t.$$.fragment,s),u=!0)},o(s){Q(t.$$.fragment,s),u=!1},d(s){s&&_(e),ne(t),f=!1,C()}}}function bt(a){let e,t,l="박스를 정말 삭제할까요?",n,r,u="확인",f,C;return{c(){e=g("div"),t=g("p"),t.textContent=l,n=E(),r=g("button"),r.textContent=u,this.h()},l(s){e=b(s,"DIV",{class:!0});var o=B(e);t=b(o,"P",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-gw0nb6"&&(t.textContent=l),n=T(o),r=b(o,"BUTTON",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-1geai0a"&&(r.textContent=u),o.forEach(_),this.h()},h(){p(t,"class","pb-1 typo-body1 text-gray-300"),p(r,"class","w-full h-14 bg-primary-500 rounded-md text-white disabled:opacity-50"),p(e,"class","px-4")},m(s,o){F(s,e,o),d(e,t),d(e,n),d(e,r),f||(C=Z(r,"click",a[9]),f=!0)},p:z,d(s){s&&_(e),f=!1,C()}}}function _t(a){let e,t,l,n,r,u,f=`<div class="flex flex-row gap-1 items-center"><img src="${ot}" alt="camera icon"/> <p class="typo-body3 text-gray-700">사진 변경</p></div>`,C,s,o,i,R,$,O,k,L,oe="박스 설명",W,D,Y,j,M,re='<p class="pb-1 typo-sub-h3 text-gray-500">박스 공개 설정</p>',ee,S,te,m,x,U,y,v,A,me,ue,ce,ge,N,be,X,_e,Ee;t=new Ye({props:{position:"static",leftBack:"black",$$slots:{default:[pt]},$$scope:{ctx:a}}});let w=a[1].image&&Pe(a);function Ue(c){a[11](c)}let Te={clear:!0,padding:"",border:"border-b-[1.5px] border-b-gray-900 pb-2.5",fontSize:"text-lg",limit:20,onInput:a[7],$$slots:{default:[mt]},$$scope:{ctx:a}};a[1].name!==void 0&&(Te.value=a[1].name),i=new et({props:Te}),Ce.push(()=>we(i,"value",Ue));function Ze(c){a[13](c)}let Oe={width:"w-full",options:Object.keys(a[4])};a[0]!==void 0&&(Oe.selected=a[0]),S=new ht({props:Oe}),Ce.push(()=>we(S,"selected",Ze));let I=!a[5]&&gt(a);function qe(c){a[16](c)}let Ae={onClose:a[15],maxHeight:150,defaultHeight:150,$$slots:{default:[bt]},$$scope:{ctx:a}};return a[3]!==void 0&&(Ae.isOpen=a[3]),N=new it({props:Ae}),Ce.push(()=>we(N,"isOpen",qe)),{c(){e=g("div"),se(t.$$.fragment),l=E(),n=g("section"),w&&w.c(),r=E(),u=g("button"),u.innerHTML=f,C=E(),s=g("section"),o=g("section"),se(i.$$.fragment),$=E(),O=g("div"),k=g("label"),L=g("p"),L.textContent=oe,W=E(),D=g("textarea"),Y=E(),j=g("div"),M=g("lable"),M.innerHTML=re,ee=E(),se(S.$$.fragment),m=E(),x=g("section"),U=E(),I&&I.c(),y=E(),v=g("div"),A=g("button"),me=ze("저장"),ge=E(),se(N.$$.fragment),this.h()},l(c){e=b(c,"DIV",{class:!0});var h=B(e);ae(t.$$.fragment,h),l=T(h),n=b(h,"SECTION",{class:!0});var G=B(n);w&&w.l(G),r=T(G),u=b(G,"BUTTON",{class:!0,"data-svelte-h":!0}),q(u)!=="svelte-o1fuye"&&(u.innerHTML=f),G.forEach(_),C=T(h),s=b(h,"SECTION",{class:!0});var H=B(s);o=b(H,"SECTION",{class:!0});var P=B(o);ae(i.$$.fragment,P),$=T(P),O=b(P,"DIV",{});var J=B(O);k=b(J,"LABEL",{class:!0});var fe=B(k);L=b(fe,"P",{class:!0,"data-svelte-h":!0}),q(L)!=="svelte-1uk7vkf"&&(L.textContent=oe),W=T(fe),D=b(fe,"TEXTAREA",{class:!0}),B(D).forEach(_),fe.forEach(_),J.forEach(_),Y=T(P),j=b(P,"DIV",{});var de=B(j);M=b(de,"LABLE",{class:!0,"data-svelte-h":!0}),q(M)!=="svelte-1cgggel"&&(M.innerHTML=re),ee=T(de),ae(S.$$.fragment,de),de.forEach(_),P.forEach(_),m=T(H),x=b(H,"SECTION",{class:!0}),B(x).forEach(_),U=T(H),I&&I.l(H),H.forEach(_),y=T(h),v=b(h,"DIV",{class:!0});var De=B(v);A=b(De,"BUTTON",{class:!0});var Se=B(A);me=Fe(Se,"저장"),Se.forEach(_),De.forEach(_),ge=T(h),ae(N.$$.fragment,h),h.forEach(_),this.h()},h(){p(u,"class","absolute bottom-4 right-4 bg-white rounded-3xl px-3.5 py-1.5"),p(n,"class","box-image relative w-full h-52 bg-gray-100"),p(L,"class","pb-1 typo-sub-h3 text-gray-500"),p(D,"class","auto-height w-full py-1 focus:ring-0bg-white text-sm svelte-10zrx5e"),p(k,"class","w-full"),p(M,"class","w-full"),p(o,"class","box-name flex flex-col gap-6 py-6"),p(x,"class","w-full min-h-20"),p(s,"class","box-setting px-4"),p(A,"class",ue=He(`w-full ${a[2]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-10zrx5e"),A.disabled=ce=!a[2],p(v,"class","fixed w-full bottom-0 left-0 px-4 pt-3 pb-10 z-10 bg-white upper-box-shadow svelte-10zrx5e"),p(e,"class","min-h-dvh")},m(c,h){F(c,e,h),le(t,e,null),d(e,l),d(e,n),w&&w.m(n,null),d(n,r),d(n,u),d(e,C),d(e,s),d(s,o),le(i,o,null),d(o,$),d(o,O),d(O,k),d(k,L),d(k,W),d(k,D),pe(D,a[1].description),d(o,Y),d(o,j),d(j,M),d(j,ee),le(S,j,null),d(s,m),d(s,x),d(s,U),I&&I.m(s,null),d(e,y),d(e,v),d(v,A),d(A,me),d(e,ge),le(N,e,null),X=!0,_e||(Ee=[Z(u,"click",a[6]),Z(D,"input",a[12]),Z(D,"input",a[7]),Z(A,"click",a[8])],_e=!0)},p(c,[h]){const G={};h&16777216&&(G.$$scope={dirty:h,ctx:c}),t.$set(G),c[1].image?w?w.p(c,h):(w=Pe(c),w.c(),w.m(n,r)):w&&(w.d(1),w=null);const H={};h&16777216&&(H.$$scope={dirty:h,ctx:c}),!R&&h&2&&(R=!0,H.value=c[1].name,ve(()=>R=!1)),i.$set(H),h&2&&pe(D,c[1].description);const P={};!te&&h&1&&(te=!0,P.selected=c[0],ve(()=>te=!1)),S.$set(P),c[5]||I.p(c,h),(!X||h&4&&ue!==(ue=He(`w-full ${c[2]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-10zrx5e"))&&p(A,"class",ue),(!X||h&4&&ce!==(ce=!c[2]))&&(A.disabled=ce);const J={};h&8&&(J.onClose=c[15]),h&16777216&&(J.$$scope={dirty:h,ctx:c}),!be&&h&8&&(be=!0,J.isOpen=c[3],ve(()=>be=!1)),N.$set(J)},i(c){X||(K(t.$$.fragment,c),K(i.$$.fragment,c),K(S.$$.fragment,c),K(I),K(N.$$.fragment,c),X=!0)},o(c){Q(t.$$.fragment,c),Q(i.$$.fragment,c),Q(S.$$.fragment,c),Q(I),Q(N.$$.fragment,c),X=!1},d(c){c&&_(e),ne(t),w&&w.d(),ne(i),ne(S),I&&I.d(),ne(N),_e=!1,Ve(Ee)}}}function Ct(a,e,t){let l;We(a,he,m=>t(19,l=m));const n=`${at}/boxes`,r={"전체 공개":"public","팔로워 공개":"follower",비공개:"private"};let{data:u}=e;const f=u.paramIdx,C=f==="-1";let s=u.jwt,o=u.box,i={...o},R="팔로워 공개";if(i.visibility){for(const[m,x]of Object.entries(r))if(i.visibility===x){R=m;break}}let $=R,O=!1,k=!1;function L(m){t(2,O=m!==R)}async function oe(){var m;try{V.emit("loading",!0);const x=await tt();if(!x.blob)return;const U=await st(x.blob),y=new FormData;y.append("image",U);const v=await fetch(`${n}/image`,{method:"POST",body:y,headers:{Authorization:`Bearer ${s}`}});if(!v.ok)return V.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});const A=await v.json();t(1,i.image=((m=A.data)==null?void 0:m.image)??null,i),t(2,O=!0)}catch{}V.emit("loading",!1)}function W(){t(2,O=!0)}async function D(){if(!O||(t(1,i.name=i.name.trim(),i),!i.name))return;for(const[y,v]of Object.entries(r))if($===y){t(1,i.visibility=v,i);break}const{url:m,method:x}=C?{url:n,method:"POST"}:{url:`${n}/${f}`,method:"PATCH"},U=await fetch(m,{method:x,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({name:i.name,description:i.description,image:i.image,visibility:i.visibility})});if(!U.ok)return V.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});C?(U.json().then(y=>{const v=y.data;v.role="owner",v.visibility=i.visibility,v.is_subcribed=!1,v.place_count="0",v.member_count="1",ye(he,l=[v,...l],l)}),V.emit("pushSnackbar",{message:"새 박스를 만들었습니다"}),ie("/boxes")):(o.name=i.name,o.description=i.description,o.image=i.image,o.visibility=i.visibility,ye(he,l=l.map(y=>(y.idx===i.idx&&(y.name=i.name,y.description=i.description,y.image=i.image,y.visibility=i.visibility),y)),l),V.emit("pushSnackbar",{message:"박스를 수정했습니다."})),t(2,O=!1)}async function Y(){await fetch(`${n}/${f}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),ye(he,l=l.filter(m=>m.idx!==i.idx),l),V.emit("pushSnackbar",{message:`${i.name} 박스를 삭제했습니다.`}),ie("/boxes")}function j(m){a.$$.not_equal(i.name,m)&&(i.name=m,t(1,i))}function M(){i.description=this.value,t(1,i)}function re(m){$=m,t(0,$)}const ee=()=>t(3,k=!0),S=()=>t(3,k=!1);function te(m){k=m,t(3,k)}return a.$$set=m=>{"data"in m&&t(10,u=m.data)},a.$$.update=()=>{a.$$.dirty&1&&L($)},[$,i,O,k,r,C,oe,W,D,Y,u,j,M,re,ee,S,te]}class It extends ke{constructor(e){super(),xe(this,e,Ct,_t,Be,{data:10})}}export{It as component,St as universal};
