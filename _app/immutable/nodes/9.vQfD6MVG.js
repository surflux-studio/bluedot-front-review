import{s as Y,C as Z,D as ee,a as O,g as S,i as x,n as te,f as h,e as H,c as U,b as V,q as j,r as W,h as T,k as pe,B as me,t as re,d as se}from"../chunks/scheduler.Dd3rEL6m.js";import{S as ne,i as oe,e as ae,c as _,b as g,m as b,t as c,a as m,d,f as G,g as J}from"../chunks/index.Dkei3nAf.js";import{U as $e}from"../chunks/UpperBoxes.DkD7scGs.js";import{g as K}from"../chunks/entry.Cctsocsa.js";import{F as ie}from"../chunks/Footer.CyjPyQf_.js";import{H as fe}from"../chunks/Header.Dz6oxG23.js";import{M as _e}from"../chunks/Map.DwjdmaG_.js";import{N as ge}from"../chunks/NavigationBar.BNN2BAnO.js";import{B as L}from"../chunks/Button.CIZZ26YC.js";import{g as be}from"../chunks/searchParams.Bja4WamP.js";import{c as Q,e as q}from"../chunks/sign.C9vOT0h0.js";import{p as de}from"../chunks/stores.4XDN9Wx_.js";import"../chunks/Field.DwtF3OY9.js";/* empty css                                                   *//* empty css                                                   */import"../chunks/map.BXxZz-wM.js";import"../chunks/ImageShaper.Dix5sBHT.js";import"../chunks/heic2any.BN35W5Yp.js";/* empty css                                                            */import{A as he}from"../chunks/ActionSheet.BxQX2vpl.js";import{S as ke}from"../chunks/Search.gIpEtegT.js";import{B as we}from"../chunks/BottomNavigationPadder.3yPoOQLh.js";import{p as xe,b as Be}from"../chunks/boxRequest.DVZWwpvB.js";/* empty css                                                    */function ve(a){let e,r,t,o;return e=new ke({}),t=new we({props:{heightPx:120}}),{c(){_(e.$$.fragment),r=O(),_(t.$$.fragment)},l(s){g(e.$$.fragment,s),r=S(s),g(t.$$.fragment,s)},m(s,i){b(e,s,i),x(s,r,i),b(t,s,i),o=!0},p:te,i(s){o||(c(e.$$.fragment,s),c(t.$$.fragment,s),o=!0)},o(s){m(e.$$.fragment,s),m(t.$$.fragment,s),o=!1},d(s){s&&h(r),d(e,s),d(t,s)}}}function Ce(a){let e,r,t;function o(i){a[1](i)}let s={sheetBackground:"bg-[black]/60 backdrop-blur-sm",$$slots:{default:[ve]},$$scope:{ctx:a}};return a[0]!==void 0&&(s.isOpen=a[0]),e=new he({props:s}),Z.push(()=>ae(e,"isOpen",o)),{c(){_(e.$$.fragment)},l(i){g(e.$$.fragment,i)},m(i,p){b(e,i,p),t=!0},p(i,[p]){const $={};p&4&&($.$$scope={dirty:p,ctx:i}),!r&&p&1&&(r=!0,$.isOpen=i[0],ee(()=>r=!1)),e.$set($)},i(i){t||(c(e.$$.fragment,i),t=!0)},o(i){m(e.$$.fragment,i),t=!1},d(i){d(e,i)}}}function Oe(a,e,r){let{isOpen:t=!1}=e;function o(s){t=s,r(0,t)}return a.$$set=s=>{"isOpen"in s&&r(0,t=s.isOpen)},[t,o]}class Se extends ne{constructor(e){super(),oe(this,e,Oe,Ce,Y,{isOpen:0})}}function ye(a){let e,r;return e=new fe({props:{position:"fixed",rightFeed:!0}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){d(e,t)}}}function Pe(a){let e,r;return e=new fe({props:{position:"fixed",leftBack:!0}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){d(e,t)}}}function X(a){let e,r;return e=new $e({props:{boxes:a[0]}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p(t,o){const s={};o&1&&(s.boxes=t[0]),e.$set(s)},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){d(e,t)}}}function Ne(a){let e,r;return e=new ie({props:{position:"fixed",leftReposition:!0,centerSearch:!0,right:"add"}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p:te,i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){d(e,t)}}}function Ie(a){let e,r;return e=new ie({props:{position:"fixed",bottom:"2rem",$$slots:{default:[Ee]},$$scope:{ctx:a}}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p(t,o){const s={};o&2048&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){d(e,t)}}}function De(a){let e;return{c(){e=re("이 장소가 아니예요")},l(r){e=se(r,"이 장소가 아니예요")},m(r,t){x(r,e,t)},d(r){r&&h(e)}}}function Ae(a){let e;return{c(){e=re("이 장소가 맞아요")},l(r){e=se(r,"이 장소가 맞아요")},m(r,t){x(r,e,t)},d(r){r&&h(e)}}}function Ee(a){let e,r,t,o;return e=new L({props:{backgroundColor:"bg-gray-300",textColor:"text-white",$$slots:{default:[De]},$$scope:{ctx:a}}}),e.$on("click",a[7]),t=new L({props:{backgroundColor:"bg-primary-500",textColor:"text-white",$$slots:{default:[Ae]},$$scope:{ctx:a}}}),t.$on("click",a[4]),{c(){_(e.$$.fragment),r=O(),_(t.$$.fragment)},l(s){g(e.$$.fragment,s),r=S(s),g(t.$$.fragment,s)},m(s,i){b(e,s,i),x(s,r,i),b(t,s,i),o=!0},p(s,i){const p={};i&2048&&(p.$$scope={dirty:i,ctx:s}),e.$set(p);const $={};i&2048&&($.$$scope={dirty:i,ctx:s}),t.$set($)},i(s){o||(c(e.$$.fragment,s),c(t.$$.fragment,s),o=!0)},o(s){m(e.$$.fragment,s),m(t.$$.fragment,s),o=!1},d(s){s&&h(r),d(e,s),d(t,s)}}}function je(a){let e,r,t,o,s,i,p,$,N,k,y,C,I,u,B,v,w,D;const F=[Pe,ye],P=[];function M(n,f){return n[3]==="post"||n[3]==="box"||n[2]?0:1}e=M(a),r=P[e]=F[e](a),s=new _e({props:{onMoveend:a[5]}});let l=a[0].length>0&&X(a);const le=[Ie,Ne],A=[];function ue(n,f){return n[3]==="post"||n[3]==="box"?0:1}y=ue(a),C=A[y]=le[y](a);function ce(n){a[8](n)}let R={};return a[1]!==void 0&&(R.isOpen=a[1]),u=new Se({props:R}),Z.push(()=>ae(u,"isOpen",ce)),w=new ge({props:{show:a[3]!=="post"}}),{c(){r.c(),t=O(),o=H("div"),_(s.$$.fragment),i=O(),p=H("div"),N=O(),l&&l.c(),k=O(),C.c(),I=O(),_(u.$$.fragment),v=O(),_(w.$$.fragment),this.h()},l(n){r.l(n),t=S(n),o=U(n,"DIV",{class:!0});var f=V(o);g(s.$$.fragment,f),i=S(f),p=U(f,"DIV",{class:!0}),V(p).forEach(h),f.forEach(h),N=S(n),l&&l.l(n),k=S(n),C.l(n),I=S(n),g(u.$$.fragment,n),v=S(n),g(w.$$.fragment,n),this.h()},h(){j(p,"class",$=W(`${a[0].length===0&&"hidden"} relative w-full h-48 z-10 top-shadow`)+" svelte-ued265"),j(o,"class","fixed top-0 left-0 w-full h-full")},m(n,f){P[e].m(n,f),x(n,t,f),x(n,o,f),b(s,o,null),T(o,i),T(o,p),x(n,N,f),l&&l.m(n,f),x(n,k,f),A[y].m(n,f),x(n,I,f),b(u,n,f),x(n,v,f),b(w,n,f),D=!0},p(n,[f]){let E=e;e=M(n),e!==E&&(J(),m(P[E],1,1,()=>{P[E]=null}),G(),r=P[e],r||(r=P[e]=F[e](n),r.c()),c(r,1),r.m(t.parentNode,t)),(!D||f&1&&$!==($=W(`${n[0].length===0&&"hidden"} relative w-full h-48 z-10 top-shadow`)+" svelte-ued265"))&&j(p,"class",$),n[0].length>0?l?(l.p(n,f),f&1&&c(l,1)):(l=X(n),l.c(),c(l,1),l.m(k.parentNode,k)):l&&(J(),m(l,1,1,()=>{l=null}),G()),C.p(n,f);const z={};!B&&f&2&&(B=!0,z.isOpen=n[1],ee(()=>B=!1)),u.$set(z)},i(n){D||(c(r),c(s.$$.fragment,n),c(l),c(C),c(u.$$.fragment,n),c(w.$$.fragment,n),D=!0)},o(n){m(r),m(s.$$.fragment,n),m(l),m(C),m(u.$$.fragment,n),m(w.$$.fragment,n),D=!1},d(n){n&&(h(t),h(o),h(N),h(k),h(I),h(v)),P[e].d(n),d(s),l&&l.d(n),A[y].d(n),d(u,n),d(w,n)}}}function qe(a,e,r){let t,o;pe(a,de,u=>r(6,o=u));let s=[];const i=o.url.searchParams.get("type"),p=o.url.searchParams.get("tags");p&&Q.set(p.split(","));let $=!1;q.on("openSearch",()=>{r(1,$=!0)}),q.on("closeSearch",()=>{r(1,$=!1)}),me(()=>{Q.set([])});async function N(){if(i==="box"){const u=o.url.searchParams.get("boxIdx"),B=Number(o.url.searchParams.get("boxIdx")),v=sessionStorage.getItem("jwt"),w=o.url.searchParams.get("placeIdx");if(Number.isNaN(B)||!u||!v||!w)return K("/boxes");(await xe(v,u,w)).ok||q.emit("pushSnackbar",{message:"장소 추가에 실패했습니다."}),K(`/boxes/${u}/detail`)}else i==="post"&&be("/viewer/edit")}let k;async function y(u){try{k&&k.abort("new request"),k=new AbortController;const B=await Be(u,k);if(!B.ok)return;const v=await B.json();r(0,s=v.data)}catch{}}const C=()=>window.history.back();function I(u){$=u,r(1,$)}return a.$$.update=()=>{a.$$.dirty&64&&r(2,t=o.url.searchParams.get("withBack")==="true")},[s,$,t,i,N,y,o,C,I]}class it extends ne{constructor(e){super(),oe(this,e,qe,je,Y,{})}}export{it as component};
