import{I as V,d as Oe,l as me,A as pe,e as Se}from"../chunks/store.Cd2LbFPE.js";import{s as oe,m as Te,e as A,c as P,b as Y,f as h,v as g,J as de,i as j,A as B,H as Z,G as Ie,u as Ae,o as Pe,p as je,F as we,I as ne,$ as ee,w as Ee,a as X,T as Me,g as Q,h as J,x as ve,k as te,y as Le,B as ye,D as _e,n as W}from"../chunks/scheduler.BS-S8op5.js";import{S as se,i as ie,t as w,a as O,c as D,d as F,m as q,f as z,b as $e,e as he,g as ge}from"../chunks/index.CxHkUi4z.js";import{H as Ce}from"../chunks/Header.CEhmEFso.js";import{V as Ne}from"../chunks/Viewer.DM4KZ2BY.js";import{p as Re}from"../chunks/stores.UwhcWCV_.js";import{N as Ve}from"../chunks/NavigationBar.Or02YSO2.js";import"../chunks/device.BmvLoMs_.js";import"../chunks/ActionSheet.svelte_svelte_type_style_lang.D8mqBr4A.js";/* empty css                                                   */import{g as Be}from"../chunks/entry._OD5CP8F.js";import"../chunks/emitter.E5P-NQ8u.js";import{g as De}from"../chunks/sign.DzAuSUd6.js";/* empty css                                                   */import{P as Fe}from"../chunks/picker.DO1g6OCe.js";import{I as qe}from"../chunks/IconSearch.BNWNFtdy.js";import{A as ze}from"../chunks/ActionSheetOpenApp.CccFDClX.js";import{s as be}from"../chunks/s32cloudfront.DM69o-3i.js";import{i as Ge}from"../chunks/isVideoFile.DGBlGWVm.js";function He(o){let e,n,t,i,c;const f=o[5].default,a=Te(f,o,o[4],null);return{c(){e=A("div"),a&&a.c(),this.h()},l(r){e=P(r,"DIV",{id:!0,class:!0,"aria-hidden":!0});var u=Y(e);a&&a.l(u),u.forEach(h),this.h()},h(){g(e,"id","mask"),g(e,"class",n=de(`${o[0]?"":"hidden"} ${o[1]}`)+" svelte-eerk6g"),g(e,"aria-hidden","")},m(r,u){j(r,e,u),a&&a.m(e,null),t=!0,i||(c=[B(e,"touchstart",Z(Ie(o[6]))),B(e,"touchend",o[7],{passive:!0}),B(e,"click",o[8])],i=!0)},p(r,[u]){a&&a.p&&(!t||u&16)&&Ae(a,f,r,r[4],t?je(f,r[4],u,null):Pe(r[4]),null),(!t||u&3&&n!==(n=de(`${r[0]?"":"hidden"} ${r[1]}`)+" svelte-eerk6g"))&&g(e,"class",n)},i(r){t||(w(a,r),t=!0)},o(r){O(a,r),t=!1},d(r){r&&h(e),a&&a.d(r),i=!1,we(c)}}}function Je(o,e,n){let{$$slots:t={},$$scope:i}=e,{onMask:c=!1}=e,{position:f="fixed"}=e,{closeOnClick:a=!1}=e,{onTouch:r=void 0}=e;function u(p){ne.call(this,o,p)}const _=()=>{a?n(0,c=!1):r&&r()},M=()=>{a?n(0,c=!1):r&&r()};return o.$$set=p=>{"onMask"in p&&n(0,c=p.onMask),"position"in p&&n(1,f=p.position),"closeOnClick"in p&&n(2,a=p.closeOnClick),"onTouch"in p&&n(3,r=p.onTouch),"$$scope"in p&&n(4,i=p.$$scope)},[c,f,a,r,i,t,u,_,M]}class Ue extends se{constructor(e){super(),ie(this,e,Je,He,oe,{onMask:0,position:1,closeOnClick:2,onTouch:3})}}function Ke(o){let e,n,t;return{c(){e=A("emoji-picker"),this.h()},l(i){e=P(i,"EMOJI-PICKER",{"aria-hidden":!0,class:!0}),Y(e).forEach(h),this.h()},h(){ee(e,"aria-hidden",""),ee(e,"class",o[0])},m(i,c){j(i,e,c),n||(t=[B(e,"emoji-click",Z(Ie(o[2]))),B(e,"touchstart",Z(o[4])),B(e,"touchend",Z(o[5]))],n=!0)},p(i,c){c&1&&ee(e,"class",i[0])},d(i){i&&h(e),n=!1,we(t)}}}function Xe(o){let e,n;return e=new Ue({props:{onMask:!0,position:"absolute",onTouch:o[6],$$slots:{default:[Ke]},$$scope:{ctx:o}}}),{c(){D(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){q(e,t,i),n=!0},p(t,[i]){const c={};i&2&&(c.onTouch=t[6]),i&257&&(c.$$scope={dirty:i,ctx:t}),e.$set(c)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function Qe(o,e,n){let{classList:t}=e,{onSelect:i}=e,{close:c}=e;function f(_){i(_.detail.unicode)}new Fe({emojiVersion:15});function a(_){ne.call(this,o,_)}function r(_){ne.call(this,o,_)}const u=()=>{c()};return o.$$set=_=>{"classList"in _&&n(0,t=_.classList),"onSelect"in _&&n(3,i=_.onSelect),"close"in _&&n(1,c=_.close)},[t,c,f,i,a,r,u]}class We extends se{constructor(e){super(),ie(this,e,Qe,Xe,oe,{classList:0,onSelect:3,close:1})}}function Ye(o){let e,n,t,i,c,f;return t=new qe({props:{width:"24",height:"24"}}),{c(){e=A("div"),n=A("button"),D(t.$$.fragment),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=Y(e);n=P(r,"BUTTON",{});var u=Y(n);F(t.$$.fragment,u),u.forEach(h),r.forEach(h),this.h()},h(){g(e,"class","flex items-center gap-2")},m(a,r){j(a,e,r),J(e,n),q(t,n,null),i=!0,c||(f=B(n,"click",o[10]),c=!0)},i(a){i||(w(t.$$.fragment,a),i=!0)},o(a){O(t.$$.fragment,a),i=!1},d(a){a&&h(e),z(t),c=!1,f()}}}function Ze(o){let e,n,t=!V&&Ye(o);return{c(){t&&t.c(),e=_e()},l(i){t&&t.l(i),e=_e()},m(i,c){t&&t.m(i,c),j(i,e,c),n=!0},p:W,i(i){n||(w(t),n=!0)},o(i){O(t),n=!1},d(i){i&&h(e),t&&t.d(i)}}}function xe(o){let e,n,t;function i(f){o[12](f)}let c={posts:o[0].posts,selectedReaction:o[2],whenCancelForExternalLink:o[11]};return o[0].index!==void 0&&(c.index=o[0].index),e=new Ne({props:c}),Ee.push(()=>$e(e,"index",i)),{c(){D(e.$$.fragment)},l(f){F(e.$$.fragment,f)},m(f,a){q(e,f,a),t=!0},p(f,a){const r={};a&1&&(r.posts=f[0].posts),a&4&&(r.selectedReaction=f[2]),a&8&&(r.whenCancelForExternalLink=f[11]),!n&&a&1&&(n=!0,r.index=f[0].index,ve(()=>n=!1)),e.$set(r)},i(f){t||(w(e.$$.fragment,f),t=!0)},o(f){O(e.$$.fragment,f),t=!1},d(f){z(e,f)}}}function et(o){let e;return{c(){e=A("div"),this.h()},l(n){e=P(n,"DIV",{class:!0}),Y(e).forEach(h),this.h()},h(){g(e,"class","w-full h-full")},m(n,t){j(n,e,t)},p:W,i:W,o:W,d(n){n&&h(e)}}}function tt(o){let e,n;return e=new Ve({}),{c(){D(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){q(e,t,i),n=!0},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function ke(o){let e,n;return e=new We({props:{classList:"absolute bottom-24 right-0 px-4 z-50",onSelect:o[6],close:o[13]}}),{c(){D(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){q(e,t,i),n=!0},p:W,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){O(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function nt(o){var b;let e,n,t,i,c,f,a,r,u,_,M,p,T,E,v,y,G,C,S,U,m;document.title=e=((b=o[1])==null?void 0:b.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다",p=new Ce({props:{position:"fixed",leftLogo:V||o[4],leftBack:!V&&!o[4]?"white":"",$$slots:{right:[Ze]},$$scope:{ctx:o}}});const $=[et,xe],k=[];function N(s,l){return s[0].posts.length===0?0:1}E=N(o),v=k[E]=$[E](o);let I=!V&&tt(),d=o[5]&&ke(o);function x(s){o[14](s)}let L={};return o[3]!==void 0&&(L.isOpen=o[3]),S=new ze({props:L}),Ee.push(()=>$e(S,"isOpen",x)),{c(){n=A("meta"),i=A("meta"),c=A("meta"),a=A("meta"),u=A("meta"),M=X(),D(p.$$.fragment),T=X(),v.c(),y=X(),I&&I.c(),G=X(),d&&d.c(),C=X(),D(S.$$.fragment),this.h()},l(s){const l=Me("svelte-xd8vjm",document.head);n=P(l,"META",{property:!0,content:!0}),i=P(l,"META",{property:!0,content:!0}),c=P(l,"META",{property:!0,content:!0}),a=P(l,"META",{property:!0,content:!0}),u=P(l,"META",{property:!0,content:!0}),l.forEach(h),M=Q(s),F(p.$$.fragment,s),T=Q(s),v.l(s),y=Q(s),I&&I.l(s),G=Q(s),d&&d.l(s),C=Q(s),F(S.$$.fragment,s),this.h()},h(){var s,l,R,H,K;g(n,"property","og:title"),g(n,"content",t=`블루닷 - ${((s=o[1])==null?void 0:s.unique_name)??"bluedot"} 님 게시물`),g(i,"property","og:url"),g(i,"content",`https://bluedot.land${location.pathname}${location.search}`),g(c,"property","og:image"),g(c,"content",f=((l=o[1])==null?void 0:l.image)??""),g(a,"property","og:image:alt"),g(a,"content",r=((R=o[1])==null?void 0:R.place_name)??""),g(u,"property","og:description"),g(u,"content",_=((H=o[1])==null?void 0:H.text)??((K=o[1])==null?void 0:K.place_name)??"")},m(s,l){J(document.head,n),J(document.head,i),J(document.head,c),J(document.head,a),J(document.head,u),j(s,M,l),q(p,s,l),j(s,T,l),k[E].m(s,l),j(s,y,l),I&&I.m(s,l),j(s,G,l),d&&d.m(s,l),j(s,C,l),q(S,s,l),m=!0},p(s,[l]){var ae,re,le,ce,fe,ue;(!m||l&2)&&e!==(e=((ae=s[1])==null?void 0:ae.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다")&&(document.title=e),(!m||l&2&&t!==(t=`블루닷 - ${((re=s[1])==null?void 0:re.unique_name)??"bluedot"} 님 게시물`))&&g(n,"content",t),(!m||l&2&&f!==(f=((le=s[1])==null?void 0:le.image)??""))&&g(c,"content",f),(!m||l&2&&r!==(r=((ce=s[1])==null?void 0:ce.place_name)??""))&&g(a,"content",r),(!m||l&2&&_!==(_=((fe=s[1])==null?void 0:fe.text)??((ue=s[1])==null?void 0:ue.place_name)??""))&&g(u,"content",_);const R={};l&16&&(R.leftLogo=V||s[4]),l&16&&(R.leftBack=!V&&!s[4]?"white":""),l&262144&&(R.$$scope={dirty:l,ctx:s}),p.$set(R);let H=E;E=N(s),E===H?k[E].p(s,l):(ge(),O(k[H],1,1,()=>{k[H]=null}),he(),v=k[E],v?v.p(s,l):(v=k[E]=$[E](s),v.c()),w(v,1),v.m(y.parentNode,y)),s[5]?d?(d.p(s,l),l&32&&w(d,1)):(d=ke(s),d.c(),w(d,1),d.m(C.parentNode,C)):d&&(ge(),O(d,1,1,()=>{d=null}),he());const K={};!U&&l&8&&(U=!0,K.isOpen=s[3],ve(()=>U=!1)),S.$set(K)},i(s){m||(w(p.$$.fragment,s),w(v),w(I),w(d),w(S.$$.fragment,s),m=!0)},o(s){O(p.$$.fragment,s),O(v),O(I),O(d),O(S.$$.fragment,s),m=!1},d(s){s&&(h(M),h(T),h(y),h(G),h(C)),h(n),h(i),h(c),h(a),h(u),z(p,s),k[E].d(s),I&&I.d(s),d&&d.d(s),z(S,s)}}}function ot(o,e,n){let t,i,c,f,a,r;te(o,Re,m=>n(9,f=m)),te(o,Oe,m=>n(16,a=m)),te(o,me,m=>n(5,r=m));let u={posts:[],index:0},_,M,p=!1,T;Le(async()=>{let m="";try{m=De()}catch{}const $=new URLSearchParams(window.location.search),k=Number($.get("postIdx")||0);Number($.get("mediaIdx")||0);const N=0,I=30,d=`&offset=${N}`,x=`&limit=${I}`;let L=[];(i||t)&&a.length>0?(L=a.map(b=>b.idx===k?{...b,mediaIdx:b.mediaIdx||0}:{...b,mediaIdx:0}),n(0,u.index=L.findIndex(b=>b.idx===String(k)),u)):(T=new AbortController,k&&(L=[await fetch(`${pe}/posts/${k}`,{method:"GET",headers:{Authorization:"Bearer "+m},signal:T.signal}).then(b=>b.json()).then(b=>({...b.data,mediaIdx:b.data.mediaIdx||0}))]),L=[...L,...await fetch(`${pe}/posts?${d}${x}`,{method:"GET",headers:{Authorization:"Bearer "+m},signal:T.signal}).then(b=>b.json()).then(b=>{var s;return(s=b.data)==null?void 0:s.posts.filter(l=>l.idx!==String(k)).map(l=>({...l,mediaIdx:l.mediaIdx||0}))})||[]]),n(0,u.posts=L,u)}),ye(()=>{T&&T.abort()});async function E(m){const $=f.url.searchParams.get("postIdx");$&&n(2,M={postIdx:$,reaction:m})}async function v(m){var k;let $=(k=u.posts)==null?void 0:k.at(m);if($){let N=$.media[0];if(N){const I=be(N);if(I.includes("youtu"))$.image=I;else{const d=await Ge(I);$.image=d?be(N+"-thumbnail"):I}}}n(1,_=$)}const y=async()=>{await Be("/search")},G=()=>{if(V)return n(3,p=!0)};function C(m){o.$$.not_equal(u.index,m)&&(u.index=m,n(0,u))}const S=()=>{me.set(!1)};function U(m){p=m,n(3,p)}return o.$$.update=()=>{o.$$.dirty&512&&n(7,t=f.url.searchParams.get("placeIdx")),o.$$.dirty&512&&n(8,i=f.url.searchParams.get("userIdx")),o.$$.dirty&384&&n(4,c=!t&&!i),o.$$.dirty&1&&v(u.index)},[u,_,M,p,c,r,E,t,i,f,y,G,C,S,U]}class $t extends se{constructor(e){super(),ie(this,e,ot,nt,oe,{})}}function st(){Se.set(!0)}const Ot=Object.freeze(Object.defineProperty({__proto__:null,load:st},Symbol.toStringTag,{value:"Module"}));export{$t as component,Ot as universal};
