import{e as Z}from"../chunks/index.g5YcAAdQ.js";import{b as te,A as re,g as se,e as T}from"../chunks/sign.CdrvQ_fB.js";import{s as ae,e as p,a as N,c as g,b,f as m,g as S,B as L,v as r,N as ee,i as P,h as i,O as z,A as V,F as le,t as ne,d as ue,q as R,r as K}from"../chunks/scheduler.CCBjAsUD.js";import{S as ie,i as oe,c as ce,b as fe,m as de,t as me,a as he,d as pe}from"../chunks/index.svcsDwjp.js";import{g as ge}from"../chunks/entry.DjYdOaZy.js";import{H as _e}from"../chunks/Header.CngaPL2S.js";import{g as Ce,u as ve}from"../chunks/photo.rS_FaKbg.js";const be=async({params:n,fetch:t,depends:e})=>{if(String(n.idx)!==String(te()))throw Z(403,"Forbidden");const o=(await(await t(`${re}/auth/users/${n.idx}`,{headers:{Authorization:`Bearer ${se()}`}})).json()).data;if(!(o!=null&&o.idx))throw Z(404,"User not found");return{user:o}},$e=Object.freeze(Object.defineProperty({__proto__:null,load:be},Symbol.toStringTag,{value:"Module"}));function Be(n){let t;return{c(){t=ne("완료")},l(e){t=ue(e,"완료")},m(e,s){P(e,t,s)},d(e){e&&m(t)}}}function ye(n){let t,e,s;return{c(){t=R("svg"),e=R("circle"),s=R("path"),this.h()},l(l){t=K(l,"svg",{class:!0,viewBox:!0});var o=b(t);e=K(o,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),b(e).forEach(m),s=K(o,"path",{class:!0,fill:!0,d:!0}),b(s).forEach(m),o.forEach(m),this.h()},h(){r(e,"class","opacity-25"),r(e,"cx","12"),r(e,"cy","12"),r(e,"r","10"),r(e,"stroke","currentColor"),r(e,"stroke-width","4"),r(e,"fill","none"),r(s,"class","opacity-75"),r(s,"fill","currentColor"),r(s,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),r(t,"class","animate-spin h-5 w-5 mr-3 text-white"),r(t,"viewBox","0 0 24 24")},m(l,o){P(l,t,o),i(t,e),i(t,s)},d(l){l&&m(t)}}}function xe(n){let t,e,s,l,o;function h(a,_){return a[3]?ye:Be}let f=h(n),u=f(n);return{c(){t=p("span"),e=p("button"),u.c(),this.h()},l(a){t=g(a,"SPAN",{slot:!0,class:!0});var _=b(t);e=g(_,"BUTTON",{});var k=b(e);u.l(k),k.forEach(m),_.forEach(m),this.h()},h(){e.disabled=n[3],r(t,"slot","right"),r(t,"class",s=`
        text-sm leading-[1.0625rem] font-medium 
        ${n[4]?"text-white":"text-[#3f3f3f]"}
      `)},m(a,_){P(a,t,_),i(t,e),u.m(e,null),l||(o=V(e,"click",n[5]),l=!0)},p(a,_){f!==(f=h(a))&&(u.d(1),u=f(a),u&&(u.c(),u.m(e,null))),_&8&&(e.disabled=a[3]),_&16&&s!==(s=`
        text-sm leading-[1.0625rem] font-medium 
        ${a[4]?"text-white":"text-[#3f3f3f]"}
      `)&&r(t,"class",s)},d(a){a&&m(t),u.d(),l=!1,o()}}}function we(n){let t,e,s,l,o,h,f,u,a,_,k,y,q='<svg class="w-4 h-4 text-gray-600 dark:text-gray-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',A,d,C,x,Q="이메일(변경 불가)",M,B,H,D,E,W="닉네임",J,w,$,G,X;return l=new _e({props:{position:"static",leftBack:"white",centerTitle:"프로필 편집",$$slots:{right:[xe]},$$scope:{ctx:n}}}),{c(){t=p("div"),e=N(),s=p("div"),ce(l.$$.fragment),o=N(),h=p("main"),f=p("div"),u=p("div"),a=p("img"),k=N(),y=p("button"),y.innerHTML=q,A=N(),d=p("div"),C=p("div"),x=p("span"),x.textContent=Q,M=N(),B=p("input"),H=N(),D=p("div"),E=p("span"),E.textContent=W,J=N(),w=p("input"),this.h()},l(c){t=g(c,"DIV",{class:!0}),b(t).forEach(m),e=S(c),s=g(c,"DIV",{class:!0});var v=b(s);fe(l.$$.fragment,v),o=S(v),h=g(v,"MAIN",{class:!0});var I=b(h);f=g(I,"DIV",{class:!0});var Y=b(f);u=g(Y,"DIV",{class:!0});var O=b(u);a=g(O,"IMG",{class:!0,src:!0,alt:!0}),k=S(O),y=g(O,"BUTTON",{class:!0,"data-svelte-h":!0}),L(y)!=="svelte-s766w9"&&(y.innerHTML=q),O.forEach(m),Y.forEach(m),A=S(I),d=g(I,"DIV",{class:!0});var U=b(d);C=g(U,"DIV",{class:!0});var F=b(C);x=g(F,"SPAN",{class:!0,"data-svelte-h":!0}),L(x)!=="svelte-1gfnk3z"&&(x.textContent=Q),M=S(F),B=g(F,"INPUT",{type:!0,class:!0}),F.forEach(m),H=S(U),D=g(U,"DIV",{class:!0});var j=b(D);E=g(j,"SPAN",{class:!0,"data-svelte-h":!0}),L(E)!=="svelte-2npwwy"&&(E.textContent=W),J=S(j),w=g(j,"INPUT",{type:!0,class:!0,placeholder:!0}),j.forEach(m),U.forEach(m),I.forEach(m),v.forEach(m),this.h()},h(){r(t,"class","fixed w-full h-full bg-black -z-10"),r(a,"class","w-24 h-24 rounded-full object-cover border border-gray-200 dark:border-gray-700"),ee(a.src,_=n[1])||r(a,"src",_),r(a,"alt","Profile Image"),r(y,"class","absolute bottom-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full p-2 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-sm"),r(u,"class","relative"),r(f,"class","flex justify-center my-3.5"),r(x,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),r(B,"type","text"),r(B,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),B.readOnly=!0,B.disabled=!0,r(C,"class","flex items-center gap-3"),r(E,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),r(w,"type","text"),r(w,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),r(w,"placeholder","mynickname"),r(D,"class","flex items-center gap-3"),r(d,"class","flex flex-col gap-2.5"),r(h,"class","flex-1 px-5"),r(s,"class","flex flex-col min-h-screen text-white")},m(c,v){P(c,t,v),P(c,e,v),P(c,s,v),de(l,s,null),i(s,o),i(s,h),i(h,f),i(f,u),i(u,a),i(u,k),i(u,y),i(h,A),i(h,d),i(d,C),i(C,x),i(C,M),i(C,B),z(B,n[2].email),i(d,H),i(d,D),i(D,E),i(D,J),i(D,w),z(w,n[0]),$=!0,G||(X=[V(y,"click",n[6]),V(B,"input",n[8]),V(w,"input",n[9])],G=!0)},p(c,[v]){const I={};v&4120&&(I.$$scope={dirty:v,ctx:c}),l.$set(I),(!$||v&2&&!ee(a.src,_=c[1]))&&r(a,"src",_),v&4&&B.value!==c[2].email&&z(B,c[2].email),v&1&&w.value!==c[0]&&z(w,c[0])},i(c){$||(me(l.$$.fragment,c),$=!0)},o(c){he(l.$$.fragment,c),$=!1},d(c){c&&(m(t),m(e),m(s)),pe(l),G=!1,le(X)}}}function ke(n,t,e){let s,{data:l}=t,o=l.user,{user:h}=JSON.parse(JSON.stringify(l)),f=h.unique_name||"",u=h.profile_image_url||"",a=!1;function _(){return s?f.trim()?/^[a-z0-9._]{1,30}$/.test(f)?!0:(T.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(T.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1):!1}async function k(){if(_())try{e(3,a=!0);const d=te(),C=await fetch(`${re}/auth/users/${d}`,{method:"PATCH",headers:{Authorization:`Bearer ${se()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:f,profileImage:u})});if(C.ok)T.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),ge(`/users/${d}`);else{const x=await C.json();console.error(x),T.emit("pushSnackbar",{message:x.message||"프로필 수정에 실패했습니다."})}}catch(d){console.error(d),T.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}finally{e(3,a=!1)}}async function y(){const d=await Ce({limit:1}),C=await ve(d);C[0]&&e(1,u=C[0])}function q(){h.email=this.value,e(2,h)}function A(){f=this.value,e(0,f)}return n.$$set=d=>{"data"in d&&e(7,l=d.data)},n.$$.update=()=>{n.$$.dirty&3&&e(4,s=f!==o.unique_name||u!==o.profile_image_url)},[f,u,h,a,s,k,y,l,q,A]}class Te extends ie{constructor(t){super(),oe(this,t,ke,we,ae,{data:7})}}export{Te as component,$e as universal};
