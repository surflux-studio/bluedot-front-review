import{s as oe,m as $e,e as S,c as M,b as Y,f as h,v as g,J as me,i as P,A as V,H as x,G as be,u as Ae,o as Te,p as Oe,F as Ie,I as ne,T as ee,w as we,a as X,U as Se,g as Q,h as J,x as Ee,k as te,y as Me,B as Pe,D as pe,n as W}from"../chunks/scheduler.DnGlJ4RW.js";import{S as se,i as ie,t as I,a as v,c as D,d as q,m as z,f as F,b as ve,e as de,g as _e}from"../chunks/index.D2MnZ5yf.js";import{H as je}from"../chunks/Header.BeZkuJ-P.js";import{V as Le}from"../chunks/Viewer.f-EhFio8.js";import{p as Ce}from"../chunks/stores.DDZyFrf2.js";import{N as Ne}from"../chunks/NavigationBar.BA1IEH1u.js";import"../chunks/device.DmbpZ0Kj.js";import"../chunks/ActionSheet.svelte_svelte_type_style_lang.CW5ZFWVc.js";/* empty css                                                   */import{I as R,d as ye,e as he,A as ge}from"../chunks/store.Dje2BmG1.js";import{g as Be}from"../chunks/entry.D5x7lc6a.js";import"../chunks/emitter.E5P-NQ8u.js";import{g as Re}from"../chunks/sign.B2Xkeh8q.js";/* empty css                                                   */import{P as Ve}from"../chunks/picker.DO1g6OCe.js";import{I as De}from"../chunks/IconSearch.BfoE4IIP.js";import{A as qe}from"../chunks/ActionSheetOpenApp.Dxtt-QfO.js";function ze(o){let e,n,t,i,l;const c=o[5].default,a=$e(c,o,o[4],null);return{c(){e=S("div"),a&&a.c(),this.h()},l(r){e=M(r,"DIV",{id:!0,class:!0,"aria-hidden":!0});var u=Y(e);a&&a.l(u),u.forEach(h),this.h()},h(){g(e,"id","mask"),g(e,"class",n=me(`${o[0]?"":"hidden"} ${o[1]}`)+" svelte-eerk6g"),g(e,"aria-hidden","")},m(r,u){P(r,e,u),a&&a.m(e,null),t=!0,i||(l=[V(e,"touchstart",x(be(o[6]))),V(e,"touchend",o[7],{passive:!0}),V(e,"click",o[8])],i=!0)},p(r,[u]){a&&a.p&&(!t||u&16)&&Ae(a,c,r,r[4],t?Oe(c,r[4],u,null):Te(r[4]),null),(!t||u&3&&n!==(n=me(`${r[0]?"":"hidden"} ${r[1]}`)+" svelte-eerk6g"))&&g(e,"class",n)},i(r){t||(I(a,r),t=!0)},o(r){v(a,r),t=!1},d(r){r&&h(e),a&&a.d(r),i=!1,Ie(l)}}}function Fe(o,e,n){let{$$slots:t={},$$scope:i}=e,{onMask:l=!1}=e,{position:c="fixed"}=e,{closeOnClick:a=!1}=e,{onTouch:r=void 0}=e;function u(m){ne.call(this,o,m)}const d=()=>{a?n(0,l=!1):r&&r()},j=()=>{a?n(0,l=!1):r&&r()};return o.$$set=m=>{"onMask"in m&&n(0,l=m.onMask),"position"in m&&n(1,c=m.position),"closeOnClick"in m&&n(2,a=m.closeOnClick),"onTouch"in m&&n(3,r=m.onTouch),"$$scope"in m&&n(4,i=m.$$scope)},[l,c,a,r,i,t,u,d,j]}class Ge extends se{constructor(e){super(),ie(this,e,Fe,ze,oe,{onMask:0,position:1,closeOnClick:2,onTouch:3})}}function He(o){let e,n,t;return{c(){e=S("emoji-picker"),this.h()},l(i){e=M(i,"EMOJI-PICKER",{"aria-hidden":!0,class:!0}),Y(e).forEach(h),this.h()},h(){ee(e,"aria-hidden",""),ee(e,"class",o[0])},m(i,l){P(i,e,l),n||(t=[V(e,"emoji-click",x(be(o[2]))),V(e,"touchstart",x(o[4])),V(e,"touchend",x(o[5]))],n=!0)},p(i,l){l&1&&ee(e,"class",i[0])},d(i){i&&h(e),n=!1,Ie(t)}}}function Je(o){let e,n;return e=new Ge({props:{onMask:!0,position:"absolute",onTouch:o[6],$$slots:{default:[He]},$$scope:{ctx:o}}}),{c(){D(e.$$.fragment)},l(t){q(e.$$.fragment,t)},m(t,i){z(e,t,i),n=!0},p(t,[i]){const l={};i&2&&(l.onTouch=t[6]),i&257&&(l.$$scope={dirty:i,ctx:t}),e.$set(l)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Ue(o,e,n){let{classList:t}=e,{onSelect:i}=e,{close:l}=e;function c(d){i(d.detail.unicode)}new Ve({emojiVersion:15});function a(d){ne.call(this,o,d)}function r(d){ne.call(this,o,d)}const u=()=>{l()};return o.$$set=d=>{"classList"in d&&n(0,t=d.classList),"onSelect"in d&&n(3,i=d.onSelect),"close"in d&&n(1,l=d.close)},[t,l,c,i,a,r,u]}class Ke extends se{constructor(e){super(),ie(this,e,Ue,Je,oe,{classList:0,onSelect:3,close:1})}}function Xe(o){let e,n,t,i,l,c;return t=new De({props:{width:"24",height:"24"}}),{c(){e=S("div"),n=S("button"),D(t.$$.fragment),this.h()},l(a){e=M(a,"DIV",{class:!0});var r=Y(e);n=M(r,"BUTTON",{});var u=Y(n);q(t.$$.fragment,u),u.forEach(h),r.forEach(h),this.h()},h(){g(e,"class","flex items-center gap-2")},m(a,r){P(a,e,r),J(e,n),z(t,n,null),i=!0,l||(c=V(n,"click",o[10]),l=!0)},i(a){i||(I(t.$$.fragment,a),i=!0)},o(a){v(t.$$.fragment,a),i=!1},d(a){a&&h(e),F(t),l=!1,c()}}}function Qe(o){let e,n,t=!R&&Xe(o);return{c(){t&&t.c(),e=pe()},l(i){t&&t.l(i),e=pe()},m(i,l){t&&t.m(i,l),P(i,e,l),n=!0},p:W,i(i){n||(I(t),n=!0)},o(i){v(t),n=!1},d(i){i&&h(e),t&&t.d(i)}}}function We(o){let e,n,t;function i(c){o[12](c)}let l={posts:o[0].posts,selectedReaction:o[2],whenCancelForExternalLink:o[11]};return o[0].index!==void 0&&(l.index=o[0].index),e=new Le({props:l}),we.push(()=>ve(e,"index",i)),{c(){D(e.$$.fragment)},l(c){q(e.$$.fragment,c)},m(c,a){z(e,c,a),t=!0},p(c,a){const r={};a&1&&(r.posts=c[0].posts),a&4&&(r.selectedReaction=c[2]),a&8&&(r.whenCancelForExternalLink=c[11]),!n&&a&1&&(n=!0,r.index=c[0].index,Ee(()=>n=!1)),e.$set(r)},i(c){t||(I(e.$$.fragment,c),t=!0)},o(c){v(e.$$.fragment,c),t=!1},d(c){F(e,c)}}}function Ye(o){let e;return{c(){e=S("div"),this.h()},l(n){e=M(n,"DIV",{class:!0}),Y(e).forEach(h),this.h()},h(){g(e,"class","w-full h-full")},m(n,t){P(n,e,t)},p:W,i:W,o:W,d(n){n&&h(e)}}}function Ze(o){let e,n;return e=new Ne({}),{c(){D(e.$$.fragment)},l(t){q(e.$$.fragment,t)},m(t,i){z(e,t,i),n=!0},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function ke(o){let e,n;return e=new Ke({props:{classList:"absolute bottom-24 right-0 px-4 z-50",onSelect:o[6],close:o[13]}}),{c(){D(e.$$.fragment)},l(t){q(e.$$.fragment,t)},m(t,i){z(e,t,i),n=!0},p:W,i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function xe(o){var U;let e,n,t,i,l,c,a,r,u,d,j,m,T,w,E,L,G,C,A,p,b;document.title=e=((U=o[1])==null?void 0:U.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다",m=new je({props:{position:"fixed",leftLogo:R||o[4],leftBack:!R&&!o[4]?"white":"",$$slots:{right:[Qe]},$$scope:{ctx:o}}});const N=[Ye,We],O=[];function Z(s,f){return s[0].posts.length===0?0:1}w=Z(o),E=O[w]=N[w](o);let $=!R&&Ze(),_=o[5]&&ke(o);function y(s){o[14](s)}let k={};return o[3]!==void 0&&(k.isOpen=o[3]),A=new qe({props:k}),we.push(()=>ve(A,"isOpen",y)),{c(){n=S("meta"),i=S("meta"),l=S("meta"),a=S("meta"),u=S("meta"),j=X(),D(m.$$.fragment),T=X(),E.c(),L=X(),$&&$.c(),G=X(),_&&_.c(),C=X(),D(A.$$.fragment),this.h()},l(s){const f=Se("svelte-1dzu9e9",document.head);n=M(f,"META",{property:!0,content:!0}),i=M(f,"META",{property:!0,content:!0}),l=M(f,"META",{property:!0,content:!0}),a=M(f,"META",{property:!0,content:!0}),u=M(f,"META",{property:!0,content:!0}),f.forEach(h),j=Q(s),q(m.$$.fragment,s),T=Q(s),E.l(s),L=Q(s),$&&$.l(s),G=Q(s),_&&_.l(s),C=Q(s),q(A.$$.fragment,s),this.h()},h(){var s,f,B,H,K;g(n,"property","og:title"),g(n,"content",t=`블루닷 - ${((s=o[1])==null?void 0:s.unique_name)??"bluedot"} 님`),g(i,"property","og:url"),g(i,"content",`https://bluedot.land${location.pathname}${location.search}`),g(l,"property","og:image"),g(l,"content",c=((f=o[1])==null?void 0:f.media[0])??""),g(a,"property","og:image:alt"),g(a,"content",r=((B=o[1])==null?void 0:B.place_name)??""),g(u,"property","og:description"),g(u,"content",d=((H=o[1])==null?void 0:H.text)??((K=o[1])==null?void 0:K.place_name)??"")},m(s,f){J(document.head,n),J(document.head,i),J(document.head,l),J(document.head,a),J(document.head,u),P(s,j,f),z(m,s,f),P(s,T,f),O[w].m(s,f),P(s,L,f),$&&$.m(s,f),P(s,G,f),_&&_.m(s,f),P(s,C,f),z(A,s,f),b=!0},p(s,[f]){var ae,re,le,ce,fe,ue;(!b||f&2)&&e!==(e=((ae=s[1])==null?void 0:ae.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다")&&(document.title=e),(!b||f&2&&t!==(t=`블루닷 - ${((re=s[1])==null?void 0:re.unique_name)??"bluedot"} 님`))&&g(n,"content",t),(!b||f&2&&c!==(c=((le=s[1])==null?void 0:le.media[0])??""))&&g(l,"content",c),(!b||f&2&&r!==(r=((ce=s[1])==null?void 0:ce.place_name)??""))&&g(a,"content",r),(!b||f&2&&d!==(d=((fe=s[1])==null?void 0:fe.text)??((ue=s[1])==null?void 0:ue.place_name)??""))&&g(u,"content",d);const B={};f&16&&(B.leftLogo=R||s[4]),f&16&&(B.leftBack=!R&&!s[4]?"white":""),f&131072&&(B.$$scope={dirty:f,ctx:s}),m.$set(B);let H=w;w=Z(s),w===H?O[w].p(s,f):(_e(),v(O[H],1,1,()=>{O[H]=null}),de(),E=O[w],E?E.p(s,f):(E=O[w]=N[w](s),E.c()),I(E,1),E.m(L.parentNode,L)),s[5]?_?(_.p(s,f),f&32&&I(_,1)):(_=ke(s),_.c(),I(_,1),_.m(C.parentNode,C)):_&&(_e(),v(_,1,1,()=>{_=null}),de());const K={};!p&&f&8&&(p=!0,K.isOpen=s[3],Ee(()=>p=!1)),A.$set(K)},i(s){b||(I(m.$$.fragment,s),I(E),I($),I(_),I(A.$$.fragment,s),b=!0)},o(s){v(m.$$.fragment,s),v(E),v($),v(_),v(A.$$.fragment,s),b=!1},d(s){s&&(h(j),h(T),h(L),h(G),h(C)),h(n),h(i),h(l),h(a),h(u),F(m,s),O[w].d(s),$&&$.d(s),_&&_.d(s),F(A,s)}}}function et(o,e,n){let t,i,l,c,a,r;te(o,Ce,p=>n(9,c=p)),te(o,ye,p=>n(16,a=p)),te(o,he,p=>n(5,r=p));let u={posts:[],index:0},d,j,m=!1,T;Me(async()=>{let p="";try{p=Re()}catch{}const b=new URLSearchParams(window.location.search),N=Number(b.get("postIdx")||0);Number(b.get("mediaIdx")||0);const O=0,Z=30,$=`&offset=${O}`,_=`&limit=${Z}`;let y=[];(i||t)&&a.length>0?(y=a.map(k=>k.idx===N?{...k,mediaIdx:k.mediaIdx||0}:{...k,mediaIdx:0}),n(0,u.index=y.findIndex(k=>k.idx===String(N)),u)):(T=new AbortController,N&&(y=[await fetch(`${ge}/posts/${N}`,{method:"GET",headers:{Authorization:"Bearer "+p},signal:T.signal}).then(k=>k.json()).then(k=>({...k.data,mediaIdx:k.data.mediaIdx||0}))]),y=[...y,...await fetch(`${ge}/posts?${$}${_}`,{method:"GET",headers:{Authorization:"Bearer "+p},signal:T.signal}).then(k=>k.json()).then(k=>{var U;return(U=k.data)==null?void 0:U.posts.filter(s=>s.idx!==String(N)).map(s=>({...s,mediaIdx:s.mediaIdx||0}))})||[]]),n(0,u.posts=y,u)}),Pe(()=>{T&&T.abort()});async function w(p){const b=c.url.searchParams.get("postIdx");b&&n(2,j={postIdx:b,reaction:p})}const E=async()=>{await Be("/search")},L=()=>{if(R)return n(3,m=!0)};function G(p){o.$$.not_equal(u.index,p)&&(u.index=p,n(0,u))}const C=()=>{he.set(!1)};function A(p){m=p,n(3,m)}return o.$$.update=()=>{var p;o.$$.dirty&512&&n(7,t=c.url.searchParams.get("placeIdx")),o.$$.dirty&512&&n(8,i=c.url.searchParams.get("userIdx")),o.$$.dirty&384&&n(4,l=!t&&!i),o.$$.dirty&1&&n(1,d=(p=u.posts)==null?void 0:p.at(u.index))},[u,d,j,m,l,r,w,t,i,c,E,L,G,C,A]}class kt extends se{constructor(e){super(),ie(this,e,et,xe,oe,{})}}export{kt as component};
