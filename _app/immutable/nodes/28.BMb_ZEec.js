import{s as Z,m as _e,e as S,c as v,b as H,f as h,v as I,J as oe,i as M,A as C,H as X,G as fe,u as he,o as ge,p as ke,F as ue,I as Y,T as Q,w as me,a as G,U as be,g as q,h as D,x as pe,k as W,y as Ie,B as we,D as se,n as z}from"../chunks/scheduler.DnGlJ4RW.js";import{S as ee,i as te,t as w,a as E,c as N,d as B,m as R,f as V,b as de,e as ie,g as ae}from"../chunks/index.D2MnZ5yf.js";import{H as Ee}from"../chunks/Header.Dtvft_Am.js";import{V as $e}from"../chunks/Viewer.BJlW-WZF.js";import{p as Ae}from"../chunks/stores.as1ujLHN.js";import{N as Te}from"../chunks/NavigationBar.CKIqf98o.js";import"../chunks/device.DOG8pcbg.js";import"../chunks/ActionSheet.svelte_svelte_type_style_lang.D0y5xGpd.js";/* empty css                                                   */import{I as y,d as Oe,e as re,A as le}from"../chunks/store.DENZNcr-.js";import{g as Se}from"../chunks/entry.Cr1mRZIL.js";import"../chunks/emitter.E5P-NQ8u.js";import{g as ve}from"../chunks/sign.D9t7E-7K.js";/* empty css                                                   */import{P as Me}from"../chunks/picker.DO1g6OCe.js";import{I as Pe}from"../chunks/IconSearch.BfoE4IIP.js";import{A as je}from"../chunks/ActionSheetOpenApp.xDyulFS0.js";function Le(o){let e,n,t,s,c;const l=o[5].default,r=_e(l,o,o[4],null);return{c(){e=S("div"),r&&r.c(),this.h()},l(a){e=v(a,"DIV",{id:!0,class:!0,"aria-hidden":!0});var u=H(e);r&&r.l(u),u.forEach(h),this.h()},h(){I(e,"id","mask"),I(e,"class",n=oe(`${o[0]?"":"hidden"} ${o[1]}`)+" svelte-eerk6g"),I(e,"aria-hidden","")},m(a,u){M(a,e,u),r&&r.m(e,null),t=!0,s||(c=[C(e,"touchstart",X(fe(o[6]))),C(e,"touchend",o[7],{passive:!0}),C(e,"click",o[8])],s=!0)},p(a,[u]){r&&r.p&&(!t||u&16)&&he(r,l,a,a[4],t?ke(l,a[4],u,null):ge(a[4]),null),(!t||u&3&&n!==(n=oe(`${a[0]?"":"hidden"} ${a[1]}`)+" svelte-eerk6g"))&&I(e,"class",n)},i(a){t||(w(r,a),t=!0)},o(a){E(r,a),t=!1},d(a){a&&h(e),r&&r.d(a),s=!1,ue(c)}}}function ye(o,e,n){let{$$slots:t={},$$scope:s}=e,{onMask:c=!1}=e,{position:l="fixed"}=e,{closeOnClick:r=!1}=e,{onTouch:a=void 0}=e;function u(d){Y.call(this,o,d)}const m=()=>{r?n(0,c=!1):a&&a()},k=()=>{r?n(0,c=!1):a&&a()};return o.$$set=d=>{"onMask"in d&&n(0,c=d.onMask),"position"in d&&n(1,l=d.position),"closeOnClick"in d&&n(2,r=d.closeOnClick),"onTouch"in d&&n(3,a=d.onTouch),"$$scope"in d&&n(4,s=d.$$scope)},[c,l,r,a,s,t,u,m,k]}class Ce extends ee{constructor(e){super(),te(this,e,ye,Le,Z,{onMask:0,position:1,closeOnClick:2,onTouch:3})}}function Ne(o){let e,n,t;return{c(){e=S("emoji-picker"),this.h()},l(s){e=v(s,"EMOJI-PICKER",{"aria-hidden":!0,class:!0}),H(e).forEach(h),this.h()},h(){Q(e,"aria-hidden",""),Q(e,"class",o[0])},m(s,c){M(s,e,c),n||(t=[C(e,"emoji-click",X(fe(o[2]))),C(e,"touchstart",X(o[4])),C(e,"touchend",X(o[5]))],n=!0)},p(s,c){c&1&&Q(e,"class",s[0])},d(s){s&&h(e),n=!1,ue(t)}}}function Be(o){let e,n;return e=new Ce({props:{onMask:!0,position:"absolute",onTouch:o[6],$$slots:{default:[Ne]},$$scope:{ctx:o}}}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p(t,[s]){const c={};s&2&&(c.onTouch=t[6]),s&257&&(c.$$scope={dirty:s,ctx:t}),e.$set(c)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function Re(o,e,n){let{classList:t}=e,{onSelect:s}=e,{close:c}=e;function l(m){s(m.detail.unicode)}new Me({emojiVersion:15});function r(m){Y.call(this,o,m)}function a(m){Y.call(this,o,m)}const u=()=>{c()};return o.$$set=m=>{"classList"in m&&n(0,t=m.classList),"onSelect"in m&&n(3,s=m.onSelect),"close"in m&&n(1,c=m.close)},[t,c,l,s,r,a,u]}class Ve extends ee{constructor(e){super(),te(this,e,Re,Be,Z,{classList:0,onSelect:3,close:1})}}function De(o){let e,n,t,s,c,l;return t=new Pe({props:{width:"24",height:"24"}}),{c(){e=S("div"),n=S("button"),N(t.$$.fragment),this.h()},l(r){e=v(r,"DIV",{class:!0});var a=H(e);n=v(a,"BUTTON",{});var u=H(n);B(t.$$.fragment,u),u.forEach(h),a.forEach(h),this.h()},h(){I(e,"class","flex items-center gap-2")},m(r,a){M(r,e,a),D(e,n),R(t,n,null),s=!0,c||(l=C(n,"click",o[10]),c=!0)},i(r){s||(w(t.$$.fragment,r),s=!0)},o(r){E(t.$$.fragment,r),s=!1},d(r){r&&h(e),V(t),c=!1,l()}}}function Fe(o){let e,n,t=!y&&De(o);return{c(){t&&t.c(),e=se()},l(s){t&&t.l(s),e=se()},m(s,c){t&&t.m(s,c),M(s,e,c),n=!0},p:z,i(s){n||(w(t),n=!0)},o(s){E(t),n=!1},d(s){s&&h(e),t&&t.d(s)}}}function Ge(o){let e,n,t;function s(l){o[12](l)}let c={posts:o[0].posts,selectedReaction:o[1],whenCancelForExternalLink:o[11]};return o[0].index!==void 0&&(c.index=o[0].index),e=new $e({props:c}),me.push(()=>de(e,"index",s)),{c(){N(e.$$.fragment)},l(l){B(e.$$.fragment,l)},m(l,r){R(e,l,r),t=!0},p(l,r){const a={};r&1&&(a.posts=l[0].posts),r&2&&(a.selectedReaction=l[1]),r&4&&(a.whenCancelForExternalLink=l[11]),!n&&r&1&&(n=!0,a.index=l[0].index,pe(()=>n=!1)),e.$set(a)},i(l){t||(w(e.$$.fragment,l),t=!0)},o(l){E(e.$$.fragment,l),t=!1},d(l){V(e,l)}}}function qe(o){let e;return{c(){e=S("div"),this.h()},l(n){e=v(n,"DIV",{class:!0}),H(e).forEach(h),this.h()},h(){I(e,"class","w-full h-full")},m(n,t){M(n,e,t)},p:z,i:z,o:z,d(n){n&&h(e)}}}function ze(o){let e,n;return e=new Te({}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function ce(o){let e,n;return e=new Ve({props:{classList:"absolute bottom-24 right-0 px-4 z-50",onSelect:o[6],close:o[13]}}),{c(){N(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,s){R(e,t,s),n=!0},p:z,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){E(e.$$.fragment,t),n=!1},d(t){V(e,t)}}}function He(o){var K;let e,n,t,s,c,l,r,a,u,m,k,d,A,j,$,F,L;document.title=e=((K=o[5])==null?void 0:K.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다",a=new Ee({props:{position:"fixed",leftLogo:y||o[3],leftBack:!y&&!o[3]?"white":"",$$slots:{right:[Fe]},$$scope:{ctx:o}}});const J=[qe,Ge],T=[];function g(i,f){return i[0].posts.length===0?0:1}m=g(o),k=T[m]=J[m](o);let b=!y&&ze(),p=o[4]&&ce(o);function x(i){o[14](i)}let U={};return o[2]!==void 0&&(U.isOpen=o[2]),$=new je({props:U}),me.push(()=>de($,"isOpen",x)),{c(){n=S("meta"),t=S("meta"),s=S("meta"),c=S("meta"),l=S("meta"),r=G(),N(a.$$.fragment),u=G(),k.c(),d=G(),b&&b.c(),A=G(),p&&p.c(),j=G(),N($.$$.fragment),this.h()},l(i){const f=be("svelte-1x2a8re",document.head);n=v(f,"META",{property:!0,content:!0}),t=v(f,"META",{property:!0,content:!0}),s=v(f,"META",{property:!0,content:!0}),c=v(f,"META",{property:!0,content:!0}),l=v(f,"META",{property:!0,content:!0}),f.forEach(h),r=q(i),B(a.$$.fragment,i),u=q(i),k.l(i),d=q(i),b&&b.l(i),A=q(i),p&&p.l(i),j=q(i),B($.$$.fragment,i),this.h()},h(){var i,f,_,P,O;I(n,"property","og:title"),I(n,"content",`블루닷 - ${((i=o[5])==null?void 0:i.unique_name)??""} 님`),I(t,"property","og:url"),I(t,"content",`https://bluedot.land${location.pathname}${location.search}`),I(s,"property","og:image"),I(s,"content",((f=o[5])==null?void 0:f.media[0])??""),I(c,"property","og:image:alt"),I(c,"content",((_=o[5])==null?void 0:_.place_name)??""),I(l,"property","og:description"),I(l,"content",((P=o[5])==null?void 0:P.text)??((O=o[5])==null?void 0:O.place_name)??"")},m(i,f){D(document.head,n),D(document.head,t),D(document.head,s),D(document.head,c),D(document.head,l),M(i,r,f),R(a,i,f),M(i,u,f),T[m].m(i,f),M(i,d,f),b&&b.m(i,f),M(i,A,f),p&&p.m(i,f),M(i,j,f),R($,i,f),L=!0},p(i,[f]){var ne;(!L||f&32)&&e!==(e=((ne=i[5])==null?void 0:ne.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다")&&(document.title=e);const _={};f&8&&(_.leftLogo=y||i[3]),f&8&&(_.leftBack=!y&&!i[3]?"white":""),f&131072&&(_.$$scope={dirty:f,ctx:i}),a.$set(_);let P=m;m=g(i),m===P?T[m].p(i,f):(ae(),E(T[P],1,1,()=>{T[P]=null}),ie(),k=T[m],k?k.p(i,f):(k=T[m]=J[m](i),k.c()),w(k,1),k.m(d.parentNode,d)),i[4]?p?(p.p(i,f),f&16&&w(p,1)):(p=ce(i),p.c(),w(p,1),p.m(j.parentNode,j)):p&&(ae(),E(p,1,1,()=>{p=null}),ie());const O={};!F&&f&4&&(F=!0,O.isOpen=i[2],pe(()=>F=!1)),$.$set(O)},i(i){L||(w(a.$$.fragment,i),w(k),w(b),w(p),w($.$$.fragment,i),L=!0)},o(i){E(a.$$.fragment,i),E(k),E(b),E(p),E($.$$.fragment,i),L=!1},d(i){i&&(h(r),h(u),h(d),h(A),h(j)),h(n),h(t),h(s),h(c),h(l),V(a,i),T[m].d(i),b&&b.d(i),p&&p.d(i),V($,i)}}}function Je(o,e,n){let t,s,c,l,r,a;W(o,Ae,g=>n(9,l=g)),W(o,Oe,g=>n(16,r=g)),W(o,re,g=>n(4,a=g));let u={posts:[],index:0},m,k,d=!1,A;Ie(async()=>{let g="";try{g=ve()}catch{}const b=new URLSearchParams(window.location.search),p=Number(b.get("postIdx")||0);Number(b.get("mediaIdx")||0);const x=0,U=30,K=`&offset=${x}`,i=`&limit=${U}`;let f=[];(s||t)&&r.length>0?(f=r.map(_=>_.idx===p?{..._,mediaIdx:_.mediaIdx||0}:{..._,mediaIdx:0}),n(0,u.index=f.findIndex(_=>_.idx===String(p)),u)):(A=new AbortController,p&&(f=[await fetch(`${le}/posts/${p}`,{method:"GET",headers:{Authorization:"Bearer "+g},signal:A.signal}).then(_=>_.json()).then(_=>({..._.data,mediaIdx:_.data.mediaIdx||0}))]),f=[...f,...await fetch(`${le}/posts?${K}${i}`,{method:"GET",headers:{Authorization:"Bearer "+g},signal:A.signal}).then(_=>_.json()).then(_=>{var P;return(P=_.data)==null?void 0:P.posts.filter(O=>O.idx!==String(p)).map(O=>({...O,mediaIdx:O.mediaIdx||0}))})||[]]),n(0,u.posts=f,u)}),we(()=>{A&&A.abort()});async function j(g){const b=l.url.searchParams.get("postIdx");b&&n(1,k={postIdx:b,reaction:g})}const $=async()=>{await Se("/search")},F=()=>{if(y)return n(2,d=!0)};function L(g){o.$$.not_equal(u.index,g)&&(u.index=g,n(0,u))}const J=()=>{re.set(!1)};function T(g){d=g,n(2,d)}return o.$$.update=()=>{o.$$.dirty&512&&n(7,t=l.url.searchParams.get("placeIdx")),o.$$.dirty&512&&n(8,s=l.url.searchParams.get("userIdx")),o.$$.dirty&384&&n(3,c=!t&&!s)},[u,k,d,c,a,m,j,t,s,l,$,F,L,J,T]}class ct extends ee{constructor(e){super(),te(this,e,Je,He,Z,{})}}export{ct as component};
