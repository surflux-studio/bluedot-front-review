import{g as Ve,A as Ce,H as Ee,e as Q,i as De}from"../chunks/Header.q6v80JDx.js";import{g as ke}from"../chunks/entry.yNG3hslh.js";import{s as ne,F as de,G as he,b as k,f,q as c,i as T,h,n as te,e as y,a as j,t as se,c as I,g as H,d as le,v as G,J as me,r as X,I as xe,D as Be,k as je,o as He,l as Te,j as Me,K as pe,H as Se}from"../chunks/scheduler.BnheM4g2.js";import{S as ye,i as Ie,c as U,a as q,m as z,t as S,b as O,d as J,g as Pe,f as Ae}from"../chunks/index.CP53dWnj.js";import{e as ge}from"../chunks/each.B4pMeuX4.js";import{M as Oe}from"../chunks/Map.rQrDrPjc.js";import{F as Ne}from"../chunks/Footer.BKPl2caD.js";import{a as R,v as Ze}from"../chunks/map.BKBbcj8P.js";import{f as Fe}from"../chunks/location.D2lC0qxq.js";import{s as oe}from"../chunks/s32cloudfront.B_19cWmf.js";import{I as Ge}from"../chunks/IconMaterialBoxRounded.BkEHgh8w.js";import{p as Le}from"../chunks/stores.iLya7Glv.js";const Re=async({params:a,fetch:e})=>{const s=Ve(),t=await e(`${Ce}/boxes/${a.idx}`,{method:"GET",headers:{Authorization:`Bearer ${s}`}});return t.ok?(await t.json()).data:ke("/boxes")},ct=Object.freeze(Object.defineProperty({__proto__:null,load:Re},Symbol.toStringTag,{value:"Module"}));function Ue(a){let e,s;return{c(){e=de("svg"),s=de("path"),this.h()},l(t){e=he(t,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var l=k(e);s=he(l,"path",{d:!0}),k(s).forEach(f),l.forEach(f),this.h()},h(){c(s,"d","M4 8H20V21C20 21.2652 19.8946 21.5196 19.7071 21.7071C19.5196 21.8946 19.2652 22 19 22H5C4.73478 22 4.48043 21.8946 4.29289 21.7071C4.10536 21.5196 4 21.2652 4 21V8ZM6 10V20H18V10H6ZM9 12H11V18H9V12ZM13 12H15V18H13V12ZM7 5V3C7 2.73478 7.10536 2.48043 7.29289 2.29289C7.48043 2.10536 7.73478 2 8 2H16C16.2652 2 16.5196 2.10536 16.7071 2.29289C16.8946 2.48043 17 2.73478 17 3V5H22V7H2V5H7ZM9 4V5H15V4H9Z"),c(e,"width","24"),c(e,"height","24"),c(e,"viewBox","0 0 24 24"),c(e,"fill",a[0]),c(e,"xmlns","http://www.w3.org/2000/svg")},m(t,l){T(t,e,l),h(e,s)},p(t,[l]){l&1&&c(e,"fill",t[0])},i:te,o:te,d(t){t&&f(e)}}}function qe(a,e,s){let{fill:t="white"}=e;return a.$$set=l=>{"fill"in l&&s(0,t=l.fill)},[t]}class ze extends ye{constructor(e){super(),Ie(this,e,qe,Ue,ne,{fill:0})}}function _e(a,e,s){const t=a.slice();return t[16]=e[s],t}function Je(a){let e,s,t,l,o=a[3].name+"",n,u;return s=new Ge({props:{length:1.25}}),{c(){e=y("div"),U(s.$$.fragment),t=j(),l=y("div"),n=se(o),this.h()},l(g){e=I(g,"DIV",{class:!0});var _=k(e);q(s.$$.fragment,_),t=H(_),l=I(_,"DIV",{class:!0});var V=k(l);n=le(V,o),V.forEach(f),_.forEach(f),this.h()},h(){c(l,"class","typo-sub-h3 text-gray-900"),c(e,"class","flex flex-row justify-center items-center gap-1")},m(g,_){T(g,e,_),z(s,e,null),h(e,t),h(e,l),h(l,n),u=!0},p:te,i(g){u||(S(s.$$.fragment,g),u=!0)},o(g){O(s.$$.fragment,g),u=!1},d(g){g&&f(e),J(s)}}}function ve(a){let e,s;return{c(){e=y("img"),this.h()},l(t){e=I(t,"IMG",{class:!0,alt:!0,src:!0}),this.h()},h(){var t,l;c(e,"class","w-full h-full object-cover"),c(e,"alt","장소 사진"),pe(e.src,s=oe(((l=(t=a[16])==null?void 0:t.media)==null?void 0:l.at(0))??"",500))||c(e,"src",s)},m(t,l){T(t,e,l)},p(t,l){var o,n;l&1&&!pe(e.src,s=oe(((n=(o=t[16])==null?void 0:o.media)==null?void 0:n.at(0))??"",500))&&c(e,"src",s)},d(t){t&&f(e)}}}function be(a){let e,s,t;function l(...o){return a[9](a[16],...o)}return{c(){e=y("input"),this.h()},l(o){e=I(o,"INPUT",{type:!0,class:!0}),this.h()},h(){c(e,"type","checkbox"),c(e,"class","absolute top-1 left-1 m-2 focus:outline-none focus:ring-0 focus:ring-offset-0")},m(o,n){T(o,e,n),s||(t=X(e,"click",Se(l)),s=!0)},p(o,n){a=o},d(o){o&&f(e),s=!1,t()}}}function $e(a){var x,E;let e,s=(E=(x=a[16])==null?void 0:x.media)==null?void 0:E.at(0),t,l,o=a[16].name+"",n,u,g=a[16].idx,_,V,D,d=s&&ve(a),b=be(a);function P(){return a[10](a[16])}return{c(){e=y("div"),d&&d.c(),t=j(),l=y("div"),n=se(o),u=j(),b.c(),_=j(),this.h()},l(v){e=I(v,"DIV",{class:!0,"aria-hidden":!0});var p=k(e);d&&d.l(p),t=H(p),l=I(p,"DIV",{class:!0});var r=k(l);n=le(r,o),r.forEach(f),u=H(p),b.l(p),_=H(p),p.forEach(f),this.h()},h(){c(l,"class","absolute bottom-0 p-2.5 typo-caption1 text-white text-shadow svelte-sygcjw"),c(e,"class","bg-gray-50 h-36 relative"),c(e,"aria-hidden","")},m(v,p){T(v,e,p),d&&d.m(e,null),h(e,t),h(e,l),h(l,n),h(e,u),b.m(e,null),h(e,_),V||(D=X(e,"click",P),V=!0)},p(v,p){var r,$;a=v,p&1&&(s=($=(r=a[16])==null?void 0:r.media)==null?void 0:$.at(0)),s?d?d.p(a,p):(d=ve(a),d.c(),d.m(e,t)):d&&(d.d(1),d=null),p&1&&o!==(o=a[16].name+"")&&Me(n,o),p&1&&ne(g,g=a[16].idx)?(b.d(1),b=be(a),b.c(),b.m(e,_)):b.p(a,p)},d(v){v&&f(e),d&&d.d(),b.d(v),V=!1,D()}}}function we(a){let e,s,t,l,o;return s=new ze({}),{c(){e=y("button"),U(s.$$.fragment),this.h()},l(n){e=I(n,"BUTTON",{class:!0});var u=k(e);q(s.$$.fragment,u),u.forEach(f),this.h()},h(){c(e,"class","bg-red-500 rounded-full p-4 pointer-events-auto")},m(n,u){T(n,e,u),z(s,e,null),t=!0,l||(o=X(e,"click",a[5]),l=!0)},p:te,i(n){t||(S(s.$$.fragment,n),t=!0)},o(n){O(s.$$.fragment,n),t=!1},d(n){n&&f(e),J(s),l=!1,o()}}}function Xe(a){let e,s,t=a[2]==="list"&&a[1].length>0&&we(a);return{c(){e=y("div"),t&&t.c(),this.h()},l(l){e=I(l,"DIV",{slot:!0});var o=k(e);t&&t.l(o),o.forEach(f),this.h()},h(){c(e,"slot","right")},m(l,o){T(l,e,o),t&&t.m(e,null),s=!0},p(l,o){l[2]==="list"&&l[1].length>0?t?(t.p(l,o),o&6&&S(t,1)):(t=we(l),t.c(),S(t,1),t.m(e,null)):t&&(Pe(),O(t,1,1,()=>{t=null}),Ae())},i(l){s||(S(t),s=!0)},o(l){O(t),s=!1},d(l){l&&f(e),t&&t.d()}}}function Ke(a){let e,s,t,l,o,n,u,g,_,V,D,d,b,P,x,E,v,p,r,$,N,M,A,ae,ie;t=new Ee({props:{position:"static",leftBack:!0,rightLink:!0,rightBoxSetting:a[3].role==="owner"?" ":"",slotPosition:"justify-center",$$slots:{default:[Je]},$$scope:{ctx:a}}}),v=new Oe({});let Z=ge(a[0]),w=[];for(let i=0;i<Z.length;i+=1)w[i]=$e(_e(a,Z,i));return M=new Ne({props:{position:"fixed",leftReposition:a[2]==="map",$$slots:{right:[Xe]},$$scope:{ctx:a}}}),{c(){e=y("div"),s=y("div"),U(t.$$.fragment),l=j(),o=y("div"),n=y("div"),u=y("button"),g=se("지도"),V=j(),D=y("button"),d=se("리스트"),P=j(),x=y("div"),E=y("div"),U(v.$$.fragment),p=j(),r=y("div");for(let i=0;i<w.length;i+=1)w[i].c();N=j(),U(M.$$.fragment),this.h()},l(i){e=I(i,"DIV",{class:!0});var m=k(e);s=I(m,"DIV",{class:!0});var B=k(s);q(t.$$.fragment,B),B.forEach(f),l=H(m),o=I(m,"DIV",{class:!0});var F=k(o);n=I(F,"DIV",{class:!0});var C=k(n);u=I(C,"BUTTON",{class:!0});var L=k(u);g=le(L,"지도"),L.forEach(f),V=H(C),D=I(C,"BUTTON",{class:!0});var ue=k(D);d=le(ue,"리스트"),ue.forEach(f),C.forEach(f),F.forEach(f),P=H(m),x=I(m,"DIV",{class:!0});var ce=k(x);E=I(ce,"DIV",{class:!0});var K=k(E);q(v.$$.fragment,K),p=H(K),r=I(K,"DIV",{class:!0});var fe=k(r);for(let re=0;re<w.length;re+=1)w[re].l(fe);fe.forEach(f),K.forEach(f),ce.forEach(f),m.forEach(f),N=H(i),q(M.$$.fragment,i),this.h()},h(){c(s,"class","flex-none"),c(u,"class",_=G(`tab-map w-full px-8 py-2.5 ${a[2]==="map"?W:Y}`)+" svelte-sygcjw"),c(D,"class",b=G(`tab-list w-full px-8 py-2.5 ${a[2]==="list"?W:Y}`)+" svelte-sygcjw"),c(n,"class","tab-category w-full flex flex-row text-center"),c(o,"class","tab flex-none w-full px-4 pt-2.5 pb-0.5"),c(r,"class","absolute left-full w-screen grid grid-cols-3 gap-1"),c(E,"class","h-full w-full transition-transform"),me(E,"transform",`translateX(${a[2]==="map"?0:-100}%)`),c(x,"class","content flex-auto"),c(e,"class",$=G(`flex flex-col w-dvw h-dvh overflow-x-hidden ${a[2]==="list"?"":"overflow-y-hidden"}`)+" svelte-sygcjw")},m(i,m){T(i,e,m),h(e,s),z(t,s,null),h(e,l),h(e,o),h(o,n),h(n,u),h(u,g),h(n,V),h(n,D),h(D,d),h(e,P),h(e,x),h(x,E),z(v,E,null),h(E,p),h(E,r);for(let B=0;B<w.length;B+=1)w[B]&&w[B].m(r,null);T(i,N,m),z(M,i,m),A=!0,ae||(ie=[X(u,"click",a[7]),X(D,"click",a[8])],ae=!0)},p(i,[m]){const B={};if(m&524288&&(B.$$scope={dirty:m,ctx:i}),t.$set(B),(!A||m&4&&_!==(_=G(`tab-map w-full px-8 py-2.5 ${i[2]==="map"?W:Y}`)+" svelte-sygcjw"))&&c(u,"class",_),(!A||m&4&&b!==(b=G(`tab-list w-full px-8 py-2.5 ${i[2]==="list"?W:Y}`)+" svelte-sygcjw"))&&c(D,"class",b),m&17){Z=ge(i[0]);let C;for(C=0;C<Z.length;C+=1){const L=_e(i,Z,C);w[C]?w[C].p(L,m):(w[C]=$e(L),w[C].c(),w[C].m(r,null))}for(;C<w.length;C+=1)w[C].d(1);w.length=Z.length}m&4&&me(E,"transform",`translateX(${i[2]==="map"?0:-100}%)`),(!A||m&4&&$!==($=G(`flex flex-col w-dvw h-dvh overflow-x-hidden ${i[2]==="list"?"":"overflow-y-hidden"}`)+" svelte-sygcjw"))&&c(e,"class",$);const F={};m&4&&(F.leftReposition=i[2]==="map"),m&524294&&(F.$$scope={dirty:m,ctx:i}),M.$set(F)},i(i){A||(S(t.$$.fragment,i),S(v.$$.fragment,i),S(M.$$.fragment,i),A=!0)},o(i){O(t.$$.fragment,i),O(v.$$.fragment,i),O(M.$$.fragment,i),A=!1},d(i){i&&(f(e),f(N)),J(t),J(v),xe(w,i),J(M,i),ae=!1,Be(ie)}}}let W="text-gray-900 typo-sub-h2 border-b-[2.5px] border-gray-900",Y="text-gray-500 typo-sub-h5";const ee=60;function Qe(a,e,s){let t;je(a,Le,r=>s(12,t=r));let{data:l}=e,o=l.box,n=l.places,u=[];He(async()=>{D()}),Te(()=>{R.un("change",d)});let g="map";const _=[];let V=[];function D(){V=n.filter(r=>!r.longitude||!r.latitude||_.includes(r.idx)?!1:(_.push(r.idx),!0)),!t.url.searchParams.get("location")&&V.length>0&&R.on("change",d),Q.emit("addIcons",V.map(r=>{var $;return{idx:Number(r.idx),coordinate:Fe([r.longitude,r.latitude]),image:oe((($=r.media)==null?void 0:$.at(0))??"",500),shape:"waterdrop",type:"place",link:`/places/${r.idx}`,rank:1,name:r.name,width:56,height:61}}))}function d(){if(R.getFeatures().length!==V.length)return;R.un("change",d);const r=R.getExtent();Ze.fit(r,{padding:[ee,ee,ee,ee],duration:500,maxZoom:16})}function b(r,$){$&&!u.includes(r)?s(1,u=[...u,r]):!$&&u.includes(r)&&s(1,u=u.filter(N=>N!==r))}async function P(){if(!De())return Q.emit("showSignInModal",{removable:!0});try{if(!(await fetch(`${Ce}/boxes/${o.idx}/places`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},body:JSON.stringify({places:u})})).ok)throw"apierror";s(0,n=n.filter($=>!u.includes($.idx))),s(1,u=[]),Q.emit("pushSnackbar",{message:"박스에서 장소를 제거했습니다."})}catch{Q.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."})}}const x=()=>s(2,g="map"),E=()=>s(2,g="list"),v=(r,$)=>b(r.idx,$.currentTarget.checked),p=r=>ke(`/places/${r.idx}`);return a.$$set=r=>{"data"in r&&s(6,l=r.data)},[n,u,g,o,b,P,l,x,E,v,p]}class ft extends ye{constructor(e){super(),Ie(this,e,Qe,Ke,ne,{data:6})}}export{ft as component,ct as universal};
