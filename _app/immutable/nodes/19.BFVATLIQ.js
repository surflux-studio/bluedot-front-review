import{e as ue}from"../chunks/index.Djh6sv37.js";import{d as oe,A as ne,g as ie,e as j}from"../chunks/sign.0LSMDjDO.js";import{s as ce,e as f,a as E,c as g,b as C,g as D,E as K,f as d,q as r,R as le,i as q,h as u,L as M,v as V,y as de,t as X,d as Y,G as Q,H as W}from"../chunks/scheduler.CAgUjVVh.js";import{S as me,i as fe,c as ge,b as pe,m as he,t as Ce,a as be,d as _e}from"../chunks/index.BArRcuOw.js";import{g as ve}from"../chunks/entry.C0kOxo6C.js";import{H as ye}from"../chunks/Header.DcbN9C6J.js";import{u as Be}from"../chunks/photo.Clvzjxfn.js";const ke=async({params:o,fetch:t,depends:e})=>{if(String(o.idx)!==String(oe()))throw ue(403,"Forbidden");const a=(await(await t(`${ne}/auth/users/${o.idx}`,{headers:{Authorization:`Bearer ${ie()}`}})).json()).data;if(!(a!=null&&a.idx))throw ue(404,"User not found");return{user:a}},Ue=Object.freeze(Object.defineProperty({__proto__:null,load:ke},Symbol.toStringTag,{value:"Module"}));function xe(o){let t;return{c(){t=X("프로필 편집")},l(e){t=Y(e,"프로필 편집")},m(e,n){q(e,t,n)},d(e){e&&d(t)}}}function we(o){let t;return{c(){t=X("저장하기")},l(e){t=Y(e,"저장하기")},m(e,n){q(e,t,n)},d(e){e&&d(t)}}}function Ee(o){let t,e,n,s;return{c(){t=Q("svg"),e=Q("circle"),n=Q("path"),s=X(`
          저장 중...`),this.h()},l(a){t=W(a,"svg",{class:!0,viewBox:!0});var c=C(t);e=W(c,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),C(e).forEach(d),n=W(c,"path",{class:!0,fill:!0,d:!0}),C(n).forEach(d),c.forEach(d),s=Y(a,`
          저장 중...`),this.h()},h(){r(e,"class","opacity-25"),r(e,"cx","12"),r(e,"cy","12"),r(e,"r","10"),r(e,"stroke","currentColor"),r(e,"stroke-width","4"),r(e,"fill","none"),r(n,"class","opacity-75"),r(n,"fill","currentColor"),r(n,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),r(t,"class","animate-spin h-5 w-5 mr-3 text-white"),r(t,"viewBox","0 0 24 24")},m(a,c){q(a,t,c),u(t,e),u(t,n),q(a,s,c)},d(a){a&&(d(t),d(s))}}}function De(o){let t,e,n,s,a,c,p,I,$,b,U='<svg class="w-4 h-4 text-gray-600 dark:text-gray-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',A,i,_,T="이메일 (변경 불가)",O,v,G,x,w,Z="닉네임 (Unique Name)",J,y,R,N,B,S,F,ee;e=new ye({props:{position:"static",leftBack:!0,$$slots:{default:[xe]},$$scope:{ctx:o}}});function te(l,m){return l[3]?Ee:we}let P=te(o),k=P(o);return{c(){t=f("div"),ge(e.$$.fragment),n=E(),s=f("main"),a=f("div"),c=f("div"),p=f("img"),$=E(),b=f("button"),b.innerHTML=U,A=E(),i=f("div"),_=f("label"),_.textContent=T,O=E(),v=f("input"),G=E(),x=f("div"),w=f("label"),w.textContent=Z,J=E(),y=f("input"),R=E(),N=f("div"),B=f("button"),k.c(),this.h()},l(l){t=g(l,"DIV",{class:!0});var m=C(t);pe(e.$$.fragment,m),n=D(m),s=g(m,"MAIN",{class:!0});var h=C(s);a=g(h,"DIV",{class:!0});var re=C(a);c=g(re,"DIV",{class:!0});var z=C(c);p=g(z,"IMG",{class:!0,src:!0,alt:!0}),$=D(z),b=g(z,"BUTTON",{class:!0,"data-svelte-h":!0}),K(b)!=="svelte-1bzn6op"&&(b.innerHTML=U),z.forEach(d),re.forEach(d),A=D(h),i=g(h,"DIV",{class:!0});var H=C(i);_=g(H,"LABEL",{class:!0,"data-svelte-h":!0}),K(_)!=="svelte-mkvsoj"&&(_.textContent=T),O=D(H),v=g(H,"INPUT",{type:!0,class:!0}),H.forEach(d),G=D(h),x=g(h,"DIV",{class:!0});var L=C(x);w=g(L,"LABEL",{class:!0,"data-svelte-h":!0}),K(w)!=="svelte-g6muw9"&&(w.textContent=Z),J=D(L),y=g(L,"INPUT",{type:!0,class:!0,placeholder:!0}),L.forEach(d),R=D(h),N=g(h,"DIV",{class:!0});var ae=C(N);B=g(ae,"BUTTON",{class:!0});var se=C(B);k.l(se),se.forEach(d),ae.forEach(d),h.forEach(d),m.forEach(d),this.h()},h(){r(p,"class","w-24 h-24 rounded-full object-cover border border-gray-200 dark:border-gray-700"),le(p.src,I=o[2])||r(p,"src",I),r(p,"alt","Profile Image"),r(b,"class","absolute bottom-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full p-2 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-sm"),r(c,"class","relative"),r(a,"class","flex justify-center mt-6 mb-4"),r(_,"class","block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"),r(v,"type","text"),r(v,"class","w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-200 cursor-not-allowed"),v.disabled=!0,r(i,"class","mb-4"),r(w,"class","block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"),r(y,"type","text"),r(y,"class","w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-md text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500"),r(y,"placeholder","예) mynickname"),r(x,"class","mb-4"),r(B,"class","w-full px-4 py-3 text-white hover:bg-primary-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 flex items-center justify-center bg-gradient-to-br from-primary-400 from-0% to-emerald-400 to-80% "),B.disabled=o[3],r(N,"class","mt-6"),r(s,"class","flex-1 px-4 py-6"),r(t,"class","flex flex-col min-h-screen")},m(l,m){q(l,t,m),he(e,t,null),u(t,n),u(t,s),u(s,a),u(a,c),u(c,p),u(c,$),u(c,b),u(s,A),u(s,i),u(i,_),u(i,O),u(i,v),M(v,o[0].email),u(s,G),u(s,x),u(x,w),u(x,J),u(x,y),M(y,o[1]),u(s,R),u(s,N),u(N,B),k.m(B,null),S=!0,F||(ee=[V(b,"click",o[6]),V(v,"input",o[7]),V(y,"input",o[8]),V(B,"click",o[4])],F=!0)},p(l,[m]){const h={};m&1024&&(h.$$scope={dirty:m,ctx:l}),e.$set(h),(!S||m&4&&!le(p.src,I=l[2]))&&r(p,"src",I),m&1&&v.value!==l[0].email&&M(v,l[0].email),m&2&&y.value!==l[1]&&M(y,l[1]),P!==(P=te(l))&&(k.d(1),k=P(l),k&&(k.c(),k.m(B,null))),(!S||m&8)&&(B.disabled=l[3])},i(l){S||(Ce(e.$$.fragment,l),S=!0)},o(l){be(e.$$.fragment,l),S=!1},d(l){l&&d(t),_e(e),k.d(),F=!1,de(ee)}}}function Ie(o,t,e){let{data:n}=t,{user:s}=n,a=s.unique_name||"",c=s.profile_image_url||"",p=!1;function I(){return a.trim()?/^[a-z0-9._]{1,30}$/.test(a)?!0:(j.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(j.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1)}async function $(){if(I()){e(3,p=!0);try{const i=oe(),_=await fetch(`${ne}/auth/users/${i}`,{method:"PATCH",headers:{Authorization:`Bearer ${ie()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:a,profileImage:c})});if(_.ok)j.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),ve(`/users/${i}`);else{const T=await _.json();console.error(T),j.emit("pushSnackbar",{message:T.message||"프로필 수정에 실패했습니다."})}}catch(i){console.error(i),j.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}e(3,p=!1)}}const b=()=>{Be({mutiple:!1}).then(i=>{i.length>0&&e(2,c=i[0])})};function U(){s.email=this.value,e(0,s)}function A(){a=this.value,e(1,a)}return o.$$set=i=>{"data"in i&&e(5,n=i.data)},[s,a,c,p,$,n,b,U,A]}class Pe extends me{constructor(t){super(),fe(this,t,Ie,De,ce,{data:5})}}export{Pe as component,Ue as universal};
