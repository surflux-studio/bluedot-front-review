import{s as Q,I as L,J as F,b as P,f as x,q as f,i as V,h as k,n as A,C as tt,a as y,g as E,D as et,k as st,A as ut,B as ct,e as C,c as $,E as H,v as J,y as it}from"../chunks/scheduler.Ds8JjPaX.js";import{S as W,i as X,e as nt,c as j,b as M,m as D,a as S,f as ht,t as B,d as Z,g as dt}from"../chunks/index.ucgEq-dW.js";import{H as mt}from"../chunks/Header.B6xjiHZa.js";import{V as pt}from"../chunks/Viewer.DoVufUBA.js";import{g as lt}from"../chunks/entry.NXM8Nk0h.js";import{b as gt,h as _t}from"../chunks/sign.a4oUh1_j.js";/* empty css                                                   */import"../chunks/heic2any.Dt0nXLAN.js";import{A as K}from"../chunks/constants.B40lR-wj.js";/* empty css                                                     */import{p as bt}from"../chunks/stores.D7XwZICj.js";import{N as vt}from"../chunks/NavigationBar.BsBm8EET.js";import{A as wt}from"../chunks/ActionSheet.CHExQTKZ.js";/* empty css                                                   */import{r as rt}from"../chunks/units.BJZU6p1c.js";import{M as xt}from"../chunks/Modal.Xo3sxNzW.js";function Tt(i){let t,e;return{c(){t=L("svg"),e=L("path"),this.h()},l(s){t=F(s,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var l=P(t);e=F(l,"path",{d:!0}),P(e).forEach(x),l.forEach(x),this.h()},h(){f(e,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 -960 960 960"),f(t,"width",i[1]),f(t,"height",i[1]),f(t,"fill",i[0])},m(s,l){V(s,t,l),k(t,e)},p(s,[l]){l&2&&f(t,"width",s[1]),l&2&&f(t,"height",s[1]),l&1&&f(t,"fill",s[0])},i:A,o:A,d(s){s&&x(t)}}}function kt(i,t,e){let s,{fill:l="#5f6368"}=t,{length:r="1.75"}=t,{alt:p="Edit"}=t;return i.$$set=a=>{"fill"in a&&e(0,l=a.fill),"length"in a&&e(2,r=a.length),"alt"in a&&e(3,p=a.alt)},i.$$.update=()=>{i.$$.dirty&4&&e(1,s=rt(r))},[l,s,r,p]}class It extends W{constructor(t){super(),X(this,t,kt,Tt,Q,{fill:0,length:2,alt:3})}}function qt(i){let t,e;return{c(){t=L("svg"),e=L("path"),this.h()},l(s){t=F(s,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var l=P(t);e=F(l,"path",{d:!0}),P(e).forEach(x),l.forEach(x),this.h()},h(){f(e,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),f(t,"xmlns","http://www.w3.org/2000/svg"),f(t,"viewBox","0 -960 960 960"),f(t,"width",i[1]),f(t,"height",i[1]),f(t,"fill",i[0])},m(s,l){V(s,t,l),k(t,e)},p(s,[l]){l&2&&f(t,"width",s[1]),l&2&&f(t,"height",s[1]),l&1&&f(t,"fill",s[0])},i:A,o:A,d(s){s&&x(t)}}}function Ct(i,t,e){let s,{fill:l="#5f6368"}=t,{length:r="1.75"}=t,{alt:p="Delete"}=t;return i.$$set=a=>{"fill"in a&&e(0,l=a.fill),"length"in a&&e(2,r=a.length),"alt"in a&&e(3,p=a.alt)},i.$$.update=()=>{i.$$.dirty&4&&e(1,s=rt(r))},[l,s,r,p]}class $t extends W{constructor(t){super(),X(this,t,Ct,qt,Q,{fill:0,length:2,alt:3})}}function yt(i){let t,e;return t=new pt({props:{posts:i[0].posts,index:i[0].index}}),{c(){j(t.$$.fragment)},l(s){M(t.$$.fragment,s)},m(s,l){D(t,s,l),e=!0},p(s,l){const r={};l&1&&(r.posts=s[0].posts),l&1&&(r.index=s[0].index),t.$set(r)},i(s){e||(B(t.$$.fragment,s),e=!0)},o(s){S(t.$$.fragment,s),e=!1},d(s){Z(t,s)}}}function Et(i){let t;return{c(){t=C("div"),this.h()},l(e){t=$(e,"DIV",{class:!0}),P(t).forEach(x),this.h()},h(){f(t,"class","w-full h-full")},m(e,s){V(e,t,s)},p:A,i:A,o:A,d(e){e&&x(t)}}}function Pt(i){let t,e,s,l,r,p="수정",a,o,u,_,h,b="삭제",v,T,g;return s=new It({props:{fill:"white",length:1.4}}),u=new $t({props:{fill:"red",length:1.4}}),{c(){t=C("div"),e=C("button"),j(s.$$.fragment),l=y(),r=C("span"),r.textContent=p,a=y(),o=C("button"),j(u.$$.fragment),_=y(),h=C("span"),h.textContent=b,this.h()},l(d){t=$(d,"DIV",{class:!0});var w=P(t);e=$(w,"BUTTON",{class:!0});var I=P(e);M(s.$$.fragment,I),l=E(I),r=$(I,"SPAN",{"data-svelte-h":!0}),H(r)!=="svelte-17aljrl"&&(r.textContent=p),I.forEach(x),a=E(w),o=$(w,"BUTTON",{class:!0});var N=P(o);M(u.$$.fragment,N),_=E(N),h=$(N,"SPAN",{"data-svelte-h":!0}),H(h)!=="svelte-1k1dgz"&&(h.textContent=b),N.forEach(x),w.forEach(x),this.h()},h(){f(e,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-white rounded-t-xl bg-[#3335] border-b border-[#333] border-collapse"),f(o,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-[red] rounded-b-xl bg-[#3336] border-t border-[#333] border-collapse"),f(t,"class","flex flex-col items-center px-6 py-4")},m(d,w){V(d,t,w),k(t,e),D(s,e,null),k(e,l),k(e,r),k(t,a),k(t,o),D(u,o,null),k(o,_),k(o,h),v=!0,T||(g=[J(e,"click",i[11]),J(o,"click",i[12])],T=!0)},p:A,i(d){v||(B(s.$$.fragment,d),B(u.$$.fragment,d),v=!0)},o(d){S(s.$$.fragment,d),S(u.$$.fragment,d),v=!1},d(d){d&&x(t),Z(s),Z(u),T=!1,it(g)}}}function St(i){let t,e,s="정말로 삭제하시겠습니까?",l,r,p="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",a,o,u,_="삭제",h,b,v="취소",T,g;return{c(){t=C("div"),e=C("h2"),e.textContent=s,l=y(),r=C("p"),r.textContent=p,a=y(),o=C("div"),u=C("button"),u.textContent=_,h=y(),b=C("button"),b.textContent=v,this.h()},l(d){t=$(d,"DIV",{class:!0});var w=P(t);e=$(w,"H2",{class:!0,"data-svelte-h":!0}),H(e)!=="svelte-1yzhdkj"&&(e.textContent=s),l=E(w),r=$(w,"P",{class:!0,"data-svelte-h":!0}),H(r)!=="svelte-26p028"&&(r.textContent=p),a=E(w),o=$(w,"DIV",{class:!0});var I=P(o);u=$(I,"BUTTON",{class:!0,"data-svelte-h":!0}),H(u)!=="svelte-1q4epan"&&(u.textContent=_),h=E(I),b=$(I,"BUTTON",{class:!0,"data-svelte-h":!0}),H(b)!=="svelte-1rzg9yy"&&(b.textContent=v),I.forEach(x),w.forEach(x),this.h()},h(){f(e,"class","text-lg font-semibold mb-2"),f(r,"class","text-gray-600 mb-4"),f(u,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),f(b,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),f(o,"class","flex justify-center space-x-4"),f(t,"class","text-center")},m(d,w){V(d,t,w),k(t,e),k(t,l),k(t,r),k(t,a),k(t,o),k(o,u),k(o,h),k(o,b),T||(g=[J(u,"click",i[14]),J(b,"click",i[15])],T=!0)},p:A,d(d){d&&x(t),T=!1,it(g)}}}function Bt(i){let t,e,s,l,r,p,a,o,u,_,h,b,v;t=new mt({props:{position:"fixed",leftBack:i[4]?"":"white",rightSearch:"white",rightPostSetting:{visible:i[3],fill:"white",onClick:i[10]}}});const T=[Et,yt],g=[];function d(n,m){return n[0].posts.length===0?0:1}s=d(i),l=g[s]=T[s](i),p=new vt({});function w(n){i[13](n)}let I={$$slots:{default:[Pt]},$$scope:{ctx:i}};i[1]!==void 0&&(I.isOpen=i[1]),o=new wt({props:I}),tt.push(()=>nt(o,"isOpen",w));function N(n){i[16](n)}let R={$$slots:{default:[St]},$$scope:{ctx:i}};return i[2]!==void 0&&(R.modalVisible=i[2]),h=new xt({props:R}),tt.push(()=>nt(h,"modalVisible",N)),{c(){j(t.$$.fragment),e=y(),l.c(),r=y(),j(p.$$.fragment),a=y(),j(o.$$.fragment),_=y(),j(h.$$.fragment)},l(n){M(t.$$.fragment,n),e=E(n),l.l(n),r=E(n),M(p.$$.fragment,n),a=E(n),M(o.$$.fragment,n),_=E(n),M(h.$$.fragment,n)},m(n,m){D(t,n,m),V(n,e,m),g[s].m(n,m),V(n,r,m),D(p,n,m),V(n,a,m),D(o,n,m),V(n,_,m),D(h,n,m),v=!0},p(n,[m]){const U={};m&16&&(U.leftBack=n[4]?"":"white"),m&10&&(U.rightPostSetting={visible:n[3],fill:"white",onClick:n[10]}),t.$set(U);let c=s;s=d(n),s===c?g[s].p(n,m):(dt(),S(g[c],1,1,()=>{g[c]=null}),ht(),l=g[s],l?l.p(n,m):(l=g[s]=T[s](n),l.c()),B(l,1),l.m(r.parentNode,r));const O={};m&2097158&&(O.$$scope={dirty:m,ctx:n}),!u&&m&2&&(u=!0,O.isOpen=n[1],et(()=>u=!1)),o.$set(O);const G={};m&2097156&&(G.$$scope={dirty:m,ctx:n}),!b&&m&4&&(b=!0,G.modalVisible=n[2],et(()=>b=!1)),h.$set(G)},i(n){v||(B(t.$$.fragment,n),B(l),B(p.$$.fragment,n),B(o.$$.fragment,n),B(h.$$.fragment,n),v=!0)},o(n){S(t.$$.fragment,n),S(l),S(p.$$.fragment,n),S(o.$$.fragment,n),S(h.$$.fragment,n),v=!1},d(n){n&&(x(e),x(r),x(a),x(_)),Z(t,n),g[s].d(n),Z(p,n),Z(o,n),Z(h,n)}}}function Vt(i,t,e){let s,l,r,p,a,o,u;st(i,_t,c=>e(18,o=c)),st(i,bt,c=>e(9,u=c));let _={posts:[],index:0};const h=sessionStorage.getItem("jwt"),b=gt();let v=!1,T=!1,g;ut(async()=>{const c=Number(u.url.searchParams.get("postIdx")||0);Number(u.url.searchParams.get("mediaIdx")||0);const O=0,G=30,ot=`&offset=${O}`,at=`&limit=${G}`;let z=[];(l||s)&&o.length>0?(z=o.map(q=>q.idx===c?{...q,mediaIdx:q.mediaIdx||0}:{...q,mediaIdx:0}),e(0,_.index=z.findIndex(q=>q.idx===String(c)),_)):(g=new AbortController,c&&(z=[await fetch(`${K}/posts/${c}`,{method:"GET",headers:{Authorization:"Bearer "+h},signal:g.signal}).then(q=>q.json()).then(q=>q.data)]),z=[...z,...await fetch(`${K}/posts?${ot}${at}`,{method:"GET",headers:{Authorization:"Bearer "+h},signal:g.signal}).then(q=>q.json()).then(q=>{var Y;return(Y=q.data)==null?void 0:Y.posts.filter(ft=>ft.idx!==String(c))})||[]]),e(0,_.posts=z,_)}),ct(()=>{g&&g.abort()});function d(){var c;fetch(`${K}/posts/${(c=window.location.search.split("postIdx=")[1])==null?void 0:c.split("&")[0]}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${h}`}}).then(O=>O.json()).then(()=>lt(`/users/${b}`,{replaceState:!0,invalidateAll:!0}))}const w=()=>{e(1,v=!0)},I=()=>{var c;e(1,v=!1),lt(`/viewer/edit?type=patch&postIdx=${(c=window.location.search.split("postIdx=")[1])==null?void 0:c.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},N=()=>{e(1,v=!1),e(2,T=!0)};function R(c){v=c,e(1,v)}const n=()=>{d(),e(2,T=!1)},m=()=>{e(2,T=!1)};function U(c){T=c,e(2,T)}return i.$$.update=()=>{var c;i.$$.dirty&512&&e(6,s=u.url.searchParams.get("placeIdx")),i.$$.dirty&512&&e(7,l=u.url.searchParams.get("userIdx")),i.$$.dirty&1&&e(8,r=(c=_.posts[_.index])==null?void 0:c.user_idx),i.$$.dirty&192&&e(4,p=!s&&!l),i.$$.dirty&256&&e(3,a=b!==null&&String(b)===String(r))},[_,v,T,a,p,d,s,l,r,u,w,I,N,R,n,m,U]}class Qt extends W{constructor(t){super(),X(this,t,Vt,Bt,Q,{})}}export{Qt as component};
