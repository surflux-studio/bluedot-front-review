import{e as Z}from"../chunks/index.g5YcAAdQ.js";import{b as te,A as re,g as se,e as T}from"../chunks/sign.CF4sWAC7.js";import{s as ae,e as p,a as N,c as g,b,f,g as S,B as V,v as r,N as ee,i as P,h as o,O as z,A as M,F as le,n as ne,t as ue,d as oe,q as R,r as K}from"../chunks/scheduler.D0BZyuSu.js";import{S as ie,i as ce,c as fe,b as de,m as me,t as he,a as pe,d as ge}from"../chunks/index.ChpzTwUX.js";import{g as Ce}from"../chunks/entry.CF33Li5p.js";import{H as _e}from"../chunks/Header.3Kxn0Mdx.js";import{g as ve,u as be}from"../chunks/photo.D3wBGtiv.js";const Be=async({params:n,fetch:e,depends:t})=>{if(String(n.idx)!==String(te()))throw Z(403,"Forbidden");const i=(await(await e(`${re}/auth/users/${n.idx}`,{headers:{Authorization:`Bearer ${se()}`}})).json()).data;if(!(i!=null&&i.idx))throw Z(404,"User not found");return{user:i}},qe=Object.freeze(Object.defineProperty({__proto__:null,load:Be},Symbol.toStringTag,{value:"Module"}));function xe(n){let e,t="프로필 편집";return{c(){e=p("span"),e.textContent=t,this.h()},l(s){e=g(s,"SPAN",{class:!0,"data-svelte-h":!0}),V(e)!=="svelte-1k731c4"&&(e.textContent=t),this.h()},h(){r(e,"class","text-white text-[0.9375rem] font-semibold")},m(s,a){P(s,e,a)},p:ne,d(s){s&&f(e)}}}function ye(n){let e;return{c(){e=ue("완료")},l(t){e=oe(t,"완료")},m(t,s){P(t,e,s)},d(t){t&&f(e)}}}function we(n){let e,t,s;return{c(){e=R("svg"),t=R("circle"),s=R("path"),this.h()},l(a){e=K(a,"svg",{class:!0,viewBox:!0});var i=b(e);t=K(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),b(t).forEach(f),s=K(i,"path",{class:!0,fill:!0,d:!0}),b(s).forEach(f),i.forEach(f),this.h()},h(){r(t,"class","opacity-25"),r(t,"cx","12"),r(t,"cy","12"),r(t,"r","10"),r(t,"stroke","currentColor"),r(t,"stroke-width","4"),r(t,"fill","none"),r(s,"class","opacity-75"),r(s,"fill","currentColor"),r(s,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),r(e,"class","animate-spin h-5 w-5 mr-3 text-white"),r(e,"viewBox","0 0 24 24")},m(a,i){P(a,e,i),o(e,t),o(e,s)},d(a){a&&f(e)}}}function ke(n){let e,t,s,a,i;function h(l,C){return l[3]?we:ye}let d=h(n),u=d(n);return{c(){e=p("span"),t=p("button"),u.c(),this.h()},l(l){e=g(l,"SPAN",{slot:!0,class:!0});var C=b(e);t=g(C,"BUTTON",{});var k=b(t);u.l(k),k.forEach(f),C.forEach(f),this.h()},h(){t.disabled=n[3],r(e,"slot","right"),r(e,"class",s=`
        text-sm leading-[1.0625rem] font-medium 
        ${n[4]?"text-white":"text-[#3f3f3f]"}
      `)},m(l,C){P(l,e,C),o(e,t),u.m(t,null),a||(i=M(t,"click",n[5]),a=!0)},p(l,C){d!==(d=h(l))&&(u.d(1),u=d(l),u&&(u.c(),u.m(t,null))),C&8&&(t.disabled=l[3]),C&16&&s!==(s=`
        text-sm leading-[1.0625rem] font-medium 
        ${l[4]?"text-white":"text-[#3f3f3f]"}
      `)&&r(e,"class",s)},d(l){l&&f(e),u.d(),a=!1,i()}}}function De(n){let e,t,s,a,i,h,d,u,l,C,k,x,q='<svg class="w-4 h-4 text-gray-600 dark:text-gray-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',A,m,_,y,Q="이메일(변경 불가)",H,B,J,D,E,W="닉네임",G,w,$,L,X;return a=new _e({props:{position:"static",leftBack:"white",$$slots:{right:[ke],default:[xe]},$$scope:{ctx:n}}}),{c(){e=p("div"),t=N(),s=p("div"),fe(a.$$.fragment),i=N(),h=p("main"),d=p("div"),u=p("div"),l=p("img"),k=N(),x=p("button"),x.innerHTML=q,A=N(),m=p("div"),_=p("div"),y=p("span"),y.textContent=Q,H=N(),B=p("input"),J=N(),D=p("div"),E=p("span"),E.textContent=W,G=N(),w=p("input"),this.h()},l(c){e=g(c,"DIV",{class:!0}),b(e).forEach(f),t=S(c),s=g(c,"DIV",{class:!0});var v=b(s);de(a.$$.fragment,v),i=S(v),h=g(v,"MAIN",{class:!0});var I=b(h);d=g(I,"DIV",{class:!0});var Y=b(d);u=g(Y,"DIV",{class:!0});var O=b(u);l=g(O,"IMG",{class:!0,src:!0,alt:!0}),k=S(O),x=g(O,"BUTTON",{class:!0,"data-svelte-h":!0}),V(x)!=="svelte-s766w9"&&(x.innerHTML=q),O.forEach(f),Y.forEach(f),A=S(I),m=g(I,"DIV",{class:!0});var U=b(m);_=g(U,"DIV",{class:!0});var F=b(_);y=g(F,"SPAN",{class:!0,"data-svelte-h":!0}),V(y)!=="svelte-1gfnk3z"&&(y.textContent=Q),H=S(F),B=g(F,"INPUT",{type:!0,class:!0}),F.forEach(f),J=S(U),D=g(U,"DIV",{class:!0});var j=b(D);E=g(j,"SPAN",{class:!0,"data-svelte-h":!0}),V(E)!=="svelte-2npwwy"&&(E.textContent=W),G=S(j),w=g(j,"INPUT",{type:!0,class:!0,placeholder:!0}),j.forEach(f),U.forEach(f),I.forEach(f),v.forEach(f),this.h()},h(){r(e,"class","fixed w-full h-full bg-black -z-10"),r(l,"class","w-24 h-24 rounded-full object-cover border border-gray-200 dark:border-gray-700"),ee(l.src,C=n[1])||r(l,"src",C),r(l,"alt","Profile Image"),r(x,"class","absolute bottom-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full p-2 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-sm"),r(u,"class","relative"),r(d,"class","flex justify-center my-3.5"),r(y,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),r(B,"type","text"),r(B,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),B.readOnly=!0,B.disabled=!0,r(_,"class","flex items-center gap-3"),r(E,"class","w-[5.875rem] text-sm font-semibold tracking-[-0.0375rem] text-[#f1f1f1]"),r(w,"type","text"),r(w,"class","flex-grow py-2.5 bg-black border-0 cursor-not-allowed text-sm read-only:text-[#B3B8BD] border-b border-[#3F3F3F] "),r(w,"placeholder","mynickname"),r(D,"class","flex items-center gap-3"),r(m,"class","flex flex-col gap-2.5"),r(h,"class","flex-1 px-5"),r(s,"class","flex flex-col min-h-screen text-white")},m(c,v){P(c,e,v),P(c,t,v),P(c,s,v),me(a,s,null),o(s,i),o(s,h),o(h,d),o(d,u),o(u,l),o(u,k),o(u,x),o(h,A),o(h,m),o(m,_),o(_,y),o(_,H),o(_,B),z(B,n[2].email),o(m,J),o(m,D),o(D,E),o(D,G),o(D,w),z(w,n[0]),$=!0,L||(X=[M(x,"click",n[6]),M(B,"input",n[8]),M(w,"input",n[9])],L=!0)},p(c,[v]){const I={};v&4120&&(I.$$scope={dirty:v,ctx:c}),a.$set(I),(!$||v&2&&!ee(l.src,C=c[1]))&&r(l,"src",C),v&4&&B.value!==c[2].email&&z(B,c[2].email),v&1&&w.value!==c[0]&&z(w,c[0])},i(c){$||(he(a.$$.fragment,c),$=!0)},o(c){pe(a.$$.fragment,c),$=!1},d(c){c&&(f(e),f(t),f(s)),ge(a),L=!1,le(X)}}}function Ee(n,e,t){let s,{data:a}=e,i=a.user,{user:h}=JSON.parse(JSON.stringify(a)),d=h.unique_name||"",u=h.profile_image_url||"",l=!1;function C(){return s?d.trim()?/^[a-z0-9._]{1,30}$/.test(d)?!0:(T.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(T.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1):!1}async function k(){if(C())try{t(3,l=!0);const m=te(),_=await fetch(`${re}/auth/users/${m}`,{method:"PATCH",headers:{Authorization:`Bearer ${se()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:d,profileImage:u})});if(_.ok)T.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),Ce(`/users/${m}`);else{const y=await _.json();console.error(y),T.emit("pushSnackbar",{message:y.message||"프로필 수정에 실패했습니다."})}}catch(m){console.error(m),T.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}finally{t(3,l=!1)}}async function x(){const m=await ve({limit:1}),_=await be(m);_[0]&&t(1,u=_[0])}function q(){h.email=this.value,t(2,h)}function A(){d=this.value,t(0,d)}return n.$$set=m=>{"data"in m&&t(7,a=m.data)},n.$$.update=()=>{n.$$.dirty&3&&t(4,s=d!==i.unique_name||u!==i.profile_image_url)},[d,u,h,l,s,k,x,a,q,A]}class Oe extends ie{constructor(e){super(),ce(this,e,Ee,De,ae,{data:7})}}export{Oe as component,qe as universal};
