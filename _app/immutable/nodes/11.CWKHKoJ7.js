import{s as j,w as H,a as N,g as M,i as L,x as V,f as h,k as q,y as G,B as J,e as S,t as U,c as D,b as K,z as X,d as Q,v as E,h as A,A as Z}from"../chunks/scheduler.CIbz-4tf.js";import{S as ee,i as te,b as W,c as w,d as y,m as I,t as k,a as P,f as x}from"../chunks/index.gvaMc9LH.js";import{H as ne}from"../chunks/Header.wc4vbHxx.js";import{M as ae}from"../chunks/Map.MyhYBlFM.js";import{a as T}from"../chunks/map.GPFN7zeQ.js";import{p as oe}from"../chunks/stores.eWff0len.js";import{A as se,o as ie,a as re}from"../chunks/ActionSheet.A9wj-oR6.js";import{F as ue}from"../chunks/Field.sEKQ2dwN.js";import{I as le,e as O,A as pe}from"../chunks/store.BNSvZl0c.js";import{i as fe}from"../chunks/sign.Bk7Ra2hF.js";import{g as me}from"../chunks/entry.D1smK8x5.js";import{t as ce}from"../chunks/proj.DXH8zrwl.js";import{C as de}from"../chunks/device.C5oMyxqL.js";import"../chunks/ActionSheet.svelte_svelte_type_style_lang.BSeVzqKc.js";import{A as Ce}from"../chunks/ActionSheetOpenApp.IOpRtyeg.js";function _e(a){let o,n,f="이 장소를 뭐라고 부를까요?",c,s,r,l,p,d,m,$,C,_,g,e;function u(i){a[8](i)}let b={clear:!0,clearColor:"#757475",padding:"pb-2.5",border:"border-b border-b-[#757475]",fontSize:"font-normal text-sm",fontColor:"text-white",limit:20,useCounter:!1,backgroundColor:"bg-transparent",placeholder:"장소 이름을 입력하세요",placeholderColor:"#757475"};return a[1]!==void 0&&(b.value=a[1]),r=new ue({props:b}),H.push(()=>W(r,"value",u)),{c(){o=S("div"),n=S("p"),n.textContent=f,c=N(),s=S("div"),w(r.$$.fragment),p=N(),d=S("div"),m=S("button"),$=U("장소 추가"),this.h()},l(i){o=D(i,"DIV",{class:!0});var t=K(o);n=D(t,"P",{class:!0,"data-svelte-h":!0}),X(n)!=="svelte-9vo44h"&&(n.textContent=f),c=M(t),s=D(t,"DIV",{class:!0});var v=K(s);y(r.$$.fragment,v),v.forEach(h),p=M(t),d=D(t,"DIV",{class:!0});var F=K(d);m=D(F,"BUTTON",{class:!0});var B=K(m);$=Q(B,"장소 추가"),B.forEach(h),F.forEach(h),t.forEach(h),this.h()},h(){E(n,"class","py-2.5 font-semibold text-sm leading-[17px] text-white"),E(s,"class","box-name flex flex-col gap-4 py-2.5"),E(m,"class","w-full p-2.5 rounded-[50px] font-medium text-sm leading-[17px] bg-[#0C79FE] text-white disabled:bg-[#383838]/70 disabled:text-[#757475]"),m.disabled=C=!a[1].trim(),E(d,"class","py-2.5"),E(o,"class","px-4")},m(i,t){L(i,o,t),A(o,n),A(o,c),A(o,s),I(r,s,null),A(o,p),A(o,d),A(d,m),A(m,$),_=!0,g||(e=Z(m,"click",a[5]),g=!0)},p(i,t){const v={};!l&&t&2&&(l=!0,v.value=i[1],V(()=>l=!1)),r.$set(v),(!_||t&2&&C!==(C=!i[1].trim()))&&(m.disabled=C)},i(i){_||(k(r.$$.fragment,i),_=!0)},o(i){P(r.$$.fragment,i),_=!1},d(i){i&&h(o),x(r),g=!1,e()}}}function ge(a){let o,n,f,c,s,r,l,p,d,m;o=new ne({props:{position:"fixed",leftBack:"black"}}),f=new ae({props:{onSelect:a[4],mapY:a[2],allowEdit:!le,whenCancelEdit:a[7]}});function $(e){a[9](e)}let C={fixed:!0,noHandle:!0,$$slots:{default:[_e]},$$scope:{ctx:a}};a[0]!==void 0&&(C.isOpen=a[0]),s=new se({props:C}),H.push(()=>W(s,"isOpen",$));function _(e){a[10](e)}let g={};return a[3]!==void 0&&(g.isOpen=a[3]),p=new Ce({props:g}),H.push(()=>W(p,"isOpen",_)),{c(){w(o.$$.fragment),n=N(),w(f.$$.fragment),c=N(),w(s.$$.fragment),l=N(),w(p.$$.fragment)},l(e){y(o.$$.fragment,e),n=M(e),y(f.$$.fragment,e),c=M(e),y(s.$$.fragment,e),l=M(e),y(p.$$.fragment,e)},m(e,u){I(o,e,u),L(e,n,u),I(f,e,u),L(e,c,u),I(s,e,u),L(e,l,u),I(p,e,u),m=!0},p(e,[u]){const b={};u&4&&(b.mapY=e[2]),u&8&&(b.whenCancelEdit=e[7]),f.$set(b);const i={};u&131074&&(i.$$scope={dirty:u,ctx:e}),!r&&u&1&&(r=!0,i.isOpen=e[0],V(()=>r=!1)),s.$set(i);const t={};!d&&u&8&&(d=!0,t.isOpen=e[3],V(()=>d=!1)),p.$set(t)},i(e){m||(k(o.$$.fragment,e),k(f.$$.fragment,e),k(s.$$.fragment,e),k(p.$$.fragment,e),m=!0)},o(e){P(o.$$.fragment,e),P(f.$$.fragment,e),P(s.$$.fragment,e),P(p.$$.fragment,e),m=!1},d(e){e&&(h(n),h(c),h(l)),x(o,e),x(f,e),x(s,e),x(p,e)}}}function be(a,o,n){let f;q(a,oe,t=>n(12,f=t)),de.isNativePlatform();let c=!1,s="",r=!1,l,p=0,d=!1;function m(t){n(2,p=-200)}function $(){n(2,p=0)}G(()=>{let t=f.url.searchParams.get("location");t&&(f.url.searchParams.delete("location"),n(6,l=t.split(",").map(Number)),me(f.url.toString(),{replaceState:!0,invalidateAll:!1})),ie(()=>{},m,$)}),J(()=>{T.setPosition(void 0),re()});function C(t){T.setPosition(t),n(0,c=t!==void 0)}function _(t){n(6,l=t),O.emit("flyTo",l)}function g(){if(!fe())return O.emit("showSignInModal",{removable:!0});if(r)return O.emit("pushSnackbar",{message:"처리중입니다. 잠시 후 다시 시도해주세요"});r=!0;const t=s.trim();if(!t||l===void 0)return;const[v,F]=ce(l);fetch(`${pe}/places`,{method:"POST",body:JSON.stringify([{name:t,location:{lon:Number(v.toFixed(6)),lat:Number(F.toFixed(6))}}])}).then(async B=>{var z,R;if(!B.ok)return O.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});const Y=(R=(z=(await B.json()).data)==null?void 0:z.at(0))==null?void 0:R.idx;n(6,l=void 0),O.emit("pushSnackbar",{message:`'${t}' 장소를 추가했습니다`}),Y&&O.emit("addIconByPlaceIdx",Y)}).catch(B=>{console.log(B),O.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."})}).finally(()=>{r=!1})}const e=()=>{};function u(t){s=t,n(1,s),n(0,c)}function b(t){c=t,n(0,c)}function i(t){d=t,n(3,d)}return a.$$.update=()=>{a.$$.dirty&1&&(c||(n(1,s=""),r=!1,T.setPosition(void 0))),a.$$.dirty&64&&C(l)},[c,s,p,d,_,g,l,e,u,b,i]}class Me extends ee{constructor(o){super(),te(this,o,be,ge,j,{})}}export{Me as component};
