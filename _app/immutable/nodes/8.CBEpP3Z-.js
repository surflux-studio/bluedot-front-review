import{g as ie}from"../chunks/entry.CNKC8QBQ.js";import{g as Re,e as J,s as he,A as Ge}from"../chunks/sign.DAu4KAMA.js";import{s as Be,e as g,c as _,b as B,f as b,x as p,i as F,n as z,U as Je,X as Ie,y as U,D as Pe,q as Xe,t as ze,d as Fe,O as pe,h as d,j as Ye,I as Ke,Y as Qe,v as Ce,a as k,g as E,z as q,B as $e,w as ve,k as We,N as He,T as ye}from"../chunks/scheduler.B6RFReyk.js";import{S as xe,i as ke,e as we,c as se,b as ae,m as le,t as Y,a as K,d as ne}from"../chunks/index.DLC1-nrr.js";import{H as et}from"../chunks/Header.DwDN9eoa.js";import{F as tt}from"../chunks/Field.DrVMeeZ9.js";import{g as st}from"../chunks/photo.XxuNTMUn.js";import{s as Le}from"../chunks/s32cloudfront.BT0INwuJ.js";import{e as je,u as at,d as lt}from"../chunks/each.BdHWekAj.js";import{A as nt}from"../chunks/ActionSheet.Cc-yrJos.js";const it="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.5339%204.27187L6.1839%205.62187H3.6V13.7219H14.4V5.62187H11.8161L10.4661%204.27187H7.5339ZM6.975%202.92188H11.025L12.375%204.27187H15.075C15.254%204.27187%2015.4257%204.34299%2015.5523%204.46958C15.6789%204.59616%2015.75%204.76785%2015.75%204.94687V14.3969C15.75%2014.5759%2015.6789%2014.7476%2015.5523%2014.8742C15.4257%2015.0008%2015.254%2015.0719%2015.075%2015.0719H2.925C2.74598%2015.0719%202.57429%2015.0008%202.4477%2014.8742C2.32112%2014.7476%202.25%2014.5759%202.25%2014.3969V4.94687C2.25%204.76785%202.32112%204.59616%202.4477%204.46958C2.57429%204.34299%202.74598%204.27187%202.925%204.27187H5.625L6.975%202.92188ZM9%2013.0469C8.01538%2013.0469%207.07109%2012.6557%206.37487%2011.9595C5.67864%2011.2633%205.2875%2010.319%205.2875%209.33437C5.2875%208.34976%205.67864%207.40547%206.37487%206.70924C7.07109%206.01301%208.01538%205.62187%209%205.62187C9.98462%205.62187%2010.9289%206.01301%2011.6251%206.70924C12.3214%207.40547%2012.7125%208.34976%2012.7125%209.33437C12.7125%2010.319%2012.3214%2011.2633%2011.6251%2011.9595C10.9289%2012.6557%209.98462%2013.0469%209%2013.0469ZM9%2011.6969C9.62657%2011.6969%2010.2275%2011.448%2010.6705%2011.0049C11.1136%2010.5619%2011.3625%209.96095%2011.3625%209.33437C11.3625%208.7078%2011.1136%208.10689%2010.6705%207.66384C10.2275%207.22078%209.62657%206.97187%209%206.97187C8.37343%206.97187%207.77251%207.22078%207.32946%207.66384C6.88641%208.10689%206.6375%208.7078%206.6375%209.33437C6.6375%209.96095%206.88641%2010.5619%207.32946%2011.0049C7.77251%2011.448%208.37343%2011.6969%209%2011.6969Z'%20fill='%234B5362'/%3e%3c/svg%3e",ot=async({params:a,parent:e})=>{var C;const t=a.idx,l=`/boxes/${t}/detail`,n=t==="-1",r=Re();if(r===null&&!n)return ie(l,{replaceState:!0});if(n)return{box:{idx:"-1",name:"",description:"",image:null,role:null},jwt:r,paramIdx:t};const u=await e();if(u.error)return J.emit("pushSnackbar",{message:"접근할 수 없습니다."}),ie(l,{replaceState:!0});const f=(C=u.data)==null?void 0:C.box;return(f==null?void 0:f.role)!=="owner"?(J.emit("pushSnackbar",{message:"접근할 수 없습니다."}),ie(l,{replaceState:!0})):{box:f,jwt:r,paramIdx:t}},At=Object.freeze(Object.defineProperty({__proto__:null,load:ot},Symbol.toStringTag,{value:"Module"}));function rt(a){let e;return{c(){e=g("div"),this.h()},l(t){e=_(t,"DIV",{class:!0}),B(e).forEach(b),this.h()},h(){p(e,"class","h-[1px] bg-gray-100")},m(t,l){F(t,e,l)},p:z,i:z,o:z,d(t){t&&b(e)}}}class ut extends xe{constructor(e){super(),ke(this,e,null,rt,Be,{})}}function Ne(a,e,t){const l=a.slice();return l[6]=e[t],l[8]=t,l}function Me(a,e){let t,l=e[6]+"",n,r;return{key:a,first:null,c(){t=g("option"),n=ze(l),this.h()},l(u){t=_(u,"OPTION",{});var f=B(t);n=Fe(f,l),f.forEach(b),this.h()},h(){t.__value=r=e[6],pe(t,t.__value),this.first=t},m(u,f){F(u,t,f),d(t,n)},p(u,f){e=u,f&4&&l!==(l=e[6]+"")&&Ye(n,l),f&4&&r!==(r=e[6])&&(t.__value=r,pe(t,t.__value))},d(u){u&&b(t)}}}function ct(a){let e,t=[],l=new Map,n,r,u,f=je(a[2]);const C=s=>s[8];for(let s=0;s<f.length;s+=1){let o=Ne(a,f,s),i=C(o);l.set(i,t[s]=Me(i,o))}return{c(){e=g("select");for(let s=0;s<t.length;s+=1)t[s].c();this.h()},l(s){e=_(s,"SELECT",{class:!0});var o=B(e);for(let i=0;i<t.length;i+=1)t[i].l(o);o.forEach(b),this.h()},h(){p(e,"class",n=`border border-gray-200 rounded-[4.75rem] py-[0.38rem] px-[0.88rem] typo-body3 text-gray-900 bg-gray-100 ${a[1]}`),e.disabled=a[3],a[0]===void 0&&Je(()=>a[5].call(e))},m(s,o){F(s,e,o);for(let i=0;i<t.length;i+=1)t[i]&&t[i].m(e,null);Ie(e,a[0],!0),r||(u=[U(e,"change",a[5]),U(e,"change",a[4])],r=!0)},p(s,[o]){o&4&&(f=je(s[2]),t=at(t,o,C,1,s,f,l,e,lt,Me,null,Ne)),o&2&&n!==(n=`border border-gray-200 rounded-[4.75rem] py-[0.38rem] px-[0.88rem] typo-body3 text-gray-900 bg-gray-100 ${s[1]}`)&&p(e,"class",n),o&8&&(e.disabled=s[3]),o&5&&Ie(e,s[0])},i:z,o:z,d(s){s&&b(e);for(let o=0;o<t.length;o+=1)t[o].d();r=!1,Pe(u)}}}function ft(a,e,t){let{width:l=""}=e,{selected:n=""}=e,{options:r=[]}=e,{disabled:u=!1}=e;Xe(()=>{r.length>0&&!n&&t(0,n=r[0])});function f(s){Ke.call(this,a,s)}function C(){n=Qe(this),t(0,n),t(2,r)}return a.$$set=s=>{"width"in s&&t(1,l=s.width),"selected"in s&&t(0,n=s.selected),"options"in s&&t(2,r=s.options),"disabled"in s&&t(3,u=s.disabled)},[n,l,r,u,f,C]}class dt extends xe{constructor(e){super(),ke(this,e,ft,ct,Be,{width:1,selected:0,options:2,disabled:3})}}function ht(a){let e,t="설정";return{c(){e=g("div"),e.textContent=t,this.h()},l(l){e=_(l,"DIV",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-1lcayg1"&&(e.textContent=t),this.h()},h(){p(e,"class","typo-h3 text-gray-900")},m(l,n){F(l,e,n)},p:z,d(l){l&&b(e)}}}function Ve(a){let e,t;return{c(){e=g("img"),this.h()},l(l){e=_(l,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){p(e,"class","w-full h-full object-cover"),He(e.src,t=Le(a[1].image))||p(e,"src",t),p(e,"alt","box_image")},m(l,n){F(l,e,n)},p(l,n){n&2&&!He(e.src,t=Le(l[1].image))&&p(e,"src",t)},d(l){l&&b(e)}}}function pt(a){let e,t='박스 이름 <span class="text-red-500">*</span>';return{c(){e=g("p"),e.innerHTML=t,this.h()},l(l){e=_(l,"P",{class:!0,"data-svelte-h":!0}),q(e)!=="svelte-mxo9hb"&&(e.innerHTML=t),this.h()},h(){p(e,"class","pb-1 typo-sub-h3 text-gray-500")},m(l,n){F(l,e,n)},p:z,d(l){l&&b(e)}}}function mt(a){let e,t,l,n,r="박스 삭제",u,f,C;return t=new ut({}),{c(){e=g("section"),se(t.$$.fragment),l=k(),n=g("button"),n.textContent=r,this.h()},l(s){e=_(s,"SECTION",{class:!0});var o=B(e);ae(t.$$.fragment,o),l=E(o),n=_(o,"BUTTON",{class:!0,"data-svelte-h":!0}),q(n)!=="svelte-1u6m5al"&&(n.textContent=r),o.forEach(b),this.h()},h(){p(n,"class","py-3 typo-body3 text-red-500"),p(e,"class","w-full mb-28")},m(s,o){F(s,e,o),le(t,e,null),d(e,l),d(e,n),u=!0,f||(C=U(n,"click",a[14]),f=!0)},p:z,i(s){u||(Y(t.$$.fragment,s),u=!0)},o(s){K(t.$$.fragment,s),u=!1},d(s){s&&b(e),ne(t),f=!1,C()}}}function gt(a){let e,t,l="박스를 정말 삭제할까요?",n,r,u="확인",f,C;return{c(){e=g("div"),t=g("p"),t.textContent=l,n=k(),r=g("button"),r.textContent=u,this.h()},l(s){e=_(s,"DIV",{class:!0});var o=B(e);t=_(o,"P",{class:!0,"data-svelte-h":!0}),q(t)!=="svelte-gw0nb6"&&(t.textContent=l),n=E(o),r=_(o,"BUTTON",{class:!0,"data-svelte-h":!0}),q(r)!=="svelte-1geai0a"&&(r.textContent=u),o.forEach(b),this.h()},h(){p(t,"class","pb-1 typo-body1 text-gray-300"),p(r,"class","w-full h-14 bg-primary-500 rounded-md text-white disabled:opacity-50"),p(e,"class","px-4")},m(s,o){F(s,e,o),d(e,t),d(e,n),d(e,r),f||(C=U(r,"click",a[9]),f=!0)},p:z,d(s){s&&b(e),f=!1,C()}}}function _t(a){let e,t,l,n,r,u,f=`<div class="flex flex-row gap-1 items-center"><img src="${it}" alt="camera icon"/> <p class="typo-body3 text-gray-700">사진 변경</p></div>`,C,s,o,i,Z,H,T,x,L,oe="박스 설명",Q,A,W,j,N,re='<p class="pb-1 typo-sub-h3 text-gray-500">박스 공개 설정</p>',ee,D,te,m,O,M,v,y,I,me,ue,ce,ge,V,_e,X,be,Ee;t=new et({props:{position:"static",leftBack:"black",$$slots:{default:[ht]},$$scope:{ctx:a}}});let w=a[1].image&&Ve(a);function Ue(c){a[11](c)}let Te={clear:!0,padding:"",border:"border-b-[1.5px] border-b-gray-900 pb-2.5",fontSize:"text-lg",limit:20,onInput:a[7],$$slots:{default:[pt]},$$scope:{ctx:a}};a[1].name!==void 0&&(Te.value=a[1].name),i=new tt({props:Te}),Ce.push(()=>we(i,"value",Ue));function qe(c){a[13](c)}let Oe={width:"w-full",options:Object.keys(a[4])};a[0]!==void 0&&(Oe.selected=a[0]),D=new dt({props:Oe}),Ce.push(()=>we(D,"selected",qe));let S=!a[5]&&mt(a);function Ze(c){a[16](c)}let Ae={onClose:a[15],maxHeight:150,defaultHeight:150,$$slots:{default:[gt]},$$scope:{ctx:a}};return a[3]!==void 0&&(Ae.isOpen=a[3]),V=new nt({props:Ae}),Ce.push(()=>we(V,"isOpen",Ze)),{c(){e=g("div"),se(t.$$.fragment),l=k(),n=g("section"),w&&w.c(),r=k(),u=g("button"),u.innerHTML=f,C=k(),s=g("section"),o=g("section"),se(i.$$.fragment),H=k(),T=g("div"),x=g("label"),L=g("p"),L.textContent=oe,Q=k(),A=g("textarea"),W=k(),j=g("div"),N=g("lable"),N.innerHTML=re,ee=k(),se(D.$$.fragment),m=k(),O=g("section"),M=k(),S&&S.c(),v=k(),y=g("div"),I=g("button"),me=ze("저장"),ge=k(),se(V.$$.fragment),this.h()},l(c){e=_(c,"DIV",{class:!0});var h=B(e);ae(t.$$.fragment,h),l=E(h),n=_(h,"SECTION",{class:!0});var R=B(n);w&&w.l(R),r=E(R),u=_(R,"BUTTON",{class:!0,"data-svelte-h":!0}),q(u)!=="svelte-o1fuye"&&(u.innerHTML=f),R.forEach(b),C=E(h),s=_(h,"SECTION",{class:!0});var $=B(s);o=_($,"SECTION",{class:!0});var P=B(o);ae(i.$$.fragment,P),H=E(P),T=_(P,"DIV",{});var G=B(T);x=_(G,"LABEL",{class:!0});var fe=B(x);L=_(fe,"P",{class:!0,"data-svelte-h":!0}),q(L)!=="svelte-1uk7vkf"&&(L.textContent=oe),Q=E(fe),A=_(fe,"TEXTAREA",{class:!0}),B(A).forEach(b),fe.forEach(b),G.forEach(b),W=E(P),j=_(P,"DIV",{});var de=B(j);N=_(de,"LABLE",{class:!0,"data-svelte-h":!0}),q(N)!=="svelte-1cgggel"&&(N.innerHTML=re),ee=E(de),ae(D.$$.fragment,de),de.forEach(b),P.forEach(b),m=E($),O=_($,"SECTION",{class:!0}),B(O).forEach(b),M=E($),S&&S.l($),$.forEach(b),v=E(h),y=_(h,"DIV",{class:!0});var De=B(y);I=_(De,"BUTTON",{class:!0});var Se=B(I);me=Fe(Se,"저장"),Se.forEach(b),De.forEach(b),ge=E(h),ae(V.$$.fragment,h),h.forEach(b),this.h()},h(){p(u,"class","absolute bottom-4 right-4 bg-white rounded-3xl px-3.5 py-1.5"),p(n,"class","box-image relative w-full h-52 bg-gray-100"),p(L,"class","pb-1 typo-sub-h3 text-gray-500"),p(A,"class","auto-height w-full py-1 focus:ring-0bg-white text-sm svelte-10zrx5e"),p(x,"class","w-full"),p(N,"class","w-full"),p(o,"class","box-name flex flex-col gap-6 py-6"),p(O,"class","w-full min-h-20"),p(s,"class","box-setting px-4"),p(I,"class",ue=$e(`w-full ${a[2]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-10zrx5e"),I.disabled=ce=!a[2],p(y,"class","fixed w-full bottom-0 left-0 px-4 pt-3 pb-10 z-10 bg-white upper-box-shadow svelte-10zrx5e"),p(e,"class","min-h-dvh")},m(c,h){F(c,e,h),le(t,e,null),d(e,l),d(e,n),w&&w.m(n,null),d(n,r),d(n,u),d(e,C),d(e,s),d(s,o),le(i,o,null),d(o,H),d(o,T),d(T,x),d(x,L),d(x,Q),d(x,A),pe(A,a[1].description),d(o,W),d(o,j),d(j,N),d(j,ee),le(D,j,null),d(s,m),d(s,O),d(s,M),S&&S.m(s,null),d(e,v),d(e,y),d(y,I),d(I,me),d(e,ge),le(V,e,null),X=!0,be||(Ee=[U(u,"click",a[6]),U(A,"input",a[12]),U(A,"input",a[7]),U(I,"click",a[8])],be=!0)},p(c,[h]){const R={};h&16777216&&(R.$$scope={dirty:h,ctx:c}),t.$set(R),c[1].image?w?w.p(c,h):(w=Ve(c),w.c(),w.m(n,r)):w&&(w.d(1),w=null);const $={};h&16777216&&($.$$scope={dirty:h,ctx:c}),!Z&&h&2&&(Z=!0,$.value=c[1].name,ve(()=>Z=!1)),i.$set($),h&2&&pe(A,c[1].description);const P={};!te&&h&1&&(te=!0,P.selected=c[0],ve(()=>te=!1)),D.$set(P),c[5]||S.p(c,h),(!X||h&4&&ue!==(ue=$e(`w-full ${c[2]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-10zrx5e"))&&p(I,"class",ue),(!X||h&4&&ce!==(ce=!c[2]))&&(I.disabled=ce);const G={};h&8&&(G.onClose=c[15]),h&16777216&&(G.$$scope={dirty:h,ctx:c}),!_e&&h&8&&(_e=!0,G.isOpen=c[3],ve(()=>_e=!1)),V.$set(G)},i(c){X||(Y(t.$$.fragment,c),Y(i.$$.fragment,c),Y(D.$$.fragment,c),Y(S),Y(V.$$.fragment,c),X=!0)},o(c){K(t.$$.fragment,c),K(i.$$.fragment,c),K(D.$$.fragment,c),K(S),K(V.$$.fragment,c),X=!1},d(c){c&&b(e),ne(t),w&&w.d(),ne(i),ne(D),S&&S.d(),ne(V),be=!1,Pe(Ee)}}}function bt(a,e,t){let l;We(a,he,m=>t(19,l=m));const n=`${Ge}/boxes`,r={"전체 공개":"public","팔로워 공개":"follower",비공개:"private"};let{data:u}=e;const f=u.paramIdx,C=f==="-1";let s=u.jwt,o=u.box,i={...o},Z="팔로워 공개";if(i.visibility){for(const[m,O]of Object.entries(r))if(i.visibility===O){Z=m;break}}let H=Z,T=!1,x=!1;function L(m){t(2,T=m!==Z)}async function oe(){var m;try{const O=await st({limit:1}),M=new FormData;M.append("image",O[0].file);const v=await fetch(`${n}/image`,{method:"POST",body:M,headers:{Authorization:`Bearer ${s}`}});if(!v.ok)return J.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});const y=await v.json();t(1,i.image=((m=y.data)==null?void 0:m.image)??null,i),t(2,T=!0)}catch{}}function Q(){t(2,T=!0)}async function A(){if(!T||(t(1,i.name=i.name.trim(),i),!i.name))return;for(const[v,y]of Object.entries(r))if(H===v){t(1,i.visibility=y,i);break}const{url:m,method:O}=C?{url:n,method:"POST"}:{url:`${n}/${f}`,method:"PATCH"},M=await fetch(m,{method:O,headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({name:i.name,description:i.description,image:i.image,visibility:i.visibility})});if(!M.ok)return J.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});C?(M.json().then(v=>{const y=v.data;y.role="owner",y.visibility=i.visibility,y.is_subcribed=!1,y.place_count="0",y.member_count="1",ye(he,l=[y,...l],l)}),J.emit("pushSnackbar",{message:"새 박스를 만들었습니다"}),ie("/boxes")):(o.name=i.name,o.description=i.description,o.image=i.image,o.visibility=i.visibility,ye(he,l=l.map(v=>(v.idx===i.idx&&(v.name=i.name,v.description=i.description,v.image=i.image,v.visibility=i.visibility),v)),l),J.emit("pushSnackbar",{message:"박스를 수정했습니다."})),t(2,T=!1)}async function W(){await fetch(`${n}/${f}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`}}),ye(he,l=l.filter(m=>m.idx!==i.idx),l),J.emit("pushSnackbar",{message:`${i.name} 박스를 삭제했습니다.`}),ie("/boxes")}function j(m){a.$$.not_equal(i.name,m)&&(i.name=m,t(1,i))}function N(){i.description=this.value,t(1,i)}function re(m){H=m,t(0,H)}const ee=()=>t(3,x=!0),D=()=>t(3,x=!1);function te(m){x=m,t(3,x)}return a.$$set=m=>{"data"in m&&t(10,u=m.data)},a.$$.update=()=>{a.$$.dirty&1&&L(H)},[H,i,T,x,r,C,oe,Q,A,W,u,j,N,re,ee,D,te]}class Dt extends xe{constructor(e){super(),ke(this,e,bt,_t,Be,{data:10})}}export{Dt as component,At as universal};
