import{g as k}from"../chunks/entry.D1smK8x5.js";import{s as S,a as I,D as F,g as P,i as x,f as d,k as B,y as D,B as O,e as V,t as j,c as E,b as H,d as L,v as U,h as q,n as z}from"../chunks/scheduler.CIbz-4tf.js";import{S as C,i as T,c as h,d as b,m as w,t as $,a as g,f as v}from"../chunks/index.gvaMc9LH.js";import{F as Z}from"../chunks/IconLocation.jehxdxar.js";import{H as A}from"../chunks/Header.wc4vbHxx.js";import{M as G}from"../chunks/Map.MyhYBlFM.js";import{N as J}from"../chunks/NavigationBar.DHQMOQvd.js";import{s as _,v as K}from"../chunks/map.GPFN7zeQ.js";import{p as Q}from"../chunks/stores.eWff0len.js";import{e as R}from"../chunks/store.BNSvZl0c.js";import{f as W}from"../chunks/proj.DXH8zrwl.js";import{s as M}from"../chunks/s32cloudfront.DKUgsqvV.js";import{i as X}from"../chunks/isVideoFile.DGBlGWVm.js";import"../chunks/device.C5oMyxqL.js";import{U as Y}from"../chunks/_FindMeButton.D4gwx8x6.js";const tt=async({params:f,parent:e})=>{var r;if(f.idx==="-1")return k("/boxes");const t=await e();return t.error||!t.data?k("/boxes"):(r=t.data)!=null&&r.hasPermission?t.data:k(`/boxes/${f.idx}`)},vt=Object.freeze(Object.defineProperty({__proto__:null,load:tt},Symbol.toStringTag,{value:"Module"}));function et(f){let e,o=(f[0].name??"")+"",t;return{c(){e=V("p"),t=j(o),this.h()},l(r){e=E(r,"P",{class:!0});var s=H(e);t=L(s,o),s.forEach(d),this.h()},h(){U(e,"class","font-semibold text-[15px] leading-[18px] text-black")},m(r,s){x(r,e,s),q(e,t)},p:z,d(r){r&&d(e)}}}function at(f){let e,o;return e=new Y({}),{c(){h(e.$$.fragment)},l(t){b(e.$$.fragment,t)},m(t,r){w(e,t,r),o=!0},i(t){o||($(e.$$.fragment,t),o=!0)},o(t){g(e.$$.fragment,t),o=!1},d(t){v(e,t)}}}function nt(f){let e,o;return e=new J({}),{c(){h(e.$$.fragment)},l(t){b(e.$$.fragment,t)},m(t,r){w(e,t,r),o=!0},i(t){o||($(e.$$.fragment,t),o=!0)},o(t){g(e.$$.fragment,t),o=!1},d(t){v(e,t)}}}function rt(f){let e,o,t,r,s,u,p,l;e=new A({props:{position:"fixed",leftBack:"black",$$slots:{default:[et]},$$scope:{ctx:f}}}),t=new G({}),s=new Z({props:{position:"fixed",$$slots:{right:[at]},$$scope:{ctx:f}}});let m=nt();return{c(){h(e.$$.fragment),o=I(),h(t.$$.fragment),r=I(),h(s.$$.fragment),u=I(),m&&m.c(),p=F()},l(a){b(e.$$.fragment,a),o=P(a),b(t.$$.fragment,a),r=P(a),b(s.$$.fragment,a),u=P(a),m&&m.l(a),p=F()},m(a,n){w(e,a,n),x(a,o,n),w(t,a,n),x(a,r,n),w(s,a,n),x(a,u,n),m&&m.m(a,n),x(a,p,n),l=!0},p(a,[n]){const i={};n&256&&(i.$$scope={dirty:n,ctx:a}),e.$set(i);const c={};n&256&&(c.$$scope={dirty:n,ctx:a}),s.$set(c)},i(a){l||($(e.$$.fragment,a),$(t.$$.fragment,a),$(s.$$.fragment,a),$(m),l=!0)},o(a){g(e.$$.fragment,a),g(t.$$.fragment,a),g(s.$$.fragment,a),g(m),l=!1},d(a){a&&(d(o),d(r),d(u),d(p)),v(e,a),v(t,a),v(s,a),m&&m.d(a)}}}const y=60;function ot(f,e,o){let t;B(f,Q,n=>o(3,t=n));let{data:r}=e,s=r.box,u=r.places;D(async()=>{await m()}),O(()=>{_.un("change",a)});const p=[];let l=[];async function m(){var n;if(u.length!==0){l=u.filter(i=>!i.longitude||!i.latitude||p.includes(i.idx)?!1:(p.push(i.idx),!0)),!t.url.searchParams.get("location")&&l.length>0&&_.on("change",a);for await(let i of l){let c=(n=i.media)==null?void 0:n.at(0);if(!String(c).includes("youtu")){const N=M(c);await X(N)&&(c=c+"-thumbnail")}i.thumbnail=c}R.emit("addIcons",l.map(i=>({idx:Number(i.idx),coordinate:W([i.longitude,i.latitude]),image:M(i.thumbnail||"",500),shape:"point",type:"place",link:`/places/${i.idx}?boxIdx=${s.idx}`,rank:1,name:i.name,width:38,height:46})))}}function a(){if(_.getFeatures().length!==l.length)return;_.un("change",a);const n=_.getExtent();K.fit(n,{padding:[y,y,y,y],duration:500,maxZoom:16})}return f.$$set=n=>{"data"in n&&o(1,r=n.data)},[s,r]}class yt extends C{constructor(e){super(),T(this,e,ot,rt,S,{data:1})}}export{yt as component,vt as universal};
