import{s as oe,m as Ae,e as S,c as P,b as Y,f as h,v as g,J as me,i as L,A as B,H as Z,G as Ie,u as Te,o as Oe,p as Se,F as we,I as ne,T as ee,w as Ee,a as X,U as Pe,g as Q,h as H,x as ve,k as te,y as Le,B as Me,D as pe,n as W}from"../chunks/scheduler.DnGlJ4RW.js";import{S as se,i as ie,t as w,a as A,c as D,d as F,m as q,f as z,b as $e,e as de,g as _e}from"../chunks/index.D2MnZ5yf.js";import{H as je}from"../chunks/Header.Bv7WMWou.js";import{V as Ce}from"../chunks/Viewer.pxW9A4KF.js";import{p as ye}from"../chunks/stores.CJ96Josu.js";import{N as Ne}from"../chunks/NavigationBar.DX80pXg9.js";import"../chunks/device.BJYfdIlo.js";import"../chunks/ActionSheet.svelte_svelte_type_style_lang.KT-G-S3w.js";/* empty css                                                   */import{I as V,d as Re,e as he,A as ge}from"../chunks/store.CfnJ9aye.js";import{g as Ve}from"../chunks/entry.DVTSSoyw.js";import"../chunks/emitter.E5P-NQ8u.js";import{g as Be}from"../chunks/sign.CB2eHpZ5.js";/* empty css                                                   */import{P as De}from"../chunks/picker.DO1g6OCe.js";import{I as Fe}from"../chunks/IconSearch.BfoE4IIP.js";import{A as qe}from"../chunks/ActionSheetOpenApp.BxvwztUb.js";import{s as ke}from"../chunks/s32cloudfront.BBdXiwkF.js";import{i as ze}from"../chunks/isVideoFile.DGBlGWVm.js";function Ge(o){let e,n,t,i,c;const f=o[5].default,a=Ae(f,o,o[4],null);return{c(){e=S("div"),a&&a.c(),this.h()},l(r){e=P(r,"DIV",{id:!0,class:!0,"aria-hidden":!0});var u=Y(e);a&&a.l(u),u.forEach(h),this.h()},h(){g(e,"id","mask"),g(e,"class",n=me(`${o[0]?"":"hidden"} ${o[1]}`)+" svelte-eerk6g"),g(e,"aria-hidden","")},m(r,u){L(r,e,u),a&&a.m(e,null),t=!0,i||(c=[B(e,"touchstart",Z(Ie(o[6]))),B(e,"touchend",o[7],{passive:!0}),B(e,"click",o[8])],i=!0)},p(r,[u]){a&&a.p&&(!t||u&16)&&Te(a,f,r,r[4],t?Se(f,r[4],u,null):Oe(r[4]),null),(!t||u&3&&n!==(n=me(`${r[0]?"":"hidden"} ${r[1]}`)+" svelte-eerk6g"))&&g(e,"class",n)},i(r){t||(w(a,r),t=!0)},o(r){A(a,r),t=!1},d(r){r&&h(e),a&&a.d(r),i=!1,we(c)}}}function Ue(o,e,n){let{$$slots:t={},$$scope:i}=e,{onMask:c=!1}=e,{position:f="fixed"}=e,{closeOnClick:a=!1}=e,{onTouch:r=void 0}=e;function u(p){ne.call(this,o,p)}const _=()=>{a?n(0,c=!1):r&&r()},M=()=>{a?n(0,c=!1):r&&r()};return o.$$set=p=>{"onMask"in p&&n(0,c=p.onMask),"position"in p&&n(1,f=p.position),"closeOnClick"in p&&n(2,a=p.closeOnClick),"onTouch"in p&&n(3,r=p.onTouch),"$$scope"in p&&n(4,i=p.$$scope)},[c,f,a,r,i,t,u,_,M]}class He extends se{constructor(e){super(),ie(this,e,Ue,Ge,oe,{onMask:0,position:1,closeOnClick:2,onTouch:3})}}function Je(o){let e,n,t;return{c(){e=S("emoji-picker"),this.h()},l(i){e=P(i,"EMOJI-PICKER",{"aria-hidden":!0,class:!0}),Y(e).forEach(h),this.h()},h(){ee(e,"aria-hidden",""),ee(e,"class",o[0])},m(i,c){L(i,e,c),n||(t=[B(e,"emoji-click",Z(Ie(o[2]))),B(e,"touchstart",Z(o[4])),B(e,"touchend",Z(o[5]))],n=!0)},p(i,c){c&1&&ee(e,"class",i[0])},d(i){i&&h(e),n=!1,we(t)}}}function Ke(o){let e,n;return e=new He({props:{onMask:!0,position:"absolute",onTouch:o[6],$$slots:{default:[Je]},$$scope:{ctx:o}}}),{c(){D(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){q(e,t,i),n=!0},p(t,[i]){const c={};i&2&&(c.onTouch=t[6]),i&257&&(c.$$scope={dirty:i,ctx:t}),e.$set(c)},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function Xe(o,e,n){let{classList:t}=e,{onSelect:i}=e,{close:c}=e;function f(_){i(_.detail.unicode)}new De({emojiVersion:15});function a(_){ne.call(this,o,_)}function r(_){ne.call(this,o,_)}const u=()=>{c()};return o.$$set=_=>{"classList"in _&&n(0,t=_.classList),"onSelect"in _&&n(3,i=_.onSelect),"close"in _&&n(1,c=_.close)},[t,c,f,i,a,r,u]}class Qe extends se{constructor(e){super(),ie(this,e,Xe,Ke,oe,{classList:0,onSelect:3,close:1})}}function We(o){let e,n,t,i,c,f;return t=new Fe({props:{width:"24",height:"24"}}),{c(){e=S("div"),n=S("button"),D(t.$$.fragment),this.h()},l(a){e=P(a,"DIV",{class:!0});var r=Y(e);n=P(r,"BUTTON",{});var u=Y(n);F(t.$$.fragment,u),u.forEach(h),r.forEach(h),this.h()},h(){g(e,"class","flex items-center gap-2")},m(a,r){L(a,e,r),H(e,n),q(t,n,null),i=!0,c||(f=B(n,"click",o[10]),c=!0)},i(a){i||(w(t.$$.fragment,a),i=!0)},o(a){A(t.$$.fragment,a),i=!1},d(a){a&&h(e),z(t),c=!1,f()}}}function Ye(o){let e,n,t=!V&&We(o);return{c(){t&&t.c(),e=pe()},l(i){t&&t.l(i),e=pe()},m(i,c){t&&t.m(i,c),L(i,e,c),n=!0},p:W,i(i){n||(w(t),n=!0)},o(i){A(t),n=!1},d(i){i&&h(e),t&&t.d(i)}}}function Ze(o){let e,n,t;function i(f){o[12](f)}let c={posts:o[0].posts,selectedReaction:o[2],whenCancelForExternalLink:o[11]};return o[0].index!==void 0&&(c.index=o[0].index),e=new Ce({props:c}),Ee.push(()=>$e(e,"index",i)),{c(){D(e.$$.fragment)},l(f){F(e.$$.fragment,f)},m(f,a){q(e,f,a),t=!0},p(f,a){const r={};a&1&&(r.posts=f[0].posts),a&4&&(r.selectedReaction=f[2]),a&8&&(r.whenCancelForExternalLink=f[11]),!n&&a&1&&(n=!0,r.index=f[0].index,ve(()=>n=!1)),e.$set(r)},i(f){t||(w(e.$$.fragment,f),t=!0)},o(f){A(e.$$.fragment,f),t=!1},d(f){z(e,f)}}}function xe(o){let e;return{c(){e=S("div"),this.h()},l(n){e=P(n,"DIV",{class:!0}),Y(e).forEach(h),this.h()},h(){g(e,"class","w-full h-full")},m(n,t){L(n,e,t)},p:W,i:W,o:W,d(n){n&&h(e)}}}function et(o){let e,n;return e=new Ne({}),{c(){D(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){q(e,t,i),n=!0},i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function be(o){let e,n;return e=new Qe({props:{classList:"absolute bottom-24 right-0 px-4 z-50",onSelect:o[6],close:o[13]}}),{c(){D(e.$$.fragment)},l(t){F(e.$$.fragment,t)},m(t,i){q(e,t,i),n=!0},p:W,i(t){n||(w(e.$$.fragment,t),n=!0)},o(t){A(e.$$.fragment,t),n=!1},d(t){z(e,t)}}}function tt(o){var k;let e,n,t,i,c,f,a,r,u,_,M,p,O,E,v,C,G,y,T,J,m;document.title=e=((k=o[1])==null?void 0:k.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다",p=new je({props:{position:"fixed",leftLogo:V||o[4],leftBack:!V&&!o[4]?"white":"",$$slots:{right:[Ye]},$$scope:{ctx:o}}});const $=[xe,Ze],b=[];function N(s,l){return s[0].posts.length===0?0:1}E=N(o),v=b[E]=$[E](o);let I=!V&&et(),d=o[5]&&be(o);function x(s){o[14](s)}let j={};return o[3]!==void 0&&(j.isOpen=o[3]),T=new qe({props:j}),Ee.push(()=>$e(T,"isOpen",x)),{c(){n=S("meta"),i=S("meta"),c=S("meta"),a=S("meta"),u=S("meta"),M=X(),D(p.$$.fragment),O=X(),v.c(),C=X(),I&&I.c(),G=X(),d&&d.c(),y=X(),D(T.$$.fragment),this.h()},l(s){const l=Pe("svelte-1kmz5ra",document.head);n=P(l,"META",{property:!0,content:!0}),i=P(l,"META",{property:!0,content:!0}),c=P(l,"META",{property:!0,content:!0}),a=P(l,"META",{property:!0,content:!0}),u=P(l,"META",{property:!0,content:!0}),l.forEach(h),M=Q(s),F(p.$$.fragment,s),O=Q(s),v.l(s),C=Q(s),I&&I.l(s),G=Q(s),d&&d.l(s),y=Q(s),F(T.$$.fragment,s),this.h()},h(){var s,l,R,U,K;g(n,"property","og:title"),g(n,"content",t=`블루닷 - ${((s=o[1])==null?void 0:s.unique_name)??"bluedot"} 님`),g(i,"property","og:url"),g(i,"content",`https://bluedot.land${location.pathname}${location.search}`),g(c,"property","og:image"),g(c,"content",f=((l=o[1])==null?void 0:l.image)??""),g(a,"property","og:image:alt"),g(a,"content",r=((R=o[1])==null?void 0:R.place_name)??""),g(u,"property","og:description"),g(u,"content",_=((U=o[1])==null?void 0:U.text)??((K=o[1])==null?void 0:K.place_name)??"")},m(s,l){H(document.head,n),H(document.head,i),H(document.head,c),H(document.head,a),H(document.head,u),L(s,M,l),q(p,s,l),L(s,O,l),b[E].m(s,l),L(s,C,l),I&&I.m(s,l),L(s,G,l),d&&d.m(s,l),L(s,y,l),q(T,s,l),m=!0},p(s,[l]){var ae,re,le,ce,fe,ue;(!m||l&2)&&e!==(e=((ae=s[1])==null?void 0:ae.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다")&&(document.title=e),(!m||l&2&&t!==(t=`블루닷 - ${((re=s[1])==null?void 0:re.unique_name)??"bluedot"} 님`))&&g(n,"content",t),(!m||l&2&&f!==(f=((le=s[1])==null?void 0:le.image)??""))&&g(c,"content",f),(!m||l&2&&r!==(r=((ce=s[1])==null?void 0:ce.place_name)??""))&&g(a,"content",r),(!m||l&2&&_!==(_=((fe=s[1])==null?void 0:fe.text)??((ue=s[1])==null?void 0:ue.place_name)??""))&&g(u,"content",_);const R={};l&16&&(R.leftLogo=V||s[4]),l&16&&(R.leftBack=!V&&!s[4]?"white":""),l&262144&&(R.$$scope={dirty:l,ctx:s}),p.$set(R);let U=E;E=N(s),E===U?b[E].p(s,l):(_e(),A(b[U],1,1,()=>{b[U]=null}),de(),v=b[E],v?v.p(s,l):(v=b[E]=$[E](s),v.c()),w(v,1),v.m(C.parentNode,C)),s[5]?d?(d.p(s,l),l&32&&w(d,1)):(d=be(s),d.c(),w(d,1),d.m(y.parentNode,y)):d&&(_e(),A(d,1,1,()=>{d=null}),de());const K={};!J&&l&8&&(J=!0,K.isOpen=s[3],ve(()=>J=!1)),T.$set(K)},i(s){m||(w(p.$$.fragment,s),w(v),w(I),w(d),w(T.$$.fragment,s),m=!0)},o(s){A(p.$$.fragment,s),A(v),A(I),A(d),A(T.$$.fragment,s),m=!1},d(s){s&&(h(M),h(O),h(C),h(G),h(y)),h(n),h(i),h(c),h(a),h(u),z(p,s),b[E].d(s),I&&I.d(s),d&&d.d(s),z(T,s)}}}function nt(o,e,n){let t,i,c,f,a,r;te(o,ye,m=>n(9,f=m)),te(o,Re,m=>n(16,a=m)),te(o,he,m=>n(5,r=m));let u={posts:[],index:0},_,M,p=!1,O;Le(async()=>{let m="";try{m=Be()}catch{}const $=new URLSearchParams(window.location.search),b=Number($.get("postIdx")||0);Number($.get("mediaIdx")||0);const N=0,I=30,d=`&offset=${N}`,x=`&limit=${I}`;let j=[];(i||t)&&a.length>0?(j=a.map(k=>k.idx===b?{...k,mediaIdx:k.mediaIdx||0}:{...k,mediaIdx:0}),n(0,u.index=j.findIndex(k=>k.idx===String(b)),u)):(O=new AbortController,b&&(j=[await fetch(`${ge}/posts/${b}`,{method:"GET",headers:{Authorization:"Bearer "+m},signal:O.signal}).then(k=>k.json()).then(k=>({...k.data,mediaIdx:k.data.mediaIdx||0}))]),j=[...j,...await fetch(`${ge}/posts?${d}${x}`,{method:"GET",headers:{Authorization:"Bearer "+m},signal:O.signal}).then(k=>k.json()).then(k=>{var s;return(s=k.data)==null?void 0:s.posts.filter(l=>l.idx!==String(b)).map(l=>({...l,mediaIdx:l.mediaIdx||0}))})||[]]),n(0,u.posts=j,u)}),Me(()=>{O&&O.abort()});async function E(m){const $=f.url.searchParams.get("postIdx");$&&n(2,M={postIdx:$,reaction:m})}async function v(m){var b;let $=(b=u.posts)==null?void 0:b.at(m);if($){let N=$.media[0];if(N){const I=ke(N,1100);if(I.includes("youtu"))$.image=I;else{const d=await ze(I);$.image=d?ke(N+"-thumbnail",1100):I}}}n(1,_=$)}const C=async()=>{await Ve("/search")},G=()=>{if(V)return n(3,p=!0)};function y(m){o.$$.not_equal(u.index,m)&&(u.index=m,n(0,u))}const T=()=>{he.set(!1)};function J(m){p=m,n(3,p)}return o.$$.update=()=>{o.$$.dirty&512&&n(7,t=f.url.searchParams.get("placeIdx")),o.$$.dirty&512&&n(8,i=f.url.searchParams.get("userIdx")),o.$$.dirty&384&&n(4,c=!t&&!i),o.$$.dirty&1&&v(u.index)},[u,_,M,p,c,r,E,t,i,f,C,G,y,T,J]}class Et extends se{constructor(e){super(),ie(this,e,nt,tt,oe,{})}}export{Et as component};
