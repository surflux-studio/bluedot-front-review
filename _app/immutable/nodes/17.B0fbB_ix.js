import{e as ue}from"../chunks/index.Ca0tKiOI.js";import{g as ne,A as oe,d as ie,H as ce,e as j}from"../chunks/Header.FoXJ-u0t.js";import{s as de,e as f,a as E,c as g,b as C,g as D,D as R,f as d,m as r,K as le,i as U,h as u,M as V,p as L,x as me,t as X,d as Y,G as Q,H as W}from"../chunks/scheduler.B4Oq0Y6j.js";import{S as fe,i as ge,c as pe,b as he,m as Ce,t as be,a as _e,d as ve}from"../chunks/index.Dwy94kkp.js";import{g as ye}from"../chunks/entry.CMhpHdxa.js";import{u as Be}from"../chunks/photo.7bPzKGjQ.js";const ke=async({params:n,fetch:t,depends:e})=>{if(String(n.idx)!==String(ne()))throw ue(403,"Forbidden");const a=(await(await t(`${oe}/auth/users/${n.idx}`,{headers:{Authorization:`Bearer ${ie()}`}})).json()).data;if(!(a!=null&&a.idx))throw ue(404,"User not found");return{user:a}},Ue=Object.freeze(Object.defineProperty({__proto__:null,load:ke},Symbol.toStringTag,{value:"Module"}));function xe(n){let t;return{c(){t=X("프로필 편집")},l(e){t=Y(e,"프로필 편집")},m(e,o){U(e,t,o)},d(e){e&&d(t)}}}function we(n){let t;return{c(){t=X("저장하기")},l(e){t=Y(e,"저장하기")},m(e,o){U(e,t,o)},d(e){e&&d(t)}}}function Ee(n){let t,e,o,s;return{c(){t=Q("svg"),e=Q("circle"),o=Q("path"),s=X(`
          저장 중...`),this.h()},l(a){t=W(a,"svg",{class:!0,viewBox:!0});var c=C(t);e=W(c,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),C(e).forEach(d),o=W(c,"path",{class:!0,fill:!0,d:!0}),C(o).forEach(d),c.forEach(d),s=Y(a,`
          저장 중...`),this.h()},h(){r(e,"class","opacity-25"),r(e,"cx","12"),r(e,"cy","12"),r(e,"r","10"),r(e,"stroke","currentColor"),r(e,"stroke-width","4"),r(e,"fill","none"),r(o,"class","opacity-75"),r(o,"fill","currentColor"),r(o,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),r(t,"class","animate-spin h-5 w-5 mr-3 text-white"),r(t,"viewBox","0 0 24 24")},m(a,c){U(a,t,c),u(t,e),u(t,o),U(a,s,c)},d(a){a&&(d(t),d(s))}}}function De(n){let t,e,o,s,a,c,p,I,$,b,q='<svg class="w-4 h-4 text-gray-600 dark:text-gray-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',A,i,_,T="이메일 (변경 불가)",O,v,G,x,w,Z="닉네임 (Unique Name)",J,y,F,N,B,S,K,ee;e=new ce({props:{position:"static",leftBack:!0,$$slots:{default:[xe]},$$scope:{ctx:n}}});function te(l,m){return l[3]?Ee:we}let P=te(n),k=P(n);return{c(){t=f("div"),pe(e.$$.fragment),o=E(),s=f("main"),a=f("div"),c=f("div"),p=f("img"),$=E(),b=f("button"),b.innerHTML=q,A=E(),i=f("div"),_=f("label"),_.textContent=T,O=E(),v=f("input"),G=E(),x=f("div"),w=f("label"),w.textContent=Z,J=E(),y=f("input"),F=E(),N=f("div"),B=f("button"),k.c(),this.h()},l(l){t=g(l,"DIV",{class:!0});var m=C(t);he(e.$$.fragment,m),o=D(m),s=g(m,"MAIN",{class:!0});var h=C(s);a=g(h,"DIV",{class:!0});var re=C(a);c=g(re,"DIV",{class:!0});var M=C(c);p=g(M,"IMG",{class:!0,src:!0,alt:!0}),$=D(M),b=g(M,"BUTTON",{class:!0,"data-svelte-h":!0}),R(b)!=="svelte-1bzn6op"&&(b.innerHTML=q),M.forEach(d),re.forEach(d),A=D(h),i=g(h,"DIV",{class:!0});var z=C(i);_=g(z,"LABEL",{class:!0,"data-svelte-h":!0}),R(_)!=="svelte-mkvsoj"&&(_.textContent=T),O=D(z),v=g(z,"INPUT",{type:!0,class:!0}),z.forEach(d),G=D(h),x=g(h,"DIV",{class:!0});var H=C(x);w=g(H,"LABEL",{class:!0,"data-svelte-h":!0}),R(w)!=="svelte-g6muw9"&&(w.textContent=Z),J=D(H),y=g(H,"INPUT",{type:!0,class:!0,placeholder:!0}),H.forEach(d),F=D(h),N=g(h,"DIV",{class:!0});var ae=C(N);B=g(ae,"BUTTON",{class:!0});var se=C(B);k.l(se),se.forEach(d),ae.forEach(d),h.forEach(d),m.forEach(d),this.h()},h(){r(p,"class","w-24 h-24 rounded-full object-cover border border-gray-200 dark:border-gray-700"),le(p.src,I=n[2])||r(p,"src",I),r(p,"alt","Profile Image"),r(b,"class","absolute bottom-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full p-2 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-sm"),r(c,"class","relative"),r(a,"class","flex justify-center mt-6 mb-4"),r(_,"class","block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"),r(v,"type","text"),r(v,"class","w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-200 cursor-not-allowed"),v.disabled=!0,r(i,"class","mb-4"),r(w,"class","block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"),r(y,"type","text"),r(y,"class","w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-md text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500"),r(y,"placeholder","예) mynickname"),r(x,"class","mb-4"),r(B,"class","w-full px-4 py-3 text-white hover:bg-primary-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 flex items-center justify-center bg-gradient-to-br from-primary-400 from-0% to-emerald-400 to-80% "),B.disabled=n[3],r(N,"class","mt-6"),r(s,"class","flex-1 px-4 py-6"),r(t,"class","flex flex-col min-h-screen")},m(l,m){U(l,t,m),Ce(e,t,null),u(t,o),u(t,s),u(s,a),u(a,c),u(c,p),u(c,$),u(c,b),u(s,A),u(s,i),u(i,_),u(i,O),u(i,v),V(v,n[0].email),u(s,G),u(s,x),u(x,w),u(x,J),u(x,y),V(y,n[1]),u(s,F),u(s,N),u(N,B),k.m(B,null),S=!0,K||(ee=[L(b,"click",n[6]),L(v,"input",n[7]),L(y,"input",n[8]),L(B,"click",n[4])],K=!0)},p(l,[m]){const h={};m&1024&&(h.$$scope={dirty:m,ctx:l}),e.$set(h),(!S||m&4&&!le(p.src,I=l[2]))&&r(p,"src",I),m&1&&v.value!==l[0].email&&V(v,l[0].email),m&2&&y.value!==l[1]&&V(y,l[1]),P!==(P=te(l))&&(k.d(1),k=P(l),k&&(k.c(),k.m(B,null))),(!S||m&8)&&(B.disabled=l[3])},i(l){S||(be(e.$$.fragment,l),S=!0)},o(l){_e(e.$$.fragment,l),S=!1},d(l){l&&d(t),ve(e),k.d(),K=!1,me(ee)}}}function Ie(n,t,e){let{data:o}=t,{user:s}=o,a=s.unique_name||"",c=s.profile_image_url||"",p=!1;function I(){return a.trim()?/^[a-z0-9._]{1,30}$/.test(a)?!0:(j.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(j.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1)}async function $(){if(I()){e(3,p=!0);try{const i=ne(),_=await fetch(`${oe}/auth/users/${i}`,{method:"PATCH",headers:{Authorization:`Bearer ${ie()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:a,profileImage:c})});if(_.ok)j.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),ye(`/users/${i}`);else{const T=await _.json();console.error(T),j.emit("pushSnackbar",{message:T.message||"프로필 수정에 실패했습니다."})}}catch(i){console.error(i),j.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}e(3,p=!1)}}const b=()=>{Be({mutiple:!1}).then(i=>{i.length>0&&e(2,c=i[0])})};function q(){s.email=this.value,e(0,s)}function A(){a=this.value,e(1,a)}return n.$$set=i=>{"data"in i&&e(5,o=i.data)},[s,a,c,p,$,o,b,q,A]}class qe extends fe{constructor(t){super(),ge(this,t,Ie,De,de,{data:5})}}export{qe as component,Ue as universal};
