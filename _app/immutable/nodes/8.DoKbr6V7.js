import{g as ie}from"../chunks/entry.C0kOxo6C.js";import{g as Me,e as z,s as de,A as Pe}from"../chunks/sign.0LSMDjDO.js";import{s as Ie,e as h,c as C,b as y,f as b,q as p,i as J,n as G,C as ge,a as B,t as ze,g as $,E as F,d as Fe,r as De,h as u,L as Te,v as W,D as _e,y as Ue,k as qe,B as Re,R as Ae,X as ve}from"../chunks/scheduler.CAgUjVVh.js";import{S as He,i as Le,e as xe,c as se,b as ae,m as ne,t as K,a as Q,d as le}from"../chunks/index.BArRcuOw.js";import{H as Ze}from"../chunks/Header.DcbN9C6J.js";import{F as Ge}from"../chunks/Field.m1jJQR91.js";import{g as Je,c as Xe}from"../chunks/photo.Clvzjxfn.js";import{s as Oe}from"../chunks/s32cloudfront.CcvdOjpW.js";import{S as Ke}from"../chunks/Select.pzJhrpCD.js";import{A as Qe}from"../chunks/ActionSheet.B696ANUG.js";const We="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.5339%204.27187L6.1839%205.62187H3.6V13.7219H14.4V5.62187H11.8161L10.4661%204.27187H7.5339ZM6.975%202.92188H11.025L12.375%204.27187H15.075C15.254%204.27187%2015.4257%204.34299%2015.5523%204.46958C15.6789%204.59616%2015.75%204.76785%2015.75%204.94687V14.3969C15.75%2014.5759%2015.6789%2014.7476%2015.5523%2014.8742C15.4257%2015.0008%2015.254%2015.0719%2015.075%2015.0719H2.925C2.74598%2015.0719%202.57429%2015.0008%202.4477%2014.8742C2.32112%2014.7476%202.25%2014.5759%202.25%2014.3969V4.94687C2.25%204.76785%202.32112%204.59616%202.4477%204.46958C2.57429%204.34299%202.74598%204.27187%202.925%204.27187H5.625L6.975%202.92188ZM9%2013.0469C8.01538%2013.0469%207.07109%2012.6557%206.37487%2011.9595C5.67864%2011.2633%205.2875%2010.319%205.2875%209.33437C5.2875%208.34976%205.67864%207.40547%206.37487%206.70924C7.07109%206.01301%208.01538%205.62187%209%205.62187C9.98462%205.62187%2010.9289%206.01301%2011.6251%206.70924C12.3214%207.40547%2012.7125%208.34976%2012.7125%209.33437C12.7125%2010.319%2012.3214%2011.2633%2011.6251%2011.9595C10.9289%2012.6557%209.98462%2013.0469%209%2013.0469ZM9%2011.6969C9.62657%2011.6969%2010.2275%2011.448%2010.6705%2011.0049C11.1136%2010.5619%2011.3625%209.96095%2011.3625%209.33437C11.3625%208.7078%2011.1136%208.10689%2010.6705%207.66384C10.2275%207.22078%209.62657%206.97187%209%206.97187C8.37343%206.97187%207.77251%207.22078%207.32946%207.66384C6.88641%208.10689%206.6375%208.7078%206.6375%209.33437C6.6375%209.96095%206.88641%2010.5619%207.32946%2011.0049C7.77251%2011.448%208.37343%2011.6969%209%2011.6969Z'%20fill='%234B5362'/%3e%3c/svg%3e",Ye={idx:"-1",name:"",image:null,role:null},et=async({params:a,parent:e})=>{var l;const t=a.idx,s=`/boxes/${t}/detail`,n=t==="-1",d=Me();if(d===null&&!n)return ie(s,{replaceState:!0});if(n)return{box:Ye,jwt:d,paramIdx:t};const m=await e();if(m.error)return z.emit("pushSnackbar",{message:"접근할 수 없습니다."}),ie(s,{replaceState:!0});const g=(l=m.data)==null?void 0:l.box;return(g==null?void 0:g.role)!=="owner"?(z.emit("pushSnackbar",{message:"접근할 수 없습니다."}),ie(s,{replaceState:!0})):{box:g,jwt:d,paramIdx:t}},_t=Object.freeze(Object.defineProperty({__proto__:null,load:et},Symbol.toStringTag,{value:"Module"}));function tt(a){let e;return{c(){e=h("div"),this.h()},l(t){e=C(t,"DIV",{class:!0}),y(e).forEach(b),this.h()},h(){p(e,"class","h-[1px] bg-gray-100")},m(t,s){J(t,e,s)},p:G,i:G,o:G,d(t){t&&b(e)}}}class st extends He{constructor(e){super(),Le(this,e,null,tt,Ie,{})}}function at(a){let e,t="설정";return{c(){e=h("div"),e.textContent=t,this.h()},l(s){e=C(s,"DIV",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-1lcayg1"&&(e.textContent=t),this.h()},h(){p(e,"class","typo-h3 text-gray-900")},m(s,n){J(s,e,n)},p:G,d(s){s&&b(e)}}}function Se(a){let e,t;return{c(){e=h("img"),this.h()},l(s){e=C(s,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){p(e,"class","w-full h-full object-cover"),Ae(e.src,t=Oe(a[1].image))||p(e,"src",t),p(e,"alt","box_image")},m(s,n){J(s,e,n)},p(s,n){n&2&&!Ae(e.src,t=Oe(s[1].image))&&p(e,"src",t)},d(s){s&&b(e)}}}function nt(a){let e,t='박스 이름 <span class="text-red-500">*</span>';return{c(){e=h("p"),e.innerHTML=t,this.h()},l(s){e=C(s,"P",{class:!0,"data-svelte-h":!0}),F(e)!=="svelte-mxo9hb"&&(e.innerHTML=t),this.h()},h(){p(e,"class","pb-1 typo-sub-h3 text-gray-500")},m(s,n){J(s,e,n)},p:G,d(s){s&&b(e)}}}function lt(a){let e,t,s,n,d="박스 삭제",m,g,l;return t=new st({}),{c(){e=h("section"),se(t.$$.fragment),s=B(),n=h("button"),n.textContent=d,this.h()},l(o){e=C(o,"SECTION",{class:!0});var r=y(e);ae(t.$$.fragment,r),s=$(r),n=C(r,"BUTTON",{class:!0,"data-svelte-h":!0}),F(n)!=="svelte-gpvhcl"&&(n.textContent=d),r.forEach(b),this.h()},h(){p(n,"class","py-3 typo-body3 text-red-500"),p(e,"class","w-full mb-28")},m(o,r){J(o,e,r),ne(t,e,null),u(e,s),u(e,n),m=!0,g||(l=W(n,"click",a[14]),g=!0)},p:G,i(o){m||(K(t.$$.fragment,o),m=!0)},o(o){Q(t.$$.fragment,o),m=!1},d(o){o&&b(e),le(t),g=!1,l()}}}function it(a){let e,t,s="박스를 정말 삭제할까요?",n,d,m="확인",g,l;return{c(){e=h("div"),t=h("p"),t.textContent=s,n=B(),d=h("button"),d.textContent=m,this.h()},l(o){e=C(o,"DIV",{class:!0});var r=y(e);t=C(r,"P",{class:!0,"data-svelte-h":!0}),F(t)!=="svelte-gw0nb6"&&(t.textContent=s),n=$(r),d=C(r,"BUTTON",{class:!0,"data-svelte-h":!0}),F(d)!=="svelte-1geai0a"&&(d.textContent=m),r.forEach(b),this.h()},h(){p(t,"class","pb-1 typo-body1 text-gray-300"),p(d,"class","w-full h-14 bg-primary-500 rounded-md text-white disabled:opacity-50"),p(e,"class","px-4")},m(o,r){J(o,e,r),u(e,t),u(e,n),u(e,d),g||(l=W(d,"click",a[9]),g=!0)},p:G,d(o){o&&b(e),g=!1,l()}}}function ot(a){let e,t,s,n,d,m,g=`<div class="flex flex-row gap-1 items-center"><img src="${We}" alt="camera icon"/> <p class="typo-body3 text-gray-700">사진 변경</p></div>`,l,o,r,x,U,q,E,O,H,oe="박스 설명",Y,k,ee,L,V,re='<p class="pb-1 typo-sub-h3 text-gray-500">박스 공개 설정</p>',te,D,c,T,j,N,w,_,S,me,ue,ce,he,M,Ce,X,be,ye;t=new Ze({props:{position:"static",leftBack:"black",$$slots:{default:[at]},$$scope:{ctx:a}}});let v=a[1].image&&Se(a);function Ve(i){a[11](i)}let we={clear:!0,padding:"",border:"border-b-[1.5px] border-b-gray-900 pb-2.5",fontSize:"text-lg",limit:20,onInput:a[7],$$slots:{default:[nt]},$$scope:{ctx:a}};a[1].name!==void 0&&(we.value=a[1].name),x=new Ge({props:we}),ge.push(()=>xe(x,"value",Ve));function je(i){a[13](i)}let Be={width:"w-full",options:Object.keys(a[5])};a[0]!==void 0&&(Be.selected=a[0]),D=new Ke({props:Be}),ge.push(()=>xe(D,"selected",je));let A=!a[4]&&lt(a);function Ne(i){a[16](i)}let $e={onClose:a[15],maxHeight:150,defaultHeight:150,$$slots:{default:[it]},$$scope:{ctx:a}};return a[3]!==void 0&&($e.isOpen=a[3]),M=new Qe({props:$e}),ge.push(()=>xe(M,"isOpen",Ne)),{c(){e=h("div"),se(t.$$.fragment),s=B(),n=h("section"),v&&v.c(),d=B(),m=h("button"),m.innerHTML=g,l=B(),o=h("section"),r=h("section"),se(x.$$.fragment),q=B(),E=h("div"),O=h("label"),H=h("p"),H.textContent=oe,Y=B(),k=h("textarea"),ee=B(),L=h("div"),V=h("lable"),V.innerHTML=re,te=B(),se(D.$$.fragment),T=B(),j=h("section"),N=B(),A&&A.c(),w=B(),_=h("div"),S=h("button"),me=ze("저장"),he=B(),se(M.$$.fragment),this.h()},l(i){e=C(i,"DIV",{class:!0});var f=y(e);ae(t.$$.fragment,f),s=$(f),n=C(f,"SECTION",{class:!0});var R=y(n);v&&v.l(R),d=$(R),m=C(R,"BUTTON",{class:!0,"data-svelte-h":!0}),F(m)!=="svelte-o1fuye"&&(m.innerHTML=g),R.forEach(b),l=$(f),o=C(f,"SECTION",{class:!0});var I=y(o);r=C(I,"SECTION",{class:!0});var P=y(r);ae(x.$$.fragment,P),q=$(P),E=C(P,"DIV",{});var Z=y(E);O=C(Z,"LABEL",{class:!0});var fe=y(O);H=C(fe,"P",{class:!0,"data-svelte-h":!0}),F(H)!=="svelte-1uk7vkf"&&(H.textContent=oe),Y=$(fe),k=C(fe,"TEXTAREA",{class:!0}),y(k).forEach(b),fe.forEach(b),Z.forEach(b),ee=$(P),L=C(P,"DIV",{});var pe=y(L);V=C(pe,"LABLE",{class:!0,"data-svelte-h":!0}),F(V)!=="svelte-1cgggel"&&(V.innerHTML=re),te=$(pe),ae(D.$$.fragment,pe),pe.forEach(b),P.forEach(b),T=$(I),j=C(I,"SECTION",{class:!0}),y(j).forEach(b),N=$(I),A&&A.l(I),I.forEach(b),w=$(f),_=C(f,"DIV",{class:!0});var Ee=y(_);S=C(Ee,"BUTTON",{class:!0});var ke=y(S);me=Fe(ke,"저장"),ke.forEach(b),Ee.forEach(b),he=$(f),ae(M.$$.fragment,f),f.forEach(b),this.h()},h(){p(m,"class","absolute bottom-4 right-4 bg-white rounded-3xl px-3.5 py-1.5"),p(n,"class","box-image relative w-full h-52 bg-gray-100"),p(H,"class","pb-1 typo-sub-h3 text-gray-500"),p(k,"class","auto-height w-full py-1 focus:ring-0bg-white text-sm svelte-10zrx5e"),p(O,"class","w-full"),p(V,"class","w-full"),p(r,"class","box-name flex flex-col gap-6 py-6"),p(j,"class","w-full min-h-20"),p(o,"class","box-setting px-4"),p(S,"class",ue=De(`w-full ${a[2]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-10zrx5e"),S.disabled=ce=!a[2],p(_,"class","fixed w-full bottom-0 left-0 px-4 pt-3 pb-10 z-10 bg-white upper-box-shadow svelte-10zrx5e"),p(e,"class","min-h-dvh")},m(i,f){J(i,e,f),ne(t,e,null),u(e,s),u(e,n),v&&v.m(n,null),u(n,d),u(n,m),u(e,l),u(e,o),u(o,r),ne(x,r,null),u(r,q),u(r,E),u(E,O),u(O,H),u(O,Y),u(O,k),Te(k,a[1].description),u(r,ee),u(r,L),u(L,V),u(L,te),ne(D,L,null),u(o,T),u(o,j),u(o,N),A&&A.m(o,null),u(e,w),u(e,_),u(_,S),u(S,me),u(e,he),ne(M,e,null),X=!0,be||(ye=[W(m,"click",a[6]),W(k,"input",a[12]),W(k,"input",a[7]),W(S,"click",a[8])],be=!0)},p(i,[f]){const R={};f&8388608&&(R.$$scope={dirty:f,ctx:i}),t.$set(R),i[1].image?v?v.p(i,f):(v=Se(i),v.c(),v.m(n,d)):v&&(v.d(1),v=null);const I={};f&8388608&&(I.$$scope={dirty:f,ctx:i}),!U&&f&2&&(U=!0,I.value=i[1].name,_e(()=>U=!1)),x.$set(I),f&2&&Te(k,i[1].description);const P={};!c&&f&1&&(c=!0,P.selected=i[0],_e(()=>c=!1)),D.$set(P),i[4]||A.p(i,f),(!X||f&4&&ue!==(ue=De(`w-full ${i[2]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-10zrx5e"))&&p(S,"class",ue),(!X||f&4&&ce!==(ce=!i[2]))&&(S.disabled=ce);const Z={};f&8&&(Z.onClose=i[15]),f&8388608&&(Z.$$scope={dirty:f,ctx:i}),!Ce&&f&8&&(Ce=!0,Z.isOpen=i[3],_e(()=>Ce=!1)),M.$set(Z)},i(i){X||(K(t.$$.fragment,i),K(x.$$.fragment,i),K(D.$$.fragment,i),K(A),K(M.$$.fragment,i),X=!0)},o(i){Q(t.$$.fragment,i),Q(x.$$.fragment,i),Q(D.$$.fragment,i),Q(A),Q(M.$$.fragment,i),X=!1},d(i){i&&b(e),le(t),v&&v.d(),le(x),le(D),A&&A.d(),le(M),be=!1,Ue(ye)}}}function rt(a,e,t){let s;qe(a,de,c=>t(18,s=c));let{data:n}=e;const d=n.paramIdx,m=d==="-1";let g=n.jwt,l=n.box;const o=`${Pe}/boxes`;let r=!1,x=!1;const U={"전체 공개":"public","팔로워 공개":"follower",비공개:"private"};let q="팔로워 공개";if(l.visibility){for(const[c,T]of Object.entries(U))if(l.visibility===T){q=c;break}}let E=q;function O(c){t(2,r=c!==q)}async function H(){var c;try{z.emit("loading",!0);const T=await Je();if(!T.blob)return;const j=await Xe(T.blob),N=new FormData;N.append("image",j);const w=await fetch(`${o}/image`,{method:"POST",body:N,headers:{Authorization:`Bearer ${g}`}});if(!w.ok)return z.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});const _=await w.json();t(1,l.image=((c=_.data)==null?void 0:c.image)??null,l),t(2,r=!0)}catch{}z.emit("loading",!1)}function oe(){t(2,r=!0)}async function Y(){if(!r||(t(1,l.name=l.name.trim(),l),!l.name))return;let c="follower";for(const[w,_]of Object.entries(U))if(E===w){c=_;break}const{url:T,method:j}=m?{url:o,method:"POST"}:{url:`${o}/${d}`,method:"PATCH"},N=await fetch(T,{method:j,headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`},body:JSON.stringify({name:l.name,description:l.description,image:l.image,visibility:c})});if(!N.ok)return z.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});m?(N.json().then(w=>{const _=w.data;_.role="owner",_.visibility=c,_.is_subcribed=!1,_.place_count="0",_.member_count="1",ve(de,s=[_,...s],s)}),z.emit("pushSnackbar",{message:"새 박스를 만들었습니다"}),ie("/boxes")):(ve(de,s=s.map(w=>w.idx===l.idx?(t(1,l.visibility=c,l),l):w),s),z.emit("pushSnackbar",{message:"박스를 수정했습니다."})),t(2,r=!1)}Re(()=>{m&&t(1,l.name="",l)});async function k(){await fetch(`${o}/${d}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}}),ve(de,s=s.filter(c=>c.idx!==l.idx),s),z.emit("pushSnackbar",{message:`${l.name} 박스를 삭제했습니다.`}),ie("/boxes")}function ee(c){a.$$.not_equal(l.name,c)&&(l.name=c,t(1,l))}function L(){l.description=this.value,t(1,l)}function V(c){E=c,t(0,E)}const re=()=>t(3,x=!0),te=()=>t(3,x=!1);function D(c){x=c,t(3,x)}return a.$$set=c=>{"data"in c&&t(10,n=c.data)},a.$$.update=()=>{a.$$.dirty&1&&O(E)},[E,l,r,x,m,U,H,oe,Y,k,n,ee,L,V,re,te,D]}class vt extends He{constructor(e){super(),Le(this,e,rt,ot,Ie,{data:10})}}export{vt as component,_t as universal};
