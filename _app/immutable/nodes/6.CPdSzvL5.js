import{d as fe,A as ie,e as y,H as me,k as te}from"../chunks/Header.FoXJ-u0t.js";import{g as N}from"../chunks/entry.CMhpHdxa.js";import{s as re,e as b,c as g,b as E,f as h,m,i as L,n as j,B as de,a as I,t as pe,g as S,D as Z,d as he,o as se,h as p,p as F,C as Ce,x as be,k as ge,A as _e,K as ae,U as xe}from"../chunks/scheduler.B4Oq0Y6j.js";import{S as le,i as ue,e as ve,c as G,b as J,m as R,t as z,a as U,d as K}from"../chunks/index.Dwy94kkp.js";import{F as $e}from"../chunks/Field.2ZpjzqQB.js";import{g as we,c as Be}from"../chunks/photo.7bPzKGjQ.js";import{s as ne}from"../chunks/s32cloudfront.bAl2UV-x.js";const ye="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.5339%204.27187L6.1839%205.62187H3.6V13.7219H14.4V5.62187H11.8161L10.4661%204.27187H7.5339ZM6.975%202.92188H11.025L12.375%204.27187H15.075C15.254%204.27187%2015.4257%204.34299%2015.5523%204.46958C15.6789%204.59616%2015.75%204.76785%2015.75%204.94687V14.3969C15.75%2014.5759%2015.6789%2014.7476%2015.5523%2014.8742C15.4257%2015.0008%2015.254%2015.0719%2015.075%2015.0719H2.925C2.74598%2015.0719%202.57429%2015.0008%202.4477%2014.8742C2.32112%2014.7476%202.25%2014.5759%202.25%2014.3969V4.94687C2.25%204.76785%202.32112%204.59616%202.4477%204.46958C2.57429%204.34299%202.74598%204.27187%202.925%204.27187H5.625L6.975%202.92188ZM9%2013.0469C8.01538%2013.0469%207.07109%2012.6557%206.37487%2011.9595C5.67864%2011.2633%205.2875%2010.319%205.2875%209.33437C5.2875%208.34976%205.67864%207.40547%206.37487%206.70924C7.07109%206.01301%208.01538%205.62187%209%205.62187C9.98462%205.62187%2010.9289%206.01301%2011.6251%206.70924C12.3214%207.40547%2012.7125%208.34976%2012.7125%209.33437C12.7125%2010.319%2012.3214%2011.2633%2011.6251%2011.9595C10.9289%2012.6557%209.98462%2013.0469%209%2013.0469ZM9%2011.6969C9.62657%2011.6969%2010.2275%2011.448%2010.6705%2011.0049C11.1136%2010.5619%2011.3625%209.96095%2011.3625%209.33437C11.3625%208.7078%2011.1136%208.10689%2010.6705%207.66384C10.2275%207.22078%209.62657%206.97187%209%206.97187C8.37343%206.97187%207.77251%207.22078%207.32946%207.66384C6.88641%208.10689%206.6375%208.7078%206.6375%209.33437C6.6375%209.96095%206.88641%2010.5619%207.32946%2011.0049C7.77251%2011.448%208.37343%2011.6969%209%2011.6969Z'%20fill='%234B5362'/%3e%3c/svg%3e",Ee={idx:"-1",name:"",image:null,role:null},Te=async({params:a,fetch:e})=>{const t=a.idx==="-1",s=fe();if(s===null)return t?N("/boxes"):N(`/boxes/${a.idx}/detail`);if(t)return{box:Ee,jwt:s,paramIdx:a.idx};const n=await e(`${ie}/boxes/${a.idx}`,{method:"GET",headers:{Authorization:`Bearer ${s}`}});if(!n.ok)return y.emit("pushSnackbar",{message:"접근할 수 없습니다."}),N(`/boxes/${a.idx}/detail`);const C=await n.json();return C.data.box.role!=="owner"?(y.emit("pushSnackbar",{message:"접근할 수 없습니다."}),N(`/boxes/${a.idx}/detail`)):{box:C.data.box,jwt:s,paramIdx:a.idx}},Ue=Object.freeze(Object.defineProperty({__proto__:null,load:Te},Symbol.toStringTag,{value:"Module"}));function ke(a){let e;return{c(){e=b("div"),this.h()},l(t){e=g(t,"DIV",{class:!0}),E(e).forEach(h),this.h()},h(){m(e,"class","h-[1px] bg-gray-100")},m(t,s){L(t,e,s)},p:j,i:j,o:j,d(t){t&&h(e)}}}class De extends le{constructor(e){super(),ue(this,e,null,ke,re,{})}}function Ie(a){let e,t="설정";return{c(){e=b("div"),e.textContent=t,this.h()},l(s){e=g(s,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-1lcayg1"&&(e.textContent=t),this.h()},h(){m(e,"class","typo-h3 text-gray-900")},m(s,n){L(s,e,n)},p:j,d(s){s&&h(e)}}}function oe(a){let e,t;return{c(){e=b("img"),this.h()},l(s){e=g(s,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){m(e,"class","w-full h-full object-cover"),ae(e.src,t=ne(a[0].image))||m(e,"src",t),m(e,"alt","box_image")},m(s,n){L(s,e,n)},p(s,n){n&1&&!ae(e.src,t=ne(s[0].image))&&m(e,"src",t)},d(s){s&&h(e)}}}function Se(a){let e,t='박스 이름 <span class="text-red-500">*</span>';return{c(){e=b("p"),e.innerHTML=t,this.h()},l(s){e=g(s,"P",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-mxo9hb"&&(e.innerHTML=t),this.h()},h(){m(e,"class","pb-1 typo-sub-h3 text-gray-500")},m(s,n){L(s,e,n)},p:j,d(s){s&&h(e)}}}function Ae(a){let e,t,s,n,C="박스 삭제",u,w,r;return t=new De({}),{c(){e=b("section"),G(t.$$.fragment),s=I(),n=b("button"),n.textContent=C,this.h()},l(o){e=g(o,"SECTION",{class:!0});var c=E(e);J(t.$$.fragment,c),s=S(c),n=g(c,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(n)!=="svelte-uo5gvv"&&(n.textContent=C),c.forEach(h),this.h()},h(){m(n,"class","py-3 typo-body3 text-red-500"),m(e,"class","w-full mb-28")},m(o,c){L(o,e,c),R(t,e,null),p(e,s),p(e,n),u=!0,w||(r=F(n,"click",a[6]),w=!0)},p:j,i(o){u||(z(t.$$.fragment,o),u=!0)},o(o){U(t.$$.fragment,o),u=!1},d(o){o&&h(e),K(t),w=!1,r()}}}function Oe(a){let e,t,s,n,C,u,w=`<div class="flex flex-row gap-1 items-center"><img src="${ye}" alt="camera icon"/> <p class="typo-body3 text-gray-700">사진 변경</p></div>`,r,o,c,v,M,P,T,V,f,x,_,A,k,O,H,q,Q;t=new me({props:{position:"static",leftBack:!0,$$slots:{default:[Ie]},$$scope:{ctx:a}}});let d=a[0].image&&oe(a);function ce(i){a[8](i)}let W={clear:!0,padding:"",border:"border-b-[1.5px] border-b-gray-900 pb-2.5",fontSize:"text-lg",limit:20,onInput:a[4],$$slots:{default:[Se]},$$scope:{ctx:a}};a[0].name!==void 0&&(W.value=a[0].name),v=new $e({props:W}),de.push(()=>ve(v,"value",ce));let $=!a[2]&&Ae(a);return{c(){e=b("div"),G(t.$$.fragment),s=I(),n=b("section"),d&&d.c(),C=I(),u=b("button"),u.innerHTML=w,r=I(),o=b("section"),c=b("section"),G(v.$$.fragment),P=I(),T=b("section"),V=I(),$&&$.c(),f=I(),x=b("div"),_=b("button"),A=pe("저장"),this.h()},l(i){e=g(i,"DIV",{class:!0});var l=E(e);J(t.$$.fragment,l),s=S(l),n=g(l,"SECTION",{class:!0});var D=E(n);d&&d.l(D),C=S(D),u=g(D,"BUTTON",{class:!0,"data-svelte-h":!0}),Z(u)!=="svelte-o1fuye"&&(u.innerHTML=w),D.forEach(h),r=S(l),o=g(l,"SECTION",{class:!0});var B=E(o);c=g(B,"SECTION",{class:!0});var X=E(c);J(v.$$.fragment,X),X.forEach(h),P=S(B),T=g(B,"SECTION",{class:!0}),E(T).forEach(h),V=S(B),$&&$.l(B),B.forEach(h),f=S(l),x=g(l,"DIV",{class:!0});var Y=E(x);_=g(Y,"BUTTON",{class:!0});var ee=E(_);A=he(ee,"저장"),ee.forEach(h),Y.forEach(h),l.forEach(h),this.h()},h(){m(u,"class","absolute bottom-4 right-4 bg-white rounded-3xl px-3.5 py-1.5"),m(n,"class","box-image relative w-full h-52 bg-gray-100"),m(c,"class","box-name flex flex-col gap-4 py-6"),m(T,"class","w-full min-h-20"),m(o,"class","box-setting px-4"),m(_,"class",k=se(`w-full ${a[1]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-cu9y2w"),_.disabled=O=!a[1],m(x,"class","fixed w-full bottom-0 left-0 px-4 pt-3 pb-10 z-10 bg-white upper-box-shadow svelte-cu9y2w"),m(e,"class","min-h-dvh")},m(i,l){L(i,e,l),R(t,e,null),p(e,s),p(e,n),d&&d.m(n,null),p(n,C),p(n,u),p(e,r),p(e,o),p(o,c),R(v,c,null),p(o,P),p(o,T),p(o,V),$&&$.m(o,null),p(e,f),p(e,x),p(x,_),p(_,A),H=!0,q||(Q=[F(u,"click",a[3]),F(_,"click",a[5])],q=!0)},p(i,[l]){const D={};l&8192&&(D.$$scope={dirty:l,ctx:i}),t.$set(D),i[0].image?d?d.p(i,l):(d=oe(i),d.c(),d.m(n,C)):d&&(d.d(1),d=null);const B={};l&8192&&(B.$$scope={dirty:l,ctx:i}),!M&&l&1&&(M=!0,B.value=i[0].name,Ce(()=>M=!1)),v.$set(B),i[2]||$.p(i,l),(!H||l&2&&k!==(k=se(`w-full ${i[1]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-cu9y2w"))&&m(_,"class",k),(!H||l&2&&O!==(O=!i[1]))&&(_.disabled=O)},i(i){H||(z(t.$$.fragment,i),z(v.$$.fragment,i),z($),H=!0)},o(i){U(t.$$.fragment,i),U(v.$$.fragment,i),U($),H=!1},d(i){i&&h(e),K(t),d&&d.d(),K(v),$&&$.d(),q=!1,be(Q)}}}function He(a,e,t){let s;ge(a,te,f=>t(9,s=f));let{data:n}=e;const C=n.paramIdx,u=C==="-1";let w=n.jwt,r=n.box;const o=`${ie}/boxes`;let c=!1;async function v(){var f;try{y.emit("loading",!0);const x=await we();if(!x.blob)return;const _=await Be(x.blob),A=new FormData;A.append("image",_);const k=await fetch(`${o}/image`,{method:"POST",body:A,headers:{Authorization:`Bearer ${w}`}});if(!k.ok)return y.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});const O=await k.json();t(0,r.image=((f=O.data)==null?void 0:f.image)??null,r),t(1,c=!0)}catch{}y.emit("loading",!1)}function M(){t(1,c=!0)}async function P(){if(!c||(t(0,r.name=r.name.trim(),r),!r.name))return;const{url:f,method:x}=u?{url:o,method:"POST"}:{url:`${o}/${C}`,method:"PATCH"};if(!(await fetch(f,{method:x,headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`},body:JSON.stringify({name:r.name,image:r.image,permission:"public"})})).ok)return y.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});u?(y.emit("pushSnackbar",{message:"새 박스를 만들었습니다"}),N("/boxes")):y.emit("pushSnackbar",{message:"박스를 수정했습니다."})}_e(()=>{u&&t(0,r.name="",r)});async function T(){await fetch(`${o}/${C}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${w}`}}),xe(te,s=s.filter(f=>f.idx!==r.idx),s),y.emit("pushSnackbar",{message:`${r.name} 박스를 삭제했습니다.`}),N("/boxes")}function V(f){a.$$.not_equal(r.name,f)&&(r.name=f,t(0,r))}return a.$$set=f=>{"data"in f&&t(7,n=f.data)},[r,c,u,v,M,P,T,n,V]}class Ze extends le{constructor(e){super(),ue(this,e,He,Oe,re,{data:7})}}export{Ze as component,Ue as universal};
