import{I as N,b as Oe,j as ue,A as me,c as Se}from"../chunks/store.h4ajp882.js";import{s as ne,m as Pe,e as L,c as M,b as W,f as g,v as k,K as pe,i as T,A as R,H as Z,G as ke,u as $e,o as Ae,p as Te,F as we,J as te,$ as x,w as Ie,a as K,P as je,g as U,h as X,x as Ee,k as ee,y as Le,B as Me,D as de,n as Q}from"../chunks/scheduler.CIbz-4tf.js";import{S as oe,i as se,t as I,a as v,c as V,d as B,m as D,f as F,b as ve,e as _e,g as he}from"../chunks/index.gvaMc9LH.js";import{H as Ce}from"../chunks/Header.BKbU_1Pz.js";import{V as ye}from"../chunks/Viewer.C9E3IhON.js";import{p as Ne}from"../chunks/stores.BOUdr80j.js";import{N as Re}from"../chunks/NavigationBar.ANanC8er.js";import"../chunks/device.ClX9nYC0.js";import"../chunks/ActionSheet.svelte_svelte_type_style_lang.CTpzmuDf.js";/* empty css                                                   */import{g as Ve}from"../chunks/entry.DKVzhUkU.js";import{g as Be}from"../chunks/sign.ClnKbARR.js";/* empty css                                                   */import{P as De}from"../chunks/picker.DO1g6OCe.js";import{I as Fe}from"../chunks/IconSearch.Deap0mXU.js";import{A as qe}from"../chunks/ActionSheetOpenApp.DS8x1NYS.js";import{s as ge}from"../chunks/s32cloudfront.DTGOjsMs.js";import{i as ze}from"../chunks/isVideoFile.DGBlGWVm.js";function Ge(s){let e,n,t,i,f;const l=s[5].default,r=Pe(l,s,s[4],null);return{c(){e=L("div"),r&&r.c(),this.h()},l(a){e=M(a,"DIV",{id:!0,class:!0,"aria-hidden":!0});var u=W(e);r&&r.l(u),u.forEach(g),this.h()},h(){k(e,"id","mask"),k(e,"class",n=pe(`${s[0]?"":"hidden"} ${s[1]}`)+" svelte-eerk6g"),k(e,"aria-hidden","")},m(a,u){T(a,e,u),r&&r.m(e,null),t=!0,i||(f=[R(e,"touchstart",Z(ke(s[6]))),R(e,"touchend",s[7],{passive:!0}),R(e,"click",s[8])],i=!0)},p(a,[u]){r&&r.p&&(!t||u&16)&&$e(r,l,a,a[4],t?Te(l,a[4],u,null):Ae(a[4]),null),(!t||u&3&&n!==(n=pe(`${a[0]?"":"hidden"} ${a[1]}`)+" svelte-eerk6g"))&&k(e,"class",n)},i(a){t||(I(r,a),t=!0)},o(a){v(r,a),t=!1},d(a){a&&g(e),r&&r.d(a),i=!1,we(f)}}}function He(s,e,n){let{$$slots:t={},$$scope:i}=e,{onMask:f=!1}=e,{position:l="fixed"}=e,{closeOnClick:r=!1}=e,{onTouch:a=void 0}=e;function u(d){te.call(this,s,d)}const p=()=>{r?n(0,f=!1):a&&a()},O=()=>{r?n(0,f=!1):a&&a()};return s.$$set=d=>{"onMask"in d&&n(0,f=d.onMask),"position"in d&&n(1,l=d.position),"closeOnClick"in d&&n(2,r=d.closeOnClick),"onTouch"in d&&n(3,a=d.onTouch),"$$scope"in d&&n(4,i=d.$$scope)},[f,l,r,a,i,t,u,p,O]}class Je extends oe{constructor(e){super(),se(this,e,He,Ge,ne,{onMask:0,position:1,closeOnClick:2,onTouch:3})}}function Ke(s){let e,n,t;return{c(){e=L("emoji-picker"),this.h()},l(i){e=M(i,"EMOJI-PICKER",{"aria-hidden":!0,class:!0}),W(e).forEach(g),this.h()},h(){x(e,"aria-hidden",""),x(e,"class",s[0])},m(i,f){T(i,e,f),n||(t=[R(e,"emoji-click",Z(ke(s[2]))),R(e,"touchstart",Z(s[4])),R(e,"touchend",Z(s[5]))],n=!0)},p(i,f){f&1&&x(e,"class",i[0])},d(i){i&&g(e),n=!1,we(t)}}}function Ue(s){let e,n;return e=new Je({props:{onMask:!0,position:"absolute",onTouch:s[6],$$slots:{default:[Ke]},$$scope:{ctx:s}}}),{c(){V(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,i){D(e,t,i),n=!0},p(t,[i]){const f={};i&2&&(f.onTouch=t[6]),i&257&&(f.$$scope={dirty:i,ctx:t}),e.$set(f)},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function Xe(s,e,n){let{classList:t}=e,{onSelect:i}=e,{close:f}=e;function l(p){i(p.detail.unicode)}new De({emojiVersion:15});function r(p){te.call(this,s,p)}function a(p){te.call(this,s,p)}const u=()=>{f()};return s.$$set=p=>{"classList"in p&&n(0,t=p.classList),"onSelect"in p&&n(3,i=p.onSelect),"close"in p&&n(1,f=p.close)},[t,f,l,i,r,a,u]}class Qe extends oe{constructor(e){super(),se(this,e,Xe,Ue,ne,{classList:0,onSelect:3,close:1})}}function We(s){let e,n,t,i,f,l;return t=new Fe({props:{width:"24",height:"24"}}),{c(){e=L("div"),n=L("button"),V(t.$$.fragment),this.h()},l(r){e=M(r,"DIV",{class:!0});var a=W(e);n=M(a,"BUTTON",{});var u=W(n);B(t.$$.fragment,u),u.forEach(g),a.forEach(g),this.h()},h(){k(e,"class","flex items-center gap-2")},m(r,a){T(r,e,a),X(e,n),D(t,n,null),i=!0,f||(l=R(n,"click",s[10]),f=!0)},i(r){i||(I(t.$$.fragment,r),i=!0)},o(r){v(t.$$.fragment,r),i=!1},d(r){r&&g(e),F(t),f=!1,l()}}}function Ye(s){let e,n,t=!N&&We(s);return{c(){t&&t.c(),e=de()},l(i){t&&t.l(i),e=de()},m(i,f){t&&t.m(i,f),T(i,e,f),n=!0},p:Q,i(i){n||(I(t),n=!0)},o(i){v(t),n=!1},d(i){i&&g(e),t&&t.d(i)}}}function Ze(s){let e,n,t;function i(l){s[12](l)}let f={posts:s[0].posts,selectedReaction:s[2],whenCancelForExternalLink:s[11]};return s[0].index!==void 0&&(f.index=s[0].index),e=new ye({props:f}),Ie.push(()=>ve(e,"index",i)),{c(){V(e.$$.fragment)},l(l){B(e.$$.fragment,l)},m(l,r){D(e,l,r),t=!0},p(l,r){const a={};r&1&&(a.posts=l[0].posts),r&4&&(a.selectedReaction=l[2]),r&8&&(a.whenCancelForExternalLink=l[11]),!n&&r&1&&(n=!0,a.index=l[0].index,Ee(()=>n=!1)),e.$set(a)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){v(e.$$.fragment,l),t=!1},d(l){F(e,l)}}}function xe(s){let e;return{c(){e=L("div"),this.h()},l(n){e=M(n,"DIV",{class:!0}),W(e).forEach(g),this.h()},h(){k(e,"class","w-full h-full")},m(n,t){T(n,e,t)},p:Q,i:Q,o:Q,d(n){n&&g(e)}}}function et(s){let e,n;return e=new Re({}),{c(){V(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,i){D(e,t,i),n=!0},i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function be(s){let e,n;return e=new Qe({props:{classList:"absolute bottom-24 right-0 px-4 z-50",onSelect:s[6],close:s[13]}}),{c(){V(e.$$.fragment)},l(t){B(e.$$.fragment,t)},m(t,i){D(e,t,i),n=!0},p:Q,i(t){n||(I(e.$$.fragment,t),n=!0)},o(t){v(e.$$.fragment,t),n=!1},d(t){F(e,t)}}}function tt(s){var j;let e,n,t,i,f,l,r,a,u,p,O,d,b,E,C,q,y,P,G,$;document.title=e=((j=s[1])==null?void 0:j.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다",O=new Ce({props:{position:"fixed",leftLogo:N||s[4],leftBack:!N&&!s[4]?"white":"",$$slots:{right:[Ye]},$$scope:{ctx:s}}});const _=[xe,Ze],h=[];function A(o,c){return o[0].posts.length===0?0:1}b=A(s),E=h[b]=_[b](s);let w=!N&&et(),m=s[5]&&be(s);function H(o){s[14](o)}let Y={};return s[3]!==void 0&&(Y.isOpen=s[3]),P=new qe({props:Y}),Ie.push(()=>ve(P,"isOpen",H)),{c(){n=L("meta"),i=L("meta"),l=L("meta"),a=L("meta"),p=K(),V(O.$$.fragment),d=K(),E.c(),C=K(),w&&w.c(),q=K(),m&&m.c(),y=K(),V(P.$$.fragment),this.h()},l(o){const c=je("svelte-1of46d2",document.head);n=M(c,"META",{property:!0,content:!0}),i=M(c,"META",{property:!0,content:!0}),l=M(c,"META",{property:!0,content:!0}),a=M(c,"META",{property:!0,content:!0}),c.forEach(g),p=U(o),B(O.$$.fragment,o),d=U(o),E.l(o),C=U(o),w&&w.l(o),q=U(o),m&&m.l(o),y=U(o),B(P.$$.fragment,o),this.h()},h(){var o,c,S,z,J;k(n,"property","og:title"),k(n,"content",t=`블루닷 - ${((o=s[1])==null?void 0:o.unique_name)??"bluedot"} 님 게시물`),k(i,"property","og:image"),k(i,"content",f=((c=s[1])==null?void 0:c.image)??""),k(l,"property","og:image:alt"),k(l,"content",r=((S=s[1])==null?void 0:S.place_name)??""),k(a,"property","og:description"),k(a,"content",u=((z=s[1])==null?void 0:z.text)??((J=s[1])==null?void 0:J.place_name)??"")},m(o,c){X(document.head,n),X(document.head,i),X(document.head,l),X(document.head,a),T(o,p,c),D(O,o,c),T(o,d,c),h[b].m(o,c),T(o,C,c),w&&w.m(o,c),T(o,q,c),m&&m.m(o,c),T(o,y,c),D(P,o,c),$=!0},p(o,[c]){var ie,ae,re,le,ce,fe;(!$||c&2)&&e!==(e=((ie=o[1])==null?void 0:ie.text)??"블루닷 - 사람과 장소 그리고 순간을 의미 있게 만들다")&&(document.title=e),(!$||c&2&&t!==(t=`블루닷 - ${((ae=o[1])==null?void 0:ae.unique_name)??"bluedot"} 님 게시물`))&&k(n,"content",t),(!$||c&2&&f!==(f=((re=o[1])==null?void 0:re.image)??""))&&k(i,"content",f),(!$||c&2&&r!==(r=((le=o[1])==null?void 0:le.place_name)??""))&&k(l,"content",r),(!$||c&2&&u!==(u=((ce=o[1])==null?void 0:ce.text)??((fe=o[1])==null?void 0:fe.place_name)??""))&&k(a,"content",u);const S={};c&16&&(S.leftLogo=N||o[4]),c&16&&(S.leftBack=!N&&!o[4]?"white":""),c&262144&&(S.$$scope={dirty:c,ctx:o}),O.$set(S);let z=b;b=A(o),b===z?h[b].p(o,c):(he(),v(h[z],1,1,()=>{h[z]=null}),_e(),E=h[b],E?E.p(o,c):(E=h[b]=_[b](o),E.c()),I(E,1),E.m(C.parentNode,C)),o[5]?m?(m.p(o,c),c&32&&I(m,1)):(m=be(o),m.c(),I(m,1),m.m(y.parentNode,y)):m&&(he(),v(m,1,1,()=>{m=null}),_e());const J={};!G&&c&8&&(G=!0,J.isOpen=o[3],Ee(()=>G=!1)),P.$set(J)},i(o){$||(I(O.$$.fragment,o),I(E),I(w),I(m),I(P.$$.fragment,o),$=!0)},o(o){v(O.$$.fragment,o),v(E),v(w),v(m),v(P.$$.fragment,o),$=!1},d(o){o&&(g(p),g(d),g(C),g(q),g(y)),g(n),g(i),g(l),g(a),F(O,o),h[b].d(o),w&&w.d(o),m&&m.d(o),F(P,o)}}}function nt(s,e,n){let t,i,f,l,r,a;ee(s,Ne,_=>n(9,l=_)),ee(s,Oe,_=>n(16,r=_)),ee(s,ue,_=>n(5,a=_));let u={posts:[],index:0},p,O,d=!1,b;Le(async()=>{let _="";try{_=Be()}catch{}const h=new URLSearchParams(window.location.search),A=Number(h.get("postIdx")||0);Number(h.get("mediaIdx")||0);const w=0,m=30,H=`&offset=${w}`,Y=`&limit=${m}`;let j=[];(i||t)&&r.length>0?(j=r.map(o=>o.idx===A?{...o,mediaIdx:o.mediaIdx||0}:{...o,mediaIdx:0}),n(0,u.index=j.findIndex(o=>o.idx===String(A)),u)):(b=new AbortController,A&&(j=[await fetch(`${me}/posts/${A}`,{method:"GET",headers:{Authorization:"Bearer "+_},signal:b.signal}).then(o=>o.json()).then(o=>({...o.data,mediaIdx:o.data.mediaIdx||0}))]),j=[...j,...await fetch(`${me}/posts?${H}${Y}`,{method:"GET",headers:{Authorization:"Bearer "+_},signal:b.signal}).then(o=>o.json()).then(o=>{var c;return(c=o.data)==null?void 0:c.posts.filter(S=>S.idx!==String(A)).map(S=>({...S,mediaIdx:S.mediaIdx||0}))})||[]]),n(0,u.posts=j,u)}),Me(()=>{b&&b.abort()});async function E(_){const h=l.url.searchParams.get("postIdx");h&&n(2,O={postIdx:h,reaction:_})}async function C(_){var A;let h=(A=u.posts)==null?void 0:A.at(_);if(h){let w=h.media[0];if(w){const m=ge(w);if(m.includes("youtu"))h.image=m;else{const H=await ze(m);h.image=H?ge(w+"-thumbnail"):m}}}n(1,p=h)}const q=async()=>{await Ve("/search")},y=()=>{if(N)return n(3,d=!0)};function P(_){s.$$.not_equal(u.index,_)&&(u.index=_,n(0,u))}const G=()=>{ue.set(!1)};function $(_){d=_,n(3,d)}return s.$$.update=()=>{s.$$.dirty&512&&n(7,t=l.url.searchParams.get("placeIdx")),s.$$.dirty&512&&n(8,i=l.url.searchParams.get("userIdx")),s.$$.dirty&384&&n(4,f=!t&&!i),s.$$.dirty&1&&C(u.index)},[u,p,O,d,f,a,E,t,i,l,q,y,P,G,$]}class Et extends oe{constructor(e){super(),se(this,e,nt,tt,ne,{})}}function ot(){Se.set(!0)}const vt=Object.freeze(Object.defineProperty({__proto__:null,load:ot},Symbol.toStringTag,{value:"Module"}));export{Et as component,vt as universal};
