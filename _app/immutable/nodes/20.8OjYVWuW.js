import{A as F,d as ie,j as W}from"../chunks/sign.CJj0RIG-.js";import{s as J,H,I as z,b as C,f as b,q as u,i as $,h as w,n as V,C as X,a as y,g as P,D as Y,k as ae,e as T,c as q,E as M,v as U,y as ne,l as ee}from"../chunks/scheduler.Dd3rEL6m.js";import"../chunks/index.Bbc5qIrd.js";import{S as K,i as Q,e as te,c as j,b as O,m as N,a as E,f as re,t as S,d as A,g as oe}from"../chunks/index.Dkei3nAf.js";import{r as le,H as fe}from"../chunks/Header.YdgG7huA.js";import{V as de}from"../chunks/Viewer.DLe4Zi2O.js";import{g as se}from"../chunks/entry.CrbIkr3p.js";/* empty css                                                   */import"../chunks/heic2any.UGIpBdk1.js";/* empty css                                                     */import{p as ce}from"../chunks/stores.CxjZeeFv.js";import{N as ue}from"../chunks/NavigationBar.ByRXct9X.js";import{A as he}from"../chunks/ActionSheet.DEmbgrn8.js";/* empty css                                                   */import{M as me}from"../chunks/Modal.hQwPFiYW.js";function ge(i){let e,t;return{c(){e=H("svg"),t=H("path"),this.h()},l(s){e=z(s,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var n=C(e);t=z(n,"path",{d:!0}),C(t).forEach(b),n.forEach(b),this.h()},h(){u(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 -960 960 960"),u(e,"width",i[1]),u(e,"height",i[1]),u(e,"fill",i[0])},m(s,n){$(s,e,n),w(e,t)},p(s,[n]){n&2&&u(e,"width",s[1]),n&2&&u(e,"height",s[1]),n&1&&u(e,"fill",s[0])},i:V,o:V,d(s){s&&b(e)}}}function pe(i,e,t){let s,{fill:n="#5f6368"}=e,{length:a="1.75"}=e,{alt:h="Edit"}=e;return i.$$set=o=>{"fill"in o&&t(0,n=o.fill),"length"in o&&t(2,a=o.length),"alt"in o&&t(3,h=o.alt)},i.$$.update=()=>{i.$$.dirty&4&&t(1,s=le(a))},[n,s,a,h]}class _e extends K{constructor(e){super(),Q(this,e,pe,ge,J,{fill:0,length:2,alt:3})}}function be(i){let e,t;return{c(){e=H("svg"),t=H("path"),this.h()},l(s){e=z(s,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var n=C(e);t=z(n,"path",{d:!0}),C(t).forEach(b),n.forEach(b),this.h()},h(){u(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),u(e,"xmlns","http://www.w3.org/2000/svg"),u(e,"viewBox","0 -960 960 960"),u(e,"width",i[1]),u(e,"height",i[1]),u(e,"fill",i[0])},m(s,n){$(s,e,n),w(e,t)},p(s,[n]){n&2&&u(e,"width",s[1]),n&2&&u(e,"height",s[1]),n&1&&u(e,"fill",s[0])},i:V,o:V,d(s){s&&b(e)}}}function ve(i,e,t){let s,{fill:n="#5f6368"}=e,{length:a="1.75"}=e,{alt:h="Delete"}=e;return i.$$set=o=>{"fill"in o&&t(0,n=o.fill),"length"in o&&t(2,a=o.length),"alt"in o&&t(3,h=o.alt)},i.$$.update=()=>{i.$$.dirty&4&&t(1,s=le(a))},[n,s,a,h]}class xe extends K{constructor(e){super(),Q(this,e,ve,be,J,{fill:0,length:2,alt:3})}}function we(i){let e,t,s;return t=new de({props:{posts:i[0].posts,index:i[0].index}}),{c(){e=T("div"),j(t.$$.fragment),this.h()},l(n){e=q(n,"DIV",{class:!0});var a=C(e);O(t.$$.fragment,a),a.forEach(b),this.h()},h(){u(e,"class","fixed top-0 left-0 w-full h-full")},m(n,a){$(n,e,a),N(t,e,null),s=!0},p(n,a){const h={};a&1&&(h.posts=n[0].posts),a&1&&(h.index=n[0].index),t.$set(h)},i(n){s||(S(t.$$.fragment,n),s=!0)},o(n){E(t.$$.fragment,n),s=!1},d(n){n&&b(e),A(t)}}}function ke(i){let e;return{c(){e=T("div"),this.h()},l(t){e=q(t,"DIV",{class:!0}),C(e).forEach(b),this.h()},h(){u(e,"class","bg-black w-screen h-screen")},m(t,s){$(t,e,s)},p:V,i:V,o:V,d(t){t&&b(e)}}}function Ie(i){let e,t,s,n,a,h="수정",o,f,c,x,g,p="삭제",m,k,d;return s=new _e({props:{fill:"white",length:1.4}}),c=new xe({props:{fill:"red",length:1.4}}),{c(){e=T("div"),t=T("button"),j(s.$$.fragment),n=y(),a=T("span"),a.textContent=h,o=y(),f=T("button"),j(c.$$.fragment),x=y(),g=T("span"),g.textContent=p,this.h()},l(_){e=q(_,"DIV",{class:!0});var v=C(e);t=q(v,"BUTTON",{class:!0});var I=C(t);O(s.$$.fragment,I),n=P(I),a=q(I,"SPAN",{"data-svelte-h":!0}),M(a)!=="svelte-17aljrl"&&(a.textContent=h),I.forEach(b),o=P(v),f=q(v,"BUTTON",{class:!0});var B=C(f);O(c.$$.fragment,B),x=P(B),g=q(B,"SPAN",{"data-svelte-h":!0}),M(g)!=="svelte-1k1dgz"&&(g.textContent=p),B.forEach(b),v.forEach(b),this.h()},h(){u(t,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-white rounded-t-xl bg-[#3335] border-b border-[#333] border-collapse"),u(f,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-[red] rounded-b-xl bg-[#3336] border-t border-[#333] border-collapse"),u(e,"class","flex flex-col items-center px-6 py-4")},m(_,v){$(_,e,v),w(e,t),N(s,t,null),w(t,n),w(t,a),w(e,o),w(e,f),N(c,f,null),w(f,x),w(f,g),m=!0,k||(d=[U(t,"click",i[11]),U(f,"click",i[12])],k=!0)},p:V,i(_){m||(S(s.$$.fragment,_),S(c.$$.fragment,_),m=!0)},o(_){E(s.$$.fragment,_),E(c.$$.fragment,_),m=!1},d(_){_&&b(e),A(s),A(c),k=!1,ne(d)}}}function Te(i){let e,t,s="정말로 삭제하시겠습니까?",n,a,h="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",o,f,c,x="삭제",g,p,m="취소",k,d;return{c(){e=T("div"),t=T("h2"),t.textContent=s,n=y(),a=T("p"),a.textContent=h,o=y(),f=T("div"),c=T("button"),c.textContent=x,g=y(),p=T("button"),p.textContent=m,this.h()},l(_){e=q(_,"DIV",{class:!0});var v=C(e);t=q(v,"H2",{class:!0,"data-svelte-h":!0}),M(t)!=="svelte-1yzhdkj"&&(t.textContent=s),n=P(v),a=q(v,"P",{class:!0,"data-svelte-h":!0}),M(a)!=="svelte-26p028"&&(a.textContent=h),o=P(v),f=q(v,"DIV",{class:!0});var I=C(f);c=q(I,"BUTTON",{class:!0,"data-svelte-h":!0}),M(c)!=="svelte-1q4epan"&&(c.textContent=x),g=P(I),p=q(I,"BUTTON",{class:!0,"data-svelte-h":!0}),M(p)!=="svelte-1rzg9yy"&&(p.textContent=m),I.forEach(b),v.forEach(b),this.h()},h(){u(t,"class","text-lg font-semibold mb-2"),u(a,"class","text-gray-600 mb-4"),u(c,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),u(p,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),u(f,"class","flex justify-center space-x-4"),u(e,"class","text-center")},m(_,v){$(_,e,v),w(e,t),w(e,n),w(e,a),w(e,o),w(e,f),w(f,c),w(f,g),w(f,p),k||(d=[U(c,"click",i[14]),U(p,"click",i[15])],k=!0)},p:V,d(_){_&&b(e),k=!1,ne(d)}}}function qe(i){let e,t,s,n,a,h,o,f,c,x,g,p,m;e=new fe({props:{position:"fixed",leftBack:i[4]?"":"white",rightSearch:"white",rightPostSetting:{visible:i[3],fill:"white",onClick:i[10]}}});const k=[ke,we],d=[];function _(l,r){return l[0].posts.length===0?0:1}s=_(i),n=d[s]=k[s](i),h=new ue({});function v(l){i[13](l)}let I={defaultHeight:16*16,maxHeight:16*16,$$slots:{default:[Ie]},$$scope:{ctx:i}};i[1]!==void 0&&(I.isOpen=i[1]),f=new he({props:I}),X.push(()=>te(f,"isOpen",v));function B(l){i[16](l)}let Z={$$slots:{default:[Te]},$$scope:{ctx:i}};return i[2]!==void 0&&(Z.modalVisible=i[2]),g=new me({props:Z}),X.push(()=>te(g,"modalVisible",B)),{c(){j(e.$$.fragment),t=y(),n.c(),a=y(),j(h.$$.fragment),o=y(),j(f.$$.fragment),x=y(),j(g.$$.fragment)},l(l){O(e.$$.fragment,l),t=P(l),n.l(l),a=P(l),O(h.$$.fragment,l),o=P(l),O(f.$$.fragment,l),x=P(l),O(g.$$.fragment,l)},m(l,r){N(e,l,r),$(l,t,r),d[s].m(l,r),$(l,a,r),N(h,l,r),$(l,o,r),N(f,l,r),$(l,x,r),N(g,l,r),m=!0},p(l,[r]){const D={};r&16&&(D.leftBack=l[4]?"":"white"),r&10&&(D.rightPostSetting={visible:l[3],fill:"white",onClick:l[10]}),e.$set(D);let G=s;s=_(l),s===G?d[s].p(l,r):(oe(),E(d[G],1,1,()=>{d[G]=null}),re(),n=d[s],n?n.p(l,r):(n=d[s]=k[s](l),n.c()),S(n,1),n.m(a.parentNode,a));const R={};r&524294&&(R.$$scope={dirty:r,ctx:l}),!c&&r&2&&(c=!0,R.isOpen=l[1],Y(()=>c=!1)),f.$set(R);const L={};r&524292&&(L.$$scope={dirty:r,ctx:l}),!p&&r&4&&(p=!0,L.modalVisible=l[2],Y(()=>p=!1)),g.$set(L)},i(l){m||(S(e.$$.fragment,l),S(n),S(h.$$.fragment,l),S(f.$$.fragment,l),S(g.$$.fragment,l),m=!0)},o(l){E(e.$$.fragment,l),E(n),E(h.$$.fragment,l),E(f.$$.fragment,l),E(g.$$.fragment,l),m=!1},d(l){l&&(b(t),b(a),b(o),b(x)),A(e,l),d[s].d(l),A(h,l),A(f,l),A(g,l)}}}function Ce(i,e,t){let s,n,a,h,o,f;ae(i,ce,r=>t(9,f=r));let{data:c}=e,x=c.tokenIdx,g=c.token,p=!1,m=!1;function k(){var r;fetch(`${F}/posts/${(r=window.location.search.split("postIdx=")[1])==null?void 0:r.split("&")[0]}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${g}`}}).then(D=>D.json()).then(()=>se(`/users/${x}`,{replaceState:!0,invalidateAll:!0}))}const d=()=>{t(1,p=!0)},_=()=>{var r;t(1,p=!1),se(`/viewer/edit?type=patch&postIdx=${(r=window.location.search.split("postIdx=")[1])==null?void 0:r.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},v=()=>{t(1,p=!1),t(2,m=!0)};function I(r){p=r,t(1,p)}const B=()=>{k(),t(2,m=!1)},Z=()=>{t(2,m=!1)};function l(r){m=r,t(2,m)}return i.$$set=r=>{"data"in r&&t(0,c=r.data)},i.$$.update=()=>{var r;i.$$.dirty&512&&t(8,s=f.url.searchParams.get("placeIdx")),i.$$.dirty&512&&t(7,n=f.url.searchParams.get("userIdx")),i.$$.dirty&1&&t(6,a=(r=c.posts[c.index])==null?void 0:r.user_idx),i.$$.dirty&384&&t(4,h=!s&&!n),i.$$.dirty&64&&t(3,o=x!==null&&String(x)===String(a))},[c,p,m,o,h,k,a,n,s,f,d,_,v,I,B,Z,l]}class Ue extends K{constructor(e){super(),Q(this,e,Ce,qe,J,{data:0})}}const $e=async({fetch:i,url:e,data:t})=>{console.warn("viewer/+page.ts load");const s=sessionStorage.getItem("jwt"),n=ie(),a=e.searchParams.get("placeIdx"),h=e.searchParams.get("userIdx"),o=Number(e.searchParams.get("postIdx")||0),f=Number(e.searchParams.get("mediaIdx")||0),c=0,x=30,g=`&offset=${c}`,p=`&limit=${x}`;let m=[],k=0;return(h||a)&&ee(W).length>0?(m=ee(W).map(d=>d.idx===o?{...d,mediaIdx:f}:{...d,mediaIdx:0}),k=m.findIndex(d=>d.idx===String(o))):(o&&(m=[await i(`${F}/posts/${o}`,{method:"GET",headers:{Authorization:"Bearer "+s}}).then(d=>d.json()).then(d=>d.data)]),m=[...m,...await i(`${F}/posts?${g}${p}`,{method:"GET",headers:{Authorization:"Bearer "+s}}).then(d=>d.json()).then(d=>d.data.filter(_=>_.idx!==String(o)))||[]]),{index:k,posts:m,tokenIdx:n,token:s}},Ge=Object.freeze(Object.defineProperty({__proto__:null,load:$e},Symbol.toStringTag,{value:"Module"}));export{Ue as component,Ge as universal};
