import{s as Z,m as ee,p as te,a as C,g as x,i as w,n as re,f as d,e as F,c as M,b as W,q as R,v as G,h as H,k as me,l as $e,t as se,d as ne}from"../chunks/scheduler.BnheM4g2.js";import{S as oe,i as ae,e as ie,c as _,a as g,m as b,t as c,b as m,d as h,f as V,g as L}from"../chunks/index.CP53dWnj.js";import{U as _e}from"../chunks/UpperBoxes.C265TdNY.js";import{g as J}from"../chunks/entry.W3sjn9Cn.js";import{F as fe}from"../chunks/Footer.8giEwWnd.js";import{c as K,e as T,A as Q,H as le}from"../chunks/Header.BCFYnwU0.js";import{M as ge}from"../chunks/Map.BVQ0LAih.js";import{N as be}from"../chunks/NavigationBar.BsUUNe2A.js";import{B as X}from"../chunks/Button.CEczC82a.js";import{g as he}from"../chunks/searchParams.DKgNtSzN.js";import{p as de}from"../chunks/stores.BwZnzf5s.js";import"../chunks/Field.BvArgg2L.js";/* empty css                                                   *//* empty css                                                   */import"../chunks/map.BQ_NA7x9.js";import"../chunks/ImageShaper.Dix5sBHT.js";import"../chunks/heic2any.DqA9OTRa.js";/* empty css                                                            */import{A as ke}from"../chunks/ActionSheet.D21vryPY.js";import{S as we}from"../chunks/Search.BbvJTZik.js";import{B as ve}from"../chunks/BottomNavigationPadder.PvxSfrxK.js";import{f as Oe}from"../chunks/search.DZF_BwyE.js";/* empty css                                                    */function Ce(a){let e,r,t,o;return e=new we({}),t=new ve({props:{heightPx:120}}),{c(){_(e.$$.fragment),r=C(),_(t.$$.fragment)},l(s){g(e.$$.fragment,s),r=x(s),g(t.$$.fragment,s)},m(s,i){b(e,s,i),w(s,r,i),b(t,s,i),o=!0},p:re,i(s){o||(c(e.$$.fragment,s),c(t.$$.fragment,s),o=!0)},o(s){m(e.$$.fragment,s),m(t.$$.fragment,s),o=!1},d(s){s&&d(r),h(e,s),h(t,s)}}}function xe(a){let e,r,t;function o(i){a[1](i)}let s={sheetBackground:"bg-[black]/60 backdrop-blur-sm",$$slots:{default:[Ce]},$$scope:{ctx:a}};return a[0]!==void 0&&(s.isOpen=a[0]),e=new ke({props:s}),ee.push(()=>ie(e,"isOpen",o)),{c(){_(e.$$.fragment)},l(i){g(e.$$.fragment,i)},m(i,p){b(e,i,p),t=!0},p(i,[p]){const $={};p&4&&($.$$scope={dirty:p,ctx:i}),!r&&p&1&&(r=!0,$.isOpen=i[0],te(()=>r=!1)),e.$set($)},i(i){t||(c(e.$$.fragment,i),t=!0)},o(i){m(e.$$.fragment,i),t=!1},d(i){h(e,i)}}}function Be(a,e,r){let{isOpen:t=!1}=e;function o(s){t=s,r(0,t)}return a.$$set=s=>{"isOpen"in s&&r(0,t=s.isOpen)},[t,o]}class Se extends oe{constructor(e){super(),ae(this,e,Be,xe,Z,{isOpen:0})}}function ye(a){let e,r;return e=new le({props:{position:"fixed",rightFeed:!0}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Pe(a){let e,r;return e=new le({props:{position:"fixed",leftBack:!0}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Y(a){let e,r;return e=new _e({props:{boxes:a[0]}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p(t,o){const s={};o&1&&(s.boxes=t[0]),e.$set(s)},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Ne(a){let e,r;return e=new fe({props:{position:"fixed",leftReposition:!0,centerSearch:!0,right:"add"}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p:re,i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Ae(a){let e,r;return e=new fe({props:{position:"fixed",bottom:"2rem",$$slots:{default:[Ee]},$$scope:{ctx:a}}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p(t,o){const s={};o&2048&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Ie(a){let e;return{c(){e=se("이 장소가 아니예요")},l(r){e=ne(r,"이 장소가 아니예요")},m(r,t){w(r,e,t)},d(r){r&&d(e)}}}function De(a){let e;return{c(){e=se("이 장소가 맞아요")},l(r){e=ne(r,"이 장소가 맞아요")},m(r,t){w(r,e,t)},d(r){r&&d(e)}}}function Ee(a){let e,r,t,o;return e=new X({props:{backgroundColor:"bg-gray-300",textColor:"text-white",$$slots:{default:[Ie]},$$scope:{ctx:a}}}),e.$on("click",a[7]),t=new X({props:{backgroundColor:"bg-primary-500",textColor:"text-white",$$slots:{default:[De]},$$scope:{ctx:a}}}),t.$on("click",a[4]),{c(){_(e.$$.fragment),r=C(),_(t.$$.fragment)},l(s){g(e.$$.fragment,s),r=x(s),g(t.$$.fragment,s)},m(s,i){b(e,s,i),w(s,r,i),b(t,s,i),o=!0},p(s,i){const p={};i&2048&&(p.$$scope={dirty:i,ctx:s}),e.$set(p);const $={};i&2048&&($.$$scope={dirty:i,ctx:s}),t.$set($)},i(s){o||(c(e.$$.fragment,s),c(t.$$.fragment,s),o=!0)},o(s){m(e.$$.fragment,s),m(t.$$.fragment,s),o=!1},d(s){s&&d(r),h(e,s),h(t,s)}}}function Re(a){let e,r,t,o,s,i,p,$,N,k,B,O,A,l,S,y,v,I;const U=[Pe,ye],P=[];function j(n,f){return n[3]==="post"||n[3]==="box"||n[2]?0:1}e=j(a),r=P[e]=U[e](a),s=new ge({props:{onMoveend:a[5]}});let u=a[0].length>0&&Y(a);const ue=[Ae,Ne],D=[];function ce(n,f){return n[3]==="post"||n[3]==="box"?0:1}B=ce(a),O=D[B]=ue[B](a);function pe(n){a[8](n)}let q={};return a[1]!==void 0&&(q.isOpen=a[1]),l=new Se({props:q}),ee.push(()=>ie(l,"isOpen",pe)),v=new be({props:{show:a[3]!=="post"}}),{c(){r.c(),t=C(),o=F("div"),_(s.$$.fragment),i=C(),p=F("div"),N=C(),u&&u.c(),k=C(),O.c(),A=C(),_(l.$$.fragment),y=C(),_(v.$$.fragment),this.h()},l(n){r.l(n),t=x(n),o=M(n,"DIV",{class:!0});var f=W(o);g(s.$$.fragment,f),i=x(f),p=M(f,"DIV",{class:!0}),W(p).forEach(d),f.forEach(d),N=x(n),u&&u.l(n),k=x(n),O.l(n),A=x(n),g(l.$$.fragment,n),y=x(n),g(v.$$.fragment,n),this.h()},h(){R(p,"class",$=G(`${a[0].length===0&&"hidden"} relative w-full h-48 z-10 top-shadow`)+" svelte-ued265"),R(o,"class","fixed top-0 left-0 w-full h-full")},m(n,f){P[e].m(n,f),w(n,t,f),w(n,o,f),b(s,o,null),H(o,i),H(o,p),w(n,N,f),u&&u.m(n,f),w(n,k,f),D[B].m(n,f),w(n,A,f),b(l,n,f),w(n,y,f),b(v,n,f),I=!0},p(n,[f]){let E=e;e=j(n),e!==E&&(L(),m(P[E],1,1,()=>{P[E]=null}),V(),r=P[e],r||(r=P[e]=U[e](n),r.c()),c(r,1),r.m(t.parentNode,t)),(!I||f&1&&$!==($=G(`${n[0].length===0&&"hidden"} relative w-full h-48 z-10 top-shadow`)+" svelte-ued265"))&&R(p,"class",$),n[0].length>0?u?(u.p(n,f),f&1&&c(u,1)):(u=Y(n),u.c(),c(u,1),u.m(k.parentNode,k)):u&&(L(),m(u,1,1,()=>{u=null}),V()),O.p(n,f);const z={};!S&&f&2&&(S=!0,z.isOpen=n[1],te(()=>S=!1)),l.$set(z)},i(n){I||(c(r),c(s.$$.fragment,n),c(u),c(O),c(l.$$.fragment,n),c(v.$$.fragment,n),I=!0)},o(n){m(r),m(s.$$.fragment,n),m(u),m(O),m(l.$$.fragment,n),m(v.$$.fragment,n),I=!1},d(n){n&&(d(t),d(o),d(N),d(k),d(A),d(y)),P[e].d(n),h(s),u&&u.d(n),D[B].d(n),h(l,n),h(v,n)}}}function Te(a,e,r){let t,o;me(a,de,l=>r(6,o=l));let s=[];const i=o.url.searchParams.get("type"),p=o.url.searchParams.get("tags");p&&K.set(p.split(","));let $=!1;T.on("openSearch",()=>{r(1,$=!0)}),T.on("closeSearch",()=>{r(1,$=!1)}),$e(()=>{K.set([])});async function N(){if(i==="box"){const l=Number(o.url.searchParams.get("boxIdx"));if(Number.isNaN(l)||!l)return J("/boxes");(await fetch(`${Q}/boxes/${l}/places/${o.url.searchParams.get("placeIdx")}`,{method:"PUT",headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}})).ok||T.emit("pushSnackbar",{message:"장소 추가에 실패했습니다."}),J(`/boxes/${l}/detail`)}else i==="post"&&he("/viewer/edit")}let k;async function B(l){try{k&&k.abort("new request"),k=new AbortController;const S=new URL(`${Q}/boxes/boundary?bbox=${l}`),y=await Oe(S,{method:"GET",headers:{Accept:"application/json"}},k);if(!y.ok)return;const v=await y.json();r(0,s=v.data)}catch{}}const O=()=>window.history.back();function A(l){$=l,r(1,$)}return a.$$.update=()=>{a.$$.dirty&64&&r(2,t=o.url.searchParams.get("withBack")==="true")},[s,$,t,i,N,B,o,O,A]}class at extends oe{constructor(e){super(),ae(this,e,Te,Re,Z,{})}}export{at as component};
