import{s as ne,e as g,c as b,b as E,f as d,l as f,i as O,n as I,x as ue,a as k,t as le,g as S,H as U,d as ce,z as te,h as p,v as q,M as fe,r as me,k as pe,o as Ce,F as se}from"../chunks/scheduler.DVlEcQ2N.js";import{S as oe,i as ie,f as de,c as G,a as J,m as R,t as P,b as F,d as K}from"../chunks/index.sqOQyxVq.js";import{H as he}from"../chunks/Header.D4XGnjtA.js";import{F as ge}from"../chunks/Field.b-LuykxF.js";import{p as be}from"../chunks/stores.CnksLA0V.js";import{g as N}from"../chunks/entry.DdiwUxVt.js";import{e as H}from"../chunks/emitter.E5P-NQ8u.js";import{g as _e}from"../chunks/photo.Dawqa4k2.js";const ve="data:image/svg+xml,%3csvg%20width='18'%20height='18'%20viewBox='0%200%2018%2018'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M7.5339%204.27187L6.1839%205.62187H3.6V13.7219H14.4V5.62187H11.8161L10.4661%204.27187H7.5339ZM6.975%202.92188H11.025L12.375%204.27187H15.075C15.254%204.27187%2015.4257%204.34299%2015.5523%204.46958C15.6789%204.59616%2015.75%204.76785%2015.75%204.94687V14.3969C15.75%2014.5759%2015.6789%2014.7476%2015.5523%2014.8742C15.4257%2015.0008%2015.254%2015.0719%2015.075%2015.0719H2.925C2.74598%2015.0719%202.57429%2015.0008%202.4477%2014.8742C2.32112%2014.7476%202.25%2014.5759%202.25%2014.3969V4.94687C2.25%204.76785%202.32112%204.59616%202.4477%204.46958C2.57429%204.34299%202.74598%204.27187%202.925%204.27187H5.625L6.975%202.92188ZM9%2013.0469C8.01538%2013.0469%207.07109%2012.6557%206.37487%2011.9595C5.67864%2011.2633%205.2875%2010.319%205.2875%209.33437C5.2875%208.34976%205.67864%207.40547%206.37487%206.70924C7.07109%206.01301%208.01538%205.62187%209%205.62187C9.98462%205.62187%2010.9289%206.01301%2011.6251%206.70924C12.3214%207.40547%2012.7125%208.34976%2012.7125%209.33437C12.7125%2010.319%2012.3214%2011.2633%2011.6251%2011.9595C10.9289%2012.6557%209.98462%2013.0469%209%2013.0469ZM9%2011.6969C9.62657%2011.6969%2010.2275%2011.448%2010.6705%2011.0049C11.1136%2010.5619%2011.3625%209.96095%2011.3625%209.33437C11.3625%208.7078%2011.1136%208.10689%2010.6705%207.66384C10.2275%207.22078%209.62657%206.97187%209%206.97187C8.37343%206.97187%207.77251%207.22078%207.32946%207.66384C6.88641%208.10689%206.6375%208.7078%206.6375%209.33437C6.6375%209.96095%206.88641%2010.5619%207.32946%2011.0049C7.77251%2011.448%208.37343%2011.6969%209%2011.6969Z'%20fill='%234B5362'/%3e%3c/svg%3e";function xe(n){let e;return{c(){e=g("div"),this.h()},l(t){e=b(t,"DIV",{class:!0}),E(e).forEach(d),this.h()},h(){f(e,"class","h-[1px] bg-gray-100")},m(t,a){O(t,e,a)},p:I,i:I,o:I,d(t){t&&d(e)}}}class Be extends oe{constructor(e){super(),ie(this,e,null,xe,ne,{})}}function $e(n){let e,t="설정";return{c(){e=g("div"),e.textContent=t,this.h()},l(a){e=b(a,"DIV",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-1lcayg1"&&(e.textContent=t),this.h()},h(){f(e,"class","typo-h3 text-gray-900")},m(a,s){O(a,e,s)},p:I,d(a){a&&d(e)}}}function ae(n){let e,t;return{c(){e=g("img"),this.h()},l(a){e=b(a,"IMG",{class:!0,src:!0,alt:!0}),this.h()},h(){f(e,"class","w-full h-full object-cover"),se(e.src,t=n[0].image)||f(e,"src",t),f(e,"alt","box_image")},m(a,s){O(a,e,s)},p(a,s){s&1&&!se(e.src,t=a[0].image)&&f(e,"src",t)},d(a){a&&d(e)}}}function we(n){let e,t='박스 이름 <span class="text-red-500">*</span>';return{c(){e=g("p"),e.innerHTML=t,this.h()},l(a){e=b(a,"P",{class:!0,"data-svelte-h":!0}),U(e)!=="svelte-mxo9hb"&&(e.innerHTML=t),this.h()},h(){f(e,"class","pb-1 typo-sub-h3 text-gray-500")},m(a,s){O(a,e,s)},p:I,d(a){a&&d(e)}}}function ye(n){let e,t,a,s,_="박스 삭제",l,r,v;return t=new Be({}),{c(){e=g("section"),G(t.$$.fragment),a=k(),s=g("button"),s.textContent=_,this.h()},l(i){e=b(i,"SECTION",{class:!0});var C=E(e);J(t.$$.fragment,C),a=S(C),s=b(C,"BUTTON",{class:!0,"data-svelte-h":!0}),U(s)!=="svelte-uo5gvv"&&(s.textContent=_),C.forEach(d),this.h()},h(){f(s,"class","py-3 typo-body3 text-red-500"),f(e,"class","w-full mb-28")},m(i,C){O(i,e,C),R(t,e,null),p(e,a),p(e,s),l=!0,r||(v=q(s,"click",n[6]),r=!0)},p:I,i(i){l||(P(t.$$.fragment,i),l=!0)},o(i){F(t.$$.fragment,i),l=!1},d(i){i&&d(e),K(t),r=!1,v()}}}function Ee(n){let e,t,a,s,_,l,r=`<div class="flex flex-row gap-1 items-center"><img src="${ve}" alt="camera icon"/> <p class="typo-body3 text-gray-700">사진 변경</p></div>`,v,i,C,x,z,M,D,c,B,$,h,L,V,j,A,Z,Q;t=new he({props:{position:"static",leftBack:!0,$$slots:{default:[$e]},$$scope:{ctx:n}}});let m=n[0].image&&ae(n);function re(o){n[7](o)}let W={clear:!0,padding:"",border:"border-b-[1.5px] border-b-gray-900 pb-2.5",fontSize:"text-lg",limit:20,onInput:n[4],$$slots:{default:[we]},$$scope:{ctx:n}};n[0].name!==void 0&&(W.value=n[0].name),x=new ge({props:W}),ue.push(()=>de(x,"value",re));let w=!n[2]&&ye(n);return{c(){e=g("div"),G(t.$$.fragment),a=k(),s=g("section"),m&&m.c(),_=k(),l=g("button"),l.innerHTML=r,v=k(),i=g("section"),C=g("section"),G(x.$$.fragment),M=k(),D=g("section"),c=k(),w&&w.c(),B=k(),$=g("div"),h=g("button"),L=le("저장"),this.h()},l(o){e=b(o,"DIV",{class:!0});var u=E(e);J(t.$$.fragment,u),a=S(u),s=b(u,"SECTION",{class:!0});var T=E(s);m&&m.l(T),_=S(T),l=b(T,"BUTTON",{class:!0,"data-svelte-h":!0}),U(l)!=="svelte-o1fuye"&&(l.innerHTML=r),T.forEach(d),v=S(u),i=b(u,"SECTION",{class:!0});var y=E(i);C=b(y,"SECTION",{class:!0});var X=E(C);J(x.$$.fragment,X),X.forEach(d),M=S(y),D=b(y,"SECTION",{class:!0}),E(D).forEach(d),c=S(y),w&&w.l(y),y.forEach(d),B=S(u),$=b(u,"DIV",{class:!0});var Y=E($);h=b(Y,"BUTTON",{class:!0});var ee=E(h);L=ce(ee,"저장"),ee.forEach(d),Y.forEach(d),u.forEach(d),this.h()},h(){f(l,"class","absolute bottom-4 right-4 bg-white rounded-3xl px-3.5 py-1.5"),f(s,"class","box-image relative w-full h-52 bg-gray-100"),f(C,"class","box-name flex flex-col gap-4 py-6"),f(D,"class","w-full min-h-20"),f(i,"class","box-setting px-4"),f(h,"class",V=te(`w-full ${n[1]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-cu9y2w"),h.disabled=j=!n[1],f($,"class","fixed w-full bottom-0 left-0 px-4 pt-3 pb-10 z-10 bg-white upper-box-shadow svelte-cu9y2w"),f(e,"class","min-h-dvh")},m(o,u){O(o,e,u),R(t,e,null),p(e,a),p(e,s),m&&m.m(s,null),p(s,_),p(s,l),p(e,v),p(e,i),p(i,C),R(x,C,null),p(i,M),p(i,D),p(i,c),w&&w.m(i,null),p(e,B),p(e,$),p($,h),p(h,L),A=!0,Z||(Q=[q(l,"click",n[3]),q(h,"click",n[5])],Z=!0)},p(o,[u]){const T={};u&4096&&(T.$$scope={dirty:u,ctx:o}),t.$set(T),o[0].image?m?m.p(o,u):(m=ae(o),m.c(),m.m(s,_)):m&&(m.d(1),m=null);const y={};u&4096&&(y.$$scope={dirty:u,ctx:o}),!z&&u&1&&(z=!0,y.value=o[0].name,fe(()=>z=!1)),x.$set(y),o[2]||w.p(o,u),(!A||u&2&&V!==(V=te(`w-full ${o[1]?"bg-primary-500":"bg-gray-300"} rounded-lg p-[15px] text-white typo-button3`)+" svelte-cu9y2w"))&&f(h,"class",V),(!A||u&2&&j!==(j=!o[1]))&&(h.disabled=j)},i(o){A||(P(t.$$.fragment,o),P(x.$$.fragment,o),P(w),A=!0)},o(o){F(t.$$.fragment,o),F(x.$$.fragment,o),F(w),A=!1},d(o){o&&d(e),K(t),m&&m.d(),K(x),w&&w.d(),Z=!1,me(Q)}}}function De(n,e,t){let a;pe(n,be,c=>t(8,a=c));const s=a.params.idx,_=s==="-1";let l=sessionStorage.getItem("jwt"),r={idx:s,name:"",image:null,role:null},v=!1;async function i(){const c=await fetch(`https://azit.surflux.studio/boxes/${s}?p=setting`,{method:"GET",headers:{Authorization:`Bearer ${l}`}});if(c.status===403)return H.emit("pushSnackbar",{message:"권한이 없어 접근할 수 없습니다."}),N(`/boxes/${s}/detail`);if(!c.ok)return;const B=await c.json();t(0,r=B.data.box)}Ce(()=>{if(!l)return _?N("/boxes"):N(`/boxes/${s}/detail`);_||i()});async function C(){var c;try{const B=await _e();if(!B.blob)return;const $=new FormData;$.append("image",B.blob);const h=await fetch("https://azit.surflux.studio/boxes/image",{method:"POST",body:$,headers:{Authorization:`Bearer ${l}`}});if(!h.ok)return H.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});const L=await h.json();t(0,r.image=((c=L.data)==null?void 0:c.image)??null,r),t(1,v=!0)}catch{}}function x(){t(1,v=!0)}async function z(){if(!v||(t(0,r.name=r.name.trim(),r),!r.name))return;const c="https://azit.surflux.studio/boxes",{url:B,method:$}=_?{url:c,method:"POST"}:{url:`${c}/${s}`,method:"PATCH"};if(!(await fetch(B,{method:$,headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`},body:JSON.stringify({name:r.name,image:r.image,permission:"public"})})).ok)return H.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."});_?(H.emit("pushSnackbar",{message:"새 박스를 만들었습니다"}),N("/boxes")):H.emit("pushSnackbar",{message:"박스를 수정했습니다."})}function M(){fetch(`https://azit.surflux.studio/boxes/${s}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${l}`}}),H.emit("pushSnackbar",{message:`${r.name} 박스를 삭제했습니다.`}),N("/boxes")}function D(c){n.$$.not_equal(r.name,c)&&(r.name=c,t(0,r))}return[r,v,_,C,x,z,M,D]}class Me extends oe{constructor(e){super(),ie(this,e,De,Ee,ne,{})}}export{Me as component};
