import{s as Z,B as ee,C as te,a as C,g as B,i as w,n as re,f as d,e as M,c as W,b as q,m as R,o as G,h as H,k as me,A as $e,t as se,d as ne}from"../chunks/scheduler.B4Oq0Y6j.js";import{S as oe,i as ae,e as ie,c as _,b as g,m as b,t as c,a as m,d as h,f as V,g as L}from"../chunks/index.Dwy94kkp.js";import{U as _e}from"../chunks/UpperBoxes.k00t2rCb.js";import{g as J}from"../chunks/entry.CMhpHdxa.js";import{F as fe}from"../chunks/Footer.gvf9hdJx.js";import{b as K,e as T,A as Q,H as le}from"../chunks/Header.FoXJ-u0t.js";import{M as ge}from"../chunks/Map.BO0WyJnQ.js";import{N as be}from"../chunks/NavigationBar.BqF2CjS9.js";import{B as X}from"../chunks/Button.OFmFBar4.js";import{g as he}from"../chunks/searchParams.B7rP42oW.js";import{p as de}from"../chunks/stores.Bepurxgr.js";import"../chunks/Field.2ZpjzqQB.js";/* empty css                                                   *//* empty css                                                   */import"../chunks/map.DHYoQLkR.js";import"../chunks/ImageShaper.Dix5sBHT.js";import"../chunks/heic2any.Bzh40-Ik.js";/* empty css                                                            */import{A as ke}from"../chunks/ActionSheet.Cxyn1QkY.js";import{S as we}from"../chunks/Search.ChNdV9Wj.js";import{B as Oe}from"../chunks/BottomNavigationPadder.DBgHLvJv.js";import{f as ve}from"../chunks/search.Dianyi0r.js";/* empty css                                                    */function Ce(a){let e,r,t,o;return e=new we({}),t=new Oe({props:{heightPx:120}}),{c(){_(e.$$.fragment),r=C(),_(t.$$.fragment)},l(s){g(e.$$.fragment,s),r=B(s),g(t.$$.fragment,s)},m(s,i){b(e,s,i),w(s,r,i),b(t,s,i),o=!0},p:re,i(s){o||(c(e.$$.fragment,s),c(t.$$.fragment,s),o=!0)},o(s){m(e.$$.fragment,s),m(t.$$.fragment,s),o=!1},d(s){s&&d(r),h(e,s),h(t,s)}}}function Be(a){let e,r,t;function o(i){a[1](i)}let s={sheetBackground:"bg-[black]/60 backdrop-blur-sm",$$slots:{default:[Ce]},$$scope:{ctx:a}};return a[0]!==void 0&&(s.isOpen=a[0]),e=new ke({props:s}),ee.push(()=>ie(e,"isOpen",o)),{c(){_(e.$$.fragment)},l(i){g(e.$$.fragment,i)},m(i,p){b(e,i,p),t=!0},p(i,[p]){const $={};p&4&&($.$$scope={dirty:p,ctx:i}),!r&&p&1&&(r=!0,$.isOpen=i[0],te(()=>r=!1)),e.$set($)},i(i){t||(c(e.$$.fragment,i),t=!0)},o(i){m(e.$$.fragment,i),t=!1},d(i){h(e,i)}}}function xe(a,e,r){let{isOpen:t=!1}=e;function o(s){t=s,r(0,t)}return a.$$set=s=>{"isOpen"in s&&r(0,t=s.isOpen)},[t,o]}class Se extends oe{constructor(e){super(),ae(this,e,xe,Be,Z,{isOpen:0})}}function ye(a){let e,r;return e=new le({props:{position:"fixed",rightFeed:!0}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Pe(a){let e,r;return e=new le({props:{position:"fixed",leftBack:!0}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Y(a){let e,r;return e=new _e({props:{boxes:a[0]}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p(t,o){const s={};o&1&&(s.boxes=t[0]),e.$set(s)},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Ae(a){let e,r;return e=new fe({props:{position:"fixed",leftReposition:!0,centerSearch:!0,right:"add"}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p:re,i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Ne(a){let e,r;return e=new fe({props:{position:"fixed",bottom:"2rem",$$slots:{default:[Ee]},$$scope:{ctx:a}}}),{c(){_(e.$$.fragment)},l(t){g(e.$$.fragment,t)},m(t,o){b(e,t,o),r=!0},p(t,o){const s={};o&2048&&(s.$$scope={dirty:o,ctx:t}),e.$set(s)},i(t){r||(c(e.$$.fragment,t),r=!0)},o(t){m(e.$$.fragment,t),r=!1},d(t){h(e,t)}}}function Ie(a){let e;return{c(){e=se("이 장소가 아니예요")},l(r){e=ne(r,"이 장소가 아니예요")},m(r,t){w(r,e,t)},d(r){r&&d(e)}}}function De(a){let e;return{c(){e=se("이 장소가 맞아요")},l(r){e=ne(r,"이 장소가 맞아요")},m(r,t){w(r,e,t)},d(r){r&&d(e)}}}function Ee(a){let e,r,t,o;return e=new X({props:{backgroundColor:"bg-gray-300",textColor:"text-white",$$slots:{default:[Ie]},$$scope:{ctx:a}}}),e.$on("click",a[7]),t=new X({props:{backgroundColor:"bg-primary-500",textColor:"text-white",$$slots:{default:[De]},$$scope:{ctx:a}}}),t.$on("click",a[4]),{c(){_(e.$$.fragment),r=C(),_(t.$$.fragment)},l(s){g(e.$$.fragment,s),r=B(s),g(t.$$.fragment,s)},m(s,i){b(e,s,i),w(s,r,i),b(t,s,i),o=!0},p(s,i){const p={};i&2048&&(p.$$scope={dirty:i,ctx:s}),e.$set(p);const $={};i&2048&&($.$$scope={dirty:i,ctx:s}),t.$set($)},i(s){o||(c(e.$$.fragment,s),c(t.$$.fragment,s),o=!0)},o(s){m(e.$$.fragment,s),m(t.$$.fragment,s),o=!1},d(s){s&&d(r),h(e,s),h(t,s)}}}function Re(a){let e,r,t,o,s,i,p,$,A,k,x,v,N,l,S,y,O,I;const U=[Pe,ye],P=[];function j(n,f){return n[3]==="post"||n[3]==="box"||n[2]?0:1}e=j(a),r=P[e]=U[e](a),s=new ge({props:{onMoveend:a[5]}});let u=a[0].length>0&&Y(a);const ue=[Ne,Ae],D=[];function ce(n,f){return n[3]==="post"||n[3]==="box"?0:1}x=ce(a),v=D[x]=ue[x](a);function pe(n){a[8](n)}let z={};return a[1]!==void 0&&(z.isOpen=a[1]),l=new Se({props:z}),ee.push(()=>ie(l,"isOpen",pe)),O=new be({props:{show:a[3]!=="post"}}),{c(){r.c(),t=C(),o=M("div"),_(s.$$.fragment),i=C(),p=M("div"),A=C(),u&&u.c(),k=C(),v.c(),N=C(),_(l.$$.fragment),y=C(),_(O.$$.fragment),this.h()},l(n){r.l(n),t=B(n),o=W(n,"DIV",{class:!0});var f=q(o);g(s.$$.fragment,f),i=B(f),p=W(f,"DIV",{class:!0}),q(p).forEach(d),f.forEach(d),A=B(n),u&&u.l(n),k=B(n),v.l(n),N=B(n),g(l.$$.fragment,n),y=B(n),g(O.$$.fragment,n),this.h()},h(){R(p,"class",$=G(`${a[0].length===0&&"hidden"} relative w-full h-48 z-10 top-shadow`)+" svelte-ued265"),R(o,"class","fixed top-0 left-0 w-full h-full")},m(n,f){P[e].m(n,f),w(n,t,f),w(n,o,f),b(s,o,null),H(o,i),H(o,p),w(n,A,f),u&&u.m(n,f),w(n,k,f),D[x].m(n,f),w(n,N,f),b(l,n,f),w(n,y,f),b(O,n,f),I=!0},p(n,[f]){let E=e;e=j(n),e!==E&&(L(),m(P[E],1,1,()=>{P[E]=null}),V(),r=P[e],r||(r=P[e]=U[e](n),r.c()),c(r,1),r.m(t.parentNode,t)),(!I||f&1&&$!==($=G(`${n[0].length===0&&"hidden"} relative w-full h-48 z-10 top-shadow`)+" svelte-ued265"))&&R(p,"class",$),n[0].length>0?u?(u.p(n,f),f&1&&c(u,1)):(u=Y(n),u.c(),c(u,1),u.m(k.parentNode,k)):u&&(L(),m(u,1,1,()=>{u=null}),V()),v.p(n,f);const F={};!S&&f&2&&(S=!0,F.isOpen=n[1],te(()=>S=!1)),l.$set(F)},i(n){I||(c(r),c(s.$$.fragment,n),c(u),c(v),c(l.$$.fragment,n),c(O.$$.fragment,n),I=!0)},o(n){m(r),m(s.$$.fragment,n),m(u),m(v),m(l.$$.fragment,n),m(O.$$.fragment,n),I=!1},d(n){n&&(d(t),d(o),d(A),d(k),d(N),d(y)),P[e].d(n),h(s),u&&u.d(n),D[x].d(n),h(l,n),h(O,n)}}}function Te(a,e,r){let t,o;me(a,de,l=>r(6,o=l));let s=[];const i=o.url.searchParams.get("type"),p=o.url.searchParams.get("tags");p&&K.set(p.split(","));let $=!1;T.on("openSearch",()=>{r(1,$=!0)}),T.on("closeSearch",()=>{r(1,$=!1)}),$e(()=>{K.set([])});async function A(){if(i==="box"){const l=Number(o.url.searchParams.get("boxIdx"));if(Number.isNaN(l)||!l)return J("/boxes");(await fetch(`${Q}/boxes/${l}/places/${o.url.searchParams.get("placeIdx")}`,{method:"PUT",headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}})).ok||T.emit("pushSnackbar",{message:"장소 추가에 실패했습니다."}),J(`/boxes/${l}/detail`)}else i==="post"&&he("/viewer/edit")}let k;async function x(l){try{k&&k.abort("new request"),k=new AbortController;const S=new URL(`${Q}/boxes/boundary?bbox=${l}`),y=await ve(S,{method:"GET",headers:{Accept:"application/json"}},k);if(!y.ok)return;const O=await y.json();r(0,s=O.data)}catch{}}const v=()=>window.history.back();function N(l){$=l,r(1,$)}return a.$$.update=()=>{a.$$.dirty&64&&r(2,t=o.url.searchParams.get("withBack")==="true")},[s,$,t,i,A,x,o,v,N]}class at extends oe{constructor(e){super(),ae(this,e,Te,Re,Z,{})}}export{at as component};
