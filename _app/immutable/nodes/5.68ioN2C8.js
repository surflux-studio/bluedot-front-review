import{g as Ve,i as Ee}from"../chunks/sign.BBnjYBtG.js";import{A as Ce}from"../chunks/store.CQlB0pd-.js";import{g as ye}from"../chunks/entry.R3hv14YQ.js";import{s as oe,F as ce,G as de,b as w,f as c,q as u,i as T,h as m,n as te,e as C,a as j,t as se,c as y,g as H,d as le,v as F,J as he,r as J,I as De,D as xe,o as Be,l as je,j as He,K as me,H as Te}from"../chunks/scheduler.BnheM4g2.js";import{S as ke,i as Ie,c as R,a as U,m as q,t as S,b as O,d as z,g as Me,f as Se}from"../chunks/index.CP53dWnj.js";import{e as pe}from"../chunks/each.B4pMeuX4.js";import{H as Ae,e as Q}from"../chunks/Header.C-GtpDdy.js";import{M as Pe}from"../chunks/Map.BdHLtGu2.js";import{F as Oe}from"../chunks/Footer.cF06bNha.js";import{a as L,v as Ne}from"../chunks/map.foE5L5tZ.js";import{f as Ze}from"../chunks/location.C_BB7ZrT.js";import{s as ge}from"../chunks/s32cloudfront.Dk2vDj77.js";import{I as Fe}from"../chunks/IconMaterialBoxRounded.BZtR2gcE.js";const Ge=async({params:a,fetch:e})=>{const s=Ve(),t=await e(`${Ce}/boxes/${a.idx}`,{method:"GET",headers:{Authorization:`Bearer ${s}`}});return t.ok?(await t.json()).data:ye("/boxes")},ut=Object.freeze(Object.defineProperty({__proto__:null,load:Ge},Symbol.toStringTag,{value:"Module"}));function Le(a){let e,s;return{c(){e=ce("svg"),s=ce("path"),this.h()},l(t){e=de(t,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var l=w(e);s=de(l,"path",{d:!0}),w(s).forEach(c),l.forEach(c),this.h()},h(){u(s,"d","M4 8H20V21C20 21.2652 19.8946 21.5196 19.7071 21.7071C19.5196 21.8946 19.2652 22 19 22H5C4.73478 22 4.48043 21.8946 4.29289 21.7071C4.10536 21.5196 4 21.2652 4 21V8ZM6 10V20H18V10H6ZM9 12H11V18H9V12ZM13 12H15V18H13V12ZM7 5V3C7 2.73478 7.10536 2.48043 7.29289 2.29289C7.48043 2.10536 7.73478 2 8 2H16C16.2652 2 16.5196 2.10536 16.7071 2.29289C16.8946 2.48043 17 2.73478 17 3V5H22V7H2V5H7ZM9 4V5H15V4H9Z"),u(e,"width","24"),u(e,"height","24"),u(e,"viewBox","0 0 24 24"),u(e,"fill",a[0]),u(e,"xmlns","http://www.w3.org/2000/svg")},m(t,l){T(t,e,l),m(e,s)},p(t,[l]){l&1&&u(e,"fill",t[0])},i:te,o:te,d(t){t&&c(e)}}}function Re(a,e,s){let{fill:t="white"}=e;return a.$$set=l=>{"fill"in l&&s(0,t=l.fill)},[t]}class Ue extends ke{constructor(e){super(),Ie(this,e,Re,Le,oe,{fill:0})}}function _e(a,e,s){const t=a.slice();return t[15]=e[s],t}function qe(a){let e,s,t,l,o=a[3].name+"",n,f;return s=new Fe({props:{length:1.25}}),{c(){e=C("div"),R(s.$$.fragment),t=j(),l=C("div"),n=se(o),this.h()},l(_){e=y(_,"DIV",{class:!0});var g=w(e);U(s.$$.fragment,g),t=H(g),l=y(g,"DIV",{class:!0});var E=w(l);n=le(E,o),E.forEach(c),g.forEach(c),this.h()},h(){u(l,"class","typo-sub-h3 text-gray-900"),u(e,"class","flex flex-row justify-center items-center gap-1")},m(_,g){T(_,e,g),q(s,e,null),m(e,t),m(e,l),m(l,n),f=!0},p:te,i(_){f||(S(s.$$.fragment,_),f=!0)},o(_){O(s.$$.fragment,_),f=!1},d(_){_&&c(e),z(s)}}}function ve(a){let e,s;return{c(){e=C("img"),this.h()},l(t){e=y(t,"IMG",{class:!0,alt:!0,src:!0}),this.h()},h(){var t,l;u(e,"class","w-full h-full object-cover"),u(e,"alt","장소 사진"),me(e.src,s=ge(((l=(t=a[15])==null?void 0:t.media)==null?void 0:l.at(0))??""))||u(e,"src",s)},m(t,l){T(t,e,l)},p(t,l){var o,n;l&1&&!me(e.src,s=ge(((n=(o=t[15])==null?void 0:o.media)==null?void 0:n.at(0))??""))&&u(e,"src",s)},d(t){t&&c(e)}}}function be(a){let e,s,t;function l(...o){return a[9](a[15],...o)}return{c(){e=C("input"),this.h()},l(o){e=y(o,"INPUT",{type:!0,class:!0}),this.h()},h(){u(e,"type","checkbox"),u(e,"class","absolute top-1 left-1 m-2 focus:outline-none focus:ring-0 focus:ring-offset-0")},m(o,n){T(o,e,n),s||(t=J(e,"click",Te(l)),s=!0)},p(o,n){a=o},d(o){o&&c(e),s=!1,t()}}}function $e(a){var D,V;let e,s=(V=(D=a[15])==null?void 0:D.media)==null?void 0:V.at(0),t,l,o=a[15].name+"",n,f,_=a[15].idx,g,E,I,d=s&&ve(a),k=be(a);function A(){return a[10](a[15])}return{c(){e=C("div"),d&&d.c(),t=j(),l=C("div"),n=se(o),f=j(),k.c(),g=j(),this.h()},l(v){e=y(v,"DIV",{class:!0,"aria-hidden":!0});var r=w(e);d&&d.l(r),t=H(r),l=y(r,"DIV",{class:!0});var h=w(l);n=le(h,o),h.forEach(c),f=H(r),k.l(r),g=H(r),r.forEach(c),this.h()},h(){u(l,"class","absolute bottom-0 p-2.5 typo-caption1 text-white text-shadow svelte-sygcjw"),u(e,"class","bg-gray-50 h-36 relative"),u(e,"aria-hidden","")},m(v,r){T(v,e,r),d&&d.m(e,null),m(e,t),m(e,l),m(l,n),m(e,f),k.m(e,null),m(e,g),E||(I=J(e,"click",A),E=!0)},p(v,r){var h,B;a=v,r&1&&(s=(B=(h=a[15])==null?void 0:h.media)==null?void 0:B.at(0)),s?d?d.p(a,r):(d=ve(a),d.c(),d.m(e,t)):d&&(d.d(1),d=null),r&1&&o!==(o=a[15].name+"")&&He(n,o),r&1&&oe(_,_=a[15].idx)?(k.d(1),k=be(a),k.c(),k.m(e,g)):k.p(a,r)},d(v){v&&c(e),d&&d.d(),k.d(v),E=!1,I()}}}function we(a){let e,s,t,l,o;return s=new Ue({}),{c(){e=C("button"),R(s.$$.fragment),this.h()},l(n){e=y(n,"BUTTON",{class:!0});var f=w(e);U(s.$$.fragment,f),f.forEach(c),this.h()},h(){u(e,"class","bg-red-500 rounded-full p-4 pointer-events-auto")},m(n,f){T(n,e,f),q(s,e,null),t=!0,l||(o=J(e,"click",a[5]),l=!0)},p:te,i(n){t||(S(s.$$.fragment,n),t=!0)},o(n){O(s.$$.fragment,n),t=!1},d(n){n&&c(e),z(s),l=!1,o()}}}function ze(a){let e,s,t=a[2]==="list"&&a[1].length>0&&we(a);return{c(){e=C("div"),t&&t.c(),this.h()},l(l){e=y(l,"DIV",{slot:!0});var o=w(e);t&&t.l(o),o.forEach(c),this.h()},h(){u(e,"slot","right")},m(l,o){T(l,e,o),t&&t.m(e,null),s=!0},p(l,o){l[2]==="list"&&l[1].length>0?t?(t.p(l,o),o&6&&S(t,1)):(t=we(l),t.c(),S(t,1),t.m(e,null)):t&&(Me(),O(t,1,1,()=>{t=null}),Se())},i(l){s||(S(t),s=!0)},o(l){O(t),s=!1},d(l){l&&c(e),t&&t.d()}}}function Je(a){let e,s,t,l,o,n,f,_,g,E,I,d,k,A,D,V,v,r,h,B,X,M,P,ae,ne;t=new Ae({props:{position:"static",leftBack:!0,rightLink:!0,rightBoxSetting:a[3].role==="owner"?" ":"",slotPosition:"justify-center",$$slots:{default:[qe]},$$scope:{ctx:a}}}),v=new Pe({});let N=pe(a[0]),b=[];for(let i=0;i<N.length;i+=1)b[i]=$e(_e(a,N,i));return M=new Oe({props:{position:"fixed",leftReposition:a[2]==="map",$$slots:{right:[ze]},$$scope:{ctx:a}}}),{c(){e=C("div"),s=C("div"),R(t.$$.fragment),l=j(),o=C("div"),n=C("div"),f=C("button"),_=se("지도"),E=j(),I=C("button"),d=se("리스트"),A=j(),D=C("div"),V=C("div"),R(v.$$.fragment),r=j(),h=C("div");for(let i=0;i<b.length;i+=1)b[i].c();X=j(),R(M.$$.fragment),this.h()},l(i){e=y(i,"DIV",{class:!0});var p=w(e);s=y(p,"DIV",{class:!0});var x=w(s);U(t.$$.fragment,x),x.forEach(c),l=H(p),o=y(p,"DIV",{class:!0});var Z=w(o);n=y(Z,"DIV",{class:!0});var $=w(n);f=y($,"BUTTON",{class:!0});var G=w(f);_=le(G,"지도"),G.forEach(c),E=H($),I=y($,"BUTTON",{class:!0});var ie=w(I);d=le(ie,"리스트"),ie.forEach(c),$.forEach(c),Z.forEach(c),A=H(p),D=y(p,"DIV",{class:!0});var ue=w(D);V=y(ue,"DIV",{class:!0});var K=w(V);U(v.$$.fragment,K),r=H(K),h=y(K,"DIV",{class:!0});var fe=w(h);for(let re=0;re<b.length;re+=1)b[re].l(fe);fe.forEach(c),K.forEach(c),ue.forEach(c),p.forEach(c),X=H(i),U(M.$$.fragment,i),this.h()},h(){u(s,"class","flex-none"),u(f,"class",g=F(`tab-map w-full px-8 py-2.5 ${a[2]==="map"?W:Y}`)+" svelte-sygcjw"),u(I,"class",k=F(`tab-list w-full px-8 py-2.5 ${a[2]==="list"?W:Y}`)+" svelte-sygcjw"),u(n,"class","tab-category w-full flex flex-row text-center"),u(o,"class","tab flex-none w-full px-4 pt-2.5 pb-0.5"),u(h,"class","absolute left-full w-screen grid grid-cols-3 gap-1"),u(V,"class","h-full w-full transition-transform"),he(V,"transform",`translateX(${a[2]==="map"?0:-100}%)`),u(D,"class","content flex-auto"),u(e,"class",B=F(`flex flex-col w-dvw h-dvh overflow-x-hidden ${a[2]==="list"?"":"overflow-y-hidden"}`)+" svelte-sygcjw")},m(i,p){T(i,e,p),m(e,s),q(t,s,null),m(e,l),m(e,o),m(o,n),m(n,f),m(f,_),m(n,E),m(n,I),m(I,d),m(e,A),m(e,D),m(D,V),q(v,V,null),m(V,r),m(V,h);for(let x=0;x<b.length;x+=1)b[x]&&b[x].m(h,null);T(i,X,p),q(M,i,p),P=!0,ae||(ne=[J(f,"click",a[7]),J(I,"click",a[8])],ae=!0)},p(i,[p]){const x={};if(p&262144&&(x.$$scope={dirty:p,ctx:i}),t.$set(x),(!P||p&4&&g!==(g=F(`tab-map w-full px-8 py-2.5 ${i[2]==="map"?W:Y}`)+" svelte-sygcjw"))&&u(f,"class",g),(!P||p&4&&k!==(k=F(`tab-list w-full px-8 py-2.5 ${i[2]==="list"?W:Y}`)+" svelte-sygcjw"))&&u(I,"class",k),p&17){N=pe(i[0]);let $;for($=0;$<N.length;$+=1){const G=_e(i,N,$);b[$]?b[$].p(G,p):(b[$]=$e(G),b[$].c(),b[$].m(h,null))}for(;$<b.length;$+=1)b[$].d(1);b.length=N.length}p&4&&he(V,"transform",`translateX(${i[2]==="map"?0:-100}%)`),(!P||p&4&&B!==(B=F(`flex flex-col w-dvw h-dvh overflow-x-hidden ${i[2]==="list"?"":"overflow-y-hidden"}`)+" svelte-sygcjw"))&&u(e,"class",B);const Z={};p&4&&(Z.leftReposition=i[2]==="map"),p&262150&&(Z.$$scope={dirty:p,ctx:i}),M.$set(Z)},i(i){P||(S(t.$$.fragment,i),S(v.$$.fragment,i),S(M.$$.fragment,i),P=!0)},o(i){O(t.$$.fragment,i),O(v.$$.fragment,i),O(M.$$.fragment,i),P=!1},d(i){i&&(c(e),c(X)),z(t),z(v),De(b,i),z(M,i),ae=!1,xe(ne)}}}let W="text-gray-900 typo-sub-h2 border-b-[2.5px] border-gray-900",Y="text-gray-500 typo-sub-h5";const ee=60;function Xe(a,e,s){let{data:t}=e,l=t.box,o=t.places,n=[];Be(async()=>{E()}),je(()=>{L.un("change",I)});let f="map";const _=[];let g=[];function E(){g=o.filter(r=>!r.longitude||!r.latitude||_.includes(r.idx)?!1:(_.push(r.idx),!0)),L.on("change",I),g.forEach(r=>{var h;Q.emit("addIcon",{idx:Number(r.idx),coordinate:Ze([r.longitude,r.latitude]),image:((h=r==null?void 0:r.media)==null?void 0:h.at(0))??"",shape:"waterdrop",type:"place",link:`/places/${r.idx}`,rank:1,name:r.name,width:56,height:61})})}function I(){if(L.getFeatures().length!==g.length)return;L.un("change",I);const r=L.getExtent();Ne.fit(r,{padding:[ee,ee,ee,ee],duration:500,maxZoom:16})}function d(r,h){h&&!n.includes(r)?s(1,n=[...n,r]):!h&&n.includes(r)&&s(1,n=n.filter(B=>B!==r))}async function k(){if(!Ee())return Q.emit("showSignInModal",{removable:!0});try{if(!(await fetch(`${Ce}/boxes/${l.idx}/places`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${sessionStorage.getItem("jwt")}`},body:JSON.stringify({places:n})})).ok)throw"apierror";s(0,o=o.filter(h=>!n.includes(h.idx))),s(1,n=[]),Q.emit("pushSnackbar",{message:"박스에서 장소를 제거했습니다."})}catch{Q.emit("pushSnackbar",{message:"일시적으로 장애가 발생했습니다."})}}const A=()=>s(2,f="map"),D=()=>s(2,f="list"),V=(r,h)=>d(r.idx,h.currentTarget.checked),v=r=>ye(`/places/${r.idx}`);return a.$$set=r=>{"data"in r&&s(6,t=r.data)},[o,n,f,l,d,k,t,A,D,V,v]}class ft extends ke{constructor(e){super(),Ie(this,e,Xe,Je,oe,{data:6})}}export{ft as component,ut as universal};
