import{e as ue}from"../chunks/index.BEwhUcAi.js";import{b as le,A as ne,g as ie,e as T}from"../chunks/sign.DAu4KAMA.js";import{s as ce,e as f,a as E,c as g,b,g as D,z as K,f as d,x as r,N as oe,i as j,h as u,O as V,y as H,D as de,t as X,d as Y,E as Q,F as W}from"../chunks/scheduler.B6RFReyk.js";import{S as me,i as fe,c as ge,b as pe,m as he,t as Ce,a as be,d as _e}from"../chunks/index.DLC1-nrr.js";import{g as ve}from"../chunks/entry.CNKC8QBQ.js";import{H as ye}from"../chunks/Header.DwDN9eoa.js";import{g as Be,u as ke}from"../chunks/photo.XxuNTMUn.js";const xe=async({params:l,fetch:t,depends:e})=>{if(String(l.idx)!==String(le()))throw ue(403,"Forbidden");const a=(await(await t(`${ne}/auth/users/${l.idx}`,{headers:{Authorization:`Bearer ${ie()}`}})).json()).data;if(!(a!=null&&a.idx))throw ue(404,"User not found");return{user:a}},qe=Object.freeze(Object.defineProperty({__proto__:null,load:xe},Symbol.toStringTag,{value:"Module"}));function we(l){let t;return{c(){t=X("프로필 편집")},l(e){t=Y(e,"프로필 편집")},m(e,n){j(e,t,n)},d(e){e&&d(t)}}}function Ee(l){let t;return{c(){t=X("저장하기")},l(e){t=Y(e,"저장하기")},m(e,n){j(e,t,n)},d(e){e&&d(t)}}}function De(l){let t,e,n,s;return{c(){t=Q("svg"),e=Q("circle"),n=Q("path"),s=X(`
          저장 중...`),this.h()},l(a){t=W(a,"svg",{class:!0,viewBox:!0});var i=b(t);e=W(i,"circle",{class:!0,cx:!0,cy:!0,r:!0,stroke:!0,"stroke-width":!0,fill:!0}),b(e).forEach(d),n=W(i,"path",{class:!0,fill:!0,d:!0}),b(n).forEach(d),i.forEach(d),s=Y(a,`
          저장 중...`),this.h()},h(){r(e,"class","opacity-25"),r(e,"cx","12"),r(e,"cy","12"),r(e,"r","10"),r(e,"stroke","currentColor"),r(e,"stroke-width","4"),r(e,"fill","none"),r(n,"class","opacity-75"),r(n,"fill","currentColor"),r(n,"d","M4 12a8 8 0 0 0 8 8v-5l-3-3-5 0z"),r(t,"class","animate-spin h-5 w-5 mr-3 text-white"),r(t,"viewBox","0 0 24 24")},m(a,i){j(a,t,i),u(t,e),u(t,n),j(a,s,i)},d(a){a&&(d(t),d(s))}}}function Ie(l){let t,e,n,s,a,i,p,I,$,_,U='<svg class="w-4 h-4 text-gray-600 dark:text-gray-200" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V7a2 2 0 0 1 2-2h3l2-3h8l2 3h3a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>',A,c,h,P="이메일 (변경 불가)",L,v,F,x,w,Z="닉네임 (Unique Name)",G,y,J,N,B,S,R,ee;e=new ye({props:{position:"static",leftBack:!0,$$slots:{default:[we]},$$scope:{ctx:l}}});function te(o,m){return o[3]?De:Ee}let q=te(l),k=q(l);return{c(){t=f("div"),ge(e.$$.fragment),n=E(),s=f("main"),a=f("div"),i=f("div"),p=f("img"),$=E(),_=f("button"),_.innerHTML=U,A=E(),c=f("div"),h=f("label"),h.textContent=P,L=E(),v=f("input"),F=E(),x=f("div"),w=f("label"),w.textContent=Z,G=E(),y=f("input"),J=E(),N=f("div"),B=f("button"),k.c(),this.h()},l(o){t=g(o,"DIV",{class:!0});var m=b(t);pe(e.$$.fragment,m),n=D(m),s=g(m,"MAIN",{class:!0});var C=b(s);a=g(C,"DIV",{class:!0});var re=b(a);i=g(re,"DIV",{class:!0});var z=b(i);p=g(z,"IMG",{class:!0,src:!0,alt:!0}),$=D(z),_=g(z,"BUTTON",{class:!0,"data-svelte-h":!0}),K(_)!=="svelte-s766w9"&&(_.innerHTML=U),z.forEach(d),re.forEach(d),A=D(C),c=g(C,"DIV",{class:!0});var M=b(c);h=g(M,"LABEL",{class:!0,"data-svelte-h":!0}),K(h)!=="svelte-mkvsoj"&&(h.textContent=P),L=D(M),v=g(M,"INPUT",{type:!0,class:!0}),M.forEach(d),F=D(C),x=g(C,"DIV",{class:!0});var O=b(x);w=g(O,"LABEL",{class:!0,"data-svelte-h":!0}),K(w)!=="svelte-g6muw9"&&(w.textContent=Z),G=D(O),y=g(O,"INPUT",{type:!0,class:!0,placeholder:!0}),O.forEach(d),J=D(C),N=g(C,"DIV",{class:!0});var ae=b(N);B=g(ae,"BUTTON",{class:!0});var se=b(B);k.l(se),se.forEach(d),ae.forEach(d),C.forEach(d),m.forEach(d),this.h()},h(){r(p,"class","w-24 h-24 rounded-full object-cover border border-gray-200 dark:border-gray-700"),oe(p.src,I=l[2])||r(p,"src",I),r(p,"alt","Profile Image"),r(_,"class","absolute bottom-0 right-0 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-700 rounded-full p-2 shadow-sm hover:bg-gray-50 dark:hover:bg-gray-700 text-sm"),r(i,"class","relative"),r(a,"class","flex justify-center mt-6 mb-4"),r(h,"class","block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"),r(v,"type","text"),r(v,"class","w-full px-3 py-2 bg-gray-100 dark:bg-gray-700 border border-gray-200 dark:border-gray-600 rounded-md text-gray-700 dark:text-gray-200 cursor-not-allowed"),v.disabled=!0,r(c,"class","mb-4"),r(w,"class","block mb-1 text-sm font-medium text-gray-700 dark:text-gray-200"),r(y,"type","text"),r(y,"class","w-full px-3 py-2 bg-white dark:bg-gray-800 border border-gray-200 dark:border-gray-600 rounded-md text-gray-900 dark:text-gray-100 focus:outline-none focus:ring-1 focus:ring-blue-500"),r(y,"placeholder","예) mynickname"),r(x,"class","mb-4"),r(B,"class","w-full px-4 py-3 text-white hover:bg-primary-500 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 flex items-center justify-center bg-gradient-to-br from-primary-400 from-0% to-emerald-400 to-80% "),B.disabled=l[3],r(N,"class","mt-6"),r(s,"class","flex-1 px-4 py-6"),r(t,"class","flex flex-col min-h-screen")},m(o,m){j(o,t,m),he(e,t,null),u(t,n),u(t,s),u(s,a),u(a,i),u(i,p),u(i,$),u(i,_),u(s,A),u(s,c),u(c,h),u(c,L),u(c,v),V(v,l[0].email),u(s,F),u(s,x),u(x,w),u(x,G),u(x,y),V(y,l[1]),u(s,J),u(s,N),u(N,B),k.m(B,null),S=!0,R||(ee=[H(_,"click",l[5]),H(v,"input",l[7]),H(y,"input",l[8]),H(B,"click",l[4])],R=!0)},p(o,[m]){const C={};m&1024&&(C.$$scope={dirty:m,ctx:o}),e.$set(C),(!S||m&4&&!oe(p.src,I=o[2]))&&r(p,"src",I),m&1&&v.value!==o[0].email&&V(v,o[0].email),m&2&&y.value!==o[1]&&V(y,o[1]),q!==(q=te(o))&&(k.d(1),k=q(o),k&&(k.c(),k.m(B,null))),(!S||m&8)&&(B.disabled=o[3])},i(o){S||(Ce(e.$$.fragment,o),S=!0)},o(o){be(e.$$.fragment,o),S=!1},d(o){o&&d(t),_e(e),k.d(),R=!1,de(ee)}}}function Ne(l,t,e){let{data:n}=t,{user:s}=n,a=s.unique_name||"",i=s.profile_image_url||"",p=!1;function I(){return a.trim()?/^[a-z0-9._]{1,30}$/.test(a)?!0:(T.emit("pushSnackbar",{message:"Unique Name은 1-30자이며, 영어 소문자, 숫자, ., _ 만 허용됩니다."}),!1):(T.emit("pushSnackbar",{message:"닉네임(Unique Name)은 비어있을 수 없습니다."}),!1)}async function $(){if(I())try{e(3,p=!0);const c=le(),h=await fetch(`${ne}/auth/users/${c}`,{method:"PATCH",headers:{Authorization:`Bearer ${ie()}`,"Content-Type":"application/json"},body:JSON.stringify({uniqueName:a,profileImage:i})});if(h.ok)T.emit("pushSnackbar",{message:"프로필이 업데이트되었습니다."}),ve(`/users/${c}`);else{const P=await h.json();console.error(P),T.emit("pushSnackbar",{message:P.message||"프로필 수정에 실패했습니다."})}}catch(c){console.error(c),T.emit("pushSnackbar",{message:"서버와 통신 중 오류가 발생했습니다."})}finally{e(3,p=!1)}}async function _(){const c=await Be({limit:1}),h=await ke(c);e(2,i=h[0])}function U(){s.email=this.value,e(0,s)}function A(){a=this.value,e(1,a)}return l.$$set=c=>{"data"in c&&e(6,n=c.data)},[s,a,i,p,$,_,n,U,A]}class ze extends me{constructor(t){super(),fe(this,t,Ne,Ie,ce,{data:6})}}export{ze as component,qe as universal};
