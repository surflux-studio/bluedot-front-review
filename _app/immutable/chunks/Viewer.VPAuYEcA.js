import{$ as _t,a0 as pt,a1 as de,a2 as gt,s as _e,F as j,i as x,f as v,e as C,a as A,t as bt,c as M,b as D,g as N,d as vt,q as b,h as Y,v as Z,j as wt,E as we,n as H,I as Ce,J as Me,k as kt,A as It,B as Et,x as yt,M as Je,z as Ct,C as Mt,G as Q,T as xe,y as Qe,P as Pe,K as xt,w as Pt,H as he}from"./scheduler.Ds8JjPaX.js";import{g as z,a as P,f as R,t as E,S as pe,i as ge,c as $,b as ee,m as te,d as le}from"./index.ucgEq-dW.js";import{e as G,u as $e,o as et}from"./each.BmbOg1ua.js";import{A as Yt}from"./constants.B40lR-wj.js";import{g as Dt}from"./entry.CayY3Lwj.js";import{p as Lt}from"./stores.2r8ZKa-r.js";import{i as Ye,b as me,e as Vt,k as be}from"./sign.B9B4Tbt1.js";/* empty css                                           *//* empty css                                                  */import{C as St}from"./CircleImage.DKVfEI4O.js";import{s as T,g as Xt,a as ve}from"./s32cloudfront.yu0ljD8J.js";import{g as jt,u as At}from"./searchParams.Ig__F9As.js";import{I as Nt,Y as Ht}from"./InstagramPlayer.B61rOJ0M.js";import{r as ae}from"./units.BJZU6p1c.js";import"./index.CGKP_Meo.js";import{C as Tt}from"./Chip.L8SttFQK.js";import{B as Bt}from"./BottomNavigationPadder.lFXP-Uph.js";function De(s,e){const n=e.token={};function t(l,r,a,d){if(e.token!==n)return;e.resolved=d;let i=e.ctx;a!==void 0&&(i=i.slice(),i[a]=d);const u=l&&(e.current=l)(i);let h=!1;e.block&&(e.blocks?e.blocks.forEach((w,p)=>{p!==r&&w&&(z(),P(w,1,1,()=>{e.blocks[p]===w&&(e.blocks[p]=null)}),R())}):e.block.d(1),u.c(),E(u,1),u.m(e.mount(),e.anchor),h=!0),e.block=u,e.blocks&&(e.blocks[r]=u),h&&gt()}if(_t(s)){const l=pt();if(s.then(r=>{de(l),t(e.then,1,e.value,r),de(null)},r=>{if(de(l),t(e.catch,2,e.error,r),de(null),!e.hasCatch)throw r}),e.current!==e.pending)return t(e.pending,0),!0}else{if(e.current!==e.then)return t(e.then,1,e.value,s),!0;e.resolved=s}}function zt(s,e,n){const t=e.slice(),{resolved:l}=s;s.current===s.then&&(t[s.value]=l),s.current===s.catch&&(t[s.error]=l),s.block.p(t,n)}function Le(s){let e,n,t,l,r,a=s[0].name+"",d,i,u=Ye()&&String(s[0].idx)!==String(me()),h,w,p;t=new St({props:{src:T(s[0].image,500),width:"1.5rem",strokeColor:"white",strokeWidth:"0"}});let m=u&&Ve(s);return{c(){e=C("div"),n=C("div"),$(t.$$.fragment),l=A(),r=C("div"),d=bt(a),i=A(),m&&m.c(),this.h()},l(_){e=M(_,"DIV",{class:!0});var g=D(e);n=M(g,"DIV",{class:!0});var o=D(n);ee(t.$$.fragment,o),l=N(o),r=M(o,"DIV",{class:!0});var c=D(r);d=vt(c,a),c.forEach(v),o.forEach(v),i=N(g),m&&m.l(g),g.forEach(v),this.h()},h(){b(r,"class","text-lg font-semibold text-white"),b(n,"class","drop-shadow-[0px_0px_5px_gray] text-center flex gap-3 justify-center items-center"),b(e,"class","flex gap-2 justify-center items-center")},m(_,g){x(_,e,g),Y(e,n),te(t,n,null),Y(n,l),Y(n,r),Y(r,d),Y(e,i),m&&m.m(e,null),h=!0,w||(p=Z(n,"click",s[3]),w=!0)},p(_,g){const o={};g&1&&(o.src=T(_[0].image,500)),t.$set(o),(!h||g&1)&&a!==(a=_[0].name+"")&&wt(d,a),g&1&&(u=Ye()&&String(_[0].idx)!==String(me())),u?m?m.p(_,g):(m=Ve(_),m.c(),m.m(e,null)):m&&(m.d(1),m=null)},i(_){h||(E(t.$$.fragment,_),h=!0)},o(_){P(t.$$.fragment,_),h=!1},d(_){_&&v(e),le(t),m&&m.d(),w=!1,p()}}}function Ve(s){let e;function n(r,a){return r[0].following?qt:Rt}let t=n(s),l=t(s);return{c(){l.c(),e=j()},l(r){l.l(r),e=j()},m(r,a){l.m(r,a),x(r,e,a)},p(r,a){t===(t=n(r))&&l?l.p(r,a):(l.d(1),l=t(r),l&&(l.c(),l.m(e.parentNode,e)))},d(r){r&&v(e),l.d(r)}}}function Rt(s){let e,n="팔로우",t,l;return{c(){e=C("div"),e.textContent=n},l(r){e=M(r,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-1jp5r6h"&&(e.textContent=n)},m(r,a){x(r,e,a),t||(l=Z(e,"click",s[1]),t=!0)},p:H,d(r){r&&v(e),t=!1,l()}}}function qt(s){let e,n="팔로잉",t,l;return{c(){e=C("div"),e.textContent=n},l(r){e=M(r,"DIV",{"data-svelte-h":!0}),we(e)!=="svelte-znfcjz"&&(e.textContent=n)},m(r,a){x(r,e,a),t||(l=Z(e,"click",s[2]),t=!0)},p:H,d(r){r&&v(e),t=!1,l()}}}function Ft(s){let e,n,t=s[0].idx&&Le(s);return{c(){t&&t.c(),e=j()},l(l){t&&t.l(l),e=j()},m(l,r){t&&t.m(l,r),x(l,e,r),n=!0},p(l,[r]){l[0].idx?t?(t.p(l,r),r&1&&E(t,1)):(t=Le(l),t.c(),E(t,1),t.m(e.parentNode,e)):t&&(z(),P(t,1,1,()=>{t=null}),R())},i(l){n||(E(t),n=!0)},o(l){P(t),n=!1},d(l){l&&v(e),t&&t.d(l)}}}function Ot(s,e,n){let{user:t={idx:"0",name:"",image:"",following:!1}}=e;async function l(){await follow({targetIdx:post.user_idx,subjectIdx:me()}),n(0,t.following=!0,t)}async function r(){await unfollow({targetIdx:post.user_idx,subjectIdx:me()}),n(0,t.following=!1,t)}const a=()=>{jt(`/users/${t.idx}`)};return s.$$set=d=>{"user"in d&&n(0,t=d.user)},[t,l,r,a]}class Wt extends pe{constructor(e){super(),ge(this,e,Ot,Ft,_e,{user:0})}}function Zt(s){const n=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(t=>{const l=r=>r.stopPropagation();return s.addEventListener(t,l),{event:t,handler:l}});return{destroy(){n.forEach(({event:t,handler:l})=>{s.removeEventListener(t,l)})}}}function Gt(s){let e,n;return{c(){e=Ce("svg"),n=Ce("path"),this.h()},l(t){e=Me(t,"svg",{width:!0,height:!0,viewBox:!0,fill:!0,xmlns:!0});var l=D(e);n=Me(l,"path",{d:!0,fill:!0}),D(n).forEach(v),l.forEach(v),this.h()},h(){b(n,"d","M10 20.2731L4.69667 14.9698C3.64779 13.9209 2.93349 12.5845 2.64411 11.1296C2.35473 9.67479 2.50326 8.1668 3.07092 6.79636C3.63858 5.42592 4.59987 4.25458 5.83324 3.43048C7.0666 2.60637 8.51665 2.1665 10 2.1665C11.4834 2.1665 12.9334 2.60637 14.1668 3.43048C15.4001 4.25458 16.3614 5.42592 16.9291 6.79636C17.4968 8.1668 17.6453 9.67479 17.3559 11.1296C17.0665 12.5845 16.3522 13.9209 15.3033 14.9698L10 20.2731ZM14.125 13.7914C14.9408 12.9756 15.4963 11.9362 15.7213 10.8047C15.9463 9.67313 15.8308 8.50027 15.3892 7.4344C14.9477 6.36853 14.2 5.45753 13.2408 4.81658C12.2815 4.17563 11.1537 3.83353 10 3.83353C8.8463 3.83353 7.71851 4.17563 6.75924 4.81658C5.79997 5.45753 5.05229 6.36853 4.61076 7.4344C4.16923 8.50027 4.05368 9.67313 4.27871 10.8047C4.50374 11.9362 5.05926 12.9756 5.875 13.7914L10 17.9164L14.125 13.7914ZM10 11.3331C9.55798 11.3331 9.13405 11.1575 8.82149 10.8449C8.50893 10.5324 8.33334 10.1085 8.33334 9.66644C8.33334 9.22441 8.50893 8.80049 8.82149 8.48793C9.13405 8.17537 9.55798 7.99977 10 7.99977C10.442 7.99977 10.866 8.17537 11.1785 8.48793C11.4911 8.80049 11.6667 9.22441 11.6667 9.66644C11.6667 10.1085 11.4911 10.5324 11.1785 10.8449C10.866 11.1575 10.442 11.3331 10 11.3331Z"),b(n,"fill","black"),b(e,"width",s[0]),b(e,"height",s[0]),b(e,"viewBox","0 0 20 20"),b(e,"fill","none"),b(e,"xmlns","http://www.w3.org/2000/svg")},m(t,l){x(t,e,l),Y(e,n)},p(t,[l]){l&1&&b(e,"width",t[0]),l&1&&b(e,"height",t[0])},i:H,o:H,d(t){t&&v(e)}}}function Ut(s,e,n){let t,{fill:l="#5f6368"}=e,{length:r="1.75"}=e;return s.$$set=a=>{"fill"in a&&n(1,l=a.fill),"length"in a&&n(2,r=a.length)},s.$$.update=()=>{s.$$.dirty&4&&n(0,t=ae(r))},[t,l,r]}class Kt extends pe{constructor(e){super(),ge(this,e,Ut,Gt,_e,{fill:1,length:2})}}function Se(s){let e,n;return e=new Tt({props:{textColor:"text-black",prefixIconComponent:Kt,value:s[0].name}}),e.$on("click",s[1]),{c(){$(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),n=!0},p(t,l){const r={};l&1&&(r.value=t[0].name),e.$set(r)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){le(e,t)}}}function Jt(s){let e,n,t=s[0].idx&&Se(s);return{c(){t&&t.c(),e=j()},l(l){t&&t.l(l),e=j()},m(l,r){t&&t.m(l,r),x(l,e,r),n=!0},p(l,[r]){l[0].idx?t?(t.p(l,r),r&1&&E(t,1)):(t=Se(l),t.c(),E(t,1),t.m(e.parentNode,e)):t&&(z(),P(t,1,1,()=>{t=null}),R())},i(l){n||(E(t),n=!0)},o(l){P(t),n=!1},d(l){l&&v(e),t&&t.d(l)}}}function Qt(s,e,n){let{place:t}=e;const l=async()=>{await Dt(`/places/${t.idx}`)};return s.$$set=r=>{"place"in r&&n(0,t=r.place)},[t,l]}class $t extends pe{constructor(e){super(),ge(this,e,Qt,Jt,_e,{place:0})}}function Xe(s,e,n){const t=s.slice();return t[47]=e[n],t[49]=n,t}function je(s,e,n){const t=s.slice();return t[50]=e[n],t[51]=e,t[52]=n,t}function Ae(s,e,n){const t=s.slice();return t[47]=e[n],t[49]=n,t}function Ne(s,e,n){const t=s.slice();return t[54]=e[n],t[49]=n,t}function He(s){let e,n,t;return{c(){e=C("div"),this.h()},l(l){e=M(l,"DIV",{class:!0}),D(e).forEach(v),this.h()},h(){b(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(l,r){x(l,e,r),n||(t=Z(e,"contextmenu",yt(s[17])),n=!0)},d(l){l&&v(e),n=!1,t()}}}function Te(s){let e,n,t,l=[],r=new Map,a,d,i,u,h,w,p,m=G(s[50].media);const _=o=>o[54];for(let o=0;o<m.length;o+=1){let c=Ne(s,m,o),I=_(c);r.set(I,l[o]=Be(I,c))}let g=!s[2]&&ze(s);return{c(){e=C("div"),n=C("div"),t=C("div");for(let o=0;o<l.length;o+=1)l[o].c();d=A(),g&&g.c(),i=A(),this.h()},l(o){e=M(o,"DIV",{class:!0,style:!0});var c=D(e);n=M(c,"DIV",{class:!0});var I=D(n);t=M(I,"DIV",{class:!0,style:!0});var X=D(t);for(let B=0;B<l.length;B+=1)l[B].l(X);X.forEach(v),I.forEach(v),d=N(c),g&&g.l(c),i=N(c),c.forEach(v),this.h()},h(){b(t,"class",a="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(s[4]?"duration-0 transition-duration-0":"")),Q(t,"transform","translateX("+(-s[50].mediaIdx*s[7].width+s[6])+"px)"),b(n,"class","carousel-container w-full h-full overflow-hidden relative select-none"),b(e,"class",u="gradient-overlay w-full h-full absolute content-center transition-transform before:content-[''] before:absolute before:left-0 before:right-0 before:h-1/2 before:pointer-events-none before:top-0 before:bg-gradient-to-b before:from-black/50 before:to-transparent after:content-[''] after:absolute after:left-0 after:right-0 after:h-1/2 after:pointer-events-none after:bottom-0 after:bg-gradient-to-t after:from-black/50 after:to-transparent "+(s[4]?"duration-0 transition-duration-0":"")),Q(e,"top","0"),Q(e,"transform","translateY("+((s[52]-s[1])*s[7].height+s[5])+"px)")},m(o,c){x(o,e,c),Y(e,n),Y(n,t);for(let I=0;I<l.length;I+=1)l[I]&&l[I].m(t,null);Y(e,d),g&&g.m(e,null),Y(e,i),h=!0,w||(p=[Z(t,"transitionend",function(){xe(s[50].mediaIdx===s[0][s[1]].mediaIdx?s[11]:void 0)&&(s[50].mediaIdx===s[0][s[1]].mediaIdx?s[11]:void 0).apply(this,arguments)}),Z(e,"transitionend",function(){xe(s[52]===s[1]?s[11]:void 0)&&(s[52]===s[1]?s[11]:void 0).apply(this,arguments)})],w=!0)},p(o,c){s=o,c[0]&1543&&(m=G(s[50].media),z(),l=$e(l,c,_,1,s,m,r,t,et,Be,null,Ne),R()),(!h||c[0]&16&&a!==(a="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(s[4]?"duration-0 transition-duration-0":"")))&&b(t,"class",a),(!h||c[0]&193)&&Q(t,"transform","translateX("+(-s[50].mediaIdx*s[7].width+s[6])+"px)"),s[2]?g&&(z(),P(g,1,1,()=>{g=null}),R()):g?(g.p(s,c),c[0]&4&&E(g,1)):(g=ze(s),g.c(),E(g,1),g.m(e,i)),(!h||c[0]&16&&u!==(u="gradient-overlay w-full h-full absolute content-center transition-transform before:content-[''] before:absolute before:left-0 before:right-0 before:h-1/2 before:pointer-events-none before:top-0 before:bg-gradient-to-b before:from-black/50 before:to-transparent after:content-[''] after:absolute after:left-0 after:right-0 after:h-1/2 after:pointer-events-none after:bottom-0 after:bg-gradient-to-t after:from-black/50 after:to-transparent "+(s[4]?"duration-0 transition-duration-0":"")))&&b(e,"class",u),(!h||c[0]&163)&&Q(e,"transform","translateY("+((s[52]-s[1])*s[7].height+s[5])+"px)")},i(o){if(!h){for(let c=0;c<m.length;c+=1)E(l[c]);E(g),h=!0}},o(o){for(let c=0;c<l.length;c+=1)P(l[c]);P(g),h=!1},d(o){o&&v(e);for(let c=0;c<l.length;c+=1)l[c].d();g&&g.d(),w=!1,Qe(p)}}}function el(s){let e,n,t={ctx:s,current:null,token:null,hasCatch:!1,pending:rl,then:sl,catch:nl};return De(n=s[10](T(s[54])),t),{c(){e=j(),t.block.c()},l(l){e=j(),t.block.l(l)},m(l,r){x(l,e,r),t.block.m(l,t.anchor=r),t.mount=()=>e.parentNode,t.anchor=e},p(l,r){s=l,t.ctx=s,r[0]&1&&n!==(n=s[10](T(s[54])))&&De(n,t)||zt(t,s,r)},i:H,o:H,d(l){l&&v(e),t.block.d(l),t.token=null,t=null}}}function tl(s){let e,n;return e=new Nt({props:{instagramId:ve(s[54])}}),{c(){$(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),n=!0},p(t,l){const r={};l[0]&1&&(r.instagramId=ve(t[54])),e.$set(r)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){le(e,t)}}}function ll(s){let e,n;return e=new Ht({props:{src:s[54]}}),{c(){$(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),n=!0},p(t,l){const r={};l[0]&1&&(r.src=t[54]),e.$set(r)},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){le(e,t)}}}function nl(s){return{c:H,l:H,m:H,p:H,d:H}}function sl(s){let e,n,t,l;return{c(){e=C("img"),this.h()},l(r){e=M(r,"IMG",{src:!0,alt:!0,class:!0,draggable:!0}),this.h()},h(){he(e.src,n=T(s[54]))||b(e,"src",n),b(e,"alt",t=s[50].place_name),b(e,"class",l="select-none pointer-events-none "+(s[2]?"rounded-xl":"")+" "+(s[9][T(s[54])]?"w-screen h-screen object-cover":"w-full h-full object-contain")),b(e,"draggable","false")},m(r,a){x(r,e,a)},p(r,a){a[0]&1&&!he(e.src,n=T(r[54]))&&b(e,"src",n),a[0]&1&&t!==(t=r[50].place_name)&&b(e,"alt",t),a[0]&517&&l!==(l="select-none pointer-events-none "+(r[2]?"rounded-xl":"")+" "+(r[9][T(r[54])]?"w-screen h-screen object-cover":"w-full h-full object-contain"))&&b(e,"class",l)},d(r){r&&v(e)}}}function rl(s){let e,n,t,l;return{c(){e=C("img"),this.h()},l(r){e=M(r,"IMG",{src:!0,alt:!0,class:!0,draggable:!0}),this.h()},h(){he(e.src,n=T(s[54]))||b(e,"src",n),b(e,"alt",t=s[50].place_name),b(e,"class",l="w-full h-full object-contain select-none pointer-events-none "+(s[2]?"rounded-xl":"")),b(e,"draggable","false")},m(r,a){x(r,e,a)},p(r,a){a[0]&1&&!he(e.src,n=T(r[54]))&&b(e,"src",n),a[0]&1&&t!==(t=r[50].place_name)&&b(e,"alt",t),a[0]&4&&l!==(l="w-full h-full object-contain select-none pointer-events-none "+(r[2]?"rounded-xl":""))&&b(e,"class",l)},d(r){r&&v(e)}}}function Be(s,e){let n,t,l,r,a,d,i,u,h;const w=[ll,tl,el],p=[];function m(_,g){return g[0]&3&&(l=null),g[0]&3&&(r=null),l==null&&(l=!!(Xt(_[54])&&_[52]===_[1])),l?0:(r==null&&(r=!!(ve(_[54])&&_[52]===_[1])),r?1:2)}return a=m(e,[-1,-1]),d=p[a]=w[a](e),{key:s,first:null,c(){n=C("div"),t=C("div"),d.c(),u=A(),this.h()},l(_){n=M(_,"DIV",{class:!0});var g=D(n);t=M(g,"DIV",{class:!0});var o=D(t);d.l(o),o.forEach(v),u=N(g),g.forEach(v),this.h()},h(){b(t,"class",i="w-full h-full flex justify-center items-center "+(e[2]?"p-5":"")),b(n,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=n},m(_,g){x(_,n,g),Y(n,t),p[a].m(t,null),Y(n,u),h=!0},p(_,g){e=_;let o=a;a=m(e,g),a===o?p[a].p(e,g):(z(),P(p[o],1,1,()=>{p[o]=null}),R(),d=p[a],d?d.p(e,g):(d=p[a]=w[a](e),d.c()),E(d,1),d.m(t,null)),(!h||g[0]&4&&i!==(i="w-full h-full flex justify-center items-center "+(e[2]?"p-5":"")))&&b(t,"class",i)},i(_){h||(E(d),h=!0)},o(_){P(d),h=!1},d(_){_&&v(n),p[a].d()}}}function ze(s){var h,w;let e,n,t,l,r,a,d,i=s[50].media.length>1&&Re(s);t=new Wt({props:{user:{idx:s[50].user_idx,name:s[50].unique_name,image:s[50].profile_image_url,signerIsFollowing:s[50].is_following}}});let u=((w=(h=s[50])==null?void 0:h.text)==null?void 0:w.length)>0&&Fe(s);return a=new $t({props:{place:{idx:s[50].place_idx,name:s[50].place_name}}}),{c(){e=C("div"),i&&i.c(),n=A(),$(t.$$.fragment),l=A(),u&&u.c(),r=A(),$(a.$$.fragment),this.h()},l(p){e=M(p,"DIV",{class:!0,style:!0});var m=D(e);i&&i.l(m),n=N(m),ee(t.$$.fragment,m),l=N(m),u&&u.l(m),r=N(m),ee(a.$$.fragment,m),m.forEach(v),this.h()},h(){b(e,"class","fixed bottom-0 w-full px-5 py-2 text-white text-md flex flex-col items-start gap-2 z-40 transition-transform drop-shadow-[0px_0px_5px_black]"),Q(e,"transform","translateY("+s[3]+"px)")},m(p,m){x(p,e,m),i&&i.m(e,null),Y(e,n),te(t,e,null),Y(e,l),u&&u.m(e,null),Y(e,r),te(a,e,null),d=!0},p(p,m){var o,c;p[50].media.length>1?i?i.p(p,m):(i=Re(p),i.c(),i.m(e,n)):i&&(i.d(1),i=null);const _={};m[0]&1&&(_.user={idx:p[50].user_idx,name:p[50].unique_name,image:p[50].profile_image_url,signerIsFollowing:p[50].is_following}),t.$set(_),((c=(o=p[50])==null?void 0:o.text)==null?void 0:c.length)>0?u?u.p(p,m):(u=Fe(p),u.c(),u.m(e,r)):u&&(u.d(1),u=null);const g={};m[0]&1&&(g.place={idx:p[50].place_idx,name:p[50].place_name}),a.$set(g),(!d||m[0]&8)&&Q(e,"transform","translateY("+p[3]+"px)")},i(p){d||(E(t.$$.fragment,p),E(a.$$.fragment,p),d=!0)},o(p){P(t.$$.fragment,p),P(a.$$.fragment,p),d=!1},d(p){p&&v(e),i&&i.d(),le(t),u&&u.d(),le(a)}}}function Re(s){let e,n=G(s[50].media),t=[];for(let l=0;l<n.length;l+=1)t[l]=qe(Ae(s,n,l));return{c(){e=C("div");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=M(l,"DIV",{class:!0});var r=D(e);for(let a=0;a<t.length;a+=1)t[a].l(r);r.forEach(v),this.h()},h(){b(e,"class","carousel-nav flex justify-center relative w-full gap-1.5")},m(l,r){x(l,e,r);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(l,r){if(r[0]&1){n=G(l[50].media);let a;for(a=0;a<n.length;a+=1){const d=Ae(l,n,a);t[a]?t[a].p(d,r):(t[a]=qe(d),t[a].c(),t[a].m(e,null))}for(;a<t.length;a+=1)t[a].d(1);t.length=n.length}},d(l){l&&v(e),Je(t,l)}}}function qe(s){let e,n;return{c(){e=C("span"),this.h()},l(t){e=M(t,"SPAN",{class:!0}),D(e).forEach(v),this.h()},h(){b(e,"class",n="carousel-dot w-1.5 h-1.5 rounded-md "+(s[50].mediaIdx===s[49]?"bg-white":"bg-white/50"))},m(t,l){x(t,e,l)},p(t,l){l[0]&1&&n!==(n="carousel-dot w-1.5 h-1.5 rounded-md "+(t[50].mediaIdx===t[49]?"bg-white":"bg-white/50"))&&b(e,"class",n)},d(t){t&&v(e)}}}function Fe(s){let e,n,t,l=String(s[50].text).includes(`
`),r,a;function d(){s[18].call(n,s[51],s[52])}let i=l&&Oe();return{c(){e=C("div"),n=C("textarea"),t=A(),i&&i.c(),this.h()},l(u){e=M(u,"DIV",{class:!0});var h=D(e);n=M(h,"TEXTAREA",{class:!0}),D(n).forEach(v),t=N(h),i&&i.l(h),h.forEach(v),this.h()},h(){b(n,"class","w-full h-5 py-0 px-1 bg-transparent text-sm drop-shadow-[0px_0px_5px_gray] placeholder:text-white/75 box-content read-only:cursor-pointer transition-all duration-300 overflow-y-auto border-none ring-0 focus:ring-0 outline-none focus:outline-none"),n.readOnly=!0,b(e,"class","flex flex-col gap-1 w-full")},m(u,h){x(u,e,h),Y(e,n),Pe(n,s[50].text),Y(e,t),i&&i.m(e,null),r||(a=[xt(Zt.call(null,n)),Z(n,"input",d),Z(e,"click",Pt(s[12]))],r=!0)},p(u,h){s=u,h[0]&1&&Pe(n,s[50].text),h[0]&1&&(l=String(s[50].text).includes(`
`)),l?i||(i=Oe(),i.c(),i.m(e,null)):i&&(i.d(1),i=null)},d(u){u&&v(e),i&&i.d(),r=!1,Qe(a)}}}function Oe(s){let e,n="더 보기";return{c(){e=C("span"),e.textContent=n,this.h()},l(t){e=M(t,"SPAN",{class:!0,"data-svelte-h":!0}),we(e)!=="svelte-1c5s9cw"&&(e.textContent=n),this.h()},h(){b(e,"class","text-xs text-white/75 px-1")},m(t,l){x(t,e,l)},d(t){t&&v(e)}}}function We(s,e){let n,t=Math.abs(e[1]-e[52])<=1,l,r,a=t&&Te(e);return{key:s,first:null,c(){n=j(),a&&a.c(),l=j(),this.h()},l(d){n=j(),a&&a.l(d),l=j(),this.h()},h(){this.first=n},m(d,i){x(d,n,i),a&&a.m(d,i),x(d,l,i),r=!0},p(d,i){e=d,i[0]&3&&(t=Math.abs(e[1]-e[52])<=1),t?a?(a.p(e,i),i[0]&3&&E(a,1)):(a=Te(e),a.c(),E(a,1),a.m(l.parentNode,l)):a&&(z(),P(a,1,1,()=>{a=null}),R())},i(d){r||(E(a),r=!0)},o(d){P(a),r=!1},d(d){d&&(v(n),v(l)),a&&a.d(d)}}}function Ze(s){var r;let e,n,t=G(((r=s[0][s[1]])==null?void 0:r.media)||[]),l=[];for(let a=0;a<t.length;a+=1)l[a]=Ge(Xe(s,t,a));return{c(){e=C("div"),n=C("div");for(let a=0;a<l.length;a+=1)l[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var d=D(e);n=M(d,"DIV",{class:!0});var i=D(n);for(let u=0;u<l.length;u+=1)l[u].l(i);i.forEach(v),d.forEach(v),this.h()},h(){b(n,"class","carousel-nav flex justify-center relative w-full gap-1.5"),b(e,"class","relative z-10 p-4 bg-transparent")},m(a,d){x(a,e,d),Y(e,n);for(let i=0;i<l.length;i+=1)l[i]&&l[i].m(n,null)},p(a,d){var i;if(d[0]&3){t=G(((i=a[0][a[1]])==null?void 0:i.media)||[]);let u;for(u=0;u<t.length;u+=1){const h=Xe(a,t,u);l[u]?l[u].p(h,d):(l[u]=Ge(h),l[u].c(),l[u].m(n,null))}for(;u<l.length;u+=1)l[u].d(1);l.length=t.length}},d(a){a&&v(e),Je(l,a)}}}function Ge(s){let e,n;return{c(){e=C("span"),this.h()},l(t){e=M(t,"SPAN",{class:!0}),D(e).forEach(v),this.h()},h(){var t;b(e,"class",n="carousel-dot w-1.5 h-1.5 rounded-md "+(((t=s[0][s[1]])==null?void 0:t.mediaIdx)===s[49]?"bg-gray-300":"bg-gray-700"))},m(t,l){x(t,e,l)},p(t,l){var r;l[0]&3&&n!==(n="carousel-dot w-1.5 h-1.5 rounded-md "+(((r=t[0][t[1]])==null?void 0:r.mediaIdx)===t[49]?"bg-gray-300":"bg-gray-700"))&&b(e,"class",n)},d(t){t&&v(e)}}}function Ue(s){let e,n;return e=new Bt({}),{c(){$(e.$$.fragment)},l(t){ee(e.$$.fragment,t)},m(t,l){te(e,t,l),n=!0},i(t){n||(E(e.$$.fragment,t),n=!0)},o(t){P(e.$$.fragment,t),n=!1},d(t){le(e,t)}}}function al(s){var g;let e,n,t,l=[],r=new Map,a,d,i,u,h=!s[2]&&He(s),w=G(s[0]);const p=o=>o[50].idx;for(let o=0;o<w.length;o+=1){let c=je(s,w,o),I=p(c);r.set(I,l[o]=We(I,c))}let m=s[2]&&((g=s[0][s[1]])==null?void 0:g.media.length)>1&&Ze(s),_=!s[2]&&Ue();return{c(){h&&h.c(),e=A(),n=C("div"),t=C("div");for(let o=0;o<l.length;o+=1)l[o].c();a=A(),m&&m.c(),d=A(),_&&_.c(),this.h()},l(o){h&&h.l(o),e=N(o),n=M(o,"DIV",{class:!0});var c=D(n);t=M(c,"DIV",{class:!0});var I=D(t);for(let X=0;X<l.length;X+=1)l[X].l(I);I.forEach(v),a=N(c),m&&m.l(c),d=N(c),_&&_.l(c),c.forEach(v),this.h()},h(){b(t,"class","flex flex-grow relative w-full h-full bg-black"),b(n,"class",i="viewer bg-black select-none flex flex-col "+(s[2]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen"))},m(o,c){h&&h.m(o,c),x(o,e,c),x(o,n,c),Y(n,t);for(let I=0;I<l.length;I+=1)l[I]&&l[I].m(t,null);Y(n,a),m&&m.m(n,null),Y(n,d),_&&_.m(n,null),s[19](n),u=!0},p(o,c){var I;o[2]?h&&(h.d(1),h=null):h||(h=He(o),h.c(),h.m(e.parentNode,e)),c[0]&7935&&(w=G(o[0]),z(),l=$e(l,c,p,1,o,w,r,t,et,We,null,je),R()),o[2]&&((I=o[0][o[1]])==null?void 0:I.media.length)>1?m?m.p(o,c):(m=Ze(o),m.c(),m.m(n,d)):m&&(m.d(1),m=null),o[2]?_&&(z(),P(_,1,1,()=>{_=null}),R()):_?c[0]&4&&E(_,1):(_=Ue(),_.c(),E(_,1),_.m(n,null)),(!u||c[0]&4&&i!==(i="viewer bg-black select-none flex flex-col "+(o[2]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen")))&&b(n,"class",i)},i(o){if(!u){for(let c=0;c<w.length;c+=1)E(l[c]);E(_),u=!0}},o(o){for(let c=0;c<l.length;c+=1)P(l[c]);P(_),u=!1},d(o){o&&(v(e),v(n)),h&&h.d(o);for(let c=0;c<l.length;c+=1)l[c].d();m&&m.d(),_&&_.d(),s[19](null)}}}const il=30,ol=10,Ke=150;function fl(s){return new Promise(e=>{const n=new Image;n.onload=()=>{const t=n.height/n.width;e(t>=15/9)},n.src=s})}function ie(s){return"touches"in s||"changedTouches"in s}function cl(s){return ie(s)?[s.touches[0].clientX,s.touches[0].clientY]:[s.clientX,s.clientY]}function ul(s,e,n){let t;kt(s,Lt,f=>n(30,t=f));let{posts:l=[]}=e,{index:r=0}=e,{type:a=t.url.searchParams.get("type")}=e,{isEdit:d=!1}=e,{dontMoveVertically:i=!1}=e,{keyboardY:u=0}=e,h=!0,w=!1,p=!1,m=0,_=0,g={width:0,height:0},o=!1,c=!1,I=!1,X=-1,B=-1,U,oe=!1,q=[],F=[],O,se={};async function tt(f){se[f]===void 0&&(n(9,se[f]=await fl(f),se),n(9,se))}async function W(){At({mediaIdx:`${l[r].mediaIdx||0}`,postIdx:`${l[r].idx}`},{replace:!0})}async function lt(){n(15,o=!0);const f=l.length,k=t.url.searchParams.get("userIdx"),y=t.url.searchParams.get("placeIdx"),L=`&offset=${f}`,V=`&limit=${il}`,S=k?`&userIdx=${k}`:"",re=y?`&placeIdx=${y}`:"",K=(await fetch(`${Yt}/posts?${S}${re}${L}${V}`).then(J=>J.json()).then(J=>{var ye;return((ye=J.data)==null?void 0:ye.posts)??[]})).map(J=>({...J,mediaIdx:0}));K.length===0&&n(16,c=!0),n(0,l=[...l,...K]),n(15,o=!1)}function nt(f){const{height:k}=g;if(r===0&&f>0||r===l.length-1&&f<0){n(5,m=f*.3);return}n(5,m=Math.max(Math.min(f,k),-k))}function st(f){n(4,h=!1);const k=ae(2),y=ie(f)?f.changedTouches[0].clientY-B:f.clientY-B;y>k&&r>0?(n(1,r-=1),w=!0,W()):-y>k&&r<l.length-1&&(n(1,r+=1),w=!0,W()),n(5,m=0)}function rt(f){const{width:k}=g,y=l[r].mediaIdx,L=l[r].media.length-1;if(y===0&&f>0||y===L&&f<0){n(6,_=f*.3);return}n(6,_=Math.max(Math.min(f,k),-k))}function at(f){n(4,h=!1);const k=ae(2),y=ie(f)?f.changedTouches[0].clientX-X:f.clientX-X,L=l[r].mediaIdx,V=l[r].media.length-1;y>k&&L>0?ne(L-1):-y>k&&L<V&&ne(L+1),n(6,_=0)}function ne(f){n(0,l[r]={...l[r],mediaIdx:f},l),n(0,l=[...l]),p=!0,W()}function fe(f){I||w||p||(oe=!0,U=void 0,be.set(!0),ie(f)?(X=f.touches[0].clientX,B=f.touches[0].clientY):(X=f.clientX,B=f.clientY,window.addEventListener("mousemove",ce,{passive:!1}),window.addEventListener("mouseup",ue)))}function ce(f){if(I||!oe||w||p)return;const[k,y]=cl(f),L=k-X,V=y-B;U===void 0&&(U=Math.abs(V)>=Math.abs(L)?"post":"media"),!i&&U==="post"?nt(V):U==="media"&&rt(L)}function ue(f){I||!oe||w||p||(oe=!1,U==="post"?st(f):U==="media"?at(f):be.set(!1),ie(f)||(window.removeEventListener("mousemove",ce),window.removeEventListener("mouseup",ue)))}function ke(f){if(I||w||p)return;f.preventDefault();const k=Date.now(),y=Math.abs(f.deltaX),L=Math.abs(f.deltaY);if(y>L){if(F.push({deltaX:f.deltaX,timestamp:k}),F=F.filter(V=>k-V.timestamp<=Ke),F.length>=2){const V=F[0],S=F[F.length-1];if(Math.abs(S.deltaX)-Math.abs(V.deltaX)>=0&&Math.abs(S.deltaX)>=30){const K=l[r].mediaIdx,J=l[r].media.length-1;S.deltaX>0&&K<J?ne(K+1):S.deltaX<0&&K>0&&ne(K-1),F=[],p=!0}}}else if(q.push({deltaY:f.deltaY,timestamp:k}),q=q.filter(V=>k-V.timestamp<=Ke),q.length>=2){const V=q[0],S=q[q.length-1];Math.abs(S.deltaY)-Math.abs(V.deltaY)>=0&&Math.abs(S.deltaY)>=30&&(S.deltaY>0&&r<l.length-1?(n(4,h=!1),n(1,r+=1),W(),w=!0):S.deltaY<0&&r>0&&(n(4,h=!1),n(1,r-=1),W(),w=!0),q=[])}}function Ie(f){if(I||w||p)return;const k=l[r].mediaIdx,y=l[r].media.length-1;switch(f.key){case"ArrowUp":r>0&&(n(4,h=!1),n(1,r--,r),w=!0,W());break;case"ArrowDown":r<l.length-1&&(n(4,h=!1),n(1,r++,r),w=!0,W());break;case"ArrowLeft":k>0&&(n(4,h=!1),p=!0,ne(k-1));break;case"ArrowRight":k<y&&(n(4,h=!1),p=!0,ne(k+1));break}}function it(){n(4,h=!0),w=!1,p=!1,be.set(!1)}function ot(f){const k=f.currentTarget;if(!k)return;const y=k.querySelector("textarea"),L=k.querySelector("span");if(!y||!L)return;const V=ae(1.25),S=ae(10);if(L.textContent==="더 보기"){const re=y.scrollHeight<S?y.scrollHeight:S;y.style.height=`${re}px`,L.textContent="접기"}else y.style.height=`${V}px`,L.textContent="더 보기"}function Ee(){O&&n(7,g={width:O.clientWidth,height:O.clientHeight})}function ft(){var y;const f=Number(t.url.searchParams.get("mediaIdx")||0),k=((y=l[r].media)==null?void 0:y.length)||0;f&&f<k?n(0,l[r]={...l[r],mediaIdx:f},l):n(0,l[r]={...l[r],mediaIdx:0},l),n(0,l=[...l]),W()}function ct(){document.addEventListener("touchstart",fe,{passive:!1}),document.addEventListener("touchmove",ce,{passive:!1}),document.addEventListener("touchend",ue),document.addEventListener("mousedown",fe,{passive:!1}),document.addEventListener("wheel",ke,{passive:!1}),document.addEventListener("keydown",Ie)}function ut(){document.removeEventListener("touchstart",fe),document.removeEventListener("touchmove",ce),document.removeEventListener("touchend",ue),document.removeEventListener("mousedown",fe),document.removeEventListener("wheel",ke),document.removeEventListener("keydown",Ie)}Vt.on("blockSwipeInViewer",f=>I=f),It(()=>{Ee();const f=new ResizeObserver(()=>Ee());return O&&f.observe(O),ct(),ft(),()=>{f.disconnect()}}),Et(()=>{ut()});function dt(f){Ct.call(this,s,f)}function ht(f,k){f[k].text=this.value,n(0,l)}function mt(f){Mt[f?"unshift":"push"](()=>{O=f,n(8,O)})}return s.$$set=f=>{"posts"in f&&n(0,l=f.posts),"index"in f&&n(1,r=f.index),"type"in f&&n(13,a=f.type),"isEdit"in f&&n(2,d=f.isEdit),"dontMoveVertically"in f&&n(14,i=f.dontMoveVertically),"keyboardY"in f&&n(3,u=f.keyboardY)},s.$$.update=()=>{s.$$.dirty[0]&114691&&!i&&r>=l.length-ol&&!o&&!c&&lt()},[l,r,d,u,h,m,_,g,O,se,tt,it,ot,a,i,o,c,dt,ht,mt]}class Yl extends pe{constructor(e){super(),ge(this,e,ul,al,_e,{posts:0,index:1,type:13,isEdit:2,dontMoveVertically:14,keyboardY:3},null,[-1,-1])}}export{Yl as V};
