import{s as De,e as I,c as E,b as V,f as p,q as d,i as $,F as ae,k as Ye,o as Me,G as Pe,l as Le,x as ce,a as C,t as ue,g as O,d as fe,H as T,I as Z,h as _,J as de,r as K,K as We,j as he,w as He,v as me}from"./scheduler.BjRrIjTN.js";import{S as xe,i as Ae,t as q,g as Se,f as ze,b as U,c as _e,a as pe,m as ge,d as ve}from"./index.BlBwh9YZ.js";import{e as Q}from"./each.CPxOT6Eo.js";import{g as Ce}from"./entry.BV8Inj_p.js";import{b as le}from"./store.gkSKwQRQ.js";import{g as Oe,s as Te}from"./searchParams.gTbWK1yz.js";import{W as qe}from"./WaterdropImage.DPUsLIAq.js";import{C as Ne}from"./CircleImage._Vs6vOE9.js";import{e as Re}from"./units.BMbtY17E.js";import{p as Xe}from"./stores.CoQzwfwp.js";/* empty css                                             */function we(t,i,s){const e=t.slice();return e[30]=i[s],e[31]=i,e[32]=s,e}function be(t,i,s){const e=t.slice();return e[33]=i[s],e[35]=s,e}function ye(t,i,s){const e=t.slice();return e[33]=i[s],e}function ke(t){let i,s,e,l,o,r,u,n,z,j,S,ee,N,P=t[30].display_name+"",B,te,y,k,H,v,x=(t[30].place_name||"")+"",R,X,se,F,D,Y,J,L=Q(t[30].media),m=[];for(let c=0;c<L.length;c+=1)m[c]=Ie(ye(t,L,c));let g=t[30].media.length>=2&&Ee(t);function ie(){t[11].call(n,t[31],t[32])}S=new Ne({props:{src:t[30].profile_image_url,width:"2rem",strokeColor:"white",strokeWidth:"13"}});function a(){return t[12](t[30])}k=new qe({props:{src:`https://picsum.photos/50/50/?r=${t[30].place_idx}`,width:"2rem",strokeColor:"white",strokeWidth:"13"}});function h(){return t[13](t[30])}return{c(){i=I("div"),s=I("div"),e=I("div");for(let c=0;c<m.length;c+=1)m[c].c();o=C(),g&&g.c(),r=C(),u=I("div"),n=I("textarea"),z=C(),j=I("div"),_e(S.$$.fragment),ee=C(),N=I("div"),B=ue(P),te=C(),y=I("div"),_e(k.$$.fragment),H=C(),v=I("div"),R=ue(x),se=C(),this.h()},l(c){i=E(c,"DIV",{class:!0});var f=V(i);s=E(f,"DIV",{class:!0});var w=V(s);e=E(w,"DIV",{class:!0});var A=V(e);for(let ne=0;ne<m.length;ne+=1)m[ne].l(A);A.forEach(p),o=O(w),g&&g.l(w),w.forEach(p),r=O(f),u=E(f,"DIV",{class:!0});var M=V(u);n=E(M,"TEXTAREA",{class:!0,placeholder:!0}),V(n).forEach(p),z=O(M),j=E(M,"DIV",{class:!0});var W=V(j);pe(S.$$.fragment,W),ee=O(W),N=E(W,"DIV",{});var b=V(N);B=fe(b,P),b.forEach(p),W.forEach(p),te=O(M),y=E(M,"DIV",{class:!0});var G=V(y);pe(k.$$.fragment,G),H=O(G),v=E(G,"DIV",{});var oe=V(v);R=fe(oe,x),oe.forEach(p),G.forEach(p),M.forEach(p),se=O(f),f.forEach(p),this.h()},h(){var c,f;d(e,"class",l=T(`carousel-track transition-transform ${t[3]?"duration-0":""}`)+" svelte-jyziao"),Z(e,"transform",`translateX(${-(((c=t[6])==null?void 0:c.width)??document.body.clientWidth)*t[30].mediaIdx+t[5]}px)`),d(s,"class","carousel-container svelte-jyziao"),d(n,"class","w-full h-auto overflow-scroll py-0 px-1 mb-3 outline-0 focus:outline-none focus:outline-0 focus:ring-0 border-none bg-transparent text-sm text-shadow placeholder:text-white/75 placeholder:text-base box-content  svelte-jyziao"),n.readOnly=t[7]!=="post"&&t[7]!=="patch",d(n,"placeholder",t[7]==="post"||t[7]==="patch"?"✎ 텍스트 입력하기":""),d(j,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-jyziao"),d(y,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-jyziao"),d(u,"class",X=T(`fixed bottom-0 w-full px-4 text-white text-md flex flex-col items-start gap-2 z-40 ${t[1]?"":"pb-24"} transition-transform`)+" svelte-jyziao"),Z(u,"transform",`translateY(${t[1]}px)`),d(i,"class",F=T(`w-screen h-screen gradient-overlay absolute content-center transition-transform ${t[3]?"duration-0":""}`)+" svelte-jyziao"),Z(i,"top",`${t[32]*100}%`),Z(i,"transform",`translateY(${-(((f=t[6])==null?void 0:f.height)??document.body.clientHeight)*t[2]+t[4]}px)`)},m(c,f){$(c,i,f),_(i,s),_(s,e);for(let w=0;w<m.length;w+=1)m[w]&&m[w].m(e,null);_(s,o),g&&g.m(s,null),_(i,r),_(i,u),_(u,n),de(n,t[30].text),_(u,z),_(u,j),ge(S,j,null),_(j,ee),_(j,N),_(N,B),_(u,te),_(u,y),ge(k,y,null),_(y,H),_(y,v),_(v,R),_(i,se),D=!0,Y||(J=[K(e,"transitionend",t[8],{once:!0}),K(n,"input",ie),K(n,"input",re),K(j,"click",a),K(y,"click",h),K(i,"transitionend",function(){We(t[32]===t[2]?t[8]:void 0)&&(t[32]===t[2]?t[8]:void 0).apply(this,arguments)})],Y=!0)},p(c,f){var M,W;if(t=c,f[0]&1){L=Q(t[30].media);let b;for(b=0;b<L.length;b+=1){const G=ye(t,L,b);m[b]?m[b].p(G,f):(m[b]=Ie(G),m[b].c(),m[b].m(e,null))}for(;b<m.length;b+=1)m[b].d(1);m.length=L.length}(!D||f[0]&8&&l!==(l=T(`carousel-track transition-transform ${t[3]?"duration-0":""}`)+" svelte-jyziao"))&&d(e,"class",l),f[0]&97&&Z(e,"transform",`translateX(${-(((M=t[6])==null?void 0:M.width)??document.body.clientWidth)*t[30].mediaIdx+t[5]}px)`),t[30].media.length>=2?g?g.p(t,f):(g=Ee(t),g.c(),g.m(s,null)):g&&(g.d(1),g=null),f[0]&1&&de(n,t[30].text);const w={};f[0]&1&&(w.src=t[30].profile_image_url),S.$set(w),(!D||f[0]&1)&&P!==(P=t[30].display_name+"")&&he(B,P);const A={};f[0]&1&&(A.src=`https://picsum.photos/50/50/?r=${t[30].place_idx}`),k.$set(A),(!D||f[0]&1)&&x!==(x=(t[30].place_name||"")+"")&&he(R,x),(!D||f[0]&2&&X!==(X=T(`fixed bottom-0 w-full px-4 text-white text-md flex flex-col items-start gap-2 z-40 ${t[1]?"":"pb-24"} transition-transform`)+" svelte-jyziao"))&&d(u,"class",X),f[0]&2&&Z(u,"transform",`translateY(${t[1]}px)`),(!D||f[0]&8&&F!==(F=T(`w-screen h-screen gradient-overlay absolute content-center transition-transform ${t[3]?"duration-0":""}`)+" svelte-jyziao"))&&d(i,"class",F),f[0]&84&&Z(i,"transform",`translateY(${-(((W=t[6])==null?void 0:W.height)??document.body.clientHeight)*t[2]+t[4]}px)`)},i(c){D||(q(S.$$.fragment,c),q(k.$$.fragment,c),D=!0)},o(c){U(S.$$.fragment,c),U(k.$$.fragment,c),D=!1},d(c){c&&p(i),ae(m,c),g&&g.d(),ve(S),ve(k),Y=!1,He(J)}}}function Ie(t){let i,s,e,l,o;return{c(){i=I("div"),s=I("img"),o=C(),this.h()},l(r){i=E(r,"DIV",{class:!0});var u=V(i);s=E(u,"IMG",{src:!0,alt:!0,class:!0}),o=O(u),u.forEach(p),this.h()},h(){me(s.src,e=t[33])||d(s,"src",e),d(s,"alt",l=t[30].place_name),d(s,"class","w-screen h-screen object-contain"),d(i,"class","carousel-slide svelte-jyziao")},m(r,u){$(r,i,u),_(i,s),_(i,o)},p(r,u){u[0]&1&&!me(s.src,e=r[33])&&d(s,"src",e),u[0]&1&&l!==(l=r[30].place_name)&&d(s,"alt",l)},d(r){r&&p(i)}}}function Ee(t){let i,s=Q(t[30].media),e=[];for(let l=0;l<s.length;l+=1)e[l]=je(be(t,s,l));return{c(){i=I("div");for(let l=0;l<e.length;l+=1)e[l].c();this.h()},l(l){i=E(l,"DIV",{class:!0});var o=V(i);for(let r=0;r<e.length;r+=1)e[r].l(o);o.forEach(p),this.h()},h(){d(i,"class","carousel-nav svelte-jyziao")},m(l,o){$(l,i,o);for(let r=0;r<e.length;r+=1)e[r]&&e[r].m(i,null)},p(l,o){if(o[0]&5){s=Q(l[30].media);let r;for(r=0;r<s.length;r+=1){const u=be(l,s,r);e[r]?e[r].p(u,o):(e[r]=je(u),e[r].c(),e[r].m(i,null))}for(;r<e.length;r+=1)e[r].d(1);e.length=s.length}},d(l){l&&p(i),ae(e,l)}}}function je(t){let i,s;return{c(){i=I("span"),this.h()},l(e){i=E(e,"SPAN",{class:!0}),V(i).forEach(p),this.h()},h(){d(i,"class",s=T(`carousel-dot ${t[0][t[2]].mediaIdx===t[35]?"active":""}`)+" svelte-jyziao")},m(e,l){$(e,i,l)},p(e,l){l[0]&5&&s!==(s=T(`carousel-dot ${e[0][e[2]].mediaIdx===e[35]?"active":""}`)+" svelte-jyziao")&&d(i,"class",s)},d(e){e&&p(i)}}}function Ve(t){let i,s,e=t[2]-t[32]<=1&&t[32]-t[2]<=1&&ke(t);return{c(){e&&e.c(),i=ce()},l(l){e&&e.l(l),i=ce()},m(l,o){e&&e.m(l,o),$(l,i,o),s=!0},p(l,o){l[2]-l[32]<=1&&l[32]-l[2]<=1?e?(e.p(l,o),o[0]&4&&q(e,1)):(e=ke(l),e.c(),q(e,1),e.m(i.parentNode,i)):e&&(Se(),U(e,1,1,()=>{e=null}),ze())},i(l){s||(q(e),s=!0)},o(l){U(e),s=!1},d(l){l&&p(i),e&&e.d(l)}}}function Ge(t){let i,s,e=Q(t[0]),l=[];for(let r=0;r<e.length;r+=1)l[r]=Ve(we(t,e,r));const o=r=>U(l[r],1,1,()=>{l[r]=null});return{c(){i=I("div");for(let r=0;r<l.length;r+=1)l[r].c();this.h()},l(r){i=E(r,"DIV",{class:!0});var u=V(i);for(let n=0;n<l.length;n+=1)l[n].l(u);u.forEach(p),this.h()},h(){d(i,"class","bg-black w-screen h-screen")},m(r,u){$(r,i,u);for(let n=0;n<l.length;n+=1)l[n]&&l[n].m(i,null);s=!0},p(r,u){if(u[0]&511){e=Q(r[0]);let n;for(n=0;n<e.length;n+=1){const z=we(r,e,n);l[n]?(l[n].p(z,u),q(l[n],1)):(l[n]=Ve(z),l[n].c(),q(l[n],1),l[n].m(i,null))}for(Se(),n=e.length;n<l.length;n+=1)o(n);ze()}},i(r){if(!s){for(let u=0;u<e.length;u+=1)q(l[u]);s=!0}},o(r){l=l.filter(Boolean);for(let u=0;u<l.length;u+=1)U(l[u]);s=!1},d(r){r&&p(i),ae(l,r)}}}function re(t){const i=t.target;i.style.height="16px";let s=i.scrollHeight;s>96&&(s=96),i.style.height=`${s}px`}function Ze(t,i,s){let e;Ye(t,Xe,a=>s(10,e=a));let l=e.url.searchParams.get("type"),{posts:o=[]}=i,{dontMoveVetically:r=!1}=i,{keyboardY:u=0}=i,n=0,z=!0,j=0;async function S(){Te({pidx:`${n}`,midx:`${o[n].mediaIdx}`},{replaceState:!0,invalidateAll:!1})}function ee(a,h){if(n===0&&a>0){H=h;return}const c=Y.height;s(4,j=a>c?c:a<-c?-c:a)}function N(a){document.querySelectorAll("textarea").forEach(f=>{re({target:f})});let h=a.changedTouches[0].clientY-H;s(3,z=!1);const c=Y.height;h>c/2&&n!==0?(s(2,n-=1),S()):-h>c/2&&n!==o.length-1&&(s(2,n+=1),S(),o.length-2),s(4,j=0)}let P=0;function B(a){const h=Y.width;a=a>h?h:a<-h?-h:a,a=o[n].mediaIdx===0&&a>0||o[n].mediaIdx===o[n].media.length-1&&a<0?0:a,s(5,P=a)}function te(a){const h=Y.width;s(3,z=!1);let c=a.changedTouches[0].clientX-k;c>h/2&&o[n].mediaIdx!==0?s(0,o[n].mediaIdx-=1,o):-c>h/2&&o[n].mediaIdx!==o[n].media.length-1&&s(0,o[n].mediaIdx+=1,o),s(5,P=0)}let y=!1;Re.on("blockSwipeInViewer",a=>y=a);let k=-1,H=-1,v;function x(a){y||(v=void 0,le.set(!0),k=a.touches[0].clientX,H=a.touches[0].clientY)}function R(a){if(y)return;let c=a.touches[0].clientX-k;const f=a.touches[0].clientY;let w=f-H;if(v===void 0&&Math.abs(w)-Math.abs(c)>=0&&(v="post"),!r&&v==="post")ee(w,f);else{if(v===void 0){const A=o[n].mediaIdx===0&&c>0,M=o[n].mediaIdx===o[n].media.length-1&&c<0,W=k<20||k>Y.width-20;A||M||W?v="else":v="media"}if(v==="else")return le.set(!1);B(c)}}function X(a){if(!y)return v==="post"?N(a):v==="media"?te(a):le.set(!1)}function se(){document.addEventListener("touchstart",x),document.addEventListener("touchmove",R),document.addEventListener("touchend",X)}function F(){document.removeEventListener("touchstart",x),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",X)}function D(){s(3,z=!0),le.set(!1)}let Y;function J(){s(6,Y={width:document.body.clientWidth,height:document.body.clientHeight})}function L(){const a=e.url.searchParams.get("pidx"),h=e.url.searchParams.get("midx"),c=Number(a);a&&c!==n&&o[c]?s(2,n=c):s(2,n=0);const f=Number(h);h&&f!==o[n].mediaIdx&&o[n].media[f]?s(0,o[n].mediaIdx=f,o):s(0,o[n].mediaIdx=0,o),S()}Me(async()=>{J(),window.addEventListener("resize",J),se(),L(),await Pe(),document.querySelectorAll("textarea").forEach(a=>{re({target:a})})}),Le(()=>{window.removeEventListener("resize",J),F()});function m(a,h){a[h].text=this.value,s(0,o)}const g=a=>{a.user_idx&&Oe(`/users/${a.user_idx}`)},ie=a=>{a.place_idx&&Ce(`/places/${a.place_idx}`)};return t.$$set=a=>{"posts"in a&&s(0,o=a.posts),"dontMoveVetically"in a&&s(9,r=a.dontMoveVetically),"keyboardY"in a&&s(1,u=a.keyboardY)},t.$$.update=()=>{t.$$.dirty[0]&1024&&e.url.searchParams.get("pidx")==0&&e.url.searchParams.get("midx")==0&&L()},[o,u,n,z,j,P,Y,l,D,r,e,m,g,ie]}class it extends xe{constructor(i){super(),Ae(this,i,Ze,Ge,De,{posts:0,dontMoveVetically:9,keyboardY:1},null,[-1,-1])}}export{it as V};
