import{s as fe,D as ae,i as N,f as g,e as y,a as q,t as be,c as T,b as R,g as j,d as ve,v as h,h as w,A as H,j as Ae,z as se,I as Ze,C as ee,n as $,q as Ce,r as Ie,E as Se,F as we,ae as We,B as Ge,K as Xe,w as Ee,x as Oe,y as qt,T as xl,M as jt,Q as it,k as rt,U as yl,G as Tl,J as Dl}from"./scheduler.CIbz-4tf.js";import{S as ue,i as ce,t as I,g as te,a as V,e as le,c as Z,d as K,m as W,f as G,b as Re}from"./index.gvaMc9LH.js";import{e as pe,u as Je,f as Ml,o as Ut}from"./each.Cdd7o6io.js";import{e as _e,A as Le,l as at,I as Ue}from"./store.Db8T8Crr.js";import{g as Ke}from"./entry.DrL1VMu_.js";import{p as Vl}from"./stores.D8B3IsND.js";import{g as He,u as Bl}from"./searchParams.bWfPxLcr.js";/* empty css                                                     *//* empty css                                                  */import{f as Pl,u as Ol}from"./follow.DfKPA7ky.js";import{a as Me,b as Xt,g as ze,i as ot}from"./sign.KpCItXCb.js";import{C as Rl}from"./CircleImage.CZpdYjea.js";import{g as ft}from"./color.C_Jm4JAr.js";import{s as ut}from"./s32cloudfront.B_T3Ab_x.js";import{r as xe}from"./units.BJZU6p1c.js";import"./ActionSheet.svelte_svelte_type_style_lang.DBhSfJvS.js";import{i as Ll}from"./device.D_cxPtc6.js";import"./index.D9DW_BvC.js";import{a as Sl}from"./NavigationBar.D2cxJtzZ.js";import{C as zt}from"./Chip.Bhn0E_B1.js";import{B as Al}from"./BottomNavigationPadder.C4NGb20C.js";import{C as Nl,I as Fl,a as ql}from"./ChipInstagram.CIMm6hR7.js";import{l as jl}from"./longPress.C9F0mLoM.js";import{I as Ul}from"./IconMore.BQ1nArCe.js";import{A as Yt,o as Xl,a as zl}from"./ActionSheet.BzgwZ27r.js";import{M as Yl}from"./Modal.BEFi8uQC.js";import{f as Hl,c as Zl,a as Kl}from"./ActionSheetReport.svelte_svelte_type_style_lang.Bi0biItC.js";import{F as Wl}from"./Figure.zRzb16HV.js";import{w as Gl,I as Jl}from"./utils.DhASpgeh.js";function ct(n){let e,t,l,s,o,r,i=n[0].unique_name+"",a,f,c,p=String(n[0].user_idx)!==String(Me()),b,E,O;const C=[$l,Ql],m=[];function d(k,P){return k[0].profile_image_url?0:1}t=d(n),l=m[t]=C[t](n);let _=p&&dt(n);return{c(){e=y("div"),l.c(),s=q(),o=y("div"),r=y("div"),a=be(i),f=q(),c=y("div"),_&&_.c(),this.h()},l(k){e=T(k,"DIV",{class:!0});var P=R(e);l.l(P),s=j(P),o=T(P,"DIV",{class:!0});var x=R(o);r=T(x,"DIV",{class:!0});var A=R(r);a=ve(A,i),A.forEach(g),f=j(x),c=T(x,"DIV",{class:!0});var L=R(c);_&&_.l(L),L.forEach(g),x.forEach(g),P.forEach(g),this.h()},h(){h(r,"class","text-sm text-white"),h(c,"class","flex gap-1 items-center"),h(o,"class","flex gap-1 items-center"),h(e,"class","flex gap-[0.625rem] justify-center items-center")},m(k,P){N(k,e,P),m[t].m(e,null),w(e,s),w(e,o),w(o,r),w(r,a),w(o,f),w(o,c),_&&_.m(c,null),b=!0,E||(O=H(r,"click",n[7]),E=!0)},p(k,P){let x=t;t=d(k),t===x?m[t].p(k,P):(te(),V(m[x],1,1,()=>{m[x]=null}),le(),l=m[t],l?l.p(k,P):(l=m[t]=C[t](k),l.c()),I(l,1),l.m(e,s)),(!b||P&1)&&i!==(i=k[0].unique_name+"")&&Ae(a,i),P&1&&(p=String(k[0].user_idx)!==String(Me())),p?_?_.p(k,P):(_=dt(k),_.c(),_.m(c,null)):_&&(_.d(1),_=null)},i(k){b||(I(l),b=!0)},o(k){V(l),b=!1},d(k){k&&g(e),m[t].d(),_&&_.d(),E=!1,O()}}}function Ql(n){var i;let e,t,l=(((i=n[0].unique_name)==null?void 0:i.at(0))??"u")+"",s,o,r;return{c(){e=y("div"),t=y("span"),s=be(l),this.h()},l(a){e=T(a,"DIV",{class:!0,style:!0});var f=R(e);t=T(f,"SPAN",{class:!0});var c=R(t);s=ve(c,l),c.forEach(g),f.forEach(g),this.h()},h(){h(t,"class","text-base font-semibold text-black"),h(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),ee(e,"background-color",ft(n[0].unique_name))},m(a,f){N(a,e,f),w(e,t),w(t,s),o||(r=H(e,"click",n[6]),o=!0)},p(a,f){var c;f&1&&l!==(l=(((c=a[0].unique_name)==null?void 0:c.at(0))??"u")+"")&&Ae(s,l),f&1&&ee(e,"background-color",ft(a[0].unique_name))},i:$,o:$,d(a){a&&g(e),o=!1,r()}}}function $l(n){let e,t;return e=new Rl({props:{src:ut(n[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",n[5]),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},p(l,s){const o={};s&1&&(o.src=ut(l[0].profile_image_url,500)),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function dt(n){let e,t="•",l,s,o=n[0].is_following?"팔로잉":"팔로우",r,i,a,f;return{c(){e=y("div"),e.textContent=t,l=q(),s=y("div"),r=be(o),this.h()},l(c){e=T(c,"DIV",{class:!0,"data-svelte-h":!0}),se(e)!=="svelte-168vif2"&&(e.textContent=t),l=j(c),s=T(c,"DIV",{class:!0});var p=R(s);r=ve(p,o),p.forEach(g),this.h()},h(){h(e,"class","text-xs text-white/60"),h(s,"class",i=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(c,p){N(c,e,p),N(c,l,p),N(c,s,p),w(s,r),a||(f=H(s,"click",function(){Ze(n[0].is_following?n[2]:n[1])&&(n[0].is_following?n[2]:n[1]).apply(this,arguments)}),a=!0)},p(c,p){n=c,p&1&&o!==(o=n[0].is_following?"팔로잉":"팔로우")&&Ae(r,o),p&1&&i!==(i=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&h(s,"class",i)},d(c){c&&(g(e),g(l),g(s)),a=!1,f()}}}function en(n){let e,t,l=n[0].idx&&n[0].unique_name&&ct(n);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,o){l&&l.m(s,o),N(s,e,o),t=!0},p(s,[o]){s[0].idx&&s[0].unique_name?l?(l.p(s,o),o&1&&I(l,1)):(l=ct(s),l.c(),I(l,1),l.m(e.parentNode,e)):l&&(te(),V(l,1,1,()=>{l=null}),le())},i(s){t||(I(l),t=!0)},o(s){V(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function tn(n,e,t){let{post:l}=e,{allowFollow:s=!0}=e,{whenCancelFollow:o=()=>{}}=e,r=!1;async function i(){if(!s)return o();r||(r=!0,await Pl({targetIdx:l.user_idx,subjectIdx:Me()}),t(0,l.is_following=!0,l),r=!1)}async function a(){if(!s)return o();r||(r=!0,await Ol({targetIdx:l.user_idx,subjectIdx:Me()}),t(0,l.is_following=!1,l),r=!1)}const f=()=>{He(`/users/${l.user_idx}`)},c=()=>{He(`/users/${l.user_idx}`)},p=()=>{He(`/users/${l.user_idx}`)};return n.$$set=b=>{"post"in b&&t(0,l=b.post),"allowFollow"in b&&t(3,s=b.allowFollow),"whenCancelFollow"in b&&t(4,o=b.whenCancelFollow)},[l,i,a,s,o,f,c,p]}class ln extends ue{constructor(e){super(),ce(this,e,tn,en,fe,{post:0,allowFollow:3,whenCancelFollow:4})}}function nn(n){let e,t,l,s;return{c(){e=Ce("svg"),t=Ce("path"),l=Ce("path"),this.h()},l(o){e=Ie(o,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var r=R(e);t=Ie(r,"path",{d:!0,fill:!0}),R(t).forEach(g),l=Ie(r,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),R(l).forEach(g),r.forEach(g),this.h()},h(){h(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),h(t,"fill",n[0]),h(l,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),h(l,"stroke",n[1]),h(l,"stroke-width","2"),h(l,"stroke-linejoin","round"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width",n[2]),h(e,"height",n[2]),h(e,"viewBox",s="0 0 "+n[2]+" "+n[2]),h(e,"fill","none")},m(o,r){N(o,e,r),w(e,t),w(e,l)},p(o,[r]){r&1&&h(t,"fill",o[0]),r&2&&h(l,"stroke",o[1]),r&4&&h(e,"width",o[2]),r&4&&h(e,"height",o[2]),r&4&&s!==(s="0 0 "+o[2]+" "+o[2])&&h(e,"viewBox",s)},i:$,o:$,d(o){o&&g(e)}}}function sn(n,e,t){let l,{fill:s="#FF4F1E"}=e,{stroke:o="#FF4F1E"}=e,{length:r=1.5}=e;return n.$$set=i=>{"fill"in i&&t(0,s=i.fill),"stroke"in i&&t(1,o=i.stroke),"length"in i&&t(3,r=i.length)},n.$$.update=()=>{n.$$.dirty&8&&t(2,l=xe(r))},[s,o,l,r]}class rn extends ue{constructor(e){super(),ce(this,e,sn,nn,fe,{fill:0,stroke:1,length:3})}}function Ye(n){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const s=o=>o.stopPropagation();return n.addEventListener(l,s),{event:l,handler:s}});return{destroy(){t.forEach(({event:l,handler:s})=>{n.removeEventListener(l,s)})}}}function ht(n){let e,t;return e=new zt({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Sl,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:n[0].name}}),e.$on("click",n[1]),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},p(l,s){const o={};s&1&&(o.value=l[0].name),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function an(n){let e,t,l=n[0].idx&&ht(n);return{c(){l&&l.c(),e=ae()},l(s){l&&l.l(s),e=ae()},m(s,o){l&&l.m(s,o),N(s,e,o),t=!0},p(s,[o]){s[0].idx?l?(l.p(s,o),o&1&&I(l,1)):(l=ht(s),l.c(),I(l,1),l.m(e.parentNode,e)):l&&(te(),V(l,1,1,()=>{l=null}),le())},i(s){t||(I(l),t=!0)},o(s){V(l),t=!1},d(s){s&&g(e),l&&l.d(s)}}}function on(n,e,t){let{place:l}=e;const s=async()=>{await Ke(`/places/${l.idx}`)};return n.$$set=o=>{"place"in o&&t(0,l=o.place)},[l,s]}class fn extends ue{constructor(e){super(),ce(this,e,on,an,fe,{place:0})}}function un(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=R(e);t=Ie(s,"path",{d:!0}),R(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",n[1]),h(e,"height",n[1]),h(e,"fill",n[0])},m(l,s){N(l,e,s),w(e,t)},p(l,[s]){s&2&&h(e,"width",l[1]),s&2&&h(e,"height",l[1]),s&1&&h(e,"fill",l[0])},i:$,o:$,d(l){l&&g(e)}}}function cn(n,e,t){let l,{fill:s="#5f6368"}=e,{length:o="1.75"}=e,{alt:r="Edit"}=e;return n.$$set=i=>{"fill"in i&&t(0,s=i.fill),"length"in i&&t(2,o=i.length),"alt"in i&&t(3,r=i.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=xe(o))},[s,l,o,r]}class dn extends ue{constructor(e){super(),ce(this,e,cn,un,fe,{fill:0,length:2,alt:3})}}function hn(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=R(e);t=Ie(s,"path",{d:!0}),R(t).forEach(g),s.forEach(g),this.h()},h(){h(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",n[1]),h(e,"height",n[1]),h(e,"fill",n[0])},m(l,s){N(l,e,s),w(e,t)},p(l,[s]){s&2&&h(e,"width",l[1]),s&2&&h(e,"height",l[1]),s&1&&h(e,"fill",l[0])},i:$,o:$,d(l){l&&g(e)}}}function mn(n,e,t){let l,{fill:s="#5f6368"}=e,{length:o="1.75"}=e,{alt:r="Delete"}=e;return n.$$set=i=>{"fill"in i&&t(0,s=i.fill),"length"in i&&t(2,o=i.length),"alt"in i&&t(3,r=i.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=xe(o))},[s,l,o,r]}class pn extends ue{constructor(e){super(),ce(this,e,mn,hn,fe,{fill:0,length:2,alt:3})}}function gn(n){let e,t=(n[0].text||"")+"",l,s,o;return{c(){e=y("p"),l=be(t),this.h()},l(r){e=T(r,"P",{class:!0,style:!0});var i=R(e);l=ve(i,t),i.forEach(g),this.h()},h(){h(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),h(e,"style",`
      overflow: hidden;
      height: ${n[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(r,i){N(r,e,i),w(e,l),s||(o=[Se(Ye.call(null,e)),H(e,"click",n[2])],s=!0)},p(r,[i]){i&1&&t!==(t=(r[0].text||"")+"")&&Ae(l,t)},i:$,o:$,d(r){r&&g(e),s=!1,we(o)}}}function _n(n,e,t){const l=We();let{post:s}=e;const o=xe(1),r=xe(6);function i(a){const f=a.currentTarget;if(f)if(f.style.height===`${o}px`||!f.style.height){if(f.scrollHeight>o){const c=f.scrollHeight<r?f.scrollHeight:r;f.style.height=`${c}px`,f.style.overflow="scroll",f.style.display="block",f.style.webkitLineClamp="unset",l("textExpanded",{expanded:!0})}}else f.style.height=`${o}px`,f.style.overflow="hidden",f.style.display="-webkit-box",f.style.webkitLineClamp="1",l("textExpanded",{expanded:!1})}return Ge(()=>{l("textExpanded",{expanded:!1})}),n.$$set=a=>{"post"in a&&t(0,s=a.post)},[s,o,i]}class bn extends ue{constructor(e){super(),ce(this,e,_n,gn,fe,{post:0})}}function vn(n){let e;return{c(){e=y("div"),this.h()},l(t){e=T(t,"DIV",{class:!0,style:!0}),R(e).forEach(g),this.h()},h(){h(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),ee(e,"opacity","0.6"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,l){N(t,e,l)},d(t){t&&g(e)}}}function wn(n){let e;return{c(){e=y("div"),this.h()},l(t){e=T(t,"DIV",{class:!0,style:!0}),R(e).forEach(g),this.h()},h(){h(e,"class","fixed inset-0 pointer-events-none z-30"),ee(e,"opacity","0.7"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,l){N(t,e,l)},d(t){t&&g(e)}}}function kn(n){let e;function t(o,r){return o[0]?wn:vn}let l=t(n),s=l(n);return{c(){s.c(),e=ae()},l(o){s.l(o),e=ae()},m(o,r){s.m(o,r),N(o,e,r)},p(o,[r]){l!==(l=t(o))&&(s.d(1),s=l(o),s&&(s.c(),s.m(e.parentNode,e)))},i:$,o:$,d(o){o&&g(e),s.d(o)}}}function Cn(n,e,t){let{isTextExpanded:l=!1}=e;return n.$$set=s=>{"isTextExpanded"in s&&t(0,l=s.isTextExpanded)},[l]}class In extends ue{constructor(e){super(),ce(this,e,Cn,kn,fe,{isTextExpanded:0})}}function mt(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function pt(n,e){let t,l,s,o,r,i=$;return{key:n,first:null,c(){t=y("span"),l=y("span"),o=q(),this.h()},l(a){t=T(a,"SPAN",{class:!0,style:!0});var f=R(t);l=T(f,"SPAN",{class:!0,style:!0}),R(l).forEach(g),o=j(f),f.forEach(g),this.h()},h(){h(l,"class",s=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),ee(l,"transform","scale("+e[4](e[7])+")"),ee(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),h(t,"class","flex items-center justify-center"),ee(t,"width","0.375rem"),ee(t,"height","0.375rem"),this.first=t},m(a,f){N(a,t,f),w(t,l),w(t,o)},p(a,f){e=a,f&13&&s!==(s=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&h(l,"class",s),f&8&&ee(l,"transform","scale("+e[4](e[7])+")"),f&13&&ee(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){r=t.getBoundingClientRect()},f(){Hl(t),i()},a(){i(),i=Zl(t,r,Kl,{})},d(a){a&&g(t)}}}function En(n){let e,t=[],l=new Map,s,o=pe(n[3]);const r=i=>i[5];for(let i=0;i<o.length;i+=1){let a=mt(n,o,i),f=r(a);l.set(f,t[i]=pt(f,a))}return{c(){e=y("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=T(i,"DIV",{class:!0});var a=R(e);for(let f=0;f<t.length;f+=1)t[f].l(a);a.forEach(g),this.h()},h(){h(e,"class",s=Xe(`
    ${n[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(i,a){N(i,e,a);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(i,[a]){if(a&29){o=pe(i[3]);for(let f=0;f<t.length;f+=1)t[f].r();t=Je(t,a,r,1,i,o,l,e,Ml,pt,null,mt);for(let f=0;f<t.length;f+=1)t[f].a()}a&2&&s!==(s=Xe(`
    ${i[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&h(e,"class",s)},i:$,o:$,d(i){i&&g(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}const De=7;function xn(n,e,t){let{post:l}=e,{fixed:s=!0}=e,o=[],r=0;function i(a){const f=l.mediaIdx-r,c=o.length;if(c<=1)return 1;const p=Math.max(f,c-1-f);return p===0?1:1-Math.abs(a-f)/p*.5}return n.$$set=a=>{"post"in a&&t(0,l=a.post),"fixed"in a&&t(1,s=a.fixed)},n.$$.update=()=>{n.$$.dirty&5&&(l.media.length>De?(l.mediaIdx<=Math.floor(De/2)?t(2,r=0):l.mediaIdx>=l.media.length-Math.ceil(De/2)?t(2,r=l.media.length-De):t(2,r=l.mediaIdx-Math.floor(De/2)),t(3,o=l.media.slice(r,r+De))):(t(2,r=0),t(3,o=l.media)))},[l,s,r,o,i]}class Ht extends ue{constructor(e){super(),ce(this,e,xn,En,fe,{post:0,fixed:1})}}function gt(n,e,t){const l=n.slice();return l[16]=e[t].text,l[17]=e[t].value,l[18]=e[t].custom,l[20]=t,l}function _t(n){let e,t,l,s,o=n[16]+"",r,i,a,f;return{c(){e=y("label"),t=y("input"),l=q(),s=y("span"),r=be(o),i=q(),this.h()},l(c){e=T(c,"LABEL",{class:!0});var p=R(e);t=T(p,"INPUT",{type:!0,name:!0,class:!0}),l=j(p),s=T(p,"SPAN",{class:!0});var b=R(s);r=ve(b,o),b.forEach(g),i=j(p),p.forEach(g),this.h()},h(){h(t,"type","radio"),h(t,"name","report"),h(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=n[17],h(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"class","flex gap-2 py-2")},m(c,p){N(c,e,p),w(e,t),w(e,l),w(e,s),w(s,r),w(e,i),a||(f=H(t,"change",n[8]),a=!0)},p:$,d(c){c&&g(e),a=!1,f()}}}function bt(n){let e,t,l,s;return{c(){e=y("div"),t=y("textarea"),this.h()},l(o){e=T(o,"DIV",{class:!0});var r=R(e);t=T(r,"TEXTAREA",{class:!0,style:!0,placeholder:!0}),R(t).forEach(g),r.forEach(g),this.h()},h(){h(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal focus:outline-none focus:ring-0 appearance-none "),ee(t,"-webkit-tap-highlight-color","transparent"),h(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),h(e,"class","px-5 py-2.5")},m(o,r){N(o,e,r),w(e,t),n[9](t),it(t,n[3]),l||(s=H(t,"input",n[10]),l=!0)},p(o,r){r&8&&it(t,o[3])},d(o){o&&g(e),n[9](null),l=!1,s()}}}function yn(n){let e,t,l="게시물 신고 사유",s,o,r,i,a,f,c="취소",p,b,E="신고",O,C,m=pe(n[4]),d=[];for(let k=0;k<m.length;k+=1)d[k]=_t(gt(n,m,k));let _=n[1]==="etc"&&bt(n);return{c(){e=y("div"),t=y("heading"),t.textContent=l,s=q(),o=y("div");for(let k=0;k<d.length;k+=1)d[k].c();r=q(),_&&_.c(),i=q(),a=y("div"),f=y("button"),f.textContent=c,p=q(),b=y("button"),b.textContent=E,this.h()},l(k){e=T(k,"DIV",{class:!0});var P=R(e);t=T(P,"HEADING",{class:!0,"data-svelte-h":!0}),se(t)!=="svelte-z3puxq"&&(t.textContent=l),s=j(P),o=T(P,"DIV",{class:!0});var x=R(o);for(let L=0;L<d.length;L+=1)d[L].l(x);x.forEach(g),r=j(P),_&&_.l(P),i=j(P),a=T(P,"DIV",{class:!0});var A=R(a);f=T(A,"BUTTON",{class:!0,"data-svelte-h":!0}),se(f)!=="svelte-xb8aop"&&(f.textContent=c),p=j(A),b=T(A,"BUTTON",{class:!0,"data-svelte-h":!0}),se(b)!=="svelte-1fehi46"&&(b.textContent=E),A.forEach(g),P.forEach(g),this.h()},h(){h(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),h(o,"class","px-5"),h(f,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),h(b,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),h(a,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),h(e,"class","flex flex-col gap-2.5")},m(k,P){N(k,e,P),w(e,t),w(e,s),w(e,o);for(let x=0;x<d.length;x+=1)d[x]&&d[x].m(o,null);w(e,r),_&&_.m(e,null),w(e,i),w(e,a),w(a,f),w(a,p),w(a,b),O||(C=[H(f,"click",n[11]),H(b,"click",n[5]),Se(Ye.call(null,e))],O=!0)},p(k,P){if(P&18){m=pe(k[4]);let x;for(x=0;x<m.length;x+=1){const A=gt(k,m,x);d[x]?d[x].p(A,P):(d[x]=_t(A),d[x].c(),d[x].m(o,null))}for(;x<d.length;x+=1)d[x].d(1);d.length=m.length}k[1]==="etc"?_?_.p(k,P):(_=bt(k),_.c(),_.m(e,i)):_&&(_.d(1),_=null)},d(k){k&&g(e),jt(d,k),_&&_.d(),O=!1,we(C)}}}function Tn(n){let e,t,l;function s(r){n[12](r)}let o={noHandle:!0,fixed:!0,$$slots:{default:[yn]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.isOpen=n[0]),e=new Yt({props:o}),Ee.push(()=>Re(e,"isOpen",s)),{c(){Z(e.$$.fragment)},l(r){K(e.$$.fragment,r)},m(r,i){W(e,r,i),l=!0},p(r,[i]){const a={};i&2097167&&(a.$$scope={dirty:i,ctx:r}),!t&&i&1&&(t=!0,a.isOpen=r[0],Oe(()=>t=!1)),e.$set(a)},i(r){l||(I(e.$$.fragment,r),l=!0)},o(r){V(e.$$.fragment,r),l=!1},d(r){G(e,r)}}}function Dn(n,e,t){const l=We();let{isOpen:s}=e,{selectedValue:o=""}=e,{targetTable:r=""}=e,{targetIdx:i=""}=e,a=null;const f=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let c="",p=!1;function b(){xl().then(()=>{a==null||a.scrollIntoView({behavior:"smooth",block:"start"})})}qt(()=>{Xl(()=>{},b,()=>{})}),Ge(()=>{zl()});async function E(){const k=f.findIndex(P=>P.value===o);if(k===-1){alert("신고 사유를 선택해주세요.");return}if(!p){p=!0,_e.emit("loading",!0);try{const P=f[k],x=new URL(`${Le}/auth/permissions`);x.searchParams.set("targetTable",r),x.searchParams.set("targetIdx",i),x.searchParams.set("relation","reported"),x.searchParams.set("subjectTable","users"),x.searchParams.set("subjectIdx",Xt().sub),x.searchParams.set("metadata",JSON.stringify({...P,customReason:c})),t(0,s=!1),t(3,c=""),await fetch(x,{method:"PUT",headers:{Authorization:`Bearer ${ze()}`}}),l("reported")}finally{p=!1,_e.emit("loading",!1)}}}const O=k=>{t(1,o=k.target.value)};function C(k){Ee[k?"unshift":"push"](()=>{a=k,t(2,a)})}function m(){c=this.value,t(3,c)}const d=()=>{t(0,s=!1)};function _(k){s=k,t(0,s)}return n.$$set=k=>{"isOpen"in k&&t(0,s=k.isOpen),"selectedValue"in k&&t(1,o=k.selectedValue),"targetTable"in k&&t(6,r=k.targetTable),"targetIdx"in k&&t(7,i=k.targetIdx)},[s,o,a,c,f,E,r,i,O,C,m,d,_]}class Mn extends ue{constructor(e){super(),ce(this,e,Dn,Tn,fe,{isOpen:0,selectedValue:1,targetTable:6,targetIdx:7})}}function vt(n){let e,t,l,s="이 게시물을 신고해 주셔서 감사합니다.",o,r,i="신고 취소하기",a,f;return{c(){e=y("div"),t=y("div"),l=y("div"),l.textContent=s,o=q(),r=y("div"),r.textContent=i,this.h()},l(c){e=T(c,"DIV",{class:!0});var p=R(e);t=T(p,"DIV",{class:!0});var b=R(t);l=T(b,"DIV",{class:!0,"data-svelte-h":!0}),se(l)!=="svelte-179ijsk"&&(l.textContent=s),o=j(b),r=T(b,"DIV",{class:!0,"data-svelte-h":!0}),se(r)!=="svelte-1haiztv"&&(r.textContent=i),b.forEach(g),p.forEach(g),this.h()},h(){h(l,"class","text-white text-[0.9375rem] font-semibold"),h(r,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),h(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),h(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(c,p){N(c,e,p),w(e,t),w(t,l),w(t,o),w(t,r),a||(f=H(r,"click",n[1]),a=!0)},p:$,d(c){c&&g(e),a=!1,f()}}}function Vn(n){let e,t=n[0]&&vt(n);return{c(){t&&t.c(),e=ae()},l(l){t&&t.l(l),e=ae()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=vt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&g(e),t&&t.d(l)}}}function Bn(n,e,t){const l=We();let{isVisible:s=!1}=e,{targetTable:o=""}=e,{targetIdx:r=""}=e,i=!1;async function a(){if(i!==!0){i=!0,_e.emit("loading",!0);try{const f=new URL(`${Le}/auth/permissions`);f.searchParams.set("targetTable",o),f.searchParams.set("targetIdx",r),f.searchParams.set("relation","reported"),f.searchParams.set("subjectTable","users"),f.searchParams.set("subjectIdx",Xt().sub),await fetch(f,{method:"DELETE",headers:{Authorization:`Bearer ${ze()}`}}),t(0,s=!1),l("unreported")}finally{i=!1,_e.emit("loading",!1)}}}return n.$$set=f=>{"isVisible"in f&&t(0,s=f.isVisible),"targetTable"in f&&t(2,o=f.targetTable),"targetIdx"in f&&t(3,r=f.targetIdx)},[s,a,o,r]}class Pn extends ue{constructor(e){super(),ce(this,e,Bn,Vn,fe,{isVisible:0,targetTable:2,targetIdx:3})}}function wt(n,e,t){const l=n.slice();return l[81]=e[t],l[82]=e,l[83]=t,l}function kt(n,e,t){const l=n.slice();return l[84]=e[t],l}function Ct(n,e,t){const l=n.slice();return l[87]=e[t],l[89]=t,l}function It(n){let e,t,l;return{c(){e=y("div"),this.h()},l(s){e=T(s,"DIV",{class:!0}),R(e).forEach(g),this.h()},h(){h(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,o){N(s,e,o),t||(l=H(e,"contextmenu",Tl(n[25])),t=!0)},d(s){s&&g(e),t=!1,l()}}}function Et(n){let e,t,l,s=[],o=new Map,r,i,a,f,c,p,b,E=pe(n[81].media);const O=m=>m[87];for(let m=0;m<E.length;m+=1){let d=Ct(n,E,m),_=O(d);o.set(_,s[m]=xt(_,d))}let C=!n[5]&&yt(n);return{c(){e=y("section"),t=y("div"),l=y("div");for(let m=0;m<s.length;m+=1)s[m].c();i=q(),C&&C.c(),a=q(),this.h()},l(m){e=T(m,"SECTION",{class:!0,style:!0});var d=R(e);t=T(d,"DIV",{class:!0});var _=R(t);l=T(_,"DIV",{class:!0,style:!0});var k=R(l);for(let P=0;P<s.length;P+=1)s[P].l(k);k.forEach(g),_.forEach(g),i=j(d),C&&C.l(d),a=j(d),d.forEach(g),this.h()},h(){h(l,"class",r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")),ee(l,"transform","translateX("+(-n[81].mediaIdx*n[11].width+n[10])+"px)"),h(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),h(e,"class",f=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`),ee(e,"top","0"),ee(e,"transform","translateY("+((n[83]-n[1])*n[11].height+n[9])+"px)")},m(m,d){N(m,e,d),w(e,t),w(t,l);for(let _=0;_<s.length;_+=1)s[_]&&s[_].m(l,null);w(e,i),C&&C.m(e,null),w(e,a),c=!0,p||(b=[H(l,"transitionend",function(){Ze(n[81].mediaIdx===n[0][n[1]].mediaIdx?n[15]:void 0)&&(n[81].mediaIdx===n[0][n[1]].mediaIdx?n[15]:void 0).apply(this,arguments)}),H(e,"transitionend",function(){Ze(n[83]===n[1]?n[15]:void 0)&&(n[83]===n[1]?n[15]:void 0).apply(this,arguments)})],p=!0)},p(m,d){n=m,d[0]&16419&&(E=pe(n[81].media),te(),s=Je(s,d,O,1,n,E,o,l,Ut,xt,null,Ct),le()),(!c||d[0]&256&&r!==(r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")))&&h(l,"class",r),(!c||d[0]&3073)&&ee(l,"transform","translateX("+(-n[81].mediaIdx*n[11].width+n[10])+"px)"),n[5]?C&&(te(),V(C,1,1,()=>{C=null}),le()):C?(C.p(n,d),d[0]&32&&I(C,1)):(C=yt(n),C.c(),I(C,1),C.m(e,a)),(!c||d[0]&256&&f!==(f=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`))&&h(e,"class",f),(!c||d[0]&2563)&&ee(e,"transform","translateY("+((n[83]-n[1])*n[11].height+n[9])+"px)")},i(m){if(!c){for(let d=0;d<E.length;d+=1)I(s[d]);I(C),c=!0}},o(m){for(let d=0;d<s.length;d+=1)V(s[d]);V(C),c=!1},d(m){m&&g(e);for(let d=0;d<s.length;d+=1)s[d].d();C&&C.d(),p=!1,we(b)}}}function xt(n,e){let t,l,s,o,r,i;return s=new Wl({props:{src:e[87],isEdit:e[5],post:e[0][e[1]],muted:e[14],autoplay:e[1]===e[83]&&e[0][e[1]].mediaIdx===e[89],isRightOrder:e[1]===e[83]}}),{key:n,first:null,c(){t=y("div"),l=y("div"),Z(s.$$.fragment),r=q(),this.h()},l(a){t=T(a,"DIV",{class:!0});var f=R(t);l=T(f,"DIV",{class:!0});var c=R(l);K(s.$$.fragment,c),c.forEach(g),r=j(f),f.forEach(g),this.h()},h(){h(l,"class",o=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `),h(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(a,f){N(a,t,f),w(t,l),W(s,l,null),w(t,r),i=!0},p(a,f){e=a;const c={};f[0]&1&&(c.src=e[87]),f[0]&32&&(c.isEdit=e[5]),f[0]&3&&(c.post=e[0][e[1]]),f[0]&16384&&(c.muted=e[14]),f[0]&3&&(c.autoplay=e[1]===e[83]&&e[0][e[1]].mediaIdx===e[89]),f[0]&3&&(c.isRightOrder=e[1]===e[83]),s.$set(c),(!i||f[0]&32&&o!==(o=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `))&&h(l,"class",o)},i(a){i||(I(s.$$.fragment,a),i=!0)},o(a){V(s.$$.fragment,a),i=!1},d(a){a&&g(t),G(s)}}}function yt(n){var B,z;let e,t,l,s,o,r,i,a,f,c,p,b,E,O,C,m=n[81].media.length>1&&Tt(n),d=((B=n[81].reference)==null?void 0:B.url)&&Dt(n),_=((z=n[81].reactions)==null?void 0:z.length)>0&&!n[6]&&Mt(n);function k(F){n[28](F,n[81],n[82],n[83])}let P={allowFollow:!Ue,whenCancelFollow:n[27]};n[81]!==void 0&&(P.post=n[81]),r=new ln({props:P}),Ee.push(()=>Re(r,"post",k));function x(...F){return n[29](n[81],n[82],n[83],...F)}f=new bn({props:{post:n[81]}}),f.$on("textExpanded",x),p=new fn({props:{place:{idx:n[81].place_idx,name:n[81].place_name}}});let A=!n[6]&&Bt(n),L=n[1]===n[83]&&Ot(n);return{c(){m&&m.c(),e=q(),t=y("div"),l=y("div"),d&&d.c(),s=q(),_&&_.c(),o=q(),Z(r.$$.fragment),a=q(),Z(f.$$.fragment),c=q(),Z(p.$$.fragment),b=q(),A&&A.c(),E=q(),L&&L.c(),O=ae(),this.h()},l(F){m&&m.l(F),e=j(F),t=T(F,"DIV",{class:!0});var U=R(t);l=T(U,"DIV",{class:!0});var J=R(l);d&&d.l(J),s=j(J),_&&_.l(J),o=j(J),K(r.$$.fragment,J),a=j(J),K(f.$$.fragment,J),c=j(J),K(p.$$.fragment,J),J.forEach(g),b=j(U),A&&A.l(U),U.forEach(g),E=j(F),L&&L.l(F),O=ae(),this.h()},h(){h(l,"class","flex-grow text-white text-md flex flex-col items-start gap-3 transition-transform text-base "),h(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(F,U){m&&m.m(F,U),N(F,e,U),N(F,t,U),w(t,l),d&&d.m(l,null),w(l,s),_&&_.m(l,null),w(l,o),W(r,l,null),w(l,a),W(f,l,null),w(l,c),W(p,l,null),w(t,b),A&&A.m(t,null),N(F,E,U),L&&L.m(F,U),N(F,O,U),C=!0},p(F,U){var oe,he;n=F,n[81].media.length>1?m?(m.p(n,U),U[0]&1&&I(m,1)):(m=Tt(n),m.c(),I(m,1),m.m(e.parentNode,e)):m&&(te(),V(m,1,1,()=>{m=null}),le()),(oe=n[81].reference)!=null&&oe.url?d?(d.p(n,U),U[0]&1&&I(d,1)):(d=Dt(n),d.c(),I(d,1),d.m(l,s)):d&&(te(),V(d,1,1,()=>{d=null}),le()),((he=n[81].reactions)==null?void 0:he.length)>0&&!n[6]?_?(_.p(n,U),U[0]&65&&I(_,1)):(_=Mt(n),_.c(),I(_,1),_.m(l,o)):_&&(te(),V(_,1,1,()=>{_=null}),le());const J={};U[0]&128&&(J.whenCancelFollow=n[27]),!i&&U[0]&1&&(i=!0,J.post=n[81],Oe(()=>i=!1)),r.$set(J);const ie={};U[0]&1&&(ie.post=n[81]),f.$set(ie);const de={};U[0]&1&&(de.place={idx:n[81].place_idx,name:n[81].place_name}),p.$set(de),n[6]?A&&(te(),V(A,1,1,()=>{A=null}),le()):A?(A.p(n,U),U[0]&64&&I(A,1)):(A=Bt(n),A.c(),I(A,1),A.m(t,null)),n[1]===n[83]?L?(L.p(n,U),U[0]&3&&I(L,1)):(L=Ot(n),L.c(),I(L,1),L.m(O.parentNode,O)):L&&(te(),V(L,1,1,()=>{L=null}),le())},i(F){C||(I(m),I(d),I(_),I(r.$$.fragment,F),I(f.$$.fragment,F),I(p.$$.fragment,F),I(A),I(L),C=!0)},o(F){V(m),V(d),V(_),V(r.$$.fragment,F),V(f.$$.fragment,F),V(p.$$.fragment,F),V(A),V(L),C=!1},d(F){F&&(g(e),g(t),g(E),g(O)),m&&m.d(F),d&&d.d(),_&&_.d(),G(r),G(f),G(p),A&&A.d(),L&&L.d(F)}}}function Tt(n){let e,t;return e=new Ht({props:{post:n[81]}}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},p(l,s){const o={};s[0]&1&&(o.post=l[81]),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Dt(n){let e,t;return e=new Nl({props:{url:n[81].reference.url,name:n[81].reference.name}}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},p(l,s){const o={};s[0]&1&&(o.url=l[81].reference.url),s[0]&1&&(o.name=l[81].reference.name),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Mt(n){let e,t,l=pe(n[81].reactions),s=[];for(let r=0;r<l.length;r+=1)s[r]=Vt(kt(n,l,r));const o=r=>V(s[r],1,1,()=>{s[r]=null});return{c(){e=y("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=T(r,"DIV",{class:!0});var i=R(e);for(let a=0;a<s.length;a+=1)s[a].l(i);i.forEach(g),this.h()},h(){h(e,"class","flex gap-1 justify-center items-center mb-1")},m(r,i){N(r,e,i);for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(e,null);t=!0},p(r,i){if(i[0]&131073){l=pe(r[81].reactions);let a;for(a=0;a<l.length;a+=1){const f=kt(r,l,a);s[a]?(s[a].p(f,i),I(s[a],1)):(s[a]=Vt(f),s[a].c(),I(s[a],1),s[a].m(e,null))}for(te(),a=l.length;a<s.length;a+=1)o(a);le()}},i(r){if(!t){for(let i=0;i<l.length;i+=1)I(s[i]);t=!0}},o(r){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)V(s[i]);t=!1},d(r){r&&g(e),jt(s,r)}}}function Vt(n){let e,t;function l(){return n[26](n[81],n[84])}return e=new zt({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:n[84].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:n[84].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",l),{c(){Z(e.$$.fragment)},l(s){K(e.$$.fragment,s)},m(s,o){W(e,s,o),t=!0},p(s,o){n=s;const r={};o[0]&1&&(r.prefix=n[84].type),o[0]&1&&(r.value=n[84].count),e.$set(r)},i(s){t||(I(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){G(e,s)}}}function Bt(n){var L;let e,t,l,s,o,r,i,a,f=((L=n[81].reactions)!=null&&L.length?n[81].reactions.reduce(n[35],0):0)+"",c,p,b,E,O,C,m,d=n[81].onReactionShowcase&&Pt(n);const _=[Rn,On],k=[];function P(B,z){return B[81].myReaction?0:1}o=P(n),r=k[o]=_[o](n);function x(){return n[36](n[81])}function A(){return n[37](n[81],n[82],n[83])}return E=new Ul({props:{fill:"white",length:1.5}}),{c(){e=y("div"),t=y("div"),d&&d.c(),l=q(),s=y("button"),r.c(),i=q(),a=y("span"),c=be(f),p=q(),b=y("button"),Z(E.$$.fragment),this.h()},l(B){e=T(B,"DIV",{class:!0});var z=R(e);t=T(z,"DIV",{class:!0});var F=R(t);d&&d.l(F),l=j(F),s=T(F,"BUTTON",{class:!0});var U=R(s);r.l(U),i=j(U),a=T(U,"SPAN",{class:!0});var J=R(a);c=ve(J,f),J.forEach(g),U.forEach(g),F.forEach(g),p=j(z),b=T(z,"BUTTON",{});var ie=R(b);K(E.$$.fragment,ie),ie.forEach(g),z.forEach(g),this.h()},h(){h(a,"class","text-xs text-white h-4"),h(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),h(t,"class","flex gap-4 relative"),h(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(B,z){N(B,e,z),w(e,t),d&&d.m(t,null),w(t,l),w(t,s),k[o].m(s,null),w(s,i),w(s,a),w(a,c),w(e,p),w(e,b),W(E,b,null),O=!0,C||(m=[H(s,"click",x),Se(Ye.call(null,s)),Se(jl.call(null,s,500)),H(s,"longpress",A),H(b,"click",n[38])],C=!0)},p(B,z){var U;n=B,n[81].onReactionShowcase?d?d.p(n,z):(d=Pt(n),d.c(),d.m(t,l)):d&&(d.d(1),d=null);let F=o;o=P(n),o!==F&&(te(),V(k[F],1,1,()=>{k[F]=null}),le(),r=k[o],r||(r=k[o]=_[o](n),r.c()),I(r,1),r.m(s,i)),(!O||z[0]&1)&&f!==(f=((U=n[81].reactions)!=null&&U.length?n[81].reactions.reduce(n[35],0):0)+"")&&Ae(c,f)},i(B){O||(I(r),I(E.$$.fragment,B),O=!0)},o(B){V(r),V(E.$$.fragment,B),O=!1},d(B){B&&g(e),d&&d.d(),k[o].d(),G(E),C=!1,we(m)}}}function Pt(n){let e,t,l="👍",s,o,r="🔥",i,a,f="😍",c,p,b="😋",E,O,C="😊️️",m,d;function _(){return n[30](n[81])}function k(){return n[31](n[81])}function P(){return n[32](n[81])}function x(){return n[33](n[81])}function A(){return n[34](n[81])}return{c(){e=y("div"),t=y("button"),t.textContent=l,s=q(),o=y("button"),o.textContent=r,i=q(),a=y("button"),a.textContent=f,c=q(),p=y("button"),p.textContent=b,E=q(),O=y("button"),O.textContent=C,this.h()},l(L){e=T(L,"DIV",{class:!0});var B=R(e);t=T(B,"BUTTON",{class:!0,"data-svelte-h":!0}),se(t)!=="svelte-3oecln"&&(t.textContent=l),s=j(B),o=T(B,"BUTTON",{class:!0,"data-svelte-h":!0}),se(o)!=="svelte-131qbu2"&&(o.textContent=r),i=j(B),a=T(B,"BUTTON",{class:!0,"data-svelte-h":!0}),se(a)!=="svelte-lq90i3"&&(a.textContent=f),c=j(B),p=T(B,"BUTTON",{class:!0,"data-svelte-h":!0}),se(p)!=="svelte-l73y87"&&(p.textContent=b),E=j(B),O=T(B,"BUTTON",{class:!0,"data-svelte-h":!0}),se(O)!=="svelte-11szxsj"&&(O.textContent=C),B.forEach(g),this.h()},h(){h(t,"class","text-2xl/[26px]"),h(o,"class","text-2xl/[26px]"),h(a,"class","text-2xl/[26px]"),h(p,"class","text-2xl/[26px]"),h(O,"class","text-2xl/[26px]"),h(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(L,B){N(L,e,B),w(e,t),w(e,s),w(e,o),w(e,i),w(e,a),w(e,c),w(e,p),w(e,E),w(e,O),m||(d=[H(t,"click",_),H(o,"click",k),H(a,"click",P),H(p,"click",x),H(O,"click",A)],m=!0)},p(L,B){n=L},d(L){L&&g(e),m=!1,we(d)}}}function On(n){let e,t;return e=new Fl({props:{fill:"white",length:1.5}}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Rn(n){let e,t;return e=new ql({props:{fill:"#EA3323",length:1.5}}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Ot(n){let e,t;return e=new In({props:{isTextExpanded:n[81].isTextExpanded}}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},p(l,s){const o={};s[0]&1&&(o.isTextExpanded=l[81].isTextExpanded),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function Rt(n,e){let t,l=Math.abs(e[1]-e[83])<=5,s,o,r=l&&Et(e);return{key:n,first:null,c(){t=ae(),r&&r.c(),s=ae(),this.h()},l(i){t=ae(),r&&r.l(i),s=ae(),this.h()},h(){this.first=t},m(i,a){N(i,t,a),r&&r.m(i,a),N(i,s,a),o=!0},p(i,a){e=i,a[0]&3&&(l=Math.abs(e[1]-e[83])<=5),l?r?(r.p(e,a),a[0]&3&&I(r,1)):(r=Et(e),r.c(),I(r,1),r.m(s.parentNode,s)):r&&(te(),V(r,1,1,()=>{r=null}),le())},i(i){o||(I(r),o=!0)},o(i){V(r),o=!1},d(i){i&&(g(t),g(s)),r&&r.d(i)}}}function Lt(n){let e,t;return e=new Ht({props:{post:n[0][n[1]],fixed:!1}}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},p(l,s){const o={};s[0]&3&&(o.post=l[0][l[1]]),e.$set(o)},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function St(n){let e,t;return e=new Al({}),{c(){Z(e.$$.fragment)},l(l){K(e.$$.fragment,l)},m(l,s){W(e,l,s),t=!0},i(l){t||(I(e.$$.fragment,l),t=!0)},o(l){V(e.$$.fragment,l),t=!1},d(l){G(e,l)}}}function At(n){let e,t,l,s,o="수정",r,i,a,f,c,p="삭제",b,E,O;return t=new dn({props:{fill:"white",length:1.5}}),a=new pn({props:{fill:"white",length:1.5}}),{c(){e=y("button"),Z(t.$$.fragment),l=q(),s=y("span"),s.textContent=o,r=q(),i=y("button"),Z(a.$$.fragment),f=q(),c=y("span"),c.textContent=p,this.h()},l(C){e=T(C,"BUTTON",{class:!0});var m=R(e);K(t.$$.fragment,m),l=j(m),s=T(m,"SPAN",{"data-svelte-h":!0}),se(s)!=="svelte-17aljrl"&&(s.textContent=o),m.forEach(g),r=j(C),i=T(C,"BUTTON",{class:!0});var d=R(i);K(a.$$.fragment,d),f=j(d),c=T(d,"SPAN",{"data-svelte-h":!0}),se(c)!=="svelte-1k1dgz"&&(c.textContent=p),d.forEach(g),this.h()},h(){h(e,"class","flex items-center gap-2 text-white text-sm"),h(i,"class","flex items-center gap-2 text-white text-sm")},m(C,m){N(C,e,m),W(t,e,null),w(e,l),w(e,s),N(C,r,m),N(C,i,m),W(a,i,null),w(i,f),w(i,c),b=!0,E||(O=[H(e,"click",n[40]),H(i,"click",n[41])],E=!0)},p:$,i(C){b||(I(t.$$.fragment,C),I(a.$$.fragment,C),b=!0)},o(C){V(t.$$.fragment,C),V(a.$$.fragment,C),b=!1},d(C){C&&(g(e),g(r),g(i)),G(t),G(a),E=!1,we(O)}}}function Nt(n){let e,t,l,s,o,r;return t=new rn({}),{c(){e=y("button"),Z(t.$$.fragment),l=be(`
        신고`),this.h()},l(i){e=T(i,"BUTTON",{class:!0});var a=R(e);K(t.$$.fragment,a),l=ve(a,`
        신고`),a.forEach(g),this.h()},h(){h(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(i,a){N(i,e,a),W(t,e,null),w(e,l),s=!0,o||(r=H(e,"click",n[43]),o=!0)},p:$,i(i){s||(I(t.$$.fragment,i),s=!0)},o(i){V(t.$$.fragment,i),s=!1},d(i){i&&g(e),G(t),o=!1,r()}}}function Ln(n){let e,t,l,s,o,r,i,a,f,c=n[13]&&At(n);s=new Jl({props:{length:1.5,fill:"white"}});let p=!n[13]&&Nt(n);return{c(){e=y("div"),c&&c.c(),t=q(),l=y("button"),Z(s.$$.fragment),o=be(`
      링크 복사`),r=q(),p&&p.c(),this.h()},l(b){e=T(b,"DIV",{id:!0,class:!0});var E=R(e);c&&c.l(E),t=j(E),l=T(E,"BUTTON",{class:!0});var O=R(l);K(s.$$.fragment,O),o=ve(O,`
      링크 복사`),O.forEach(g),r=j(E),p&&p.l(E),E.forEach(g),this.h()},h(){h(l,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"id","test"),h(e,"class","flex flex-col px-5 gap-3")},m(b,E){N(b,e,E),c&&c.m(e,null),w(e,t),w(e,l),W(s,l,null),w(l,o),w(e,r),p&&p.m(e,null),i=!0,a||(f=[H(l,"click",n[42]),Se(Ye.call(null,e))],a=!0)},p(b,E){b[13]?c?(c.p(b,E),E[0]&8192&&I(c,1)):(c=At(b),c.c(),I(c,1),c.m(e,t)):c&&(te(),V(c,1,1,()=>{c=null}),le()),b[13]?p&&(te(),V(p,1,1,()=>{p=null}),le()):p?(p.p(b,E),E[0]&8192&&I(p,1)):(p=Nt(b),p.c(),I(p,1),p.m(e,null))},i(b){i||(I(c),I(s.$$.fragment,b),I(p),i=!0)},o(b){V(c),V(s.$$.fragment,b),V(p),i=!1},d(b){b&&g(e),c&&c.d(),G(s),p&&p.d(),a=!1,we(f)}}}function Sn(n){let e,t,l="정말로 삭제하시겠습니까?",s,o,r="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",i,a,f,c="삭제",p,b,E="취소",O,C;return{c(){e=y("div"),t=y("h2"),t.textContent=l,s=q(),o=y("p"),o.textContent=r,i=q(),a=y("div"),f=y("button"),f.textContent=c,p=q(),b=y("button"),b.textContent=E,this.h()},l(m){e=T(m,"DIV",{class:!0});var d=R(e);t=T(d,"H2",{class:!0,"data-svelte-h":!0}),se(t)!=="svelte-1yzhdkj"&&(t.textContent=l),s=j(d),o=T(d,"P",{class:!0,"data-svelte-h":!0}),se(o)!=="svelte-26p028"&&(o.textContent=r),i=j(d),a=T(d,"DIV",{class:!0});var _=R(a);f=T(_,"BUTTON",{class:!0,"data-svelte-h":!0}),se(f)!=="svelte-1q4epan"&&(f.textContent=c),p=j(_),b=T(_,"BUTTON",{class:!0,"data-svelte-h":!0}),se(b)!=="svelte-1rzg9yy"&&(b.textContent=E),_.forEach(g),d.forEach(g),this.h()},h(){h(t,"class","text-lg font-semibold mb-2"),h(o,"class","text-gray-600 mb-4"),h(f,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),h(b,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),h(a,"class","flex justify-center space-x-4"),h(e,"class","text-center")},m(m,d){N(m,e,d),w(e,t),w(e,s),w(e,o),w(e,i),w(e,a),w(a,f),w(a,p),w(a,b),O||(C=[H(f,"click",n[48]),H(b,"click",n[49])],O=!0)},p:$,d(m){m&&g(e),O=!1,we(C)}}}function An(n){var he;let e,t,l,s=[],o=new Map,r,i,a,f,c,p,b,E,O,C,m,d,_,k,P,x=!n[5]&&It(n),A=pe(n[0]);const L=v=>v[81].idx;for(let v=0;v<A.length;v+=1){let D=wt(n,A,v),Q=L(D);o.set(Q,s[v]=Rt(Q,D))}let B=n[5]&&((he=n[0][n[1]])==null?void 0:he.media.length)>1&&Lt(n),z=!n[5]&&St();function F(v){n[44](v)}let U={fixed:!0,noHandle:!0,$$slots:{default:[Ln]},$$scope:{ctx:n}};n[2]!==void 0&&(U.isOpen=n[2]),c=new Yt({props:U}),Ee.push(()=>Re(c,"isOpen",F));function J(v){n[45](v)}let ie={targetTable:"posts",targetIdx:n[0][n[1]].idx};n[3]!==void 0&&(ie.isOpen=n[3]),E=new Mn({props:ie}),Ee.push(()=>Re(E,"isOpen",J)),E.$on("reported",n[46]),m=new Pn({props:{isVisible:n[0][n[1]].permission_signer==="reported",targetTable:"posts",targetIdx:n[0][n[1]].idx}}),m.$on("unreported",n[47]);function de(v){n[50](v)}let oe={$$slots:{default:[Sn]},$$scope:{ctx:n}};return n[4]!==void 0&&(oe.modalVisible=n[4]),_=new Yl({props:oe}),Ee.push(()=>Re(_,"modalVisible",de)),{c(){x&&x.c(),e=q(),t=y("div"),l=y("div");for(let v=0;v<s.length;v+=1)s[v].c();r=q(),B&&B.c(),i=q(),z&&z.c(),f=q(),Z(c.$$.fragment),b=q(),Z(E.$$.fragment),C=q(),Z(m.$$.fragment),d=q(),Z(_.$$.fragment),this.h()},l(v){x&&x.l(v),e=j(v),t=T(v,"DIV",{class:!0});var D=R(t);l=T(D,"DIV",{class:!0});var Q=R(l);for(let ne=0;ne<s.length;ne+=1)s[ne].l(Q);Q.forEach(g),r=j(D),B&&B.l(D),i=j(D),z&&z.l(D),D.forEach(g),f=j(v),K(c.$$.fragment,v),b=j(v),K(E.$$.fragment,v),C=j(v),K(m.$$.fragment,v),d=j(v),K(_.$$.fragment,v),this.h()},h(){h(l,"class","flex flex-grow relative w-full h-full bg-black"),h(t,"class",a="viewer bg-black select-none flex flex-col "+(n[5]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh"))},m(v,D){x&&x.m(v,D),N(v,e,D),N(v,t,D),w(t,l);for(let Q=0;Q<s.length;Q+=1)s[Q]&&s[Q].m(l,null);w(t,r),B&&B.m(t,null),w(t,i),z&&z.m(t,null),n[39](t),N(v,f,D),W(c,v,D),N(v,b,D),W(E,v,D),N(v,C,D),W(m,v,D),N(v,d,D),W(_,v,D),P=!0},p(v,D){var Ne;v[5]?x&&(x.d(1),x=null):x||(x=It(v),x.c(),x.m(e.parentNode,e)),D[0]&184295&&(A=pe(v[0]),te(),s=Je(s,D,L,1,v,A,o,l,Ut,Rt,null,wt),le()),v[5]&&((Ne=v[0][v[1]])==null?void 0:Ne.media.length)>1?B?(B.p(v,D),D[0]&35&&I(B,1)):(B=Lt(v),B.c(),I(B,1),B.m(t,i)):B&&(te(),V(B,1,1,()=>{B=null}),le()),v[5]?z&&(te(),V(z,1,1,()=>{z=null}),le()):z?D[0]&32&&I(z,1):(z=St(),z.c(),I(z,1),z.m(t,null)),(!P||D[0]&32&&a!==(a="viewer bg-black select-none flex flex-col "+(v[5]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh")))&&h(t,"class",a);const Q={};D[0]&8220|D[2]&268435456&&(Q.$$scope={dirty:D,ctx:v}),!p&&D[0]&4&&(p=!0,Q.isOpen=v[2],Oe(()=>p=!1)),c.$set(Q);const ne={};D[0]&3&&(ne.targetIdx=v[0][v[1]].idx),!O&&D[0]&8&&(O=!0,ne.isOpen=v[3],Oe(()=>O=!1)),E.$set(ne);const Ve={};D[0]&3&&(Ve.isVisible=v[0][v[1]].permission_signer==="reported"),D[0]&3&&(Ve.targetIdx=v[0][v[1]].idx),m.$set(Ve);const Be={};D[0]&16|D[2]&268435456&&(Be.$$scope={dirty:D,ctx:v}),!k&&D[0]&16&&(k=!0,Be.modalVisible=v[4],Oe(()=>k=!1)),_.$set(Be)},i(v){if(!P){for(let D=0;D<A.length;D+=1)I(s[D]);I(B),I(z),I(c.$$.fragment,v),I(E.$$.fragment,v),I(m.$$.fragment,v),I(_.$$.fragment,v),P=!0}},o(v){for(let D=0;D<s.length;D+=1)V(s[D]);V(B),V(z),V(c.$$.fragment,v),V(E.$$.fragment,v),V(m.$$.fragment,v),V(_.$$.fragment,v),P=!1},d(v){v&&(g(e),g(t),g(f),g(b),g(C),g(d)),x&&x.d(v);for(let D=0;D<s.length;D+=1)s[D].d();B&&B.d(),z&&z.d(),n[39](null),G(c,v),G(E,v),G(m,v),G(_,v)}}}const Nn=30,Fn=10,Ft=150;function Pe(n){return"touches"in n||"changedTouches"in n}function qn(n){return Pe(n)?[n.touches[0].clientX,n.touches[0].clientY]:[n.clientX,n.clientY]}function jn(n,e,t){let l,s,o,r;rt(n,at,u=>t(14,o=u)),rt(n,Vl,u=>t(24,r=u));let{posts:i=[]}=e,{index:a=0}=e,{type:f=r.url.searchParams.get("type")}=e,{isEdit:c=!1}=e,{dontMoveVertically:p=!1}=e,{selectedReaction:b=void 0}=e,{hideActionButtons:E=!1}=e,{whenCancelForExternalLink:O=()=>{}}=e,C=!0,m=!1,d=!1,_=0,k=0,P={width:0,height:0},x=!1,A=!1,{actionSheetMoreIsOpen:L=!1}=e,{actionSheetReportIsOpen:B=!1}=e,{modalVisible:z=!1}=e;function F(u){if(!u)return!1;const M=Me();return M!==null&&String(M)===u}let U=!1,J=!1,ie=-1,de=-1,oe,he=!1,v=[],D=[],Q;async function ne(){var u,M;i[a]&&Bl({mediaIdx:`${((u=i[a])==null?void 0:u.mediaIdx)||0}`,postIdx:`${(M=i[a])==null?void 0:M.idx}`},{replace:!0})}async function Ve(){t(21,U=!0);const u=i.length,M=r.url.searchParams.get("userIdx"),S=r.url.searchParams.get("placeIdx"),X=`&offset=${u}`,Y=`&limit=${Nn}`,re=M?`&userIdx=${M}`:"",Te=S?`&placeIdx=${S}`:"",me=(await fetch(`${Le}/posts?${re}${Te}${X}${Y}`).then(ke=>ke.json()).then(ke=>{var st;return((st=ke.data)==null?void 0:st.posts)??[]})).map(ke=>({...ke,mediaIdx:0}));me.length===0&&t(22,J=!0),t(0,i=[...i,...me]),t(21,U=!1)}function Be(u){const{height:M}=P;if(a===0&&u>0||a===i.length-1&&u<0){t(9,_=u*.3);return}t(9,_=Math.max(Math.min(u,M),-M))}function Ne(u){t(8,C=!1);const M=xe(2),S=Pe(u)?u.changedTouches[0].clientY-de:u.clientY-de;S>M&&a>0?(t(1,a-=1),m=!0,ne()):-S>M&&a<i.length-1&&(t(1,a+=1),m=!0,ne()),t(9,_=0)}function Zt(u){const{width:M}=P,S=i[a].mediaIdx,X=i[a].media.length-1;if(S===0&&u>0||S===X&&u<0){t(10,k=u*.3);return}t(10,k=Math.max(Math.min(u,M),-M))}function Kt(u){t(8,C=!1);const M=xe(2),S=Pe(u)?u.changedTouches[0].clientX-ie:u.clientX-ie,X=i[a].mediaIdx,Y=i[a].media.length-1;S>M&&X>0?ye(X-1):-S>M&&X<Y&&ye(X+1),t(10,k=0)}function ye(u){t(0,i[a]={...i[a],mediaIdx:u},i),t(0,i=[...i]),d=!0,ne()}function Fe(u){m||d||(he=!0,oe=void 0,Pe(u)?(ie=u.touches[0].clientX,de=u.touches[0].clientY):(ie=u.clientX,de=u.clientY,window.addEventListener("mousemove",qe,{passive:!1}),window.addEventListener("mouseup",je)))}function qe(u){if(!he||m||d)return;const[M,S]=qn(u),X=M-ie,Y=S-de;oe===void 0&&(oe=Math.abs(Y)>=Math.abs(X)?"post":"media"),!p&&oe==="post"?Be(Y):oe==="media"&&Zt(X)}function je(u){!he||m||d||(he=!1,oe==="post"?Ne(u):oe==="media"&&Kt(u),Pe(u)||(window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",je)))}function Qe(u){if(m||d)return;u.preventDefault();const M=Date.now(),S=Math.abs(u.deltaX),X=Math.abs(u.deltaY);if(S>X){if(D.push({deltaX:u.deltaX,timestamp:M}),D=D.filter(Y=>M-Y.timestamp<=Ft),D.length>=2){const Y=D[0],re=D[D.length-1];if(Math.abs(re.deltaX)-Math.abs(Y.deltaX)>=0&&Math.abs(re.deltaX)>=30){const me=i[a].mediaIdx,ke=i[a].media.length-1;re.deltaX>0&&me<ke?ye(me+1):re.deltaX<0&&me>0&&ye(me-1),D=[],d=!0}}}else if(v.push({deltaY:u.deltaY,timestamp:M}),v=v.filter(Y=>M-Y.timestamp<=Ft),v.length>=2){const Y=v[0],re=v[v.length-1];Math.abs(re.deltaY)-Math.abs(Y.deltaY)>=0&&Math.abs(re.deltaY)>=30&&(re.deltaY>0&&a<i.length-1?(t(8,C=!1),t(1,a+=1),ne(),m=!0):re.deltaY<0&&a>0&&(t(8,C=!1),t(1,a-=1),ne(),m=!0),v=[])}}function $e(u){if(m||d)return;const M=i[a].mediaIdx,S=i[a].media.length-1;switch(u.key){case"ArrowUp":a>0&&(t(8,C=!1),t(1,a--,a),m=!0,ne());break;case"ArrowDown":a<i.length-1&&(t(8,C=!1),t(1,a++,a),m=!0,ne());break;case"ArrowLeft":M>0&&(t(8,C=!1),d=!0,ye(M-1));break;case"ArrowRight":M<S&&(t(8,C=!1),d=!0,ye(M+1));break}}function Wt(){t(8,C=!0),m=!1,d=!1}function et(){Q&&t(11,P={width:Q.clientWidth,height:Q.clientHeight})}function Gt(){var S,X;const u=Number(r.url.searchParams.get("mediaIdx")||0),M=((X=(S=i.at(a))==null?void 0:S.media)==null?void 0:X.length)||0;u&&u<M?t(0,i[a]={...i[a],mediaIdx:u},i):t(0,i[a]={...i[a],mediaIdx:0},i),t(0,i=[...i]),ne()}function Jt(){document.addEventListener("touchstart",Fe,{passive:!1}),document.addEventListener("touchmove",qe,{passive:!1}),document.addEventListener("touchend",je),document.addEventListener("mousedown",Fe,{passive:!1}),document.addEventListener("wheel",Qe,{passive:!1}),document.addEventListener("keydown",$e)}function Qt(){document.removeEventListener("touchstart",Fe),document.removeEventListener("touchmove",qe),document.removeEventListener("touchend",je),document.removeEventListener("mousedown",Fe),document.removeEventListener("wheel",Qe),document.removeEventListener("keydown",$e)}qt(()=>{yl(at,o=!0,o),et();const u=new ResizeObserver(()=>et());return Q&&u.observe(Q),Jt(),Gt(),()=>{u.disconnect()}}),Ge(()=>{Qt()});function tt(){var X;if(A)return;A=!0;const u=ze(),M=Me(),S=(X=i[a])==null?void 0:X.idx;if(!u||!M||!S)return A=!1;fetch(`${Le}/posts/${S}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}}).then(Y=>Y.json()).then(()=>Ke(`/users/${M}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{A=!1})}async function lt(u){var Y,re,Te;const M=(Y=i[u])==null?void 0:Y.idx;if(M===void 0||c||((re=i[u])==null?void 0:re.needReactionReload)!==!0&&((Te=i[u])!=null&&Te.reactions))return;const S=ze(),X=await fetch(`${Le}/vote/reactions?targetTable=posts&targetId=${M}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+S}});if(X.ok){const me=await X.json();t(0,i[u].reactions=me.data.reactions,i),t(0,i[u].myReaction=me.data.myReaction,i)}}function ge(u,M){if(Ue)return O();if(x)return;x=!0;const S=a,X=i[S];if((X==null?void 0:X.idx)!==u)return x=!1;if(!ot())return X.needReactionReload=!0,x=!1,_e.emit("showSignInModal",{removable:!0,callback:Ll?()=>{lt(S)}:void 0});X.myReaction===M?_e.emit("setReaction",{target:"posts",targetId:u,reaction:null,callback:()=>{t(0,i[S].myReaction=null,i),nt(S,M),x=!1}}):(X.myReaction&&nt(S,X.myReaction),_e.emit("setReaction",{target:"posts",targetId:u,reaction:M,callback:()=>{t(0,i[S].myReaction=M,i),i[S].reactions.some(Y=>Y.type===M)?t(0,i[S].reactions=i[S].reactions.map(Y=>Y.type===M?{...Y,count:Number(Y.count)+1}:Y),i):t(0,i[S].reactions=[...i[S].reactions,{type:M,count:1}],i),x=!1}}))}function nt(u,M){let S=[];for(const X of i[u].reactions)if(X.type===M){const Y=Number(X.count);Y>1&&S.push({...X,count:Y-1})}else S.push(X);t(0,i[u].reactions=S,i)}function $t(u){Dl.call(this,n,u)}const el=(u,M)=>{ge(u.idx,M.type)},tl=()=>{if(Ue)return O()};function ll(u,M,S,X){S[X]=u,t(0,i)}const nl=(u,M,S,X)=>{t(0,M[S].isTextExpanded=X.detail.expanded,i)},sl=u=>{ge(u.idx,"👍")},il=u=>{ge(u.idx,"️🔥")},rl=u=>{ge(u.idx,"😍")},al=u=>{ge(u.idx,"😋")},ol=u=>{ge(u.idx,"😊️️")},fl=(u,M)=>u+Number(M.count),ul=u=>{ge(u.idx,u.myReaction||"❤️")},cl=(u,M,S)=>{t(0,M[S].onReactionShowcase=!0,i);const X=()=>{t(0,M[S].onReactionShowcase=!1,i),window.removeEventListener("click",X)};setTimeout(()=>{window.addEventListener("click",X)},500)},dl=()=>{if(Ue)return O();if(!ot())return _e.emit("showSignInModal",{removable:!0});t(2,L=!0)};function hl(u){Ee[u?"unshift":"push"](()=>{Q=u,t(12,Q)})}const ml=()=>{var u;t(2,L=!1),Ke(`/viewer/edit?type=patch&postIdx=${(u=window.location.search.split("postIdx=")[1])==null?void 0:u.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},pl=()=>{t(2,L=!1),t(4,z=!0)},gl=()=>{Gl(`${location.pathname}${location.search}`),t(2,L=!1)},_l=()=>{t(2,L=!1),t(3,B=!0)};function bl(u){L=u,t(2,L)}function vl(u){B=u,t(3,B)}const wl=()=>{t(0,i[a].permission_signer="reported",i)},kl=()=>{t(0,i[a].permission_signer=null,i)},Cl=()=>{tt(),t(4,z=!1)},Il=()=>{t(4,z=!1)};function El(u){z=u,t(4,z)}return n.$$set=u=>{"posts"in u&&t(0,i=u.posts),"index"in u&&t(1,a=u.index),"type"in u&&t(18,f=u.type),"isEdit"in u&&t(5,c=u.isEdit),"dontMoveVertically"in u&&t(19,p=u.dontMoveVertically),"selectedReaction"in u&&t(20,b=u.selectedReaction),"hideActionButtons"in u&&t(6,E=u.hideActionButtons),"whenCancelForExternalLink"in u&&t(7,O=u.whenCancelForExternalLink),"actionSheetMoreIsOpen"in u&&t(2,L=u.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in u&&t(3,B=u.actionSheetReportIsOpen),"modalVisible"in u&&t(4,z=u.modalVisible)},n.$$.update=()=>{var u;n.$$.dirty[0]&16777216&&r&&ne(),n.$$.dirty[0]&1048576&&b&&ge(b.postIdx,b.reaction),n.$$.dirty[0]&2&&lt(a),n.$$.dirty[0]&3&&t(23,l=(u=i[a])==null?void 0:u.user_idx),n.$$.dirty[0]&8388608&&t(13,s=F(l)),n.$$.dirty[0]&6815747&&!p&&a>=i.length-Fn&&!U&&!J&&Ve()},[i,a,L,B,z,c,E,O,C,_,k,P,Q,s,o,Wt,tt,ge,f,p,b,U,J,l,r,$t,el,tl,ll,nl,sl,il,rl,al,ol,fl,ul,cl,dl,hl,ml,pl,gl,_l,bl,vl,wl,kl,Cl,Il,El]}class _s extends ue{constructor(e){super(),ce(this,e,jn,An,fe,{posts:0,index:1,type:18,isEdit:5,dontMoveVertically:19,selectedReaction:20,hideActionButtons:6,whenCancelForExternalLink:7,actionSheetMoreIsOpen:2,actionSheetReportIsOpen:3,modalVisible:4},null,[-1,-1,-1])}}export{_s as V};
