import{s as ge,w as Ae,x as Ie,b as E,f as m,o as d,i as A,h as w,n as J,e as y,a as S,c as k,g as P,m as ee,T as X,p as T,z as F,K as q,v as Ge,C as Ke,U as We,H as te,t as _e,d as ve,j as Ce,F as ae,y as ue,I as Y,k as Ze,D as $e,N as xe,E as ie}from"./scheduler.CGPrvQej.js";import{S as be,i as ye,c as ce,d as fe,m as he,t as de,a as pe,e as me}from"./index.C24WiM7b.js";import{o as Qe,a as Xe}from"./keyboard.ZzgkaS5U.js";import{D as Ye}from"./Dim.C2ZicWh8.js";import{e as R}from"./each.Bquof17x.js";import{a as se,k as et,A as tt,e as nt}from"./store.DB5cCk6Q.js";import{a as ot,g as rt}from"./sign.Cb4QPjG6.js";const it=["local","version","cdnUrl"],st=["skins"],lt=["compact","flat","shortcodes"];function at(n,e){return ht(n)||ft(n,e)||ct(n,e)||ut()}function ut(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ct(n,e){if(n){if(typeof n=="string")return Be(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Be(n,e):void 0}}function Be(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,o=Array(e);t<e;t++)o[t]=n[t];return o}function ft(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var o,r,i,s,a=[],l=!0,c=!1;try{if(i=(t=t.call(n)).next,e!==0)for(;!(l=(o=i.call(t)).done)&&(a.push(o.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}function ht(n){if(Array.isArray(n))return n}function Oe(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);e&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),t.push.apply(t,o)}return t}function Je(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Oe(Object(t),!0).forEach(function(o){dt(n,o,t[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach(function(o){Object.defineProperty(n,o,Object.getOwnPropertyDescriptor(t,o))})}return n}function dt(n,e,t){return(e=pt(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function pt(n){var e=mt(n,"string");return typeof e=="symbol"?e:e+""}function mt(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var o=t.call(n,e||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function ke(n,e){if(n==null)return{};var t,o,r=gt(n,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(n);for(o=0;o<i.length;o++)t=i[o],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(n,t)&&(r[t]=n[t])}return r}function gt(n,e){if(n==null)return{};var t={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(e.indexOf(o)>=0)continue;t[o]=n[o]}return t}function _t(n,e,t){let o=`https://cdn.jsdelivr.net/npm/emojibase-data@${e}/${n}`;return typeof t=="function"?o=t(n,e):typeof t=="string"&&(o=`${t}/${n}`),o}async function we(n,e={}){const t=e.local,o=t===void 0?!1:t,r=e.version,i=r===void 0?"latest":r,s=e.cdnUrl,a=ke(e,it),l=_t(n,i,s),c=o?localStorage:sessionStorage,u=`emojibase/${i}/${n}`,p=c.getItem(u);if(p)return JSON.parse(p);const C=await fetch(l,Je({credentials:"omit",mode:"cors",redirect:"error"},a));if(!C.ok)throw new Error("Failed to load Emojibase dataset.");const L=await C.json();try{c.setItem(u,JSON.stringify(L))}catch{}return L}const vt={discord:"joypixels",slack:"iamcal"};async function Te(n,e,t){return we(`${n}/shortcodes/${vt[e]??e}.json`,t)}function $(n,e){if(e.length===0)return n;const t=new Set(n.shortcodes);return e.forEach(o=>{const r=o[n.hexcode];Array.isArray(r)?r.forEach(i=>t.add(i)):r&&t.add(r)}),n.shortcodes=[...t],n.skins&&n.skins.forEach(o=>{$(o,e)}),n}function Ct(n,e=[]){const t=[];return n.forEach(o=>{if(o.skins){const r=o.skins,i=ke(o,st);t.push($(i,e)),r.forEach(s=>{const a=Je({},s);i.tags&&(a.tags=[...i.tags]),t.push($(a,e))})}else t.push($(o,e))}),t}function bt(n,e){return e.length===0||n.forEach(t=>{$(t,e)}),n}async function Le(n,e={}){const t=e.compact,o=t===void 0?!1:t,r=e.flat,i=r===void 0?!1:r,s=e.shortcodes,a=s===void 0?[]:s,l=ke(e,lt),c=await we(`${n}/${o?"compact":"data"}.json`,l);let u=[];return a.length>0&&(u=await Promise.all(a.map(p=>{let C;if(p.includes("/")){const L=p.split("/"),I=at(L,2),V=I[0],O=I[1];C=Te(V,O,l)}else C=Te(n,p,l);return C.catch(()=>({}))}))),i?Ct(c,u):bt(c,u)}async function yt(n,e){return we(`${n}/messages.json`,e)}function kt(n){let e,t;return{c(){e=Ae("svg"),t=Ae("path"),this.h()},l(o){e=Ie(o,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var r=E(e);t=Ie(r,"path",{d:!0,fill:!0}),E(t).forEach(m),r.forEach(m),this.h()},h(){d(t,"d","M25.3183 6H10.6C10.2189 6.00049 9.84232 6.08586 9.49524 6.25042C9.14815 6.41497 8.83856 6.65495 8.58708 6.95437C8.54355 7.00635 8.5053 7.0629 8.47292 7.12313L3.13692 15.4844C3.04734 15.6401 3 15.8183 3 16C3 16.1817 3.04734 16.36 3.13692 16.5156L8.46515 24.8638C8.49865 24.9281 8.53873 24.9885 8.58469 25.0438C8.83614 25.3437 9.14585 25.5841 9.49316 25.749C9.84047 25.9139 10.2174 25.9995 10.5988 26H25.3183C26.0293 25.9992 26.7109 25.7034 27.2137 25.1777C27.7164 24.652 27.9992 23.9391 28 23.1956V8.80437C27.9992 8.06086 27.7164 7.34804 27.2137 6.8223C26.7109 6.29655 26.0293 6.00083 25.3183 6ZM22.0233 19.4375C22.1142 19.5299 22.1867 19.6402 22.2364 19.7621C22.2862 19.884 22.3123 20.0151 22.3132 20.1476C22.3141 20.2802 22.2898 20.4116 22.2416 20.5342C22.1935 20.6569 22.1226 20.7683 22.033 20.862C21.9433 20.9557 21.8367 21.0298 21.7194 21.0801C21.6021 21.1303 21.4765 21.1557 21.3497 21.1547C21.223 21.1537 21.0977 21.1263 20.9811 21.0743C20.8646 21.0222 20.7591 20.9464 20.6708 20.8512L17.4613 17.5L14.2536 20.8531C14.0741 21.0408 13.8306 21.1463 13.5767 21.1463C13.3229 21.1463 13.0794 21.0408 12.8999 20.8531C12.7204 20.6654 12.6195 20.4108 12.6195 20.1453C12.6195 19.8798 12.7204 19.6252 12.8999 19.4375L16.1064 16.0831L12.8975 12.7275C12.718 12.5394 12.6174 12.2846 12.6177 12.0189C12.618 11.7532 12.7191 11.4986 12.899 11.3109C13.0788 11.1233 13.3225 11.018 13.5766 11.0183C13.8306 11.0186 14.0742 11.1244 14.2536 11.3125L17.4625 14.6687L20.6702 11.3125C20.8496 11.1249 21.093 11.0194 21.3467 11.0194C21.6005 11.0194 21.8439 11.1249 22.0233 11.3125C22.2027 11.5001 22.3035 11.7546 22.3035 12.02C22.3035 12.2854 22.2027 12.5399 22.0233 12.7275L18.8138 16.0831L22.0233 19.4375Z"),d(t,"fill","#757475"),d(e,"xmlns","http://www.w3.org/2000/svg"),d(e,"width","32"),d(e,"height","32"),d(e,"viewBox","0 0 32 32"),d(e,"fill","none")},m(o,r){A(o,e,r),w(e,t)},p:J,i:J,o:J,d(o){o&&m(e)}}}class wt extends be{constructor(e){super(),ye(this,e,null,kt,ge,{})}}function Se(n,e,t){const o=n.slice();return o[27]=e[t],o}function Pe(n,e,t){const o=n.slice();return o[35]=e[t],o}function Ve(n,e,t){const o=n.slice();return o[30]=e[t][0],o[31]=e[t][1],o}function Me(n,e,t){const o=n.slice();return o[35]=e[t],o}function le(n){const e=n.slice(),t=`group-${e[30]}`;return e[34]=t,e}function He(n){let e,t="✕",o,r;return{c(){e=y("button"),e.textContent=t,this.h()},l(i){e=k(i,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),ee(e)!=="svelte-1jh20in"&&(e.textContent=t),this.h()},h(){d(e,"class","absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 pointer-events-auto"),d(e,"title","검색어 지우기")},m(i,s){A(i,e,s),o||(r=T(e,"click",F(q(n[9]))),o=!0)},p:J,d(i){i&&m(e),o=!1,r()}}}function Et(n){let e,t=R(n[2]),o=[];for(let r=0;r<t.length;r+=1)o[r]=Ne(Pe(n,t,r));return{c(){e=y("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=k(r,"DIV",{class:!0});var i=E(e);for(let s=0;s<o.length;s+=1)o[s].l(i);i.forEach(m),this.h()},h(){d(e,"class","grid grid-cols-7 gap-x-[0.88rem] gap-y-[0.44rem] mb-[0.44rem] place-items-center")},m(r,i){A(r,e,i);for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(e,null)},p(r,i){if(i[0]&2052){t=R(r[2]);let s;for(s=0;s<t.length;s+=1){const a=Pe(r,t,s);o[s]?o[s].p(a,i):(o[s]=Ne(a),o[s].c(),o[s].m(e,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=t.length}},d(r){r&&m(e),te(o,r)}}}function jt(n){let e,t=R(Object.entries(n[0]).sort(n[16])),o=[];for(let r=0;r<t.length;r+=1)o[r]=Re(Ve(n,t,r));return{c(){for(let r=0;r<o.length;r+=1)o[r].c();e=Y()},l(r){for(let i=0;i<o.length;i+=1)o[i].l(r);e=Y()},m(r,i){for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(r,i);A(r,e,i)},p(r,i){if(i[0]&2049){t=R(Object.entries(r[0]).sort(r[16]));let s;for(s=0;s<t.length;s+=1){const a=Ve(r,t,s);o[s]?o[s].p(a,i):(o[s]=Re(a),o[s].c(),o[s].m(e.parentNode,e))}for(;s<o.length;s+=1)o[s].d(1);o.length=t.length}},d(r){r&&m(e),te(o,r)}}}function Dt(n){let e,t="<p>검색 결과가 없습니다.</p>";return{c(){e=y("div"),e.innerHTML=t,this.h()},l(o){e=k(o,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-f17ezd"&&(e.innerHTML=t),this.h()},h(){d(e,"class","flex justify-center items-center h-full text-sm text-[#757D86]")},m(o,r){A(o,e,r)},p:J,d(o){o&&m(e)}}}function At(n){let e,t="<p>이모지 로딩 중...</p>";return{c(){e=y("div"),e.innerHTML=t,this.h()},l(o){e=k(o,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-b733zt"&&(e.innerHTML=t),this.h()},h(){d(e,"class","flex justify-center items-center h-full text-sm text-[#757D86]")},m(o,r){A(o,e,r)},p:J,d(o){o&&m(e)}}}function Ne(n){let e,t=n[35].unicode+"",o,r,i,s,a;function l(){return n[18](n[35])}return{c(){e=y("div"),o=_e(t),r=S(),this.h()},l(c){e=k(c,"DIV",{class:!0,title:!0});var u=E(e);o=ve(u,t),r=P(u),u.forEach(m),this.h()},h(){d(e,"class","h-[2.125rem] pointer-events-auto hover:bg-gray-100 p-1 rounded cursor-pointer text-center text-white text-3xl aspect-square leading-none "),d(e,"title",i=n[35].label)},m(c,u){A(c,e,u),w(e,o),w(e,r),s||(a=T(e,"click",F(q(l)),!0),s=!0)},p(c,u){n=c,u[0]&4&&t!==(t=n[35].unicode+"")&&Ce(o,t),u[0]&4&&i!==(i=n[35].label)&&d(e,"title",i)},d(c){c&&m(e),s=!1,a()}}}function ze(n){let e,t,o,r,i,s=R(n[31]),a=[];for(let l=0;l<s.length;l+=1)a[l]=Fe(Me(n,s,l));return{c(){e=y("hr"),o=S(),r=y("div");for(let l=0;l<a.length;l+=1)a[l].c();i=S(),this.h()},l(l){e=k(l,"HR",{id:!0,class:!0}),o=P(l),r=k(l,"DIV",{class:!0});var c=E(r);for(let u=0;u<a.length;u+=1)a[u].l(c);i=P(c),c.forEach(m),this.h()},h(){d(e,"id",t=n[34]),d(e,"class","opacity-0 h-0 m-0 p-0"),d(r,"class","grid grid-cols-7 gap-x-[0.88rem] gap-y-[0.44rem] mb-[0.44rem] place-items-center")},m(l,c){A(l,e,c),A(l,o,c),A(l,r,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(r,null);w(r,i)},p(l,c){if(c[0]&1&&t!==(t=l[34])&&d(e,"id",t),c[0]&2049){s=R(l[31]);let u;for(u=0;u<s.length;u+=1){const p=Me(l,s,u);a[u]?a[u].p(p,c):(a[u]=Fe(p),a[u].c(),a[u].m(r,i))}for(;u<a.length;u+=1)a[u].d(1);a.length=s.length}},d(l){l&&(m(e),m(o),m(r)),te(a,l)}}}function Fe(n){let e,t=n[35].unicode+"",o,r,i,s;function a(){return n[17](n[35])}return{c(){e=y("div"),o=_e(t),this.h()},l(l){e=k(l,"DIV",{class:!0,title:!0});var c=E(e);o=ve(c,t),c.forEach(m),this.h()},h(){d(e,"class","h-[2.125rem] pointer-events-auto hover:bg-gray-100 p-1 rounded cursor-pointer text-center text-white text-3xl aspect-square leading-none "),d(e,"title",r=n[35].label)},m(l,c){A(l,e,c),w(e,o),i||(s=T(e,"click",F(q(a)),!0),i=!0)},p(l,c){n=l,c[0]&1&&t!==(t=n[35].unicode+"")&&Ce(o,t),c[0]&1&&r!==(r=n[35].label)&&d(e,"title",r)},d(l){l&&m(e),i=!1,s()}}}function Re(n){let e,t=n[31].length>0&&ze(le(n));return{c(){t&&t.c(),e=Y()},l(o){t&&t.l(o),e=Y()},m(o,r){t&&t.m(o,r),A(o,e,r)},p(o,r){o[31].length>0?t?t.p(le(o),r):(t=ze(le(o)),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(o){o&&m(e),t&&t.d(o)}}}function Ue(n){let e,t=R(n[1]),o=[];for(let r=0;r<t.length;r+=1)o[r]=qe(Se(n,t,r));return{c(){e=y("div");for(let r=0;r<o.length;r+=1)o[r].c();this.h()},l(r){e=k(r,"DIV",{class:!0});var i=E(e);for(let s=0;s<o.length;s+=1)o[s].l(i);i.forEach(m),this.h()},h(){d(e,"class","flex items-center justify-between overflow-x-hidden py-1")},m(r,i){A(r,e,i);for(let s=0;s<o.length;s+=1)o[s]&&o[s].m(e,null)},p(r,i){if(i[0]&1042){t=R(r[1]);let s;for(s=0;s<t.length;s+=1){const a=Se(r,t,s);o[s]?o[s].p(a,i):(o[s]=qe(a),o[s].c(),o[s].m(e,null))}for(;s<o.length;s+=1)o[s].d(1);o.length=t.length}},d(r){r&&m(e),te(o,r)}}}function qe(n){let e,t=n[27].label+"",o,r,i,s,a,l;function c(){return n[20](n[27])}return{c(){e=y("div"),o=_e(t),r=S(),this.h()},l(u){e=k(u,"DIV",{class:!0,title:!0});var p=E(e);o=ve(p,t),r=P(p),p.forEach(m),this.h()},h(){d(e,"class",i="cursor-pointer pointer-events-auto text-xl "+(n[4]===n[27].key?"bg-gray-200 rounded":"")),d(e,"title",s=`Group ${n[27].groupIndex}`)},m(u,p){A(u,e,p),w(e,o),w(e,r),a||(l=T(e,"click",F(q(c))),a=!0)},p(u,p){n=u,p[0]&2&&t!==(t=n[27].label+"")&&Ce(o,t),p[0]&18&&i!==(i="cursor-pointer pointer-events-auto text-xl "+(n[4]===n[27].key?"bg-gray-200 rounded":""))&&d(e,"class",i),p[0]&2&&s!==(s=`Group ${n[27].groupIndex}`)&&d(e,"title",s)},d(u){u&&m(e),a=!1,l()}}}function It(n){let e,t,o,r,i,s,a,l='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M6.46558 0.656982C9.67367 0.656982 12.2749 3.25755 12.2751 6.46558C12.2751 7.83381 11.8011 9.09099 11.0095 10.0837L15.1511 14.2253L15.2351 14.3289C15.4027 14.5829 15.3747 14.9275 15.1511 15.1511C14.9275 15.3747 14.5829 15.4027 14.3289 15.2351L14.2253 15.1511L10.0828 11.0085C9.09002 11.8001 7.83379 12.2751 6.46558 12.2751C3.25752 12.2749 0.656982 9.67369 0.656982 6.46558C0.657273 3.25771 3.2577 0.657234 6.46558 0.656982ZM6.46558 1.96558C3.98069 1.96583 1.96587 3.9807 1.96558 6.46558C1.96558 8.9507 3.98051 10.9653 6.46558 10.9656C8.95086 10.9656 10.9656 8.95086 10.9656 6.46558C10.9653 3.98054 8.95068 1.96558 6.46558 1.96558Z" fill="#757D86"></path></svg>',c,u,p,C,L,I,V,O,M,N,G,b=n[3]&&He(n);C=new wt({});function K(g,x){return g[5]?At:g[2].length===0?Dt:g[3]?Et:jt}let z=K(n),B=z(n),f=!n[3]&&Ue(n);return{c(){e=y("div"),t=y("div"),o=y("div"),r=y("div"),i=y("input"),s=S(),a=y("div"),a.innerHTML=l,c=S(),b&&b.c(),u=S(),p=y("div"),ce(C.$$.fragment),L=S(),I=y("div"),B.c(),V=S(),O=y("div"),f&&f.c(),this.h()},l(g){e=k(g,"DIV",{class:!0});var x=E(e);t=k(x,"DIV",{class:!0});var Q=E(t);o=k(Q,"DIV",{class:!0});var W=E(o);r=k(W,"DIV",{class:!0});var U=E(r);i=k(U,"INPUT",{type:!0,class:!0,placeholder:!0}),s=P(U),a=k(U,"DIV",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-1p6fzlx"&&(a.innerHTML=l),c=P(U),b&&b.l(U),U.forEach(m),u=P(W),p=k(W,"DIV",{class:!0});var h=E(p);fe(C.$$.fragment,h),h.forEach(m),W.forEach(m),Q.forEach(m),L=P(x),I=k(x,"DIV",{class:!0});var v=E(I);B.l(v),v.forEach(m),V=P(x),O=k(x,"DIV",{class:!0});var j=E(O);f&&f.l(j),j.forEach(m),x.forEach(m),this.h()},h(){d(i,"type","text"),d(i,"class","w-full py-1.5 pr-8 pl-9 border border-none rounded-lg pointer-events-auto bg-[#DADDE0B2]/70 text-sm text-black placeholder:text-[#757D86] "),d(i,"placeholder","검색"),d(a,"class","absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 pointer-events-auto"),d(r,"class","grow mr-2 relative"),d(p,"class","shrink-0 pointer-events-auto"),d(o,"class","flex items-center justify-between"),d(t,"class","sticky top-0 w-full safe-area-pb py-4 mb-3 px-6 z-10"),d(I,"class","w-full flex-1 px-6 overflow-y-auto "),d(O,"class","sticky bottom-0 w-full bg-[#F6F6F6]/60 safe-area-pb px-6 z-10"),d(e,"class","w-full h-[18.2rem] max-w-[768px] bg-[rgb(246,246,246)]/60 rounded-t-[0.625rem] shadow-xl backdrop-blur-[5.32vh] flex flex-col relative pointer-events-auto ")},m(g,x){A(g,e,x),w(e,t),w(t,o),w(o,r),w(r,i),X(i,n[3]),w(r,s),w(r,a),w(r,c),b&&b.m(r,null),w(o,u),w(o,p),he(C,p,null),w(e,L),w(e,I),B.m(I,null),n[19](I),w(e,V),w(e,O),f&&f.m(O,null),M=!0,N||(G=[T(i,"input",n[14]),T(i,"input",n[8]),T(i,"click",F(q(n[13]))),T(p,"click",F(q(n[15])),!0),T(I,"scroll",n[7]),T(e,"click",F(q(n[12])))],N=!0)},p(g,x){x[0]&8&&i.value!==g[3]&&X(i,g[3]),g[3]?b?b.p(g,x):(b=He(g),b.c(),b.m(r,null)):b&&(b.d(1),b=null),z===(z=K(g))&&B?B.p(g,x):(B.d(1),B=z(g),B&&(B.c(),B.m(I,null))),g[3]?f&&(f.d(1),f=null):f?f.p(g,x):(f=Ue(g),f.c(),f.m(O,null))},i(g){M||(de(C.$$.fragment,g),M=!0)},o(g){pe(C.$$.fragment,g),M=!1},d(g){g&&m(e),b&&b.d(),me(C),B.d(),n[19](null),f&&f.d(),N=!1,Ge(G)}}}function xt(n,e,t){let o={},r=[],i=[],s=[],a="",l=null,c=!0,u,p=new Map,C={},L=[];function I(){setTimeout(()=>{p.clear(),r.forEach(h=>{const v=u.querySelector(`#${h.key}`);v&&p.set(h.key,v.offsetTop-u.offsetTop)}),console.log("동적 카테고리 위치 저장됨:",[...p.entries()])},100)}function V(){if(!u)return;const h=u.scrollTop;let v=null;for(const[j,H]of p.entries())H!==void 0&&h>=H-10&&(v=j);if(v===null&&r.length>0){const j=r[0].key,H=p.get(j);H!==void 0&&h<H&&(v=j)}v!==l&&(t(4,l=v),console.log("스크롤로 카테고리 변경:",l))}function O(){if(!a.trim()){t(2,s=i);return}const h=a.toLowerCase();t(2,s=i.filter(v=>{if(v.unicode.toLowerCase().includes(h)||v.label&&v.label.toLowerCase().includes(h)||v.tags&&v.tags.some(_=>_.toLowerCase().includes(h)))return!0;const j=L.find(_=>_.hexcode===v.hexcode);if(j&&(j.label&&j.label.toLowerCase().includes(h)||j.tags&&j.tags.some(_=>_.toLowerCase().includes(h))))return!0;const H=C[`annotation-${v.hexcode}`];if(H&&H.toLowerCase().includes(h))return!0;const Z=C[`tags-${v.hexcode}`];return!!(Z&&Z.toLowerCase().includes(h))}))}function M(){t(3,a=""),O()}function N(h){if(t(4,l=h),p.has(h)){const v=p.get(h);u.scrollTo({top:v,behavior:"smooth"}),console.log(`저장된 위치로 스크롤: ${h}:`,v)}else console.log(`저장된 위치가 없음: ${h}, 위치 다시 계산`),setTimeout(()=>{const v=u.querySelector(`#category-${h}`);if(v&&u){const j=v.offsetTop-u.offsetTop;u.scrollTo({top:j,behavior:"smooth"}),p.set(h,j),console.log(`위치 계산 및 저장: ${h}:`,j)}},10)}async function G(){try{t(5,c=!0),C=await yt("ko"),console.log("한국어 메시지 로드 완료:",Object.keys(C).length);const h=new Map;(await Le("ko",{compact:!0,flat:!0})).forEach(_=>h.set(_.hexcode,_)),i=(await Le("en",{compact:!0,flat:!0})).map(_=>{const D={..._},ne=h.get(_.hexcode);if(ne&&ne.tags){const oe=new Set([...D.tags||[],...ne.tags||[]]);D.tags=Array.from(oe)}const Ee=C[`annotation-${_.hexcode}`];Ee&&D.label&&(D.label=`${D.label} (${Ee})`);const je=C[`tags-${_.hexcode}`];if(je){const oe=je.split(",").map(re=>re.trim()),De=new Set(D.tags||[]);oe.forEach(re=>De.add(re)),D.tags=Array.from(De)}return D}).sort((_,D)=>_.group===void 0&&D.group===void 0?0:_.group===void 0?1:D.group===void 0?-1:_.group===D.group?(_.order||0)-(D.order||0):_.group-D.group),t(0,o={}),t(1,r=[]);let Z=-1;for(const _ of i)if(_.group!==void 0&&(o[_.group]||t(0,o[_.group]=[],o),o[_.group].push(_),_.group!==Z)){const D=o[_.group][0];D&&D.unicode&&(r.push({key:`group-${_.group}`,label:D.unicode,groupIndex:_.group}),Z=_.group)}console.log("생성된 카테고리 헤더:",r),t(2,s=i),console.log("통합 및 그룹핑된 이모지 로드 완료 (EN 기준):",i.length)}catch(h){console.error("이모지 로딩 오류:",h)}finally{t(5,c=!1),I()}}Ke(()=>{G();const h=()=>{I()};return window.addEventListener("resize",h),()=>{window.removeEventListener("resize",h)}});const b=We();function K(h){ae.call(this,n,h)}function z(h){ae.call(this,n,h)}function B(){a=this.value,t(3,a)}const f=()=>{b("backspace")},g=([h],[v])=>parseInt(h)-parseInt(v),x=h=>{b("emojiClick",{emoji:h})},Q=h=>{b("emojiClick",{emoji:h})};function W(h){ue[h?"unshift":"push"](()=>{u=h,t(6,u)})}return[o,r,s,a,l,c,u,V,O,M,N,b,K,z,B,f,g,x,Q,W,h=>N(h.key)]}class Bt extends be{constructor(e){super(),ye(this,e,xt,It,ge,{},null,[-1,-1])}}function Ot(n){let e,t,o,r,i,s;return{c(){e=y("div"),t=y("textarea"),this.h()},l(a){e=k(a,"DIV",{class:!0});var l=E(e);t=k(l,"TEXTAREA",{class:!0,inputmode:!0}),E(t).forEach(m),l.forEach(m),this.h()},h(){d(t,"class",o="resize-none outline-none ring-0 focus:outline-none focus:ring-0 border-none shadow-none text-white bg-transparent transition-transform duration-300 text-center "+(n[2]==="emoji"&&n[0]?"translate-y-[-125px]":"translate-y-0")+" caret-white w-full mx-12 min-h-6"),d(t,"inputmode",r=n[2]==="emoji"?"none":"text"),xe(t,"text-2xl",n[2]==="emoji"),d(e,"class","flex items-center justify-center h-full")},m(a,l){A(a,e,l),w(e,t),X(t,n[1]),n[12](t),i||(s=[T(t,"input",n[11]),T(t,"click",F(n[10])),T(t,"keydown",n[13]),T(t,"input",n[8])],i=!0)},p(a,l){l&5&&o!==(o="resize-none outline-none ring-0 focus:outline-none focus:ring-0 border-none shadow-none text-white bg-transparent transition-transform duration-300 text-center "+(a[2]==="emoji"&&a[0]?"translate-y-[-125px]":"translate-y-0")+" caret-white w-full mx-12 min-h-6")&&d(t,"class",o),l&4&&r!==(r=a[2]==="emoji"?"none":"text")&&d(t,"inputmode",r),l&2&&X(t,a[1]),l&5&&xe(t,"text-2xl",a[2]==="emoji")},d(a){a&&m(e),n[12](null),i=!1,Ge(s)}}}function Tt(n){let e,t,o,r,i,s,a;return e=new Ye({props:{className:`
    transition-opacity duration-300 
    ${n[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${n[5]?"visible":"invisible"}
  `,$$slots:{default:[Ot]},$$scope:{ctx:n}}}),e.$on("click",n[14]),i=new Bt({}),i.$on("backspace",n[6]),i.$on("emojiClick",n[7]),{c(){ce(e.$$.fragment),t=S(),o=y("div"),r=y("div"),ce(i.$$.fragment),this.h()},l(l){fe(e.$$.fragment,l),t=P(l),o=k(l,"DIV",{class:!0});var c=E(o);r=k(c,"DIV",{class:!0});var u=E(r);fe(i.$$.fragment,u),u.forEach(m),c.forEach(m),this.h()},h(){d(r,"class","transition-transform duration-300 w-full flex justify-center"),d(o,"class",s="fixed bottom-0 left-0 right-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 pointer-events-none "+(n[0]?"translate-y-0":"translate-y-[330px]")+" "+(n[2]==="emoji"&&n[5]?"visible":"invisible"))},m(l,c){he(e,l,c),A(l,t,c),A(l,o,c),w(o,r),he(i,r,null),n[15](r),a=!0},p(l,[c]){const u={};c&33&&(u.className=`
    transition-opacity duration-300 
    ${l[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${l[5]?"visible":"invisible"}
  `),c&2097167&&(u.$$scope={dirty:c,ctx:l}),e.$set(u),(!a||c&37&&s!==(s="fixed bottom-0 left-0 right-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 pointer-events-none "+(l[0]?"translate-y-0":"translate-y-[330px]")+" "+(l[2]==="emoji"&&l[5]?"visible":"invisible")))&&d(o,"class",s)},i(l){a||(de(e.$$.fragment,l),de(i.$$.fragment,l),a=!0)},o(l){pe(e.$$.fragment,l),pe(i.$$.fragment,l),a=!1},d(l){l&&(m(t),m(o)),me(e,l),me(i),n[15](null)}}}function Lt(n){}function St(){}function Pt(n,e,t){let o;Ze(n,se,f=>t(17,o=f));const r=We();let i=null,s=null,{isOpen:a=!1}=e,{type:l="text"}=e,{value:c=""}=e,u;et.subscribe(({isOpen:f,type:g})=>{if(u=o.at(-1),!!u){if(u.ownerIdx!==String(ot())){t(0,a=!1);return}t(0,a=f),t(2,l=g),M(),l==="emoji"?t(1,c=u.emoji||""):t(1,c=u.back||"")}});function p(){l==="emoji"?se.update(f=>(f.at(-1)&&(f.at(-1).emoji=c),f)):l==="text"&&se.update(f=>(f.at(-1)&&(f.at(-1).back=c),f))}let C=!1;function L(){u&&fetch(`${tt}/posts/dots/${u.idx}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${rt()}`,"x-api-version":nt.DOTS},body:JSON.stringify({emojis:u.emoji||"",text:u.back||""})}).then(f=>{f.ok&&console.log("success")})}Ke(()=>{Qe(()=>{},Lt,St)}),$e(()=>{Xe()});async function I(){i&&(i.focus(),await ie(),document.execCommand("delete"))}async function V(f){if(!i)return;const g=f.detail.emoji.unicode;i.focus(),await ie(),document.execCommand("insertText",!1,g)}function O(){i==null||i.focus()}function M(){i&&ie().then(()=>{t(3,i.style.height="auto",i),t(3,i.style.height=i.scrollHeight+"px",i)})}function N(f){ae.call(this,n,f)}function G(){c=this.value,t(1,c)}function b(f){ue[f?"unshift":"push"](()=>{i=f,t(3,i)})}const K=f=>{if(l==="emoji"){if(f.metaKey&&f.key==="k")return;f.preventDefault(),f.stopPropagation()}},z=f=>{f.stopPropagation(),t(0,a=!1)};function B(f){ue[f?"unshift":"push"](()=>{s=f,t(4,s)})}return n.$$set=f=>{"isOpen"in f&&t(0,a=f.isOpen),"type"in f&&t(2,l=f.type),"value"in f&&t(1,c=f.value)},n.$$.update=()=>{n.$$.dirty&2&&c&&p(),n.$$.dirty&3&&(a?t(5,C=!0):(L(),setTimeout(()=>{r("close",c),t(5,C=!1)},300)))},[a,c,l,i,s,C,I,V,M,O,N,G,b,K,z,B]}class Ut extends be{constructor(e){super(),ye(this,e,Pt,Tt,ge,{isOpen:0,type:2,value:1,focusInput:9})}get focusInput(){return this.$$.ctx[9]}}export{Ut as I};
