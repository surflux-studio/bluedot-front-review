import{s as We,e as v,c as b,b as E,f as p,m as h,i as ee,D as fe,k as Ce,E as He,F as Te,G as xe,v as me,a as W,t as _e,g as C,d as pe,p as Oe,H as A,I as F,h as m,J as ge,r as J,K as Ae,j as ve,u as qe,q as be}from"./scheduler.Bw1HVZ4I.js";import{S as Ne,i as Re,t as q,g as Pe,f as Le,b as Q,c as we,a as ye,m as ke,d as Ie}from"./index.B-tLs4nj.js";import{e as $}from"./each.Nm2dZFLC.js";import{g as Xe}from"./entry.BXNUqQsT.js";import{b as oe,c as Be}from"./heic2any.C5mk9rbx.js";import{g as Ge,s as Ue}from"./searchParams.DutnsLNr.js";import{W as Ze}from"./WaterdropImage.C1WF8pTS.js";import{C as Fe}from"./CircleImage.fE3M2leQ.js";import{e as Je}from"./units.qluQ__4t.js";import{p as Ke}from"./stores.DvKb9PLv.js";/* empty css                                             */function Ee(e,s,l){const t=e.slice();return t[31]=s[l],t[32]=s,t[33]=l,t}function Ve(e,s,l){const t=e.slice();return t[34]=s[l],t[36]=l,t}function je(e,s,l){const t=e.slice();return t[34]=s[l],t}function Se(e){let s,l,t,i,o,r,c,n,S,V,j,te,N,P=e[31].display_name+"",K,se,y,k,H,g,T=(e[31].place_name||"")+"",R,X,le,x,D,Y="공유",B,G,z,ie,ne,O=$(e[31].media),a=[];for(let f=0;f<O.length;f+=1)a[f]=ze(je(e,O,f));let u=e[31].media.length>=2&&De(e);function _(){e[11].call(n,e[32],e[33])}j=new Fe({props:{src:e[31].profile_image_url,width:"2rem",strokeColor:"white",strokeWidth:"13"}});function M(){return e[12](e[31])}k=new Ze({props:{src:`https://picsum.photos/50/50/?r=${e[31].place_idx}`,width:"2rem",strokeColor:"white",strokeWidth:"13"}});function re(){return e[13](e[31])}return{c(){s=v("div"),l=v("div"),t=v("div");for(let f=0;f<a.length;f+=1)a[f].c();o=W(),u&&u.c(),r=W(),c=v("div"),n=v("textarea"),S=W(),V=v("div"),we(j.$$.fragment),te=W(),N=v("div"),K=_e(P),se=W(),y=v("div"),we(k.$$.fragment),H=W(),g=v("div"),R=_e(T),le=W(),x=v("div"),D=v("button"),D.textContent=Y,B=W(),this.h()},l(f){s=b(f,"DIV",{class:!0});var d=E(s);l=b(d,"DIV",{class:!0});var I=E(l);t=b(I,"DIV",{class:!0});var ae=E(t);for(let ce=0;ce<a.length;ce+=1)a[ce].l(ae);ae.forEach(p),o=C(I),u&&u.l(I),I.forEach(p),r=C(d),c=b(d,"DIV",{class:!0});var L=E(c);n=b(L,"TEXTAREA",{class:!0,placeholder:!0}),E(n).forEach(p),S=C(L),V=b(L,"DIV",{class:!0});var U=E(V);ye(j.$$.fragment,U),te=C(U),N=b(U,"DIV",{});var w=E(N);K=pe(w,P),w.forEach(p),U.forEach(p),se=C(L),y=b(L,"DIV",{class:!0});var Z=E(y);ye(k.$$.fragment,Z),H=C(Z),g=b(Z,"DIV",{});var de=E(g);R=pe(de,T),de.forEach(p),Z.forEach(p),L.forEach(p),le=C(d),x=b(d,"DIV",{class:!0});var he=E(x);D=b(he,"BUTTON",{class:!0,"data-svelte-h":!0}),Oe(D)!=="svelte-172h23d"&&(D.textContent=Y),he.forEach(p),B=C(d),d.forEach(p),this.h()},h(){var f,d;h(t,"class",i=A(`carousel-track transition-transform ${e[3]?"duration-0":""}`)+" svelte-jyziao"),F(t,"transform",`translateX(${-(((f=e[6])==null?void 0:f.width)??document.body.clientWidth)*e[31].mediaIdx+e[5]}px)`),h(l,"class","carousel-container svelte-jyziao"),h(n,"class","w-full h-auto overflow-scroll py-0 px-1 mb-3 outline-0 focus:outline-none focus:outline-0 focus:ring-0 border-none bg-transparent text-sm text-shadow placeholder:text-white/75 placeholder:text-base box-content  svelte-jyziao"),n.readOnly=e[7]!=="post"&&e[7]!=="patch",h(n,"placeholder",e[7]==="post"||e[7]==="patch"?"✎ 텍스트 입력하기":""),h(V,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-jyziao"),h(y,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-jyziao"),h(c,"class",X=A(`fixed bottom-0 w-full px-4 text-white text-md flex flex-col items-start gap-2 z-[9999] ${e[1]?"":"pb-24"} transition-transform`)+" svelte-jyziao"),F(c,"transform",`translateY(${e[1]}px)`),h(D,"class","bg-yellow-300"),h(x,"class","absolute bottom-20 right-4 z-[9999]"),h(s,"class",G=A(`w-screen h-screen gradient-overlay absolute content-center transition-transform ${e[3]?"duration-0":""}`)+" svelte-jyziao"),F(s,"top",`${e[33]*100}%`),F(s,"transform",`translateY(${-(((d=e[6])==null?void 0:d.height)??document.body.clientHeight)*e[2]+e[4]}px)`)},m(f,d){ee(f,s,d),m(s,l),m(l,t);for(let I=0;I<a.length;I+=1)a[I]&&a[I].m(t,null);m(l,o),u&&u.m(l,null),m(s,r),m(s,c),m(c,n),ge(n,e[31].text),m(c,S),m(c,V),ke(j,V,null),m(V,te),m(V,N),m(N,K),m(c,se),m(c,y),ke(k,y,null),m(y,H),m(y,g),m(g,R),m(s,le),m(s,x),m(x,D),m(s,B),z=!0,ie||(ne=[J(t,"transitionend",e[8],{once:!0}),J(n,"input",_),J(n,"input",ue),J(V,"click",M),J(y,"click",re),J(D,"click",e[14]),J(s,"transitionend",function(){Ae(e[33]===e[2]?e[8]:void 0)&&(e[33]===e[2]?e[8]:void 0).apply(this,arguments)})],ie=!0)},p(f,d){var L,U;if(e=f,d[0]&1){O=$(e[31].media);let w;for(w=0;w<O.length;w+=1){const Z=je(e,O,w);a[w]?a[w].p(Z,d):(a[w]=ze(Z),a[w].c(),a[w].m(t,null))}for(;w<a.length;w+=1)a[w].d(1);a.length=O.length}(!z||d[0]&8&&i!==(i=A(`carousel-track transition-transform ${e[3]?"duration-0":""}`)+" svelte-jyziao"))&&h(t,"class",i),d[0]&97&&F(t,"transform",`translateX(${-(((L=e[6])==null?void 0:L.width)??document.body.clientWidth)*e[31].mediaIdx+e[5]}px)`),e[31].media.length>=2?u?u.p(e,d):(u=De(e),u.c(),u.m(l,null)):u&&(u.d(1),u=null),d[0]&1&&ge(n,e[31].text);const I={};d[0]&1&&(I.src=e[31].profile_image_url),j.$set(I),(!z||d[0]&1)&&P!==(P=e[31].display_name+"")&&ve(K,P);const ae={};d[0]&1&&(ae.src=`https://picsum.photos/50/50/?r=${e[31].place_idx}`),k.$set(ae),(!z||d[0]&1)&&T!==(T=(e[31].place_name||"")+"")&&ve(R,T),(!z||d[0]&2&&X!==(X=A(`fixed bottom-0 w-full px-4 text-white text-md flex flex-col items-start gap-2 z-[9999] ${e[1]?"":"pb-24"} transition-transform`)+" svelte-jyziao"))&&h(c,"class",X),d[0]&2&&F(c,"transform",`translateY(${e[1]}px)`),(!z||d[0]&8&&G!==(G=A(`w-screen h-screen gradient-overlay absolute content-center transition-transform ${e[3]?"duration-0":""}`)+" svelte-jyziao"))&&h(s,"class",G),d[0]&84&&F(s,"transform",`translateY(${-(((U=e[6])==null?void 0:U.height)??document.body.clientHeight)*e[2]+e[4]}px)`)},i(f){z||(q(j.$$.fragment,f),q(k.$$.fragment,f),z=!0)},o(f){Q(j.$$.fragment,f),Q(k.$$.fragment,f),z=!1},d(f){f&&p(s),fe(a,f),u&&u.d(),Ie(j),Ie(k),ie=!1,qe(ne)}}}function ze(e){let s,l,t,i,o;return{c(){s=v("div"),l=v("img"),o=W(),this.h()},l(r){s=b(r,"DIV",{class:!0});var c=E(s);l=b(c,"IMG",{src:!0,alt:!0,class:!0}),o=C(c),c.forEach(p),this.h()},h(){be(l.src,t=e[34])||h(l,"src",t),h(l,"alt",i=e[31].place_name),h(l,"class","w-screen h-screen object-contain"),h(s,"class","carousel-slide svelte-jyziao")},m(r,c){ee(r,s,c),m(s,l),m(s,o)},p(r,c){c[0]&1&&!be(l.src,t=r[34])&&h(l,"src",t),c[0]&1&&i!==(i=r[31].place_name)&&h(l,"alt",i)},d(r){r&&p(s)}}}function De(e){let s,l=$(e[31].media),t=[];for(let i=0;i<l.length;i+=1)t[i]=Ye(Ve(e,l,i));return{c(){s=v("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){s=b(i,"DIV",{class:!0});var o=E(s);for(let r=0;r<t.length;r+=1)t[r].l(o);o.forEach(p),this.h()},h(){h(s,"class","carousel-nav svelte-jyziao")},m(i,o){ee(i,s,o);for(let r=0;r<t.length;r+=1)t[r]&&t[r].m(s,null)},p(i,o){if(o[0]&5){l=$(i[31].media);let r;for(r=0;r<l.length;r+=1){const c=Ve(i,l,r);t[r]?t[r].p(c,o):(t[r]=Ye(c),t[r].c(),t[r].m(s,null))}for(;r<t.length;r+=1)t[r].d(1);t.length=l.length}},d(i){i&&p(s),fe(t,i)}}}function Ye(e){let s,l;return{c(){s=v("span"),this.h()},l(t){s=b(t,"SPAN",{class:!0}),E(s).forEach(p),this.h()},h(){h(s,"class",l=A(`carousel-dot ${e[0][e[2]].mediaIdx===e[36]?"active":""}`)+" svelte-jyziao")},m(t,i){ee(t,s,i)},p(t,i){i[0]&5&&l!==(l=A(`carousel-dot ${t[0][t[2]].mediaIdx===t[36]?"active":""}`)+" svelte-jyziao")&&h(s,"class",l)},d(t){t&&p(s)}}}function Me(e){let s,l,t=e[2]-e[33]<=1&&e[33]-e[2]<=1&&Se(e);return{c(){t&&t.c(),s=me()},l(i){t&&t.l(i),s=me()},m(i,o){t&&t.m(i,o),ee(i,s,o),l=!0},p(i,o){i[2]-i[33]<=1&&i[33]-i[2]<=1?t?(t.p(i,o),o[0]&4&&q(t,1)):(t=Se(i),t.c(),q(t,1),t.m(s.parentNode,s)):t&&(Pe(),Q(t,1,1,()=>{t=null}),Le())},i(i){l||(q(t),l=!0)},o(i){Q(t),l=!1},d(i){i&&p(s),t&&t.d(i)}}}function Qe(e){let s,l,t=$(e[0]),i=[];for(let r=0;r<t.length;r+=1)i[r]=Me(Ee(e,t,r));const o=r=>Q(i[r],1,1,()=>{i[r]=null});return{c(){s=v("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){s=b(r,"DIV",{class:!0});var c=E(s);for(let n=0;n<i.length;n+=1)i[n].l(c);c.forEach(p),this.h()},h(){h(s,"class","bg-black w-screen h-screen")},m(r,c){ee(r,s,c);for(let n=0;n<i.length;n+=1)i[n]&&i[n].m(s,null);l=!0},p(r,c){if(c[0]&511){t=$(r[0]);let n;for(n=0;n<t.length;n+=1){const S=Ee(r,t,n);i[n]?(i[n].p(S,c),q(i[n],1)):(i[n]=Me(S),i[n].c(),q(i[n],1),i[n].m(s,null))}for(Pe(),n=t.length;n<i.length;n+=1)o(n);Le()}},i(r){if(!l){for(let c=0;c<t.length;c+=1)q(i[c]);l=!0}},o(r){i=i.filter(Boolean);for(let c=0;c<i.length;c+=1)Q(i[c]);l=!1},d(r){r&&p(s),fe(i,r)}}}function ue(e){const s=e.target;s.style.height="16px";let l=s.scrollHeight;l>96&&(l=96),s.style.height=`${l}px`}function $e(e,s,l){let t;Ce(e,Ke,a=>l(10,t=a));let i=t.url.searchParams.get("type"),{posts:o=[]}=s,{dontMoveVetically:r=!1}=s,{keyboardY:c=0}=s,n=0,S=!0,V=0;async function j(){Ue({pidx:`${n}`,midx:`${o[n].mediaIdx}`},{replaceState:!0,invalidateAll:!1})}function te(a,u){if(n===0&&a>0){H=u;return}const _=Y.height;l(4,V=a>_?_:a<-_?-_:a)}function N(a){document.querySelectorAll("textarea").forEach(M=>{ue({target:M})});let u=a.changedTouches[0].clientY-H;l(3,S=!1);const _=Y.height;u>_/2&&n!==0?(l(2,n-=1),j()):-u>_/2&&n!==o.length-1&&(l(2,n+=1),j(),o.length-2),l(4,V=0)}let P=0;function K(a){const u=Y.width;a=a>u?u:a<-u?-u:a,a=o[n].mediaIdx===0&&a>0||o[n].mediaIdx===o[n].media.length-1&&a<0?0:a,l(5,P=a)}function se(a){const u=Y.width;l(3,S=!1);let _=a.changedTouches[0].clientX-k;_>u/2&&o[n].mediaIdx!==0?l(0,o[n].mediaIdx-=1,o):-_>u/2&&o[n].mediaIdx!==o[n].media.length-1&&l(0,o[n].mediaIdx+=1,o),l(5,P=0)}let y=!1;Je.on("blockSwipeInViewer",a=>y=a);let k=-1,H=-1,g;function T(a){y||(g=void 0,oe.set(!0),k=a.touches[0].clientX,H=a.touches[0].clientY)}function R(a){if(y)return;let _=a.touches[0].clientX-k;const M=a.touches[0].clientY;let re=M-H;if(g===void 0&&Math.abs(re)-Math.abs(_)>=0&&(g="post"),!r&&g==="post")te(re,M);else{if(g===void 0){const f=o[n].mediaIdx===0&&_>0,d=o[n].mediaIdx===o[n].media.length-1&&_<0,I=k<20||k>Y.width-20;f||d||I?g="else":g="media"}if(g==="else")return oe.set(!1);K(_)}}function X(a){if(!y)return g==="post"?N(a):g==="media"?se(a):oe.set(!1)}function le(){document.addEventListener("touchstart",T),document.addEventListener("touchmove",R),document.addEventListener("touchend",X)}function x(){document.removeEventListener("touchstart",T),document.removeEventListener("touchmove",R),document.removeEventListener("touchend",X)}function D(){l(3,S=!0),oe.set(!1)}let Y;function B(){l(6,Y={width:document.body.clientWidth,height:document.body.clientHeight})}function G(){const a=t.url.searchParams.get("pidx"),u=t.url.searchParams.get("midx"),_=Number(a);a&&_!==n&&o[_]?l(2,n=_):l(2,n=0);const M=Number(u);u&&M!==o[n].mediaIdx&&o[n].media[M]?l(0,o[n].mediaIdx=M,o):l(0,o[n].mediaIdx=0,o),j()}He(async()=>{B(),window.addEventListener("resize",B),le(),G(),await Te(),document.querySelectorAll("textarea").forEach(a=>{ue({target:a})})}),xe(()=>{window.removeEventListener("resize",B),x()});function z(a,u){a[u].text=this.value,l(0,o)}const ie=a=>{a.user_idx&&Ge(`/users/${a.user_idx}`)},ne=a=>{a.place_idx&&Xe(`/places/${a.place_idx}`)},O=()=>{Be.set(!0)};return e.$$set=a=>{"posts"in a&&l(0,o=a.posts),"dontMoveVetically"in a&&l(9,r=a.dontMoveVetically),"keyboardY"in a&&l(1,c=a.keyboardY)},e.$$.update=()=>{e.$$.dirty[0]&1024&&t.url.searchParams.get("pidx")==0&&t.url.searchParams.get("midx")==0&&G()},[o,c,n,S,V,P,Y,i,D,r,t,z,ie,ne,O]}class ft extends Ne{constructor(s){super(),Re(this,s,$e,Qe,We,{posts:0,dontMoveVetically:9,keyboardY:1},null,[-1,-1])}}export{ft as V};
