import{g as S,w as v}from"./entry.PZK0YXEE.js";import{_ as E}from"./preload-helper.D6kgxu3v.js";import{e as Z}from"./emitter.E5P-NQ8u.js";import{a5 as ne}from"./scheduler.C36nLLxS.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */var A;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(A||(A={}));class F extends Error{constructor(e,s,n){super(e),this.message=e,this.code=s,this.data=n}}const oe=t=>{var e,s;return t!=null&&t.androidBridge?"android":!((s=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},ae=t=>{const e=t.CapacitorCustomPlatform||null,s=t.Capacitor||{},n=s.Plugins=s.Plugins||{},o=()=>e!==null?e.name:oe(t),r=()=>o()!=="web",a=l=>{const d=h.get(l);return!!(d!=null&&d.platforms.has(o())||i(l))},i=l=>{var d;return(d=s.PluginHeaders)===null||d===void 0?void 0:d.find(U=>U.name===l)},c=l=>t.console.error(l),h=new Map,j=(l,d={})=>{const U=h.get(l);if(U)return console.warn(`Capacitor plugin "${l}" already registered. Cannot register plugins twice.`),U.proxy;const y=o(),P=i(l);let m;const te=async()=>(!m&&y in d?m=typeof d[y]=="function"?m=await d[y]():m=d[y]:e!==null&&!m&&"web"in d&&(m=typeof d.web=="function"?m=await d.web():m=d.web),m),se=(u,f)=>{var g,w;if(P){const b=P==null?void 0:P.methods.find(p=>f===p.name);if(b)return b.rtype==="promise"?p=>s.nativePromise(l,f.toString(),p):(p,I)=>s.nativeCallback(l,f.toString(),p,I);if(u)return(g=u[f])===null||g===void 0?void 0:g.bind(u)}else{if(u)return(w=u[f])===null||w===void 0?void 0:w.bind(u);throw new F(`"${l}" plugin is not implemented on ${y}`,A.Unimplemented)}},M=u=>{let f;const g=(...w)=>{const b=te().then(p=>{const I=se(p,u);if(I){const $=I(...w);return f=$==null?void 0:$.remove,$}else throw new F(`"${l}.${u}()" is not implemented on ${y}`,A.Unimplemented)});return u==="addListener"&&(b.remove=async()=>f()),b};return g.toString=()=>`${u.toString()}() { [capacitor code] }`,Object.defineProperty(g,"name",{value:u,writable:!1,configurable:!1}),g},J=M("addListener"),K=M("removeListener"),re=(u,f)=>{const g=J({eventName:u},f),w=async()=>{const p=await g;K({eventName:u,callbackId:p},f)},b=new Promise(p=>g.then(()=>p({remove:w})));return b.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await w()},b},B=new Proxy({},{get(u,f){switch(f){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return P?re:J;case"removeListener":return K;default:return M(f)}}});return n[l]=B,h.set(l,{name:l,proxy:B,platforms:new Set([...Object.keys(d),...P?[y]:[]])}),B};return s.convertFileSrc||(s.convertFileSrc=l=>l),s.getPlatform=o,s.handleError=c,s.isNativePlatform=r,s.isPluginAvailable=a,s.registerPlugin=j,s.Exception=F,s.DEBUG=!!s.DEBUG,s.isLoggingEnabled=!!s.isLoggingEnabled,s},ie=t=>t.Capacitor=ae(t),k=ie(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),L=k.registerPlugin;class N{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,s){let n=!1;this.listeners[e]||(this.listeners[e]=[],n=!0),this.listeners[e].push(s);const r=this.windowListeners[e];r&&!r.registered&&this.addWindowListener(r),n&&this.sendRetainedArgumentsForEvent(e);const a=async()=>this.removeListener(e,s);return Promise.resolve({remove:a})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,n){const o=this.listeners[e];if(!o){if(n){let r=this.retainedEventArguments[e];r||(r=[]),r.push(s),this.retainedEventArguments[e]=r}return}o.forEach(r=>r(s))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:n=>{this.notifyListeners(s,n)}}}unimplemented(e="not implemented"){return new k.Exception(e,A.Unimplemented)}unavailable(e="not available"){return new k.Exception(e,A.Unavailable)}async removeListener(e,s){const n=this.listeners[e];if(!n)return;const o=n.indexOf(s);this.listeners[e].splice(o,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(n=>{this.notifyListeners(e,n)}))}}const V=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),z=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class ce extends N{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(n=>{if(n.length<=0)return;let[o,r]=n.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");o=z(o).trim(),r=z(r).trim(),s[o]=r}),s}async setCookie(e){try{const s=V(e.key),n=V(e.value),o=`; expires=${(e.expires||"").replace("expires=","")}`,r=(e.path||"/").replace("path=",""),a=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${n||""}${o}; path=${r}; ${a};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}L("CapacitorCookies",{web:()=>new ce});const le=async t=>new Promise((e,s)=>{const n=new FileReader;n.onload=()=>{const o=n.result;e(o.indexOf(",")>=0?o.split(",")[1]:o)},n.onerror=o=>s(o),n.readAsDataURL(t)}),de=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(o=>o.toLocaleLowerCase()).reduce((o,r,a)=>(o[r]=t[e[a]],o),{})},ue=(t,e=!0)=>t?Object.entries(t).reduce((n,o)=>{const[r,a]=o;let i,c;return Array.isArray(a)?(c="",a.forEach(h=>{i=e?encodeURIComponent(h):h,c+=`${r}=${i}&`}),c.slice(0,-1)):(i=e?encodeURIComponent(a):a,c=`${r}=${i}`),`${n}&${c}`},"").substr(1):null,fe=(t,e={})=>{const s=Object.assign({method:t.method||"GET",headers:t.headers},e),o=de(t.headers)["content-type"]||"";if(typeof t.data=="string")s.body=t.data;else if(o.includes("application/x-www-form-urlencoded")){const r=new URLSearchParams;for(const[a,i]of Object.entries(t.data||{}))r.set(a,i);s.body=r.toString()}else if(o.includes("multipart/form-data")||t.data instanceof FormData){const r=new FormData;if(t.data instanceof FormData)t.data.forEach((i,c)=>{r.append(c,i)});else for(const i of Object.keys(t.data))r.append(i,t.data[i]);s.body=r;const a=new Headers(s.headers);a.delete("content-type"),s.headers=a}else(o.includes("application/json")||typeof t.data=="object")&&(s.body=JSON.stringify(t.data));return s};class pe extends N{async request(e){const s=fe(e,e.webFetchExtra),n=ue(e.params,e.shouldEncodeUrlParams),o=n?`${e.url}?${n}`:e.url,r=await fetch(o,s),a=r.headers.get("content-type")||"";let{responseType:i="text"}=r.ok?e:{};a.includes("application/json")&&(i="json");let c,h;switch(i){case"arraybuffer":case"blob":h=await r.blob(),c=await le(h);break;case"json":c=await r.json();break;case"document":case"text":default:c=await r.text()}const j={};return r.headers.forEach((l,d)=>{j[d]=l}),{data:c,headers:j,status:r.status,url:r.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}L("CapacitorHttp",{web:()=>new pe});const q=L("SocialLogin",{web:()=>E(()=>import("./web.B741FzKC.js"),[],import.meta.url).then(t=>new t.SocialLoginWeb)}),ge=L("Device",{web:()=>E(()=>import("./web.BnHrwOYm.js"),[],import.meta.url).then(t=>new t.DeviceWeb)}),he=L("App",{web:()=>E(()=>import("./web.DmEZpHTc.js"),[],import.meta.url).then(t=>new t.AppWeb)}),me=k.isNativePlatform();let C;async function we(){return C||(C=await ge.getInfo(),C)}let _;async function Ae(){if(_)return _;if(me)_="mobile";else{const t=await we();["ios","android"].includes(t.operatingSystem)?_="mobile":_="pc"}return _}let O;async function Se(){O||(O=await he.addListener("appUrlOpen",t=>{const e=new URL(t.url),s=`${e.pathname}${e.search}`;S(s,{replaceState:!0,invalidateAll:!0}),O==null||O.remove(),O=void 0}))}const be="https://basemap.surflux.studio/geoserver",ke=`${be}/gwc/service/tms/1.0.0/bluedot:base_building@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf`,je="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_railway_900913_241127.json",Ue="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_station_900913_241127.json",Ie="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_entrance_900913_241127.json";var Y=(t=>(t[t.MobileS=320]="MobileS",t[t.MobileM=375]="MobileM",t[t.MobileL=425]="MobileL",t[t.Tablet=768]="Tablet",t[t.Laptop=1024]="Laptop",t[t.LaptopL=1440]="LaptopL",t[t.FourK=2560]="FourK",t))(Y||{});const x="https://api.bluedot.land",$e="https://d1egcbbnpo4gtd.cloudfront.net",Ce={POST:"1",BOX:"0",PLACE:"0",EMBEDDING:"0",DOTS:"1"},xe="1/1.585",De=v(void 0),Ee=v(Y.MobileM),R=v(!1),ye=v(!0),Te=v(!1),We=v([]),Me=v({isOpen:!1}),G=L("SecureStoragePlugin",{web:()=>E(()=>import("./web.Cv_0nJmJ.js"),[],import.meta.url).then(t=>new t.SecureStoragePluginWeb)}),D=k.getPlatform(),T=D==="ios"||D==="android";async function Be(){q.initialize({google:{iOSClientId:"298551622119-6r1e3ji2e6vdioqarf2pg3g6brvd47od.apps.googleusercontent.com",webClientId:"298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com"},apple:{}})}async function Fe(t){var e;if(T){const n=(await q.login({provider:"google",options:{scopes:["email","profile"],forcePrompt:!0}})).result,r=await(await fetch(`${x}/auth/social/user`,{method:"POST",body:JSON.stringify({name:n.profile.name,email:n.profile.email,picture:n.profile.imageUrl,provider:"google",keepSignin:t})})).json();if(!((e=r==null?void 0:r.data)!=null&&e.access))throw Z.emit("pushSnackbar",{message:"로그인에 실패했습니다."}),Error("Failed to sign in");W(r.data.access,r.data.refresh)}else if(D==="web"){const s="298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com",n=`${x}/auth/oauth/google`,o="email profile",r="code",a=new URL(window.location.href);a.searchParams.set("keepSignin",t.toString());const i=a.toString(),c=new URL("https://accounts.google.com/o/oauth2/v2/auth");c.searchParams.set("response_type",r),c.searchParams.set("client_id",s),c.searchParams.set("redirect_uri",n),c.searchParams.set("scope",o),c.searchParams.set("state",i),c.searchParams.set("prompt","select_account"),location.replace(c)}else throw Error("Not supported platform")}async function Re(t){var i;if(D!=="ios")return;const s=(await q.login({provider:"apple",options:{}})).result;let n=s.profile.givenName??"";s.profile.familyName&&(n+=(n?" ":"")+s.profile.familyName);let o=s.profile.email;const a=await(await fetch(`${x}/auth/social/apple`,{method:"POST",body:JSON.stringify({name:n,email:o,providerId:s.profile.user,keepSignin:t})})).json();if(!((i=a==null?void 0:a.data)!=null&&i.access))throw Z.emit("pushSnackbar",{message:"로그인에 실패했습니다."}),Error("Failed to sign in");W(a.data.access,a.data.refresh)}function qe(){sessionStorage.removeItem("jwt"),T&&G.clear()}function ee(){try{const t=sessionStorage.getItem("jwt")||null;if(!t)throw new Error("jwt not found");if(ne(R)===!0&&!window.location.pathname.startsWith("/users/sign-up/")&&!window.location.pathname.startsWith("/tp/"))return console.log("A"),S("/users/sign-up/agreement"),null;const e=H(t);if(e.exp&&Math.floor(Date.now()/1e3)>e.exp)throw ye.set(!0),new Error("jwt expired");return e.sig===!1&&!window.location.pathname.startsWith("/users/sign-up")&&!window.location.pathname.startsWith("/tp")?(R.set(!0),S("/users/sign-up/agreement"),null):t}catch(t){return console.warn(t),sessionStorage.removeItem("jwt"),null}}function ve(){const t=ee();return t?H(t):null}function Ge(){const t=ve();return t?BigInt(t.sub):null}function W(t,e){sessionStorage.setItem("jwt",t),T&&e&&G.set({key:"refresh",value:e})}async function He(){const t={credentials:"include"};if(T)try{const e=await G.get({key:"refresh"});if(!e.value)return!1;t.headers={Authorization:`Bearer ${e.value}`}}catch{return!1}try{const e=await fetch(`${x}/auth/token/refresh`,t);if(!e.ok)throw new Error("Failed to refresh token");const s=await e.json();return W(s.data.access,s.data.refresh),!0}catch{return!1}}async function Je(t){const e=t.searchParams.get("access");if(e){W(e);const s=H(e).sig;if(t.searchParams.delete("access"),s===!1){R.set(!0),await S("/users/sign-up/agreement");return}await S(t.toString(),{replaceState:!0,invalidateAll:!1})}}function H(t){const s=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(s).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(n)}function Ke(){return ee()!==null}var X;(function(t){t.Dark="DARK",t.Light="LIGHT",t.Default="DEFAULT"})(X||(X={}));var Q;(function(t){t.Body="body",t.Ionic="ionic",t.Native="native",t.None="none"})(Q||(Q={}));const Ve=L("Keyboard");export{x as A,k as C,be as G,Ve as K,ke as P,Y as S,N as W,Me as a,Ee as b,Se as c,Fe as d,Re as e,Ke as f,Ge as g,Je as h,me as i,Ae as j,ye as k,He as l,Be as m,Te as n,xe as o,F as p,Ce as q,L as r,We as s,ee as t,qe as u,De as v,je as w,Ue as x,Ie as y,$e as z};
