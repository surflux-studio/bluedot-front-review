import{s as Je,e as Y,c as A,b as H,f as y,q as m,i as Q,r as N,z as Qe,I as ge,k as $e,o as et,N as tt,l as st,w as ve,E as nt,a as Z,t as Se,g as F,d as Te,v as re,h as M,O as we,j as We,D as Re,K as be,P as Ie,y as lt}from"./scheduler.BnheM4g2.js";import{S as rt,i as ot,t as q,g as pe,f as _e,b as J,c as je,a as qe,m as Oe,d as ze}from"./index.CP53dWnj.js";import{e as oe}from"./each.B4pMeuX4.js";import{e as at,A as it,d as me,r as Ee}from"./Header.BCFYnwU0.js";import{g as ct}from"./entry.W3sjn9Cn.js";import{u as ut,g as ft}from"./searchParams.DKgNtSzN.js";import{W as dt}from"./WaterdropImage.B2tgz0zb.js";import{C as ht}from"./CircleImage.B02Dd2sW.js";import{p as mt}from"./stores.BwZnzf5s.js";import"./index.B9Q_Ya9a.js";import{s as de}from"./s32cloudfront.B8qU7lVk.js";/* empty css                                             */function gt(t){const s=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(o=>{const i=e=>e.stopPropagation();return t.addEventListener(o,i),{event:o,handler:i}});return{destroy(){s.forEach(({event:o,handler:i})=>{t.removeEventListener(o,i)})}}}function ye(t,n,s){const o=t.slice();return o[46]=n[s],o[47]=n,o[48]=s,o}function ke(t,n,s){const o=t.slice();return o[49]=n[s],o[51]=s,o}function xe(t,n,s){const o=t.slice();return o[52]=n[s],o}function Me(t){var R,j;let n,s,o,i,e,a,f,l,d,u,h,b,L,V,O=(t[46].place_name||"")+"",G,te,k,ae,se,ne,P,z,K,S=oe(t[46].media),p=[];for(let v=0;v<S.length;v+=1)p[v]=Le(xe(t,S,v));let I=t[46].media.length>1&&De(t),E=(t[7]==="post"||t[7]==="patch"||((j=(R=t[46])==null?void 0:R.text)==null?void 0:j.length)>0)&&Ae(t),_=t[46].user_idx&&Pe(t);b=new dt({props:{src:"/graydot.png",width:"2rem",strokeColor:"white",strokeWidth:"13"}});function le(){return t[21](t[46])}return{c(){n=Y("div"),s=Y("div"),o=Y("div");for(let v=0;v<p.length;v+=1)p[v].c();a=Z(),f=Y("div"),I&&I.c(),l=Z(),E&&E.c(),d=Z(),_&&_.c(),u=Z(),h=Y("div"),je(b.$$.fragment),L=Z(),V=Y("div"),G=Se(O),ae=Z(),this.h()},l(v){n=A(v,"DIV",{class:!0,style:!0});var w=H(n);s=A(w,"DIV",{class:!0});var D=H(s);o=A(D,"DIV",{class:!0,style:!0});var $=H(o);for(let ie=0;ie<p.length;ie+=1)p[ie].l($);$.forEach(y),D.forEach(y),a=F(w),f=A(w,"DIV",{class:!0,style:!0});var g=H(f);I&&I.l(g),l=F(g),E&&E.l(g),d=F(g),_&&_.l(g),u=F(g),h=A(g,"DIV",{class:!0});var B=H(h);qe(b.$$.fragment,B),L=F(B),V=A(B,"DIV",{});var fe=H(V);G=Te(fe,O),fe.forEach(y),B.forEach(y),g.forEach(y),ae=F(w),w.forEach(y),this.h()},h(){m(o,"class",i=re(`carousel-track transition-transform ${t[3]?"duration-0":""}`)+" svelte-1xgvwrg"),m(o,"style",e=`transform: translateX(${-t[46].mediaIdx*t[6].width+t[5]}px);`),m(s,"class","carousel-container svelte-1xgvwrg"),m(h,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-1xgvwrg"),m(f,"class",te=re(`fixed bottom-0 w-full px-4 text-white text-md flex flex-col items-start gap-2 z-40 
            ${t[2]?"":"pb-24"} 
           transition-transform`)+" svelte-1xgvwrg"),m(f,"style",k=`transform: translateY(${t[2]}px);`),m(n,"class",se=re(`w-full h-full gradient-overlay absolute content-center transition-transform ${t[3]?"duration-0":""}`)+" svelte-1xgvwrg"),m(n,"style",ne=`top: 0; transform: translateY(${(t[48]-t[1])*t[6].height+t[4]}px);`)},m(v,w){Q(v,n,w),M(n,s),M(s,o);for(let D=0;D<p.length;D+=1)p[D]&&p[D].m(o,null);M(n,a),M(n,f),I&&I.m(f,null),M(f,l),E&&E.m(f,null),M(f,d),_&&_.m(f,null),M(f,u),M(f,h),Oe(b,h,null),M(h,L),M(h,V),M(V,G),M(n,ae),P=!0,z||(K=[N(o,"transitionend",function(){we(t[46].mediaIdx===t[0][t[1]].mediaIdx?t[9]:void 0)&&(t[46].mediaIdx===t[0][t[1]].mediaIdx?t[9]:void 0).apply(this,arguments)}),N(h,"click",le),N(n,"transitionend",function(){we(t[48]===t[1]?t[9]:void 0)&&(t[48]===t[1]?t[9]:void 0).apply(this,arguments)})],z=!0)},p(v,w){var D,$;if(t=v,w[0]&1){S=oe(t[46].media);let g;for(g=0;g<S.length;g+=1){const B=xe(t,S,g);p[g]?p[g].p(B,w):(p[g]=Le(B),p[g].c(),p[g].m(o,null))}for(;g<p.length;g+=1)p[g].d(1);p.length=S.length}(!P||w[0]&8&&i!==(i=re(`carousel-track transition-transform ${t[3]?"duration-0":""}`)+" svelte-1xgvwrg"))&&m(o,"class",i),(!P||w[0]&97&&e!==(e=`transform: translateX(${-t[46].mediaIdx*t[6].width+t[5]}px);`))&&m(o,"style",e),t[46].media.length>1?I?I.p(t,w):(I=De(t),I.c(),I.m(f,l)):I&&(I.d(1),I=null),t[7]==="post"||t[7]==="patch"||(($=(D=t[46])==null?void 0:D.text)==null?void 0:$.length)>0?E?E.p(t,w):(E=Ae(t),E.c(),E.m(f,d)):E&&(E.d(1),E=null),t[46].user_idx?_?(_.p(t,w),w[0]&1&&q(_,1)):(_=Pe(t),_.c(),q(_,1),_.m(f,u)):_&&(pe(),J(_,1,1,()=>{_=null}),_e()),(!P||w[0]&1)&&O!==(O=(t[46].place_name||"")+"")&&We(G,O),(!P||w[0]&4&&te!==(te=re(`fixed bottom-0 w-full px-4 text-white text-md flex flex-col items-start gap-2 z-40 
            ${t[2]?"":"pb-24"} 
           transition-transform`)+" svelte-1xgvwrg"))&&m(f,"class",te),(!P||w[0]&4&&k!==(k=`transform: translateY(${t[2]}px);`))&&m(f,"style",k),(!P||w[0]&8&&se!==(se=re(`w-full h-full gradient-overlay absolute content-center transition-transform ${t[3]?"duration-0":""}`)+" svelte-1xgvwrg"))&&m(n,"class",se),(!P||w[0]&82&&ne!==(ne=`top: 0; transform: translateY(${(t[48]-t[1])*t[6].height+t[4]}px);`))&&m(n,"style",ne)},i(v){P||(q(_),q(b.$$.fragment,v),P=!0)},o(v){J(_),J(b.$$.fragment,v),P=!1},d(v){v&&y(n),ge(p,v),I&&I.d(),E&&E.d(),_&&_.d(),ze(b),z=!1,Re(K)}}}function Le(t){let n,s,o,i,e;return{c(){n=Y("div"),s=Y("img"),e=Z(),this.h()},l(a){n=A(a,"DIV",{class:!0});var f=H(n);s=A(f,"IMG",{src:!0,alt:!0,class:!0,draggable:!0}),e=F(f),f.forEach(y),this.h()},h(){be(s.src,o=de(t[52]))||m(s,"src",o),m(s,"alt",i=t[46].place_name),m(s,"class","w-full h-full object-contain svelte-1xgvwrg"),m(s,"draggable","false"),m(n,"class","carousel-slide svelte-1xgvwrg")},m(a,f){Q(a,n,f),M(n,s),M(n,e)},p(a,f){f[0]&1&&!be(s.src,o=de(a[52]))&&m(s,"src",o),f[0]&1&&i!==(i=a[46].place_name)&&m(s,"alt",i)},d(a){a&&y(n)}}}function De(t){let n,s=oe(t[46].media),o=[];for(let i=0;i<s.length;i+=1)o[i]=Ye(ke(t,s,i));return{c(){n=Y("div");for(let i=0;i<o.length;i+=1)o[i].c();this.h()},l(i){n=A(i,"DIV",{class:!0});var e=H(n);for(let a=0;a<o.length;a+=1)o[a].l(e);e.forEach(y),this.h()},h(){m(n,"class","carousel-nav svelte-1xgvwrg")},m(i,e){Q(i,n,e);for(let a=0;a<o.length;a+=1)o[a]&&o[a].m(n,null)},p(i,e){if(e[0]&1){s=oe(i[46].media);let a;for(a=0;a<s.length;a+=1){const f=ke(i,s,a);o[a]?o[a].p(f,e):(o[a]=Ye(f),o[a].c(),o[a].m(n,null))}for(;a<o.length;a+=1)o[a].d(1);o.length=s.length}},d(i){i&&y(n),ge(o,i)}}}function Ye(t){let n,s;return{c(){n=Y("span"),this.h()},l(o){n=A(o,"SPAN",{class:!0}),H(n).forEach(y),this.h()},h(){m(n,"class",s="carousel-dot "+(t[46].mediaIdx===t[51]?"active":"")+" svelte-1xgvwrg")},m(o,i){Q(o,n,i)},p(o,i){i[0]&1&&s!==(s="carousel-dot "+(o[46].mediaIdx===o[51]?"active":"")+" svelte-1xgvwrg")&&m(n,"class",s)},d(o){o&&y(n)}}}function Ae(t){let n,s,o;function i(){t[18].call(n,t[47],t[48])}return{c(){n=Y("textarea"),this.h()},l(e){n=A(e,"TEXTAREA",{class:!0,placeholder:!0}),H(n).forEach(y),this.h()},h(){m(n,"class","w-full h-auto overflow-scroll py-0 px-1 mb-3 outline-0 focus:outline-none focus:ring-0 border-none bg-transparent text-sm text-shadow placeholder:text-white/75 placeholder:text-base box-content read-only:cursor-pointer  svelte-1xgvwrg"),n.readOnly=t[7]!=="post"&&t[7]!=="patch",m(n,"placeholder",t[7]==="post"||t[7]==="patch"?"✎ 텍스트 입력하기":"")},m(e,a){Q(e,n,a),Ie(n,t[46].text),s||(o=[N(n,"input",i),lt(gt.call(null,n)),N(n,"input",t[19]),N(n,"click",t[10]),N(n,"focus",t[11]),N(n,"blur",t[12])],s=!0)},p(e,a){t=e,a[0]&1&&Ie(n,t[46].text)},d(e){e&&y(n),s=!1,Re(o)}}}function Pe(t){let n,s,o,i,e=t[46].unique_name+"",a,f,l,d;s=new ht({props:{src:de(t[46].profile_image_url,500),width:"2rem",strokeColor:"white",strokeWidth:"13"}});function u(){return t[20](t[46])}return{c(){n=Y("div"),je(s.$$.fragment),o=Z(),i=Y("div"),a=Se(e),this.h()},l(h){n=A(h,"DIV",{class:!0});var b=H(n);qe(s.$$.fragment,b),o=F(b),i=A(b,"DIV",{});var L=H(i);a=Te(L,e),L.forEach(y),b.forEach(y),this.h()},h(){m(n,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-1xgvwrg")},m(h,b){Q(h,n,b),Oe(s,n,null),M(n,o),M(n,i),M(i,a),f=!0,l||(d=N(n,"click",u),l=!0)},p(h,b){t=h;const L={};b[0]&1&&(L.src=de(t[46].profile_image_url,500)),s.$set(L),(!f||b[0]&1)&&e!==(e=t[46].unique_name+"")&&We(a,e)},i(h){f||(q(s.$$.fragment,h),f=!0)},o(h){J(s.$$.fragment,h),f=!1},d(h){h&&y(n),ze(s),l=!1,d()}}}function Xe(t){let n=Math.abs(t[1]-t[48])<=1,s,o,i=n&&Me(t);return{c(){i&&i.c(),s=ve()},l(e){i&&i.l(e),s=ve()},m(e,a){i&&i.m(e,a),Q(e,s,a),o=!0},p(e,a){a[0]&2&&(n=Math.abs(e[1]-e[48])<=1),n?i?(i.p(e,a),a[0]&2&&q(i,1)):(i=Me(e),i.c(),q(i,1),i.m(s.parentNode,s)):i&&(pe(),J(i,1,1,()=>{i=null}),_e())},i(e){o||(q(i),o=!0)},o(e){J(i),o=!1},d(e){e&&y(s),i&&i.d(e)}}}function pt(t){let n,s,o,i,e=oe(t[0]),a=[];for(let l=0;l<e.length;l+=1)a[l]=Xe(ye(t,e,l));const f=l=>J(a[l],1,1,()=>{a[l]=null});return{c(){n=Y("div");for(let l=0;l<a.length;l+=1)a[l].c();this.h()},l(l){n=A(l,"DIV",{class:!0});var d=H(n);for(let u=0;u<a.length;u+=1)a[u].l(d);d.forEach(y),this.h()},h(){m(n,"class","bg-black w-screen h-screen")},m(l,d){Q(l,n,d);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(n,null);s=!0,o||(i=N(n,"contextmenu",Qe(t[17])),o=!0)},p(l,d){if(d[0]&8191){e=oe(l[0]);let u;for(u=0;u<e.length;u+=1){const h=ye(l,e,u);a[u]?(a[u].p(h,d),q(a[u],1)):(a[u]=Xe(h),a[u].c(),q(a[u],1),a[u].m(n,null))}for(pe(),u=e.length;u<a.length;u+=1)f(u);_e()}},i(l){if(!s){for(let d=0;d<e.length;d+=1)q(a[d]);s=!0}},o(l){a=a.filter(Boolean);for(let d=0;d<a.length;d+=1)J(a[d]);s=!1},d(l){l&&y(n),ge(a,l),o=!1,i()}}}const _t=30,vt=10,He=10,Ve=300;function ue(t){return"touches"in t||"changedTouches"in t}function wt(t,n,s){let o;$e(t,mt,r=>s(16,o=r));let i=o.url.searchParams.get("type"),{posts:e=[]}=n,{dontMoveVertically:a=!1}=n,{keyboardY:f=0}=n,{index:l=0}=n,d=!0,u=!1,h=!1,b=0,L=0,V={width:0,height:0},O=!1,G=!1;async function te(){s(14,O=!0);const r=o.url.searchParams.get("userIdx"),c=o.url.searchParams.get("placeIdx"),x=e.length,T=_t,W=r?`&userIdx=${r}`:"",C=c?`&placeIdx=${c}`:"",ce=`&offset=${x}`,ee=`&limit=${T}`,U=(await fetch(`${it}/posts?${W}${C}${ce}${ee}`).then(X=>X.json()).then(X=>X.data)).map(X=>({...X,mediaIdx:0}));U.length===0&&s(15,G=!0),s(0,e=[...e,...U]),s(14,O=!1)}async function k(){ut({mediaIdx:`${e[l].mediaIdx}`,postIdx:`${e[l].idx}`},{replace:!0})}function ae(r){const c=V.height;if(l===0&&r>0){s(4,b=r*.3);return}if(l===e.length-1&&r<0){s(4,b=r*.3);return}s(4,b=Math.max(Math.min(r,c),-c))}function se(r){document.querySelectorAll("textarea").forEach(T=>{g({target:T})}),s(3,d=!1),V.height;let c=0;ue(r)?c=r.changedTouches[0].clientY-S:c=r.clientY-S;const x=Ee(2);c>x&&l>0?(s(1,l-=1),u=!0,k()):-c>x&&l<e.length-1&&(s(1,l+=1),u=!0,k()),s(4,b=0)}function ne(r){const c=V.width;if(r=Math.max(Math.min(r,c),-c),e[l].mediaIdx===0&&r>0||e[l].mediaIdx===e[l].media.length-1&&r<0){s(5,L=r*.3);return}s(5,L=r)}function P(r){V.width,s(3,d=!1);let c=0;ue(r)?c=r.changedTouches[0].clientX-K:c=r.clientX-K;const x=Ee(2);if(c>x&&e[l].mediaIdx>0){const T=e[l].mediaIdx-1;s(0,e[l]={...e[l],mediaIdx:T},e),s(0,e=[...e]),h=!0,k()}else if(-c>x&&e[l].mediaIdx<e[l].media.length-1){const T=e[l].mediaIdx+1;s(0,e[l]={...e[l],mediaIdx:T},e),s(0,e=[...e]),h=!0,k()}s(5,L=0)}let z=!1,K=-1,S=-1,p,I=!1;at.on("blockSwipeInViewer",r=>z=r);function E(r){z||u||h||(I=!0,p=void 0,me.set(!0),ue(r)?(K=r.touches[0].clientX,S=r.touches[0].clientY):(K=r.clientX,S=r.clientY,window.addEventListener("mousemove",_,{passive:!1}),window.addEventListener("mouseup",le)))}function _(r){if(z||!I||u||h)return;let c=0,x=0;ue(r)?(c=r.touches[0].clientX,x=r.touches[0].clientY):(c=r.clientX,x=r.clientY);let T=c-K,W=x-S;p===void 0&&(p=Math.abs(W)>=Math.abs(T)?"post":"media"),!a&&p==="post"?ae(W):p==="media"&&ne(T)}function le(r){z||!I||u||h||(I=!1,p==="post"?se(r):p==="media"?P(r):me.set(!1),ue(r)||(window.removeEventListener("mousemove",_),window.removeEventListener("mouseup",le)))}let R=[],j=[];function v(r){if(z||u||h)return;r.preventDefault();const c=Date.now(),x=Math.abs(r.deltaX),T=Math.abs(r.deltaY);if(x>T){if(j.push({deltaX:r.deltaX,timestamp:c}),j=j.filter(W=>c-W.timestamp<=Ve),j.length>=2){const W=j[0],C=j[j.length-1],ce=Math.abs(W.deltaX),ee=Math.abs(C.deltaX),U=ee-ce;if(U<0)return;if(U>=0&&ee>=He){let X=!1;if(C.deltaX>0&&e[l].mediaIdx<e[l].media.length-1){const he=e[l].mediaIdx+1;s(0,e[l]={...e[l],mediaIdx:he},e),s(0,e=[...e]),s(3,d=!1),k(),X=!0}else if(C.deltaX<0&&e[l].mediaIdx>0){const he=e[l].mediaIdx-1;s(0,e[l]={...e[l],mediaIdx:he},e),s(0,e=[...e]),s(3,d=!1),k(),X=!0}j=[],X&&(h=!0)}}}else if(R.push({deltaY:r.deltaY,timestamp:c}),R=R.filter(W=>c-W.timestamp<=Ve),R.length>=2){const W=R[0],C=R[R.length-1],ce=Math.abs(W.deltaY),ee=Math.abs(C.deltaY),U=ee-ce;if(U<0)return;if(U>=0&&ee>=He){let X=!1;C.deltaY>0&&l<e.length-1?(s(3,d=!1),s(1,l+=1),k(),X=!0):C.deltaY<0&&l>0&&(s(3,d=!1),s(1,l-=1),k(),X=!0),R=[],X&&(u=!0)}}}function w(r){if(!(z||u||h))switch(r.key){case"ArrowUp":l>0&&(s(3,d=!1),s(1,l-=1),u=!0,k());break;case"ArrowDown":l<e.length-1&&(s(3,d=!1),s(1,l+=1),u=!0,k());break;case"ArrowLeft":if(e[l].mediaIdx>0){const c=e[l].mediaIdx-1;s(0,e[l]={...e[l],mediaIdx:c},e),s(0,e=[...e]),s(3,d=!1),h=!0,k()}break;case"ArrowRight":if(e[l].mediaIdx<e[l].media.length-1){const c=e[l].mediaIdx+1;s(0,e[l]={...e[l],mediaIdx:c},e),s(0,e=[...e]),s(3,d=!1),h=!0,k()}break}}function D(){s(6,V={width:document.body.clientWidth,height:document.body.clientHeight})}function $(){const r=Number(o.url.searchParams.get("mediaIdx")||0);r&&e[l].media[r]?(s(0,e[l]={...e[l],mediaIdx:r},e),s(0,e=[...e])):(s(0,e[l]={...e[l],mediaIdx:0},e),s(0,e=[...e])),k()}function g(r){if(i!=="post"&&i!=="patch")return;const c=r.target;c.style.height="16px";let x=c.scrollHeight;x>window.innerHeight/3&&(x=window.innerHeight/3),c.style.height=`${x}px`}et(async()=>{D(),window.addEventListener("resize",D),B(),$(),await tt(),document.querySelectorAll("textarea").forEach(r=>{g({target:r})})}),st(()=>{window.removeEventListener("resize",D),fe()});function B(){document.addEventListener("touchstart",E,{passive:!1}),document.addEventListener("touchmove",_,{passive:!1}),document.addEventListener("touchend",le),document.addEventListener("mousedown",E,{passive:!1}),document.addEventListener("wheel",v,{passive:!1}),document.addEventListener("keydown",w)}function fe(){document.removeEventListener("touchstart",E),document.removeEventListener("touchmove",_),document.removeEventListener("touchend",le),document.removeEventListener("mousedown",E),document.removeEventListener("wheel",v),document.removeEventListener("keydown",w)}function ie(){s(3,d=!0),u=!1,h=!1,me.set(!1)}function Ce(r){if(i==="post"||i==="patch")return;const c=r.target;c instanceof HTMLTextAreaElement&&(c.scrollHeight<=c.clientHeight||(c.hasAttribute("open")?(c.style.height="",c.removeAttribute("open")):(c.style.height=`${window.innerHeight/3}px`,c.setAttribute("open",""))))}function Ne(r){if(i!=="post"&&i!=="patch")return;const c=r.target;c.hasAttribute("open")||(c.style.height=`${window.innerHeight/3}px`,c.setAttribute("open",""))}function Be(r){if(i!=="post"&&i!=="patch")return;const c=r.target;c.hasAttribute("open")&&(c.style.height="",c.removeAttribute("open"))}function Ge(r){nt.call(this,t,r)}function Ke(r,c){r[c].text=this.value,s(0,e)}const Ue=r=>g(r),Ze=r=>{r.user_idx&&ft(`/users/${r.user_idx}`)},Fe=r=>{r.place_idx&&ct(`/places/${r.place_idx}`)};return t.$$set=r=>{"posts"in r&&s(0,e=r.posts),"dontMoveVertically"in r&&s(13,a=r.dontMoveVertically),"keyboardY"in r&&s(2,f=r.keyboardY),"index"in r&&s(1,l=r.index)},t.$$.update=()=>{t.$$.dirty[0]&65536&&o&&k(),t.$$.dirty[0]&57347&&!a&&l>=e.length-vt&&!O&&!G&&te()},[e,l,f,d,b,L,V,i,g,ie,Ce,Ne,Be,a,O,G,o,Ge,Ke,Ue,Ze,Fe]}class Xt extends rt{constructor(n){super(),ot(this,n,wt,pt,Je,{posts:0,dontMoveVertically:13,keyboardY:2,index:1},null,[-1,-1])}}export{Xt as V};
