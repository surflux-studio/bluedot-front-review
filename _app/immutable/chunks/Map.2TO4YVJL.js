const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web.BZgSpE0H.js","./store.DvWxHXYa.js","./entry.DZF0wp9D.js","./scheduler.BITwsD4T.js","./preload-helper.D6kgxu3v.js","./web.BDN2T4Vn.js"])))=>i.map(i=>d[i]);
var Pr=Object.defineProperty;var kr=(s,t,e)=>t in s?Pr(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var _n=(s,t,e)=>kr(s,typeof t!="symbol"?t+"":t,e);import{s as ni,y as rs,e as ht,c as dt,b as pt,f as K,o as W,i as Kt,p as re,B as os,C as as,D as ls,H as cs,a as Ki,g as ji,m as Gr,h as Bt,q as Xi,n as Cn,w as Mr,ab as hs,t as Ur,d as Nr,L as ds,a5 as As,G as wn,u as us,l as fs,K as En,z as Yr,k as Qr}from"./scheduler.BITwsD4T.js";import{S as si,i as ri,t as Me,d as Ue,c as Sn,a as Rn,m as Fn,e as In}from"./index.DH03c96b.js";import{o as Vr,a as Wr}from"./keyboard.BPj_UjQm.js";import{e as Tn}from"./each.BRtNWmHE.js";import{B as Kr,u as Ne,l as Ye,E as jt,a as ne,R as jr,g as P,e as Ji,i as oe,c as Li,G as Xr,b as Se,d as Jr,h as zr,j as oi,k as Zr,m as rt,S as ai,n as ft,o as Hr,p as qr,q as $r,r as $t,s as gs,t as to,v as ms,w as eo,x as io,y as Di,z as xs,A as no,C as zi,D as so,P as Mt,F as ro,H as ps,I as Xt,J as oo,K as ao,L as lo,N as co,Q as Oi,U as Bi,W as ys,Y as _s,Z as ho,_ as Qe,$ as Ao,a0 as Cs,a1 as ws,a2 as uo,a3 as Es,a4 as At,a5 as Ve,a6 as li,a7 as se,a8 as fo,a9 as ae,aa as go,ab as Ss,ac as mo,ad as Rs,ae as xo,af as te,ag as po,ah as ee,ai as Fs,aj as Pi,ak as gt,al as yo,am as _o,an as bn,ao as Ht,ap as Is,aq as Ts,ar as Y,as as le,at as bs,au as Co,av as wo,aw as Eo,ax as So,ay as Ro,az as vs,aA as q,aB as Fo,aC as Zi,aD as Io,X as To,aE as bo,aF as vo,aG as Lo,aH as Do,aI as Oo,aJ as ki,aK as Bo,aL as Po,aM as ko,aN as Pt,aO as ot,aP as We,aQ as Ke,aR as Ft,aS as It,aT as je,aU as Xe,aV as Je,aW as ci,aX as Go,aY as Mo,aZ as Qt,a_ as Ce,a$ as ze,b0 as Ls,b1 as Uo,b2 as No,b3 as Ds,b4 as Yo,b5 as qt,b6 as Qo,b7 as Vo,b8 as vn,b9 as Wo,ba as xe,bb as Ko,bc as jo,bd as Xo,be as Jo,bf as ce,bg as Ln,bh as Os,bi as pe,bj as zo,bk as xt,bl as Dn,bm as On,bn as Zo,bo as Bs,bp as Ho,bq as Ps,br as qo,bs as $o,bt as ta,bu as ea,bv as wi,bw as Bn,bx as ia,by as Le,bz as z,bA as na,bB as sa,bC as ra,bD as oa,bE as he,bF as aa,bG as X,bH as Wt,bI as Z,bJ as ks,bK as lt,bL as la,bM as ca,bN as Pn,bO as ha,bP as da,bQ as Aa,T as Gs,V as ua,f as Ze,O as Ms,M as fa,bR as Ei}from"./Overlay.Cc9n_-zc.js";import{k as hi,l as ga,m as ma,n as xa,G as Hi,P as pa,r as Us,C as ya,A as Ns,j as Ys,o as kn}from"./store.DvWxHXYa.js";import{g as Qs}from"./entry.DZF0wp9D.js";import{e as ut}from"./emitter.E5P-NQ8u.js";import{_ as Vs}from"./preload-helper.D6kgxu3v.js";import{p as _a}from"./stores.DtOGFS_L.js";import{s as Ca}from"./searchParams.DTxyPUsb.js";function Ws(s,t){const e=(""+s).split("."),i=(""+t).split(".");for(let n=0;n<Math.max(e.length,i.length);n++){const r=parseInt(e[n]||"0",10),o=parseInt(i[n]||"0",10);if(r>o)return 1;if(o>r)return-1}return 0}const wa="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20opacity='0.2'%20cx='15'%20cy='15'%20r='15'%20fill='%230C79FE'%20/%3e%3ccircle%20cx='15'%20cy='15'%20r='7'%20fill='%230C79FE'%20stroke='white'%20stroke-width='2'%20/%3e%3c/svg%3e",Ea=""+new URL("../assets/add-marker.CpezPS16.svg",import.meta.url).href;function Sa(s){let t,e,i,n,r;const o=s[2].default,a=rs(o,s,s[1],null);return{c(){t=ht("div"),a&&a.c(),this.h()},l(l){t=dt(l,"DIV",{class:!0});var c=pt(t);a&&a.l(c),c.forEach(K),this.h()},h(){W(t,"class",e="fixed inset-0 bg-black/50 z-50 "+s[0])},m(l,c){Kt(l,t,c),a&&a.m(t,null),i=!0,n||(r=re(t,"click",s[3]),n=!0)},p(l,[c]){a&&a.p&&(!i||c&2)&&os(a,o,l,l[1],i?ls(o,l[1],c,null):as(l[1]),null),(!i||c&1&&e!==(e="fixed inset-0 bg-black/50 z-50 "+l[0]))&&W(t,"class",e)},i(l){i||(Me(a,l),i=!0)},o(l){Ue(a,l),i=!1},d(l){l&&K(t),a&&a.d(l),n=!1,r()}}}function Ra(s,t,e){let{$$slots:i={},$$scope:n}=t,{className:r=""}=t;function o(a){cs.call(this,s,a)}return s.$$set=a=>{"className"in a&&e(0,r=a.className),"$$scope"in a&&e(1,n=a.$$scope)},[r,n,i,o]}class Fa extends si{constructor(t){super(),ri(this,t,Ra,Sa,ni,{className:0})}}const Ia=["local","version","cdnUrl"],Ta=["skins"],ba=["compact","flat","shortcodes"];function va(s,t){return Ba(s)||Oa(s,t)||Da(s,t)||La()}function La(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Da(s,t){if(s){if(typeof s=="string")return Gn(s,t);var e={}.toString.call(s).slice(8,-1);return e==="Object"&&s.constructor&&(e=s.constructor.name),e==="Map"||e==="Set"?Array.from(s):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?Gn(s,t):void 0}}function Gn(s,t){(t==null||t>s.length)&&(t=s.length);for(var e=0,i=Array(t);e<t;e++)i[e]=s[e];return i}function Oa(s,t){var e=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(e!=null){var i,n,r,o,a=[],l=!0,c=!1;try{if(r=(e=e.call(s)).next,t!==0)for(;!(l=(i=r.call(e)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(h){c=!0,n=h}finally{try{if(!l&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function Ba(s){if(Array.isArray(s))return s}function Mn(s,t){var e=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),e.push.apply(e,i)}return e}function Ks(s){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?Mn(Object(e),!0).forEach(function(i){Pa(s,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(e)):Mn(Object(e)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(e,i))})}return s}function Pa(s,t,e){return(t=ka(t))in s?Object.defineProperty(s,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):s[t]=e,s}function ka(s){var t=Ga(s,"string");return typeof t=="symbol"?t:t+""}function Ga(s,t){if(typeof s!="object"||!s)return s;var e=s[Symbol.toPrimitive];if(e!==void 0){var i=e.call(s,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function qi(s,t){if(s==null)return{};var e,i,n=Ma(s,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(s,e)&&(n[e]=s[e])}return n}function Ma(s,t){if(s==null)return{};var e={};for(var i in s)if({}.hasOwnProperty.call(s,i)){if(t.indexOf(i)>=0)continue;e[i]=s[i]}return e}function Ua(s,t,e){let i=`https://cdn.jsdelivr.net/npm/emojibase-data@${t}/${s}`;return typeof e=="function"?i=e(s,t):typeof e=="string"&&(i=`${e}/${s}`),i}async function js(s,t={}){const e=t.local,i=e===void 0?!1:e,n=t.version,r=n===void 0?"latest":n,o=t.cdnUrl,a=qi(t,Ia),l=Ua(s,r,o),c=i?localStorage:sessionStorage,h=`emojibase/${r}/${s}`,d=c.getItem(h);if(d)return JSON.parse(d);const A=await fetch(l,Ks({credentials:"omit",mode:"cors",redirect:"error"},a));if(!A.ok)throw new Error("Failed to load Emojibase dataset.");const u=await A.json();try{c.setItem(h,JSON.stringify(u))}catch{}return u}const Na={discord:"joypixels",slack:"iamcal"};async function Un(s,t,e){return js(`${s}/shortcodes/${Na[t]??t}.json`,e)}function ye(s,t){if(t.length===0)return s;const e=new Set(s.shortcodes);return t.forEach(i=>{const n=i[s.hexcode];Array.isArray(n)?n.forEach(r=>e.add(r)):n&&e.add(n)}),s.shortcodes=[...e],s.skins&&s.skins.forEach(i=>{ye(i,t)}),s}function Ya(s,t=[]){const e=[];return s.forEach(i=>{if(i.skins){const n=i.skins,r=qi(i,Ta);e.push(ye(r,t)),n.forEach(o=>{const a=Ks({},o);r.tags&&(a.tags=[...r.tags]),e.push(ye(a,t))})}else e.push(ye(i,t))}),e}function Qa(s,t){return t.length===0||s.forEach(e=>{ye(e,t)}),s}async function Va(s,t={}){const e=t.compact,i=e===void 0?!1:e,n=t.flat,r=n===void 0?!1:n,o=t.shortcodes,a=o===void 0?[]:o,l=qi(t,ba),c=await js(`${s}/${i?"compact":"data"}.json`,l);let h=[];return a.length>0&&(h=await Promise.all(a.map(d=>{let A;if(d.includes("/")){const u=d.split("/"),f=va(u,2),m=f[0],x=f[1];A=Un(m,x,l)}else A=Un(s,d,l);return A.catch(()=>({}))}))),r?Ya(c,h):Qa(c,h)}let Gi=[];Va("en",{compact:!0,flat:!1}).then(s=>{Gi=s.slice(26).concat(s.slice(0,26))});function Nn(s,t,e){const i=s.slice();return i[3]=t[e],i}function Yn(s){let t,e=s[3].unicode+"",i,n,r,o;function a(){return s[1](s[3])}return{c(){t=ht("div"),i=Ur(e),n=Ki(),this.h()},l(l){t=dt(l,"DIV",{class:!0});var c=pt(t);i=Nr(c,e),n=ji(c),c.forEach(K),this.h()},h(){W(t,"class","text-3xl")},m(l,c){Kt(l,t,c),Bt(t,i),Bt(t,n),r||(o=re(t,"click",Xi(a)),r=!0)},p(l,c){s=l},d(l){l&&K(t),r=!1,o()}}}function Wa(s){let t,e,i,n,r,o,a="backspace",l,c,h=Tn(Gi),d=[];for(let A=0;A<h.length;A+=1)d[A]=Yn(Nn(s,h,A));return{c(){t=ht("div"),e=ht("div");for(let A=0;A<d.length;A+=1)d[A].c();i=Ki(),n=ht("div"),r=ht("div"),o=ht("div"),o.textContent=a,this.h()},l(A){t=dt(A,"DIV",{class:!0});var u=pt(t);e=dt(u,"DIV",{class:!0});var f=pt(e);for(let g=0;g<d.length;g+=1)d[g].l(f);f.forEach(K),i=ji(u),n=dt(u,"DIV",{class:!0});var m=pt(n);r=dt(m,"DIV",{class:!0});var x=pt(r);o=dt(x,"DIV",{"data-svelte-h":!0}),Gr(o)!=="svelte-1sht5tp"&&(o.textContent=a),x.forEach(K),m.forEach(K),u.forEach(K),this.h()},h(){W(e,"class","w-full flex-1 grid grid-cols-7 gap-2 justify-items-center p-4 overflow-y-auto "),W(r,"class","flex items-center justify-end"),W(n,"class","absolute bottom-0 w-full bg-white safe-area-pb p-4 h-12"),W(t,"class","w-full h-[300px] max-w-[500px] bg-white rounded-t-lg shadow-xl flex flex-col relative p-2 ")},m(A,u){Kt(A,t,u),Bt(t,e);for(let f=0;f<d.length;f+=1)d[f]&&d[f].m(e,null);Bt(t,i),Bt(t,n),Bt(n,r),Bt(r,o),l||(c=re(o,"click",Xi(s[2])),l=!0)},p(A,[u]){if(u&1){h=Tn(Gi);let f;for(f=0;f<h.length;f+=1){const m=Nn(A,h,f);d[f]?d[f].p(m,u):(d[f]=Yn(m),d[f].c(),d[f].m(e,null))}for(;f<d.length;f+=1)d[f].d(1);d.length=h.length}},i:Cn,o:Cn,d(A){A&&K(t),Mr(d,A),l=!1,c()}}}function Ka(s){const t=hs();return[t,n=>{t("click",{emoji:n})},()=>t("backspace")]}class ja extends si{constructor(t){super(),ri(this,t,Ka,Wa,ni,{})}}function Xa(s){let t,e,i,n,r,o;return{c(){t=ht("div"),e=ht("div"),this.h()},l(a){t=dt(a,"DIV",{class:!0});var l=pt(t);e=dt(l,"DIV",{class:!0,contenteditable:!0,inputmode:!0}),pt(e).forEach(K),l.forEach(K),this.h()},h(){W(e,"class",i="outline-none ring-0 focus:outline-none focus:ring-0 text-white transition-transform duration-300 text-center "+(s[1]==="emoji"&&s[0]?"translate-y-[-150px]":"translate-y-0")+" caret-white"),W(e,"contenteditable",!0),W(e,"inputmode",n=s[1]==="emoji"?"none":"text"),wn(e,"text-2xl",s[1]==="emoji"),W(t,"class","w-full h-full flex items-center justify-center")},m(a,l){Kt(a,t,l),Bt(t,e),s[7](e),r||(o=[re(e,"click",Xi(s[5])),re(e,"keydown",s[6])],r=!0)},p(a,l){l&3&&i!==(i="outline-none ring-0 focus:outline-none focus:ring-0 text-white transition-transform duration-300 text-center "+(a[1]==="emoji"&&a[0]?"translate-y-[-150px]":"translate-y-0")+" caret-white")&&W(e,"class",i),l&2&&n!==(n=a[1]==="emoji"?"none":"text")&&W(e,"inputmode",n),l&3&&wn(e,"text-2xl",a[1]==="emoji")},d(a){a&&K(t),s[7](null),r=!1,us(o)}}}function Ja(s){let t,e,i,n,r,o;return t=new Fa({props:{className:`
    transition-opacity duration-300 
    ${s[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${s[3]?"visible":"invisible"}
  `,$$slots:{default:[Xa]},$$scope:{ctx:s}}}),t.$on("click",s[8]),n=new ja({}),n.$on("backspace",s[9]),n.$on("click",s[10]),{c(){Sn(t.$$.fragment),e=Ki(),i=ht("div"),Sn(n.$$.fragment),this.h()},l(a){Rn(t.$$.fragment,a),e=ji(a),i=dt(a,"DIV",{class:!0});var l=pt(i);Rn(n.$$.fragment,l),l.forEach(K),this.h()},h(){W(i,"class",r="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 "+(s[0]?"translate-y-0":"translate-y-[330px]")+" "+(s[1]==="emoji"&&s[3]?"visible":"invisible"))},m(a,l){Fn(t,a,l),Kt(a,e,l),Kt(a,i,l),Fn(n,i,null),o=!0},p(a,[l]){const c={};l&9&&(c.className=`
    transition-opacity duration-300 
    ${a[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${a[3]?"visible":"invisible"}
  `),l&16391&&(c.$$scope={dirty:l,ctx:a}),t.$set(c),(!o||l&11&&r!==(r="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 "+(a[0]?"translate-y-0":"translate-y-[330px]")+" "+(a[1]==="emoji"&&a[3]?"visible":"invisible")))&&W(i,"class",r)},i(a){o||(Me(t.$$.fragment,a),Me(n.$$.fragment,a),o=!0)},o(a){Ue(t.$$.fragment,a),Ue(n.$$.fragment,a),o=!1},d(a){a&&(K(e),K(i)),In(t,a),In(n)}}}function za(s,t,e){const i=hs();let{isOpen:n=!1}=t,{value:r}=t,{type:o="text"}=t,a=!1,l=null;function c(g){l==null||l.focus(),l==null||l.style.setProperty("transform",`translateY(-${g.keyboardHeight/2}px)`)}function h(){l==null||l.blur(),l==null||l.style.setProperty("transform","translateY(0px)")}ds(()=>{Vr(()=>{},c,h),new MutationObserver(y=>{e(4,r=(l==null?void 0:l.innerText)||""),i("change",r)}).observe(l,{childList:!0,subtree:!0})}),As(()=>{Wr()});function d(g){cs.call(this,s,g)}const A=g=>{o==="emoji"&&(g.preventDefault(),g.stopPropagation())};function u(g){fs[g?"unshift":"push"](()=>{l=g,e(2,l)})}const f=g=>{g.stopPropagation(),e(0,n=!1)},m=()=>{const g=window.getSelection();if(g!=null&&g.rangeCount&&l){const y=g.getRangeAt(0);y.collapsed&&y.setStart(y.startContainer,y.startOffset-1),y.deleteContents(),g.removeAllRanges(),g.addRange(y)}},x=g=>{const y=g.detail.emoji.unicode,_=window.getSelection();if(_!=null&&_.rangeCount&&l){const p=_.getRangeAt(0);p.deleteContents();const C=document.createTextNode(y);p.insertNode(C),p.setStartAfter(C),p.setEndAfter(C),_.removeAllRanges(),_.addRange(p)}};return s.$$set=g=>{"isOpen"in g&&e(0,n=g.isOpen),"value"in g&&e(4,r=g.value),"type"in g&&e(1,o=g.type)},s.$$.update=()=>{s.$$.dirty&5&&(n?(e(3,a=!0),setTimeout(()=>{l&&l.focus()},300),setInterval(()=>{l&&l.focus()},1e3)):setTimeout(()=>{e(3,a=!1)},300))},[n,o,l,a,r,d,A,u,f,m,x]}class id extends si{constructor(t){super(),ri(this,t,za,Ja,ni,{isOpen:0,value:4,type:1})}}class yt extends Kr{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new yt(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Ne(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Ye(t,jt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?Za(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Za(s){if(typeof s=="function")return s;let t;return Array.isArray(s)?t=s:(ne(typeof s.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[s]),function(){return t}}class Qn{constructor(t){this.rbush_=new jr(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[P(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const o=t[n],a=e[n],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=l,this.items_[P(a)]=l}this.rbush_.load(i)}remove(t){const e=P(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[P(e)],n=[i.minX,i.minY,i.maxX,i.maxY];Ji(n,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(n){return n.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return oe(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Li(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class He extends Xr{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Ne),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(Ye(t[e],jt.CHANGE,this.changed,this))}clone(){const t=new He(Si(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Se(this.getExtent(),t,e))return n;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)n=r[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){Jr(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)zr(t,e[i].getExtent());return t}getGeometries(){return Si(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(n=!0)}return n?new He(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=oi(this.getExtent()));const n=this.geometries_;for(let r=0,o=n.length;r<o;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Si(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Si(s){return s.map(t=>t.clone())}function qe(s,t,e,i,n,r,o){let a,l;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=n;else if(c!==0){let h=s[t],d=s[t+1],A=0;const u=[0];for(let x=t+i;x<e;x+=i){const g=s[x],y=s[x+1];A+=Math.sqrt((g-h)*(g-h)+(y-d)*(y-d)),u.push(A),h=g,d=y}const f=n*A,m=Zr(u,f);m<0?(l=(f-u[-m-2])/(u[-m-1]-u[-m-2]),a=t+(-m-2)*i):a=t+m*i}o=o>1?o:2,r=r||new Array(o);for(let h=0;h<o;++h)r[h]=a===void 0?NaN:l===void 0?s[a+h]:rt(s[a+h],s[a+i+h],l);return r}function Mi(s,t,e,i,n,r){if(e==t)return null;let o;if(n<s[t+i-1])return r?(o=s.slice(t,t+i),o[i-1]=n,o):null;if(s[e-1]<n)return r?(o=s.slice(e-i,e),o[i-1]=n,o):null;if(n==s[t+i-1])return s.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const A=a+l>>1;n<s[(A+1)*i-1]?l=A:a=A+1}const c=s[a*i-1];if(n==c)return s.slice((a-1)*i,(a-1)*i+i);const h=s[(a+1)*i-1],d=(n-c)/(h-c);o=[];for(let A=0;A<i-1;++A)o.push(rt(s[(a-1)*i+A],s[a*i+A],d));return o.push(n),o}function Ha(s,t,e,i,n,r,o){if(o)return Mi(s,t,e[e.length-1],i,n,r);let a;if(n<s[i-1])return r?(a=s.slice(0,i),a[i-1]=n,a):null;if(s[s.length-1]<n)return r?(a=s.slice(s.length-i),a[i-1]=n,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(n<s[t+i-1])return null;if(n<=s[h-1])return Mi(s,t,h,i,n,!1);t=h}}return null}function Xs(s,t,e,i){let n=s[t],r=s[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=s[a],c=s[a+1];o+=Math.sqrt((l-n)*(l-n)+(c-r)*(c-r)),n=l,r=c}return o}class Jt extends ai{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){ft(this.flatCoordinates,t),this.changed()}clone(){const t=new Jt(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Se(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Hr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),qr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return $r(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,Mi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return $t(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return qe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return Xs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=gs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Jt(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return to(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ms(this.flatCoordinates,0,t,this.stride),this.changed()}}class we extends ai{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const n=t,r=[],o=[];for(let l=0,c=n.length;l<c;++l){const h=n[l];ft(r,h.getFlatCoordinates()),o.push(r.length)}const a=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(t){ft(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new we(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Se(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(eo(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),io(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,Ha(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Di(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new Jt(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new Jt(t.slice(r,l),i);n.push(c),r=l}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=qe(e,i,l,r,.5);ft(t,c),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=xs(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new we(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return no(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=zi(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class Re extends ai{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){ft(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new Re(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Se(this.getExtent(),t,e))return n;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const c=so(t,e,r[a],r[a+1]);if(c<n){n=c;for(let h=0;h<o;++h)i[h]=r[a+h];i.length=o}}return n}getCoordinates(){return $t(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Mt(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,o=t.length;r<o;r+=i){const a=new Mt(t.slice(r,r+i),e);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i){const o=e[n],a=e[n+1];if(ro(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=ms(this.flatCoordinates,0,t,this.stride),this.changed()}}function Js(s,t,e,i){const n=[];let r=Xt();for(let o=0,a=e.length;o<a;++o){const l=e[o];r=ps(s,t,l[0],i),n.push((r[0]+r[2])/2,(r[1]+r[3])/2),t=l[l.length-1]}return n}class Ee extends ai{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,r=[],o=[];for(let a=0,l=n.length;a<l;++a){const c=n[a],h=r.length,d=c.getEnds();for(let A=0,u=d.length;A<u;++A)d[A]+=h;ft(r,c.getFlatCoordinates()),o.push(d)}e=n.length===0?this.getLayout():n[0].getLayout(),t=r,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;ft(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let n=0,r=e.length;n<r;++n)e[n]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const i=new Ee(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<Se(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(oo(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),ao(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return lo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return co(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Oi(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Bi(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Js(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=ys(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Re(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;_s(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Oi(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=ho(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new Ee(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(e!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=e;return new Qe(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(r!==0)for(let d=0,A=l.length;d<A;++d)l[d]-=r;const h=new Qe(e.slice(r,c),t,l);n.push(h),r=c}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return Ao(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Cs(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}}const Vn=ae();class H{constructor(t,e,i,n,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?ws(this.flatCoordinates_):ps(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=oi(this.getExtent());this.flatInteriorPoints_=uo(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Es(this.flatCoordinates_,this.ends_),e=Js(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=ys(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=qe(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const o=i[n],a=qe(t,e,o,2,.5);ft(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=At(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const n=Ve(i)/Ve(e);li(Vn,i[0],i[3],n,-n,0,0,0),se(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Vn,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new H(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=fo((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=gs(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=xs(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=go(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n);break}return n&&(this.simplifiedGeometry_=new H(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}H.prototype.getFlatCoordinates=H.prototype.getOrientedFlatCoordinates;const st={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function qa(s,t){return[[-1/0,-1/0,1/0,1/0]]}function zs(s,t){return[s]}let $a=!1;function Zs(s,t,e,i,n,r,o){const a=new XMLHttpRequest;a.open("GET",typeof s=="function"?s(e,i,n):s,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=$a,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?r(t.readFeatures(h,{extent:e,featureProjection:n}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Wn(s,t){return function(e,i,n,r,o){const a=this;Zs(s,t,e,i,n,function(l,c){a.addFeatures(l),r!==void 0&&r(l)},o||Ss)}}class vt extends Fs{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class Ut extends mo{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ss,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(ne(this.format_,"`format` must be set when `url` is set"),this.loader_=Wn(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:qa;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new Qn:null,this.loadedExtentsRtree_=new Qn,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),!e&&i===void 0&&(i=new Rs(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=P(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new vt(st.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof H||(this.featureChangeKeys_[t]=[Ye(e,jt.CHANGE,this.handleFeatureChange_,this),Ye(e,xo.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const n=String(e.getId());if(!(n in this.idIndex_))this.idIndex_[n]=e;else if(e instanceof H){const r=this.idIndex_[n];r instanceof H?Array.isArray(r)?r.push(e):this.idIndex_[n]=[r,e]:i=!1}else i=!1}return i&&(ne(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=P(a);this.addToIndex_(l,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],l=P(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),n.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(st.ADDFEATURE))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new vt(st.ADDFEATURE,i[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(st.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(st.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(te.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(te.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Ne);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=n=>{this.removeFeatureInternal(n)};this.featuresRtree_.forEach(i);for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new vt(st.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(n){const r=n.getGeometry();if(r instanceof H||r.intersectsCoordinate(t))return e(n)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const n=i.getGeometry();if(n instanceof H||n.intersectsExtent(t)){const r=e(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),oe(this.nullGeometryFeatures_)||ft(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=po(t,e);return[].concat(...n.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Pi,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),d=a;if(a=h instanceof H?0:h.closestPointXY(i,n,o,a),a<d){r=c;const A=Math.sqrt(a);l[0]=i-A,l[1]=n-A,l[2]=i+A,l[3]=n+A}}}),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=P(e),n=e.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const r=e.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new vt(st.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:P(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&oe(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let o=0,a=r.length;o<a;++o){const l=r[o];n.forEachInExtent(l,function(h){return ee(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new vt(st.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new vt(st.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new vt(st.FEATURESLOADERROR))}),n.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,function(n){if(Ji(n.extent,t))return i=n,!0}),i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=P(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i==null||i.forEach(Ne),delete this.featureChangeKeys_[e];const n=t.getId();if(n!==void 0){const r=n.toString(),o=this.idIndex_[r];o===t?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[e],this.hasListener(st.REMOVEFEATURE)&&this.dispatchEvent(new vt(st.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){ne(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Wn(t,this.format_))}}class Hs extends Ut{constructor(t){t=t||{},super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=t.distance!==void 0?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(e){const i=e.getGeometry();return ne(!i||i.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),i},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,i){var n;(n=this.source)==null||n.loadFeatures(t,e,i),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(jt.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(jt.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const i=t===0?0:Math.min(e,t)/t,n=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=e,this.interpolationRatio=i,n&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const t=Xt(),e=this.distance*this.resolution,i=this.source.getFeatures(),n={};for(let r=0,o=i.length;r<o;r++){const a=i[r];if(!(P(a)in n)){const l=this.geometryFunction(a);if(l){const c=l.getCoordinates();ws(c,t),gt(t,e,t);const h=this.source.getFeaturesInExtent(t).filter(function(d){const A=P(d);return A in n?!1:(n[A]=!0,!0)});this.features.push(this.createCluster(h,t))}}}}createCluster(t,e){const i=[0,0];for(let a=t.length-1;a>=0;--a){const l=this.geometryFunction(t[a]);l?yo(i,l.getCoordinates()):t.splice(a,1)}_o(i,1/t.length);const n=oi(e),r=this.interpolationRatio,o=new Mt([i[0]*(1-r)+n[0]*r,i[1]*(1-r)+n[1]*r]);return this.createCustomCluster_?this.createCustomCluster_(o,t):new yt({geometry:o,features:t})}}const Kn=4,Ui="1.3.0";function tl(s,t,e,i,n){n.WIDTH=e[0],n.HEIGHT=e[1];const r=i.getAxisOrientation(),o=Ws(n.VERSION,"1.3")>=0;n[o?"CRS":"SRS"]=i.getCode();const a=o&&r.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return n.BBOX=a.join(","),Is(s,n)}function el(s,t,e,i,n,r,o){r=Object.assign({REQUEST:"GetMap"},r);const a=t/e,l=[bn(Ht(s)/a,Kn),bn(Ve(s)/a,Kn)];if(e!=1)switch(o){case"geoserver":const h=90*e+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+h:r.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":r.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":r.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return tl(n,s,l,i,r)}function jn(s,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:Ui,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},s)}let il=class extends Ts{constructor(t,e,i,n,r,o){super(t,e,o),this.extent=null,this.format_=n,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=r,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==Y.IDLE&&(this.setState(Y.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(t,e){this.setFeatures(t)}onError(){this.setState(Y.ERROR)}setFeatures(t){this.features_=t,this.setState(Y.LOADED)}setLoader(t){this.loader_=t}};const Xn=[];class nl extends Ts{constructor(t,e,i,n){super(t,e,{transition:0}),this.context_=null,this.executorGroups=[],this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=n.bind(void 0,this),this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=le(1,1,Xn)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(t){const e=P(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){bs(this.context_),Xn.push(this.context_.canvas),this.context_=null,super.release()}}class sl extends Co{constructor(t){const e=t.projection||"EPSG:3857",i=t.extent||wo(e),n=t.tileGrid||Eo({extent:i,maxResolution:t.maxResolution,maxZoom:t.maxZoom!==void 0?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,projection:e,state:t.state,tileGrid:n,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:rl,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0?!0:t.wrapX,transition:t.transition,zDirection:t.zDirection===void 0?1:t.zDirection}),this.format_=t.format?t.format:null,this.sourceTileCache_=new So(128),this.overlaps_=t.overlaps==null?!0:t.overlaps,this.tileClass=t.tileClass?t.tileClass:il,this.tileGrids_={}}getOverlaps(){return this.overlaps_}clear(){this.sourceTileCache_.clear()}expireCache(t,e){const i=this.getTileCacheForProjection(t),n=Object.keys(e).reduce((r,o)=>{const a=Ro(o),l=i.peek(a);if(l){const c=l.sourceTiles;for(let h=0,d=c.length;h<d;++h)r[c[h].getKey()]=!0}return r},{});super.expireCache(t,e),this.sourceTileCache_.expireCache(n)}getSourceTiles(t,e,i){if(i.getState()===Y.IDLE){i.setState(Y.LOADING);const n=i.wrappedTileCoord,r=this.getTileGridForProjection(e),o=r.getTileCoordExtent(n),a=n[0],l=r.getResolution(a);gt(o,-l,o);const c=this.tileGrid,h=c.getExtent();h&&vs(o,h,o);const d=c.getZForResolution(l,this.zDirection);c.forEachTileCoord(o,d,A=>{const u=this.tileUrlFunction(A,t,e),f=this.sourceTileCache_.containsKey(u)?this.sourceTileCache_.get(u):new this.tileClass(A,u?Y.IDLE:Y.EMPTY,u,this.format_,this.tileLoadFunction);i.sourceTiles.push(f);const m=f.getState();if(m<Y.LOADED){const x=g=>{this.handleTileChange(g);const y=f.getState();if(y===Y.LOADED||y===Y.ERROR){const _=f.getKey();_ in i.errorTileKeys?f.getState()===Y.LOADED&&delete i.errorTileKeys[_]:i.loadingSourceTiles--,y===Y.ERROR?i.errorTileKeys[_]=!0:f.removeEventListener(jt.CHANGE,x),i.loadingSourceTiles===0&&i.setState(oe(i.errorTileKeys)?Y.LOADED:Y.ERROR)}};f.addEventListener(jt.CHANGE,x),i.loadingSourceTiles++}m===Y.IDLE&&(f.extent=c.getTileCoordExtent(A),f.projection=e,f.resolution=c.getResolution(A[0]),this.sourceTileCache_.set(u,f),f.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(A=>A.getState()===Y.ERROR)?Y.ERROR:Y.LOADED)}return i.sourceTiles}getTile(t,e,i,n,r){const o=[t,e,i];let a=this.getTileCoordForTileUrlFunction(o,r);const l=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(r);if(a&&l){const A=c.getTileCoordExtent(a);gt(A,-c.getResolution(t),A),q(l,A)||(a=null)}let h=!0;if(a!==null){const A=this.tileGrid,u=c.getResolution(t),f=A.getZForResolution(u,1),m=c.getTileCoordExtent(a);gt(m,-u,m),A.forEachTileCoord(m,f,x=>{h=h&&!this.tileUrlFunction(x,n,r)})}const d=new nl(o,h?Y.EMPTY:Y.IDLE,a,this.getSourceTiles.bind(this,n,r));return d.key=this.getKey(),d}getTileGridForProjection(t){const e=t.getCode();let i=this.tileGrids_[e];if(!i){const n=this.tileGrid,r=n.getResolutions().slice(),o=r.map(function(c,h){return n.getOrigin(h)}),a=r.map(function(c,h){return n.getTileSize(h)}),l=Io+1;for(let c=r.length;c<l;++c)r.push(r[c-1]/2),o.push(o[c-1]),a.push(a[c-1]);i=new Fo({extent:n.getExtent(),origins:o,resolutions:r,tileSizes:a}),this.tileGrids_[e]=i}return i}getTilePixelRatio(t){return t}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=Zi(n.getTileSize(t),this.tmpSize);return[Math.round(r[0]*e),Math.round(r[1]*e)]}}function rl(s,t){s.setLoader(function(e,i,n){Zs(t,s.getFormat(),e,i,n,s.onLoad.bind(s),s.onError.bind(s))})}class ol extends To{constructor(t){t=t||{},super({projection:t.projection,tileGrid:t.tileGrid,wrapX:t.wrapX!==void 0?t.wrapX:!0,zDirection:t.zDirection,url:t.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(e,i)=>{const n=e.getTileCoord()[0],r=Zi(this.tileGrid.getTileSize(n)),o=le(r[0],r[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,r[0]+.5,r[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,r[0]/2,r[1]/2,r[0]),o.fillText(i,r[0]/2,r[1]/2,r[0]),e.setImage(o.canvas)}})}}class al extends bo{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=Xt(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,n){const r=At(i),o=this.getProjection()||r;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=vo(t,r,o),c=Lo(o,r,t,e),h=a.getZForResolution(c,this.zDirection),d=a.getResolution(h),A=a.getTileCoordForCoordAndZ(l,h);if(a.getResolutions().length<=A[0])return;let u=a.getTileCoordExtent(A,this.tmpExtent_);const f=this.gutter_;f!==0&&(u=gt(u,d*f,u));const m={QUERY_LAYERS:this.params_.LAYERS};Object.assign(m,jn(this.params_,"GetFeatureInfo"),n);const x=Math.floor((l[0]-u[0])/d),g=Math.floor((u[3]-l[1])/d);return m[this.v13_?"I":"X"]=x,m[this.v13_?"J":"Y"]=g,this.getRequestUrl_(A,u,1,o||r,m)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:Ui,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const n=this.params_.LAYERS;if(!(!Array.isArray(n)||n.length===1))return;i.LAYER=n}if(t!==void 0){const n=this.getProjection()?this.getProjection().getMetersPerUnit():1,r=28e-5;i.SCALE=t*n/r}return Object.assign(i,e),Is(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,n,r){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=Do(Oo(t),o.length);a=o[l]}return el(e,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(t[0]),i,n,a,r,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||Ui;this.v13_=Ws(t,"1.3")>=0}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const r=n.getResolution(t[0]);let o=n.getTileCoordExtent(t,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=gt(o,r*a,o));const l=Object.assign({},jn(this.params_,"GetMap"));return this.getRequestUrl_(t,o,e,i,l)}}const T={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},De=[T.FILL],kt=[T.STROKE],Vt=[T.BEGIN_PATH],Jn=[T.CLOSE_PATH];class qs{drawCustom(t,e,i,n,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class Fe extends qs{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=t.length;a<l;a+=e)n[0]=t[a],n[1]=t[a+1],ki(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,r,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=n);let h=t[e],d=t[e+1];const A=this.tmpCoordinate_;let u=!0,f,m,x;for(f=e+n;f<i;f+=n)A[0]=t[f],A[1]=t[f+1],x=Bo(c,A),x!==m?(u&&(a[l++]=h,a[l++]=d,u=!1),a[l++]=A[0],a[l++]=A[1]):x===Po.INTERSECTING?(a[l++]=A[0],a[l++]=A[1],u=!1):u=!0,h=A[0],d=A[1],m=x;return(r&&u||f===e+n)&&(a[l++]=h,a[l++]=d),l}drawCustomCoordinates_(t,e,i,n,r){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(t,e,l,n,!1,!1);r.push(c),e=l}return e}drawCustom(t,e,i,n,r){this.beginGeometry(t,e,r);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,d,A,u;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),A=[];const f=t.getEndss();u=0;for(let m=0,x=f.length;m<x;++m){const g=[];u=this.drawCustomCoordinates_(c,u,f[m],a,g),A.push(g)}this.instructions.push([T.CUSTOM,l,A,t,i,Bi,r]),this.hitDetectionInstructions.push([T.CUSTOM,l,A,t,n||i,Bi,r]);break;case"Polygon":case"MultiLineString":d=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),u=this.drawCustomCoordinates_(c,0,t.getEnds(),a,d),this.instructions.push([T.CUSTOM,l,d,t,i,Di,r]),this.hitDetectionInstructions.push([T.CUSTOM,l,d,t,n||i,Di,r]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([T.CUSTOM,l,h,t,i,$t,r]),this.hitDetectionInstructions.push([T.CUSTOM,l,h,t,n||i,$t,r]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([T.CUSTOM,l,h,t,i,$t,r]),this.hitDetectionInstructions.push([T.CUSTOM,l,h,t,n||i,$t,r]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([T.CUSTOM,l,h,t,i,void 0,r]),this.hitDetectionInstructions.push([T.CUSTOM,l,h,t,n||i,void 0,r]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[T.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[T.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let n,r,o=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==T.END_GEOMETRY?o=e:r==T.BEGIN_GEOMETRY&&(n[2]=e,ko(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const n=t.getColor();i.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,i.fillStyle=Pt(n||ot)}else i.fillStyle=void 0;if(e){const n=e.getColor();i.strokeStyle=Pt(n||We);const r=e.getLineCap();i.lineCap=r!==void 0?r:Ke;const o=e.getLineDash();i.lineDash=o?o.slice():Ft;const a=e.getLineDashOffset();i.lineDashOffset=a||It;const l=e.getLineJoin();i.lineJoin=l!==void 0?l:je;const c=e.getWidth();i.lineWidth=c!==void 0?c:Xe;const h=e.getMiterLimit();i.miterLimit=h!==void 0?h:Je,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[T.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[T.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!ci(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[T.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=Go(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;gt(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class ll extends Fe{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!ki(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,r);this.instructions.push([T.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([T.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=[];for(let l=0,c=n.length;l<c;l+=t.getStride())(!this.maxExtent||ki(this.maxExtent,n.slice(l,l+2)))&&r.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,2);this.instructions.push([T.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([T.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class cl extends Fe{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),a=[T.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([T.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ft,It],Vt);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(kt),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([T.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ft,It],Vt);const a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride();let h=0;for(let d=0,A=a.length;d<A;++d)h=this.drawFlatCoordinates_(l,h,a[d],c);this.hitDetectionInstructions.push(kt),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(kt),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(kt),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(Vt)}}class zn extends Fe{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=i.length;this.instructions.push(Vt),this.hitDetectionInstructions.push(Vt);for(let c=0;c<l;++c){const h=i[c],d=this.coordinates.length,A=this.appendFlatLineCoordinates(t,e,h,n,!0,!a),u=[T.MOVE_TO_LINE_TO,d,A];this.instructions.push(u),this.hitDetectionInstructions.push(u),a&&(this.instructions.push(Jn),this.hitDetectionInstructions.push(Jn)),e=h}return o&&(this.instructions.push(De),this.hitDetectionInstructions.push(De)),a&&(this.instructions.push(kt),this.hitDetectionInstructions.push(kt)),e}drawCircle(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([T.SET_FILL_STYLE,ot]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([T.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ft,It]);const a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[T.CIRCLE,c];this.instructions.push(Vt,h),this.hitDetectionInstructions.push(Vt,h),n.fillStyle!==void 0&&(this.instructions.push(De),this.hitDetectionInstructions.push(De)),n.strokeStyle!==void 0&&(this.instructions.push(kt),this.hitDetectionInstructions.push(kt)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([T.SET_FILL_STYLE,ot]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([T.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ft,It]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([T.SET_FILL_STYLE,ot]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([T.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Ft,It]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride();let h=0;for(let d=0,A=a.length;d<A;++d)h=this.drawFlatCoordinatess_(l,h,a[d],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=Mo(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function hl(s,t,e,i,n){const r=[];let o=e,a=0,l=t.slice(e,2);for(;a<s&&o+n<i;){const[c,h]=l.slice(-2),d=t[o+n],A=t[o+n+1],u=Math.sqrt((d-c)*(d-c)+(A-h)*(A-h));if(a+=u,a>=s){const f=(s-a+u)/u,m=rt(c,d,f),x=rt(h,A,f);l.push(m,x),r.push(l),l=[m,x],a==s&&(o+=n),a=0}else if(a<s)l.push(t[o+n],t[o+n+1]),o+=n;else{const f=u-a,m=rt(c,d,f/u),x=rt(h,A,f/u);l.push(m,x),r.push(l),l=[m,x],a=0,o+=n}}return a>0&&r.push(l),r}function dl(s,t,e,i,n){let r=e,o=e,a=0,l=0,c=e,h,d,A,u,f,m,x,g,y,_;for(d=e;d<i;d+=n){const p=t[d],C=t[d+1];f!==void 0&&(y=p-f,_=C-m,u=Math.sqrt(y*y+_*_),x!==void 0&&(l+=A,h=Math.acos((x*y+g*_)/(A*u)),h>s&&(l>a&&(a=l,r=c,o=d),l=0,c=d-n)),A=u,x=y,g=_),f=p,m=C}return l+=u,l>a?[c,d]:[r,o]}const $e={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Al extends Fe{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ot]={fillStyle:ot},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!r)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,d=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!q(this.maxExtent,t.getExtent()))return;let A;if(h=t.getFlatCoordinates(),c=="LineString")A=[h.length];else if(c=="MultiLineString")A=t.getEnds();else if(c=="Polygon")A=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const x=t.getEndss();A=[];for(let g=0,y=x.length;g<y;++g)A.push(x[g][0])}this.beginGeometry(t,e,i);const u=o.repeat,f=u?void 0:o.textAlign;let m=0;for(let x=0,g=A.length;x<g;++x){let y;u?y=hl(u*this.resolution,h,m,A[x],d):y=[h.slice(m,A[x])];for(let _=0,p=y.length;_<p;++_){const C=y[_];let S=0,R=C.length;if(f==null){const F=dl(o.maxAngle,C,0,C.length,2);S=F[0],R=F[1]}for(let F=S;F<R;F+=d)a.push(C[F],C[F+1]);const I=a.length;m=A[x],this.drawChars_(l,I),l=I}}this.endGeometry(e)}else{let A=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),d=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||A.push(h[2]/this.resolution),d=3;break;case"MultiPolygon":const y=t.getFlatInteriorPoints();h=[];for(let _=0,p=y.length;_<p;_+=3)o.overflow||A.push(y[_+2]/this.resolution),h.push(y[_],y[_+1]);if(h.length===0)return;d=2;break}const u=this.appendFlatPointCoordinates(h,d);if(u===l)return;if(A&&(u-l)/2!==h.length/d){let y=l/2;A=A.filter((_,p)=>{const C=a[(y+p)*2]===h[p*d]&&a[(y+p)*2+1]===h[p*d+1];return C||--y,C})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);let f=o.padding;if(f!=Qt&&(o.scale[0]<0||o.scale[1]<0)){let y=o.padding[0],_=o.padding[1],p=o.padding[2],C=o.padding[3];o.scale[0]<0&&(_=-_,C=-C),o.scale[1]<0&&(y=-y,p=-p),f=[y,_,p,C]}const m=this.pixelRatio;this.instructions.push([T.DRAW_IMAGE,l,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,f==Qt?Qt:f.map(function(y){return y*m}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,A]);const x=1/m,g=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=ot,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([T.DRAW_IMAGE,l,u,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[x,x],NaN,this.declutterMode_,this.declutterImageWithText_,f,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ot:this.fillKey_,this.textOffsetX_,this.textOffsetY_,A]),o.backgroundFill&&(this.state.fillStyle=g,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Ce,justify:e.justify,textBaseline:e.textBaseline||ze,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=$e[n.textBaseline],h=this.textOffsetY_*l,d=this.text_,A=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([T.DRAW_CHARS,t,e,c,n.overflow,a,n.maxAngle,l,h,r,A*l,d,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([T.DRAW_CHARS,t,e,c,n.overflow,a&&ot,n.maxAngle,l,h,r,A*l,d,o,1/l,this.declutterMode_])}setTextStyle(t,e){let i,n,r;if(!t)this.text_="";else{const o=t.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=Pt(o.getColor()||ot)):(n=null,this.textFillState_=n);const a=t.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const f=a.getLineDash(),m=a.getLineDashOffset(),x=a.getWidth(),g=a.getMiterLimit();r.lineCap=a.getLineCap()||Ke,r.lineDash=f?f.slice():Ft,r.lineDashOffset=m===void 0?It:m,r.lineJoin=a.getLineJoin()||je,r.lineWidth=x===void 0?Xe:x,r.miterLimit=g===void 0?Je:g,r.strokeStyle=Pt(a.getColor()||We)}i=this.textState_;const l=t.getFont()||Ls;Uo(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||ze,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Qt,i.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),d=t.getOffsetY(),A=t.getRotateWithView(),u=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=A===void 0?!1:A,this.textRotation_=u===void 0?0:u,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:P(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+P(n.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const ul={Circle:zn,Default:Fe,Image:ll,LineString:cl,Polygon:zn,Text:Al};class $s{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];if(r===void 0){const o=ul[e];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r}return r}}function fl(s,t,e,i,n,r,o,a,l,c,h,d){let A=s[t],u=s[t+1],f=0,m=0,x=0,g=0;function y(){f=A,m=u,t+=i,A=s[t],u=s[t+1],g+=x,x=Math.sqrt((A-f)*(A-f)+(u-m)*(u-m))}do y();while(t<e-i&&g+x<r);let _=x===0?0:(r-g)/x;const p=rt(f,A,_),C=rt(m,u,_),S=t-i,R=g,I=r+a*l(c,n,h);for(;t<e-i&&g+x<I;)y();_=x===0?0:(I-g)/x;const F=rt(f,A,_),B=rt(m,u,_);let b;if(d){const E=[p,C,F,B];No(E,0,4,2,d,E,E),b=E[0]>E[2]}else b=p>F;const v=Math.PI,G=[],L=S+i===t;t=S,x=0,g=R,A=s[t],u=s[t+1];let D;if(L){y(),D=Math.atan2(u-m,A-f),b&&(D+=D>0?-v:v);const E=(F+p)/2,M=(B+C)/2;return G[0]=[E,M,(I-r)/2,D,n],G}n=n.replace(/\n/g," ");for(let E=0,M=n.length;E<M;){y();let U=Math.atan2(u-m,A-f);if(b&&(U+=U>0?-v:v),D!==void 0){let w=U-D;if(w+=w>v?-2*v:w<-v?2*v:0,Math.abs(w)>o)return null}D=U;const j=E;let N=0;for(;E<M;++E){const w=b?M-E-1:E,Ai=a*l(c,n[w],h);if(t+i<e&&g+x<r+N+Ai/2)break;N+=Ai}if(E===j)continue;const V=b?n.substring(M-j,M-E):n.substring(j,E);_=x===0?0:(r+N/2-g)/x;const $=rt(f,A,_),bt=rt(m,u,_);G.push([$,bt,N/2,U,V]),r+=N}return G}const zt=Xt(),Lt=[],St=[],Rt=[],Dt=[];function Zn(s){return s[3].declutterBox}const Hn=new RegExp("[-----]");function Ri(s,t){return t==="start"?t=Hn.test(s)?"right":"left":t==="end"&&(t=Hn.test(s)?"left":"right"),$e[t]}function gl(s,t,e){return e>0&&s.push(`
`,""),s.push(t,""),s}class ml{constructor(t,e,i,n,r){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=ae(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new Ds:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],d=l.justify?$e[l.justify]:Ri(Array.isArray(t)?t[0]:t,l.textAlign||Ce),A=n&&o.lineWidth?o.lineWidth:0,u=Array.isArray(t)?t:String(t).split(`
`).reduce(gl,[]),{width:f,height:m,widths:x,heights:g,lineWidths:y}=Yo(l,u),_=f+A,p=[],C=(_+2)*h[0],S=(m+A)*h[1],R={width:C<0?Math.floor(C):Math.ceil(C),height:S<0?Math.floor(S):Math.ceil(S),contextInstructions:p};(h[0]!=1||h[1]!=1)&&p.push("scale",h),n&&(p.push("strokeStyle",o.strokeStyle),p.push("lineWidth",A),p.push("lineCap",o.lineCap),p.push("lineJoin",o.lineJoin),p.push("miterLimit",o.miterLimit),p.push("setLineDash",[o.lineDash]),p.push("lineDashOffset",o.lineDashOffset)),i&&p.push("fillStyle",a.fillStyle),p.push("textBaseline","middle"),p.push("textAlign","center");const I=.5-d;let F=d*_+I*A;const B=[],b=[];let v=0,G=0,L=0,D=0,E;for(let M=0,U=u.length;M<U;M+=2){const j=u[M];if(j===`
`){G+=v,v=0,F=d*_+I*A,++D;continue}const N=u[M+1]||l.font;N!==E&&(n&&B.push("font",N),i&&b.push("font",N),E=N),v=Math.max(v,g[L]);const V=[j,F+I*x[L]+d*(x[L]-y[D]),.5*(A+v)+G];F+=x[L],n&&B.push("strokeText",V),i&&b.push("fillText",V),++L}return Array.prototype.push.apply(p,B),Array.prototype.push.apply(p,b),this.labels_[r]=R,R}replayTextBackground_(t,e,i,n,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,o,a,l,c,h,d,A,u,f,m,x){a*=A[0],l*=A[1];let g=i-a,y=n-l;const _=r+c>t?t-c:r,p=o+h>e?e-h:o,C=f[3]+_*A[0]+f[1],S=f[0]+p*A[1]+f[2],R=g-f[3],I=y-f[0];(m||d!==0)&&(Lt[0]=R,Dt[0]=R,Lt[1]=I,St[1]=I,St[0]=R+C,Rt[0]=St[0],Rt[1]=I+S,Dt[1]=Rt[1]);let F;return d!==0?(F=li(ae(),i,n,1,1,d,-i,-n),qt(F,Lt),qt(F,St),qt(F,Rt),qt(F,Dt),Li(Math.min(Lt[0],St[0],Rt[0],Dt[0]),Math.min(Lt[1],St[1],Rt[1],Dt[1]),Math.max(Lt[0],St[0],Rt[0],Dt[0]),Math.max(Lt[1],St[1],Rt[1],Dt[1]),zt)):Li(Math.min(R,R+C),Math.min(I,I+S),Math.max(R,R+C),Math.max(I,I+S),zt),u&&(g=Math.round(g),y=Math.round(y)),{drawImageX:g,drawImageY:y,drawImageW:_,drawImageH:p,originX:c,originY:h,declutterBox:{minX:zt[0],minY:zt[1],maxX:zt[2],maxY:zt[3],value:x},canvasTransform:F,scale:A}}replayImageOrLabel_(t,e,i,n,r,o,a){const l=!!(o||a),c=n.declutterBox,h=a?a[2]*n.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,Lt,St,Rt,Dt,o,a),Qo(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=qt(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],o=this.createLabel(t,e,n,i),a=this.strokeStates[i],l=this.pixelRatio,c=Ri(Array.isArray(t)?t[0]:t,r.textAlign||Ce),h=$e[r.textBaseline||ze],d=a&&a.lineWidth?a.lineWidth:0,A=o.width/l-2*r.scale[0],u=c*A+2*(.5-c)*d,f=h*o.height/l+2*(.5-h)*d;return{label:o,anchorX:u,anchorY:f}}execute_(t,e,i,n,r,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&ci(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=se(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),Vo(this.renderedTransform_,i));let d=0;const A=n.length;let u=0,f,m,x,g,y,_,p,C,S,R,I,F,B,b=0,v=0,G=null,L=null;const D=this.coordinateCache_,E=this.viewRotation_,M=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,U={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:E},j=this.instructions!=n||this.overlaps?0:200;let N,V,$,bt;for(;d<A;){const w=n[d];switch(w[0]){case T.BEGIN_GEOMETRY:N=w[1],bt=w[3],N.getGeometry()?a!==void 0&&!q(a,bt.getExtent())?d=w[2]+1:++d:d=w[2],c&&(c.zIndex=w[4]);break;case T.BEGIN_PATH:b>j&&(this.fill_(t),b=0),v>j&&(t.stroke(),v=0),!b&&!v&&(t.beginPath(),y=NaN,_=NaN),++d;break;case T.CIRCLE:u=w[1];const ui=h[u],fi=h[u+1],Er=h[u+2],Sr=h[u+3],ln=Er-ui,cn=Sr-fi,hn=Math.sqrt(ln*ln+cn*cn);t.moveTo(ui+hn,fi),t.arc(ui,fi,hn,0,2*Math.PI,!0),++d;break;case T.CLOSE_PATH:t.closePath(),++d;break;case T.CUSTOM:u=w[1],f=w[2];const Rr=w[3],Fr=w[4],dn=w[5];U.geometry=Rr,U.feature=N,d in D||(D[d]=[]);const de=D[d];dn?dn(h,u,f,2,de):(de[0]=h[u],de[1]=h[u+1],de.length=2),c&&(c.zIndex=w[6]),Fr(de,U),++d;break;case T.DRAW_IMAGE:u=w[1],f=w[2],S=w[3],m=w[4],x=w[5];let gi=w[6];const Ir=w[7],Tr=w[8],br=w[9],An=w[10];let mi=w[11];const vr=w[12];let Te=w[13];g=w[14]||"declutter";const Ae=w[15];if(!S&&w.length>=20){R=w[19],I=w[20],F=w[21],B=w[22];const et=this.drawLabelWithPointPlacement_(R,I,F,B);S=et.label,w[3]=S;const Yt=w[23];m=(et.anchorX-Yt)*this.pixelRatio,w[4]=m;const it=w[24];x=(et.anchorY-it)*this.pixelRatio,w[5]=x,gi=S.height,w[6]=gi,Te=S.width,w[13]=Te}let xi;w.length>25&&(xi=w[25]);let pi,be,ve;w.length>17?(pi=w[16],be=w[17],ve=w[18]):(pi=Qt,be=!1,ve=!1),An&&M?mi+=E:!An&&!M&&(mi-=E);let Lr=0;for(;u<f;u+=2){if(xi&&xi[Lr++]<Te/this.pixelRatio)continue;const et=this.calculateImageOrLabelDimensions_(S.width,S.height,h[u],h[u+1],Te,gi,m,x,Tr,br,mi,vr,r,pi,be||ve,N),Yt=[t,e,S,et,Ir,be?G:null,ve?L:null];if(l){let it,mt,nt;if(Ae){const Q=f-u;if(!Ae[Q]){Ae[Q]={args:Yt,declutterMode:g};continue}const J=Ae[Q];it=J.args,mt=J.declutterMode,delete Ae[Q],nt=Zn(it)}let Ct,wt;if(it&&(mt!=="declutter"||!l.collides(nt))&&(Ct=!0),(g!=="declutter"||!l.collides(et.declutterBox))&&(wt=!0),mt==="declutter"&&g==="declutter"){const Q=Ct&&wt;Ct=Q,wt=Q}Ct&&(mt!=="none"&&l.insert(nt),this.replayImageOrLabel_.apply(this,it)),wt&&(g!=="none"&&l.insert(et.declutterBox),this.replayImageOrLabel_.apply(this,Yt))}else this.replayImageOrLabel_.apply(this,Yt)}++d;break;case T.DRAW_CHARS:const un=w[1],fn=w[2],yi=w[3],Dr=w[4];B=w[5];const Or=w[6],gn=w[7],mn=w[8];F=w[9];const _i=w[10];R=w[11],I=w[12];const xn=[w[13],w[13]];g=w[14]||"declutter";const Ci=this.textStates[I],ue=Ci.font,fe=[Ci.scale[0]*gn,Ci.scale[1]*gn];let ge;ue in this.widths_?ge=this.widths_[ue]:(ge={},this.widths_[ue]=ge);const pn=Xs(h,un,fn,2),yn=Math.abs(fe[0])*vn(ue,R,ge);if(Dr||yn<=pn){const et=this.textStates[I].textAlign,Yt=(pn-yn)*Ri(R,et),it=fl(h,un,fn,2,R,Yt,Or,Math.abs(fe[0]),vn,ue,ge,M?0:this.viewRotation_);t:if(it){const mt=[];let nt,Ct,wt,Q,J;if(F)for(nt=0,Ct=it.length;nt<Ct;++nt){J=it[nt],wt=J[4],Q=this.createLabel(wt,I,"",F),m=J[2]+(fe[0]<0?-_i:_i),x=yi*Q.height+(.5-yi)*2*_i*fe[1]/fe[0]-mn;const Et=this.calculateImageOrLabelDimensions_(Q.width,Q.height,J[0],J[1],Q.width,Q.height,m,x,0,0,J[3],xn,!1,Qt,!1,N);if(l&&g==="declutter"&&l.collides(Et.declutterBox))break t;mt.push([t,e,Q,Et,1,null,null])}if(B)for(nt=0,Ct=it.length;nt<Ct;++nt){J=it[nt],wt=J[4],Q=this.createLabel(wt,I,B,""),m=J[2],x=yi*Q.height-mn;const Et=this.calculateImageOrLabelDimensions_(Q.width,Q.height,J[0],J[1],Q.width,Q.height,m,x,0,0,J[3],xn,!1,Qt,!1,N);if(l&&g==="declutter"&&l.collides(Et.declutterBox))break t;mt.push([t,e,Q,Et,1,null,null])}l&&g!=="none"&&l.load(mt.map(Zn));for(let Et=0,Br=mt.length;Et<Br;++Et)this.replayImageOrLabel_.apply(this,mt[Et])}}++d;break;case T.END_GEOMETRY:if(o!==void 0){N=w[1];const et=o(N,bt,g);if(et)return et}++d;break;case T.FILL:j?b++:this.fill_(t),++d;break;case T.MOVE_TO_LINE_TO:for(u=w[1],f=w[2],V=h[u],$=h[u+1],t.moveTo(V,$),y=V+.5|0,_=$+.5|0,u+=2;u<f;u+=2)V=h[u],$=h[u+1],p=V+.5|0,C=$+.5|0,(u==f-2||p!==y||C!==_)&&(t.lineTo(V,$),y=p,_=C);++d;break;case T.SET_FILL_STYLE:G=w,this.alignAndScaleFill_=w[2],b&&(this.fill_(t),b=0,v&&(t.stroke(),v=0)),t.fillStyle=w[1],++d;break;case T.SET_STROKE_STYLE:L=w,v&&(t.stroke(),v=0),this.setStrokeStyle_(t,w),++d;break;case T.STROKE:j?v++:t.stroke(),++d;break;default:++d;break}}b&&this.fill_(t),v&&t.stroke()}execute(t,e,i,n,r,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,r)}}const ie=["Polygon","Circle","LineString","Image","Text","Default"],ti=["Image","Text"],xl=ie.filter(s=>!ti.includes(s));class tr{constructor(t,e,i,n,r,o,a){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=ae(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const r=t[i];for(const o in r){const a=r[o];n[o]=new ml(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let n=0,r=t.length;n<r;++n)if(t[n]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,o){n=Math.round(n);const a=n*2+1,l=li(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=le(a,a,void 0,{willReadFrequently:!0}));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=Xt(),Wo(d,t),gt(d,e*(this.renderBuffer_+n),d));const A=pl(n);let u;function f(C,S,R){const I=h.getImageData(0,0,a,a).data;for(let F=0,B=A.length;F<B;F++)if(I[A[F]]>0){if(!o||R==="none"||u!=="Image"&&u!=="Text"||o.includes(C)){const b=(A[F]-3)/4,v=n-b%a,G=n-(b/a|0),L=r(C,S,v*v+G*G);if(L)return L}h.clearRect(0,0,a,a);break}}const m=Object.keys(this.executorsByZIndex_).map(Number);m.sort(xe);let x,g,y,_,p;for(x=m.length-1;x>=0;--x){const C=m[x].toString();for(y=this.executorsByZIndex_[C],g=ie.length-1;g>=0;--g)if(u=ie[g],_=y[u],_!==void 0&&(p=_.executeHitDetection(h,l,i,f,d),p))return p}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],o=e[3],a=[i,n,i,o,r,o,r,n];return se(a,0,8,2,t,a),a}isEmpty(){return oe(this.executorsByZIndex_)}execute(t,e,i,n,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(xe),o=o||ie;const c=ie.length;let h,d,A,u,f;for(a&&l.reverse(),h=0,d=l.length;h<d;++h){const m=l[h].toString();for(f=this.executorsByZIndex_[m],A=0,u=o.length;A<u;++A){const x=o[A],g=f[x];if(g!==void 0){const y=a===null?void 0:g.getZIndexContext(),_=y?y.getContext():t,p=this.maxExtent_&&x!=="Image"&&x!=="Text";if(p&&(_.save(),this.clip(_,i)),!y||x==="Text"||x==="Image"?g.execute(_,e,i,n,r,a):y.pushFunction(C=>g.execute(C,e,i,n,r,a)),p&&_.restore(),y){y.offset();const C=l[h]*c+A;this.deferredZIndexContexts_[C]||(this.deferredZIndexContexts_[C]=[]),this.deferredZIndexContexts_[C].push(y)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(xe);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),t[e[i]].length=0}}const Fi={};function pl(s){if(Fi[s]!==void 0)return Fi[s];const t=s*2+1,e=s*s,i=new Array(e+1);for(let r=0;r<=s;++r)for(let o=0;o<=s;++o){const a=r*r+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((s+r)*t+(s+o))*4+3),r>0&&l.push(((s-r)*t+(s+o))*4+3),o>0&&(l.push(((s+r)*t+(s-o))*4+3),r>0&&l.push(((s-r)*t+(s-o))*4+3))}const n=[];for(let r=0,o=i.length;r<o;++r)i[r]&&n.push(...i[r]);return Fi[s]=n,n}class yl extends qs{constructor(t,e,i,n,r,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?Ko(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=ae()}drawImages_(t,e,i,n){if(!this.image_)return;const r=se(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,d=r.length;h<d;h+=2){const A=r[h]-this.imageAnchorX_,u=r[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const f=A+this.imageAnchorX_,m=u+this.imageAnchorY_;li(a,f,m,1,1,c,-f,-m),o.save(),o.transform.apply(o,a),o.translate(f,m),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,A,u,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=se(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const l=r[e]+this.textOffsetX_,c=r[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,n,r){const o=this.context_,a=se(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return r&&o.closePath(),i}drawRings_(t,e,i,n){for(let r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=jo(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(q(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=t.getFlatCoordinates();let r=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)r=this.moveToLineTo_(n,r,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!q(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=r.length;a<l;++a){const c=r[a];n=this.drawRings_(i,n,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),ci(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Ce;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:Pt(i||ot)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),n=e.getLineCap(),r=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=r||Ft;this.strokeState_={lineCap:n!==void 0?n:Ke,lineDash:this.pixelRatio_===1?h:h.map(d=>d*this.pixelRatio_),lineDashOffset:(o||It)*this.pixelRatio_,lineJoin:a!==void 0?a:je,lineWidth:(l!==void 0?l:Xe)*this.pixelRatio_,miterLimit:c!==void 0?c:Je,strokeStyle:Pt(i||We)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const u=e.getColor();this.textFillState_={fillStyle:Pt(u||ot)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const u=i.getColor(),f=i.getLineCap(),m=i.getLineDash(),x=i.getLineDashOffset(),g=i.getLineJoin(),y=i.getWidth(),_=i.getMiterLimit();this.textStrokeState_={lineCap:f!==void 0?f:Ke,lineDash:m||Ft,lineDashOffset:x||It,lineJoin:g!==void 0?g:je,lineWidth:y!==void 0?y:Xe,miterLimit:_!==void 0?_:Je,strokeStyle:Pt(u||We)}}const n=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),d=t.getTextAlign(),A=t.getTextBaseline();this.textState_={font:n!==void 0?n:Ls,textAlign:d!==void 0?d:Ce,textBaseline:A!==void 0?A:ze},this.text_=h!==void 0?Array.isArray(h)?h.reduce((u,f,m)=>u+=m%2?" ":f,""):h:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const tt=.5;function er(s,t,e,i,n,r,o,a,l){const c=l?Os(n):n,h=s[0]*tt,d=s[1]*tt,A=le(h,d);A.imageSmoothingEnabled=!1;const u=A.canvas,f=new yl(A,tt,n,null,o,a,l?Xo(Jo(),l):null),m=e.length,x=Math.floor((256*256*256-1)/m),g={};for(let _=1;_<=m;++_){const p=e[_-1],C=p.getStyleFunction()||i;if(!C)continue;let S=C(p,r);if(!S)continue;Array.isArray(S)||(S=[S]);const I=(_*x).toString(16).padStart(7,"#00000");for(let F=0,B=S.length;F<B;++F){const b=S[F],v=b.getGeometryFunction()(p);if(!v||!q(c,v.getExtent()))continue;const G=b.clone(),L=G.getFill();L&&L.setColor(I);const D=G.getStroke();D&&(D.setColor(I),D.setLineDash(null)),G.setText(void 0);const E=b.getImage();if(E){const N=E.getImageSize();if(!N)continue;const V=le(N[0],N[1],void 0,{alpha:!1}),$=V.canvas;V.fillStyle=I,V.fillRect(0,0,$.width,$.height),G.setImage(new ce({img:$,anchor:E.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:E.getOrigin(),opacity:1,size:E.getSize(),scale:E.getScale(),rotation:E.getRotation(),rotateWithView:E.getRotateWithView()}))}const M=G.getZIndex()||0;let U=g[M];U||(U={},g[M]=U,U.Polygon=[],U.Circle=[],U.LineString=[],U.Point=[]);const j=v.getType();if(j==="GeometryCollection"){const N=v.getGeometriesArrayRecursive();for(let V=0,$=N.length;V<$;++V){const bt=N[V];U[bt.getType().replace("Multi","")].push(bt,G)}}else U[j.replace("Multi","")].push(v,G)}}const y=Object.keys(g).map(Number).sort(xe);for(let _=0,p=y.length;_<p;++_){const C=g[y[_]];for(const S in C){const R=C[S];for(let I=0,F=R.length;I<F;I+=2){f.setStyle(R[I+1]);for(let B=0,b=t.length;B<b;++B)f.setTransform(t[B]),f.drawGeometry(R[I])}}}return A.getImageData(0,0,u.width,u.height)}function ir(s,t,e){const i=[];if(e){const n=Math.floor(Math.round(s[0])*tt),r=Math.floor(Math.round(s[1])*tt),o=(Ln(n,0,e.width-1)+Ln(r,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],h=e.data[o+2]+256*(l+256*a),d=Math.floor((256*256*256-1)/t.length);h&&h%d===0&&i.push(t[h/d-1])}return i}const _l=.5,nr={Point:Tl,LineString:Rl,Polygon:vl,MultiPoint:bl,MultiLineString:Fl,MultiPolygon:Il,GeometryCollection:Sl,Circle:wl};function Cl(s,t){return parseInt(P(s),10)-parseInt(P(t),10)}function Ni(s,t){const e=sr(s,t);return e*e}function sr(s,t){return _l*s/t}function wl(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const l=s.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(r,o),l.drawCircle(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function ei(s,t,e,i,n,r,o,a){const l=[],c=e.getImage();if(c){let A=!0;const u=c.getImageState();u==pe.LOADED||u==pe.ERROR?A=!1:u==pe.IDLE&&c.load(),A&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const d=l.length>0;return d&&Promise.all(l).then(()=>n(null)),El(s,t,e,i,r,o,a),d}function El(s,t,e,i,n,r,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,n);if(e.getRenderer())rr(s,l,e,t,o);else{const h=nr[l.getType()];h(s,l,e,t,o,r)}}function rr(s,t,e,i,n){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)rr(s,o[a],e,i,n);return}s.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),n)}function Sl(s,t,e,i,n,r){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=nr[o[a].getType()];c(s,o[a],e,i,n,r)}}function Rl(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=s.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function Fl(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=s.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function Il(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(o||r){const l=s.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawMultiPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}function Tl(s,t,e,i,n,r){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=r&&o&&l?{}:void 0;if(o){if(o.getImageState()!=pe.LOADED)return;const h=s.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,i,n)}if(l){const h=s.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,i,n)}}function bl(s,t,e,i,n,r){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=r&&a&&c?{}:void 0;if(a){if(o.getImageState()!=pe.LOADED)return;const d=s.getBuilder(e.getZIndex(),"Image");d.setImageStyle(o,h),d.drawMultiPoint(t,i,n)}if(c){const d=s.getBuilder(e.getZIndex(),"Text");d.setTextStyle(l,h),d.drawText(t,i,n)}}function vl(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const l=s.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}class Ll extends zo{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Xt(),this.wrappedRenderedExtent_=Xt(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,o=r.center,a=r.resolution,l=r.projection,c=r.rotation,h=l.getExtent(),d=this.getLayer().getSource(),A=this.getLayer().getDeclutter(),u=e.pixelRatio,f=e.viewHints,m=!(f[xt.ANIMATING]||f[xt.INTERACTING]),x=this.context,g=Math.round(Ht(n)/a*u),y=Math.round(Ve(n)/a*u),_=d.getWrapX()&&l.canWrapX(),p=_?Ht(h):null,C=_?Math.ceil((n[2]-h[2])/p)+1:1;let S=_?Math.floor((n[0]-h[0])/p):0;do{let R=this.getRenderTransform(o,a,0,u,g,y,S*p);e.declutter&&(R=R.slice(0)),t.execute(x,[x.canvas.width,x.canvas.height],R,c,m,i===void 0?ie:i?ti:xl,i?A&&e.declutter[A]:void 0)}while(++S<C)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=le(this.context.canvas.width,this.context.canvas.height,Dn))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,bs(this.context),Dn.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const r=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(On.PRERENDER)||this.getLayer().hasListener(On.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(r,t),n.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=Zo(i.extent);a=q(l,t.extent),this.clipped_=a&&!ee(l,t.extent),this.clipped_&&this.clipUnrotated(r,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&r.restore(),this.postRender(r,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],d=i[0]*tt,A=i[1]*tt;h.push(this.getRenderTransform(n,r,o,tt,d,A,0).slice());const u=c.getSource(),f=a.getExtent();if(u.getWrapX()&&a.canWrapX()&&!ee(f,l)){let m=l[0];const x=Ht(f);let g=0,y;for(;m<f[0];)--g,y=x*g,h.push(this.getRenderTransform(n,r,o,tt,d,A,y).slice()),m+=x;for(g=0,m=l[2];m>f[2];)++g,y=x*g,h.push(this.getRenderTransform(n,r,o,tt,d,A,y).slice()),m-=x}this.hitDetectionImageData_=er(i,h,this.renderedFeatures_,c.getStyleFunction(),l,r,o,Ni(r,this.renderedPixelRatio_),null)}e(ir(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(f,m,x){const g=P(f),y=c[g];if(y){if(y!==!0&&x<y.distanceSq){if(x===0)return c[g]=!0,r.splice(r.lastIndexOf(y),1),n(f,l,m);y.geometry=m,y.distanceSq=x}}else{if(x===0)return c[g]=!0,n(f,l,m);r.push(c[g]={feature:f,layer:l,geometry:m,distanceSq:x,callback:n})}};let d;const A=[this.replayGroup_],u=this.getLayer().getDeclutter();return A.some(f=>d=f.forEachFeatureAtCoordinate(t,o,a,i,h,u&&e.declutter[u]?e.declutter[u].all().map(m=>m.value):null)),d}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[xt.ANIMATING],r=t.viewHints[xt.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,d=c.resolution,A=t.pixelRatio,u=e.getRevision(),f=e.getRenderBuffer();let m=e.getRenderOrder();m===void 0&&(m=Cl);const x=c.center.slice(),g=gt(l,f*d),y=g.slice(),_=[g.slice()],p=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!ee(p,t.extent)){const L=Ht(p),D=Math.max(Ht(g)/2,L);g[0]=p[0]-D,g[2]=p[2]+D,Bs(x,h);const E=Ho(_[0],h);E[0]<p[0]&&E[2]<p[2]?_.push([E[0]+L,E[1],E[2]+L,E[3]]):E[0]>p[0]&&E[2]>p[2]&&_.push([E[0]-L,E[1],E[2]-L,E[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==u&&this.renderedRenderOrder_==m&&this.renderedFrameDeclutter_===!!t.declutter&&ee(this.wrappedRenderedExtent_,g))return ci(this.renderedExtent_,y)||(this.hitDetectionImageData_=null,this.renderedExtent_=y),this.renderedCenter_=x,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const C=new $s(sr(d,A),g,d,A);let S;for(let L=0,D=_.length;L<D;++L)i.loadFeatures(_[L],d,h);const R=Ni(d,A);let I=!0;const F=(L,D)=>{let E;const M=L.getStyleFunction()||e.getStyleFunction();if(M&&(E=M(L,d)),E){const U=this.renderFeature(L,R,E,C,S,this.getLayer().getDeclutter(),D);I=I&&!U}},B=Os(g),b=i.getFeaturesInExtent(B);m&&b.sort(m);for(let L=0,D=b.length;L<D;++L)F(b[L],L);this.renderedFeatures_=b,this.ready=I;const v=C.finish(),G=new tr(g,d,A,i.getOverlaps(),v,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=d,this.renderedRevision_=u,this.renderedRenderOrder_=m,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=y,this.wrappedRenderedExtent_=g,this.renderedCenter_=x,this.renderedProjection_=h,this.renderedPixelRatio_=A,this.replayGroup_=G,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=ei(n,t,i[c],e,this.boundHandleStyleImageChange_,r,o,a)||l;else l=ei(n,t,i,e,this.boundHandleStyleImageChange_,r,o,a);return l}}class Nt extends Ps{constructor(t){super(t)}createRenderer(){return new Ll(this)}}const Dl={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},qn={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class Ol extends qo{constructor(t,e){super(t,e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=ae(),this.tileClipContexts_=null}drawTile(t,e,i,n,r,o,a,l){this.updateExecutorGroup_(t,e.pixelRatio,e.viewState.projection),this.tileImageNeedsRender_(t)&&this.renderTileImage_(t,e),super.drawTile(t,e,i,n,r,o,a,l)}getTile(t,e,i,n){const r=this.getOrCreateTile(t,e,i,n);if(!r)return null;const a=n.viewState.resolution,l=n.viewHints;return(!(l[xt.ANIMATING]||l[xt.INTERACTING])||!r.wantedResolution)&&(r.wantedResolution=a),r}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const n=this.getLayer(),r=n.getRevision(),o=n.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(n);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==r&&l.renderedRenderOrder==o)return;const c=n.getSource(),h=!!n.getDeclutter(),d=c.getTileGrid(),u=c.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),f=c.getSourceTiles(e,i,t),m=P(n);delete t.hitDetectionImageData[m],t.executorGroups[m]=[],l.dirty=!1;for(let x=0,g=f.length;x<g;++x){const y=f[x];if(y.getState()!=Y.LOADED)continue;const _=y.tileCoord,p=d.getTileCoordExtent(_),C=vs(u,p),S=gt(C,n.getRenderBuffer()*a,this.tempExtent),R=Ji(p,C)?null:S,I=new $s(0,C,a,e),F=Ni(a,e),B=function(D,E){let M;const U=D.getStyleFunction()||n.getStyleFunction();if(U&&(M=U(D,a)),M){const j=this.renderFeature(D,F,M,I,h,E);l.dirty=l.dirty||j}},b=y.getFeatures();o&&o!==l.renderedRenderOrder&&b.sort(o);for(let D=0,E=b.length;D<E;++D){const M=b[D];(!R||q(R,M.getGeometry().getExtent()))&&B.call(this,M,D)}const v=I.finish(),G=n.getRenderMode()!=="vector"&&h&&f.length===1?null:C,L=new tr(G,a,e,c.getOverlaps(),v,n.getRenderBuffer(),!0);t.executorGroups[m].push(L)}l.renderedRevision=r,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,n,r){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),h=l.getSource().getTileGridForProjection(e.viewState.projection),d=$o([t]);gt(d,o*i,d);const A={},u=function(x,g,y){let _=x.getId();_===void 0&&(_=P(x));const p=A[_];if(p){if(p!==!0&&y<p.distanceSq){if(y===0)return A[_]=!0,r.splice(r.lastIndexOf(p),1),n(x,l,g);p.geometry=g,p.distanceSq=y}}else{if(y===0)return A[_]=!0,n(x,l,g);r.push(A[_]={feature:x,layer:l,geometry:g,distanceSq:y,callback:n})}},f=this.renderedTiles;let m;for(let x=0,g=f.length;!m&&x<g;++x){const y=f[x],_=h.getTileCoordExtent(y.wrappedTileCoord);if(!q(_,d))continue;const p=P(l),C=[y.executorGroups[p]],S=l.getDeclutter();C.some(R=>{const I=S?e.declutter[S].all().map(F=>F.value):null;for(let F=0,B=R.length;F<B;++F)if(m=R[F].forEachFeatureAtCoordinate(t,o,a,i,u,I),m)return!0})}return m}getFeatures(t){return new Promise((e,i)=>{const n=this.getLayer(),r=P(n),o=n.getSource(),a=this.renderedProjection,l=a.getExtent(),c=this.renderedResolution,h=o.getTileGridForProjection(a),d=qt(this.renderedPixelToCoordinateTransform_,t.slice()),A=h.getTileCoordForCoordAndResolution(d,c);let u;for(let _=0,p=this.renderedTiles.length;_<p;++_)if(A.toString()===this.renderedTiles[_].tileCoord.toString()){if(u=this.renderedTiles[_],u.getState()===Y.LOADED){const C=h.getTileCoordExtent(u.tileCoord);o.getWrapX()&&a.canWrapX()&&!ee(l,C)&&Bs(d,a);break}u=void 0}if(!u||u.loadingSourceTiles>0){e([]);return}const f=h.getTileCoordExtent(u.wrappedTileCoord),m=ta(f),x=[(d[0]-m[0])/c,(m[1]-d[1])/c],g=u.getSourceTiles().reduce(function(_,p){return _.concat(p.getFeatures())},[]);let y=u.hitDetectionImageData[r];if(!y){const _=Zi(h.getTileSize(h.getZForResolution(c,o.zDirection))),p=this.renderedRotation_,C=[this.getRenderTransform(h.getTileCoordCenter(u.wrappedTileCoord),c,0,tt,_[0]*tt,_[1]*tt,0)];y=er(_,C,g,n.getStyleFunction(),h.getTileCoordExtent(u.wrappedTileCoord),u.getReplayState(n).renderedResolution,p),u.hitDetectionImageData[r]=y}e(ir(x,g,y))})}getFeaturesInExtent(t){const e=[],i=this.getTileCache();if(i.getCount()===0)return e;const n=this.getLayer().getSource().tileGrid,r=n.getZForResolution(this.renderedResolution);return i.forEach(o=>{if(o.tileCoord[0]!==r||o.getState()!==Y.LOADED)return;const a=o.getSourceTiles();for(let l=0,c=a.length;l<c;++l){const h=a[l],d=h.tileCoord;if(q(t,n.getTileCoordExtent(d))){const A=h.getFeatures();if(A)for(let u=0,f=A.length;u<f;++u){const m=A[u],x=m.getGeometry();q(t,x.getExtent())&&e.push(m)}}}}),e}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const i=this.context,n=i.globalAlpha;i.globalAlpha=e.opacity;const r=t.viewHints,o=!(r[xt.ANIMATING]||r[xt.INTERACTING]),a=this.renderedTiles;for(let l=0,c=a.length;l<c;++l){const h=a[l],d=h.executorGroups[P(this.getLayer())],A=this.getLayer().getDeclutter();if(d)for(let u=d.length-1;u>=0;--u)d[u].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(h,t),t.viewState.rotation,o,ti,A?t.declutter[A]:void 0)}i.globalAlpha=n}renderDeferredInternal(t){const i=this.renderedTiles.reduce((a,l,c)=>(l.executorGroups[P(this.getLayer())].forEach(h=>a.push({executorGroup:h,index:c})),a),[]),n=i.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),r={};for(let a=0,l=i.length;a<l;++a){const c=i[a].executorGroup.getDeferredZIndexContexts();for(const h in c)r[h]=!0}Object.keys(r).sort(xe).map(Number).forEach(a=>{n.forEach((l,c)=>{l[a]&&(l[a].forEach(h=>{const{executorGroup:d,index:A}=i[c],u=d.getRenderedContext(),f=u.globalAlpha;u.globalAlpha=this.renderedOpacity_;const m=this.tileClipContexts_[A];m&&m.draw(u),h.draw(u),m&&u.restore(),u.globalAlpha=f,h.clear()}),l[a].length=0)})})}getTileRenderTransform(t,e){const i=e.pixelRatio,n=e.viewState,r=n.center,o=n.resolution,a=n.rotation,l=e.size,c=Math.round(l[0]*i),h=Math.round(l[1]*i),A=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),u=t.tileCoord,f=A.getTileCoordExtent(t.wrappedTileCoord),m=A.getTileCoordExtent(u,this.tempExtent)[0]-f[0];return ea(wi(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(r,o,a,i,c,h,m))}postRender(t,e){var p;const i=e.viewHints,n=!(i[xt.ANIMATING]||i[xt.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const r=this.getLayer(),o=r.getRenderMode(),a=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=r.getDeclutter(),c=l?qn[o].filter(C=>!ti.includes(C)):qn[o],h=e.viewState,d=h.rotation,A=r.getSource(),f=A.getTileGridForProjection(h.projection).getZForResolution(h.resolution,A.zDirection),m=this.renderedTiles,x=[],g=[],y=[];let _=!0;for(let C=m.length-1;C>=0;--C){const S=m[C];_=_&&!S.getReplayState(r).dirty;const R=S.executorGroups[P(r)].filter(L=>L.hasExecutors(c));if(R.length===0)continue;const I=this.getTileRenderTransform(S,e),F=S.tileCoord[0];let B=!1;const b=R[0].getClipCoords(I);let v=t,G;if(b){G=new Ds,v=G.getContext();for(let L=0,D=x.length;L<D;++L)if(f!==F&&F<g[L]){const E=x[L];q([b[0],b[3],b[4],b[7]],[E[0],E[3],E[4],E[7]])&&(B||(v.save(),B=!0),v.beginPath(),v.moveTo(b[0],b[1]),v.lineTo(b[2],b[3]),v.lineTo(b[4],b[5]),v.lineTo(b[6],b[7]),v.moveTo(E[6],E[7]),v.lineTo(E[4],E[5]),v.lineTo(E[2],E[3]),v.lineTo(E[0],E[1]),v.clip())}x.push(b),g.push(F)}for(let L=0,D=R.length;L<D;++L)R[L].execute(t,[t.canvas.width,t.canvas.height],I,d,n,c,(p=e.declutter)==null?void 0:p[l]);B&&(v===t?v.restore():y[C]=G)}t.globalAlpha=a,this.ready=_,this.tileClipContexts_=y,e.declutter||this.renderDeferredInternal(e),super.postRender(t,e)}renderFeature(t,e,i,n,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,c=i.length;l<c;++l)a=ei(n,t,i[l],e,this.boundHandleStyleImageChange_,void 0,r,o)||a;else a=ei(n,t,i,e,this.boundHandleStyleImageChange_,void 0,r,o);return a}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const i=t.getReplayState(e),n=e.getRevision(),r=t.wantedResolution;return i.renderedTileResolution!==r||i.renderedTileRevision!==n}renderTileImage_(t,e){const i=this.getLayer(),n=t.getReplayState(i),r=i.getRevision(),o=t.executorGroups[P(i)];n.renderedTileRevision=r;const a=t.wrappedTileCoord,l=a[0],c=i.getSource();let h=e.pixelRatio;const A=e.viewState.projection,u=c.getTileGridForProjection(A),f=u.getResolution(t.tileCoord[0]),m=e.pixelRatio/t.wantedResolution*f,x=u.getResolution(l),g=t.getContext();h=Math.round(Math.max(h,m/h));const y=c.getTilePixelSize(l,h,A);g.canvas.width=y[0],g.canvas.height=y[1];const _=h/m;if(_!==1){const R=Bn(this.tmpTransform_);wi(R,_,_),g.setTransform.apply(g,R)}const p=u.getTileCoordExtent(a,this.tempExtent),C=m/x,S=Bn(this.tmpTransform_);wi(S,C,-C),ia(S,-p[0],-p[3]);for(let R=0,I=o.length;R<I;++R)o[R].execute(g,[g.canvas.width*_,g.canvas.height*_],S,0,!0,Dl[i.getRenderMode()],null);n.renderedTileResolution=t.wantedResolution}}class Bl extends Ps{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload;const i=t.cacheSize===void 0?0:t.cacheSize;delete t.cacheSize,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i;const n=t.renderMode||"hybrid";ne(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new Ol(this,{cacheSize:this.cacheSize_})}getFeatures(t){return super.getFeatures(t)}getFeaturesInExtent(t){return this.getRenderer().getFeaturesInExtent(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Le.PRELOAD)}getUseInterimTilesOnError(){return this.get(Le.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(Le.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(Le.USE_INTERIM_TILES_ON_ERROR,t)}}const Pl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAAB60lEQVQ4Ea1VwS4DURS9BBvCsKlNk2FLolaiq1qQhoVKWBt/UF/Q9gMEX9CxRdJaENKFdlPLToQlKrXQDUPYsOCc6bxGeKrUSe686X33nd659533RPQw4I7DMrAr2JtvJd9nYdSiTeONwZeOhAPG8tKwRMKDYga7vTDn7F6c83vZO6pI9rBShjMFs2F1fCZcN4M98fT6JIgC9SDdS7nyLFOLOSlXnpKYJ7GHj4SJ0OhA8nh3WozeTjXfcHQfXzxSZL6BwFUGK0ILmaVLubmmydQ/kXR8+oCZLsCXbfcnEo0yS62dytBEBnW7UTz10ejtEpYISMMMElqxaNBUheeMAus0PnMg+ZOquA+v8oBsdGC92UTMWSScn48GdXHo6J2w0172fY3ryjgg0oGHGRrp1xIic61f5+T2AsaYYeg7Qt3C73x+yUwS/itIWGbxWwUVBDgkdAroYqugLIFrEhbs7YtW+Tx9g8Tb2Ha+WHVhfyZlyfzDwlbSi0F6mVJuFtLr+hWx+/gK6e1TeitYaKsuZ+HY5OlBbTYLkvknTopkXKcI+R5HYVM1of/cdZaImTlnd5tYmyQBoT659qv2tDAkqG8qZQwqUhuftcoXb2Vr5xJj1UUcPzMLawoWongF8NhXVwCvA/riMB4GX/AO0EK4gq4xIIQAAAAASUVORK5CYII=",kl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACXElEQVQ4EY1VPW/TUBS9RdCFqjIsRUiRXDYEIumEyBSGSBUdmkp8jHUkfoCj7sT5BW1/gYPEBEh1BxBVBtIlEQIpHgpigRhloQzEVHQpgznnJc91HVN6pJv3fO99x/fdj1gkGwbUNmQL0odEY+mNdRbWTExlaCvQuaXinLH64JqUilfEzF1Ubv7eUPyPQ9neGYj3ZhBA2YA0ITHShOtmbsZ21++AaC52ytoEg0O5e78lweC3AzuJFZKE9cLNy87bl2UxZi9o+6lreHCkSBH5BhxrdNaEFiJze62lM5PpN5F0ofyaka5A550bG+pZkelrTV19JpRqrYuDh5pLrcbstDBFgAsxSGhVFnOmTjwtGsxR/sYlGX5+JP13KxJFEUg72hyvzDeLCIVFwuXlxVxs1JtRJJHYj6+rNPCFzlpe2p194TXTYEcApfP4MQuIIg0SMKokkCe00AxeMJ1Uqz3bC8gzwkIWofJK/IQHf1QOVx+qSBKW0XacMpOE/wXJmE++2Fm7dao/CYN05dInak/eK5W7UUyb4mdOEOCT0N/t7seG9KZqd8T/FEpWWyV9OZbANxLuNp9/Sdrifa3+QdrdH9JEn4W/jlQP/us2nG/A46Swf/qIwEjOLw/O3+afzSQYbYZvAM95PXoVtMNWr3UvsyUmKY81LNhC+RVHrwptU1fZg2KTlcxq2uPjJ3e6+jjbIBmtmpB7G4ltjAb95LzSmAYnhpH5ez83YXO0XV9ZP3O1IHXON0TNsm585rXd+S5PX3zlCIbw4zU9yJlgwYtV6UH0J4CfA+psCIs5gb9vzOmWEVmx1QAAAABJRU5ErkJggg==",Gl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACiElEQVQ4EY1Vz2sTURCe+qMKLXXjJSINbPQkFpqCqM3FeAgEPSQFf926Ae8mf0GSv6DpWSQpeKpC0oPSkoPpJUVQskILOWgTCYi9NGmxl3rQ79vsW7Kbpe3AZF5m5n078943uyL+osGdgVagbeg/W5u2z4D1lTEfbwq+Uiwa1Baf3pBY9JrooQkrzdzuibnTk7WNrlTXux04C9Ay1BEv4JIemsyUluYBFHSS/Bad7pE8fFKTTvdPHnECWzIMmIvMXM1/eh8Xbeqiip9o+4fHFigqLyIxy2QFaKCyUrP2+Mxg6kkEnYt/ZKUL8FXP2YGcX2WqrbHrb4U6aPFIYVlWmxoXHhGkBNUIaKQSIV0dPCNKCDB7OyC91nNpf16QCNbpbEOFHcvz5iXCYRAwmUyEnKBasDomFgt3rGPgA1+9vCX1xh7ac1fJPWQEJEZAnU/2CgHsVpzQ2noXFJp0aOQEsCC9ILMX8BPxA2RUSTq7xUOX/uFfqbx5oNwuax+ZzgpPFX16QmLzQekfHMvKu90T80mbNg7c91K8O0mR8N2qlIpRSSWmXWFO0Fz8g8kKzc2tPVeQfzhmy69bLj8pEpkJyLedfZdf5cP+JOBmefXHSAKryeS+uEBXVnetW158dnMkn/MNqbJl8qcNYmve+cULQLK5r9aFMNsisU+7pFH4XqWDlLAavRToUGnWHlmbuHlYFO/8yM+bx9nxoWnsKZ+3N7bQYmCj/uv+i6Quly8p9yCqXRkXqlcIxmlqfT8oIMYXhAzTJoOLKAwGfXQSvGCcGFZmbu8vI5ZXcdWy+k9rQHOcb6g1y4r4bL3e+G1xEYB95LHNKvRMYiCLnwC+9tUnoG37MrAadET+A5b38dBIuf2xAAAAAElFTkSuQmCC",Ml="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACP0lEQVQ4EZ1VsW4TQRAdUKABhYMmNJYuSYMEIk6FcOUUlqJQxJFCKNkgUXMRH+DzByDHNcWZEhHJpiACuUjSOE0kn6IgpQJHpiANOSLcOAW8t9yenPM5NjxpvHezs8+zb2f2RJJhwe3AqrCvsN+hNUOfwpiISwnePHxeNjNhPX08JdnMbbFT13SYf3Ai/ucTef+pLbWP7RacRVgFFiFOWLJT1x2v9BBEE1FQ0kOr3ZG55bq02r9czJNYo5ewkL53y93ayIk1fsXMXzgGp11NiszXEbjGYEOokJnXrD8amcz8E0lnc5vMdAm+2uVwojAss+KrfZl8UNUaGjKO1vhVoUSAx1cSqvx8yjbCcyYO6rX++lCCn2ewbnxa681DxIQi4eLifKovqNdB8V88vyPWjcHasiKALAnt9N2bvevPPZeRGeG+vH/OH39heQEzY/hJDyLkVl1ox8MahlAymxkOxFphT2/1In3ji0nYYiZxVN5+ke3GsaiVaZRERxtjjr51JDg9i4eb0/e5ZX9n9xinrEWNAuHDwq4ulciJB+U0RD2ZNqUSTbEtgSMWtoMjL7EOh4F16JUyiW259GyH/b3KLVewtYDb+19QkvCyqJjWy6P1qs36gq78fyGmnrO5D2y9VSZnTrkGR5kFTN1GBcnCG6dIMq4zhHx2IGzxb6P3nzoDekGJmJl/8KMMv2vmzJbNO0cFK7C/YTKDLjKFT622G9/lzTtdUgHiuM0abCQoRPETwGvffAL4OaDPgfEy6MMf5Dvf2UslcMoAAAAASUVORK5CYII=",Ul="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACf0lEQVQ4EY1VTWsTURS99RuUdtqFdTM40Y3QYlMQ1KziIlh0kQRU3HWK7p3iD0jyA0rStULiVoXEhWLJwmQTEYQMUjULNSMRsRuTlnZTF3rOdN6QzIzaA3fee/fdOe+++zEjEg0NagtShXQhvz1pezoTYyTGIrQZ6MrJxLS2ePOMJBOnxNCPu2b2el/s9315ttaT2sueA2UBUoH4CBIWDf2EVS5eBtG0bxQ1cXo7cuVGXZzedh77JHYxTJiLz07lXz1NiTZ+WO3/cxxs7bqk8LwEw2UaK0ITnpXb9ev7JlMnkXQ+9YKeZqGrKcJu903WULFSxqsPOlJ6+FEt3REHC28xjEZrg54OoIsdwsPMLOghMr7ABMRnpuTe3XNcutDGj6ipPzLeTCKITRKm0wu6vzk8cb5tS+aq/t8E8R1WBAiTJDTiM5PDPP4ccZHTuCKvTvDgYFiUMcsLmDuAR/zvhDuyZLXE/tCXxusNiV2sSmHlneIYGb2DDHoYCWYvf/+8LN4663vlBX9EF3yZHjos0iAY/BwIh6/I4HPdhLdBMIGATUI7yoAeRl9vTCYiMs22BL6SsFl5/JmLEEpIhiIdbP2S5dxb1yaZOBmyZX8DbmFrmHRRrFqwf3lq9k6TXeAScL+YvyDx2dGqYMiQMAdGMdUpGXRAtV2/htYLFy69G2zujsTTPQEP7s2nnvPQJSwrB72NDmI2udb4ful22pBjR5V6b5drbSL6IH5xOp82C7DkB0IYQwULVyzsNXo468pIjSwhemav/1yFLq/06spqzdGE5NjfEJlDF6nCZ6warR/y6MkXthk/BrxmDbIvmLDiL4CfffUL4O+AOguiQUL4AxQW8ADbO5FsAAAAAElFTkSuQmCC",Nl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACrUlEQVQ4EY1VQWsTYRCd2loFJW56iYiBrXgItNgUBW0vbQ+xRQ+JqKgntwcPgocUDx43+QES/QGSCF6sSlKkYsihKUh6ERKlhR5sm5Ii9tKkxRxakfreJt8SNhvpg9lvd2b27eyb+XZF3KHBHYWlYRuww6YVmz4Dqyu6XLwR+JLjoz7t4d0LMj56VnT/KSuttFyV0kpV5rIVyXyulOGMw1IwG07ChO4/HU0mRkDks5PcTsqVukzcyUm58juGOIkttBKawcG+2ML7kGie4yr+37W2d2CRovIXSJxhsiI0UFmymLt5ZDL1JJIOhz6x0lvwZY41A2anyuLPv4s3MCtd597I8PV5S0NFxlXz9AolApK8JKERmfLrSnhGFGbMr5LJbsnCh5BUV+9JeNIvE7dzwqpaQb3ZRPiMbhzMZ08GA8EBb2sOXqEuDx5/kaWPUxK46JGTJ7qtRu3v/8V5j915+yYM1lx2a78HDt1JxqRvKzsWgXamV1Jv12Rzqy5jIz4xn16yOVpPOF7AEAmDboScN2I4NG9VQ61Ss+sCeSQRv2zFWg9NyXQSdkS+sI2br0j0UcDKoQx8QHjyfMc5ZVPKTHSCFQUH+mwyxlkFG7C4tO1MV90vkbDkljCEJmG22m5kh/kwJ7gtgU0SLqZm15xxuyGcw9reHyvOc94Yho5OcH8DGe4Uzs8GBltz7l9KMT1TEGpJYDdJ+tWYBAfbR6z/arqMlH619SJIThdzN1xfhxXWdg/aZw8MjLFRkGcalykONrEKbbzZ/M9r98O6NcQNd+PIoeY8OkEyfnFWf+zGEeMHQqihQhT6xBsbvb3rKkmtlIGVlZZ3XsIXU371yuqaqwEzub85xOy2Gnxqmi/8ktfv1qlrDXl8zQzsSDCQxV8AP/vqF7DR9EWxarA2/APTqP6lLyWxXQAAAABJRU5ErkJggg==",Yl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACN0lEQVQ4EY1VPU8bQRCdoCQNETI0pLF0mBIEThlXToGEoMCWAilZ+AVn5Qec/Qfi8AfiS5kPyeciEcgFduMoEshWREqw0TXQBAuFJimS9+zbk41XZz9pbm/fzr6bnd3ZEzEjBtqGlWFt2L/AmgGn0BrxwMBmwJXSqfnY7nZC0qmnYsWne26tsxtp/byRypEv3qHfAVmAubAQ9wWLVvyJXSo+h9B86GR66fh38uJlVTr+7zzGKdzDoKCTXJ7LH39ek9jMIz0e2XZv//REEflbOOborAUVIis1q5sTi+kvUfTZ2ldGmgXnacF2+3vW0rmic+XQF9s50fOG2vK7tCSXZkOu1rhmpF0QCw/xUJn1+JAYPVeX5qRUTPE1BPO2l2tgFY9Dji/MNzcRwoqCW1vr8SEHdhjtYMTksvt1Ua8WR3iO8URAME1BazB8DprAZfHIcNNM4PECVqfwSE4iWHjzQ3Z3EsboqBSsxqLgWOAQYxfvRO0sjvWlYIfOUcg5p5HRcS7TwYaCrfq3a3aMcD9c9Pj86xXjuCZZlsAlBevux3PNj7TMnTNGjJNY34BHQRc72OUu3oeOTmEzosCUBZeFqyslg9IrN6sbI4c2Sohj3du/KL0vLL09dF1GSHggDnh7sDYnBcWCG6eAOS7naUG+20hsoV/o0btOZ6aIkbXOfh2gmydH6CX3e/2nQuOwvmGo6dnwImCuao0ref/pgoK8DLhMDzYRFLz4C+C1r38B/B2Qs2Ex2Aj+A+Wp1NVgc0jkAAAAAElFTkSuQmCC",Ql="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAAClklEQVQ4EY1VQWsTURCeqo2Cod16iYiRTU+KxcaL2l4aD8Wgh6Sg1IPgCno2xR+Q5A9Y/QGSFLxYhawHpSUH00tFELJKCzlok5JS7KWJpbnoIX7fZl+a7G6lHwxvd2be92bmzeyK+EODOgUpQKqQtiNlR2dg9cWAjzYJXS42GdIe3huV2ORZ0cOnbTdrrSHWekPeL9fFXKrXoMxC8pAu3ITzejiYys1PgCjUdfJ7qNVbcvNuUWr1/QzsJLbRS5iOjp3JfHo3LdrQoLL/d23u/bFJEfkLOM7RWREaiCxXLt45Mpk6iaRXpz8y0hnozGOOIe0XmUpr4NxroXRSbCkue9WGAsISATmIRkIjGQ/rqvC0KJBg/PKINCqzUv0yI1E8U+cG681LhN4gYSIRD7t9kEKLaUjm2RW7DDzw6eNLto42N9gRQIyEOk92QxseBFFA2CoKpdUdtFCw20ZKz5XtBYzzUtrt7Qd88YBkTJEpsfiMrPBqSqJj3gC4mXVmhIdiLvNV9AtBmZoISeJWpywLbzcO9afhBKSGkz2Xkn+zYUfU20rG7KhErpn2Acn4+T5iThBgMUJr5fNOn5Evm1v7dg17m5w1Zbrf1nc9/k6tN0m4kl/86XFgmhY2LiwepGgubQkvxq8rON+AyUth/1TR2Jp7fpl29vl3u1XozQjTaKPUk4t87YKXFbleqEERUaOXRDsUysXb9qaup/Og+s6v+Zt7fzF6H3joI7jnjzt7KmiLkeXS9o37CV1OnVTqjlUbDgjFDZKxrSo/fmdh4weir21SKGy2M+jeSXCTsZaMzFrbfQlbRtlVyuqdqwFJc74h9iyrSWLqpdVfwl4EYRN+TNOEHAkGvPgL4Gdf/QL4O6AuBdEgHvwD/oD7on0nGz4AAAAASUVORK5CYII=",Vl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACqUlEQVQ4EY1VTWsTURS9VVuFSjvpJiJGproRKyRFQZONcREJukgCSt05QVyb/IIkP0CSrl1MBFdaSFwolizabFoEJVFayEJNSkTspklLuqkLPeclL0zHoD1w5713v+a++zEjMhoG2ClQCdQE/R5QbcCzsI7E2AhuHDw7HPIaD+9fkHDojJi+SaVW3+hIfbMjr5fbUn7XboGZAxVBQ7gd5k3f6ZSdD8KRd6g0atNq78utexVptXtZyOlYwekwE7gyk11ZiogxNa7l/1y7ewfKKSIvQDFNZe3QQmR2rXL3yM70m+h0PvKWkSbAKx8bCDKjImPOeK2xsy8UJdPrMNzXvtRqTE0IUwTYIIMOrXjUZ+rEU0LQMPGoKv45j3QaC9J8n5Du7oEk02t9BceT+WYRwbLoMBaL+hzi/nZ1bVttCrlrKg18oV0ICqPWMqcROwII06EZQBRubH3viZvP6xnT4/IJreMG2wvw02HAbUjJzaBXReLMGaPjmYVwY5Ay84RboM/MSyx6ThUFOVZO6ps7/+1PRthyRqEdci0WQpLPXVU59F/2yMrSbSX2z8041dSeEwTUGWG9ur6NKqukKqGS4Hrgy5PHl4QREnwxC2LnQ+rsfDAdwBYjrBZffnXK1N48PynZp59l8VlDnbt7vySd+SDWwsXhbDuNON9AmZPC/mmisQ33/OIDACcfEVmPyipSG2lwjyYjn71eakFlVo9eHKNXqlXuQHmCtodAA2MaLTNixhn5fOQNX5qEUfH4wLKBVvAsr/648SBmyqmTmt2X0pmbRwmdcTQbX3ZzOPIDIcyhRgqJzfUH/fC8agXnyuIwsvrGziL4WS3TV9ZnrhYow/lmdTnLuvH7Vf4pz199Y7W70OM1y6AjwYJWCVQD6V8AfwfkpUAG6C/8AeTBAxu3Ro0CAAAAAElFTkSuQmCC",Wl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACiUlEQVQ4Ea1Vz2sTQRR+9UcVLLrrpSIGVk8FC01Pai+Nh0DRQ1JQ8eb2P0j+giR/gLSeBRPBi20l8aBYcmhzaRGErFAlBzWRFLEXsy3NpR70+97uxJAmoQc/eDM7b9588+a9N7Mi/WFBnYIUIXXIn1Cqoc5F3xcjfbRJ6PKxmXHr0f1rEpu5JE7knJp52y3xPrXk9VpTSu+aDShzkAKkg17CRScylsov3gLReMeo30ej2Zbb98rSaB5kMU9iRTdhJjp5Mbu+Ghfr/GkzP7T39w+VFJ4vwTBNY0PowrN8tXz32GRmJ5JOx9/S03noSifCiYzxzN//LenMB7l6o6jx+rcw0NsTyzJy+YUspLdA0oYDo8IQAXmIRUI3ORdxGHgGfTr+Rg1p7O8d0lCRe/wRidiR9Vdxqb+fp0cg3dQ5xptJxMAlYSIxF9EJ73NLdys+m9WxaXispac1oT563das83tjc7dzClYEEDuFxqER4T5QpX53N/ScRzN2nNPxpC0VkFLP8gKm6GG025DaXvB4SFqvWpwrY0LvibBWHRL+V5CwwQQMg31hVJPQa0PveHSCN4gdCb3K1i4HAzGLLHJxuEjt6ASTMhXGn3EGvpOwUlj+qkaDGnrB0mCZaDmhVllGjKu5orzfgBZ2ATv53G0YWCZMAgvenngpjZ228DIQ3CR8LArm6iWxW7FavtOJySBy3iQWvHmBOA4uw8EC1hROhgtriJG9tvHj5sOEI2fPGPVRWs5ZSBJBMr44tS97OQz5QEh32aQQ2Fxw0YdnnQsZInrmbf96gmGWOsIcORgFrYsuw/sN0Syawg8y+1Oer3wjoQ87HrMEORZcWPEXwGff/ALqoS6F3oIcwV8sRRZkeZzwewAAAABJRU5ErkJggg==",Kl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACFUlEQVQ4Ea1VsU4bQRCdIEIDIgcNaU66UCEFyaaKoHIKCwsKOxKpuUjpsb/A9heAawpf2iSSLwXIyAWmIU0kuwCJhmBkCtzA2UoaU8B761vrFFvG4DxpbvdmZ9/Nze7bFekPA+4krAC7gN37VvF9Ntq+eNHHm4AvH1mZMzY/zktk5bVY5qQKq57cSvX0Vn4c1MUt1mtwZmEOrIt/CbctcyqZ314G0Vw3qF+nVv8r7zdKUqv/yWCcxApBwnR4cTZz+D0qxvRLPT6w9VptRYrMdxCYYrAmtJFZvlJaH5pMf4mkS9F9ZvoBPnfMH0gHM/Nad5JK/5I37wqqZnoy29zumfK7xSvlNqYnhCUC8jCDhHYiZlq68KzNUnRPEbHvNdsMRgadmrlYEK95J01kpsF6cxHxbpMwHo+ZegxEN7L1eUGYcRD8tfiqqfzGq94ac0cAkXE8rPDbme5cZNvtBzuMCcYFx9jn9gJCzDA8KJBRw8AvmUXC/woS1ljwUUEFAVUSVo9+NkblE8oSuCThkfP1fGRC6htQG9spHzc82LNJWTL/sHC09BKQXqFSWoP0Jp5ETFVRCJDeJ0x09Cq7cOR4enADDwuS+SdOlmScpwnZT6Kw2Y7QH191lkhJ9OQmh7kZEhD6lztvnaeNJk19UzWhgEJYq/LxtXz59httw0Mcf9OFDQUbUbwCeOzrK4DXAX1JGA+DHjwAVtbTH+z+42MAAAAASUVORK5CYII=",jl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACcUlEQVQ4EZVVz2sTQRR+Fc1FsVsvFSGweiooNgVBzMV4CBQ9NAG9CW4E7xv8Azb7B0jSs0gieKpC4kFRcjC5pChCFmnFiyYSEOuhWYu51MP6fZOdEJLVxA/ezuybN9++eT9mRaJhQG1DqpAOJAilHeosjJFYiNBmoCunksvGnVvnJJU8LWb8uDLzdvri7fbl+eue1F71ulC6kApkhEnCohk/YZeLV0C0PDKKmnR7A7l2sy7d3q8C1kmsME7oJC6cKrx5lhbj5DG9/s/RPzhUpPC8BMM8jTWhBc/K7fqNucn0l0i6ln5JT7PQ1Y6EC472zD/4LXnnvZy9XFXx0hv1EZdWtmThzJPwuAM4EBOGCChDDBJamfW4ycAz6GvpF4qIBP7PQxoq8CPc3HmXlc7brCTOL0ku31JrjDeTiBeLhBsb63G10Njek6J7SejtOHgsb3dfnPsXVUj4cc4brT0cdaBMWRFA6igeJr9G2PdW1Dj5UJ7Bq3FoImNxmECWF7BKDxOacHzDrHn2bjP0OKZMw1o1SfjfyNktMRZjUsCxJ0HCrnZ/cjHqnWTeR38qzuwgwCOh10Qy5oH74IM0tn9I9dHVqXplhQBfSdisbH2eyUey0sNPqLmksuWpKKxbgv0N1Phg/fRRKkHw7fZIoAu0DnWnb5upsVJKBuF6h2S69TJovWq7fl0VLxfmBT1kM6D1cthT0VmuQbHJ24NFPC9IFt44Lsm4TxNybiOw7rDRh9VP5d/ALlFturO/CZuCttNH1u8cLYjD/obIKrpIFz6T0Gh9l8dPv7DtfNjxmCoRGGfCggV/Abz2dTIYeOpsCJM5hT/w/RU/0O92gQAAAABJRU5ErkJggg==",Xl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACpklEQVQ4EY1US2sTURQ+9Q0pduKmIo1MXRWUNoKgdmNcFIoukoKiC8Fx4dqoP2CSH1Bi1wWTghurkLjwUbIw3VQEIUEqZKFNJFJ00ySl2TSL8ftu5o6TB6kfnHvvnHvmu/e8rshgGFDHIVlIBeK4UnR1FuaBGBmgjUGXjsyOG/dvn5PI7GkxQwFlVtqsS+lbXd6s1ST3oVaFMgnJQDz0EqbM0Gg8nboKonHPaNCiWmvJ9Vt5qdb2EtgnsYKf0A5fOJX4+HpOjJNH9f7QubG7r0hx82cwfExjTWjhZuli/uZ/k+mTSHpx7h1vugBd7pC7YeubaVcmLzMf/6D1walVGTnzwnW3hQscE4YISEMMElqx+ZDJwGdebuG0t9zEiS0164HxmjkfFHpRL9+RMNbUEYw3k4ilRcJodD5EvVR/7Un2+TWxn0yrbz3QLf6UeDqtMs4Y21jDTe9gVgQQOYLB5GkEfyAKG3/UrAefW1qlbBB3McY6CWR5ATMkDGtCz3rIIm5/keZuG/W4I6nkJRVDmru1auqkDKHo3pqcGBVzIiCNZlsVOMPhBwmrvQnwG/SuHz2cUvEr5m9I7n1NVpBIgh3EiYSl9U/dMeOOH2y5peWyX6VcZaL0DWkD/CThemb1R5dx74d5NiCJxa+ShGgwcehn0RXC/gZyHFg/dRS242zfU8I1dN439SgnB1nVr46DzDtIirKpfF6gvgLxWi8G4yzjwhIZhgYy3Gju66zC5bZqBtTkA/yXOez+XEYsgmuF7St3o6acOK7V/dTcM8Y6h5KM3VL+3uRrwwdC/GUTR2CTnUbvbrt+2k7xs01LmztL2E9oG/3a6G/OFsRmf0NU/+rCZ3kVNn7LyqstdkoDdnRTJQLzgbBgwSenCNHJYOCpi0MMSB/+AqyMIb5pMY78AAAAAElFTkSuQmCC",Jl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACZ0lEQVQ4EY1VQWsTQRR+inqx6OqlPRhY66VgsSkI0pziIRD0kAjqSXALeu6KPyDZH6BJzh52PaqFrgelkoPppb0ICaWCF3UlRczFJqW9pIf6fdOdZZtsZT94u7Pfe/PlzZt5E5FkGKBt2ArsJ+wwtHbIWXgn4lQCWwbn5nOTxuMH05LPTYmZOa/COls70vm6I+8/dcVf7QYgHZgHizAqWDMzE7ZbW4DQZBSUNAi6+3L7flOC7l4VfgorxAUr2dnL1c/LBTEunNX+/777u0MliszrCHzGYC1oITO33bybWkz/EkXnCx+Z6T1w/unQUdGZ6aVcvcX9SEbj1Teh31/dRgLnhCUCXJhBQatczJgsPAPnCx9UEIWTQL76YlP6gwMZIDuC9eYmYmhRsFQqZshLsL0nzHTpyYz6Tno4EFt6OiPGxeN15okA8hQ0s9cvqbk156ZkZ4/Gihh5eG9+SGujJ9XnN0Y8zHKK3BwFs1pwLCpGcKnOy021ghgdDcOzalIwFbjUUvFKdMhPmkTB4KQN0JO4VHSGLD68huOxr4y+/mAo/d0DFcYOAjpn+Fjb6GGXp5Uj6QE/Jg4lixMQh135Ij7akBvJtgR+McM17+33eNzY2K0vyOHvR8eMNfPquaim7G9AHWyvtd7rw8aE0hIsQ3hZeLr1ymi9lXbzjjrUaYUYxxqyGdB6i/j09C77IBq8PVirtKBYeOM4FOM8LcixjcI6R42e3HYM0mCJmFln628DXFXzesn6m28LVmF/w2QOXaQPPmvVWv8jr9+hY1B3xHGZPiwVLETxymnD9F8A/w7I2TBeBmP4BxL//+/DOFLuAAAAAElFTkSuQmCC",zl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACp0lEQVQ4EY1Uz09TQRAef6GJBF694IEmT7yYSKTchIv1ACFyKCRKPJjwjPH+jHfh/QGInD1QjyJJ8YAROdBeMCYmbRVJD0qf1hC50ELgAof6fdu3m5Y+lElmZ3dm9tvZ2ZkVCScLahecAhfB1YCzgc6BDKVTIdoR6Gbj/R3W+L0uifdfFjt6Ubnl1sqS+1aWt0slWXhf8qH0wEmwoaOA03a01Z2d7gNQh3EKm/ilfbl9d1n80t4k7ARWVA84Eeu+NLkyPyBW2zlt/6es7B4oUET+Ao5P6KwBHUQ2m10ePjGYPomgvQPvGOkodAsasFj8NGozV5XdQ/Gm8syRrMwPmvwlX2+I9zyvcYzEPkmvbjHSCpRXzmJwRoaiCoxJH32UkcRQJ07cN5s4ya9vi93ZKhNPbzTouWC++YgAdgiYSAxFlVNuvSz6QWZeFpRODzwg2KhVDZIVAcA4Ae3Y9YgyOmNdDU71C//3nuAmwoOYt1t9KirjwvIC9ZzGENOAxhoy8X/ti/vss/AWrEWWjDf1xXgGtWozwhOR+/iajI9dNY/EfPcOLjZFygj9ow8QdgIfQ3cM7bHuiOI8oiUxagoC5jIft7g4lpgzXo/yKLW3tygVIwb9JGAmOfdDKY8brLYWSc6hDqe+KpdareKAnUOJ43FI7G/QAgcLXEbLVaubDwxDV0XRmjXn6Cb961Rx5Wr2w7Cy0wZ//kqm9UbgnMou30Hr1a5AYxgxusrOgckn170Di2y9h/BPngk2FZCfyFJ68+b9hC0Xzmt1MyRtVpA3grF8Ct93PHjygxDmUJOLxHq1Rm9sO+1QL9m/jCy3tj0D/aS26c9Brykd8AT7m53Rgy7Shc/ySq/+kVdvNthm/Ax4TfUQkP8lBx4pcBasH4OJp84FW+Am+gsT+CdBBSasZgAAAABJRU5ErkJggg==",Zl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACv0lEQVQ4EY1Vv29SURQ+9Uc1qbHQBWNKfLVLkzYWolHLUhwwRAcgseoGNXF/jX8A8AcY7GxSXhMX0QQcMDYMwtLGwYCmJgy2pcEYu1hoZGkH/b7bdwlSxH7J4fLOPed759e9T6Q3HFCbkCxkC/LblrKti2HtiYEe2jB0ab/P5YjOXRa/74IY7iFlVlnflcqXXXmzUpfcu3oNyiTEgrTRTZgy3OfMdGoGRK62Ua8/tXpLbt0rSK3+K4F9Eit0EsY9UyOJ968D4jh/Wu/3XRt7+4oUkT+D4QKNNWEMkaXLhbvHJtNvIqk38JaRRqDLnbA34jqyxt6BRB6VZOxGFkYt7afW5NPP4pzIyMDFF+K9nWcdEcCgsERAGuIgYSwcdBssfHF1R8auZ2UYKfciszKbkl2ald3qA4nOjcu8uabsWG82kVyn8BMKBd1YRIprO8oB6csynDWYVgLRbX2ItDtuPp6QJvR8MYPhRCAgPwkNz6RT+SaeXFFrd3QcF8/kiDiGB8V6uSHb31oyO+OSuG1PJ44XME1Cjyakphc+YfYOi59X0bBuTB+lklTyqnKxZ9Ug4X9BMnQRzteEqRLMwhvIq0jDwdE2B5tS606xvWv/uTQ6pLqpyahmRIyQp4bgCeJCwkoJzegHDLzaZqSd4LOBlxGsM7BNwpKV2eDDP8Eae6acshD/qFKl4eLzqprD6P1x5WdHqgbbQrsbnMF+SKd80mjuq4HnYHOMskt+lTpLZl8Wlj56Ycxetly4o2rVj5gnicR2V9H9A9UcNG0eftZJ27mKejhXit9vPgwZcvaMVh+l5h7nkSAZb5zq12YSj7wghDXUMFHY5OFB//sMa4POlSXi2FTWfy5Cn9B7OmX9zDUGifN8cyym2RD7JLFWxdUfsvxqk8esATummYMcCzFY8RPAa19/Avg5oM6EOCBH8AelXiRum6PHbAAAAABJRU5ErkJggg==",Hl="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACU0lEQVQ4EZVVMW/TQBR+RcACqlyWsERy2wVERdOxWUiHSFUZmkpQxroSzLj8gcQ/ANLMIGJGoFLMAAIy0C5BTLGqIlhogrLQhZoKljLA9118VkIs13zSu7Pffffd87t7Z5F4GHDbsAasA/sTWjv0WehjMRbjLcFXL+QzxtrNKSnkL4qZPado/t6h+B8P5cWbnnive104HZgLi/CvYNXMnrfr1XkIZSJS3EO390sWbjSl2/tZwTiFFQYFy7mZC5V3W0Uxxs/o8cQ+ODpWooh8E8QNkrWghcjq7eb11GJ6JYrOFV8x0hX4PC3Y6XxYMXWuag8/y+ajT2Lfvix371yS7daBrG+0tMZQ33hckOCHijTAwORpNFZpMavEmBdODI5+wz2G/lhNzs1MSL2aV8+60Vxj/Kzkrkww5wYWtk6BsLy8mFU8hC3X5jPSfrsU7SwHOImbNGg77w/EujUd8XgigAIjNLmCegsnqZeEhtG5z74I0hSxeLyAWUaY04LR6AkPzv3doehID/NvMsL/Qlx0gwKMsEtSWnDTBnOn57GCAJ+CPhOcBjw+XLx87+oInWUJfKXgDhOcBs6DXVlbndL5GprC+gY8CrpYOeDqSXCf7qvorNXpERqjDi8LV1dKCaXXaDeX1JkbmZHgYBHMFV+y9NZBcxkh4cFR4+2hq6PvTm4pFt44Dpgu2VqQzzYS6/QL/eRdZ4oYmb/3vYa5FQoQ+pP7b/3WQldmfcNkFlWkDz5ztd36Jk+e7/PC4GXAz/RgqWCBxV8Ar339C+DvgD4bZsBG8BdTQPJbZdBgiQAAAABJRU5ErkJggg==",ql="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACs0lEQVQ4EY1UTWsTURS99aMKLXbSTUQanLpSKyYFUZtN4iJQdJEEFF0IRqH7SH9Akl/QZu1HUnDjB0y6UCxZmGxausoILWahTSRSrIsmlmaji3jOS1462LH2wJ03c999Z+49774n4g4D7iTMgtVgnZ5Ver4ERlcMuHhj8OXCQa/x4M45CQdPi+kbUmH2WlPs9aYsLjWk8L5RhzMDy8P6+JtwzvQNJ3NzUyDy9oPcXuqNtty4XZR6YzeNeRIrOAlTgUuj6Q9vImKcOq7nDxxbO78UKTKfR+BjBmvCBDLLVYq3Dk2m/0TSycg7ZhqHr3CkN5HSmbV2fkv8UVnGr1kIaut16p0lDpx5oaxbbhsJDAolAnIwg4SJ2LTPpPCl5S0Zv2rJCEp2kjGaBGfHhqRZvassNOVVPmZIvbmJ5CJhNDrt4xoprWyJ9Twk6Vm/+tYPLkJJkpy5oCShxsmZ88qnf8yOAMIkNAMTHrU2PXvZdXdZFjSWj2gZDbZQ199tKbYX4D+GR0AT6mC30XoWUiWi/8QYGVTy5OaDipTxvV41meGhkH36SRFRO//FbkX0UQ4nSFjXOjgnnO+LyKq08kPYCdSOVluNKbKFlxsqlCcIsElol7EZB4E/dOqlY82xYal/21Wf1BT4SsJy/tUX5fzXw49Ns9e3Jfuk2g9hi1FP/8So8vF8AwU+2D9NlNPpbN5XVluNq9uFo/ahnTrYaX3rdJBxZy5zxRlfI5k+ejEEW5Xizf6ucdINWm99A/FkTUbesicfIj5/tLeoit3yLJU2r9+LmnLyhHbvp2TL0AiS8QRVP//M4JMXhDjbJglhM92DvneGGeQGasjM7LXtLObTOkaXrL85JmApnm8YRPeIbnyWW1r+LguvN9jYLcSxTLURGP+LBCIsWAWmN4PC05eEGbB9+AMiziwWYWCsOQAAAABJRU5ErkJggg==",$l="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACq0lEQVQ4EY1VTWsTURS99aMKKe3ETUUanXZVsJgUxY9sjItI0UUSUHRnKrg20h+QyQ+QxD9gRnBjLUxcKJYummxSXCVKC11oG4lIu2nTYjd1oee8zIthMpEeuPNx750z951374yIPwy4MzAHtgn741rN9aVx9sWAjzcJXzEWHTUe3Z+QWPSsmKGASquv7kp9bVfeLTal9LHZgDMHs2EdeAnzZmgoU8zfANFoJ8nvotE8kFv3lqTR/GUhTmKFbsJsZOqMtbwQF2P4pI7/99zaP1SkqLyAxGdM1oRpVFasLd09Mpl+E0mn4x9YaQq+0jE3kNWVtfZ/S+pxRcavOUg60M+pay5x4NxrZcxh3BgeFEoEFGEGCdPJmZBJ4cvVbRm/6sgIluxHFr4YlM1PKWXM4QsI6s1NJBcJE4mZEP1SXtkW5+VNsebC6l4fPq/tqMtC7oracb7cLkSltXeoimCQHQHESGhG8GbCmrvku7t6aSqp6xCZCkoFRRBsLyBMwogmpMcPXCpE75GBEjV+tHV2e9U84Ufg9VGj9IMJpRmvuRHllS21Gm+LscJG9wZ4yfR9Hvrlc5fFHAvIBdjywm1FbI4NqRROEFBnhXXogF1Woqqg98CRo1ZPn0wKOqITJkkWuhPMAb6zwoo9/403fWGeD4j1/IvkYAR7dTZTFWqv9ed8A6qxbYjbosD9QM3YTvb8hmrq4OQbtRmUgaBk7sfC1qOXxOg5taU7Spd+xPphY2QQee15Z7XT8ffsglnE7ePuw+uYyeBi+ef1hwlTTp/S7l5qkuk4yTgt61/3csjkB0KooUYGwubag/5vhnXQe6ZErKy+uvMCMUvH9ZL1Pc9pWJbzzR1lU2vhqVW5uiWv3m5w5FrI4zJLsCMhjSwHVoPpXwB/B/RlYAasB38BbTMURenwjkwAAAAASUVORK5CYII=",tc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACyUlEQVQ4EY1UTU9TURAdNaAJhj5YiBvMC2yIEqk7YAMuSIwsbBMtLkx4xLC2DT+A8gekXWssbv1I60IjdkHZ1JiQtBqIXaitKSGy4bUENnRxPee299HA82OS09s3M/d03syZivibBXcUSANlQLVQaPkcnL52xscbgi81Od5nzd4bkMnxy2L3d+m04qYrxS1X3qxWJfO+WoFzCVgBPDtJuGz3X4ymlsdA1Ocl+X2pVA/l5t2sVKoHccRJrK2dcDE43BtfezUlVneHif/1rO0faVJUnkBijMmG0EFlqUJ2+r/JzC+R9MbUO1Yahi9j/OXyp7AqfJhWeFU9AKu7Uzkzg8otRZTaeeAhOj+kGMNFFbrVr3gPb8VnF7DO4sNBwLYCHRJ+uC4TY33ilmaE1Ra39iT5pISUpsUWNzCMbVl7PSUgkgBaMxfL635ziMhymJlOJcYVCFRwuMerhFVlnk0otMLzIVdXYypm9ayWFWKQrDLDCu3gtR4h8Mp4PDa33kBPO7Ujl9/V39unz5h9pUs+Q0qUF2yEhEGSnTTKYunxF3k0P6RDdTTfCjTJ23ODV3ulsn1gtGqT8JQZjc1GBsQBaG796FSen4OEFRIYayeLL1w3boFGpeZDyur46twgWJGExfWPu/pibb/RmvQlaSdjkOtHzbGXxvjjXEcqgyfsJwnXV158R3JDq55bEl8YgVAPPTCTVTiRQYnFN7Sf+cmnX3VfOSjuN0wLm/pxKWKcvqB4KRXKBKReDpeAMQJ3y4C3eiHoLV3I3vZkwuCfjNWxn802NLB6b1H1wRzyV861LpXQn57V3M7o/Tu2XDhv3P6UjFNCpk2lb3X+2ySYzR4ai6KxS81FP566CZ48ORxWVtzcSyIWN3Hzb2OeeTrAIvcbkJHWFjHAQeXyv+T5yx+cdg0uvqYeBOP/MgcJaaAAmEGw8fRFAQs4Zb8BSBtwJRgqL8cAAAAASUVORK5CYII=",ec="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACe0lEQVQ4EY1VTWsTYRCeiHqplNVLRBpYParYFARpLsZDINRDEvDj6Ab/QIo/INk/YJKzh6zQUxWSHipqDjaXFE8JUqEXbSQXvZhY2ks91Od5s7Ok61ozMDvvzsz7vPPOx65INFlQl8BN8B742Oeer3MgIykWoc1D10in4taTh9cknbosdmLOuPV3RtL/PJKNd0NpvR0OoHTBHjigMGDVTlwoNarLAIoHTlGLwfBQ7j1oy2B4UIGdwIamAcvJm5cqH15nxJo/p/ZT5Xj/yIAi8hocV+msgA4ia/Ta92cG05MIupR5w0gL0LXO+IayRqZXiV1ZE3JxdRvOh7rfyPqLXbl6pymU1vx5YYpADbBFQCefTdiaeOZl8cZFGe0+lr2PBRn/OgJolxsMMO3eq694iwmjIzHfLCKWDgFzuWyCej+SY6m5t83VeUgV663uD99+IHeX49J7vxJU3hjwYEeA0mfxsJOIiEQARjVNBEN+jcqPZNocrNleoEVGmFTAwOovmDv3+ScpP7sVNv317qfMJmAkjfd/S+FpR3LZBXEemetE+oWVBByEq0gwU5zrlslneFPUOycI1Cdgv7M9Sbo6FktdsRfmxKulVPVfybEEfSNgx1v/EmwgGE+rIG+MXDlw+MeC8w1qscoeKlkGs4/EW2ePoVKZTSP1weprr6pOJQ/1Pxaejl4erdHstVdM56vjLJL5XsLhGL0i/D1emdSCos5CaPdP1Kc/tXjY68LTo7cCcl1CYt3JoJ+cXRrDxIZnZP2dn3XYKmrXK+s7pQMuc77BZq618Zmrre53eYlZBuAYfrxmCzwTOfDiL4Cfff0F8HdAXQlsigh5gv4ArXr/f4PXeKEAAAAASUVORK5CYII=",ic="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACqklEQVQ4EY1Uv29SURQ+GstiU58O4iAJ0aVRIzRxKQs4kBA7AIm2i4mPqLOPdBf4AxQ6GwOuagIOGpVBWCCaJpCmJiwKBmOqgw+butgBv+/CfSk/rJzke/fec8797rnnnvNEposBtQUUgTbQH6Ix1JkYp8qRKdoYdPlQwG3cunFOQoEz4vUcV27NbVuaH2158aYrpdfdDpQZoAA4Mk6Y9XrmrXx2GURux2napNP9LVevl6XT3UvDTmIlBwlT/kun0u+eh8VYmNP2Q8fe7h9FishzcEzSWROaiCzfKK/MTKZPIulS+BUjjUNX0vp2+328T+Cq+gH65tr5vt1a7fe/3VSwW2vKbiy4lA99uQe34toGjKP4mLGIx8vEMye+iycFGwWOPFUSVl0fKsn7m7iBS9of4soeXHarPcw3YJCLhNFoxKNezzgxJ7nMFXVtHmDdWZRK7btDWKnvSGr9smNPY85D+UCsCEjoGD5eP6IiGm9XnM2c2L/2UTLzjo5RHxQSURgIywviY4R+ko0LnTMPt+Te3cVxk7OO364qO9MwrFUvCSekt7uvchONnBVzVV1lwidh1ZQuve4bsZGwo0OnRZMFl0+rfI54DxfJ1KZU6j+k+DjolBk7CNIkYbNaHyRek/kuGFLIBYbbR4fMgy203VdhA+iWpAfbEvKFhNXC009coERq6kReg1FrKCM+JMs9akk+OzhM2xkI+xuiCpv1Y6MEnILGemTO4iXG9XqNAGhrA07rxVAexUb5GiJ0UT+zMLql8EvcZi+BTQVemVKCYoOdwt6cVXTOsZd/mwL3aULOLSQ2M2j0QcFS+S9hBzGy5vbPDfiktZ/+2+g1RxNIsb8B1du68PkIldqOPHn2mS3Zgx+vqR4C43/FhEcRaAD6QZh46iyAjzkhfwH6QzxVDjE9cQAAAABJRU5ErkJggg==",nc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACz0lEQVQ4EY1VMUxTURS9iCAGAh8TpQON37poJFASB+kCDo1GBtpEwcGEb3Q0sYTBxKXt5mJaZofWFU3AQSN2sCwYE5NWg6aD0poSYhd/ITiIw/ecR1/zU0r1Jve//+497/73zj2vFWluBsIR+BK8CHdqnqvFLIxNra1JNIRYaiIwYMze8MlEwCOmt1vB8uu25D/b8mKlLMuvyyUE4/A0vG6NBROmtyeSSoyh0EAd1OylVP4ll69npFTejSHPwsrcBaP+oROxt8+DYvR26HzLsbqzp4pi50kA5wjWBS3sLJXLTP53Mf0lFh0NvuJOw4gt63ix+D7sYHeOf6hfNcDo7XRi88OOs3Wr7sSACoc5LFRYvQ5zG24cwcMKXfWaGNX27989L3ZhRnj09OKGLDwpMKWMnJ0e7BaehJipK161Bpsg5wZAVjse0Qf3hs6R5DYQ8OjhqHQdaxfPqeOKj+y7itycMlXBj19sic2PqK4Tw8bNRT+ovOdkF7q/+fsokKb/Qr/QrRmfWqgflIjR16mnwu67LbtWUVPKCjTwfYQF/SzWaNRcevGbgKPGlESwq+2dP5Jd+yGpZEAVqxU0yeEB4/HDd1YlEb9YF7UbdGawR0xwSZGsghJ2Whtlww6b+jZowc5O+8DXsMYdOrJRITRnHHyOBl/mucM8v0JrVYy5+ONPCud+8KilzV0hRbDvLLhKrnQxds6aPqvmjNFpRl+HJCEhd1E2BXdaxsc86n4DpoRN/dgULMYDjhtUF3buzaTDucZR4ODZobgRK8LrVy8E4FIuc023n7lDrYoOV7f3VMP4Du5wkt3bWJCmsGkFdKp/Jbt1iSKmaFsZ89Qni7Epha/bceCTXOOWTQTExvcv+j5vrYqSP+4sv/5zAbiYxlI2jWYhEOX9hstI7RYRxAZRzE+fbWCsVBHiMVUjmP+XWQDwL4A/+7oRJJ6xCNyAH7C/V6JHC9VDTDkAAAAASUVORK5CYII=",sc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACnElEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX66FY9uDxVwbHkN0MjFJLwDix8DhIMbo5WPkTZ99gUDRfzwCiYQCYLhgKgOkCCAJAFhoYaAvC5MA0yDJ9oNj7G+EM908GgoKEITDpIIoadA7MkQtW3wNKMWI4MB6YCIHAH8NCUOoS4GdlmNBoAvY1KKXWF+kxgFIePgBylL2lOMP5XV5YUzc0xSuwoBsC8u35Xd4owiDXA+MZRQyd42AlzgDChACGhegaQJaB8hMonkEAFJfI8QMSAwUXsXkWr4UfPv0GJx5/DxlgQaAEMhsMHjz5CmOCaUiCIq6QwGkhzDJ7SzFwfMJsAKW4+f2WMC7JNCjRYAXglKolwLBgghVWeXIFQRY+AMUTMkgsOAbmNhTrA7PEVzhGVkMqG5T6geACKEg3Llx1Nx+WKA4ce8mwYBUoLzGAMzCYASVAeZLYxIGsD8SGZqsLoKLNARgv+++fCgDmOzZ0dVThg9KDoetWUAGiCArSA8BUNrGw/ixVDMdmSGPvRZBlE4FyD2BVwwlgGHt8/PRbwsJYhGo1BshnmeUnGWYsvg2qnhKB+AfMwh9AzsoT595wrtz40EKQHxK0EmKcQGHSASihTZxzgyEy8wgD0EyQz0CWgStgbKYpAAUXADGomUBuEwPUPJkAxA5AjAIA7oMIyaGb3E0AAAAASUVORK5CYII=",rc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACyElEQVRIDa1WX0hTYRQ/Vi7F0C0ihzS41stAqEn/Zi9uD8agBzcIoyezPw8+OfFBelrroeihtr0JRib10CRIH4TEhyWEqURbkjCIugslkIJtMmE5Yv3Obfd273bXdPqDw/2+c77vnO/8+c53iUrhACsAEkH5KimKfWMgAaRBjWpmxNhnbDR4B25Z6VrPCRIsDSrx9oexT0mKrSTJ/2iZEquZIHb6QSnWIBtkY5HenuO24N2zZGysZdmukdrYIv/DZQqOxmNQ5gSl9he03odX7pEH56nuoMzatT1Jl8vZwl6aP64k66Bxhj0UBMshMTp7ac88Kz4qe9p6bpLwde6D0OcbOqkxxjlwXp6lmpbnEvUNvsMpN4v16M7fzK9T+8Vp4j0yUBfkRV0AbjZos7WZZJmk2HNjjk6Bl4xfIXHRQ/l8HgrmlTXlBoO+9+S5PofDGziMmmW9KEKgu8Qgcx0XminoPyN5zZXKFcsnrwSOgrjkIUdHc8nSQsULB4olLBgLdGjYSDjZ2g5reHqTV0869dgaXolBtfRv7jJIdo7UykKjcS4AZWm3y4ID/UuLItAZcEjLQjjWIHmWSm/R+MQXZZ24lqHE2qZCqXROkVUa/NdDrl7GwE0rtXdNUydyI+e3kuJy8hIPuTg4ZGpwXo1NtVJo1fxqxmwwUXzHvCjv8Ymvkj7OH7cnDtt286R3EO6tQIwNTqnzwyEL4ErcgRG++CZrmCZnVinysqvqZi5ZQjNhg9zaHLioEXHJLV1Y5sqQPS/cIZm94y9HiWsAzaCVO3Ui++u3af1H1u5GeathbDIgdwY1q6rx7XtReh35HsLmF/LTsIAYu9IbObP99JE9ezHYs/7hRRp59pmfpz5QVjaYxSS88OFnfXjqm91U8Mp8tB7snYNTEXocp6v9bwk62TM2Jj3AetoEMJ+C+Deh2l8MEXuDIAdIgz9GchluxrTNYQAAAABJRU5ErkJggg==",oc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACgUlEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX6+G0rLD+DIOi+XpwnKAbhI1/4NhLBkO3rQyJhcfh0sB0wVAATBdAEACy0MBAWxAuicwARf6GHU+AQfKV4cPHX8hSWNkgxwUmHQTKMYKCEUVNPDARAoE/XgsDkw8ygHxPLAClTFDUBLjLYGiBpngFkIVYASh1OViJA7OHElZ5bIL717gSzEos2DSCgnDBqnsMIAOwgYmzb4ASAFzK3lIc7Di4AB4GVgsdQ3aDgxJXxr//5AvDx0+/4cbqI7HhgjgYGBaCglKAn43BAehqkE9h4OETYMIBGgwqFCY0msCESaYxLDxw/CXDhSvvwFkB2bSEgmMMCeHKDPP7LZGFSWaDLHwA9Akw80PKTWzxxii1BByfoERELgClYCC4AEqlGxeuukuuOUTrA+VpILgAKtocgCXB/vunAoDxw0a0AaQoBMW9oetWUGGgCPLhAWASn1hYf5YUM0hS29h7EWTZRKCmB7Cq4QQwjD2ASV3CwliEajUGyGeZ5ScZZiy+DaqeEoH4B8zCH0DOyhPn3nCu3PjQQhCYLUBAQowTTJNKgLLTxDk3GCIzjzAAzQT5DGQZuALGZpYCUHABEIOaCeQ2MUDNkwlA7ADEKAAATIH2zR+4T2EAAAAASUVORK5CYII=",ac="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACXElEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX68Et27jjMYOi+Xqs+MHjr+hmofA/fPrNUFh/BqwXFIcwAEwXDAXAdAEEASxAwsBAWxAmx6CvLcQwv98KzgcxNu58zLBhxxMGAX7ccQtKKIHJB8EJDeSwDx9/oZgRD0yEDb2X/DEsBKVM9NSZWHicARIKbCiGIHMOHH/J0N9owhDgIcPAKLUEWQrMhpqpALIQL1iw8h5YPiFMCa86aJDhVQOSJGghKC+BfAcDoKADBTEyQJZHFsfGxmshNt+BUtyDJ/gTDzaLYGJ4LUT3HUiTg5U4GMMMIJUGZQusAJvvsCokURBk4QNs+Qub70g0G0U5NF9eAFm4ceGquyiStPAdKLEBwQVQ0eYALAn23z8VACxtcOczFBeRyAGVQIauW0FlqiLIhweAKW9iYf1ZEo0hXnlj70WQZROBOh7AqoYTwDD2+Pjpt4SFsQjVagyQzzLLTzLMWHwbVD0lAvEPmIU/gJyVJ8694Vy58aGFID8kaCXEOIHCpANQIpw45wZDZOYRBqCZIJ+BLANXwNhMUwAKLgBiUDOB3CYGqHkyAYgdgBgFAADj2e234obfjwAAAABJRU5ErkJggg==",lc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAAC20lEQVRIDa1WTWgTURCeqo0tljYBsaE0sK0XQdGU+pN4aXJQAx6SgLR4aqN46MkGD+IpxIPiQbO9FfyJRQ9WD00OxZQeYkCaRtTEYiEguikpQlDIJijEBtGZR3Z52TXSpB0YMm9m3sz73sy8DYCeHKgKIUvIf1rkNO4LIwvIddTGrYwoB4zdhqmrVw7BxOhBECz7OPPWxczHImTWihC8twq5/A8RdwaRZYqgJKRk8fHRQat48wQYu9vJtm2Sy5sQvLsK4v1sBoM5keXdtai3EZVn5s4p6NirqLadj8VyOfsIpfnDWrEDIy4SQkGwdEnppfM7hkx7VEI6cDIC+OvchcZA4NrRumRUA+eFJWjre8rY50/iKX9q4/xz/Wq5AENnF8AfeKfasS9gCvsCyUMJrdbDJtVIp/FeTsAx1BWzYyClvCCXNsHnX1Z9Ggn+wFv0S+LhDYSmzm0cmxDJrUtI6PDOQQweZ6ipU0Mo08n/R3QDNENUGqG/S+da63iBEtaR9YiJnZBPEI3lcUT0QfiNFFA5JK/Xynu0CrqOsGgH76UEOE73squRy1WYfziiulKr8+R2WYAvC2/TyrqEFHz6QRYI6Yi9l/nTevbFF9QNs3Vuo76B5FJVG7fhWpcw8jLPOlJKedRNHkQwdGYB3Of6GepwyK7amhV0NUwkCywoH4jqY+xph3UNMt5nqzIlzPEzRtdIKCOxDTUG1Yx8lCtWDU0I9LYiZShhdPb5Z3XrxNgg0ONNM6UMfmQxD/OPHC0/5iwTjhtShp42B3ZmXHrjYeNAWoUU5LUZUtRN/1IjUg/gfA/QS52r/PptKnyr2Kg5eDL2GLB2Bl7VknzjVhpi8a/TuPmZ8mlYwTt2lcpVs214/459MQjZ5PUUzDz5RJ8nH3JFSVjBxdzK+++dc9F1m6mGynygE9XNE5WCZvfi5GvAmISMksmNIgloeIxMfxNa/Ysh4V4R2YFcR38Bb3Ues5HaWTAAAAAASUVORK5CYII=",cc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAADA0lEQVRIDa1WX0iTURQ/648pim0QOaTRrBcpKCOr5YvbgyT00IQwgkAtevCpSQ/R01wPRQ+57U3QVKiHFoH5EBg+TCH8E9GmpA2CNlGEUbRvQ2Epsc7v5r19m01T94Oze79z7/mde/589xvRRthZ5WWJsmR2KCG262exsmTBoHsy8txtLC9y3bldTa3Nx8lqKdUt//80/ClB4dkEebpmKLaw7GNLD4sGBukQzoItzcdqfA/OkbF8P9Z2DS21Sp4nM+TriYSZzMGi7V1nfcRRObsfX6DiA1K1a3+Cq9FRiSjN07OJYmZ8iwitVktZNDRyuWCR5R4VkVadf008Ovbwott995RyFltYIcfVETJUPheCOXRbYTM77gtycV8wnHBYU3PSpPiabo2y8yJKRK4Jqb9YIQ6AU26Gto5xOnqkVNhEp5oInNBJtHATMq4gpZnM0g2pF1EhvfpDINpcnTLgCQ5zpuENDfbZlR10puqXBOey28GDCLPA9aSx8bjSyXRKI7WgmyAjMiqpzme3T26Q4+DTekJaRyfiZDxYRKPsHCcHKTAQ+Erzi8tyOyHl9roK9YyJllqjpptjhN7IxYYI/b2feY9BEJ0+8ae2nq5pkTYYJzlVscUVJSDPRZtrXBy28x8Os2o4NLxAra4JUS99CtGpzksWwg20FeAsPKdR8FWD6nxps6GGieQqF7hMFVluRDrDcwn5mHfscH/I60waIaWxvwUu4zvwB/l7InJd1BB1RK02A64w1NfbWUsaHxyckhd2uFsx4MfHucarIWSwrz7DUaqvBEeX8Xpq1brcpx+5Q9V+5suac2qFbb+3Dvp+1NDOpMHoe6fqRNaJTsNJ9bWEfidAY+E95Tu1Cjd1LP3zlyn+LW1zNloUHy5xvBaFwP2HIRoOLvmZ64X8NExyjhuTqTWz7eyhgn0xEFn7vSnqfvYFtWtjSUuHaX4ITH78XhIYmreZ1iMzHy5h9faBZvH3Ruh6+ztiTkQGZ1o+JisvDLDgb0JWA2zjOcp7fSx2liz8BkCog304fm8JAAAAAElFTkSuQmCC",hc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAAC0UlEQVRIDa1WTWgTURCe+lNbLDUBaUNpcKMXQdGUqk17MTlUAj00glQ81SoeemqCB/EU40HxoNncCi0kRQ+mCtpDRdtDDIitoiYWiwFpk9IiBMWkoUI0iM63ZpfdbCsxyQdD3pt9b76Zl2/eLpEednb52ZJsvyu0GO8LsglsGtSpZgYeew3N9e6RSwfp/MABEsy7VY/LH8Y/ZCi+mCHfnQVKrW6IvNPHlkUEmRBkkcGB/Vbx+nEyNO/Es6qRzf0k3+0FEscScQ7mYMtuL0a9yVW5Rm91UcMu2VU1nxTL6WhDlab3i5kGjvgMFQqCuSkZm+2rWWWlqaJSy4nHxL+ObfzQ6718REP2/GWaHGdmqa7tnmRDnjksLo2z6Rx7O05Nk8f7VnnOuiA364LhAqHVesioPEytfqfTF6J0lH2ZxFmKzfSxAL5JPmXRFgOP9w0hORCUJjjIImT06wgD4x/J3tNKou+YVLX1sJEiD3sJmSOZfwE9hL9GaG/SLSsqXgChBtn1Ahn21Gt8yBgWnUtr/KUTOclSv3q+Qz3BGMd7jaXs93VKJPAFxhKaI4LU1eh3mqV9at9WYx0hmj70YIk6ep+QiwOxpKUmZiUrMVJr2qPFqZQLHSE2Qiih8DKtrG3Qye5WCoo9rNoZ2tf+9+YJ+rvLja9bpyOEOLhJCZXKgFhwXUFA1QKiSZWqz83ynphclmJLbXIxKiUA4VQK3K2MOAinJiaXlDhoCT+3BISDxrd0PeJjbZHaRFlUwQAnxIjjarNz5pHka5eiSjkeqkOLVHuZZ3MFFuE0BGjBTZ3K//hlTH/J26BKNUBWi8v86o0YPY18DnDs+/KrYZ7P2LmeK5hsnXtrQoLEUdnwlVc0evcTXk9DbHmZMM+T8Py7r43hqRWbsXjTmFoa2f3/wF8RGE/QueEXxDFRGcikF/Bm0QR2htjwmVDpJ0aS94psdjYN/gBLWxwVhmOXcAAAAABJRU5ErkJggg==",k={exit1:Pl,exit2:kl,exit3:Gl,exit4:Ml,exit5:Ul,exit6:Nl,exit7:Yl,exit8:Ql,exit9:Vl,exit10:Wl,exit11:Kl,exit12:jl,exit13:Xl,exit14:Jl,exit15:zl,exit16:Zl,exit17:Hl,exit18:ql,exit19:$l,exit20:tc,exit21:ec,exit22:ic,exit23:nc,exit2_1:sc,exit3_1:rc,exit4_1:oc,exit7_1:ac,exit8_1:lc,exit8_2:cc,exit9_1:hc};class dc{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=yt,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?At(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=At(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return z()}readFeature(t,e){return z()}readFeatures(t,e){return z()}readGeometry(t,e){return z()}readProjection(t){return z()}writeFeature(t,e){return z()}writeFeatures(t,e){return z()}writeGeometry(t,e){return z()}}const or=dc;function di(s,t,e){const i=e?At(e.featureProjection):null,n=e?At(e.dataProjection):null;let r=s;if(i&&n&&!na(i,n)){t&&(r=s.clone());const o=t?i:n,a=t?n:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(sa(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};r===s&&(r=s.clone()),r.applyTransform(a)}return r}const Ac={Point:Mt,LineString:Jt,Polygon:Qe,MultiPoint:Re,MultiLineString:we,MultiPolygon:Ee};function uc(s,t,e){return Array.isArray(t[0])?(_s(s,0,t,e)||(s=s.slice(),Oi(s,0,t,e)),s):(ra(s,0,t,e)||(s=s.slice(),oa(s,0,t,e)),s)}function ar(s,t){var r;const e=s.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>ar({...s,geometry:o})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const n=e.layout.length;return di(new H(i,i==="Polygon"?uc(e.flatCoordinates,e.ends,n):e.flatCoordinates,(r=e.ends)==null?void 0:r.flat(),n,s.properties||{},s.id).enableSimplifyTransformed(),!1,t)}function $i(s,t){if(!s)return null;if(Array.isArray(s)){const i=s.map(n=>$i(n,t));return new He(i)}const e=Ac[s.type];return di(new e(s.flatCoordinates,s.layout,s.ends),!1,t)}class fc extends or{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Oe(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Oe(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return z()}readFeaturesFromObject(t,e){return z()}readGeometry(t,e){return this.readGeometryFromObject(Oe(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return z()}readProjection(t){return this.readProjectionFromObject(Oe(t))}readProjectionFromObject(t){return z()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return z()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return z()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return z()}}function Oe(s){if(typeof s=="string"){const t=JSON.parse(s);return t||null}return s!==null?s:null}class tn extends fc{constructor(t){t=t||{},super(),this.dataProjection=At(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=At(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const n=en(i.geometry);if(this.featureClass===H)return ar({geometry:n,id:i.id,properties:i.properties},e);const r=new yt;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry($i(n,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){const i=t;let n=null;if(i.type==="FeatureCollection"){const r=t;n=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&n.push(c)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return gc(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=At(e.properties.name);else if(e.type==="EPSG")i=At("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(n!==void 0&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=Yi(o,e),delete r[t.getGeometryName()]),oe(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return Yi(t,this.adaptOptions(e))}}function en(s,t){if(!s)return null;let e;switch(s.type){case"Point":{e=xc(s);break}case"LineString":{e=pc(s);break}case"Polygon":{e=wc(s);break}case"MultiPoint":{e=_c(s);break}case"MultiLineString":{e=yc(s);break}case"MultiPolygon":{e=Cc(s);break}case"GeometryCollection":{e=mc(s);break}default:throw new Error("Unsupported GeoJSON type: "+s.type)}return e}function gc(s,t){const e=en(s);return $i(e,t)}function mc(s,t){return s.geometries.map(function(i){return en(i)})}function xc(s){const t=s.coordinates;return{type:"Point",flatCoordinates:t,layout:he(t.length)}}function pc(s){var i;const t=s.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:he(((i=t[0])==null?void 0:i.length)||2)}}function yc(s){var r,o;const t=s.coordinates,e=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length)||2,i=[],n=zi(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:n,layout:he(e)}}function _c(s){var e;const t=s.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:he(((e=t[0])==null?void 0:e.length)||2)}}function Cc(s){var r,o;const t=s.coordinates,e=[],i=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o[0].length)||2,n=Cs(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:n,layout:he(i)}}function wc(s){var r,o;const t=s.coordinates,e=[],i=(o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length,n=zi(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:n,layout:he(i)}}function Yi(s,t){s=di(s,!0,t);const e=s.getType();let i;switch(e){case"Point":{i=Tc(s);break}case"LineString":{i=Sc(s);break}case"Polygon":{i=bc(s,t);break}case"MultiPoint":{i=Fc(s);break}case"MultiLineString":{i=Rc(s);break}case"MultiPolygon":{i=Ic(s,t);break}case"GeometryCollection":{i=Ec(s,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function Ec(s,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:s.getGeometriesArray().map(function(i){return Yi(i,t)})}}function Sc(s,t){return{type:"LineString",coordinates:s.getCoordinates()}}function Rc(s,t){return{type:"MultiLineString",coordinates:s.getCoordinates()}}function Fc(s,t){return{type:"MultiPoint",coordinates:s.getCoordinates()}}function Ic(s,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:s.getCoordinates(e)}}function Tc(s,t){return{type:"Point",coordinates:s.getCoordinates()}}function bc(s,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:s.getCoordinates(e)}}const Qi=65536*65536,$n=1/Qi,vc=12,ts=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Ii=0,Be=1,me=2,Pe=5;class Lc{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,e,i=this.length){for(;this.pos<i;){const n=this.readVarint(),r=n>>3,o=this.pos;this.type=n&7,t(r,e,this),this.pos===o&&this.skip(n)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*Qi;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*Qi;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const e=this.buf;let i,n;return n=e[this.pos++],i=n&127,n<128||(n=e[this.pos++],i|=(n&127)<<7,n<128)||(n=e[this.pos++],i|=(n&127)<<14,n<128)||(n=e[this.pos++],i|=(n&127)<<21,n<128)?i:(n=e[this.pos],i|=(n&15)<<28,Dc(i,t,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2===1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=vc&&ts?ts.decode(this.buf.subarray(e,t)):Kc(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e}readPackedVarint(t=[],e){const i=this.readPackedEnd();for(;this.pos<i;)t.push(this.readVarint(e));return t}readPackedSVarint(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===me?this.readVarint()+this.pos:this.pos+1}skip(t){const e=t&7;if(e===Ii)for(;this.buf[this.pos++]>127;);else if(e===me)this.pos=this.readVarint()+this.pos;else if(e===Pe)this.pos+=4;else if(e===Be)this.pos+=8;else throw new Error(`Unimplemented type: ${e}`)}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;for(;e<this.pos+t;)e*=2;if(e!==this.length){const i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*$n),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*$n),!0),this.pos+=8}writeVarint(t){if(t=+t||0,t>268435455||t<0){Oc(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))}writeSVarint(t){this.writeVarint(t<0?-t*2-1:t*2)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(t.length*4),this.pos++;const e=this.pos;this.pos=jc(this.buf,t,this.pos);const i=this.pos-e;i>=128&&es(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e),this.realloc(e);for(let i=0;i<e;i++)this.buf[this.pos++]=t[i]}writeRawMessage(t,e){this.pos++;const i=this.pos;t(e,this);const n=this.pos-i;n>=128&&es(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n}writeMessage(t,e,i){this.writeTag(t,me),this.writeRawMessage(e,i)}writePackedVarint(t,e){e.length&&this.writeMessage(t,kc,e)}writePackedSVarint(t,e){e.length&&this.writeMessage(t,Gc,e)}writePackedBoolean(t,e){e.length&&this.writeMessage(t,Nc,e)}writePackedFloat(t,e){e.length&&this.writeMessage(t,Mc,e)}writePackedDouble(t,e){e.length&&this.writeMessage(t,Uc,e)}writePackedFixed32(t,e){e.length&&this.writeMessage(t,Yc,e)}writePackedSFixed32(t,e){e.length&&this.writeMessage(t,Qc,e)}writePackedFixed64(t,e){e.length&&this.writeMessage(t,Vc,e)}writePackedSFixed64(t,e){e.length&&this.writeMessage(t,Wc,e)}writeBytesField(t,e){this.writeTag(t,me),this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,Pe),this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,Pe),this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,Be),this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,Be),this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,Ii),this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,Ii),this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,me),this.writeString(e)}writeFloatField(t,e){this.writeTag(t,Pe),this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,Be),this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function Dc(s,t,e){const i=e.buf;let n,r;if(r=i[e.pos++],n=(r&112)>>4,r<128||(r=i[e.pos++],n|=(r&127)<<3,r<128)||(r=i[e.pos++],n|=(r&127)<<10,r<128)||(r=i[e.pos++],n|=(r&127)<<17,r<128)||(r=i[e.pos++],n|=(r&127)<<24,r<128)||(r=i[e.pos++],n|=(r&1)<<31,r<128))return Zt(s,n,t);throw new Error("Expected varint not more than 10 bytes")}function Zt(s,t,e){return e?t*4294967296+(s>>>0):(t>>>0)*4294967296+(s>>>0)}function Oc(s,t){let e,i;if(s>=0?(e=s%4294967296|0,i=s/4294967296|0):(e=~(-s%4294967296),i=~(-s/4294967296),e^4294967295?e=e+1|0:(e=0,i=i+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),Bc(e,i,t),Pc(i,t)}function Bc(s,t,e){e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos]=s&127}function Pc(s,t){const e=(s&7)<<4;t.buf[t.pos++]|=e|((s>>>=3)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127)))))}function es(s,t,e){const i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));e.realloc(i);for(let n=e.pos-1;n>=s;n--)e.buf[n+i]=e.buf[n]}function kc(s,t){for(let e=0;e<s.length;e++)t.writeVarint(s[e])}function Gc(s,t){for(let e=0;e<s.length;e++)t.writeSVarint(s[e])}function Mc(s,t){for(let e=0;e<s.length;e++)t.writeFloat(s[e])}function Uc(s,t){for(let e=0;e<s.length;e++)t.writeDouble(s[e])}function Nc(s,t){for(let e=0;e<s.length;e++)t.writeBoolean(s[e])}function Yc(s,t){for(let e=0;e<s.length;e++)t.writeFixed32(s[e])}function Qc(s,t){for(let e=0;e<s.length;e++)t.writeSFixed32(s[e])}function Vc(s,t){for(let e=0;e<s.length;e++)t.writeFixed64(s[e])}function Wc(s,t){for(let e=0;e<s.length;e++)t.writeSFixed64(s[e])}function Kc(s,t,e){let i="",n=t;for(;n<e;){const r=s[n];let o=null,a=r>239?4:r>223?3:r>191?2:1;if(n+a>e)break;let l,c,h;a===1?r<128&&(o=r):a===2?(l=s[n+1],(l&192)===128&&(o=(r&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=s[n+1],c=s[n+2],(l&192)===128&&(c&192)===128&&(o=(r&15)<<12|(l&63)<<6|c&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=s[n+1],c=s[n+2],h=s[n+3],(l&192)===128&&(c&192)===128&&(h&192)===128&&(o=(r&15)<<18|(l&63)<<12|(c&63)<<6|h&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),n+=a}return i}function jc(s,t,e){for(let i=0,n,r;i<t.length;i++){if(n=t.charCodeAt(i),n>55295&&n<57344)if(r)if(n<56320){s[e++]=239,s[e++]=191,s[e++]=189,r=n;continue}else n=r-55296<<10|n-56320|65536,r=null;else{n>56319||i+1===t.length?(s[e++]=239,s[e++]=191,s[e++]=189):r=n;continue}else r&&(s[e++]=239,s[e++]=191,s[e++]=189,r=null);n<128?s[e++]=n:(n<2048?s[e++]=n>>6|192:(n<65536?s[e++]=n>>12|224:(s[e++]=n>>18|240,s[e++]=n>>12&63|128),s[e++]=n>>6&63|128),s[e++]=n&63|128)}return e}class Xc extends or{constructor(t){super(),t=t||{},this.dataProjection=new aa({code:"",units:"tile-pixels"}),this.featureClass=t.featureClass?t.featureClass:H,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,i,n){t.pos=e.geometry;const r=t.readVarint()+t.pos;let o=1,a=0,l=0,c=0,h=0,d=0;for(;t.pos<r;){if(!a){const A=t.readVarint();o=A&7,a=A>>3}if(a--,o===1||o===2)l+=t.readSVarint(),c+=t.readSVarint(),o===1&&h>d&&(n.push(h),d=h),i.push(l,c),h+=2;else if(o===7)h>d&&(i.push(i[d],i[d+1]),h+=2);else throw new Error("Invalid command found in the PBF")}h>d&&(n.push(h),d=h)}createFeature_(t,e,i){const n=e.type;if(n===0)return null;let r;const o=e.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=e.id,o[this.layerName_]=e.layer.name;const l=[],c=[];this.readRawGeometry_(t,e,l,c);const h=qc(n,c.length);if(this.featureClass===H)r=new this.featureClass(h,l,c,2,o,a),r.transform(i.dataProjection);else{let d;if(h=="Polygon"){const f=Es(l,c);d=f.length>1?new Ee(l,"XY",f):new Qe(l,"XY",c)}else d=h==="Point"?new Mt(l,"XY"):h==="LineString"?new Jt(l,"XY"):h==="MultiPoint"?new Re(l,"XY"):h==="MultiLineString"?new we(l,"XY",c):null;const A=this.featureClass;r=new A,this.geometryName_&&r.setGeometryName(this.geometryName_);const u=di(d,!1,i);r.setGeometry(u),a!==void 0&&r.setId(a),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(t,e){const i=this.layers_;e=this.adaptOptions(e);const n=At(e.dataProjection);n.setWorldExtent(e.extent),e.dataProjection=n;const r=new Lc(t),o=r.readFields(Jc,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const c=o[l],h=c?[0,0,c.extent,c.extent]:null;n.setExtent(h);for(let d=0,A=c.length;d<A;++d){const u=Hc(r,c,d),f=this.createFeature_(r,u,e);f!==null&&a.push(f)}}return a}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}}function Jc(s,t,e){if(s===3){const i={keys:[],values:[],features:[]},n=e.readVarint()+e.pos;e.readFields(zc,i,n),i.length=i.features.length,i.length&&(t[i.name]=i)}}function zc(s,t,e){if(s===15)t.version=e.readVarint();else if(s===1)t.name=e.readString();else if(s===5)t.extent=e.readVarint();else if(s===2)t.features.push(e.pos);else if(s===3)t.keys.push(e.readString());else if(s===4){let i=null;const n=e.readVarint()+e.pos;for(;e.pos<n;)s=e.readVarint()>>3,i=s===1?e.readString():s===2?e.readFloat():s===3?e.readDouble():s===4?e.readVarint64():s===5?e.readVarint():s===6?e.readSVarint():s===7?e.readBoolean():null;t.values.push(i)}}function Zc(s,t,e){if(s==1)t.id=e.readVarint();else if(s==2){const i=e.readVarint()+e.pos;for(;e.pos<i;){const n=t.layer.keys[e.readVarint()],r=t.layer.values[e.readVarint()];t.properties[n]=r}}else s==3?t.type=e.readVarint():s==4&&(t.geometry=e.pos)}function Hc(s,t,e){s.pos=t.features[e];const i=s.readVarint()+s.pos,n={layer:t,type:0,properties:{}};return s.readFields(Zc,n,i),n}function qc(s,t){let e;return s===1?e=t===1?"Point":"MultiPoint":s===2?e=t===1?"LineString":"MultiLineString":s===3&&(e="Polygon"),e}let Tt;hi.subscribe(s=>Tt=s);const nn={1:"#7885BB",2:"#84CD8C",3:"#F5A881",4:"#7AC0E7",5:"#B086E4",6:"#CE9168",7:"#A1A56E",8:"#EA73A3",9:"#D9C593",10:"#71B1E6",11:"#ABD7C4",12:"#91D5C0",13:"#A5CFE9",14:"#C4E29E",15:"#F2E374",16:"#CD7984",17:"#D2D087",18:"#BCA468",19:"#A8D6A5",20:"#FABF78",21:"#A4BDDE",22:"#F8C67E",23:"#66BCB9",24:"#E98D9D",25:"#66CBB3",26:"#FFD066",27:"#65AC91",28:"#F6A665",29:"#B4D992",30:"#D7BA66",31:"#7AB1E0",32:"#B79DCC",33:"#909FC4",34:"#6698C9"},$c={1:k.exit1,2:k.exit2,3:k.exit3,4:k.exit4,5:k.exit5,6:k.exit6,7:k.exit7,8:k.exit8,9:k.exit9,10:k.exit10,11:k.exit11,12:k.exit12,13:k.exit13,14:k.exit14,15:k.exit15,16:k.exit16,17:k.exit17,18:k.exit18,19:k.exit19,20:k.exit20,21:k.exit21,22:k.exit22,23:k.exit23,"2-1":k.exit2_1,"3-1":k.exit3_1,"4-1":k.exit4_1,"7-1":k.exit7_1,"8-1":k.exit8_1,"8-2":k.exit8_2,"9-1":k.exit9_1},sn=new tn,th=new Nt({source:new Ut({format:sn,url:ga}),style:function(s){if(!Tt)return;const t=Tt.getView().getZoom();if(t&&t>=15){const e=nn[s.get("line_id")];return new X({stroke:new Wt({color:e,width:1.5})})}else return},zIndex:2,updateWhileAnimating:!0,updateWhileInteracting:!0}),lr=new Ut,cr=new Ut;fetch(ma).then(s=>s.json()).then(s=>{sn.readFeatures(s).forEach(e=>{lr.addFeature(e);const i=e.get("center");if(i){const n=new yt({geometry:new Mt(i.coordinates),name:e.get("name"),color:nn[e.get("line_id")]});cr.addFeature(n)}})}).catch(s=>console.error("Error loading GeoJSON data:",s));const eh=new Nt({source:lr,style:function(s){if(!Tt)return;const t=Tt.getView().getZoom();if(t&&t>=15.8){const e=nn[s.get("line_id")];return new X({fill:new Z({color:e})})}else return},zIndex:4,updateWhileAnimating:!0,updateWhileInteracting:!0}),ih=new Nt({source:cr,style:function(s){if(!Tt)return;const t=Tt.getView().getZoom();if(!(!t||t<15))return t<15.8?new X({image:new ks({radius:4,fill:new Z({color:"white"}),stroke:new Wt({color:s.get("color"),width:1.5})}),text:new lt({font:'600 14px "Pretendard Variable"',textBaseline:"top",offsetY:8,fill:new Z({color:"#25272A"}),stroke:new Wt({color:"white",width:3}),text:s.get("name")})}):new X({text:new lt({font:'600 14px "Pretendard Variable"',textBaseline:"top",offsetY:8,fill:new Z({color:"#25272A"}),stroke:new Wt({color:"white",width:3}),text:s.get("name")})})},zIndex:6,updateWhileAnimating:!0,updateWhileInteracting:!0,declutter:!0}),Ti={},nh=new Nt({source:new Ut({format:sn,url:xa}),style:function(s){if(!Tt)return;const t=Tt.getView().getZoom();if(t&&t>=16.2){const e=s.get("id");return Ti[e]||(Ti[e]=new X({image:new ce({src:$c[s.get("name")],scale:.75})})),Ti[e]}else return},zIndex:5,updateWhileAnimating:!0,updateWhileInteracting:!0}),sh="data:image/svg+xml,%3csvg%20width='8'%20height='8'%20viewBox='0%200%208%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='4'%20cy='4'%20r='3.5'%20fill='white'%20stroke='%2325272A'%20/%3e%3ccircle%20cx='4'%20cy='4'%20r='1.5'%20fill='%2325272A'%20stroke='%2325272A'%20/%3e%3c/svg%3e",rh="data:image/svg+xml,%3csvg%20width='6'%20height='6'%20viewBox='0%200%206%206'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='3'%20cy='3'%20r='2.5'%20transform='matrix(1%200%200%20-1%200%206)'%20fill='white'%20stroke='%2325272A'%20/%3e%3c/svg%3e";let Vi;hi.subscribe(s=>Vi=s);const Ot=new Wt({color:"white",width:1}),oh=new Ut({format:new tn,url:s=>`${Hi}/wfs?service=WFS&version=2.0.0&request=GetFeature&typename=bluedot:base_administrative&srsName=EPSG%3A900913&outputFormat=application%2Fjson&exceptions=application%2Fjson&bbox=${s.join(",")},EPSG:900913`,strategy:zs}),ah=new Hs({source:oh,distance:80,createCluster:(s,t)=>t.length<=1?t[0]:t.sort((i,n)=>i.get("labelrank")-n.get("labelrank"))[0]}),lh=new Nt({source:ah,style:function(s){if(!Vi)return;const t=Vi.getView().getZoom();if(!t||t<6)return;const e=s.get("labelrank"),i=s.get("alias")??s.get("name_ko");if(e===1)return t>=6&&t<7.5?new X({text:new lt({font:'700 14px "Pretendard Variable"',fill:new Z({color:"#25272A"}),stroke:Ot,text:i}),zIndex:10}):void 0;if(e===2){const n=s.get("capital");return t>=6&&t<11?new X({text:new lt({font:`600 ${t<8?"12":"16"}px "Pretendard Variable"`,textAlign:"left",offsetX:7,fill:new Z({color:"#25272A"}),stroke:Ot,text:i}),image:n?new ce({src:sh,width:8}):void 0,zIndex:9}):void 0}else if(e===3){const n=s.get("metropolitan");return t>=7.5&&t<11?new X({text:new lt({font:`600 ${t<8?"10":"14"}px "Pretendard Variable"`,textBaseline:"bottom",offsetY:-5,fill:new Z({color:"#4B5362"}),stroke:Ot,text:i}),image:n?new ce({src:rh,width:6}):void 0,zIndex:8}):void 0}else return e===4?t>=8&&t<9?new X({text:new lt({font:'600 12px "Pretendard Variable"',fill:new Z({color:"#778195"}),stroke:Ot,text:i}),zIndex:7}):void 0:e===5?t>=9&&t<14?new X({text:new lt({font:`600 ${t<11?"12":"14"}px "Pretendard Variable"`,fill:new Z({color:"#8690A2"}),stroke:Ot,text:i}),zIndex:6}):void 0:e===6?t>=11&&t<14?new X({text:new lt({font:'600 14px "Pretendard Variable"',fill:new Z({color:"#8690A2"}),stroke:Ot,text:i}),zIndex:5}):void 0:e===7?t>=14&&t<17.1?new X({text:new lt({font:`600 ${t<13?"10":"12"}px "Pretendard Variable"`,fill:new Z({color:"#8690A2"}),stroke:Ot,text:i}),zIndex:4}):void 0:e===8&&t>=15&&t<17.1?new X({text:new lt({font:'600 10px "Pretendard Variable"',fill:new Z({color:"#8690A2"}),stroke:Ot,text:i}),zIndex:3}):void 0},zIndex:3,renderBuffer:100}),hr=new X({fill:new Z({color:"#DAEEFF"}),stroke:new Wt({color:"#D1E9FC",width:1})}),ch=new Bl({source:new sl({format:new Xc,url:pa}),minZoom:17,zIndex:1,renderMode:"vector",style:hr}),hh=new Nt({source:new Ut({format:new tn,url:s=>`${Hi}/wfs?service=WFS&version=2.0.0&request=GetFeature&typename=bluedot:base_building_big&srsName=EPSG%3A900913&outputFormat=application%2Fjson&exceptions=application%2Fjson&bbox=${s[0]}%2C${s[1]}%2C${s[2]}%2C${s[3]}%2CEPSG%3A900913`,strategy:zs}),minZoom:16,maxZoom:17,zIndex:1,updateWhileAnimating:!0,updateWhileInteracting:!0,style:hr}),dh={SELECT:"select"};class Ah extends Fs{constructor(t,e,i,n){super(t),this.selected=e,this.deselected=i,this.mapBrowserEvent=n}}const ke={};class rn extends la{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:ca,this.addCondition_=t.addCondition?t.addCondition:Pn,this.removeCondition_=t.removeCondition?t.removeCondition:Pn,this.toggleCondition_=t.toggleCondition?t.toggleCondition:ha,this.multi_=t.multi?t.multi:!1,this.filter_=t.filter?t.filter:Pi,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=t.style!==void 0?t.style:uh(),this.features_=t.features||new Rs;let e;if(t.layers)if(typeof t.layers=="function")e=t.layers;else{const i=t.layers;e=function(n){return i.includes(n)}}else e=Pi;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[P(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[P(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(te.ADD,this.boundAddFeature_),this.features_.addEventListener(te.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(te.ADD,this.boundAddFeature_),this.features_.removeEventListener(te.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const i=this.getMap().getAllLayers().find(function(n){if(n instanceof Nt&&n.getSource()&&n.getSource().hasFeature(e))return n});i&&this.addFeatureLayerAssociation_(e,i)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}getStyle(){return this.style_}applySelectedStyle_(t){const e=P(t);e in ke||(ke[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let n=e.length-1;n>=0;--n){const r=e[n];if(r!==this&&r instanceof rn&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(r.getStyle());return}}const i=P(t);t.setStyle(ke[i]),delete ke[i]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[P(t)]}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),r=!e&&!i&&!n,o=t.map,a=this.getFeatures(),l=[],c=[];if(r){da(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,(h,d)=>{if(!(!(h instanceof yt)||!this.filter_(h,d)))return this.addFeatureLayerAssociation_(h,d),c.push(h),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=a.getLength()-1;h>=0;--h){const d=a.item(h),A=c.indexOf(d);A>-1?c.splice(A,1):(a.remove(d),l.push(d))}c.length!==0&&a.extend(c)}else{o.forEachFeatureAtPixel(t.pixel,(h,d)=>{if(!(!(h instanceof yt)||!this.filter_(h,d)))return(e||n)&&!a.getArray().includes(h)?(this.addFeatureLayerAssociation_(h,d),c.push(h)):(i||n)&&a.getArray().includes(h)&&(l.push(h),this.removeFeatureLayerAssociation_(h)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=l.length-1;h>=0;--h)a.remove(l[h]);a.extend(c)}return(c.length>0||l.length>0)&&this.dispatchEvent(new Ah(dh.SELECT,c,l,t)),!0}}function uh(){const s=Aa();return ft(s.Polygon,s.LineString),ft(s.GeometryCollection,s.LineString),function(t){return t.getGeometry()?s[t.getGeometry().getType()]:null}}const fh=`<svg width="50" height="58" viewBox="0 0 50 58" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <g filter="url(#filter0_d_1215_8322)">
    <path fill-rule="evenodd" clip-rule="evenodd"
      d="M43 24.0345C43 25.4836 42.8384 26.8948 42.5322 28.2511C39.9336 41.6768 27.2737 51.0001 24 51.0001C20.7263 51.0001 8.06645 41.6768 5.46782 28.2511C5.16163 26.8948 5 25.4836 5 24.0345C5 23.9377 5.00072 23.8411 5.00216 23.7447C5.00072 23.6356 5 23.5263 5 23.4167H5.00982C5.33529 13.1902 13.7129 5 24 5C34.2871 5 42.6647 13.1902 42.9902 23.4167H43C43 23.5263 42.9993 23.6356 42.9978 23.7447C42.9993 23.8411 43 23.9377 43 24.0345Z"
      fill="white" />
    <rect x="8.1665" y="8.17188" width="31.6667" height="31.7241" rx="15.8333"
      fill="#D9D9D9" />
    <rect x="8.1665" y="8.17188" width="31.6667" height="31.7241" rx="15.8333"
      fill="url(#pattern_img)" />
  </g>
  <defs>
    <filter id="filter0_d_1215_8322" x="0" y="0" width="50" height="58" filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix in="SourceAlpha" type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
      <feOffset dx="1" dy="1" />
      <feGaussianBlur stdDeviation="3" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0" />
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1215_8322" />
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1215_8322" result="shape" />
    </filter>
    <pattern id="pattern_img" width="1" height="1">
      <image width="31.6667" height="31.7241"
        xlink:href="dataURL"
        preserveAspectRatio="xMidYMid slice" />
    </pattern>
  </defs>
</svg>`,Gt=document.createElement("canvas");Gt.style.display="none";const O=Gt.getContext("2d"),gh="image/jpeg",dr="image/png",_e=5,Wi=1.5;async function mh(s,t){return new Promise(async(e,i)=>{const n=new Image;n.crossOrigin="anonymous",n.onload=async function(){if(!O)return;const r=t*Wi;Gt.width=r,Gt.height=r;const o=(r-_e*2)/2;O.beginPath(),O.arc(r/2,r/2,o,0,2*Math.PI),O.shadowBlur=_e,O.shadowColor="rgba(0, 0, 0, 0.5)",O.shadowOffsetX=1,O.shadowOffsetY=1,O.fill(),O.shadowBlur=0,O.shadowOffsetX=0,O.shadowOffsetY=0,O.clip(),O.drawImage(n,0,0,r,r),O.lineWidth=10,O.strokeStyle="white",O.stroke();const a=Gt.toDataURL(dr);O.clearRect(0,0,r,r),e(a)},n.src=s})}async function xh(s){const t=await yh(s),e=fh.replace("dataURL",t),i=new Blob([e],{type:"image/svg+xml"});return URL.createObjectURL(i)}async function ph(s,t=204,e=224.4){return new Promise(async(i,n)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=async function(){if(!O)return;t*=Wi,e*=Wi,Gt.width=t,Gt.height=e;const o=t-_e,a=e-_e,l=o/200,c=a/220;O.beginPath(),O.moveTo(100*l,220*c),O.lineTo(32*l,154*c),O.bezierCurveTo(5*l,128*c,-5*l,76*c,29*l,36*c),O.bezierCurveTo(63*l,-5*c,137*l,-5*c,171*l,36*c),O.bezierCurveTo(205*l,76*c,195*l,128*c,168*l,154*c),O.closePath(),O.shadowBlur=_e,O.shadowColor="rgba(0, 0, 0, 0.5)",O.shadowOffsetX=1,O.shadowOffsetY=1,O.fill(),O.shadowBlur=0,O.shadowOffsetX=0,O.shadowOffsetY=0,O.clip(),O.drawImage(r,0,0,o,a),O.lineWidth=10,O.strokeStyle="white",O.stroke();const h=Gt.toDataURL(dr);O.clearRect(0,0,t,e),i(h)},r.src=s})}function yh(s){return new Promise((t,e)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const n=document.createElement("canvas"),r=n.getContext("2d");if(!r)return e("context not found");n.width=i.width,n.height=i.height,r.drawImage(i,0,0,i.width,i.height);const o=n.toDataURL(gh,.3);t(o)},i.onerror=e,i.src=s})}const ii="data:image/svg+xml,%3csvg%20width='56'%20height='58'%20viewBox='0%200%2056%2058'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20%3e%3cpath%20d='M43.1568%2038.1549L27.6001%2052.7999L12.0434%2038.1549C8.96671%2035.2584%206.87153%2031.5681%206.02275%2027.5507C5.17397%2023.5332%205.60971%2019.369%207.27487%2015.5847C8.94003%2011.8004%2011.7598%208.5659%2015.3777%206.29023C18.9955%204.01456%2023.249%202.79993%2027.6001%202.79993C31.9512%202.79993%2036.2047%204.01456%2039.8225%206.29023C43.4404%208.5659%2046.2602%2011.8004%2047.9253%2015.5847C49.5905%2019.369%2050.0262%2023.5332%2049.1774%2027.5507C48.3287%2031.5681%2046.2335%2035.2584%2043.1568%2038.1549Z'%20fill='gray'%20shape-rendering='crispEdges'%20/%3e%3cpath%20d='M43.1568%2038.1549L27.6001%2052.7999L12.0434%2038.1549C8.96671%2035.2584%206.87153%2031.5681%206.02275%2027.5507C5.17397%2023.5332%205.60971%2019.369%207.27487%2015.5847C8.94003%2011.8004%2011.7598%208.5659%2015.3777%206.29023C18.9955%204.01456%2023.249%202.79993%2027.6001%202.79993C31.9512%202.79993%2036.2047%204.01456%2039.8225%206.29023C43.4404%208.5659%2046.2602%2011.8004%2047.9253%2015.5847C49.5905%2019.369%2050.0262%2023.5332%2049.1774%2027.5507C48.3287%2031.5681%2046.2335%2035.2584%2043.1568%2038.1549Z'%20stroke='white'%20stroke-width='3'%20shape-rendering='crispEdges'%20/%3e%3c/svg%3e",Ar="data:image/svg+xml,%3csvg%20width='50'%20height='58'%20viewBox='0%200%2050%2058'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%20filter='url(%23filter0_d_1215_8322)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M43%2024.0345C43%2025.4836%2042.8384%2026.8948%2042.5322%2028.2511C39.9336%2041.6768%2027.2737%2051.0001%2024%2051.0001C20.7263%2051.0001%208.06645%2041.6768%205.46782%2028.2511C5.16163%2026.8948%205%2025.4836%205%2024.0345C5%2023.9377%205.00072%2023.8411%205.00216%2023.7447C5.00072%2023.6356%205%2023.5263%205%2023.4167H5.00982C5.33529%2013.1902%2013.7129%205%2024%205C34.2871%205%2042.6647%2013.1902%2042.9902%2023.4167H43C43%2023.5263%2042.9993%2023.6356%2042.9978%2023.7447C42.9993%2023.8411%2043%2023.9377%2043%2024.0345Z'%20fill='white'%20/%3e%3crect%20x='8.1665'%20y='8.17188'%20width='31.6667'%20height='31.7241'%20rx='15.8333'%20fill='%23D9D9D9'%20/%3e%3crect%20x='8.1665'%20y='8.17188'%20width='31.6667'%20height='31.7241'%20rx='15.8333'%20fill='url(%23pattern_img)'%20/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_1215_8322'%20x='0'%20y='0'%20width='50'%20height='58'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'%20/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'%20/%3e%3cfeOffset%20dx='1'%20dy='1'%20/%3e%3cfeGaussianBlur%20stdDeviation='3'%20/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'%20/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.1%200'%20/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_1215_8322'%20/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_1215_8322'%20result='shape'%20/%3e%3c/filter%3e%3cpattern%20id='pattern_img'%20width='1'%20height='1'%3e%3cimage%20width='31.6667'%20height='31.7241'%20xlink:href='dataURL'%20preserveAspectRatio='xMidYMid%20slice'%20/%3e%3c/pattern%3e%3c/defs%3e%3c/svg%3e";let ct;hi.subscribe(s=>{ct=s,ct&&(ct.addInteraction(an),ct.getView().on("change:resolution",()=>{if(!ct)return;const t=ct.getView().getZoom();if(!t)return;const e=80*(17/t);ur.setDistance(e)}))});const _t=new Ut({attributions:[],wrapX:!1}),ur=new Hs({source:_t,distance:80,createCluster:(s,t)=>{const e=t.sort((i,n)=>Number(i.getId())-Number(n.getId()));return new yt({geometry:e[0].getGeometry(),features:e})}}),on=new Nt({source:ur,zIndex:10,style:fr,renderBuffer:100,updateWhileAnimating:!1,updateWhileInteracting:!0});_t.on("change",()=>{_t.getState()==="ready"&&on.changed()});const _h="iconSelector",an=new rn({layers:[on],style:fr});an.setProperties({name:_h});an.on("select",s=>{const t=s.mapBrowserEvent.coordinate,e=s.selected[0];let i=null,n=1/0;const r=e.get("features");r.forEach(o=>{var c;const a=(c=o.getGeometry())==null?void 0:c.getCoordinates();if(!a)return;const l=Ch(t,a);l<n&&(i=o,n=l)}),Qs((i??r[0]).get("link"))});function Ch(s,t){const e=s[0]-t[0],i=s[1]-t[1];return Math.sqrt(e*e+i*i)}function fr(s){const t=s.get("features"),e=[];let i;for(let n=0;n<t.length;n++){const r=t[n],o=Number(r.getId());if(Number.isNaN(o))continue;const a=r.getGeometry();if(a)if(n===0){if(i=wh(r),r.get("onlyMain")===!0)break}else e.push(new X({image:new ks({radius:3,fill:new Z({color:"#3490FF"})}),geometry:a}))}return i&&e.push(i),e}const Ge={};function wh(s){const t=`${s.get("type")}_${s.getId()}`,e=s.get("width"),i=s.get("height");let n;if(!Ge[t]){const r=s.get("image");r&&(n=Rh({shape:s.get("shape"),image:r,width:e,height:i}));const o=s.get("src"),a=new X({image:o?new ce({src:o,width:e,height:i,displacement:[0,s.get("offsetY")]}):void 0,text:new lt({font:'400 12px/1.8 "Pretendard Variable"',textBaseline:"top",offsetY:-1.75862,fill:new Z({color:"#25272A"}),stroke:new Wt({color:"white",width:1.5}),text:s.get("name")})});Ge[t]=a}return n==null||n.then(r=>{Ge[t].setImage(new ce({src:r,width:e,height:i,displacement:[0,s.get("offsetY")]})),_t.changed()}),Ge[t]}async function Eh(s){if(!ct)return;const t=[],e=s.map(async i=>{if(i.idx&&_t.getFeatureById(i.idx))return;const n=i.shape==="waterdrop"?ii:i.shape==="point"?Ar:"";t.push(gr(i,n))});await Promise.allSettled(e),_t.addFeatures(t)}async function Sh(s){if(!ct||s.idx&&_t.getFeatureById(s.idx))return;const t=s.shape==="waterdrop"?ii:s.shape==="point"?Ar:"",e=gr(s,t);_t.addFeature(e)}function gr(s,t){const e=new yt({width:s.width,height:s.height,offsetY:s.height/2,name:s.name.replace(/(.{8})/g,`$1
`),link:s.link,rank:s.rank,src:t,type:s.type,shape:s.shape,image:s.image,onlyMain:s.onlyMain});if(s.coordinate)e.setGeometry(new Mt(s.coordinate));else if(ct){const i=ct.getView().calculateExtent(ct.getSize()),n=oi(i);e.setGeometry(new Mt(n))}return e.setId(s.idx),e}async function Rh(s){let t;return s.shape==="circle"?t=await mh(s.image,s.width):s.shape==="waterdrop"?t=s.image===""?ii:await ph(s.image,s.width,s.height):s.shape==="point"?t=await xh(s.image):t=ii,t}const is=Us("Preferences",{web:()=>Vs(()=>import("./web.BZgSpE0H.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(s=>new s.PreferencesWeb)});function Fh(s){s.CapacitorUtils.Synapse=new Proxy({},{get(t,e){return new Proxy({},{get(i,n){return(r,o,a)=>{const l=s.Capacitor.Plugins[e];if(l===void 0){a(new Error(`Capacitor plugin ${e} not found`));return}if(typeof l[n]!="function"){a(new Error(`Method ${n} not found in Capacitor plugin ${e}`));return}(async()=>{try{const c=await l[n](r);o(c)}catch(c){a(c)}})()}}})}})}function Ih(s){s.CapacitorUtils.Synapse=new Proxy({},{get(t,e){return s.cordova.plugins[e]}})}function Th(s=!1){window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!s?Fh(window):window.cordova!==void 0&&Ih(window)}const ns=Us("Geolocation",{web:()=>Vs(()=>import("./web.BDN2T4Vn.js"),__vite__mapDeps([5,1,2,3,4]),import.meta.url).then(s=>new s.GeolocationWeb)});Th();let bi={latitude:0,longitude:0,accuracy:0,altitudeAccuracy:void 0,altitude:null,speed:null,heading:null};class mr{static async getCurrentOrLastLocation(){const t=ya.isNativePlatform()?await this.checkAndRequestGeolocationPermission():{location:"granted"};if((t==null?void 0:t.location)==="granted")try{const e=await ns.getCurrentPosition({maximumAge:2e3}),{latitude:i,longitude:n,accuracy:r,altitudeAccuracy:o,altitude:a,speed:l,heading:c}=e.coords;return bi={latitude:i,longitude:n,accuracy:r,altitudeAccuracy:o,altitude:a,speed:l,heading:c},this.saveLastKnownLocation(bi),bi}catch(e){return console.warn(e),this.getLastKnownLocation()}else return this.getLastKnownLocation()}static async checkAndRequestGeolocationPermission(){try{return await ns.requestPermissions({permissions:["location"]})}catch{return null}}static saveLastKnownLocation(t){is.set({key:this.LAST_LOCATION_KEY,value:JSON.stringify(t)})}static async getLastKnownLocation(){const{value:t}=await is.get({key:this.LAST_LOCATION_KEY});return t?JSON.parse(t):null}}_n(mr,"LAST_LOCATION_KEY","last_known_location");new Gs({source:new ol,zIndex:99});const bh=new al({url:`${Hi}/wms`,params:{LAYERS:"bluedot:v3_base",FORMAT:"image/png8",TRANSPARENT:!0,TILED:!0}}),vh=new Gs({source:bh,zIndex:0,preload:1/0}),Ie=new ua({projection:"EPSG:3857",center:Ze([126.97685,37.578019]),zoom:16,minZoom:2,maxZoom:22}),xr=document.createElement("img");xr.src=wa;const pr=new Ms({id:0,element:xr,positioning:"center-center",stopEvent:!1}),yr=document.createElement("img");yr.src=Ea;const Lh=new Ms({id:1,element:yr,positioning:"bottom-center",stopEvent:!1,offset:[0,7]}),at=new fa({layers:[vh,hh,ch,th,nh,ih,eh,lh,on],overlays:[pr,Lh],view:Ie,controls:[]});hi.set(at);ut.on("setTo",_r);function _r(s){Ie.setCenter(s)}ut.on("setToCurrentPosition",()=>Cr(_r));async function Cr(s){const t=await mr.getCurrentOrLastLocation();if(t){const e=Ze([t.longitude,t.latitude]);s(e),pr.setPosition(e)}else console.log("No location available")}ut.on("flyTo",wr);function wr(s){Ie.animate({center:s})}ut.on("flyToCurrentPosition",()=>Cr(wr));ut.on("setZoom",Dh);function Dh(s){Ie.setZoom(s)}ut.on("addIcon",Oh);function Oh(s){Sh(s)}ut.on("addIcons",Bh);function Bh(s){Eh(s)}function Ph(s){Ie.animate(s)}async function kh(s,t={},e,i){const n=e||new AbortController;let r;try{return await fetch(s.href,{...t,signal:n.signal})}catch(o){throw o.name==="AbortError"&&console.error("Request timed out"),o}}async function Gh({tags:s,bbox:t,abortController:e,offset:i=0,limit:n=100}){const r=new URL(`${Ns}/embeddings/explore`);r.searchParams.append("tags",s),r.searchParams.append("bbox",t),i&&r.searchParams.append("offset",String(i)),n&&r.searchParams.append("limit",String(n));try{return(await(await kh(r,{headers:{"x-api-version":Ys.EMBEDDING}},e||void 0)).json()).data}catch(o){return o!=="new request"&&console.error(o),[]}}function Mh(s,t=500,e=10){let i,n,r;const o=c=>{if("TouchEvent"in window&&c instanceof TouchEvent&&c.touches.length>=2)return clearTimeout(i);const{clientX:h,clientY:d}=c instanceof MouseEvent?c:c.touches[0];n=h,r=d,i=setTimeout(()=>{s.dispatchEvent(new CustomEvent("longpress",{detail:c}))},t)},a=c=>{if("TouchEvent"in window&&c instanceof TouchEvent&&c.touches.length>=2)return clearTimeout(i);const{clientX:h,clientY:d}=c instanceof MouseEvent?c:c.touches[0],A=Math.abs(h-n),u=Math.abs(d-r);(A>e||u>e)&&clearTimeout(i)},l=()=>{clearTimeout(i)};return s.addEventListener("mousedown",o),s.addEventListener("mousemove",a),s.addEventListener("mouseup",l),s.addEventListener("mouseleave",l),s.addEventListener("touchstart",o),s.addEventListener("touchmove",a),s.addEventListener("touchend",l),s.addEventListener("touchcancel",l),{destroy(){s.removeEventListener("mousedown",o),s.removeEventListener("mousemove",a),s.removeEventListener("mouseup",l),s.removeEventListener("mouseleave",l),s.removeEventListener("touchstart",o),s.removeEventListener("touchmove",a),s.removeEventListener("touchend",l),s.removeEventListener("touchcancel",l)}}}function Uh(s){if(!s||!s.includes("youtu"))return null;let t=null;return s.includes("watch?v=")?t=s.split("watch?v=")[1].split("&")[0]:s.includes("embed")?t=s.split("embed/")[1].split("?")[0]:s.includes("shorts")&&(t=s.split("shorts/")[1].split("?")[0]),t}function Nh(s,t="default"){return s.includes("youtu")?`https://img.youtube.com/vi/${Uh(s)}/${t}.jpg`:s}function vi(s,t){if(!s)return"";if(typeof s!="string"&&(s=s[0]||""),String(s).includes("youtu"))return Nh(s,"hqdefault");if(!String(s).includes("bluedot-media"))return s;const e=s.split("/").at(-1);return t?`${kn}/resize?key=${e}&side=${t}`:`${kn}/${e}`}async function Yh(s){try{const e=(await fetch(s,{method:"HEAD"})).headers.get("Content-Type");return e?e.startsWith("video/"):!1}catch(t){return console.error("Error checking file type:",t),!1}}function Qh(s){let t,e,i,n;const r=s[8].default,o=rs(r,s,s[7],null);return{c(){t=ht("div"),o&&o.c(),this.h()},l(a){t=dt(a,"DIV",{id:!0,class:!0});var l=pt(t);o&&o.l(l),l.forEach(K),this.h()},h(){W(t,"id","map"),W(t,"class","absolute w-full h-full z-[1] bg-[#BDDBF3] transition-transform duration-500"),En(t,"transform",`translateY(${s[1]}px)`)},m(a,l){Kt(a,t,l),o&&o.m(t,null),s[9](t),e=!0,i||(n=[Yr(Mh.call(null,t,500)),re(t,"longpress",s[10])],i=!0)},p(a,[l]){o&&o.p&&(!e||l&128)&&os(o,r,a,a[7],e?ls(r,a[7],l,null):as(a[7]),null),l&2&&En(t,"transform",`translateY(${a[1]}px)`)},i(a){e||(Me(o,a),e=!0)},o(a){Ue(o,a),e=!1},d(a){a&&K(t),o&&o.d(a),s[9](null),i=!1,us(n)}}}function ss(s){s.preventDefault()}function Vh(s,t,e){let i;Qr(s,_a,p=>e(5,i=p));let{$$slots:n={},$$scope:r}=t,{onSelect:o=()=>{}}=t,{onMoveend:a=()=>{}}=t,{mapY:l=0}=t,{allowEdit:c=!0}=t,{whenCancelEdit:h=()=>{}}=t;_t.refresh(),ut.on("explorePlaces",u);let d="",A;async function u(){var p;if(!(at.getView().getZoom()<16))try{A&&A.abort("new request");const C=(p=window.location.search.split("tags=")[1])==null?void 0:p.split("&")[0];if(!C)return;const S=decodeURIComponent(C);if(!S)return;d!==S&&(_t.refresh(),d=S),A=new AbortController;const R=await Gh({tags:d,bbox:Ei(at.getView().calculateExtent(),"EPSG:3857","EPSG:4326").join(),abortController:A});ut.emit("addIcons",R.map(I=>({idx:I.idx,coordinate:Ze(I.location.replace("POINT(","").replace(")","").split(" ").map(Number)),image:vi(I.thumbnail,500)||"",shape:"point",type:"place",link:`/places/${I.idx}`,rank:3,name:I.name,width:38,height:46,onlyMain:!0})))}catch(C){(C==null?void 0:C.name)==="AbortError"?console.log(" explorePlaces  ."):console.error("explorePlaces   :",C)}}at.on("moveend",f);function f(){var p,C;u(),Ca({location:((p=at.getView().getCenter())==null?void 0:p.join(","))??"",zoom:((C=at.getView().getZoom())==null?void 0:C.toFixed(2))??""}),a(Ei(at.getView().calculateExtent(),"EPSG:3857","EPSG:4326").join())}u();let m;ds(()=>{at.setTarget(m),m.addEventListener("contextmenu",ss),i.url.searchParams.has("location")&&x(),i.url.searchParams.has("placeIdx")&&g(i.url.searchParams.get("placeIdx")),a(Ei(at.getView().calculateExtent(),"EPSG:3857","EPSG:4326").join())}),As(()=>{at.un("moveend",f),m.removeEventListener("contextmenu",ss)});function x(){const p=i.url.searchParams.get("location"),C=i.url.searchParams.get("zoom"),S=p==null?void 0:p.split(",").map(Number),R={};S&&(R.center=S),C&&(R.zoom=Number(C)),Object.values(R).length>0&&Ph(R)}ut.on("addIconByPlaceIdx",g);async function g(p){var I;const C=await fetch(`${Ns}/places/${p}`,{headers:{"x-api-version":Ys.PLACE}}).then(F=>F.json()).then(F=>F.data.place).catch(F=>{console.error(F)});let S=((I=C.thumbnail)==null?void 0:I.at(0))||"";if(!String(S).includes("youtu")){const F=vi(S);await Yh(F)&&(S=S+"-thumbnail")}const R={idx:C.placeIdx,coordinate:Ze([C.longitude,C.latitude]),image:vi(S,500)||"",shape:"point",type:"place",link:`/places/${C.placeIdx}`,rank:5,name:C.name,width:38,height:46};ut.emit("addIcon",R)}function y(p){fs[p?"unshift":"push"](()=>{m=p,e(4,m)})}const _=p=>{if(!c)return h();if(!i.url.pathname.startsWith("/map"))return;const C=at.getEventCoordinate(p.detail);i.url.pathname!=="/map/edit"?Qs(`/map/edit?location=${C.join()}`):o(C)};return s.$$set=p=>{"onSelect"in p&&e(0,o=p.onSelect),"onMoveend"in p&&e(6,a=p.onMoveend),"mapY"in p&&e(1,l=p.mapY),"allowEdit"in p&&e(2,c=p.allowEdit),"whenCancelEdit"in p&&e(3,h=p.whenCancelEdit),"$$scope"in p&&e(7,r=p.$$scope)},[o,l,c,h,m,i,a,r,n,y,_]}class sd extends si{constructor(t){super(),ri(this,t,Vh,Qh,ni,{onSelect:0,onMoveend:6,mapY:1,allowEdit:2,whenCancelEdit:3})}}export{id as I,sd as M,vi as s};
