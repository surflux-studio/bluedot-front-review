const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web.CE-hvQjn.js","./store.DH9_6OTf.js","./entry.DbZqF0Ud.js","./scheduler.D5EyFb4W.js","./preload-helper.D6kgxu3v.js","./web.CEId339_.js"])))=>i.map(i=>d[i]);
var io=Object.defineProperty;var no=(s,t,e)=>t in s?io(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var Gn=(s,t,e)=>no(s,typeof t!="symbol"?t+"":t,e);import{s as ve,z as vs,e as j,c as W,b as z,f as G,o as O,i as H,p as ot,C as Ls,D as Ds,E as Bs,I as ks,J as Mn,K as Un,h as Z,n as ae,a as vt,g as Lt,a7 as Nn,q as ui,B as sn,u as rn,M as on,ab as Os,m as an,x as Ai,t as ln,d as cn,j as hn,l as Xe,y as ze,a5 as Ps,H as Yn,v as Qn,L as Vn,A as so,k as ro}from"./scheduler.D5EyFb4W.js";import{S as Le,i as De,t as Re,d as Fe,c as Ni,a as Yi,m as Qi,e as Vi}from"./index.C3Y6q9cQ.js";import{o as oo,a as ao}from"./keyboard.D1iMQ7W1.js";import{e as Qt}from"./each.cAoPAF8s.js";import{B as lo,u as Je,l as Ze,E as Zt,a as le,R as co,g as N,e as dn,i as he,c as ji,G as ho,b as Be,d as uo,h as Ao,j as fi,k as fo,m as dt,S as gi,n as yt,o as go,p as mo,q as po,r as ne,s as Gs,t as xo,v as Ms,w as yo,x as Co,y as Wi,z as Us,A as _o,C as un,D as Eo,P as Vt,F as wo,H as Ns,I as Ht,J as So,K as Ro,L as Fo,N as To,Q as Ki,U as Xi,W as Ys,Y as Qs,Z as Io,_ as He,$ as bo,a0 as Vs,a1 as js,a2 as vo,a3 as Ws,a4 as pt,a5 as qe,a6 as mi,a7 as ce,a8 as Lo,a9 as de,aa as Do,ab as Ks,ac as Bo,ad as Xs,ae as ko,af as se,ag as Oo,ah as re,ai as zs,aj as zi,ak as Ct,al as Po,am as Go,an as jn,ao as ee,ap as Js,aq as Zs,ar as V,as as ue,at as Hs,au as Mo,av as Uo,aw as No,ax as Yo,ay as Qo,az as qs,aA as st,aB as Vo,aC as An,aD as jo,X as Wo,aE as Ko,aF as Xo,aG as zo,aH as Jo,aI as Zo,aJ as Ji,aK as Ho,aL as qo,aM as $o,aN as Ut,aO as ut,aP as $e,aQ as ti,aR as Dt,aS as Bt,aT as ei,aU as ii,aV as ni,aW as pi,aX as ta,aY as ea,aZ as Xt,a_ as Te,a$ as si,b0 as $s,b1 as ia,b2 as na,b3 as tr,b4 as sa,b5 as ie,b6 as ra,b7 as oa,b8 as Wn,b9 as aa,ba as _e,bb as la,bc as ca,bd as ha,be as da,bf as Ae,bg as Kn,bh as er,bi as Ee,bj as ua,bk as Et,bl as Xn,bm as zn,bn as Aa,bo as ir,bp as fa,bq as nr,br as ga,bs as ma,bt as pa,bu as xa,bv as vi,bw as Jn,bx as ya,by as Ne,bz as et,bA as Ca,bB as _a,bC as Ea,bD as wa,bE as fe,bF as Sa,bG as $,bH as Jt,bI as it,bJ as sr,bK as gt,bL as Ra,bM as Fa,bN as Zn,bO as Ta,bP as Ia,bQ as ba,T as rr,V as va,f as ri,O as or,M as La,bR as Li}from"./Overlay.Cc9n_-zc.js";import{k as xi,l as Da,m as Ba,n as ka,G as fn,P as Oa,r as ar,C as Pa,A as lr,j as cr,o as Hn}from"./store.DH9_6OTf.js";import{g as hr}from"./entry.DbZqF0Ud.js";import{e as xt}from"./emitter.E5P-NQ8u.js";import{_ as dr}from"./preload-helper.D6kgxu3v.js";import{p as Ga}from"./stores.QjTzLvL_.js";import{s as Ma}from"./searchParams.D3NHimwt.js";function ur(s,t){const e=(""+s).split("."),i=(""+t).split(".");for(let n=0;n<Math.max(e.length,i.length);n++){const r=parseInt(e[n]||"0",10),o=parseInt(i[n]||"0",10);if(r>o)return 1;if(o>r)return-1}return 0}const Ua="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20opacity='0.2'%20cx='15'%20cy='15'%20r='15'%20fill='%230C79FE'%20/%3e%3ccircle%20cx='15'%20cy='15'%20r='7'%20fill='%230C79FE'%20stroke='white'%20stroke-width='2'%20/%3e%3c/svg%3e",Na=""+new URL("../assets/add-marker.CpezPS16.svg",import.meta.url).href;function Ya(s){let t,e,i,n,r;const o=s[2].default,a=vs(o,s,s[1],null);return{c(){t=j("div"),a&&a.c(),this.h()},l(l){t=W(l,"DIV",{class:!0});var c=z(t);a&&a.l(c),c.forEach(G),this.h()},h(){O(t,"class",e="fixed inset-0 bg-black/50 z-50 "+s[0])},m(l,c){H(l,t,c),a&&a.m(t,null),i=!0,n||(r=ot(t,"click",s[3]),n=!0)},p(l,[c]){a&&a.p&&(!i||c&2)&&Ls(a,o,l,l[1],i?Bs(o,l[1],c,null):Ds(l[1]),null),(!i||c&1&&e!==(e="fixed inset-0 bg-black/50 z-50 "+l[0]))&&O(t,"class",e)},i(l){i||(Re(a,l),i=!0)},o(l){Fe(a,l),i=!1},d(l){l&&G(t),a&&a.d(l),n=!1,r()}}}function Qa(s,t,e){let{$$slots:i={},$$scope:n}=t,{className:r=""}=t;function o(a){ks.call(this,s,a)}return s.$$set=a=>{"className"in a&&e(0,r=a.className),"$$scope"in a&&e(1,n=a.$$scope)},[r,n,i,o]}class Va extends Le{constructor(t){super(),De(this,t,Qa,Ya,ve,{className:0})}}const ja=["local","version","cdnUrl"],Wa=["skins"],Ka=["compact","flat","shortcodes"];function Xa(s,t){return Ha(s)||Za(s,t)||Ja(s,t)||za()}function za(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Ja(s,t){if(s){if(typeof s=="string")return qn(s,t);var e={}.toString.call(s).slice(8,-1);return e==="Object"&&s.constructor&&(e=s.constructor.name),e==="Map"||e==="Set"?Array.from(s):e==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?qn(s,t):void 0}}function qn(s,t){(t==null||t>s.length)&&(t=s.length);for(var e=0,i=Array(t);e<t;e++)i[e]=s[e];return i}function Za(s,t){var e=s==null?null:typeof Symbol<"u"&&s[Symbol.iterator]||s["@@iterator"];if(e!=null){var i,n,r,o,a=[],l=!0,c=!1;try{if(r=(e=e.call(s)).next,t!==0)for(;!(l=(i=r.call(e)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(h){c=!0,n=h}finally{try{if(!l&&e.return!=null&&(o=e.return(),Object(o)!==o))return}finally{if(c)throw n}}return a}}function Ha(s){if(Array.isArray(s))return s}function $n(s,t){var e=Object.keys(s);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(s);t&&(i=i.filter(function(n){return Object.getOwnPropertyDescriptor(s,n).enumerable})),e.push.apply(e,i)}return e}function Ar(s){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?arguments[t]:{};t%2?$n(Object(e),!0).forEach(function(i){qa(s,i,e[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(e)):$n(Object(e)).forEach(function(i){Object.defineProperty(s,i,Object.getOwnPropertyDescriptor(e,i))})}return s}function qa(s,t,e){return(t=$a(t))in s?Object.defineProperty(s,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):s[t]=e,s}function $a(s){var t=tl(s,"string");return typeof t=="symbol"?t:t+""}function tl(s,t){if(typeof s!="object"||!s)return s;var e=s[Symbol.toPrimitive];if(e!==void 0){var i=e.call(s,t||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function gn(s,t){if(s==null)return{};var e,i,n=el(s,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);for(i=0;i<r.length;i++)e=r[i],t.indexOf(e)>=0||{}.propertyIsEnumerable.call(s,e)&&(n[e]=s[e])}return n}function el(s,t){if(s==null)return{};var e={};for(var i in s)if({}.hasOwnProperty.call(s,i)){if(t.indexOf(i)>=0)continue;e[i]=s[i]}return e}function il(s,t,e){let i=`https://cdn.jsdelivr.net/npm/emojibase-data@${t}/${s}`;return typeof e=="function"?i=e(s,t):typeof e=="string"&&(i=`${e}/${s}`),i}async function mn(s,t={}){const e=t.local,i=e===void 0?!1:e,n=t.version,r=n===void 0?"latest":n,o=t.cdnUrl,a=gn(t,ja),l=il(s,r,o),c=i?localStorage:sessionStorage,h=`emojibase/${r}/${s}`,d=c.getItem(h);if(d)return JSON.parse(d);const u=await fetch(l,Ar({credentials:"omit",mode:"cors",redirect:"error"},a));if(!u.ok)throw new Error("Failed to load Emojibase dataset.");const A=await u.json();try{c.setItem(h,JSON.stringify(A))}catch{}return A}const nl={discord:"joypixels",slack:"iamcal"};async function ts(s,t,e){return mn(`${s}/shortcodes/${nl[t]??t}.json`,e)}function we(s,t){if(t.length===0)return s;const e=new Set(s.shortcodes);return t.forEach(i=>{const n=i[s.hexcode];Array.isArray(n)?n.forEach(r=>e.add(r)):n&&e.add(n)}),s.shortcodes=[...e],s.skins&&s.skins.forEach(i=>{we(i,t)}),s}function sl(s,t=[]){const e=[];return s.forEach(i=>{if(i.skins){const n=i.skins,r=gn(i,Wa);e.push(we(r,t)),n.forEach(o=>{const a=Ar({},o);r.tags&&(a.tags=[...r.tags]),e.push(we(a,t))})}else e.push(we(i,t))}),e}function rl(s,t){return t.length===0||s.forEach(e=>{we(e,t)}),s}async function es(s,t={}){const e=t.compact,i=e===void 0?!1:e,n=t.flat,r=n===void 0?!1:n,o=t.shortcodes,a=o===void 0?[]:o,l=gn(t,Ka),c=await mn(`${s}/${i?"compact":"data"}.json`,l);let h=[];return a.length>0&&(h=await Promise.all(a.map(d=>{let u;if(d.includes("/")){const A=d.split("/"),f=Xa(A,2),g=f[0],p=f[1];u=ts(g,p,l)}else u=ts(s,d,l);return u.catch(()=>({}))}))),r?sl(c,h):rl(c,h)}async function ol(s,t){return mn(`${s}/messages.json`,t)}function al(s){let t,e;return{c(){t=Mn("svg"),e=Mn("path"),this.h()},l(i){t=Un(i,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var n=z(t);e=Un(n,"path",{d:!0,fill:!0}),z(e).forEach(G),n.forEach(G),this.h()},h(){O(e,"d","M25.3183 6H10.6C10.2189 6.00049 9.84232 6.08586 9.49524 6.25042C9.14815 6.41497 8.83856 6.65495 8.58708 6.95437C8.54355 7.00635 8.5053 7.0629 8.47292 7.12313L3.13692 15.4844C3.04734 15.6401 3 15.8183 3 16C3 16.1817 3.04734 16.36 3.13692 16.5156L8.46515 24.8638C8.49865 24.9281 8.53873 24.9885 8.58469 25.0438C8.83614 25.3437 9.14585 25.5841 9.49316 25.749C9.84047 25.9139 10.2174 25.9995 10.5988 26H25.3183C26.0293 25.9992 26.7109 25.7034 27.2137 25.1777C27.7164 24.652 27.9992 23.9391 28 23.1956V8.80437C27.9992 8.06086 27.7164 7.34804 27.2137 6.8223C26.7109 6.29655 26.0293 6.00083 25.3183 6ZM22.0233 19.4375C22.1142 19.5299 22.1867 19.6402 22.2364 19.7621C22.2862 19.884 22.3123 20.0151 22.3132 20.1476C22.3141 20.2802 22.2898 20.4116 22.2416 20.5342C22.1935 20.6569 22.1226 20.7683 22.033 20.862C21.9433 20.9557 21.8367 21.0298 21.7194 21.0801C21.6021 21.1303 21.4765 21.1557 21.3497 21.1547C21.223 21.1537 21.0977 21.1263 20.9811 21.0743C20.8646 21.0222 20.7591 20.9464 20.6708 20.8512L17.4613 17.5L14.2536 20.8531C14.0741 21.0408 13.8306 21.1463 13.5767 21.1463C13.3229 21.1463 13.0794 21.0408 12.8999 20.8531C12.7204 20.6654 12.6195 20.4108 12.6195 20.1453C12.6195 19.8798 12.7204 19.6252 12.8999 19.4375L16.1064 16.0831L12.8975 12.7275C12.718 12.5394 12.6174 12.2846 12.6177 12.0189C12.618 11.7532 12.7191 11.4986 12.899 11.3109C13.0788 11.1233 13.3225 11.018 13.5766 11.0183C13.8306 11.0186 14.0742 11.1244 14.2536 11.3125L17.4625 14.6687L20.6702 11.3125C20.8496 11.1249 21.093 11.0194 21.3467 11.0194C21.6005 11.0194 21.8439 11.1249 22.0233 11.3125C22.2027 11.5001 22.3035 11.7546 22.3035 12.02C22.3035 12.2854 22.2027 12.5399 22.0233 12.7275L18.8138 16.0831L22.0233 19.4375Z"),O(e,"fill","#757475"),O(t,"xmlns","http://www.w3.org/2000/svg"),O(t,"width","32"),O(t,"height","32"),O(t,"viewBox","0 0 32 32"),O(t,"fill","none")},m(i,n){H(i,t,n),Z(t,e)},p:ae,i:ae,o:ae,d(i){i&&G(t)}}}class ll extends Le{constructor(t){super(),De(this,t,null,al,ve,{})}}function is(s,t,e){const i=s.slice();return i[25]=t[e],i}function ns(s,t,e){const i=s.slice();return i[33]=t[e],i}function ss(s,t,e){const i=s.slice();return i[28]=t[e][0],i[29]=t[e][1],i}function rs(s,t,e){const i=s.slice();return i[33]=t[e],i}function Di(s){const t=s.slice(),e=`group-${t[28]}`;return t[32]=e,t}function os(s){let t,e="✕",i,n;return{c(){t=j("button"),t.textContent=e,this.h()},l(r){t=W(r,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),an(t)!=="svelte-1ab8ajd"&&(t.textContent=e),this.h()},h(){O(t,"class","absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700"),O(t,"title","검색어 지우기")},m(r,o){H(r,t,o),i||(n=ot(t,"click",s[9]),i=!0)},p:ae,d(r){r&&G(t),i=!1,n()}}}function cl(s){let t,e=Qt(s[2]),i=[];for(let n=0;n<e.length;n+=1)i[n]=as(ns(s,e,n));return{c(){t=j("div");for(let n=0;n<i.length;n+=1)i[n].c();this.h()},l(n){t=W(n,"DIV",{class:!0});var r=z(t);for(let o=0;o<i.length;o+=1)i[o].l(r);r.forEach(G),this.h()},h(){O(t,"class","grid grid-cols-7 gap-2")},m(n,r){H(n,t,r);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null)},p(n,r){if(r[0]&2052){e=Qt(n[2]);let o;for(o=0;o<e.length;o+=1){const a=ns(n,e,o);i[o]?i[o].p(a,r):(i[o]=as(a),i[o].c(),i[o].m(t,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&G(t),Ai(i,n)}}}function hl(s){let t,e=Qt(Object.entries(s[0]).sort(s[14])),i=[];for(let n=0;n<e.length;n+=1)i[n]=hs(ss(s,e,n));return{c(){for(let n=0;n<i.length;n+=1)i[n].c();t=ze()},l(n){for(let r=0;r<i.length;r+=1)i[r].l(n);t=ze()},m(n,r){for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(n,r);H(n,t,r)},p(n,r){if(r[0]&2049){e=Qt(Object.entries(n[0]).sort(n[14]));let o;for(o=0;o<e.length;o+=1){const a=ss(n,e,o);i[o]?i[o].p(a,r):(i[o]=hs(a),i[o].c(),i[o].m(t.parentNode,t))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&G(t),Ai(i,n)}}}function dl(s){let t,e="<p>검색 결과가 없습니다.</p>";return{c(){t=j("div"),t.innerHTML=e,this.h()},l(i){t=W(i,"DIV",{class:!0,"data-svelte-h":!0}),an(t)!=="svelte-1sbvlnv"&&(t.innerHTML=e),this.h()},h(){O(t,"class","flex justify-center items-center h-full")},m(i,n){H(i,t,n)},p:ae,d(i){i&&G(t)}}}function ul(s){let t,e="<p>이모지 로딩 중...</p>";return{c(){t=j("div"),t.innerHTML=e,this.h()},l(i){t=W(i,"DIV",{class:!0,"data-svelte-h":!0}),an(t)!=="svelte-n7g9l7"&&(t.innerHTML=e),this.h()},h(){O(t,"class","flex justify-center items-center h-full")},m(i,n){H(i,t,n)},p:ae,d(i){i&&G(t)}}}function as(s){let t,e=s[33].unicode+"",i,n,r,o,a;function l(){return s[16](s[33])}return{c(){t=j("div"),i=ln(e),n=vt(),this.h()},l(c){t=W(c,"DIV",{class:!0,title:!0});var h=z(t);i=cn(h,e),n=Lt(h),h.forEach(G),this.h()},h(){O(t,"class","text-3xl pointer-events-auto hover:bg-gray-100 p-1 rounded cursor-pointer text-center"),O(t,"title",r=s[33].label)},m(c,h){H(c,t,h),Z(t,i),Z(t,n),o||(a=ot(t,"click",ui(sn(l)),!0),o=!0)},p(c,h){s=c,h[0]&4&&e!==(e=s[33].unicode+"")&&hn(i,e),h[0]&4&&r!==(r=s[33].label)&&O(t,"title",r)},d(c){c&&G(t),o=!1,a()}}}function ls(s){let t,e,i,n,r,o=Qt(s[29]),a=[];for(let l=0;l<o.length;l+=1)a[l]=cs(rs(s,o,l));return{c(){t=j("hr"),i=vt(),n=j("div");for(let l=0;l<a.length;l+=1)a[l].c();r=vt(),this.h()},l(l){t=W(l,"HR",{id:!0,class:!0}),i=Lt(l),n=W(l,"DIV",{class:!0});var c=z(n);for(let h=0;h<a.length;h+=1)a[h].l(c);r=Lt(c),c.forEach(G),this.h()},h(){O(t,"id",e=s[32]),O(t,"class","opacity-0 h-0 m-0 p-0"),O(n,"class","grid grid-cols-7 gap-2 mb-4")},m(l,c){H(l,t,c),H(l,i,c),H(l,n,c);for(let h=0;h<a.length;h+=1)a[h]&&a[h].m(n,null);Z(n,r)},p(l,c){if(c[0]&1&&e!==(e=l[32])&&O(t,"id",e),c[0]&2049){o=Qt(l[29]);let h;for(h=0;h<o.length;h+=1){const d=rs(l,o,h);a[h]?a[h].p(d,c):(a[h]=cs(d),a[h].c(),a[h].m(n,r))}for(;h<a.length;h+=1)a[h].d(1);a.length=o.length}},d(l){l&&(G(t),G(i),G(n)),Ai(a,l)}}}function cs(s){let t,e=s[33].unicode+"",i,n,r,o;function a(){return s[15](s[33])}return{c(){t=j("div"),i=ln(e),this.h()},l(l){t=W(l,"DIV",{class:!0,title:!0});var c=z(t);i=cn(c,e),c.forEach(G),this.h()},h(){O(t,"class","text-3xl pointer-events-auto hover:bg-gray-100 p-1 rounded cursor-pointer text-center"),O(t,"title",n=s[33].label)},m(l,c){H(l,t,c),Z(t,i),r||(o=ot(t,"click",ui(sn(a)),!0),r=!0)},p(l,c){s=l,c[0]&1&&e!==(e=s[33].unicode+"")&&hn(i,e),c[0]&1&&n!==(n=s[33].label)&&O(t,"title",n)},d(l){l&&G(t),r=!1,o()}}}function hs(s){let t,e=s[29].length>0&&ls(Di(s));return{c(){e&&e.c(),t=ze()},l(i){e&&e.l(i),t=ze()},m(i,n){e&&e.m(i,n),H(i,t,n)},p(i,n){i[29].length>0?e?e.p(Di(i),n):(e=ls(Di(i)),e.c(),e.m(t.parentNode,t)):e&&(e.d(1),e=null)},d(i){i&&G(t),e&&e.d(i)}}}function ds(s){let t,e=Qt(s[1]),i=[];for(let n=0;n<e.length;n+=1)i[n]=us(is(s,e,n));return{c(){t=j("div");for(let n=0;n<i.length;n+=1)i[n].c();this.h()},l(n){t=W(n,"DIV",{class:!0});var r=z(t);for(let o=0;o<i.length;o+=1)i[o].l(r);r.forEach(G),this.h()},h(){O(t,"class","flex items-center justify-between overflow-x-auto")},m(n,r){H(n,t,r);for(let o=0;o<i.length;o+=1)i[o]&&i[o].m(t,null)},p(n,r){if(r[0]&1042){e=Qt(n[1]);let o;for(o=0;o<e.length;o+=1){const a=is(n,e,o);i[o]?i[o].p(a,r):(i[o]=us(a),i[o].c(),i[o].m(t,null))}for(;o<i.length;o+=1)i[o].d(1);i.length=e.length}},d(n){n&&G(t),Ai(i,n)}}}function us(s){let t,e=s[25].label+"",i,n,r,o,a,l;function c(){return s[18](s[25])}return{c(){t=j("div"),i=ln(e),n=vt(),this.h()},l(h){t=W(h,"DIV",{class:!0,title:!0});var d=z(t);i=cn(d,e),n=Lt(d),d.forEach(G),this.h()},h(){O(t,"class",r="cursor-pointer px-2 text-xl "+(s[4]===s[25].key?"bg-gray-200 rounded":"")),O(t,"title",o=`Group ${s[25].groupIndex}`)},m(h,d){H(h,t,d),Z(t,i),Z(t,n),a||(l=ot(t,"click",c),a=!0)},p(h,d){s=h,d[0]&2&&e!==(e=s[25].label+"")&&hn(i,e),d[0]&18&&r!==(r="cursor-pointer px-2 text-xl "+(s[4]===s[25].key?"bg-gray-200 rounded":""))&&O(t,"class",r),d[0]&2&&o!==(o=`Group ${s[25].groupIndex}`)&&O(t,"title",o)},d(h){h&&G(t),a=!1,l()}}}function Al(s){let t,e,i,n,r,o,a,l,c,h,d,u,A,f,g,p,y=s[3]&&os(s);c=new ll({});function m(w,R){return w[5]?ul:w[2].length===0?dl:w[3]?cl:hl}let C=m(s),x=C(s),_=!s[3]&&ds(s);return{c(){t=j("div"),e=j("div"),i=j("div"),n=j("div"),r=j("input"),o=vt(),y&&y.c(),a=vt(),l=j("div"),Ni(c.$$.fragment),h=vt(),d=j("div"),x.c(),u=vt(),A=j("div"),_&&_.c(),this.h()},l(w){t=W(w,"DIV",{class:!0});var R=z(t);e=W(R,"DIV",{class:!0});var I=z(e);i=W(I,"DIV",{class:!0});var T=z(i);n=W(T,"DIV",{class:!0});var U=z(n);r=W(U,"INPUT",{type:!0,class:!0,placeholder:!0}),o=Lt(U),y&&y.l(U),U.forEach(G),a=Lt(T),l=W(T,"DIV",{class:!0});var D=z(l);Yi(c.$$.fragment,D),D.forEach(G),T.forEach(G),I.forEach(G),h=Lt(R),d=W(R,"DIV",{class:!0});var E=z(d);x.l(E),E.forEach(G),u=Lt(R),A=W(R,"DIV",{class:!0});var L=z(A);_&&_.l(L),L.forEach(G),R.forEach(G),this.h()},h(){O(r,"type","text"),O(r,"class","w-full p-1 border border-gray-300 rounded-md pr-8"),O(r,"placeholder","이모지 검색... (한글 가능)"),O(n,"class","grow mr-2 relative"),O(l,"class","shrink-0"),O(i,"class","flex items-center justify-between mb-2"),O(e,"class","sticky top-0 w-full bg-white safe-area-pb p-2 h-16 z-10"),O(d,"class","w-full flex-1 p-2 overflow-y-auto "),O(A,"class","sticky bottom-0 w-full bg-white safe-area-pb p-2 h-14 z-10"),O(t,"class","w-full h-[300px] max-w-[500px] bg-white rounded-t-lg shadow-xl flex flex-col relative p-2 ")},m(w,R){H(w,t,R),Z(t,e),Z(e,i),Z(i,n),Z(n,r),Nn(r,s[3]),Z(n,o),y&&y.m(n,null),Z(i,a),Z(i,l),Qi(c,l,null),Z(t,h),Z(t,d),x.m(d,null),s[17](d),Z(t,u),Z(t,A),_&&_.m(A,null),f=!0,g||(p=[ot(r,"input",s[12]),ot(r,"input",s[8]),ot(l,"click",ui(sn(s[13])),!0),ot(d,"scroll",s[7])],g=!0)},p(w,R){R[0]&8&&r.value!==w[3]&&Nn(r,w[3]),w[3]?y?y.p(w,R):(y=os(w),y.c(),y.m(n,null)):y&&(y.d(1),y=null),C===(C=m(w))&&x?x.p(w,R):(x.d(1),x=C(w),x&&(x.c(),x.m(d,null))),w[3]?_&&(_.d(1),_=null):_?_.p(w,R):(_=ds(w),_.c(),_.m(A,null))},i(w){f||(Re(c.$$.fragment,w),f=!0)},o(w){Fe(c.$$.fragment,w),f=!1},d(w){w&&G(t),y&&y.d(),Vi(c),x.d(),s[17](null),_&&_.d(),g=!1,rn(p)}}}function fl(s,t,e){let i={},n=[],r=[],o=[],a="",l=null,c=!0,h,d=new Map,u={},A=[];function f(){setTimeout(()=>{d.clear(),n.forEach(E=>{const L=h.querySelector(`#${E.key}`);L&&d.set(E.key,L.offsetTop-h.offsetTop)}),console.log("동적 카테고리 위치 저장됨:",[...d.entries()])},100)}function g(){if(!h)return;const E=h.scrollTop;let L=null;for(const[b,k]of d.entries())k!==void 0&&E>=k-10&&(L=b);if(L===null&&n.length>0){const b=n[0].key,k=d.get(b);k!==void 0&&E<k&&(L=b)}L!==l&&(e(4,l=L),console.log("스크롤로 카테고리 변경:",l))}function p(){if(!a.trim()){e(2,o=r);return}const E=a.toLowerCase();e(2,o=r.filter(L=>{if(L.unicode.toLowerCase().includes(E)||L.label&&L.label.toLowerCase().includes(E)||L.tags&&L.tags.some(v=>v.toLowerCase().includes(E)))return!0;const b=A.find(v=>v.hexcode===L.hexcode);if(b&&(b.label&&b.label.toLowerCase().includes(E)||b.tags&&b.tags.some(v=>v.toLowerCase().includes(E))))return!0;const k=u[`annotation-${L.hexcode}`];if(k&&k.toLowerCase().includes(E))return!0;const F=u[`tags-${L.hexcode}`];return!!(F&&F.toLowerCase().includes(E))}))}function y(){e(3,a=""),p()}function m(E){if(e(4,l=E),d.has(E)){const L=d.get(E);h.scrollTo({top:L,behavior:"smooth"}),console.log(`저장된 위치로 스크롤: ${E}:`,L)}else console.log(`저장된 위치가 없음: ${E}, 위치 다시 계산`),setTimeout(()=>{const L=h.querySelector(`#category-${E}`);if(L&&h){const b=L.offsetTop-h.offsetTop;h.scrollTo({top:b,behavior:"smooth"}),d.set(E,b),console.log(`위치 계산 및 저장: ${E}:`,b)}},10)}async function C(){try{e(5,c=!0),u=await ol("ko"),console.log("한국어 메시지 로드 완료:",Object.keys(u).length);const E=new Map;(await es("ko",{compact:!0,flat:!0})).forEach(v=>E.set(v.hexcode,v)),r=(await es("en",{compact:!0,flat:!0})).map(v=>{const P={...v},J=E.get(v.hexcode);if(J&&J.tags){const q=new Set([...P.tags||[],...J.tags||[]]);P.tags=Array.from(q)}const Q=u[`annotation-${v.hexcode}`];Q&&P.label&&(P.label=`${P.label} (${Q})`);const K=u[`tags-${v.hexcode}`];if(K){const q=K.split(",").map(S=>S.trim()),At=new Set(P.tags||[]);q.forEach(S=>At.add(S)),P.tags=Array.from(At)}return P}).sort((v,P)=>v.group===void 0&&P.group===void 0?0:v.group===void 0?1:P.group===void 0?-1:v.group===P.group?(v.order||0)-(P.order||0):v.group-P.group),e(0,i={}),e(1,n=[]);let F=-1;for(const v of r)if(v.group!==void 0&&(i[v.group]||e(0,i[v.group]=[],i),i[v.group].push(v),v.group!==F)){const P=i[v.group][0];P&&P.unicode&&(n.push({key:`group-${v.group}`,label:P.unicode,groupIndex:v.group}),F=v.group)}console.log("생성된 카테고리 헤더:",n),e(2,o=r),console.log("통합 및 그룹핑된 이모지 로드 완료 (EN 기준):",r.length)}catch(E){console.error("이모지 로딩 오류:",E)}finally{e(5,c=!1),f()}}on(()=>{C();const E=()=>{f()};return window.addEventListener("resize",E),()=>{window.removeEventListener("resize",E)}});const x=Os();function _(){a=this.value,e(3,a)}const w=()=>{x("backspace")},R=([E],[L])=>parseInt(E)-parseInt(L),I=E=>{x("emojiClick",{emoji:E})},T=E=>{x("emojiClick",{emoji:E})};function U(E){Xe[E?"unshift":"push"](()=>{h=E,e(6,h)})}return[i,n,o,a,l,c,h,g,p,y,m,x,_,w,R,I,T,U,E=>m(E.key)]}class gl extends Le{constructor(t){super(),De(this,t,fl,Al,ve,{},null,[-1,-1])}}function ml(s){let t,e,i,n,r,o;return{c(){t=j("div"),e=j("textarea"),this.h()},l(a){t=W(a,"DIV",{class:!0});var l=z(t);e=W(l,"TEXTAREA",{class:!0,inputmode:!0}),z(e).forEach(G),l.forEach(G),this.h()},h(){O(e,"class",i="outline-none ring-0 focus:outline-none focus:ring-0 border-none shadow-none text-white bg-transparent transition-transform duration-300 text-center "+(s[1]==="emoji"&&s[0]?"translate-y-[-125px]":"translate-y-0")+" caret-white w-full mx-12 min-h-6"),O(e,"inputmode",n=s[1]==="emoji"?"none":"text"),Yn(e,"text-2xl",s[1]==="emoji"),O(t,"class","flex items-center justify-center h-full")},m(a,l){H(a,t,l),Z(t,e),s[11](e),r||(o=[ot(e,"click",ui(s[9])),ot(e,"keydown",s[10]),ot(e,"input",Cl)],r=!0)},p(a,l){l&3&&i!==(i="outline-none ring-0 focus:outline-none focus:ring-0 border-none shadow-none text-white bg-transparent transition-transform duration-300 text-center "+(a[1]==="emoji"&&a[0]?"translate-y-[-125px]":"translate-y-0")+" caret-white w-full mx-12 min-h-6")&&O(e,"class",i),l&2&&n!==(n=a[1]==="emoji"?"none":"text")&&O(e,"inputmode",n),l&3&&Yn(e,"text-2xl",a[1]==="emoji")},d(a){a&&G(t),s[11](null),r=!1,rn(o)}}}function pl(s){let t,e,i,n,r,o,a;return t=new Va({props:{className:`
    transition-opacity duration-300 
    ${s[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${s[2]?"visible":"invisible"}
  `,$$slots:{default:[ml]},$$scope:{ctx:s}}}),t.$on("click",s[12]),r=new gl({}),r.$on("backspace",s[5]),r.$on("emojiClick",s[6]),{c(){Ni(t.$$.fragment),e=vt(),i=j("div"),n=j("div"),Ni(r.$$.fragment),this.h()},l(l){Yi(t.$$.fragment,l),e=Lt(l),i=W(l,"DIV",{class:!0});var c=z(i);n=W(c,"DIV",{class:!0});var h=z(n);Yi(r.$$.fragment,h),h.forEach(G),c.forEach(G),this.h()},h(){O(n,"class","transition-transform duration-300"),O(i,"class",o="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 "+(s[0]?"translate-y-0":"translate-y-[330px]")+" "+(s[1]==="emoji"&&s[2]?"visible":"invisible"))},m(l,c){Qi(t,l,c),H(l,e,c),H(l,i,c),Z(i,n),Qi(r,n,null),s[13](n),a=!0},p(l,[c]){const h={};c&5&&(h.className=`
    transition-opacity duration-300 
    ${l[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${l[2]?"visible":"invisible"}
  `),c&32779&&(h.$$scope={dirty:c,ctx:l}),t.$set(h),(!a||c&7&&o!==(o="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 "+(l[0]?"translate-y-0":"translate-y-[330px]")+" "+(l[1]==="emoji"&&l[2]?"visible":"invisible")))&&O(i,"class",o)},i(l){a||(Re(t.$$.fragment,l),Re(r.$$.fragment,l),a=!0)},o(l){Fe(t.$$.fragment,l),Fe(r.$$.fragment,l),a=!1},d(l){l&&(G(e),G(i)),Vi(t,l),Vi(r),s[13](null)}}}function xl(s){}function yl(){}const Cl=s=>{s.target.style.height="auto",s.target.style.height=s.target.scrollHeight+"px"};function _l(s,t,e){const i=Os();let{isOpen:n=!1}=t,{value:r}=t,{type:o="text"}=t,a=!1,l=null,c=null;on(()=>{oo(()=>{},xl,yl),new MutationObserver(C=>{e(7,r=(l==null?void 0:l.innerText)||""),i("change",r)}).observe(l,{childList:!0,subtree:!0})}),Ps(()=>{ao()});async function h(){if(!l)return;l.focus(),await Qn(),document.execCommand("delete");const m=l.innerText;i("change",m)}async function d(m){if(!l)return;const C=m.detail.emoji.unicode;l.focus(),await Qn(),document.execCommand("insertText",!1,C);const x=l.innerText;i("change",x)}function u(){l==null||l.focus()}function A(m){ks.call(this,s,m)}const f=m=>{if(o==="emoji"){if(m.metaKey&&m.key==="k")return;m.preventDefault(),m.stopPropagation()}};function g(m){Xe[m?"unshift":"push"](()=>{l=m,e(3,l)})}const p=m=>{m.stopPropagation(),e(0,n=!1)};function y(m){Xe[m?"unshift":"push"](()=>{c=m,e(4,c)})}return s.$$set=m=>{"isOpen"in m&&e(0,n=m.isOpen),"value"in m&&e(7,r=m.value),"type"in m&&e(1,o=m.type)},s.$$.update=()=>{s.$$.dirty&1&&(n?e(2,a=!0):setTimeout(()=>{e(2,a=!1)},300))},[n,o,a,l,c,h,d,r,u,A,f,g,p,y]}class Id extends Le{constructor(t){super(),De(this,t,_l,pl,ve,{isOpen:0,value:7,type:1,focusInput:8})}get focusInput(){return this.$$.ctx[8]}}class wt extends lo{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new wt(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(Je(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=Ze(t,Zt.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?El(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function El(s){if(typeof s=="function")return s;let t;return Array.isArray(s)?t=s:(le(typeof s.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[s]),function(){return t}}class As{constructor(t){this.rbush_=new co(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[N(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const o=t[n],a=e[n],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=l,this.items_[N(a)]=l}this.rbush_.load(i)}remove(t){const e=N(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[N(e)],n=[i.minX,i.minY,i.maxX,i.maxY];dn(n,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(n){return n.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return he(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return ji(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class oi extends ho{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(Je),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(Ze(t[e],Zt.CHANGE,this.changed,this))}clone(){const t=new oi(Bi(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Be(this.getExtent(),t,e))return n;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)n=r[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){uo(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)Ao(t,e[i].getExtent());return t}getGeometries(){return Bi(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(n=!0)}return n?new oi(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=fi(this.getExtent()));const n=this.geometries_;for(let r=0,o=n.length;r<o;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Bi(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}}function Bi(s){return s.map(t=>t.clone())}function ai(s,t,e,i,n,r,o){let a,l;const c=(e-t)/i;if(c===1)a=t;else if(c===2)a=t,l=n;else if(c!==0){let h=s[t],d=s[t+1],u=0;const A=[0];for(let p=t+i;p<e;p+=i){const y=s[p],m=s[p+1];u+=Math.sqrt((y-h)*(y-h)+(m-d)*(m-d)),A.push(u),h=y,d=m}const f=n*u,g=fo(A,f);g<0?(l=(f-A[-g-2])/(A[-g-1]-A[-g-2]),a=t+(-g-2)*i):a=t+g*i}o=o>1?o:2,r=r||new Array(o);for(let h=0;h<o;++h)r[h]=a===void 0?NaN:l===void 0?s[a+h]:dt(s[a+h],s[a+i+h],l);return r}function Zi(s,t,e,i,n,r){if(e==t)return null;let o;if(n<s[t+i-1])return r?(o=s.slice(t,t+i),o[i-1]=n,o):null;if(s[e-1]<n)return r?(o=s.slice(e-i,e),o[i-1]=n,o):null;if(n==s[t+i-1])return s.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const u=a+l>>1;n<s[(u+1)*i-1]?l=u:a=u+1}const c=s[a*i-1];if(n==c)return s.slice((a-1)*i,(a-1)*i+i);const h=s[(a+1)*i-1],d=(n-c)/(h-c);o=[];for(let u=0;u<i-1;++u)o.push(dt(s[(a-1)*i+u],s[a*i+u],d));return o.push(n),o}function wl(s,t,e,i,n,r,o){if(o)return Zi(s,t,e[e.length-1],i,n,r);let a;if(n<s[i-1])return r?(a=s.slice(0,i),a[i-1]=n,a):null;if(s[s.length-1]<n)return r?(a=s.slice(s.length-i),a[i-1]=n,a):null;for(let l=0,c=e.length;l<c;++l){const h=e[l];if(t!=h){if(n<s[t+i-1])return null;if(n<=s[h-1])return Zi(s,t,h,i,n,!1);t=h}}return null}function fr(s,t,e,i){let n=s[t],r=s[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=s[a],c=s[a+1];o+=Math.sqrt((l-n)*(l-n)+(c-r)*(c-r)),n=l,r=c}return o}class qt extends gi{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){yt(this.flatCoordinates,t),this.changed()}clone(){const t=new qt(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Be(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(go(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),mo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return po(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,Zi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return ai(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return fr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=Gs(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new qt(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return xo(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ms(this.flatCoordinates,0,t,this.stride),this.changed()}}class Ie extends gi{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const n=t,r=[],o=[];for(let l=0,c=n.length;l<c;++l){const h=n[l];yt(r,h.getFlatCoordinates()),o.push(r.length)}const a=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(t){yt(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new Ie(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<Be(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(yo(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Co(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,wl(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return Wi(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new qt(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],c=new qt(t.slice(r,l),i);n.push(c),r=l}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let o=0,a=n.length;o<a;++o){const l=n[o],c=ai(e,i,l,r,.5);yt(t,c),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Us(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new Ie(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return _o(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=un(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}class ke extends gi{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){yt(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new ke(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<Be(this.getExtent(),t,e))return n;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const c=Eo(t,e,r[a],r[a+1]);if(c<n){n=c;for(let h=0;h<o;++h)i[h]=r[a+h];i.length=o}}return n}getCoordinates(){return ne(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new Vt(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,o=t.length;r<o;r+=i){const a=new Vt(t.slice(r,r+i),e);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i){const o=e[n],a=e[n+1];if(wo(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Ms(this.flatCoordinates,0,t,this.stride),this.changed()}}function gr(s,t,e,i){const n=[];let r=Ht();for(let o=0,a=e.length;o<a;++o){const l=e[o];r=Ns(s,t,l[0],i),n.push((r[0]+r[2])/2,(r[1]+r[3])/2),t=l[l.length-1]}return n}class be extends gi{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,r=[],o=[];for(let a=0,l=n.length;a<l;++a){const c=n[a],h=r.length,d=c.getEnds();for(let u=0,A=d.length;u<A;++u)d[u]+=h;yt(r,c.getFlatCoordinates()),o.push(d)}e=n.length===0?this.getLayout():n[0].getLayout(),t=r,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;yt(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let n=0,r=e.length;n<r;++n)e[n]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const i=new be(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<Be(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(So(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ro(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Fo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return To(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ki(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Xi(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=gr(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Ys(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new ke(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Qs(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ki(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=Io(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new be(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(e!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=e;return new He(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),c=l[l.length-1];if(r!==0)for(let d=0,u=l.length;d<u;++d)l[d]-=r;const h=new He(e.slice(r,c),t,l);n.push(h),r=c}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return bo(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=Vs(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}}const fs=de();class nt{constructor(t,e,i,n,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?js(this.flatCoordinates_):Ns(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=fi(this.getExtent());this.flatInteriorPoints_=vo(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Ws(this.flatCoordinates_,this.ends_),e=gr(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Ys(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=ai(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const o=i[n],a=ai(t,e,o,2,.5);yt(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=pt(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const n=qe(i)/qe(e);mi(fs,i[0],i[3],n,-n,0,0,0),ce(this.flatCoordinates_,0,this.flatCoordinates_.length,2,fs,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new nt(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=Lo((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=Gs(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=Us(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=Do(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n);break}return n&&(this.simplifiedGeometry_=new nt(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}nt.prototype.getFlatCoordinates=nt.prototype.getOrientedFlatCoordinates;const ht={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function Sl(s,t){return[[-1/0,-1/0,1/0,1/0]]}function mr(s,t){return[s]}let Rl=!1;function pr(s,t,e,i,n,r,o){const a=new XMLHttpRequest;a.open("GET",typeof s=="function"?s(e,i,n):s,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=Rl,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const c=t.getType();try{let h;c=="text"||c=="json"?h=a.responseText:c=="xml"?h=a.responseXML||a.responseText:c=="arraybuffer"&&(h=a.response),h?r(t.readFeatures(h,{extent:e,featureProjection:n}),t.readProjection(h)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function gs(s,t){return function(e,i,n,r,o){const a=this;pr(s,t,e,i,n,function(l,c){a.addFeatures(l),r!==void 0&&r(l)},o||Ks)}}class Ot extends zs{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class jt extends Bo{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=Ks,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(le(this.format_,"`format` must be set when `url` is set"),this.loader_=gs(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:Sl;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new As:null,this.loadedExtentsRtree_=new As,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),!e&&i===void 0&&(i=new Xs(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=N(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new Ot(ht.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof nt||(this.featureChangeKeys_[t]=[Ze(e,Zt.CHANGE,this.handleFeatureChange_,this),Ze(e,ko.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const n=String(e.getId());if(!(n in this.idIndex_))this.idIndex_[n]=e;else if(e instanceof nt){const r=this.idIndex_[n];r instanceof nt?Array.isArray(r)?r.push(e):this.idIndex_[n]=[r,e]:i=!1}else i=!1}return i&&(le(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=N(a);this.addToIndex_(l,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],l=N(a);this.setupChangeEvents_(l,a);const c=a.getGeometry();if(c){const h=c.getExtent();e.push(h),n.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(ht.ADDFEATURE))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new Ot(ht.ADDFEATURE,i[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(ht.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(ht.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(se.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(se.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(Je);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=n=>{this.removeFeatureInternal(n)};this.featuresRtree_.forEach(i);for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new Ot(ht.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(n){const r=n.getGeometry();if(r instanceof nt||r.intersectsCoordinate(t))return e(n)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const n=i.getGeometry();if(n instanceof nt||n.intersectsExtent(t)){const r=e(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),he(this.nullGeometryFeatures_)||yt(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=Oo(t,e);return[].concat(...n.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||zi,this.featuresRtree_.forEachInExtent(l,function(c){if(e(c)){const h=c.getGeometry(),d=a;if(a=h instanceof nt?0:h.closestPointXY(i,n,o,a),a<d){r=c;const u=Math.sqrt(a);l[0]=i-u,l[1]=n-u,l[2]=i+u,l[3]=n+u}}}),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=N(e),n=e.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const r=e.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new Ot(ht.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:N(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&he(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let o=0,a=r.length;o<a;++o){const l=r[o];n.forEachInExtent(l,function(h){return re(h.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new Ot(ht.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,h=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ot(ht.FEATURESLOADEND,void 0,h))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new Ot(ht.FEATURESLOADERROR))}),n.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,function(n){if(dn(n.extent,t))return i=n,!0}),i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=N(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i==null||i.forEach(Je),delete this.featureChangeKeys_[e];const n=t.getId();if(n!==void 0){const r=n.toString(),o=this.idIndex_[r];o===t?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[e],this.hasListener(ht.REMOVEFEATURE)&&this.dispatchEvent(new Ot(ht.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){le(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(gs(t,this.format_))}}class xr extends jt{constructor(t){t=t||{},super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=t.distance!==void 0?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(e){const i=e.getGeometry();return le(!i||i.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),i},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,i){var n;(n=this.source)==null||n.loadFeatures(t,e,i),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(Zt.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(Zt.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const i=t===0?0:Math.min(e,t)/t,n=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=e,this.interpolationRatio=i,n&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const t=Ht(),e=this.distance*this.resolution,i=this.source.getFeatures(),n={};for(let r=0,o=i.length;r<o;r++){const a=i[r];if(!(N(a)in n)){const l=this.geometryFunction(a);if(l){const c=l.getCoordinates();js(c,t),Ct(t,e,t);const h=this.source.getFeaturesInExtent(t).filter(function(d){const u=N(d);return u in n?!1:(n[u]=!0,!0)});this.features.push(this.createCluster(h,t))}}}}createCluster(t,e){const i=[0,0];for(let a=t.length-1;a>=0;--a){const l=this.geometryFunction(t[a]);l?Po(i,l.getCoordinates()):t.splice(a,1)}Go(i,1/t.length);const n=fi(e),r=this.interpolationRatio,o=new Vt([i[0]*(1-r)+n[0]*r,i[1]*(1-r)+n[1]*r]);return this.createCustomCluster_?this.createCustomCluster_(o,t):new wt({geometry:o,features:t})}}const ms=4,Hi="1.3.0";function Fl(s,t,e,i,n){n.WIDTH=e[0],n.HEIGHT=e[1];const r=i.getAxisOrientation(),o=ur(n.VERSION,"1.3")>=0;n[o?"CRS":"SRS"]=i.getCode();const a=o&&r.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return n.BBOX=a.join(","),Js(s,n)}function Tl(s,t,e,i,n,r,o){r=Object.assign({REQUEST:"GetMap"},r);const a=t/e,l=[jn(ee(s)/a,ms),jn(qe(s)/a,ms)];if(e!=1)switch(o){case"geoserver":const h=90*e+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+h:r.FORMAT_OPTIONS="dpi:"+h;break;case"mapserver":r.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":r.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return Fl(n,s,l,i,r)}function ps(s,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:Hi,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},s)}let Il=class extends Zs{constructor(t,e,i,n,r,o){super(t,e,o),this.extent=null,this.format_=n,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=r,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==V.IDLE&&(this.setState(V.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(t,e){this.setFeatures(t)}onError(){this.setState(V.ERROR)}setFeatures(t){this.features_=t,this.setState(V.LOADED)}setLoader(t){this.loader_=t}};const xs=[];class bl extends Zs{constructor(t,e,i,n){super(t,e,{transition:0}),this.context_=null,this.executorGroups=[],this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=n.bind(void 0,this),this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=ue(1,1,xs)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(t){const e=N(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){Hs(this.context_),xs.push(this.context_.canvas),this.context_=null,super.release()}}class vl extends Mo{constructor(t){const e=t.projection||"EPSG:3857",i=t.extent||Uo(e),n=t.tileGrid||No({extent:i,maxResolution:t.maxResolution,maxZoom:t.maxZoom!==void 0?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,projection:e,state:t.state,tileGrid:n,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Ll,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0?!0:t.wrapX,transition:t.transition,zDirection:t.zDirection===void 0?1:t.zDirection}),this.format_=t.format?t.format:null,this.sourceTileCache_=new Yo(128),this.overlaps_=t.overlaps==null?!0:t.overlaps,this.tileClass=t.tileClass?t.tileClass:Il,this.tileGrids_={}}getOverlaps(){return this.overlaps_}clear(){this.sourceTileCache_.clear()}expireCache(t,e){const i=this.getTileCacheForProjection(t),n=Object.keys(e).reduce((r,o)=>{const a=Qo(o),l=i.peek(a);if(l){const c=l.sourceTiles;for(let h=0,d=c.length;h<d;++h)r[c[h].getKey()]=!0}return r},{});super.expireCache(t,e),this.sourceTileCache_.expireCache(n)}getSourceTiles(t,e,i){if(i.getState()===V.IDLE){i.setState(V.LOADING);const n=i.wrappedTileCoord,r=this.getTileGridForProjection(e),o=r.getTileCoordExtent(n),a=n[0],l=r.getResolution(a);Ct(o,-l,o);const c=this.tileGrid,h=c.getExtent();h&&qs(o,h,o);const d=c.getZForResolution(l,this.zDirection);c.forEachTileCoord(o,d,u=>{const A=this.tileUrlFunction(u,t,e),f=this.sourceTileCache_.containsKey(A)?this.sourceTileCache_.get(A):new this.tileClass(u,A?V.IDLE:V.EMPTY,A,this.format_,this.tileLoadFunction);i.sourceTiles.push(f);const g=f.getState();if(g<V.LOADED){const p=y=>{this.handleTileChange(y);const m=f.getState();if(m===V.LOADED||m===V.ERROR){const C=f.getKey();C in i.errorTileKeys?f.getState()===V.LOADED&&delete i.errorTileKeys[C]:i.loadingSourceTiles--,m===V.ERROR?i.errorTileKeys[C]=!0:f.removeEventListener(Zt.CHANGE,p),i.loadingSourceTiles===0&&i.setState(he(i.errorTileKeys)?V.LOADED:V.ERROR)}};f.addEventListener(Zt.CHANGE,p),i.loadingSourceTiles++}g===V.IDLE&&(f.extent=c.getTileCoordExtent(u),f.projection=e,f.resolution=c.getResolution(u[0]),this.sourceTileCache_.set(A,f),f.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(u=>u.getState()===V.ERROR)?V.ERROR:V.LOADED)}return i.sourceTiles}getTile(t,e,i,n,r){const o=[t,e,i];let a=this.getTileCoordForTileUrlFunction(o,r);const l=this.getTileGrid().getExtent(),c=this.getTileGridForProjection(r);if(a&&l){const u=c.getTileCoordExtent(a);Ct(u,-c.getResolution(t),u),st(l,u)||(a=null)}let h=!0;if(a!==null){const u=this.tileGrid,A=c.getResolution(t),f=u.getZForResolution(A,1),g=c.getTileCoordExtent(a);Ct(g,-A,g),u.forEachTileCoord(g,f,p=>{h=h&&!this.tileUrlFunction(p,n,r)})}const d=new bl(o,h?V.EMPTY:V.IDLE,a,this.getSourceTiles.bind(this,n,r));return d.key=this.getKey(),d}getTileGridForProjection(t){const e=t.getCode();let i=this.tileGrids_[e];if(!i){const n=this.tileGrid,r=n.getResolutions().slice(),o=r.map(function(c,h){return n.getOrigin(h)}),a=r.map(function(c,h){return n.getTileSize(h)}),l=jo+1;for(let c=r.length;c<l;++c)r.push(r[c-1]/2),o.push(o[c-1]),a.push(a[c-1]);i=new Vo({extent:n.getExtent(),origins:o,resolutions:r,tileSizes:a}),this.tileGrids_[e]=i}return i}getTilePixelRatio(t){return t}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=An(n.getTileSize(t),this.tmpSize);return[Math.round(r[0]*e),Math.round(r[1]*e)]}}function Ll(s,t){s.setLoader(function(e,i,n){pr(t,s.getFormat(),e,i,n,s.onLoad.bind(s),s.onError.bind(s))})}class Dl extends Wo{constructor(t){t=t||{},super({projection:t.projection,tileGrid:t.tileGrid,wrapX:t.wrapX!==void 0?t.wrapX:!0,zDirection:t.zDirection,url:t.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(e,i)=>{const n=e.getTileCoord()[0],r=An(this.tileGrid.getTileSize(n)),o=ue(r[0],r[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,r[0]+.5,r[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,r[0]/2,r[1]/2,r[0]),o.fillText(i,r[0]/2,r[1]/2,r[0]),e.setImage(o.canvas)}})}}class Bl extends Ko{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=Ht(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,n){const r=pt(i),o=this.getProjection()||r;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=Xo(t,r,o),c=zo(o,r,t,e),h=a.getZForResolution(c,this.zDirection),d=a.getResolution(h),u=a.getTileCoordForCoordAndZ(l,h);if(a.getResolutions().length<=u[0])return;let A=a.getTileCoordExtent(u,this.tmpExtent_);const f=this.gutter_;f!==0&&(A=Ct(A,d*f,A));const g={QUERY_LAYERS:this.params_.LAYERS};Object.assign(g,ps(this.params_,"GetFeatureInfo"),n);const p=Math.floor((l[0]-A[0])/d),y=Math.floor((A[3]-l[1])/d);return g[this.v13_?"I":"X"]=p,g[this.v13_?"J":"Y"]=y,this.getRequestUrl_(u,A,1,o||r,g)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:Hi,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const n=this.params_.LAYERS;if(!(!Array.isArray(n)||n.length===1))return;i.LAYER=n}if(t!==void 0){const n=this.getProjection()?this.getProjection().getMetersPerUnit():1,r=28e-5;i.SCALE=t*n/r}return Object.assign(i,e),Js(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,n,r){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=Jo(Zo(t),o.length);a=o[l]}return Tl(e,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(t[0]),i,n,a,r,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||Hi;this.v13_=ur(t,"1.3")>=0}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const r=n.getResolution(t[0]);let o=n.getTileCoordExtent(t,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=Ct(o,r*a,o));const l=Object.assign({},ps(this.params_,"GetMap"));return this.getRequestUrl_(t,o,e,i,l)}}const B={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},Ye=[B.FILL],Nt=[B.STROKE],zt=[B.BEGIN_PATH],ys=[B.CLOSE_PATH];class yr{drawCustom(t,e,i,n,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class Oe extends yr{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=t.length;a<l;a+=e)n[0]=t[a],n[1]=t[a+1],Ji(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,r,o){const a=this.coordinates;let l=a.length;const c=this.getBufferedMaxExtent();o&&(e+=n);let h=t[e],d=t[e+1];const u=this.tmpCoordinate_;let A=!0,f,g,p;for(f=e+n;f<i;f+=n)u[0]=t[f],u[1]=t[f+1],p=Ho(c,u),p!==g?(A&&(a[l++]=h,a[l++]=d,A=!1),a[l++]=u[0],a[l++]=u[1]):p===qo.INTERSECTING?(a[l++]=u[0],a[l++]=u[1],A=!1):A=!0,h=u[0],d=u[1],g=p;return(r&&A||f===e+n)&&(a[l++]=h,a[l++]=d),l}drawCustomCoordinates_(t,e,i,n,r){for(let o=0,a=i.length;o<a;++o){const l=i[o],c=this.appendFlatLineCoordinates(t,e,l,n,!1,!1);r.push(c),e=l}return e}drawCustom(t,e,i,n,r){this.beginGeometry(t,e,r);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let c,h,d,u,A;switch(o){case"MultiPolygon":c=t.getOrientedFlatCoordinates(),u=[];const f=t.getEndss();A=0;for(let g=0,p=f.length;g<p;++g){const y=[];A=this.drawCustomCoordinates_(c,A,f[g],a,y),u.push(y)}this.instructions.push([B.CUSTOM,l,u,t,i,Xi,r]),this.hitDetectionInstructions.push([B.CUSTOM,l,u,t,n||i,Xi,r]);break;case"Polygon":case"MultiLineString":d=[],c=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),A=this.drawCustomCoordinates_(c,0,t.getEnds(),a,d),this.instructions.push([B.CUSTOM,l,d,t,i,Wi,r]),this.hitDetectionInstructions.push([B.CUSTOM,l,d,t,n||i,Wi,r]);break;case"LineString":case"Circle":c=t.getFlatCoordinates(),h=this.appendFlatLineCoordinates(c,0,c.length,a,!1,!1),this.instructions.push([B.CUSTOM,l,h,t,i,ne,r]),this.hitDetectionInstructions.push([B.CUSTOM,l,h,t,n||i,ne,r]);break;case"MultiPoint":c=t.getFlatCoordinates(),h=this.appendFlatPointCoordinates(c,a),h>l&&(this.instructions.push([B.CUSTOM,l,h,t,i,ne,r]),this.hitDetectionInstructions.push([B.CUSTOM,l,h,t,n||i,ne,r]));break;case"Point":c=t.getFlatCoordinates(),this.coordinates.push(c[0],c[1]),h=this.coordinates.length,this.instructions.push([B.CUSTOM,l,h,t,i,void 0,r]),this.hitDetectionInstructions.push([B.CUSTOM,l,h,t,n||i,void 0,r]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[B.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[B.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let n,r,o=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==B.END_GEOMETRY?o=e:r==B.BEGIN_GEOMETRY&&(n[2]=e,$o(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const n=t.getColor();i.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,i.fillStyle=Ut(n||ut)}else i.fillStyle=void 0;if(e){const n=e.getColor();i.strokeStyle=Ut(n||$e);const r=e.getLineCap();i.lineCap=r!==void 0?r:ti;const o=e.getLineDash();i.lineDash=o?o.slice():Dt;const a=e.getLineDashOffset();i.lineDashOffset=a||Bt;const l=e.getLineJoin();i.lineJoin=l!==void 0?l:ei;const c=e.getWidth();i.lineWidth=c!==void 0?c:ii;const h=e.getMiterLimit();i.miterLimit=h!==void 0?h:ni,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[B.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[B.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,c=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!pi(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=c)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=c)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[B.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=ta(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;Ct(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class kl extends Oe{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!Ji(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,r);this.instructions.push([B.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([B.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=[];for(let l=0,c=n.length;l<c;l+=t.getStride())(!this.maxExtent||Ji(this.maxExtent,n.slice(l,l+2)))&&r.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,2);this.instructions.push([B.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([B.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class Ol extends Oe{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),a=[B.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([B.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Dt,Bt],zt);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Nt),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([B.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Dt,Bt],zt);const a=t.getEnds(),l=t.getFlatCoordinates(),c=t.getStride();let h=0;for(let d=0,u=a.length;d<u;++d)h=this.drawFlatCoordinates_(l,h,a[d],c);this.hitDetectionInstructions.push(Nt),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Nt),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Nt),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push(zt)}}class Cs extends Oe{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=i.length;this.instructions.push(zt),this.hitDetectionInstructions.push(zt);for(let c=0;c<l;++c){const h=i[c],d=this.coordinates.length,u=this.appendFlatLineCoordinates(t,e,h,n,!0,!a),A=[B.MOVE_TO_LINE_TO,d,u];this.instructions.push(A),this.hitDetectionInstructions.push(A),a&&(this.instructions.push(ys),this.hitDetectionInstructions.push(ys)),e=h}return o&&(this.instructions.push(Ye),this.hitDetectionInstructions.push(Ye)),a&&(this.instructions.push(Nt),this.hitDetectionInstructions.push(Nt)),e}drawCircle(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([B.SET_FILL_STYLE,ut]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([B.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Dt,Bt]);const a=t.getFlatCoordinates(),l=t.getStride(),c=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const h=[B.CIRCLE,c];this.instructions.push(zt,h),this.hitDetectionInstructions.push(zt,h),n.fillStyle!==void 0&&(this.instructions.push(Ye),this.hitDetectionInstructions.push(Ye)),n.strokeStyle!==void 0&&(this.instructions.push(Nt),this.hitDetectionInstructions.push(Nt)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([B.SET_FILL_STYLE,ut]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([B.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Dt,Bt]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),c=t.getStride();this.drawFlatCoordinatess_(l,0,a,c),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([B.SET_FILL_STYLE,ut]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([B.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,Dt,Bt]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),c=t.getStride();let h=0;for(let d=0,u=a.length;d<u;++d)h=this.drawFlatCoordinatess_(l,h,a[d],c);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=ea(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function Pl(s,t,e,i,n){const r=[];let o=e,a=0,l=t.slice(e,2);for(;a<s&&o+n<i;){const[c,h]=l.slice(-2),d=t[o+n],u=t[o+n+1],A=Math.sqrt((d-c)*(d-c)+(u-h)*(u-h));if(a+=A,a>=s){const f=(s-a+A)/A,g=dt(c,d,f),p=dt(h,u,f);l.push(g,p),r.push(l),l=[g,p],a==s&&(o+=n),a=0}else if(a<s)l.push(t[o+n],t[o+n+1]),o+=n;else{const f=A-a,g=dt(c,d,f/A),p=dt(h,u,f/A);l.push(g,p),r.push(l),l=[g,p],a=0,o+=n}}return a>0&&r.push(l),r}function Gl(s,t,e,i,n){let r=e,o=e,a=0,l=0,c=e,h,d,u,A,f,g,p,y,m,C;for(d=e;d<i;d+=n){const x=t[d],_=t[d+1];f!==void 0&&(m=x-f,C=_-g,A=Math.sqrt(m*m+C*C),p!==void 0&&(l+=u,h=Math.acos((p*m+y*C)/(u*A)),h>s&&(l>a&&(a=l,r=c,o=d),l=0,c=d-n)),u=A,p=m,y=C),f=x,g=_}return l+=A,l>a?[c,d]:[r,o]}const li={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class Ml extends Oe{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ut]={fillStyle:ut},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!r)return;const a=this.coordinates;let l=a.length;const c=t.getType();let h=null,d=t.getStride();if(o.placement==="line"&&(c=="LineString"||c=="MultiLineString"||c=="Polygon"||c=="MultiPolygon")){if(!st(this.maxExtent,t.getExtent()))return;let u;if(h=t.getFlatCoordinates(),c=="LineString")u=[h.length];else if(c=="MultiLineString")u=t.getEnds();else if(c=="Polygon")u=t.getEnds().slice(0,1);else if(c=="MultiPolygon"){const p=t.getEndss();u=[];for(let y=0,m=p.length;y<m;++y)u.push(p[y][0])}this.beginGeometry(t,e,i);const A=o.repeat,f=A?void 0:o.textAlign;let g=0;for(let p=0,y=u.length;p<y;++p){let m;A?m=Pl(A*this.resolution,h,g,u[p],d):m=[h.slice(g,u[p])];for(let C=0,x=m.length;C<x;++C){const _=m[C];let w=0,R=_.length;if(f==null){const T=Gl(o.maxAngle,_,0,_.length,2);w=T[0],R=T[1]}for(let T=w;T<R;T+=d)a.push(_[T],_[T+1]);const I=a.length;g=u[p],this.drawChars_(l,I),l=I}}this.endGeometry(e)}else{let u=o.overflow?null:[];switch(c){case"Point":case"MultiPoint":h=t.getFlatCoordinates();break;case"LineString":h=t.getFlatMidpoint();break;case"Circle":h=t.getCenter();break;case"MultiLineString":h=t.getFlatMidpoints(),d=2;break;case"Polygon":h=t.getFlatInteriorPoint(),o.overflow||u.push(h[2]/this.resolution),d=3;break;case"MultiPolygon":const m=t.getFlatInteriorPoints();h=[];for(let C=0,x=m.length;C<x;C+=3)o.overflow||u.push(m[C+2]/this.resolution),h.push(m[C],m[C+1]);if(h.length===0)return;d=2;break}const A=this.appendFlatPointCoordinates(h,d);if(A===l)return;if(u&&(A-l)/2!==h.length/d){let m=l/2;u=u.filter((C,x)=>{const _=a[(m+x)*2]===h[x*d]&&a[(m+x)*2+1]===h[x*d+1];return _||--m,_})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);let f=o.padding;if(f!=Xt&&(o.scale[0]<0||o.scale[1]<0)){let m=o.padding[0],C=o.padding[1],x=o.padding[2],_=o.padding[3];o.scale[0]<0&&(C=-C,_=-_),o.scale[1]<0&&(m=-m,x=-x),f=[m,C,x,_]}const g=this.pixelRatio;this.instructions.push([B.DRAW_IMAGE,l,A,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,f==Xt?Xt:f.map(function(m){return m*g}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,u]);const p=1/g,y=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=ut,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([B.DRAW_IMAGE,l,A,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[p,p],NaN,this.declutterMode_,this.declutterImageWithText_,f,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ut:this.fillKey_,this.textOffsetX_,this.textOffsetY_,u]),o.backgroundFill&&(this.state.fillStyle=y,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||Te,justify:e.justify,textBaseline:e.textBaseline||si,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,c=li[n.textBaseline],h=this.textOffsetY_*l,d=this.text_,u=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([B.DRAW_CHARS,t,e,c,n.overflow,a,n.maxAngle,l,h,r,u*l,d,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([B.DRAW_CHARS,t,e,c,n.overflow,a&&ut,n.maxAngle,l,h,r,u*l,d,o,1/l,this.declutterMode_])}setTextStyle(t,e){let i,n,r;if(!t)this.text_="";else{const o=t.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=Ut(o.getColor()||ut)):(n=null,this.textFillState_=n);const a=t.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const f=a.getLineDash(),g=a.getLineDashOffset(),p=a.getWidth(),y=a.getMiterLimit();r.lineCap=a.getLineCap()||ti,r.lineDash=f?f.slice():Dt,r.lineDashOffset=g===void 0?Bt:g,r.lineJoin=a.getLineJoin()||ei,r.lineWidth=p===void 0?ii:p,r.miterLimit=y===void 0?ni:y,r.strokeStyle=Ut(a.getColor()||$e)}i=this.textState_;const l=t.getFont()||$s;ia(l);const c=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||si,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Xt,i.scale=c===void 0?[1,1]:c;const h=t.getOffsetX(),d=t.getOffsetY(),u=t.getRotateWithView(),A=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=h===void 0?0:h,this.textOffsetY_=d===void 0?0:d,this.textRotateWithView_=u===void 0?!1:u,this.textRotation_=A===void 0?0:A,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:N(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+N(n.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const Ul={Circle:Cs,Default:Oe,Image:kl,LineString:Ol,Polygon:Cs,Text:Ml};class Cr{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];if(r===void 0){const o=Ul[e];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r}return r}}function Nl(s,t,e,i,n,r,o,a,l,c,h,d){let u=s[t],A=s[t+1],f=0,g=0,p=0,y=0;function m(){f=u,g=A,t+=i,u=s[t],A=s[t+1],y+=p,p=Math.sqrt((u-f)*(u-f)+(A-g)*(A-g))}do m();while(t<e-i&&y+p<r);let C=p===0?0:(r-y)/p;const x=dt(f,u,C),_=dt(g,A,C),w=t-i,R=y,I=r+a*l(c,n,h);for(;t<e-i&&y+p<I;)m();C=p===0?0:(I-y)/p;const T=dt(f,u,C),U=dt(g,A,C);let D;if(d){const F=[x,_,T,U];na(F,0,4,2,d,F,F),D=F[0]>F[2]}else D=x>T;const E=Math.PI,L=[],b=w+i===t;t=w,p=0,y=R,u=s[t],A=s[t+1];let k;if(b){m(),k=Math.atan2(A-g,u-f),D&&(k+=k>0?-E:E);const F=(T+x)/2,v=(U+_)/2;return L[0]=[F,v,(I-r)/2,k,n],L}n=n.replace(/\n/g," ");for(let F=0,v=n.length;F<v;){m();let P=Math.atan2(A-g,u-f);if(D&&(P+=P>0?-E:E),k!==void 0){let S=P-k;if(S+=S>E?-2*E:S<-E?2*E:0,Math.abs(S)>o)return null}k=P;const J=F;let Q=0;for(;F<v;++F){const S=D?v-F-1:F,Ci=a*l(c,n[S],h);if(t+i<e&&y+p<r+Q+Ci/2)break;Q+=Ci}if(F===J)continue;const K=D?n.substring(v-J,v-F):n.substring(J,F);C=p===0?0:(r+Q/2-y)/p;const q=dt(f,u,C),At=dt(g,A,C);L.push([q,At,Q/2,P,K]),r+=Q}return L}const $t=Ht(),Pt=[],It=[],bt=[],Gt=[];function _s(s){return s[3].declutterBox}const Es=new RegExp("[֑-ࣿיִ-﷿ﹰ-ﻼࠀ-࿿-]");function ki(s,t){return t==="start"?t=Es.test(s)?"right":"left":t==="end"&&(t=Es.test(s)?"left":"right"),li[t]}function Yl(s,t,e){return e>0&&s.push(`
`,""),s.push(t,""),s}class Ql{constructor(t,e,i,n,r){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=de(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new tr:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],c=this.pixelRatio,h=[l.scale[0]*c,l.scale[1]*c],d=l.justify?li[l.justify]:ki(Array.isArray(t)?t[0]:t,l.textAlign||Te),u=n&&o.lineWidth?o.lineWidth:0,A=Array.isArray(t)?t:String(t).split(`
`).reduce(Yl,[]),{width:f,height:g,widths:p,heights:y,lineWidths:m}=sa(l,A),C=f+u,x=[],_=(C+2)*h[0],w=(g+u)*h[1],R={width:_<0?Math.floor(_):Math.ceil(_),height:w<0?Math.floor(w):Math.ceil(w),contextInstructions:x};(h[0]!=1||h[1]!=1)&&x.push("scale",h),n&&(x.push("strokeStyle",o.strokeStyle),x.push("lineWidth",u),x.push("lineCap",o.lineCap),x.push("lineJoin",o.lineJoin),x.push("miterLimit",o.miterLimit),x.push("setLineDash",[o.lineDash]),x.push("lineDashOffset",o.lineDashOffset)),i&&x.push("fillStyle",a.fillStyle),x.push("textBaseline","middle"),x.push("textAlign","center");const I=.5-d;let T=d*C+I*u;const U=[],D=[];let E=0,L=0,b=0,k=0,F;for(let v=0,P=A.length;v<P;v+=2){const J=A[v];if(J===`
`){L+=E,E=0,T=d*C+I*u,++k;continue}const Q=A[v+1]||l.font;Q!==F&&(n&&U.push("font",Q),i&&D.push("font",Q),F=Q),E=Math.max(E,y[b]);const K=[J,T+I*p[b]+d*(p[b]-m[k]),.5*(u+E)+L];T+=p[b],n&&U.push("strokeText",K),i&&D.push("fillText",K),++b}return Array.prototype.push.apply(x,U),Array.prototype.push.apply(x,D),this.labels_[r]=R,R}replayTextBackground_(t,e,i,n,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,o,a,l,c,h,d,u,A,f,g,p){a*=u[0],l*=u[1];let y=i-a,m=n-l;const C=r+c>t?t-c:r,x=o+h>e?e-h:o,_=f[3]+C*u[0]+f[1],w=f[0]+x*u[1]+f[2],R=y-f[3],I=m-f[0];(g||d!==0)&&(Pt[0]=R,Gt[0]=R,Pt[1]=I,It[1]=I,It[0]=R+_,bt[0]=It[0],bt[1]=I+w,Gt[1]=bt[1]);let T;return d!==0?(T=mi(de(),i,n,1,1,d,-i,-n),ie(T,Pt),ie(T,It),ie(T,bt),ie(T,Gt),ji(Math.min(Pt[0],It[0],bt[0],Gt[0]),Math.min(Pt[1],It[1],bt[1],Gt[1]),Math.max(Pt[0],It[0],bt[0],Gt[0]),Math.max(Pt[1],It[1],bt[1],Gt[1]),$t)):ji(Math.min(R,R+_),Math.min(I,I+w),Math.max(R,R+_),Math.max(I,I+w),$t),A&&(y=Math.round(y),m=Math.round(m)),{drawImageX:y,drawImageY:m,drawImageW:C,drawImageH:x,originX:c,originY:h,declutterBox:{minX:$t[0],minY:$t[1],maxX:$t[2],maxY:$t[3],value:p},canvasTransform:T,scale:u}}replayImageOrLabel_(t,e,i,n,r,o,a){const l=!!(o||a),c=n.declutterBox,h=a?a[2]*n.scale[0]/2:0;return c.minX-h<=e[0]&&c.maxX+h>=0&&c.minY-h<=e[1]&&c.maxY+h>=0&&(l&&this.replayTextBackground_(t,Pt,It,bt,Gt,o,a),ra(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=ie(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],o=this.createLabel(t,e,n,i),a=this.strokeStates[i],l=this.pixelRatio,c=ki(Array.isArray(t)?t[0]:t,r.textAlign||Te),h=li[r.textBaseline||si],d=a&&a.lineWidth?a.lineWidth:0,u=o.width/l-2*r.scale[0],A=c*u+2*(.5-c)*d,f=h*o.height/l+2*(.5-h)*d;return{label:o,anchorX:A,anchorY:f}}execute_(t,e,i,n,r,o,a,l){const c=this.zIndexContext_;let h;this.pixelCoordinates_&&pi(i,this.renderedTransform_)?h=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),h=ce(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),oa(this.renderedTransform_,i));let d=0;const u=n.length;let A=0,f,g,p,y,m,C,x,_,w,R,I,T,U,D=0,E=0,L=null,b=null;const k=this.coordinateCache_,F=this.viewRotation_,v=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,P={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:F},J=this.instructions!=n||this.overlaps?0:200;let Q,K,q,At;for(;d<u;){const S=n[d];switch(S[0]){case B.BEGIN_GEOMETRY:Q=S[1],At=S[3],Q.getGeometry()?a!==void 0&&!st(a,At.getExtent())?d=S[2]+1:++d:d=S[2],c&&(c.zIndex=S[4]);break;case B.BEGIN_PATH:D>J&&(this.fill_(t),D=0),E>J&&(t.stroke(),E=0),!D&&!E&&(t.beginPath(),m=NaN,C=NaN),++d;break;case B.CIRCLE:A=S[1];const _i=h[A],Ei=h[A+1],jr=h[A+2],Wr=h[A+3],Rn=jr-_i,Fn=Wr-Ei,Tn=Math.sqrt(Rn*Rn+Fn*Fn);t.moveTo(_i+Tn,Ei),t.arc(_i,Ei,Tn,0,2*Math.PI,!0),++d;break;case B.CLOSE_PATH:t.closePath(),++d;break;case B.CUSTOM:A=S[1],f=S[2];const Kr=S[3],Xr=S[4],In=S[5];P.geometry=Kr,P.feature=Q,d in k||(k[d]=[]);const ge=k[d];In?In(h,A,f,2,ge):(ge[0]=h[A],ge[1]=h[A+1],ge.length=2),c&&(c.zIndex=S[6]),Xr(ge,P),++d;break;case B.DRAW_IMAGE:A=S[1],f=S[2],w=S[3],g=S[4],p=S[5];let wi=S[6];const zr=S[7],Jr=S[8],Zr=S[9],bn=S[10];let Si=S[11];const Hr=S[12];let Ge=S[13];y=S[14]||"declutter";const me=S[15];if(!w&&S.length>=20){R=S[19],I=S[20],T=S[21],U=S[22];const at=this.drawLabelWithPointPlacement_(R,I,T,U);w=at.label,S[3]=w;const Kt=S[23];g=(at.anchorX-Kt)*this.pixelRatio,S[4]=g;const lt=S[24];p=(at.anchorY-lt)*this.pixelRatio,S[5]=p,wi=w.height,S[6]=wi,Ge=w.width,S[13]=Ge}let Ri;S.length>25&&(Ri=S[25]);let Fi,Me,Ue;S.length>17?(Fi=S[16],Me=S[17],Ue=S[18]):(Fi=Xt,Me=!1,Ue=!1),bn&&v?Si+=F:!bn&&!v&&(Si-=F);let qr=0;for(;A<f;A+=2){if(Ri&&Ri[qr++]<Ge/this.pixelRatio)continue;const at=this.calculateImageOrLabelDimensions_(w.width,w.height,h[A],h[A+1],Ge,wi,g,p,Jr,Zr,Si,Hr,r,Fi,Me||Ue,Q),Kt=[t,e,w,at,zr,Me?L:null,Ue?b:null];if(l){let lt,_t,ct;if(me){const X=f-A;if(!me[X]){me[X]={args:Kt,declutterMode:y};continue}const tt=me[X];lt=tt.args,_t=tt.declutterMode,delete me[X],ct=_s(lt)}let Rt,Ft;if(lt&&(_t!=="declutter"||!l.collides(ct))&&(Rt=!0),(y!=="declutter"||!l.collides(at.declutterBox))&&(Ft=!0),_t==="declutter"&&y==="declutter"){const X=Rt&&Ft;Rt=X,Ft=X}Rt&&(_t!=="none"&&l.insert(ct),this.replayImageOrLabel_.apply(this,lt)),Ft&&(y!=="none"&&l.insert(at.declutterBox),this.replayImageOrLabel_.apply(this,Kt))}else this.replayImageOrLabel_.apply(this,Kt)}++d;break;case B.DRAW_CHARS:const vn=S[1],Ln=S[2],Ti=S[3],$r=S[4];U=S[5];const to=S[6],Dn=S[7],Bn=S[8];T=S[9];const Ii=S[10];R=S[11],I=S[12];const kn=[S[13],S[13]];y=S[14]||"declutter";const bi=this.textStates[I],pe=bi.font,xe=[bi.scale[0]*Dn,bi.scale[1]*Dn];let ye;pe in this.widths_?ye=this.widths_[pe]:(ye={},this.widths_[pe]=ye);const On=fr(h,vn,Ln,2),Pn=Math.abs(xe[0])*Wn(pe,R,ye);if($r||Pn<=On){const at=this.textStates[I].textAlign,Kt=(On-Pn)*ki(R,at),lt=Nl(h,vn,Ln,2,R,Kt,to,Math.abs(xe[0]),Wn,pe,ye,v?0:this.viewRotation_);t:if(lt){const _t=[];let ct,Rt,Ft,X,tt;if(T)for(ct=0,Rt=lt.length;ct<Rt;++ct){tt=lt[ct],Ft=tt[4],X=this.createLabel(Ft,I,"",T),g=tt[2]+(xe[0]<0?-Ii:Ii),p=Ti*X.height+(.5-Ti)*2*Ii*xe[1]/xe[0]-Bn;const Tt=this.calculateImageOrLabelDimensions_(X.width,X.height,tt[0],tt[1],X.width,X.height,g,p,0,0,tt[3],kn,!1,Xt,!1,Q);if(l&&y==="declutter"&&l.collides(Tt.declutterBox))break t;_t.push([t,e,X,Tt,1,null,null])}if(U)for(ct=0,Rt=lt.length;ct<Rt;++ct){tt=lt[ct],Ft=tt[4],X=this.createLabel(Ft,I,U,""),g=tt[2],p=Ti*X.height-Bn;const Tt=this.calculateImageOrLabelDimensions_(X.width,X.height,tt[0],tt[1],X.width,X.height,g,p,0,0,tt[3],kn,!1,Xt,!1,Q);if(l&&y==="declutter"&&l.collides(Tt.declutterBox))break t;_t.push([t,e,X,Tt,1,null,null])}l&&y!=="none"&&l.load(_t.map(_s));for(let Tt=0,eo=_t.length;Tt<eo;++Tt)this.replayImageOrLabel_.apply(this,_t[Tt])}}++d;break;case B.END_GEOMETRY:if(o!==void 0){Q=S[1];const at=o(Q,At,y);if(at)return at}++d;break;case B.FILL:J?D++:this.fill_(t),++d;break;case B.MOVE_TO_LINE_TO:for(A=S[1],f=S[2],K=h[A],q=h[A+1],t.moveTo(K,q),m=K+.5|0,C=q+.5|0,A+=2;A<f;A+=2)K=h[A],q=h[A+1],x=K+.5|0,_=q+.5|0,(A==f-2||x!==m||_!==C)&&(t.lineTo(K,q),m=x,C=_);++d;break;case B.SET_FILL_STYLE:L=S,this.alignAndScaleFill_=S[2],D&&(this.fill_(t),D=0,E&&(t.stroke(),E=0)),t.fillStyle=S[1],++d;break;case B.SET_STROKE_STYLE:b=S,E&&(t.stroke(),E=0),this.setStrokeStyle_(t,S),++d;break;case B.STROKE:J?E++:t.stroke(),++d;break;default:++d;break}}D&&this.fill_(t),E&&t.stroke()}execute(t,e,i,n,r,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,r)}}const oe=["Polygon","Circle","LineString","Image","Text","Default"],ci=["Image","Text"],Vl=oe.filter(s=>!ci.includes(s));class _r{constructor(t,e,i,n,r,o,a){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=de(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const r=t[i];for(const o in r){const a=r[o];n[o]=new Ql(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let n=0,r=t.length;n<r;++n)if(t[n]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,o){n=Math.round(n);const a=n*2+1,l=mi(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),c=!this.hitDetectionContext_;c&&(this.hitDetectionContext_=ue(a,a,void 0,{willReadFrequently:!0}));const h=this.hitDetectionContext_;h.canvas.width!==a||h.canvas.height!==a?(h.canvas.width=a,h.canvas.height=a):c||h.clearRect(0,0,a,a);let d;this.renderBuffer_!==void 0&&(d=Ht(),aa(d,t),Ct(d,e*(this.renderBuffer_+n),d));const u=jl(n);let A;function f(_,w,R){const I=h.getImageData(0,0,a,a).data;for(let T=0,U=u.length;T<U;T++)if(I[u[T]]>0){if(!o||R==="none"||A!=="Image"&&A!=="Text"||o.includes(_)){const D=(u[T]-3)/4,E=n-D%a,L=n-(D/a|0),b=r(_,w,E*E+L*L);if(b)return b}h.clearRect(0,0,a,a);break}}const g=Object.keys(this.executorsByZIndex_).map(Number);g.sort(_e);let p,y,m,C,x;for(p=g.length-1;p>=0;--p){const _=g[p].toString();for(m=this.executorsByZIndex_[_],y=oe.length-1;y>=0;--y)if(A=oe[y],C=m[A],C!==void 0&&(x=C.executeHitDetection(h,l,i,f,d),x))return x}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],o=e[3],a=[i,n,i,o,r,o,r,n];return ce(a,0,8,2,t,a),a}isEmpty(){return he(this.executorsByZIndex_)}execute(t,e,i,n,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(_e),o=o||oe;const c=oe.length;let h,d,u,A,f;for(a&&l.reverse(),h=0,d=l.length;h<d;++h){const g=l[h].toString();for(f=this.executorsByZIndex_[g],u=0,A=o.length;u<A;++u){const p=o[u],y=f[p];if(y!==void 0){const m=a===null?void 0:y.getZIndexContext(),C=m?m.getContext():t,x=this.maxExtent_&&p!=="Image"&&p!=="Text";if(x&&(C.save(),this.clip(C,i)),!m||p==="Text"||p==="Image"?y.execute(C,e,i,n,r,a):m.pushFunction(_=>y.execute(_,e,i,n,r,a)),x&&C.restore(),m){m.offset();const _=l[h]*c+u;this.deferredZIndexContexts_[_]||(this.deferredZIndexContexts_[_]=[]),this.deferredZIndexContexts_[_].push(m)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(_e);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),t[e[i]].length=0}}const Oi={};function jl(s){if(Oi[s]!==void 0)return Oi[s];const t=s*2+1,e=s*s,i=new Array(e+1);for(let r=0;r<=s;++r)for(let o=0;o<=s;++o){const a=r*r+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((s+r)*t+(s+o))*4+3),r>0&&l.push(((s-r)*t+(s+o))*4+3),o>0&&(l.push(((s+r)*t+(s-o))*4+3),r>0&&l.push(((s-r)*t+(s-o))*4+3))}const n=[];for(let r=0,o=i.length;r<o;++r)i[r]&&n.push(...i[r]);return Oi[s]=n,n}class Wl extends yr{constructor(t,e,i,n,r,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?la(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=de()}drawImages_(t,e,i,n){if(!this.image_)return;const r=ce(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let c=this.imageRotation_;this.transformRotation_===0&&(c-=this.viewRotation_),this.imageRotateWithView_&&(c+=this.viewRotation_);for(let h=0,d=r.length;h<d;h+=2){const u=r[h]-this.imageAnchorX_,A=r[h+1]-this.imageAnchorY_;if(c!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const f=u+this.imageAnchorX_,g=A+this.imageAnchorY_;mi(a,f,g,1,1,c,-f,-g),o.save(),o.transform.apply(o,a),o.translate(f,g),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,u,A,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=ce(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const l=r[e]+this.textOffsetX_,c=r[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,c-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,c),this.textFillState_&&o.fillText(this.text_,l,c))}}moveToLineTo_(t,e,i,n,r){const o=this.context_,a=ce(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let c=2;c<l;c+=2)o.lineTo(a[c],a[c+1]);return r&&o.closePath(),i}drawRings_(t,e,i,n){for(let r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!st(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=ca(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!st(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(st(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=t.getFlatCoordinates();let r=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,c=o.length;l<c;++l)r=this.moveToLineTo_(n,r,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!st(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!st(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=r.length;a<l;++a){const c=r[a];n=this.drawRings_(i,n,c,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),pi(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:Te;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:Ut(i||ut)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),n=e.getLineCap(),r=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),c=e.getMiterLimit(),h=r||Dt;this.strokeState_={lineCap:n!==void 0?n:ti,lineDash:this.pixelRatio_===1?h:h.map(d=>d*this.pixelRatio_),lineDashOffset:(o||Bt)*this.pixelRatio_,lineJoin:a!==void 0?a:ei,lineWidth:(l!==void 0?l:ii)*this.pixelRatio_,miterLimit:c!==void 0?c:ni,strokeStyle:Ut(i||$e)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const A=e.getColor();this.textFillState_={fillStyle:Ut(A||ut)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const A=i.getColor(),f=i.getLineCap(),g=i.getLineDash(),p=i.getLineDashOffset(),y=i.getLineJoin(),m=i.getWidth(),C=i.getMiterLimit();this.textStrokeState_={lineCap:f!==void 0?f:ti,lineDash:g||Dt,lineDashOffset:p||Bt,lineJoin:y!==void 0?y:ei,lineWidth:m!==void 0?m:ii,miterLimit:C!==void 0?C:ni,strokeStyle:Ut(A||$e)}}const n=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),c=t.getScaleArray(),h=t.getText(),d=t.getTextAlign(),u=t.getTextBaseline();this.textState_={font:n!==void 0?n:$s,textAlign:d!==void 0?d:Te,textBaseline:u!==void 0?u:si},this.text_=h!==void 0?Array.isArray(h)?h.reduce((A,f,g)=>A+=g%2?" ":f,""):h:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*c[0],this.pixelRatio_*c[1]]}}}const rt=.5;function Er(s,t,e,i,n,r,o,a,l){const c=l?er(n):n,h=s[0]*rt,d=s[1]*rt,u=ue(h,d);u.imageSmoothingEnabled=!1;const A=u.canvas,f=new Wl(u,rt,n,null,o,a,l?ha(da(),l):null),g=e.length,p=Math.floor((256*256*256-1)/g),y={};for(let C=1;C<=g;++C){const x=e[C-1],_=x.getStyleFunction()||i;if(!_)continue;let w=_(x,r);if(!w)continue;Array.isArray(w)||(w=[w]);const I=(C*p).toString(16).padStart(7,"#00000");for(let T=0,U=w.length;T<U;++T){const D=w[T],E=D.getGeometryFunction()(x);if(!E||!st(c,E.getExtent()))continue;const L=D.clone(),b=L.getFill();b&&b.setColor(I);const k=L.getStroke();k&&(k.setColor(I),k.setLineDash(null)),L.setText(void 0);const F=D.getImage();if(F){const Q=F.getImageSize();if(!Q)continue;const K=ue(Q[0],Q[1],void 0,{alpha:!1}),q=K.canvas;K.fillStyle=I,K.fillRect(0,0,q.width,q.height),L.setImage(new Ae({img:q,anchor:F.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:F.getOrigin(),opacity:1,size:F.getSize(),scale:F.getScale(),rotation:F.getRotation(),rotateWithView:F.getRotateWithView()}))}const v=L.getZIndex()||0;let P=y[v];P||(P={},y[v]=P,P.Polygon=[],P.Circle=[],P.LineString=[],P.Point=[]);const J=E.getType();if(J==="GeometryCollection"){const Q=E.getGeometriesArrayRecursive();for(let K=0,q=Q.length;K<q;++K){const At=Q[K];P[At.getType().replace("Multi","")].push(At,L)}}else P[J.replace("Multi","")].push(E,L)}}const m=Object.keys(y).map(Number).sort(_e);for(let C=0,x=m.length;C<x;++C){const _=y[m[C]];for(const w in _){const R=_[w];for(let I=0,T=R.length;I<T;I+=2){f.setStyle(R[I+1]);for(let U=0,D=t.length;U<D;++U)f.setTransform(t[U]),f.drawGeometry(R[I])}}}return u.getImageData(0,0,A.width,A.height)}function wr(s,t,e){const i=[];if(e){const n=Math.floor(Math.round(s[0])*rt),r=Math.floor(Math.round(s[1])*rt),o=(Kn(n,0,e.width-1)+Kn(r,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],h=e.data[o+2]+256*(l+256*a),d=Math.floor((256*256*256-1)/t.length);h&&h%d===0&&i.push(t[h/d-1])}return i}const Kl=.5,Sr={Point:tc,LineString:Hl,Polygon:ic,MultiPoint:ec,MultiLineString:ql,MultiPolygon:$l,GeometryCollection:Zl,Circle:zl};function Xl(s,t){return parseInt(N(s),10)-parseInt(N(t),10)}function qi(s,t){const e=Rr(s,t);return e*e}function Rr(s,t){return Kl*s/t}function zl(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const l=s.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(r,o),l.drawCircle(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function hi(s,t,e,i,n,r,o,a){const l=[],c=e.getImage();if(c){let u=!0;const A=c.getImageState();A==Ee.LOADED||A==Ee.ERROR?u=!1:A==Ee.IDLE&&c.load(),u&&l.push(c.ready())}const h=e.getFill();h&&h.loading()&&l.push(h.ready());const d=l.length>0;return d&&Promise.all(l).then(()=>n(null)),Jl(s,t,e,i,r,o,a),d}function Jl(s,t,e,i,n,r,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,n);if(e.getRenderer())Fr(s,l,e,t,o);else{const h=Sr[l.getType()];h(s,l,e,t,o,r)}}function Fr(s,t,e,i,n){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)Fr(s,o[a],e,i,n);return}s.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),n)}function Zl(s,t,e,i,n,r){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const c=Sr[o[a].getType()];c(s,o[a],e,i,n,r)}}function Hl(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=s.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function ql(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=s.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function $l(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(o||r){const l=s.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawMultiPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}function tc(s,t,e,i,n,r){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),c=r&&o&&l?{}:void 0;if(o){if(o.getImageState()!=Ee.LOADED)return;const h=s.getBuilder(e.getZIndex(),"Image");h.setImageStyle(o,c),h.drawPoint(t,i,n)}if(l){const h=s.getBuilder(e.getZIndex(),"Text");h.setTextStyle(a,c),h.drawText(t,i,n)}}function ec(s,t,e,i,n,r){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),c=l&&l.getText(),h=r&&a&&c?{}:void 0;if(a){if(o.getImageState()!=Ee.LOADED)return;const d=s.getBuilder(e.getZIndex(),"Image");d.setImageStyle(o,h),d.drawMultiPoint(t,i,n)}if(c){const d=s.getBuilder(e.getZIndex(),"Text");d.setTextStyle(l,h),d.drawText(t,i,n)}}function ic(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const l=s.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}class nc extends ua{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Ht(),this.wrappedRenderedExtent_=Ht(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,o=r.center,a=r.resolution,l=r.projection,c=r.rotation,h=l.getExtent(),d=this.getLayer().getSource(),u=this.getLayer().getDeclutter(),A=e.pixelRatio,f=e.viewHints,g=!(f[Et.ANIMATING]||f[Et.INTERACTING]),p=this.context,y=Math.round(ee(n)/a*A),m=Math.round(qe(n)/a*A),C=d.getWrapX()&&l.canWrapX(),x=C?ee(h):null,_=C?Math.ceil((n[2]-h[2])/x)+1:1;let w=C?Math.floor((n[0]-h[0])/x):0;do{let R=this.getRenderTransform(o,a,0,A,y,m,w*x);e.declutter&&(R=R.slice(0)),t.execute(p,[p.canvas.width,p.canvas.height],R,c,g,i===void 0?oe:i?ci:Vl,i?u&&e.declutter[u]:void 0)}while(++w<_)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=ue(this.context.canvas.width,this.context.canvas.height,Xn))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,Hs(this.context),Xn.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const r=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(zn.PRERENDER)||this.getLayer().hasListener(zn.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(r,t),n.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=Aa(i.extent);a=st(l,t.extent),this.clipped_=a&&!re(l,t.extent),this.clipped_&&this.clipUnrotated(r,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&r.restore(),this.postRender(r,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,c=this.getLayer(),h=[],d=i[0]*rt,u=i[1]*rt;h.push(this.getRenderTransform(n,r,o,rt,d,u,0).slice());const A=c.getSource(),f=a.getExtent();if(A.getWrapX()&&a.canWrapX()&&!re(f,l)){let g=l[0];const p=ee(f);let y=0,m;for(;g<f[0];)--y,m=p*y,h.push(this.getRenderTransform(n,r,o,rt,d,u,m).slice()),g+=p;for(y=0,g=l[2];g>f[2];)++y,m=p*y,h.push(this.getRenderTransform(n,r,o,rt,d,u,m).slice()),g-=p}this.hitDetectionImageData_=Er(i,h,this.renderedFeatures_,c.getStyleFunction(),l,r,o,qi(r,this.renderedPixelRatio_),null)}e(wr(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),c={},h=function(f,g,p){const y=N(f),m=c[y];if(m){if(m!==!0&&p<m.distanceSq){if(p===0)return c[y]=!0,r.splice(r.lastIndexOf(m),1),n(f,l,g);m.geometry=g,m.distanceSq=p}}else{if(p===0)return c[y]=!0,n(f,l,g);r.push(c[y]={feature:f,layer:l,geometry:g,distanceSq:p,callback:n})}};let d;const u=[this.replayGroup_],A=this.getLayer().getDeclutter();return u.some(f=>d=f.forEachFeatureAtCoordinate(t,o,a,i,h,A&&e.declutter[A]?e.declutter[A].all().map(g=>g.value):null)),d}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[Et.ANIMATING],r=t.viewHints[Et.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,c=t.viewState,h=c.projection,d=c.resolution,u=t.pixelRatio,A=e.getRevision(),f=e.getRenderBuffer();let g=e.getRenderOrder();g===void 0&&(g=Xl);const p=c.center.slice(),y=Ct(l,f*d),m=y.slice(),C=[y.slice()],x=h.getExtent();if(i.getWrapX()&&h.canWrapX()&&!re(x,t.extent)){const b=ee(x),k=Math.max(ee(y)/2,b);y[0]=x[0]-k,y[2]=x[2]+k,ir(p,h);const F=fa(C[0],h);F[0]<x[0]&&F[2]<x[2]?C.push([F[0]+b,F[1],F[2]+b,F[3]]):F[0]>x[0]&&F[2]>x[2]&&C.push([F[0]-b,F[1],F[2]-b,F[3]])}if(this.ready&&this.renderedResolution_==d&&this.renderedRevision_==A&&this.renderedRenderOrder_==g&&this.renderedFrameDeclutter_===!!t.declutter&&re(this.wrappedRenderedExtent_,y))return pi(this.renderedExtent_,m)||(this.hitDetectionImageData_=null,this.renderedExtent_=m),this.renderedCenter_=p,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const _=new Cr(Rr(d,u),y,d,u);let w;for(let b=0,k=C.length;b<k;++b)i.loadFeatures(C[b],d,h);const R=qi(d,u);let I=!0;const T=(b,k)=>{let F;const v=b.getStyleFunction()||e.getStyleFunction();if(v&&(F=v(b,d)),F){const P=this.renderFeature(b,R,F,_,w,this.getLayer().getDeclutter(),k);I=I&&!P}},U=er(y),D=i.getFeaturesInExtent(U);g&&D.sort(g);for(let b=0,k=D.length;b<k;++b)T(D[b],b);this.renderedFeatures_=D,this.ready=I;const E=_.finish(),L=new _r(y,d,u,i.getOverlaps(),E,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=d,this.renderedRevision_=A,this.renderedRenderOrder_=g,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=m,this.wrappedRenderedExtent_=y,this.renderedCenter_=p,this.renderedProjection_=h,this.renderedPixelRatio_=u,this.replayGroup_=L,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let c=0,h=i.length;c<h;++c)l=hi(n,t,i[c],e,this.boundHandleStyleImageChange_,r,o,a)||l;else l=hi(n,t,i,e,this.boundHandleStyleImageChange_,r,o,a);return l}}class Wt extends nr{constructor(t){super(t)}createRenderer(){return new nc(this)}}const sc={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},ws={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class rc extends ga{constructor(t,e){super(t,e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=de(),this.tileClipContexts_=null}drawTile(t,e,i,n,r,o,a,l){this.updateExecutorGroup_(t,e.pixelRatio,e.viewState.projection),this.tileImageNeedsRender_(t)&&this.renderTileImage_(t,e),super.drawTile(t,e,i,n,r,o,a,l)}getTile(t,e,i,n){const r=this.getOrCreateTile(t,e,i,n);if(!r)return null;const a=n.viewState.resolution,l=n.viewHints;return(!(l[Et.ANIMATING]||l[Et.INTERACTING])||!r.wantedResolution)&&(r.wantedResolution=a),r}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const n=this.getLayer(),r=n.getRevision(),o=n.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(n);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==r&&l.renderedRenderOrder==o)return;const c=n.getSource(),h=!!n.getDeclutter(),d=c.getTileGrid(),A=c.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),f=c.getSourceTiles(e,i,t),g=N(n);delete t.hitDetectionImageData[g],t.executorGroups[g]=[],l.dirty=!1;for(let p=0,y=f.length;p<y;++p){const m=f[p];if(m.getState()!=V.LOADED)continue;const C=m.tileCoord,x=d.getTileCoordExtent(C),_=qs(A,x),w=Ct(_,n.getRenderBuffer()*a,this.tempExtent),R=dn(x,_)?null:w,I=new Cr(0,_,a,e),T=qi(a,e),U=function(k,F){let v;const P=k.getStyleFunction()||n.getStyleFunction();if(P&&(v=P(k,a)),v){const J=this.renderFeature(k,T,v,I,h,F);l.dirty=l.dirty||J}},D=m.getFeatures();o&&o!==l.renderedRenderOrder&&D.sort(o);for(let k=0,F=D.length;k<F;++k){const v=D[k];(!R||st(R,v.getGeometry().getExtent()))&&U.call(this,v,k)}const E=I.finish(),L=n.getRenderMode()!=="vector"&&h&&f.length===1?null:_,b=new _r(L,a,e,c.getOverlaps(),E,n.getRenderBuffer(),!0);t.executorGroups[g].push(b)}l.renderedRevision=r,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,n,r){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),h=l.getSource().getTileGridForProjection(e.viewState.projection),d=ma([t]);Ct(d,o*i,d);const u={},A=function(p,y,m){let C=p.getId();C===void 0&&(C=N(p));const x=u[C];if(x){if(x!==!0&&m<x.distanceSq){if(m===0)return u[C]=!0,r.splice(r.lastIndexOf(x),1),n(p,l,y);x.geometry=y,x.distanceSq=m}}else{if(m===0)return u[C]=!0,n(p,l,y);r.push(u[C]={feature:p,layer:l,geometry:y,distanceSq:m,callback:n})}},f=this.renderedTiles;let g;for(let p=0,y=f.length;!g&&p<y;++p){const m=f[p],C=h.getTileCoordExtent(m.wrappedTileCoord);if(!st(C,d))continue;const x=N(l),_=[m.executorGroups[x]],w=l.getDeclutter();_.some(R=>{const I=w?e.declutter[w].all().map(T=>T.value):null;for(let T=0,U=R.length;T<U;++T)if(g=R[T].forEachFeatureAtCoordinate(t,o,a,i,A,I),g)return!0})}return g}getFeatures(t){return new Promise((e,i)=>{const n=this.getLayer(),r=N(n),o=n.getSource(),a=this.renderedProjection,l=a.getExtent(),c=this.renderedResolution,h=o.getTileGridForProjection(a),d=ie(this.renderedPixelToCoordinateTransform_,t.slice()),u=h.getTileCoordForCoordAndResolution(d,c);let A;for(let C=0,x=this.renderedTiles.length;C<x;++C)if(u.toString()===this.renderedTiles[C].tileCoord.toString()){if(A=this.renderedTiles[C],A.getState()===V.LOADED){const _=h.getTileCoordExtent(A.tileCoord);o.getWrapX()&&a.canWrapX()&&!re(l,_)&&ir(d,a);break}A=void 0}if(!A||A.loadingSourceTiles>0){e([]);return}const f=h.getTileCoordExtent(A.wrappedTileCoord),g=pa(f),p=[(d[0]-g[0])/c,(g[1]-d[1])/c],y=A.getSourceTiles().reduce(function(C,x){return C.concat(x.getFeatures())},[]);let m=A.hitDetectionImageData[r];if(!m){const C=An(h.getTileSize(h.getZForResolution(c,o.zDirection))),x=this.renderedRotation_,_=[this.getRenderTransform(h.getTileCoordCenter(A.wrappedTileCoord),c,0,rt,C[0]*rt,C[1]*rt,0)];m=Er(C,_,y,n.getStyleFunction(),h.getTileCoordExtent(A.wrappedTileCoord),A.getReplayState(n).renderedResolution,x),A.hitDetectionImageData[r]=m}e(wr(p,y,m))})}getFeaturesInExtent(t){const e=[],i=this.getTileCache();if(i.getCount()===0)return e;const n=this.getLayer().getSource().tileGrid,r=n.getZForResolution(this.renderedResolution);return i.forEach(o=>{if(o.tileCoord[0]!==r||o.getState()!==V.LOADED)return;const a=o.getSourceTiles();for(let l=0,c=a.length;l<c;++l){const h=a[l],d=h.tileCoord;if(st(t,n.getTileCoordExtent(d))){const u=h.getFeatures();if(u)for(let A=0,f=u.length;A<f;++A){const g=u[A],p=g.getGeometry();st(t,p.getExtent())&&e.push(g)}}}}),e}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const i=this.context,n=i.globalAlpha;i.globalAlpha=e.opacity;const r=t.viewHints,o=!(r[Et.ANIMATING]||r[Et.INTERACTING]),a=this.renderedTiles;for(let l=0,c=a.length;l<c;++l){const h=a[l],d=h.executorGroups[N(this.getLayer())],u=this.getLayer().getDeclutter();if(d)for(let A=d.length-1;A>=0;--A)d[A].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(h,t),t.viewState.rotation,o,ci,u?t.declutter[u]:void 0)}i.globalAlpha=n}renderDeferredInternal(t){const i=this.renderedTiles.reduce((a,l,c)=>(l.executorGroups[N(this.getLayer())].forEach(h=>a.push({executorGroup:h,index:c})),a),[]),n=i.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),r={};for(let a=0,l=i.length;a<l;++a){const c=i[a].executorGroup.getDeferredZIndexContexts();for(const h in c)r[h]=!0}Object.keys(r).sort(_e).map(Number).forEach(a=>{n.forEach((l,c)=>{l[a]&&(l[a].forEach(h=>{const{executorGroup:d,index:u}=i[c],A=d.getRenderedContext(),f=A.globalAlpha;A.globalAlpha=this.renderedOpacity_;const g=this.tileClipContexts_[u];g&&g.draw(A),h.draw(A),g&&A.restore(),A.globalAlpha=f,h.clear()}),l[a].length=0)})})}getTileRenderTransform(t,e){const i=e.pixelRatio,n=e.viewState,r=n.center,o=n.resolution,a=n.rotation,l=e.size,c=Math.round(l[0]*i),h=Math.round(l[1]*i),u=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),A=t.tileCoord,f=u.getTileCoordExtent(t.wrappedTileCoord),g=u.getTileCoordExtent(A,this.tempExtent)[0]-f[0];return xa(vi(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(r,o,a,i,c,h,g))}postRender(t,e){var x;const i=e.viewHints,n=!(i[Et.ANIMATING]||i[Et.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const r=this.getLayer(),o=r.getRenderMode(),a=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=r.getDeclutter(),c=l?ws[o].filter(_=>!ci.includes(_)):ws[o],h=e.viewState,d=h.rotation,u=r.getSource(),f=u.getTileGridForProjection(h.projection).getZForResolution(h.resolution,u.zDirection),g=this.renderedTiles,p=[],y=[],m=[];let C=!0;for(let _=g.length-1;_>=0;--_){const w=g[_];C=C&&!w.getReplayState(r).dirty;const R=w.executorGroups[N(r)].filter(b=>b.hasExecutors(c));if(R.length===0)continue;const I=this.getTileRenderTransform(w,e),T=w.tileCoord[0];let U=!1;const D=R[0].getClipCoords(I);let E=t,L;if(D){L=new tr,E=L.getContext();for(let b=0,k=p.length;b<k;++b)if(f!==T&&T<y[b]){const F=p[b];st([D[0],D[3],D[4],D[7]],[F[0],F[3],F[4],F[7]])&&(U||(E.save(),U=!0),E.beginPath(),E.moveTo(D[0],D[1]),E.lineTo(D[2],D[3]),E.lineTo(D[4],D[5]),E.lineTo(D[6],D[7]),E.moveTo(F[6],F[7]),E.lineTo(F[4],F[5]),E.lineTo(F[2],F[3]),E.lineTo(F[0],F[1]),E.clip())}p.push(D),y.push(T)}for(let b=0,k=R.length;b<k;++b)R[b].execute(t,[t.canvas.width,t.canvas.height],I,d,n,c,(x=e.declutter)==null?void 0:x[l]);U&&(E===t?E.restore():m[_]=L)}t.globalAlpha=a,this.ready=C,this.tileClipContexts_=m,e.declutter||this.renderDeferredInternal(e),super.postRender(t,e)}renderFeature(t,e,i,n,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,c=i.length;l<c;++l)a=hi(n,t,i[l],e,this.boundHandleStyleImageChange_,void 0,r,o)||a;else a=hi(n,t,i,e,this.boundHandleStyleImageChange_,void 0,r,o);return a}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const i=t.getReplayState(e),n=e.getRevision(),r=t.wantedResolution;return i.renderedTileResolution!==r||i.renderedTileRevision!==n}renderTileImage_(t,e){const i=this.getLayer(),n=t.getReplayState(i),r=i.getRevision(),o=t.executorGroups[N(i)];n.renderedTileRevision=r;const a=t.wrappedTileCoord,l=a[0],c=i.getSource();let h=e.pixelRatio;const u=e.viewState.projection,A=c.getTileGridForProjection(u),f=A.getResolution(t.tileCoord[0]),g=e.pixelRatio/t.wantedResolution*f,p=A.getResolution(l),y=t.getContext();h=Math.round(Math.max(h,g/h));const m=c.getTilePixelSize(l,h,u);y.canvas.width=m[0],y.canvas.height=m[1];const C=h/g;if(C!==1){const R=Jn(this.tmpTransform_);vi(R,C,C),y.setTransform.apply(y,R)}const x=A.getTileCoordExtent(a,this.tempExtent),_=g/p,w=Jn(this.tmpTransform_);vi(w,_,-_),ya(w,-x[0],-x[3]);for(let R=0,I=o.length;R<I;++R)o[R].execute(y,[y.canvas.width*C,y.canvas.height*C],w,0,!0,sc[i.getRenderMode()],null);n.renderedTileResolution=t.wantedResolution}}class oc extends nr{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload;const i=t.cacheSize===void 0?0:t.cacheSize;delete t.cacheSize,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i;const n=t.renderMode||"hybrid";le(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new rc(this,{cacheSize:this.cacheSize_})}getFeatures(t){return super.getFeatures(t)}getFeaturesInExtent(t){return this.getRenderer().getFeaturesInExtent(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Ne.PRELOAD)}getUseInterimTilesOnError(){return this.get(Ne.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(Ne.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(Ne.USE_INTERIM_TILES_ON_ERROR,t)}}const ac="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAAB60lEQVQ4Ea1VwS4DURS9BBvCsKlNk2FLolaiq1qQhoVKWBt/UF/Q9gMEX9CxRdJaENKFdlPLToQlKrXQDUPYsOCc6bxGeKrUSe686X33nd659533RPQw4I7DMrAr2JtvJd9nYdSiTeONwZeOhAPG8tKwRMKDYga7vTDn7F6c83vZO6pI9rBShjMFs2F1fCZcN4M98fT6JIgC9SDdS7nyLFOLOSlXnpKYJ7GHj4SJ0OhA8nh3WozeTjXfcHQfXzxSZL6BwFUGK0ILmaVLubmmydQ/kXR8+oCZLsCXbfcnEo0yS62dytBEBnW7UTz10ejtEpYISMMMElqxaNBUheeMAus0PnMg+ZOquA+v8oBsdGC92UTMWSScn48GdXHo6J2w0172fY3ryjgg0oGHGRrp1xIic61f5+T2AsaYYeg7Qt3C73x+yUwS/itIWGbxWwUVBDgkdAroYqugLIFrEhbs7YtW+Tx9g8Tb2Ha+WHVhfyZlyfzDwlbSi0F6mVJuFtLr+hWx+/gK6e1TeitYaKsuZ+HY5OlBbTYLkvknTopkXKcI+R5HYVM1of/cdZaImTlnd5tYmyQBoT659qv2tDAkqG8qZQwqUhuftcoXb2Vr5xJj1UUcPzMLawoWongF8NhXVwCvA/riMB4GX/AO0EK4gq4xIIQAAAAASUVORK5CYII=",lc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACXElEQVQ4EY1VPW/TUBS9RdCFqjIsRUiRXDYEIumEyBSGSBUdmkp8jHUkfoCj7sT5BW1/gYPEBEh1BxBVBtIlEQIpHgpigRhloQzEVHQpgznnJc91HVN6pJv3fO99x/fdj1gkGwbUNmQL0odEY+mNdRbWTExlaCvQuaXinLH64JqUilfEzF1Ubv7eUPyPQ9neGYj3ZhBA2YA0ITHShOtmbsZ21++AaC52ytoEg0O5e78lweC3AzuJFZKE9cLNy87bl2UxZi9o+6lreHCkSBH5BhxrdNaEFiJze62lM5PpN5F0ofyaka5A550bG+pZkelrTV19JpRqrYuDh5pLrcbstDBFgAsxSGhVFnOmTjwtGsxR/sYlGX5+JP13KxJFEUg72hyvzDeLCIVFwuXlxVxs1JtRJJHYj6+rNPCFzlpe2p194TXTYEcApfP4MQuIIg0SMKokkCe00AxeMJ1Uqz3bC8gzwkIWofJK/IQHf1QOVx+qSBKW0XacMpOE/wXJmE++2Fm7dao/CYN05dInak/eK5W7UUyb4mdOEOCT0N/t7seG9KZqd8T/FEpWWyV9OZbANxLuNp9/Sdrifa3+QdrdH9JEn4W/jlQP/us2nG/A46Swf/qIwEjOLw/O3+afzSQYbYZvAM95PXoVtMNWr3UvsyUmKY81LNhC+RVHrwptU1fZg2KTlcxq2uPjJ3e6+jjbIBmtmpB7G4ltjAb95LzSmAYnhpH5ez83YXO0XV9ZP3O1IHXON0TNsm585rXd+S5PX3zlCIbw4zU9yJlgwYtV6UH0J4CfA+psCIs5gb9vzOmWEVmx1QAAAABJRU5ErkJggg==",cc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACiElEQVQ4EY1Vz2sTURCe+qMKLXXjJSINbPQkFpqCqM3FeAgEPSQFf926Ae8mf0GSv6DpWSQpeKpC0oPSkoPpJUVQskILOWgTCYi9NGmxl3rQ79vsW7Kbpe3AZF5m5n078943uyL+osGdgVagbeg/W5u2z4D1lTEfbwq+Uiwa1Baf3pBY9JrooQkrzdzuibnTk7WNrlTXux04C9Ay1BEv4JIemsyUluYBFHSS/Bad7pE8fFKTTvdPHnECWzIMmIvMXM1/eh8Xbeqiip9o+4fHFigqLyIxy2QFaKCyUrP2+Mxg6kkEnYt/ZKUL8FXP2YGcX2WqrbHrb4U6aPFIYVlWmxoXHhGkBNUIaKQSIV0dPCNKCDB7OyC91nNpf16QCNbpbEOFHcvz5iXCYRAwmUyEnKBasDomFgt3rGPgA1+9vCX1xh7ac1fJPWQEJEZAnU/2CgHsVpzQ2noXFJp0aOQEsCC9ILMX8BPxA2RUSTq7xUOX/uFfqbx5oNwuax+ZzgpPFX16QmLzQekfHMvKu90T80mbNg7c91K8O0mR8N2qlIpRSSWmXWFO0Fz8g8kKzc2tPVeQfzhmy69bLj8pEpkJyLedfZdf5cP+JOBmefXHSAKryeS+uEBXVnetW158dnMkn/MNqbJl8qcNYmve+cULQLK5r9aFMNsisU+7pFH4XqWDlLAavRToUGnWHlmbuHlYFO/8yM+bx9nxoWnsKZ+3N7bQYmCj/uv+i6Quly8p9yCqXRkXqlcIxmlqfT8oIMYXhAzTJoOLKAwGfXQSvGCcGFZmbu8vI5ZXcdWy+k9rQHOcb6g1y4r4bL3e+G1xEYB95LHNKvRMYiCLnwC+9tUnoG37MrAadET+A5b38dBIuf2xAAAAAElFTkSuQmCC",hc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACP0lEQVQ4EZ1VsW4TQRAdUKABhYMmNJYuSYMEIk6FcOUUlqJQxJFCKNkgUXMRH+DzByDHNcWZEhHJpiACuUjSOE0kn6IgpQJHpiANOSLcOAW8t9yenPM5NjxpvHezs8+zb2f2RJJhwe3AqrCvsN+hNUOfwpiISwnePHxeNjNhPX08JdnMbbFT13SYf3Ai/ucTef+pLbWP7RacRVgFFiFOWLJT1x2v9BBEE1FQ0kOr3ZG55bq02r9czJNYo5ewkL53y93ayIk1fsXMXzgGp11NiszXEbjGYEOokJnXrD8amcz8E0lnc5vMdAm+2uVwojAss+KrfZl8UNUaGjKO1vhVoUSAx1cSqvx8yjbCcyYO6rX++lCCn2ewbnxa681DxIQi4eLifKovqNdB8V88vyPWjcHasiKALAnt9N2bvevPPZeRGeG+vH/OH39heQEzY/hJDyLkVl1ox8MahlAymxkOxFphT2/1In3ji0nYYiZxVN5+ke3GsaiVaZRERxtjjr51JDg9i4eb0/e5ZX9n9xinrEWNAuHDwq4ulciJB+U0RD2ZNqUSTbEtgSMWtoMjL7EOh4F16JUyiW259GyH/b3KLVewtYDb+19QkvCyqJjWy6P1qs36gq78fyGmnrO5D2y9VSZnTrkGR5kFTN1GBcnCG6dIMq4zhHx2IGzxb6P3nzoDekGJmJl/8KMMv2vmzJbNO0cFK7C/YTKDLjKFT622G9/lzTtdUgHiuM0abCQoRPETwGvffAL4OaDPgfEy6MMf5Dvf2UslcMoAAAAASUVORK5CYII=",dc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACf0lEQVQ4EY1VTWsTURS99RuUdtqFdTM40Y3QYlMQ1KziIlh0kQRU3HWK7p3iD0jyA0rStULiVoXEhWLJwmQTEYQMUjULNSMRsRuTlnZTF3rOdN6QzIzaA3fee/fdOe+++zEjEg0NagtShXQhvz1pezoTYyTGIrQZ6MrJxLS2ePOMJBOnxNCPu2b2el/s9315ttaT2sueA2UBUoH4CBIWDf2EVS5eBtG0bxQ1cXo7cuVGXZzedh77JHYxTJiLz07lXz1NiTZ+WO3/cxxs7bqk8LwEw2UaK0ITnpXb9ev7JlMnkXQ+9YKeZqGrKcJu903WULFSxqsPOlJ6+FEt3REHC28xjEZrg54OoIsdwsPMLOghMr7ABMRnpuTe3XNcutDGj6ipPzLeTCKITRKm0wu6vzk8cb5tS+aq/t8E8R1WBAiTJDTiM5PDPP4ccZHTuCKvTvDgYFiUMcsLmDuAR/zvhDuyZLXE/tCXxusNiV2sSmHlneIYGb2DDHoYCWYvf/+8LN4663vlBX9EF3yZHjos0iAY/BwIh6/I4HPdhLdBMIGATUI7yoAeRl9vTCYiMs22BL6SsFl5/JmLEEpIhiIdbP2S5dxb1yaZOBmyZX8DbmFrmHRRrFqwf3lq9k6TXeAScL+YvyDx2dGqYMiQMAdGMdUpGXRAtV2/htYLFy69G2zujsTTPQEP7s2nnvPQJSwrB72NDmI2udb4ful22pBjR5V6b5drbSL6IH5xOp82C7DkB0IYQwULVyzsNXo468pIjSwhemav/1yFLq/06spqzdGE5NjfEJlDF6nCZ6warR/y6MkXthk/BrxmDbIvmLDiL4CfffUL4O+AOguiQUL4AxQW8ADbO5FsAAAAAElFTkSuQmCC",uc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACrUlEQVQ4EY1VQWsTYRCd2loFJW56iYiBrXgItNgUBW0vbQ+xRQ+JqKgntwcPgocUDx43+QES/QGSCF6sSlKkYsihKUh6ERKlhR5sm5Ii9tKkxRxakfreJt8SNhvpg9lvd2b27eyb+XZF3KHBHYWlYRuww6YVmz4Dqyu6XLwR+JLjoz7t4d0LMj56VnT/KSuttFyV0kpV5rIVyXyulOGMw1IwG07ChO4/HU0mRkDks5PcTsqVukzcyUm58juGOIkttBKawcG+2ML7kGie4yr+37W2d2CRovIXSJxhsiI0UFmymLt5ZDL1JJIOhz6x0lvwZY41A2anyuLPv4s3MCtd597I8PV5S0NFxlXz9AolApK8JKERmfLrSnhGFGbMr5LJbsnCh5BUV+9JeNIvE7dzwqpaQb3ZRPiMbhzMZ08GA8EBb2sOXqEuDx5/kaWPUxK46JGTJ7qtRu3v/8V5j915+yYM1lx2a78HDt1JxqRvKzsWgXamV1Jv12Rzqy5jIz4xn16yOVpPOF7AEAmDboScN2I4NG9VQ61Ss+sCeSQRv2zFWg9NyXQSdkS+sI2br0j0UcDKoQx8QHjyfMc5ZVPKTHSCFQUH+mwyxlkFG7C4tO1MV90vkbDkljCEJmG22m5kh/kwJ7gtgU0SLqZm15xxuyGcw9reHyvOc94Yho5OcH8DGe4Uzs8GBltz7l9KMT1TEGpJYDdJ+tWYBAfbR6z/arqMlH619SJIThdzN1xfhxXWdg/aZw8MjLFRkGcalykONrEKbbzZ/M9r98O6NcQNd+PIoeY8OkEyfnFWf+zGEeMHQqihQhT6xBsbvb3rKkmtlIGVlZZ3XsIXU371yuqaqwEzub85xOy2Gnxqmi/8ktfv1qlrDXl8zQzsSDCQxV8AP/vqF7DR9EWxarA2/APTqP6lLyWxXQAAAABJRU5ErkJggg==",Ac="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACN0lEQVQ4EY1VPU8bQRCdoCQNETI0pLF0mBIEThlXToGEoMCWAilZ+AVn5Qec/Qfi8AfiS5kPyeciEcgFduMoEshWREqw0TXQBAuFJimS9+zbk41XZz9pbm/fzr6bnd3ZEzEjBtqGlWFt2L/AmgGn0BrxwMBmwJXSqfnY7nZC0qmnYsWne26tsxtp/byRypEv3qHfAVmAubAQ9wWLVvyJXSo+h9B86GR66fh38uJlVTr+7zzGKdzDoKCTXJ7LH39ek9jMIz0e2XZv//REEflbOOborAUVIis1q5sTi+kvUfTZ2ldGmgXnacF2+3vW0rmic+XQF9s50fOG2vK7tCSXZkOu1rhmpF0QCw/xUJn1+JAYPVeX5qRUTPE1BPO2l2tgFY9Dji/MNzcRwoqCW1vr8SEHdhjtYMTksvt1Ua8WR3iO8URAME1BazB8DprAZfHIcNNM4PECVqfwSE4iWHjzQ3Z3EsboqBSsxqLgWOAQYxfvRO0sjvWlYIfOUcg5p5HRcS7TwYaCrfq3a3aMcD9c9Pj86xXjuCZZlsAlBevux3PNj7TMnTNGjJNY34BHQRc72OUu3oeOTmEzosCUBZeFqyslg9IrN6sbI4c2Sohj3du/KL0vLL09dF1GSHggDnh7sDYnBcWCG6eAOS7naUG+20hsoV/o0btOZ6aIkbXOfh2gmydH6CX3e/2nQuOwvmGo6dnwImCuao0ref/pgoK8DLhMDzYRFLz4C+C1r38B/B2Qs2Ex2Aj+A+Wp1NVgc0jkAAAAAElFTkSuQmCC",fc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAAClklEQVQ4EY1VQWsTURCeqo2Cod16iYiRTU+KxcaL2l4aD8Wgh6Sg1IPgCno2xR+Q5A9Y/QGSFLxYhawHpSUH00tFELJKCzlok5JS7KWJpbnoIX7fZl+a7G6lHwxvd2be92bmzeyK+EODOgUpQKqQtiNlR2dg9cWAjzYJXS42GdIe3huV2ORZ0cOnbTdrrSHWekPeL9fFXKrXoMxC8pAu3ITzejiYys1PgCjUdfJ7qNVbcvNuUWr1/QzsJLbRS5iOjp3JfHo3LdrQoLL/d23u/bFJEfkLOM7RWREaiCxXLt45Mpk6iaRXpz8y0hnozGOOIe0XmUpr4NxroXRSbCkue9WGAsISATmIRkIjGQ/rqvC0KJBg/PKINCqzUv0yI1E8U+cG681LhN4gYSIRD7t9kEKLaUjm2RW7DDzw6eNLto42N9gRQIyEOk92QxseBFFA2CoKpdUdtFCw20ZKz5XtBYzzUtrt7Qd88YBkTJEpsfiMrPBqSqJj3gC4mXVmhIdiLvNV9AtBmZoISeJWpywLbzcO9afhBKSGkz2Xkn+zYUfU20rG7KhErpn2Acn4+T5iThBgMUJr5fNOn5Evm1v7dg17m5w1Zbrf1nc9/k6tN0m4kl/86XFgmhY2LiwepGgubQkvxq8rON+AyUth/1TR2Jp7fpl29vl3u1XozQjTaKPUk4t87YKXFbleqEERUaOXRDsUysXb9qaup/Og+s6v+Zt7fzF6H3joI7jnjzt7KmiLkeXS9o37CV1OnVTqjlUbDgjFDZKxrSo/fmdh4weir21SKGy2M+jeSXCTsZaMzFrbfQlbRtlVyuqdqwFJc74h9iyrSWLqpdVfwl4EYRN+TNOEHAkGvPgL4Gdf/QL4O6AuBdEgHvwD/oD7on0nGz4AAAAASUVORK5CYII=",gc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACqUlEQVQ4EY1VTWsTURS9VVuFSjvpJiJGproRKyRFQZONcREJukgCSt05QVyb/IIkP0CSrl1MBFdaSFwolizabFoEJVFayEJNSkTspklLuqkLPeclL0zHoD1w5713v+a++zEjMhoG2ClQCdQE/R5QbcCzsI7E2AhuHDw7HPIaD+9fkHDojJi+SaVW3+hIfbMjr5fbUn7XboGZAxVBQ7gd5k3f6ZSdD8KRd6g0atNq78utexVptXtZyOlYwekwE7gyk11ZiogxNa7l/1y7ewfKKSIvQDFNZe3QQmR2rXL3yM70m+h0PvKWkSbAKx8bCDKjImPOeK2xsy8UJdPrMNzXvtRqTE0IUwTYIIMOrXjUZ+rEU0LQMPGoKv45j3QaC9J8n5Du7oEk02t9BceT+WYRwbLoMBaL+hzi/nZ1bVttCrlrKg18oV0ICqPWMqcROwII06EZQBRubH3viZvP6xnT4/IJreMG2wvw02HAbUjJzaBXReLMGaPjmYVwY5Ay84RboM/MSyx6ThUFOVZO6ps7/+1PRthyRqEdci0WQpLPXVU59F/2yMrSbSX2z8041dSeEwTUGWG9ur6NKqukKqGS4Hrgy5PHl4QREnwxC2LnQ+rsfDAdwBYjrBZffnXK1N48PynZp59l8VlDnbt7vySd+SDWwsXhbDuNON9AmZPC/mmisQ33/OIDACcfEVmPyipSG2lwjyYjn71eakFlVo9eHKNXqlXuQHmCtodAA2MaLTNixhn5fOQNX5qEUfH4wLKBVvAsr/648SBmyqmTmt2X0pmbRwmdcTQbX3ZzOPIDIcyhRgqJzfUH/fC8agXnyuIwsvrGziL4WS3TV9ZnrhYow/lmdTnLuvH7Vf4pz199Y7W70OM1y6AjwYJWCVQD6V8AfwfkpUAG6C/8AeTBAxu3Ro0CAAAAAElFTkSuQmCC",mc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACiUlEQVQ4Ea1Vz2sTQRR+9UcVLLrrpSIGVk8FC01Pai+Nh0DRQ1JQ8eb2P0j+giR/gLSeBRPBi20l8aBYcmhzaRGErFAlBzWRFLEXsy3NpR70+97uxJAmoQc/eDM7b9588+a9N7Mi/WFBnYIUIXXIn1Cqoc5F3xcjfbRJ6PKxmXHr0f1rEpu5JE7knJp52y3xPrXk9VpTSu+aDShzkAKkg17CRScylsov3gLReMeo30ej2Zbb98rSaB5kMU9iRTdhJjp5Mbu+Ghfr/GkzP7T39w+VFJ4vwTBNY0PowrN8tXz32GRmJ5JOx9/S03noSifCiYzxzN//LenMB7l6o6jx+rcw0NsTyzJy+YUspLdA0oYDo8IQAXmIRUI3ORdxGHgGfTr+Rg1p7O8d0lCRe/wRidiR9Vdxqb+fp0cg3dQ5xptJxMAlYSIxF9EJ73NLdys+m9WxaXispac1oT563das83tjc7dzClYEEDuFxqER4T5QpX53N/ScRzN2nNPxpC0VkFLP8gKm6GG025DaXvB4SFqvWpwrY0LvibBWHRL+V5CwwQQMg31hVJPQa0PveHSCN4gdCb3K1i4HAzGLLHJxuEjt6ASTMhXGn3EGvpOwUlj+qkaDGnrB0mCZaDmhVllGjKu5orzfgBZ2ATv53G0YWCZMAgvenngpjZ228DIQ3CR8LArm6iWxW7FavtOJySBy3iQWvHmBOA4uw8EC1hROhgtriJG9tvHj5sOEI2fPGPVRWs5ZSBJBMr44tS97OQz5QEh32aQQ2Fxw0YdnnQsZInrmbf96gmGWOsIcORgFrYsuw/sN0Syawg8y+1Oer3wjoQ87HrMEORZcWPEXwGff/ALqoS6F3oIcwV8sRRZkeZzwewAAAABJRU5ErkJggg==",pc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACFUlEQVQ4Ea1VsU4bQRCdIEIDIgcNaU66UCEFyaaKoHIKCwsKOxKpuUjpsb/A9heAawpf2iSSLwXIyAWmIU0kuwCJhmBkCtzA2UoaU8B761vrFFvG4DxpbvdmZ9/Nze7bFekPA+4krAC7gN37VvF9Ntq+eNHHm4AvH1mZMzY/zktk5bVY5qQKq57cSvX0Vn4c1MUt1mtwZmEOrIt/CbctcyqZ314G0Vw3qF+nVv8r7zdKUqv/yWCcxApBwnR4cTZz+D0qxvRLPT6w9VptRYrMdxCYYrAmtJFZvlJaH5pMf4mkS9F9ZvoBPnfMH0gHM/Nad5JK/5I37wqqZnoy29zumfK7xSvlNqYnhCUC8jCDhHYiZlq68KzNUnRPEbHvNdsMRgadmrlYEK95J01kpsF6cxHxbpMwHo+ZegxEN7L1eUGYcRD8tfiqqfzGq94ac0cAkXE8rPDbme5cZNvtBzuMCcYFx9jn9gJCzDA8KJBRw8AvmUXC/woS1ljwUUEFAVUSVo9+NkblE8oSuCThkfP1fGRC6htQG9spHzc82LNJWTL/sHC09BKQXqFSWoP0Jp5ETFVRCJDeJ0x09Cq7cOR4enADDwuS+SdOlmScpwnZT6Kw2Y7QH191lkhJ9OQmh7kZEhD6lztvnaeNJk19UzWhgEJYq/LxtXz59httw0Mcf9OFDQUbUbwCeOzrK4DXAX1JGA+DHjwAVtbTH+z+42MAAAAASUVORK5CYII=",xc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACcUlEQVQ4EZVVz2sTQRR+Fc1FsVsvFSGweiooNgVBzMV4CBQ9NAG9CW4E7xv8Azb7B0jSs0gieKpC4kFRcjC5pChCFmnFiyYSEOuhWYu51MP6fZOdEJLVxA/ezuybN9++eT9mRaJhQG1DqpAOJAilHeosjJFYiNBmoCunksvGnVvnJJU8LWb8uDLzdvri7fbl+eue1F71ulC6kApkhEnCohk/YZeLV0C0PDKKmnR7A7l2sy7d3q8C1kmsME7oJC6cKrx5lhbj5DG9/s/RPzhUpPC8BMM8jTWhBc/K7fqNucn0l0i6ln5JT7PQ1Y6EC472zD/4LXnnvZy9XFXx0hv1EZdWtmThzJPwuAM4EBOGCChDDBJamfW4ycAz6GvpF4qIBP7PQxoq8CPc3HmXlc7brCTOL0ku31JrjDeTiBeLhBsb63G10Njek6J7SejtOHgsb3dfnPsXVUj4cc4brT0cdaBMWRFA6igeJr9G2PdW1Dj5UJ7Bq3FoImNxmECWF7BKDxOacHzDrHn2bjP0OKZMw1o1SfjfyNktMRZjUsCxJ0HCrnZ/cjHqnWTeR38qzuwgwCOh10Qy5oH74IM0tn9I9dHVqXplhQBfSdisbH2eyUey0sNPqLmksuWpKKxbgv0N1Phg/fRRKkHw7fZIoAu0DnWnb5upsVJKBuF6h2S69TJovWq7fl0VLxfmBT1kM6D1cthT0VmuQbHJ24NFPC9IFt44Lsm4TxNybiOw7rDRh9VP5d/ALlFturO/CZuCttNH1u8cLYjD/obIKrpIFz6T0Gh9l8dPv7DtfNjxmCoRGGfCggV/Abz2dTIYeOpsCJM5hT/w/RU/0O92gQAAAABJRU5ErkJggg==",yc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACpklEQVQ4EY1US2sTURQ+9Q0pduKmIo1MXRWUNoKgdmNcFIoukoKiC8Fx4dqoP2CSH1Bi1wWTghurkLjwUbIw3VQEIUEqZKFNJFJ00ySl2TSL8ftu5o6TB6kfnHvvnHvmu/e8rshgGFDHIVlIBeK4UnR1FuaBGBmgjUGXjsyOG/dvn5PI7GkxQwFlVtqsS+lbXd6s1ST3oVaFMgnJQDz0EqbM0Gg8nboKonHPaNCiWmvJ9Vt5qdb2EtgnsYKf0A5fOJX4+HpOjJNH9f7QubG7r0hx82cwfExjTWjhZuli/uZ/k+mTSHpx7h1vugBd7pC7YeubaVcmLzMf/6D1walVGTnzwnW3hQscE4YISEMMElqx+ZDJwGdebuG0t9zEiS0164HxmjkfFHpRL9+RMNbUEYw3k4ilRcJodD5EvVR/7Un2+TWxn0yrbz3QLf6UeDqtMs4Y21jDTe9gVgQQOYLB5GkEfyAKG3/UrAefW1qlbBB3McY6CWR5ATMkDGtCz3rIIm5/keZuG/W4I6nkJRVDmru1auqkDKHo3pqcGBVzIiCNZlsVOMPhBwmrvQnwG/SuHz2cUvEr5m9I7n1NVpBIgh3EiYSl9U/dMeOOH2y5peWyX6VcZaL0DWkD/CThemb1R5dx74d5NiCJxa+ShGgwcehn0RXC/gZyHFg/dRS242zfU8I1dN439SgnB1nVr46DzDtIirKpfF6gvgLxWi8G4yzjwhIZhgYy3Gju66zC5bZqBtTkA/yXOez+XEYsgmuF7St3o6acOK7V/dTcM8Y6h5KM3VL+3uRrwwdC/GUTR2CTnUbvbrt+2k7xs01LmztL2E9oG/3a6G/OFsRmf0NU/+rCZ3kVNn7LyqstdkoDdnRTJQLzgbBgwSenCNHJYOCpi0MMSB/+AqyMIb5pMY78AAAAAElFTkSuQmCC",Cc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACZ0lEQVQ4EY1VQWsTQRR+inqx6OqlPRhY66VgsSkI0pziIRD0kAjqSXALeu6KPyDZH6BJzh52PaqFrgelkoPppb0ICaWCF3UlRczFJqW9pIf6fdOdZZtsZT94u7Pfe/PlzZt5E5FkGKBt2ArsJ+wwtHbIWXgn4lQCWwbn5nOTxuMH05LPTYmZOa/COls70vm6I+8/dcVf7QYgHZgHizAqWDMzE7ZbW4DQZBSUNAi6+3L7flOC7l4VfgorxAUr2dnL1c/LBTEunNX+/777u0MliszrCHzGYC1oITO33bybWkz/EkXnCx+Z6T1w/unQUdGZ6aVcvcX9SEbj1Teh31/dRgLnhCUCXJhBQatczJgsPAPnCx9UEIWTQL76YlP6gwMZIDuC9eYmYmhRsFQqZshLsL0nzHTpyYz6Tno4EFt6OiPGxeN15okA8hQ0s9cvqbk156ZkZ4/Gihh5eG9+SGujJ9XnN0Y8zHKK3BwFs1pwLCpGcKnOy021ghgdDcOzalIwFbjUUvFKdMhPmkTB4KQN0JO4VHSGLD68huOxr4y+/mAo/d0DFcYOAjpn+Fjb6GGXp5Uj6QE/Jg4lixMQh135Ij7akBvJtgR+McM17+33eNzY2K0vyOHvR8eMNfPquaim7G9AHWyvtd7rw8aE0hIsQ3hZeLr1ymi9lXbzjjrUaYUYxxqyGdB6i/j09C77IBq8PVirtKBYeOM4FOM8LcixjcI6R42e3HYM0mCJmFln628DXFXzesn6m28LVmF/w2QOXaQPPmvVWv8jr9+hY1B3xHGZPiwVLETxymnD9F8A/w7I2TBeBmP4BxL//+/DOFLuAAAAAElFTkSuQmCC",_c="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACp0lEQVQ4EY1Uz09TQRAef6GJBF694IEmT7yYSKTchIv1ACFyKCRKPJjwjPH+jHfh/QGInD1QjyJJ8YAROdBeMCYmbRVJD0qf1hC50ELgAof6fdu3m5Y+lElmZ3dm9tvZ2ZkVCScLahecAhfB1YCzgc6BDKVTIdoR6Gbj/R3W+L0uifdfFjt6Ubnl1sqS+1aWt0slWXhf8qH0wEmwoaOA03a01Z2d7gNQh3EKm/ilfbl9d1n80t4k7ARWVA84Eeu+NLkyPyBW2zlt/6es7B4oUET+Ao5P6KwBHUQ2m10ePjGYPomgvQPvGOkodAsasFj8NGozV5XdQ/Gm8syRrMwPmvwlX2+I9zyvcYzEPkmvbjHSCpRXzmJwRoaiCoxJH32UkcRQJ07cN5s4ya9vi93ZKhNPbzTouWC++YgAdgiYSAxFlVNuvSz6QWZeFpRODzwg2KhVDZIVAcA4Ae3Y9YgyOmNdDU71C//3nuAmwoOYt1t9KirjwvIC9ZzGENOAxhoy8X/ti/vss/AWrEWWjDf1xXgGtWozwhOR+/iajI9dNY/EfPcOLjZFygj9ow8QdgIfQ3cM7bHuiOI8oiUxagoC5jIft7g4lpgzXo/yKLW3tygVIwb9JGAmOfdDKY8brLYWSc6hDqe+KpdareKAnUOJ43FI7G/QAgcLXEbLVaubDwxDV0XRmjXn6Cb961Rx5Wr2w7Cy0wZ//kqm9UbgnMou30Hr1a5AYxgxusrOgckn170Di2y9h/BPngk2FZCfyFJ68+b9hC0Xzmt1MyRtVpA3grF8Ct93PHjygxDmUJOLxHq1Rm9sO+1QL9m/jCy3tj0D/aS26c9Brykd8AT7m53Rgy7Shc/ySq/+kVdvNthm/Ax4TfUQkP8lBx4pcBasH4OJp84FW+Am+gsT+CdBBSasZgAAAABJRU5ErkJggg==",Ec="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACv0lEQVQ4EY1Vv29SURQ+9Uc1qbHQBWNKfLVLkzYWolHLUhwwRAcgseoGNXF/jX8A8AcY7GxSXhMX0QQcMDYMwtLGwYCmJgy2pcEYu1hoZGkH/b7bdwlSxH7J4fLOPed759e9T6Q3HFCbkCxkC/LblrKti2HtiYEe2jB0ab/P5YjOXRa/74IY7iFlVlnflcqXXXmzUpfcu3oNyiTEgrTRTZgy3OfMdGoGRK62Ua8/tXpLbt0rSK3+K4F9Eit0EsY9UyOJ968D4jh/Wu/3XRt7+4oUkT+D4QKNNWEMkaXLhbvHJtNvIqk38JaRRqDLnbA34jqyxt6BRB6VZOxGFkYt7afW5NPP4pzIyMDFF+K9nWcdEcCgsERAGuIgYSwcdBssfHF1R8auZ2UYKfciszKbkl2ald3qA4nOjcu8uabsWG82kVyn8BMKBd1YRIprO8oB6csynDWYVgLRbX2ItDtuPp6QJvR8MYPhRCAgPwkNz6RT+SaeXFFrd3QcF8/kiDiGB8V6uSHb31oyO+OSuG1PJ44XME1Cjyakphc+YfYOi59X0bBuTB+lklTyqnKxZ9Ug4X9BMnQRzteEqRLMwhvIq0jDwdE2B5tS606xvWv/uTQ6pLqpyahmRIyQp4bgCeJCwkoJzegHDLzaZqSd4LOBlxGsM7BNwpKV2eDDP8Eae6acshD/qFKl4eLzqprD6P1x5WdHqgbbQrsbnMF+SKd80mjuq4HnYHOMskt+lTpLZl8Wlj56Ycxetly4o2rVj5gnicR2V9H9A9UcNG0eftZJ27mKejhXit9vPgwZcvaMVh+l5h7nkSAZb5zq12YSj7wghDXUMFHY5OFB//sMa4POlSXi2FTWfy5Cn9B7OmX9zDUGifN8cyym2RD7JLFWxdUfsvxqk8esATummYMcCzFY8RPAa19/Avg5oM6EOCBH8AelXiRum6PHbAAAAABJRU5ErkJggg==",wc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACU0lEQVQ4EZVVMW/TQBR+RcACqlyWsERy2wVERdOxWUiHSFUZmkpQxroSzLj8gcQ/ANLMIGJGoFLMAAIy0C5BTLGqIlhogrLQhZoKljLA9118VkIs13zSu7Pffffd87t7Z5F4GHDbsAasA/sTWjv0WehjMRbjLcFXL+QzxtrNKSnkL4qZPado/t6h+B8P5cWbnnive104HZgLi/CvYNXMnrfr1XkIZSJS3EO390sWbjSl2/tZwTiFFQYFy7mZC5V3W0Uxxs/o8cQ+ODpWooh8E8QNkrWghcjq7eb11GJ6JYrOFV8x0hX4PC3Y6XxYMXWuag8/y+ajT2Lfvix371yS7daBrG+0tMZQ33hckOCHijTAwORpNFZpMavEmBdODI5+wz2G/lhNzs1MSL2aV8+60Vxj/Kzkrkww5wYWtk6BsLy8mFU8hC3X5jPSfrsU7SwHOImbNGg77w/EujUd8XgigAIjNLmCegsnqZeEhtG5z74I0hSxeLyAWUaY04LR6AkPzv3doehID/NvMsL/Qlx0gwKMsEtSWnDTBnOn57GCAJ+CPhOcBjw+XLx87+oInWUJfKXgDhOcBs6DXVlbndL5GprC+gY8CrpYOeDqSXCf7qvorNXpERqjDi8LV1dKCaXXaDeX1JkbmZHgYBHMFV+y9NZBcxkh4cFR4+2hq6PvTm4pFt44Dpgu2VqQzzYS6/QL/eRdZ4oYmb/3vYa5FQoQ+pP7b/3WQldmfcNkFlWkDz5ztd36Jk+e7/PC4GXAz/RgqWCBxV8Ar339C+DvgD4bZsBG8BdTQPJbZdBgiQAAAABJRU5ErkJggg==",Sc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACs0lEQVQ4EY1UTWsTURS99aMKLXbSTUQanLpSKyYFUZtN4iJQdJEEFF0IRqH7SH9Akl/QZu1HUnDjB0y6UCxZmGxausoILWahTSRSrIsmlmaji3jOS1462LH2wJ03c999Z+49774n4g4D7iTMgtVgnZ5Ver4ERlcMuHhj8OXCQa/x4M45CQdPi+kbUmH2WlPs9aYsLjWk8L5RhzMDy8P6+JtwzvQNJ3NzUyDy9oPcXuqNtty4XZR6YzeNeRIrOAlTgUuj6Q9vImKcOq7nDxxbO78UKTKfR+BjBmvCBDLLVYq3Dk2m/0TSycg7ZhqHr3CkN5HSmbV2fkv8UVnGr1kIaut16p0lDpx5oaxbbhsJDAolAnIwg4SJ2LTPpPCl5S0Zv2rJCEp2kjGaBGfHhqRZvassNOVVPmZIvbmJ5CJhNDrt4xoprWyJ9Twk6Vm/+tYPLkJJkpy5oCShxsmZ88qnf8yOAMIkNAMTHrU2PXvZdXdZFjSWj2gZDbZQ199tKbYX4D+GR0AT6mC30XoWUiWi/8QYGVTy5OaDipTxvV41meGhkH36SRFRO//FbkX0UQ4nSFjXOjgnnO+LyKq08kPYCdSOVluNKbKFlxsqlCcIsElol7EZB4E/dOqlY82xYal/21Wf1BT4SsJy/tUX5fzXw49Ns9e3Jfuk2g9hi1FP/8So8vF8AwU+2D9NlNPpbN5XVluNq9uFo/ahnTrYaX3rdJBxZy5zxRlfI5k+ejEEW5Xizf6ucdINWm99A/FkTUbesicfIj5/tLeoit3yLJU2r9+LmnLyhHbvp2TL0AiS8QRVP//M4JMXhDjbJglhM92DvneGGeQGasjM7LXtLObTOkaXrL85JmApnm8YRPeIbnyWW1r+LguvN9jYLcSxTLURGP+LBCIsWAWmN4PC05eEGbB9+AMiziwWYWCsOQAAAABJRU5ErkJggg==",Rc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACq0lEQVQ4EY1VTWsTURS99aMKKe3ETUUanXZVsJgUxY9sjItI0UUSUHRnKrg20h+QyQ+QxD9gRnBjLUxcKJYummxSXCVKC11oG4lIu2nTYjd1oee8zIthMpEeuPNx750z951374yIPwy4MzAHtgn741rN9aVx9sWAjzcJXzEWHTUe3Z+QWPSsmKGASquv7kp9bVfeLTal9LHZgDMHs2EdeAnzZmgoU8zfANFoJ8nvotE8kFv3lqTR/GUhTmKFbsJsZOqMtbwQF2P4pI7/99zaP1SkqLyAxGdM1oRpVFasLd09Mpl+E0mn4x9YaQq+0jE3kNWVtfZ/S+pxRcavOUg60M+pay5x4NxrZcxh3BgeFEoEFGEGCdPJmZBJ4cvVbRm/6sgIluxHFr4YlM1PKWXM4QsI6s1NJBcJE4mZEP1SXtkW5+VNsebC6l4fPq/tqMtC7oracb7cLkSltXeoimCQHQHESGhG8GbCmrvku7t6aSqp6xCZCkoFRRBsLyBMwogmpMcPXCpE75GBEjV+tHV2e9U84Ufg9VGj9IMJpRmvuRHllS21Gm+LscJG9wZ4yfR9Hvrlc5fFHAvIBdjywm1FbI4NqRROEFBnhXXogF1Woqqg98CRo1ZPn0wKOqITJkkWuhPMAb6zwoo9/403fWGeD4j1/IvkYAR7dTZTFWqv9ed8A6qxbYjbosD9QM3YTvb8hmrq4OQbtRmUgaBk7sfC1qOXxOg5taU7Spd+xPphY2QQee15Z7XT8ffsglnE7ePuw+uYyeBi+ef1hwlTTp/S7l5qkuk4yTgt61/3csjkB0KooUYGwubag/5vhnXQe6ZErKy+uvMCMUvH9ZL1Pc9pWJbzzR1lU2vhqVW5uiWv3m5w5FrI4zJLsCMhjSwHVoPpXwB/B/RlYAasB38BbTMURenwjkwAAAAASUVORK5CYII=",Fc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACyUlEQVQ4EY1UTU9TURAdNaAJhj5YiBvMC2yIEqk7YAMuSIwsbBMtLkx4xLC2DT+A8gekXWssbv1I60IjdkHZ1JiQtBqIXaitKSGy4bUENnRxPee299HA82OS09s3M/d03syZivibBXcUSANlQLVQaPkcnL52xscbgi81Od5nzd4bkMnxy2L3d+m04qYrxS1X3qxWJfO+WoFzCVgBPDtJuGz3X4ymlsdA1Ocl+X2pVA/l5t2sVKoHccRJrK2dcDE43BtfezUlVneHif/1rO0faVJUnkBijMmG0EFlqUJ2+r/JzC+R9MbUO1Yahi9j/OXyp7AqfJhWeFU9AKu7Uzkzg8otRZTaeeAhOj+kGMNFFbrVr3gPb8VnF7DO4sNBwLYCHRJ+uC4TY33ilmaE1Ra39iT5pISUpsUWNzCMbVl7PSUgkgBaMxfL635ziMhymJlOJcYVCFRwuMerhFVlnk0otMLzIVdXYypm9ayWFWKQrDLDCu3gtR4h8Mp4PDa33kBPO7Ujl9/V39unz5h9pUs+Q0qUF2yEhEGSnTTKYunxF3k0P6RDdTTfCjTJ23ODV3ulsn1gtGqT8JQZjc1GBsQBaG796FSen4OEFRIYayeLL1w3boFGpeZDyur46twgWJGExfWPu/pibb/RmvQlaSdjkOtHzbGXxvjjXEcqgyfsJwnXV158R3JDq55bEl8YgVAPPTCTVTiRQYnFN7Sf+cmnX3VfOSjuN0wLm/pxKWKcvqB4KRXKBKReDpeAMQJ3y4C3eiHoLV3I3vZkwuCfjNWxn802NLB6b1H1wRzyV861LpXQn57V3M7o/Tu2XDhv3P6UjFNCpk2lb3X+2ySYzR4ai6KxS81FP566CZ48ORxWVtzcSyIWN3Hzb2OeeTrAIvcbkJHWFjHAQeXyv+T5yx+cdg0uvqYeBOP/MgcJaaAAmEGw8fRFAQs4Zb8BSBtwJRgqL8cAAAAASUVORK5CYII=",Tc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACe0lEQVQ4EY1VTWsTYRCeiHqplNVLRBpYParYFARpLsZDINRDEvDj6Ab/QIo/INk/YJKzh6zQUxWSHipqDjaXFE8JUqEXbSQXvZhY2ks91Od5s7Ok61ozMDvvzsz7vPPOx65INFlQl8BN8B742Oeer3MgIykWoc1D10in4taTh9cknbosdmLOuPV3RtL/PJKNd0NpvR0OoHTBHjigMGDVTlwoNarLAIoHTlGLwfBQ7j1oy2B4UIGdwIamAcvJm5cqH15nxJo/p/ZT5Xj/yIAi8hocV+msgA4ia/Ta92cG05MIupR5w0gL0LXO+IayRqZXiV1ZE3JxdRvOh7rfyPqLXbl6pymU1vx5YYpADbBFQCefTdiaeOZl8cZFGe0+lr2PBRn/OgJolxsMMO3eq694iwmjIzHfLCKWDgFzuWyCej+SY6m5t83VeUgV663uD99+IHeX49J7vxJU3hjwYEeA0mfxsJOIiEQARjVNBEN+jcqPZNocrNleoEVGmFTAwOovmDv3+ScpP7sVNv317qfMJmAkjfd/S+FpR3LZBXEemetE+oWVBByEq0gwU5zrlslneFPUOycI1Cdgv7M9Sbo6FktdsRfmxKulVPVfybEEfSNgx1v/EmwgGE+rIG+MXDlw+MeC8w1qscoeKlkGs4/EW2ePoVKZTSP1weprr6pOJQ/1Pxaejl4erdHstVdM56vjLJL5XsLhGL0i/D1emdSCos5CaPdP1Kc/tXjY68LTo7cCcl1CYt3JoJ+cXRrDxIZnZP2dn3XYKmrXK+s7pQMuc77BZq618Zmrre53eYlZBuAYfrxmCzwTOfDiL4Cfff0F8HdAXQlsigh5gv4ArXr/f4PXeKEAAAAASUVORK5CYII=",Ic="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACqklEQVQ4EY1Uv29SURQ+GstiU58O4iAJ0aVRIzRxKQs4kBA7AIm2i4mPqLOPdBf4AxQ6GwOuagIOGpVBWCCaJpCmJiwKBmOqgw+butgBv+/CfSk/rJzke/fec8797rnnnvNEposBtQUUgTbQH6Ix1JkYp8qRKdoYdPlQwG3cunFOQoEz4vUcV27NbVuaH2158aYrpdfdDpQZoAA4Mk6Y9XrmrXx2GURux2napNP9LVevl6XT3UvDTmIlBwlT/kun0u+eh8VYmNP2Q8fe7h9FishzcEzSWROaiCzfKK/MTKZPIulS+BUjjUNX0vp2+328T+Cq+gH65tr5vt1a7fe/3VSwW2vKbiy4lA99uQe34toGjKP4mLGIx8vEMye+iycFGwWOPFUSVl0fKsn7m7iBS9of4soeXHarPcw3YJCLhNFoxKNezzgxJ7nMFXVtHmDdWZRK7btDWKnvSGr9smNPY85D+UCsCEjoGD5eP6IiGm9XnM2c2L/2UTLzjo5RHxQSURgIywviY4R+ko0LnTMPt+Te3cVxk7OO364qO9MwrFUvCSekt7uvchONnBVzVV1lwidh1ZQuve4bsZGwo0OnRZMFl0+rfI54DxfJ1KZU6j+k+DjolBk7CNIkYbNaHyRek/kuGFLIBYbbR4fMgy203VdhA+iWpAfbEvKFhNXC009coERq6kReg1FrKCM+JMs9akk+OzhM2xkI+xuiCpv1Y6MEnILGemTO4iXG9XqNAGhrA07rxVAexUb5GiJ0UT+zMLql8EvcZi+BTQVemVKCYoOdwt6cVXTOsZd/mwL3aULOLSQ2M2j0QcFS+S9hBzGy5vbPDfiktZ/+2+g1RxNIsb8B1du68PkIldqOPHn2mS3Zgx+vqR4C43/FhEcRaAD6QZh46iyAjzkhfwH6QzxVDjE9cQAAAABJRU5ErkJggg==",bc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACz0lEQVQ4EY1VMUxTURS9iCAGAh8TpQON37poJFASB+kCDo1GBtpEwcGEb3Q0sYTBxKXt5mJaZofWFU3AQSN2sCwYE5NWg6aD0poSYhd/ITiIw/ecR1/zU0r1Jve//+497/73zj2vFWluBsIR+BK8CHdqnqvFLIxNra1JNIRYaiIwYMze8MlEwCOmt1vB8uu25D/b8mKlLMuvyyUE4/A0vG6NBROmtyeSSoyh0EAd1OylVP4ll69npFTejSHPwsrcBaP+oROxt8+DYvR26HzLsbqzp4pi50kA5wjWBS3sLJXLTP53Mf0lFh0NvuJOw4gt63ix+D7sYHeOf6hfNcDo7XRi88OOs3Wr7sSACoc5LFRYvQ5zG24cwcMKXfWaGNX27989L3ZhRnj09OKGLDwpMKWMnJ0e7BaehJipK161Bpsg5wZAVjse0Qf3hs6R5DYQ8OjhqHQdaxfPqeOKj+y7itycMlXBj19sic2PqK4Tw8bNRT+ovOdkF7q/+fsokKb/Qr/QrRmfWqgflIjR16mnwu67LbtWUVPKCjTwfYQF/SzWaNRcevGbgKPGlESwq+2dP5Jd+yGpZEAVqxU0yeEB4/HDd1YlEb9YF7UbdGawR0xwSZGsghJ2Whtlww6b+jZowc5O+8DXsMYdOrJRITRnHHyOBl/mucM8v0JrVYy5+ONPCud+8KilzV0hRbDvLLhKrnQxds6aPqvmjNFpRl+HJCEhd1E2BXdaxsc86n4DpoRN/dgULMYDjhtUF3buzaTDucZR4ODZobgRK8LrVy8E4FIuc023n7lDrYoOV7f3VMP4Du5wkt3bWJCmsGkFdKp/Jbt1iSKmaFsZ89Qni7Epha/bceCTXOOWTQTExvcv+j5vrYqSP+4sv/5zAbiYxlI2jWYhEOX9hstI7RYRxAZRzE+fbWCsVBHiMVUjmP+XWQDwL4A/+7oRJJ6xCNyAH7C/V6JHC9VDTDkAAAAASUVORK5CYII=",vc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACnElEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX66FY9uDxVwbHkN0MjFJLwDix8DhIMbo5WPkTZ99gUDRfzwCiYQCYLhgKgOkCCAJAFhoYaAvC5MA0yDJ9oNj7G+EM908GgoKEITDpIIoadA7MkQtW3wNKMWI4MB6YCIHAH8NCUOoS4GdlmNBoAvY1KKXWF+kxgFIePgBylL2lOMP5XV5YUzc0xSuwoBsC8u35Xd4owiDXA+MZRQyd42AlzgDChACGhegaQJaB8hMonkEAFJfI8QMSAwUXsXkWr4UfPv0GJx5/DxlgQaAEMhsMHjz5CmOCaUiCIq6QwGkhzDJ7SzFwfMJsAKW4+f2WMC7JNCjRYAXglKolwLBgghVWeXIFQRY+AMUTMkgsOAbmNhTrA7PEVzhGVkMqG5T6geACKEg3Llx1Nx+WKA4ce8mwYBUoLzGAMzCYASVAeZLYxIGsD8SGZqsLoKLNARgv+++fCgDmOzZ0dVThg9KDoetWUAGiCArSA8BUNrGw/ixVDMdmSGPvRZBlE4FyD2BVwwlgGHt8/PRbwsJYhGo1BshnmeUnGWYsvg2qnhKB+AfMwh9AzsoT595wrtz40EKQHxK0EmKcQGHSASihTZxzgyEy8wgD0EyQz0CWgStgbKYpAAUXADGomUBuEwPUPJkAxA5AjAIA7oMIyaGb3E0AAAAASUVORK5CYII=",Lc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACyElEQVRIDa1WX0hTYRQ/Vi7F0C0ihzS41stAqEn/Zi9uD8agBzcIoyezPw8+OfFBelrroeihtr0JRib10CRIH4TEhyWEqURbkjCIugslkIJtMmE5Yv3Obfd273bXdPqDw/2+c77vnO/8+c53iUrhACsAEkH5KimKfWMgAaRBjWpmxNhnbDR4B25Z6VrPCRIsDSrx9oexT0mKrSTJ/2iZEquZIHb6QSnWIBtkY5HenuO24N2zZGysZdmukdrYIv/DZQqOxmNQ5gSl9he03odX7pEH56nuoMzatT1Jl8vZwl6aP64k66Bxhj0UBMshMTp7ac88Kz4qe9p6bpLwde6D0OcbOqkxxjlwXp6lmpbnEvUNvsMpN4v16M7fzK9T+8Vp4j0yUBfkRV0AbjZos7WZZJmk2HNjjk6Bl4xfIXHRQ/l8HgrmlTXlBoO+9+S5PofDGziMmmW9KEKgu8Qgcx0XminoPyN5zZXKFcsnrwSOgrjkIUdHc8nSQsULB4olLBgLdGjYSDjZ2g5reHqTV0869dgaXolBtfRv7jJIdo7UykKjcS4AZWm3y4ID/UuLItAZcEjLQjjWIHmWSm/R+MQXZZ24lqHE2qZCqXROkVUa/NdDrl7GwE0rtXdNUydyI+e3kuJy8hIPuTg4ZGpwXo1NtVJo1fxqxmwwUXzHvCjv8Ymvkj7OH7cnDtt286R3EO6tQIwNTqnzwyEL4ErcgRG++CZrmCZnVinysqvqZi5ZQjNhg9zaHLioEXHJLV1Y5sqQPS/cIZm94y9HiWsAzaCVO3Ui++u3af1H1u5GeathbDIgdwY1q6rx7XtReh35HsLmF/LTsIAYu9IbObP99JE9ezHYs/7hRRp59pmfpz5QVjaYxSS88OFnfXjqm91U8Mp8tB7snYNTEXocp6v9bwk62TM2Jj3AetoEMJ+C+Deh2l8MEXuDIAdIgz9GchluxrTNYQAAAABJRU5ErkJggg==",Dc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACgUlEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX6+G0rLD+DIOi+XpwnKAbhI1/4NhLBkO3rQyJhcfh0sB0wVAATBdAEACy0MBAWxAuicwARf6GHU+AQfKV4cPHX8hSWNkgxwUmHQTKMYKCEUVNPDARAoE/XgsDkw8ygHxPLAClTFDUBLjLYGiBpngFkIVYASh1OViJA7OHElZ5bIL717gSzEos2DSCgnDBqnsMIAOwgYmzb4ASAFzK3lIc7Di4AB4GVgsdQ3aDgxJXxr//5AvDx0+/4cbqI7HhgjgYGBaCglKAn43BAehqkE9h4OETYMIBGgwqFCY0msCESaYxLDxw/CXDhSvvwFkB2bSEgmMMCeHKDPP7LZGFSWaDLHwA9Akw80PKTWzxxii1BByfoERELgClYCC4AEqlGxeuukuuOUTrA+VpILgAKtocgCXB/vunAoDxw0a0AaQoBMW9oetWUGGgCPLhAWASn1hYf5YUM0hS29h7EWTZRKCmB7Cq4QQwjD2ASV3CwliEajUGyGeZ5ScZZiy+DaqeEoH4B8zCH0DOyhPn3nCu3PjQQhCYLUBAQowTTJNKgLLTxDk3GCIzjzAAzQT5DGQZuALGZpYCUHABEIOaCeQ2MUDNkwlA7ADEKAAATIH2zR+4T2EAAAAASUVORK5CYII=",Bc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACXElEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX68Et27jjMYOi+Xqs+MHjr+hmofA/fPrNUFh/BqwXFIcwAEwXDAXAdAEEASxAwsBAWxAmx6CvLcQwv98KzgcxNu58zLBhxxMGAX7ccQtKKIHJB8EJDeSwDx9/oZgRD0yEDb2X/DEsBKVM9NSZWHicARIKbCiGIHMOHH/J0N9owhDgIcPAKLUEWQrMhpqpALIQL1iw8h5YPiFMCa86aJDhVQOSJGghKC+BfAcDoKADBTEyQJZHFsfGxmshNt+BUtyDJ/gTDzaLYGJ4LUT3HUiTg5U4GMMMIJUGZQusAJvvsCokURBk4QNs+Qub70g0G0U5NF9eAFm4ceGquyiStPAdKLEBwQVQ0eYALAn23z8VACxtcOczFBeRyAGVQIauW0FlqiLIhweAKW9iYf1ZEo0hXnlj70WQZROBOh7AqoYTwDD2+Pjpt4SFsQjVagyQzzLLTzLMWHwbVD0lAvEPmIU/gJyVJ8694Vy58aGFID8kaCXEOIHCpANQIpw45wZDZOYRBqCZIJ+BLANXwNhMUwAKLgBiUDOB3CYGqHkyAYgdgBgFAADj2e234obfjwAAAABJRU5ErkJggg==",kc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAAC20lEQVRIDa1WTWgTURCeqo0tljYBsaE0sK0XQdGU+pN4aXJQAx6SgLR4aqN46MkGD+IpxIPiQbO9FfyJRQ9WD00OxZQeYkCaRtTEYiEguikpQlDIJijEBtGZR3Z52TXSpB0YMm9m3sz73sy8DYCeHKgKIUvIf1rkNO4LIwvIddTGrYwoB4zdhqmrVw7BxOhBECz7OPPWxczHImTWihC8twq5/A8RdwaRZYqgJKRk8fHRQat48wQYu9vJtm2Sy5sQvLsK4v1sBoM5keXdtai3EZVn5s4p6NirqLadj8VyOfsIpfnDWrEDIy4SQkGwdEnppfM7hkx7VEI6cDIC+OvchcZA4NrRumRUA+eFJWjre8rY50/iKX9q4/xz/Wq5AENnF8AfeKfasS9gCvsCyUMJrdbDJtVIp/FeTsAx1BWzYyClvCCXNsHnX1Z9Ggn+wFv0S+LhDYSmzm0cmxDJrUtI6PDOQQweZ6ipU0Mo08n/R3QDNENUGqG/S+da63iBEtaR9YiJnZBPEI3lcUT0QfiNFFA5JK/Xynu0CrqOsGgH76UEOE73squRy1WYfziiulKr8+R2WYAvC2/TyrqEFHz6QRYI6Yi9l/nTevbFF9QNs3Vuo76B5FJVG7fhWpcw8jLPOlJKedRNHkQwdGYB3Of6GepwyK7amhV0NUwkCywoH4jqY+xph3UNMt5nqzIlzPEzRtdIKCOxDTUG1Yx8lCtWDU0I9LYiZShhdPb5Z3XrxNgg0ONNM6UMfmQxD/OPHC0/5iwTjhtShp42B3ZmXHrjYeNAWoUU5LUZUtRN/1IjUg/gfA/QS52r/PptKnyr2Kg5eDL2GLB2Bl7VknzjVhpi8a/TuPmZ8mlYwTt2lcpVs214/459MQjZ5PUUzDz5RJ8nH3JFSVjBxdzK+++dc9F1m6mGynygE9XNE5WCZvfi5GvAmISMksmNIgloeIxMfxNa/Ysh4V4R2YFcR38Bb3Ues5HaWTAAAAAASUVORK5CYII=",Oc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAADA0lEQVRIDa1WX0iTURQ/648pim0QOaTRrBcpKCOr5YvbgyT00IQwgkAtevCpSQ/R01wPRQ+57U3QVKiHFoH5EBg+TCH8E9GmpA2CNlGEUbRvQ2Epsc7v5r19m01T94Oze79z7/mde/589xvRRthZ5WWJsmR2KCG262exsmTBoHsy8txtLC9y3bldTa3Nx8lqKdUt//80/ClB4dkEebpmKLaw7GNLD4sGBukQzoItzcdqfA/OkbF8P9Z2DS21Sp4nM+TriYSZzMGi7V1nfcRRObsfX6DiA1K1a3+Cq9FRiSjN07OJYmZ8iwitVktZNDRyuWCR5R4VkVadf008Ovbwott995RyFltYIcfVETJUPheCOXRbYTM77gtycV8wnHBYU3PSpPiabo2y8yJKRK4Jqb9YIQ6AU26Gto5xOnqkVNhEp5oInNBJtHATMq4gpZnM0g2pF1EhvfpDINpcnTLgCQ5zpuENDfbZlR10puqXBOey28GDCLPA9aSx8bjSyXRKI7WgmyAjMiqpzme3T26Q4+DTekJaRyfiZDxYRKPsHCcHKTAQ+Erzi8tyOyHl9roK9YyJllqjpptjhN7IxYYI/b2feY9BEJ0+8ae2nq5pkTYYJzlVscUVJSDPRZtrXBy28x8Os2o4NLxAra4JUS99CtGpzksWwg20FeAsPKdR8FWD6nxps6GGieQqF7hMFVluRDrDcwn5mHfscH/I60waIaWxvwUu4zvwB/l7InJd1BB1RK02A64w1NfbWUsaHxyckhd2uFsx4MfHucarIWSwrz7DUaqvBEeX8Xpq1brcpx+5Q9V+5suac2qFbb+3Dvp+1NDOpMHoe6fqRNaJTsNJ9bWEfidAY+E95Tu1Cjd1LP3zlyn+LW1zNloUHy5xvBaFwP2HIRoOLvmZ64X8NExyjhuTqTWz7eyhgn0xEFn7vSnqfvYFtWtjSUuHaX4ITH78XhIYmreZ1iMzHy5h9faBZvH3Ruh6+ztiTkQGZ1o+JisvDLDgb0JWA2zjOcp7fSx2liz8BkCog304fm8JAAAAAElFTkSuQmCC",Pc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAAC0UlEQVRIDa1WTWgTURCe+lNbLDUBaUNpcKMXQdGUqk17MTlUAj00glQ81SoeemqCB/EU40HxoNncCi0kRQ+mCtpDRdtDDIitoiYWiwFpk9IiBMWkoUI0iM63ZpfdbCsxyQdD3pt9b76Zl2/eLpEednb52ZJsvyu0GO8LsglsGtSpZgYeew3N9e6RSwfp/MABEsy7VY/LH8Y/ZCi+mCHfnQVKrW6IvNPHlkUEmRBkkcGB/Vbx+nEyNO/Es6qRzf0k3+0FEscScQ7mYMtuL0a9yVW5Rm91UcMu2VU1nxTL6WhDlab3i5kGjvgMFQqCuSkZm+2rWWWlqaJSy4nHxL+ObfzQ6718REP2/GWaHGdmqa7tnmRDnjksLo2z6Rx7O05Nk8f7VnnOuiA364LhAqHVesioPEytfqfTF6J0lH2ZxFmKzfSxAL5JPmXRFgOP9w0hORCUJjjIImT06wgD4x/J3tNKou+YVLX1sJEiD3sJmSOZfwE9hL9GaG/SLSsqXgChBtn1Ahn21Gt8yBgWnUtr/KUTOclSv3q+Qz3BGMd7jaXs93VKJPAFxhKaI4LU1eh3mqV9at9WYx0hmj70YIk6ep+QiwOxpKUmZiUrMVJr2qPFqZQLHSE2Qiih8DKtrG3Qye5WCoo9rNoZ2tf+9+YJ+rvLja9bpyOEOLhJCZXKgFhwXUFA1QKiSZWqz83ynphclmJLbXIxKiUA4VQK3K2MOAinJiaXlDhoCT+3BISDxrd0PeJjbZHaRFlUwQAnxIjjarNz5pHka5eiSjkeqkOLVHuZZ3MFFuE0BGjBTZ3K//hlTH/J26BKNUBWi8v86o0YPY18DnDs+/KrYZ7P2LmeK5hsnXtrQoLEUdnwlVc0evcTXk9DbHmZMM+T8Py7r43hqRWbsXjTmFoa2f3/wF8RGE/QueEXxDFRGcikF/Bm0QR2htjwmVDpJ0aS94psdjYN/gBLWxwVhmOXcAAAAABJRU5ErkJggg==",Y={exit1:ac,exit2:lc,exit3:cc,exit4:hc,exit5:dc,exit6:uc,exit7:Ac,exit8:fc,exit9:gc,exit10:mc,exit11:pc,exit12:xc,exit13:yc,exit14:Cc,exit15:_c,exit16:Ec,exit17:wc,exit18:Sc,exit19:Rc,exit20:Fc,exit21:Tc,exit22:Ic,exit23:bc,exit2_1:vc,exit3_1:Lc,exit4_1:Dc,exit7_1:Bc,exit8_1:kc,exit8_2:Oc,exit9_1:Pc};class Gc{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=wt,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?pt(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=pt(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return et()}readFeature(t,e){return et()}readFeatures(t,e){return et()}readGeometry(t,e){return et()}readProjection(t){return et()}writeFeature(t,e){return et()}writeFeatures(t,e){return et()}writeGeometry(t,e){return et()}}const Tr=Gc;function yi(s,t,e){const i=e?pt(e.featureProjection):null,n=e?pt(e.dataProjection):null;let r=s;if(i&&n&&!Ca(i,n)){t&&(r=s.clone());const o=t?i:n,a=t?n:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(_a(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let c=0,h=l.length;c<h;++c)l[c]=Math.round(l[c]*o)/o;return l};r===s&&(r=s.clone()),r.applyTransform(a)}return r}const Mc={Point:Vt,LineString:qt,Polygon:He,MultiPoint:ke,MultiLineString:Ie,MultiPolygon:be};function Uc(s,t,e){return Array.isArray(t[0])?(Qs(s,0,t,e)||(s=s.slice(),Ki(s,0,t,e)),s):(Ea(s,0,t,e)||(s=s.slice(),wa(s,0,t,e)),s)}function Ir(s,t){var r;const e=s.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>Ir({...s,geometry:o})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const n=e.layout.length;return yi(new nt(i,i==="Polygon"?Uc(e.flatCoordinates,e.ends,n):e.flatCoordinates,(r=e.ends)==null?void 0:r.flat(),n,s.properties||{},s.id).enableSimplifyTransformed(),!1,t)}function pn(s,t){if(!s)return null;if(Array.isArray(s)){const i=s.map(n=>pn(n,t));return new oi(i)}const e=Mc[s.type];return yi(new e(s.flatCoordinates,s.layout,s.ends),!1,t)}class Nc extends Tr{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(Qe(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(Qe(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return et()}readFeaturesFromObject(t,e){return et()}readGeometry(t,e){return this.readGeometryFromObject(Qe(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return et()}readProjection(t){return this.readProjectionFromObject(Qe(t))}readProjectionFromObject(t){return et()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return et()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return et()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return et()}}function Qe(s){if(typeof s=="string"){const t=JSON.parse(s);return t||null}return s!==null?s:null}class xn extends Nc{constructor(t){t=t||{},super(),this.dataProjection=pt(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=pt(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const n=yn(i.geometry);if(this.featureClass===nt)return Ir({geometry:n,id:i.id,properties:i.properties},e);const r=new wt;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry(pn(n,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){const i=t;let n=null;if(i.type==="FeatureCollection"){const r=t;n=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const c=this.readFeatureFromObject(o[a],e);c&&n.push(c)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return Yc(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=pt(e.properties.name);else if(e.type==="EPSG")i=pt("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(n!==void 0&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=$i(o,e),delete r[t.getGeometryName()]),he(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return $i(t,this.adaptOptions(e))}}function yn(s,t){if(!s)return null;let e;switch(s.type){case"Point":{e=Vc(s);break}case"LineString":{e=jc(s);break}case"Polygon":{e=zc(s);break}case"MultiPoint":{e=Kc(s);break}case"MultiLineString":{e=Wc(s);break}case"MultiPolygon":{e=Xc(s);break}case"GeometryCollection":{e=Qc(s);break}default:throw new Error("Unsupported GeoJSON type: "+s.type)}return e}function Yc(s,t){const e=yn(s);return pn(e,t)}function Qc(s,t){return s.geometries.map(function(i){return yn(i)})}function Vc(s){const t=s.coordinates;return{type:"Point",flatCoordinates:t,layout:fe(t.length)}}function jc(s){var i;const t=s.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:fe(((i=t[0])==null?void 0:i.length)||2)}}function Wc(s){var r,o;const t=s.coordinates,e=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length)||2,i=[],n=un(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:n,layout:fe(e)}}function Kc(s){var e;const t=s.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:fe(((e=t[0])==null?void 0:e.length)||2)}}function Xc(s){var r,o;const t=s.coordinates,e=[],i=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o[0].length)||2,n=Vs(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:n,layout:fe(i)}}function zc(s){var r,o;const t=s.coordinates,e=[],i=(o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length,n=un(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:n,layout:fe(i)}}function $i(s,t){s=yi(s,!0,t);const e=s.getType();let i;switch(e){case"Point":{i=th(s);break}case"LineString":{i=Zc(s);break}case"Polygon":{i=eh(s,t);break}case"MultiPoint":{i=qc(s);break}case"MultiLineString":{i=Hc(s);break}case"MultiPolygon":{i=$c(s,t);break}case"GeometryCollection":{i=Jc(s,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function Jc(s,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:s.getGeometriesArray().map(function(i){return $i(i,t)})}}function Zc(s,t){return{type:"LineString",coordinates:s.getCoordinates()}}function Hc(s,t){return{type:"MultiLineString",coordinates:s.getCoordinates()}}function qc(s,t){return{type:"MultiPoint",coordinates:s.getCoordinates()}}function $c(s,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:s.getCoordinates(e)}}function th(s,t){return{type:"Point",coordinates:s.getCoordinates()}}function eh(s,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:s.getCoordinates(e)}}const tn=65536*65536,Ss=1/tn,ih=12,Rs=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),Pi=0,Ve=1,Ce=2,je=5;class nh{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,e,i=this.length){for(;this.pos<i;){const n=this.readVarint(),r=n>>3,o=this.pos;this.type=n&7,t(r,e,this),this.pos===o&&this.skip(n)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*tn;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*tn;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const e=this.buf;let i,n;return n=e[this.pos++],i=n&127,n<128||(n=e[this.pos++],i|=(n&127)<<7,n<128)||(n=e[this.pos++],i|=(n&127)<<14,n<128)||(n=e[this.pos++],i|=(n&127)<<21,n<128)?i:(n=e[this.pos],i|=(n&15)<<28,sh(i,t,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2===1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=ih&&Rs?Rs.decode(this.buf.subarray(e,t)):ph(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e}readPackedVarint(t=[],e){const i=this.readPackedEnd();for(;this.pos<i;)t.push(this.readVarint(e));return t}readPackedSVarint(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===Ce?this.readVarint()+this.pos:this.pos+1}skip(t){const e=t&7;if(e===Pi)for(;this.buf[this.pos++]>127;);else if(e===Ce)this.pos=this.readVarint()+this.pos;else if(e===je)this.pos+=4;else if(e===Ve)this.pos+=8;else throw new Error(`Unimplemented type: ${e}`)}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;for(;e<this.pos+t;)e*=2;if(e!==this.length){const i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Ss),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Ss),!0),this.pos+=8}writeVarint(t){if(t=+t||0,t>268435455||t<0){rh(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))}writeSVarint(t){this.writeVarint(t<0?-t*2-1:t*2)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(t.length*4),this.pos++;const e=this.pos;this.pos=xh(this.buf,t,this.pos);const i=this.pos-e;i>=128&&Fs(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e),this.realloc(e);for(let i=0;i<e;i++)this.buf[this.pos++]=t[i]}writeRawMessage(t,e){this.pos++;const i=this.pos;t(e,this);const n=this.pos-i;n>=128&&Fs(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n}writeMessage(t,e,i){this.writeTag(t,Ce),this.writeRawMessage(e,i)}writePackedVarint(t,e){e.length&&this.writeMessage(t,lh,e)}writePackedSVarint(t,e){e.length&&this.writeMessage(t,ch,e)}writePackedBoolean(t,e){e.length&&this.writeMessage(t,uh,e)}writePackedFloat(t,e){e.length&&this.writeMessage(t,hh,e)}writePackedDouble(t,e){e.length&&this.writeMessage(t,dh,e)}writePackedFixed32(t,e){e.length&&this.writeMessage(t,Ah,e)}writePackedSFixed32(t,e){e.length&&this.writeMessage(t,fh,e)}writePackedFixed64(t,e){e.length&&this.writeMessage(t,gh,e)}writePackedSFixed64(t,e){e.length&&this.writeMessage(t,mh,e)}writeBytesField(t,e){this.writeTag(t,Ce),this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,je),this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,je),this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,Ve),this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,Ve),this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,Pi),this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,Pi),this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,Ce),this.writeString(e)}writeFloatField(t,e){this.writeTag(t,je),this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,Ve),this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function sh(s,t,e){const i=e.buf;let n,r;if(r=i[e.pos++],n=(r&112)>>4,r<128||(r=i[e.pos++],n|=(r&127)<<3,r<128)||(r=i[e.pos++],n|=(r&127)<<10,r<128)||(r=i[e.pos++],n|=(r&127)<<17,r<128)||(r=i[e.pos++],n|=(r&127)<<24,r<128)||(r=i[e.pos++],n|=(r&1)<<31,r<128))return te(s,n,t);throw new Error("Expected varint not more than 10 bytes")}function te(s,t,e){return e?t*4294967296+(s>>>0):(t>>>0)*4294967296+(s>>>0)}function rh(s,t){let e,i;if(s>=0?(e=s%4294967296|0,i=s/4294967296|0):(e=~(-s%4294967296),i=~(-s/4294967296),e^4294967295?e=e+1|0:(e=0,i=i+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),oh(e,i,t),ah(i,t)}function oh(s,t,e){e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos]=s&127}function ah(s,t){const e=(s&7)<<4;t.buf[t.pos++]|=e|((s>>>=3)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127)))))}function Fs(s,t,e){const i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));e.realloc(i);for(let n=e.pos-1;n>=s;n--)e.buf[n+i]=e.buf[n]}function lh(s,t){for(let e=0;e<s.length;e++)t.writeVarint(s[e])}function ch(s,t){for(let e=0;e<s.length;e++)t.writeSVarint(s[e])}function hh(s,t){for(let e=0;e<s.length;e++)t.writeFloat(s[e])}function dh(s,t){for(let e=0;e<s.length;e++)t.writeDouble(s[e])}function uh(s,t){for(let e=0;e<s.length;e++)t.writeBoolean(s[e])}function Ah(s,t){for(let e=0;e<s.length;e++)t.writeFixed32(s[e])}function fh(s,t){for(let e=0;e<s.length;e++)t.writeSFixed32(s[e])}function gh(s,t){for(let e=0;e<s.length;e++)t.writeFixed64(s[e])}function mh(s,t){for(let e=0;e<s.length;e++)t.writeSFixed64(s[e])}function ph(s,t,e){let i="",n=t;for(;n<e;){const r=s[n];let o=null,a=r>239?4:r>223?3:r>191?2:1;if(n+a>e)break;let l,c,h;a===1?r<128&&(o=r):a===2?(l=s[n+1],(l&192)===128&&(o=(r&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=s[n+1],c=s[n+2],(l&192)===128&&(c&192)===128&&(o=(r&15)<<12|(l&63)<<6|c&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=s[n+1],c=s[n+2],h=s[n+3],(l&192)===128&&(c&192)===128&&(h&192)===128&&(o=(r&15)<<18|(l&63)<<12|(c&63)<<6|h&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),n+=a}return i}function xh(s,t,e){for(let i=0,n,r;i<t.length;i++){if(n=t.charCodeAt(i),n>55295&&n<57344)if(r)if(n<56320){s[e++]=239,s[e++]=191,s[e++]=189,r=n;continue}else n=r-55296<<10|n-56320|65536,r=null;else{n>56319||i+1===t.length?(s[e++]=239,s[e++]=191,s[e++]=189):r=n;continue}else r&&(s[e++]=239,s[e++]=191,s[e++]=189,r=null);n<128?s[e++]=n:(n<2048?s[e++]=n>>6|192:(n<65536?s[e++]=n>>12|224:(s[e++]=n>>18|240,s[e++]=n>>12&63|128),s[e++]=n>>6&63|128),s[e++]=n&63|128)}return e}class yh extends Tr{constructor(t){super(),t=t||{},this.dataProjection=new Sa({code:"",units:"tile-pixels"}),this.featureClass=t.featureClass?t.featureClass:nt,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,i,n){t.pos=e.geometry;const r=t.readVarint()+t.pos;let o=1,a=0,l=0,c=0,h=0,d=0;for(;t.pos<r;){if(!a){const u=t.readVarint();o=u&7,a=u>>3}if(a--,o===1||o===2)l+=t.readSVarint(),c+=t.readSVarint(),o===1&&h>d&&(n.push(h),d=h),i.push(l,c),h+=2;else if(o===7)h>d&&(i.push(i[d],i[d+1]),h+=2);else throw new Error("Invalid command found in the PBF")}h>d&&(n.push(h),d=h)}createFeature_(t,e,i){const n=e.type;if(n===0)return null;let r;const o=e.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=e.id,o[this.layerName_]=e.layer.name;const l=[],c=[];this.readRawGeometry_(t,e,l,c);const h=Sh(n,c.length);if(this.featureClass===nt)r=new this.featureClass(h,l,c,2,o,a),r.transform(i.dataProjection);else{let d;if(h=="Polygon"){const f=Ws(l,c);d=f.length>1?new be(l,"XY",f):new He(l,"XY",c)}else d=h==="Point"?new Vt(l,"XY"):h==="LineString"?new qt(l,"XY"):h==="MultiPoint"?new ke(l,"XY"):h==="MultiLineString"?new Ie(l,"XY",c):null;const u=this.featureClass;r=new u,this.geometryName_&&r.setGeometryName(this.geometryName_);const A=yi(d,!1,i);r.setGeometry(A),a!==void 0&&r.setId(a),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(t,e){const i=this.layers_;e=this.adaptOptions(e);const n=pt(e.dataProjection);n.setWorldExtent(e.extent),e.dataProjection=n;const r=new nh(t),o=r.readFields(Ch,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const c=o[l],h=c?[0,0,c.extent,c.extent]:null;n.setExtent(h);for(let d=0,u=c.length;d<u;++d){const A=wh(r,c,d),f=this.createFeature_(r,A,e);f!==null&&a.push(f)}}return a}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}}function Ch(s,t,e){if(s===3){const i={keys:[],values:[],features:[]},n=e.readVarint()+e.pos;e.readFields(_h,i,n),i.length=i.features.length,i.length&&(t[i.name]=i)}}function _h(s,t,e){if(s===15)t.version=e.readVarint();else if(s===1)t.name=e.readString();else if(s===5)t.extent=e.readVarint();else if(s===2)t.features.push(e.pos);else if(s===3)t.keys.push(e.readString());else if(s===4){let i=null;const n=e.readVarint()+e.pos;for(;e.pos<n;)s=e.readVarint()>>3,i=s===1?e.readString():s===2?e.readFloat():s===3?e.readDouble():s===4?e.readVarint64():s===5?e.readVarint():s===6?e.readSVarint():s===7?e.readBoolean():null;t.values.push(i)}}function Eh(s,t,e){if(s==1)t.id=e.readVarint();else if(s==2){const i=e.readVarint()+e.pos;for(;e.pos<i;){const n=t.layer.keys[e.readVarint()],r=t.layer.values[e.readVarint()];t.properties[n]=r}}else s==3?t.type=e.readVarint():s==4&&(t.geometry=e.pos)}function wh(s,t,e){s.pos=t.features[e];const i=s.readVarint()+s.pos,n={layer:t,type:0,properties:{}};return s.readFields(Eh,n,i),n}function Sh(s,t){let e;return s===1?e=t===1?"Point":"MultiPoint":s===2?e=t===1?"LineString":"MultiLineString":s===3&&(e="Polygon"),e}let kt;xi.subscribe(s=>kt=s);const Cn={1:"#7885BB",2:"#84CD8C",3:"#F5A881",4:"#7AC0E7",5:"#B086E4",6:"#CE9168",7:"#A1A56E",8:"#EA73A3",9:"#D9C593",10:"#71B1E6",11:"#ABD7C4",12:"#91D5C0",13:"#A5CFE9",14:"#C4E29E",15:"#F2E374",16:"#CD7984",17:"#D2D087",18:"#BCA468",19:"#A8D6A5",20:"#FABF78",21:"#A4BDDE",22:"#F8C67E",23:"#66BCB9",24:"#E98D9D",25:"#66CBB3",26:"#FFD066",27:"#65AC91",28:"#F6A665",29:"#B4D992",30:"#D7BA66",31:"#7AB1E0",32:"#B79DCC",33:"#909FC4",34:"#6698C9"},Rh={1:Y.exit1,2:Y.exit2,3:Y.exit3,4:Y.exit4,5:Y.exit5,6:Y.exit6,7:Y.exit7,8:Y.exit8,9:Y.exit9,10:Y.exit10,11:Y.exit11,12:Y.exit12,13:Y.exit13,14:Y.exit14,15:Y.exit15,16:Y.exit16,17:Y.exit17,18:Y.exit18,19:Y.exit19,20:Y.exit20,21:Y.exit21,22:Y.exit22,23:Y.exit23,"2-1":Y.exit2_1,"3-1":Y.exit3_1,"4-1":Y.exit4_1,"7-1":Y.exit7_1,"8-1":Y.exit8_1,"8-2":Y.exit8_2,"9-1":Y.exit9_1},_n=new xn,Fh=new Wt({source:new jt({format:_n,url:Da}),style:function(s){if(!kt)return;const t=kt.getView().getZoom();if(t&&t>=15){const e=Cn[s.get("line_id")];return new $({stroke:new Jt({color:e,width:1.5})})}else return},zIndex:2,updateWhileAnimating:!0,updateWhileInteracting:!0}),br=new jt,vr=new jt;fetch(Ba).then(s=>s.json()).then(s=>{_n.readFeatures(s).forEach(e=>{br.addFeature(e);const i=e.get("center");if(i){const n=new wt({geometry:new Vt(i.coordinates),name:e.get("name"),color:Cn[e.get("line_id")]});vr.addFeature(n)}})}).catch(s=>console.error("Error loading GeoJSON data:",s));const Th=new Wt({source:br,style:function(s){if(!kt)return;const t=kt.getView().getZoom();if(t&&t>=15.8){const e=Cn[s.get("line_id")];return new $({fill:new it({color:e})})}else return},zIndex:4,updateWhileAnimating:!0,updateWhileInteracting:!0}),Ih=new Wt({source:vr,style:function(s){if(!kt)return;const t=kt.getView().getZoom();if(!(!t||t<15))return t<15.8?new $({image:new sr({radius:4,fill:new it({color:"white"}),stroke:new Jt({color:s.get("color"),width:1.5})}),text:new gt({font:'600 14px "Pretendard Variable"',textBaseline:"top",offsetY:8,fill:new it({color:"#25272A"}),stroke:new Jt({color:"white",width:3}),text:s.get("name")})}):new $({text:new gt({font:'600 14px "Pretendard Variable"',textBaseline:"top",offsetY:8,fill:new it({color:"#25272A"}),stroke:new Jt({color:"white",width:3}),text:s.get("name")})})},zIndex:6,updateWhileAnimating:!0,updateWhileInteracting:!0,declutter:!0}),Gi={},bh=new Wt({source:new jt({format:_n,url:ka}),style:function(s){if(!kt)return;const t=kt.getView().getZoom();if(t&&t>=16.2){const e=s.get("id");return Gi[e]||(Gi[e]=new $({image:new Ae({src:Rh[s.get("name")],scale:.75})})),Gi[e]}else return},zIndex:5,updateWhileAnimating:!0,updateWhileInteracting:!0}),vh="data:image/svg+xml,%3csvg%20width='8'%20height='8'%20viewBox='0%200%208%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='4'%20cy='4'%20r='3.5'%20fill='white'%20stroke='%2325272A'%20/%3e%3ccircle%20cx='4'%20cy='4'%20r='1.5'%20fill='%2325272A'%20stroke='%2325272A'%20/%3e%3c/svg%3e",Lh="data:image/svg+xml,%3csvg%20width='6'%20height='6'%20viewBox='0%200%206%206'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='3'%20cy='3'%20r='2.5'%20transform='matrix(1%200%200%20-1%200%206)'%20fill='white'%20stroke='%2325272A'%20/%3e%3c/svg%3e";let en;xi.subscribe(s=>en=s);const Mt=new Jt({color:"white",width:1}),Dh=new jt({format:new xn,url:s=>`${fn}/wfs?service=WFS&version=2.0.0&request=GetFeature&typename=bluedot:base_administrative&srsName=EPSG%3A900913&outputFormat=application%2Fjson&exceptions=application%2Fjson&bbox=${s.join(",")},EPSG:900913`,strategy:mr}),Bh=new xr({source:Dh,distance:80,createCluster:(s,t)=>t.length<=1?t[0]:t.sort((i,n)=>i.get("labelrank")-n.get("labelrank"))[0]}),kh=new Wt({source:Bh,style:function(s){if(!en)return;const t=en.getView().getZoom();if(!t||t<6)return;const e=s.get("labelrank"),i=s.get("alias")??s.get("name_ko");if(e===1)return t>=6&&t<7.5?new $({text:new gt({font:'700 14px "Pretendard Variable"',fill:new it({color:"#25272A"}),stroke:Mt,text:i}),zIndex:10}):void 0;if(e===2){const n=s.get("capital");return t>=6&&t<11?new $({text:new gt({font:`600 ${t<8?"12":"16"}px "Pretendard Variable"`,textAlign:"left",offsetX:7,fill:new it({color:"#25272A"}),stroke:Mt,text:i}),image:n?new Ae({src:vh,width:8}):void 0,zIndex:9}):void 0}else if(e===3){const n=s.get("metropolitan");return t>=7.5&&t<11?new $({text:new gt({font:`600 ${t<8?"10":"14"}px "Pretendard Variable"`,textBaseline:"bottom",offsetY:-5,fill:new it({color:"#4B5362"}),stroke:Mt,text:i}),image:n?new Ae({src:Lh,width:6}):void 0,zIndex:8}):void 0}else return e===4?t>=8&&t<9?new $({text:new gt({font:'600 12px "Pretendard Variable"',fill:new it({color:"#778195"}),stroke:Mt,text:i}),zIndex:7}):void 0:e===5?t>=9&&t<14?new $({text:new gt({font:`600 ${t<11?"12":"14"}px "Pretendard Variable"`,fill:new it({color:"#8690A2"}),stroke:Mt,text:i}),zIndex:6}):void 0:e===6?t>=11&&t<14?new $({text:new gt({font:'600 14px "Pretendard Variable"',fill:new it({color:"#8690A2"}),stroke:Mt,text:i}),zIndex:5}):void 0:e===7?t>=14&&t<17.1?new $({text:new gt({font:`600 ${t<13?"10":"12"}px "Pretendard Variable"`,fill:new it({color:"#8690A2"}),stroke:Mt,text:i}),zIndex:4}):void 0:e===8&&t>=15&&t<17.1?new $({text:new gt({font:'600 10px "Pretendard Variable"',fill:new it({color:"#8690A2"}),stroke:Mt,text:i}),zIndex:3}):void 0},zIndex:3,renderBuffer:100}),Lr=new $({fill:new it({color:"#DAEEFF"}),stroke:new Jt({color:"#D1E9FC",width:1})}),Oh=new oc({source:new vl({format:new yh,url:Oa}),minZoom:17,zIndex:1,renderMode:"vector",style:Lr}),Ph=new Wt({source:new jt({format:new xn,url:s=>`${fn}/wfs?service=WFS&version=2.0.0&request=GetFeature&typename=bluedot:base_building_big&srsName=EPSG%3A900913&outputFormat=application%2Fjson&exceptions=application%2Fjson&bbox=${s[0]}%2C${s[1]}%2C${s[2]}%2C${s[3]}%2CEPSG%3A900913`,strategy:mr}),minZoom:16,maxZoom:17,zIndex:1,updateWhileAnimating:!0,updateWhileInteracting:!0,style:Lr}),Gh={SELECT:"select"};class Mh extends zs{constructor(t,e,i,n){super(t),this.selected=e,this.deselected=i,this.mapBrowserEvent=n}}const We={};class En extends Ra{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:Fa,this.addCondition_=t.addCondition?t.addCondition:Zn,this.removeCondition_=t.removeCondition?t.removeCondition:Zn,this.toggleCondition_=t.toggleCondition?t.toggleCondition:Ta,this.multi_=t.multi?t.multi:!1,this.filter_=t.filter?t.filter:zi,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=t.style!==void 0?t.style:Uh(),this.features_=t.features||new Xs;let e;if(t.layers)if(typeof t.layers=="function")e=t.layers;else{const i=t.layers;e=function(n){return i.includes(n)}}else e=zi;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[N(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[N(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(se.ADD,this.boundAddFeature_),this.features_.addEventListener(se.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(se.ADD,this.boundAddFeature_),this.features_.removeEventListener(se.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const i=this.getMap().getAllLayers().find(function(n){if(n instanceof Wt&&n.getSource()&&n.getSource().hasFeature(e))return n});i&&this.addFeatureLayerAssociation_(e,i)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}getStyle(){return this.style_}applySelectedStyle_(t){const e=N(t);e in We||(We[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let n=e.length-1;n>=0;--n){const r=e[n];if(r!==this&&r instanceof En&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(r.getStyle());return}}const i=N(t);t.setStyle(We[i]),delete We[i]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[N(t)]}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),r=!e&&!i&&!n,o=t.map,a=this.getFeatures(),l=[],c=[];if(r){Ia(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,(h,d)=>{if(!(!(h instanceof wt)||!this.filter_(h,d)))return this.addFeatureLayerAssociation_(h,d),c.push(h),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=a.getLength()-1;h>=0;--h){const d=a.item(h),u=c.indexOf(d);u>-1?c.splice(u,1):(a.remove(d),l.push(d))}c.length!==0&&a.extend(c)}else{o.forEachFeatureAtPixel(t.pixel,(h,d)=>{if(!(!(h instanceof wt)||!this.filter_(h,d)))return(e||n)&&!a.getArray().includes(h)?(this.addFeatureLayerAssociation_(h,d),c.push(h)):(i||n)&&a.getArray().includes(h)&&(l.push(h),this.removeFeatureLayerAssociation_(h)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let h=l.length-1;h>=0;--h)a.remove(l[h]);a.extend(c)}return(c.length>0||l.length>0)&&this.dispatchEvent(new Mh(Gh.SELECT,c,l,t)),!0}}function Uh(){const s=ba();return yt(s.Polygon,s.LineString),yt(s.GeometryCollection,s.LineString),function(t){return t.getGeometry()?s[t.getGeometry().getType()]:null}}const Nh=`<svg width="50" height="58" viewBox="0 0 50 58" fill="none" xmlns="http://www.w3.org/2000/svg"
  xmlns:xlink="http://www.w3.org/1999/xlink">
  <g filter="url(#filter0_d_1215_8322)">
    <path fill-rule="evenodd" clip-rule="evenodd"
      d="M43 24.0345C43 25.4836 42.8384 26.8948 42.5322 28.2511C39.9336 41.6768 27.2737 51.0001 24 51.0001C20.7263 51.0001 8.06645 41.6768 5.46782 28.2511C5.16163 26.8948 5 25.4836 5 24.0345C5 23.9377 5.00072 23.8411 5.00216 23.7447C5.00072 23.6356 5 23.5263 5 23.4167H5.00982C5.33529 13.1902 13.7129 5 24 5C34.2871 5 42.6647 13.1902 42.9902 23.4167H43C43 23.5263 42.9993 23.6356 42.9978 23.7447C42.9993 23.8411 43 23.9377 43 24.0345Z"
      fill="white" />
    <rect x="8.1665" y="8.17188" width="31.6667" height="31.7241" rx="15.8333"
      fill="#D9D9D9" />
    <rect x="8.1665" y="8.17188" width="31.6667" height="31.7241" rx="15.8333"
      fill="url(#pattern_img)" />
  </g>
  <defs>
    <filter id="filter0_d_1215_8322" x="0" y="0" width="50" height="58" filterUnits="userSpaceOnUse"
      color-interpolation-filters="sRGB">
      <feFlood flood-opacity="0" result="BackgroundImageFix" />
      <feColorMatrix in="SourceAlpha" type="matrix"
        values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0" result="hardAlpha" />
      <feOffset dx="1" dy="1" />
      <feGaussianBlur stdDeviation="3" />
      <feComposite in2="hardAlpha" operator="out" />
      <feColorMatrix type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.1 0" />
      <feBlend mode="normal" in2="BackgroundImageFix" result="effect1_dropShadow_1215_8322" />
      <feBlend mode="normal" in="SourceGraphic" in2="effect1_dropShadow_1215_8322" result="shape" />
    </filter>
    <pattern id="pattern_img" width="1" height="1">
      <image width="31.6667" height="31.7241"
        xlink:href="dataURL"
        preserveAspectRatio="xMidYMid slice" />
    </pattern>
  </defs>
</svg>`,Yt=document.createElement("canvas");Yt.style.display="none";const M=Yt.getContext("2d"),Yh="image/jpeg",Dr="image/png",Se=5,nn=1.5;async function Qh(s,t){return new Promise(async(e,i)=>{const n=new Image;n.crossOrigin="anonymous",n.onload=async function(){if(!M)return;const r=t*nn;Yt.width=r,Yt.height=r;const o=(r-Se*2)/2;M.beginPath(),M.arc(r/2,r/2,o,0,2*Math.PI),M.shadowBlur=Se,M.shadowColor="rgba(0, 0, 0, 0.5)",M.shadowOffsetX=1,M.shadowOffsetY=1,M.fill(),M.shadowBlur=0,M.shadowOffsetX=0,M.shadowOffsetY=0,M.clip(),M.drawImage(n,0,0,r,r),M.lineWidth=10,M.strokeStyle="white",M.stroke();const a=Yt.toDataURL(Dr);M.clearRect(0,0,r,r),e(a)},n.src=s})}async function Vh(s){const t=await Wh(s),e=Nh.replace("dataURL",t),i=new Blob([e],{type:"image/svg+xml"});return URL.createObjectURL(i)}async function jh(s,t=204,e=224.4){return new Promise(async(i,n)=>{const r=new Image;r.crossOrigin="anonymous",r.onload=async function(){if(!M)return;t*=nn,e*=nn,Yt.width=t,Yt.height=e;const o=t-Se,a=e-Se,l=o/200,c=a/220;M.beginPath(),M.moveTo(100*l,220*c),M.lineTo(32*l,154*c),M.bezierCurveTo(5*l,128*c,-5*l,76*c,29*l,36*c),M.bezierCurveTo(63*l,-5*c,137*l,-5*c,171*l,36*c),M.bezierCurveTo(205*l,76*c,195*l,128*c,168*l,154*c),M.closePath(),M.shadowBlur=Se,M.shadowColor="rgba(0, 0, 0, 0.5)",M.shadowOffsetX=1,M.shadowOffsetY=1,M.fill(),M.shadowBlur=0,M.shadowOffsetX=0,M.shadowOffsetY=0,M.clip(),M.drawImage(r,0,0,o,a),M.lineWidth=10,M.strokeStyle="white",M.stroke();const h=Yt.toDataURL(Dr);M.clearRect(0,0,t,e),i(h)},r.src=s})}function Wh(s){return new Promise((t,e)=>{const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{const n=document.createElement("canvas"),r=n.getContext("2d");if(!r)return e("context not found");n.width=i.width,n.height=i.height,r.drawImage(i,0,0,i.width,i.height);const o=n.toDataURL(Yh,.3);t(o)},i.onerror=e,i.src=s})}const di="data:image/svg+xml,%3csvg%20width='56'%20height='58'%20viewBox='0%200%2056%2058'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20%3e%3cpath%20d='M43.1568%2038.1549L27.6001%2052.7999L12.0434%2038.1549C8.96671%2035.2584%206.87153%2031.5681%206.02275%2027.5507C5.17397%2023.5332%205.60971%2019.369%207.27487%2015.5847C8.94003%2011.8004%2011.7598%208.5659%2015.3777%206.29023C18.9955%204.01456%2023.249%202.79993%2027.6001%202.79993C31.9512%202.79993%2036.2047%204.01456%2039.8225%206.29023C43.4404%208.5659%2046.2602%2011.8004%2047.9253%2015.5847C49.5905%2019.369%2050.0262%2023.5332%2049.1774%2027.5507C48.3287%2031.5681%2046.2335%2035.2584%2043.1568%2038.1549Z'%20fill='gray'%20shape-rendering='crispEdges'%20/%3e%3cpath%20d='M43.1568%2038.1549L27.6001%2052.7999L12.0434%2038.1549C8.96671%2035.2584%206.87153%2031.5681%206.02275%2027.5507C5.17397%2023.5332%205.60971%2019.369%207.27487%2015.5847C8.94003%2011.8004%2011.7598%208.5659%2015.3777%206.29023C18.9955%204.01456%2023.249%202.79993%2027.6001%202.79993C31.9512%202.79993%2036.2047%204.01456%2039.8225%206.29023C43.4404%208.5659%2046.2602%2011.8004%2047.9253%2015.5847C49.5905%2019.369%2050.0262%2023.5332%2049.1774%2027.5507C48.3287%2031.5681%2046.2335%2035.2584%2043.1568%2038.1549Z'%20stroke='white'%20stroke-width='3'%20shape-rendering='crispEdges'%20/%3e%3c/svg%3e",Br="data:image/svg+xml,%3csvg%20width='50'%20height='58'%20viewBox='0%200%2050%2058'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%20filter='url(%23filter0_d_1215_8322)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M43%2024.0345C43%2025.4836%2042.8384%2026.8948%2042.5322%2028.2511C39.9336%2041.6768%2027.2737%2051.0001%2024%2051.0001C20.7263%2051.0001%208.06645%2041.6768%205.46782%2028.2511C5.16163%2026.8948%205%2025.4836%205%2024.0345C5%2023.9377%205.00072%2023.8411%205.00216%2023.7447C5.00072%2023.6356%205%2023.5263%205%2023.4167H5.00982C5.33529%2013.1902%2013.7129%205%2024%205C34.2871%205%2042.6647%2013.1902%2042.9902%2023.4167H43C43%2023.5263%2042.9993%2023.6356%2042.9978%2023.7447C42.9993%2023.8411%2043%2023.9377%2043%2024.0345Z'%20fill='white'%20/%3e%3crect%20x='8.1665'%20y='8.17188'%20width='31.6667'%20height='31.7241'%20rx='15.8333'%20fill='%23D9D9D9'%20/%3e%3crect%20x='8.1665'%20y='8.17188'%20width='31.6667'%20height='31.7241'%20rx='15.8333'%20fill='url(%23pattern_img)'%20/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_1215_8322'%20x='0'%20y='0'%20width='50'%20height='58'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'%20/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'%20/%3e%3cfeOffset%20dx='1'%20dy='1'%20/%3e%3cfeGaussianBlur%20stdDeviation='3'%20/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'%20/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.1%200'%20/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_1215_8322'%20/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_1215_8322'%20result='shape'%20/%3e%3c/filter%3e%3cpattern%20id='pattern_img'%20width='1'%20height='1'%3e%3cimage%20width='31.6667'%20height='31.7241'%20xlink:href='dataURL'%20preserveAspectRatio='xMidYMid%20slice'%20/%3e%3c/pattern%3e%3c/defs%3e%3c/svg%3e";let mt;xi.subscribe(s=>{mt=s,mt&&(mt.addInteraction(Sn),mt.getView().on("change:resolution",()=>{if(!mt)return;const t=mt.getView().getZoom();if(!t)return;const e=80*(17/t);kr.setDistance(e)}))});const St=new jt({attributions:[],wrapX:!1}),kr=new xr({source:St,distance:80,createCluster:(s,t)=>{const e=t.sort((i,n)=>Number(i.getId())-Number(n.getId()));return new wt({geometry:e[0].getGeometry(),features:e})}}),wn=new Wt({source:kr,zIndex:10,style:Or,renderBuffer:100,updateWhileAnimating:!1,updateWhileInteracting:!0});St.on("change",()=>{St.getState()==="ready"&&wn.changed()});const Kh="iconSelector",Sn=new En({layers:[wn],style:Or});Sn.setProperties({name:Kh});Sn.on("select",s=>{const t=s.mapBrowserEvent.coordinate,e=s.selected[0];let i=null,n=1/0;const r=e.get("features");r.forEach(o=>{var c;const a=(c=o.getGeometry())==null?void 0:c.getCoordinates();if(!a)return;const l=Xh(t,a);l<n&&(i=o,n=l)}),hr((i??r[0]).get("link"))});function Xh(s,t){const e=s[0]-t[0],i=s[1]-t[1];return Math.sqrt(e*e+i*i)}function Or(s){const t=s.get("features"),e=[];let i;for(let n=0;n<t.length;n++){const r=t[n],o=Number(r.getId());if(Number.isNaN(o))continue;const a=r.getGeometry();if(a)if(n===0){if(i=zh(r),r.get("onlyMain")===!0)break}else e.push(new $({image:new sr({radius:3,fill:new it({color:"#3490FF"})}),geometry:a}))}return i&&e.push(i),e}const Ke={};function zh(s){const t=`${s.get("type")}_${s.getId()}`,e=s.get("width"),i=s.get("height");let n;if(!Ke[t]){const r=s.get("image");r&&(n=Hh({shape:s.get("shape"),image:r,width:e,height:i}));const o=s.get("src"),a=new $({image:o?new Ae({src:o,width:e,height:i,displacement:[0,s.get("offsetY")]}):void 0,text:new gt({font:'400 12px/1.8 "Pretendard Variable"',textBaseline:"top",offsetY:-1.75862,fill:new it({color:"#25272A"}),stroke:new Jt({color:"white",width:1.5}),text:s.get("name")})});Ke[t]=a}return n==null||n.then(r=>{Ke[t].setImage(new Ae({src:r,width:e,height:i,displacement:[0,s.get("offsetY")]})),St.changed()}),Ke[t]}async function Jh(s){if(!mt)return;const t=[],e=s.map(async i=>{if(i.idx&&St.getFeatureById(i.idx))return;const n=i.shape==="waterdrop"?di:i.shape==="point"?Br:"";t.push(Pr(i,n))});await Promise.allSettled(e),St.addFeatures(t)}async function Zh(s){if(!mt||s.idx&&St.getFeatureById(s.idx))return;const t=s.shape==="waterdrop"?di:s.shape==="point"?Br:"",e=Pr(s,t);St.addFeature(e)}function Pr(s,t){const e=new wt({width:s.width,height:s.height,offsetY:s.height/2,name:s.name.replace(/(.{8})/g,`$1
`),link:s.link,rank:s.rank,src:t,type:s.type,shape:s.shape,image:s.image,onlyMain:s.onlyMain});if(s.coordinate)e.setGeometry(new Vt(s.coordinate));else if(mt){const i=mt.getView().calculateExtent(mt.getSize()),n=fi(i);e.setGeometry(new Vt(n))}return e.setId(s.idx),e}async function Hh(s){let t;return s.shape==="circle"?t=await Qh(s.image,s.width):s.shape==="waterdrop"?t=s.image===""?di:await jh(s.image,s.width,s.height):s.shape==="point"?t=await Vh(s.image):t=di,t}const Ts=ar("Preferences",{web:()=>dr(()=>import("./web.CE-hvQjn.js"),__vite__mapDeps([0,1,2,3,4]),import.meta.url).then(s=>new s.PreferencesWeb)});function qh(s){s.CapacitorUtils.Synapse=new Proxy({},{get(t,e){return new Proxy({},{get(i,n){return(r,o,a)=>{const l=s.Capacitor.Plugins[e];if(l===void 0){a(new Error(`Capacitor plugin ${e} not found`));return}if(typeof l[n]!="function"){a(new Error(`Method ${n} not found in Capacitor plugin ${e}`));return}(async()=>{try{const c=await l[n](r);o(c)}catch(c){a(c)}})()}}})}})}function $h(s){s.CapacitorUtils.Synapse=new Proxy({},{get(t,e){return s.cordova.plugins[e]}})}function td(s=!1){window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!s?qh(window):window.cordova!==void 0&&$h(window)}const Is=ar("Geolocation",{web:()=>dr(()=>import("./web.CEId339_.js"),__vite__mapDeps([5,1,2,3,4]),import.meta.url).then(s=>new s.GeolocationWeb)});td();let Mi={latitude:0,longitude:0,accuracy:0,altitudeAccuracy:void 0,altitude:null,speed:null,heading:null};class Gr{static async getCurrentOrLastLocation(){const t=Pa.isNativePlatform()?await this.checkAndRequestGeolocationPermission():{location:"granted"};if((t==null?void 0:t.location)==="granted")try{const e=await Is.getCurrentPosition({maximumAge:2e3}),{latitude:i,longitude:n,accuracy:r,altitudeAccuracy:o,altitude:a,speed:l,heading:c}=e.coords;return Mi={latitude:i,longitude:n,accuracy:r,altitudeAccuracy:o,altitude:a,speed:l,heading:c},this.saveLastKnownLocation(Mi),Mi}catch(e){return console.warn(e),this.getLastKnownLocation()}else return this.getLastKnownLocation()}static async checkAndRequestGeolocationPermission(){try{return await Is.requestPermissions({permissions:["location"]})}catch{return null}}static saveLastKnownLocation(t){Ts.set({key:this.LAST_LOCATION_KEY,value:JSON.stringify(t)})}static async getLastKnownLocation(){const{value:t}=await Ts.get({key:this.LAST_LOCATION_KEY});return t?JSON.parse(t):null}}Gn(Gr,"LAST_LOCATION_KEY","last_known_location");new rr({source:new Dl,zIndex:99});const ed=new Bl({url:`${fn}/wms`,params:{LAYERS:"bluedot:v3_base",FORMAT:"image/png8",TRANSPARENT:!0,TILED:!0}}),id=new rr({source:ed,zIndex:0,preload:1/0}),Pe=new va({projection:"EPSG:3857",center:ri([126.97685,37.578019]),zoom:16,minZoom:2,maxZoom:22}),Mr=document.createElement("img");Mr.src=Ua;const Ur=new or({id:0,element:Mr,positioning:"center-center",stopEvent:!1}),Nr=document.createElement("img");Nr.src=Na;const nd=new or({id:1,element:Nr,positioning:"bottom-center",stopEvent:!1,offset:[0,7]}),ft=new La({layers:[id,Ph,Oh,Fh,bh,Ih,Th,kh,wn],overlays:[Ur,nd],view:Pe,controls:[]});xi.set(ft);xt.on("setTo",Yr);function Yr(s){Pe.setCenter(s)}xt.on("setToCurrentPosition",()=>Qr(Yr));async function Qr(s){const t=await Gr.getCurrentOrLastLocation();if(t){const e=ri([t.longitude,t.latitude]);s(e),Ur.setPosition(e)}else console.log("No location available")}xt.on("flyTo",Vr);function Vr(s){Pe.animate({center:s})}xt.on("flyToCurrentPosition",()=>Qr(Vr));xt.on("setZoom",sd);function sd(s){Pe.setZoom(s)}xt.on("addIcon",rd);function rd(s){Zh(s)}xt.on("addIcons",od);function od(s){Jh(s)}function ad(s){Pe.animate(s)}async function ld(s,t={},e,i){const n=e||new AbortController;let r;try{return await fetch(s.href,{...t,signal:n.signal})}catch(o){throw o.name==="AbortError"&&console.error("Request timed out"),o}}async function cd({tags:s,bbox:t,abortController:e,offset:i=0,limit:n=100}){const r=new URL(`${lr}/embeddings/explore`);r.searchParams.append("tags",s),r.searchParams.append("bbox",t),i&&r.searchParams.append("offset",String(i)),n&&r.searchParams.append("limit",String(n));try{return(await(await ld(r,{headers:{"x-api-version":cr.EMBEDDING}},e||void 0)).json()).data}catch(o){return o!=="new request"&&console.error(o),[]}}function hd(s,t=500,e=10){let i,n,r;const o=c=>{if("TouchEvent"in window&&c instanceof TouchEvent&&c.touches.length>=2)return clearTimeout(i);const{clientX:h,clientY:d}=c instanceof MouseEvent?c:c.touches[0];n=h,r=d,i=setTimeout(()=>{s.dispatchEvent(new CustomEvent("longpress",{detail:c}))},t)},a=c=>{if("TouchEvent"in window&&c instanceof TouchEvent&&c.touches.length>=2)return clearTimeout(i);const{clientX:h,clientY:d}=c instanceof MouseEvent?c:c.touches[0],u=Math.abs(h-n),A=Math.abs(d-r);(u>e||A>e)&&clearTimeout(i)},l=()=>{clearTimeout(i)};return s.addEventListener("mousedown",o),s.addEventListener("mousemove",a),s.addEventListener("mouseup",l),s.addEventListener("mouseleave",l),s.addEventListener("touchstart",o),s.addEventListener("touchmove",a),s.addEventListener("touchend",l),s.addEventListener("touchcancel",l),{destroy(){s.removeEventListener("mousedown",o),s.removeEventListener("mousemove",a),s.removeEventListener("mouseup",l),s.removeEventListener("mouseleave",l),s.removeEventListener("touchstart",o),s.removeEventListener("touchmove",a),s.removeEventListener("touchend",l),s.removeEventListener("touchcancel",l)}}}function dd(s){if(!s||!s.includes("youtu"))return null;let t=null;return s.includes("watch?v=")?t=s.split("watch?v=")[1].split("&")[0]:s.includes("embed")?t=s.split("embed/")[1].split("?")[0]:s.includes("shorts")&&(t=s.split("shorts/")[1].split("?")[0]),t}function ud(s,t="default"){return s.includes("youtu")?`https://img.youtube.com/vi/${dd(s)}/${t}.jpg`:s}function Ui(s,t){if(!s)return"";if(typeof s!="string"&&(s=s[0]||""),String(s).includes("youtu"))return ud(s,"hqdefault");if(!String(s).includes("bluedot-media"))return s;const e=s.split("/").at(-1);return t?`${Hn}/resize?key=${e}&side=${t}`:`${Hn}/${e}`}async function Ad(s){try{const e=(await fetch(s,{method:"HEAD"})).headers.get("Content-Type");return e?e.startsWith("video/"):!1}catch(t){return console.error("Error checking file type:",t),!1}}function fd(s){let t,e,i,n;const r=s[8].default,o=vs(r,s,s[7],null);return{c(){t=j("div"),o&&o.c(),this.h()},l(a){t=W(a,"DIV",{id:!0,class:!0});var l=z(t);o&&o.l(l),l.forEach(G),this.h()},h(){O(t,"id","map"),O(t,"class","absolute w-full h-full z-[1] bg-[#BDDBF3] transition-transform duration-500"),Vn(t,"transform",`translateY(${s[1]}px)`)},m(a,l){H(a,t,l),o&&o.m(t,null),s[9](t),e=!0,i||(n=[so(hd.call(null,t,500)),ot(t,"longpress",s[10])],i=!0)},p(a,[l]){o&&o.p&&(!e||l&128)&&Ls(o,r,a,a[7],e?Bs(r,a[7],l,null):Ds(a[7]),null),l&2&&Vn(t,"transform",`translateY(${a[1]}px)`)},i(a){e||(Re(o,a),e=!0)},o(a){Fe(o,a),e=!1},d(a){a&&G(t),o&&o.d(a),s[9](null),i=!1,rn(n)}}}function bs(s){s.preventDefault()}function gd(s,t,e){let i;ro(s,Ga,x=>e(5,i=x));let{$$slots:n={},$$scope:r}=t,{onSelect:o=()=>{}}=t,{onMoveend:a=()=>{}}=t,{mapY:l=0}=t,{allowEdit:c=!0}=t,{whenCancelEdit:h=()=>{}}=t;St.refresh(),xt.on("explorePlaces",A);let d="",u;async function A(){var x;if(!(ft.getView().getZoom()<16))try{u&&u.abort("new request");const _=(x=window.location.search.split("tags=")[1])==null?void 0:x.split("&")[0];if(!_)return;const w=decodeURIComponent(_);if(!w)return;d!==w&&(St.refresh(),d=w),u=new AbortController;const R=await cd({tags:d,bbox:Li(ft.getView().calculateExtent(),"EPSG:3857","EPSG:4326").join(),abortController:u});xt.emit("addIcons",R.map(I=>({idx:I.idx,coordinate:ri(I.location.replace("POINT(","").replace(")","").split(" ").map(Number)),image:Ui(I.thumbnail,500)||"",shape:"point",type:"place",link:`/places/${I.idx}`,rank:3,name:I.name,width:38,height:46,onlyMain:!0})))}catch(_){(_==null?void 0:_.name)==="AbortError"?console.log("이전 explorePlaces 요청이 취소되었습니다."):console.error("explorePlaces 중 에러 발생:",_)}}ft.on("moveend",f);function f(){var x,_;A(),Ma({location:((x=ft.getView().getCenter())==null?void 0:x.join(","))??"",zoom:((_=ft.getView().getZoom())==null?void 0:_.toFixed(2))??""}),a(Li(ft.getView().calculateExtent(),"EPSG:3857","EPSG:4326").join())}A();let g;on(()=>{ft.setTarget(g),g.addEventListener("contextmenu",bs),i.url.searchParams.has("location")&&p(),i.url.searchParams.has("placeIdx")&&y(i.url.searchParams.get("placeIdx")),a(Li(ft.getView().calculateExtent(),"EPSG:3857","EPSG:4326").join())}),Ps(()=>{ft.un("moveend",f),g.removeEventListener("contextmenu",bs)});function p(){const x=i.url.searchParams.get("location"),_=i.url.searchParams.get("zoom"),w=x==null?void 0:x.split(",").map(Number),R={};w&&(R.center=w),_&&(R.zoom=Number(_)),Object.values(R).length>0&&ad(R)}xt.on("addIconByPlaceIdx",y);async function y(x){var I;const _=await fetch(`${lr}/places/${x}`,{headers:{"x-api-version":cr.PLACE}}).then(T=>T.json()).then(T=>T.data.place).catch(T=>{console.error(T)});let w=((I=_.thumbnail)==null?void 0:I.at(0))||"";if(!String(w).includes("youtu")){const T=Ui(w);await Ad(T)&&(w=w+"-thumbnail")}const R={idx:_.placeIdx,coordinate:ri([_.longitude,_.latitude]),image:Ui(w,500)||"",shape:"point",type:"place",link:`/places/${_.placeIdx}`,rank:5,name:_.name,width:38,height:46};xt.emit("addIcon",R)}function m(x){Xe[x?"unshift":"push"](()=>{g=x,e(4,g)})}const C=x=>{if(!c)return h();if(!i.url.pathname.startsWith("/map"))return;const _=ft.getEventCoordinate(x.detail);i.url.pathname!=="/map/edit"?hr(`/map/edit?location=${_.join()}`):o(_)};return s.$$set=x=>{"onSelect"in x&&e(0,o=x.onSelect),"onMoveend"in x&&e(6,a=x.onMoveend),"mapY"in x&&e(1,l=x.mapY),"allowEdit"in x&&e(2,c=x.allowEdit),"whenCancelEdit"in x&&e(3,h=x.whenCancelEdit),"$$scope"in x&&e(7,r=x.$$scope)},[o,l,c,h,g,i,a,r,n,m,C]}let vd=class extends Le{constructor(t){super(),De(this,t,gd,fd,ve,{onSelect:0,onMoveend:6,mapY:1,allowEdit:2,whenCancelEdit:3})}};export{Id as I,vd as M,Ui as s};
