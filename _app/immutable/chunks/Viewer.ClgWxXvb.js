import{s as oe,D as se,i as L,f as p,e as D,a as j,t as _e,c as M,b as A,g as F,d as be,v as h,h as w,y as z,j as Le,x as ee,O as He,C as $,n as J,q as Ce,r as xe,E as Se,F as ve,ac as Ge,B as At,J as Ue,z as De,A as Oe,L as St,N as nt,k as bl,w as vl,G as wl,I as kl}from"./scheduler.CbwPF6wx.js";import{S as fe,i as ue,t as y,g as te,a as R,d as le,c as H,b as Z,m as G,e as W,f as Re}from"./index.DiLw73rm.js";import{e as de,u as We,f as Cl,o as Lt}from"./each.CXq2Zfzp.js";import{A as Ae}from"./store.CPTkvk8U.js";import{g as Ze}from"./entry.CYhhIJ0e.js";import{p as xl}from"./stores.Do8LutLq.js";import{e as ge,C as Il}from"./emitter.BcHy5OTs.js";import{g as Xe,u as El}from"./searchParams.lYxsupce.js";/* empty css                                           *//* empty css                                                  */import{f as yl,u as Tl}from"./follow.CbL3tkgA.js";import{a as Me,b as Nt,g as Ye,i as st}from"./sign.BcpGJUxZ.js";import{C as Dl}from"./CircleImage.S7F7_7k5.js";import{g as it}from"./color.C_Jm4JAr.js";import{s as rt}from"./s32cloudfront.DjPWYYa3.js";import{r as Ie}from"./units.BJZU6p1c.js";import"./ActionSheet.svelte_svelte_type_style_lang.BvWcrwq5.js";import"./index.D4TUq_wN.js";import{a as Ml}from"./NavigationBar.CO7Wh7xX.js";import{C as qt}from"./Chip.6-PdHg3v.js";import{B as Vl}from"./BottomNavigationPadder.BR6eHBA2.js";import{I as Bl,a as Pl}from"./IconHeartFill.Da6WXsfi.js";import{l as Ol}from"./longPress.C9F0mLoM.js";import{w as Rl,a as Al}from"./Header.BOnL5d1B.js";import{A as jt}from"./ActionSheet.DHoVty9l.js";import{M as Sl}from"./Modal.DY_WW6ab.js";import{f as Ll,c as Nl,a as ql}from"./ActionSheetReport.svelte_svelte_type_style_lang.BwjDeOaq.js";import{F as jl}from"./Figure.BrifxCAH.js";import{I as Fl}from"./IconLink.BCnKa0tU.js";function at(n){let e,t,l,s,a,o,i=n[0].unique_name+"",r,f,u,g=String(n[0].user_idx)!==String(Me()),v,E,B;const _=[Yl,Ul],d=[];function m(T,I){return T[0].profile_image_url?0:1}t=m(n),l=d[t]=_[t](n);let k=g&&ot(n);return{c(){e=D("div"),l.c(),s=j(),a=D("div"),o=D("div"),r=_e(i),f=j(),u=D("div"),k&&k.c(),this.h()},l(T){e=M(T,"DIV",{class:!0});var I=A(e);l.l(I),s=F(I),a=M(I,"DIV",{class:!0});var x=A(a);o=M(x,"DIV",{class:!0});var U=A(o);r=be(U,i),U.forEach(p),f=F(x),u=M(x,"DIV",{class:!0});var P=A(u);k&&k.l(P),P.forEach(p),x.forEach(p),I.forEach(p),this.h()},h(){h(o,"class","text-sm text-white"),h(u,"class","flex gap-1 items-center"),h(a,"class","flex gap-1 items-center"),h(e,"class","flex gap-[0.625rem] justify-center items-center")},m(T,I){L(T,e,I),d[t].m(e,null),w(e,s),w(e,a),w(a,o),w(o,r),w(a,f),w(a,u),k&&k.m(u,null),v=!0,E||(B=z(o,"click",n[5]),E=!0)},p(T,I){let x=t;t=m(T),t===x?d[t].p(T,I):(te(),R(d[x],1,1,()=>{d[x]=null}),le(),l=d[t],l?l.p(T,I):(l=d[t]=_[t](T),l.c()),y(l,1),l.m(e,s)),(!v||I&1)&&i!==(i=T[0].unique_name+"")&&Le(r,i),I&1&&(g=String(T[0].user_idx)!==String(Me())),g?k?k.p(T,I):(k=ot(T),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},i(T){v||(y(l),v=!0)},o(T){R(l),v=!1},d(T){T&&p(e),d[t].d(),k&&k.d(),E=!1,B()}}}function Ul(n){var i;let e,t,l=(((i=n[0].unique_name)==null?void 0:i.at(0))??"u")+"",s,a,o;return{c(){e=D("div"),t=D("span"),s=_e(l),this.h()},l(r){e=M(r,"DIV",{class:!0,style:!0});var f=A(e);t=M(f,"SPAN",{class:!0});var u=A(t);s=be(u,l),u.forEach(p),f.forEach(p),this.h()},h(){h(t,"class","text-base font-semibold text-black"),h(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),$(e,"background-color",it(n[0].unique_name))},m(r,f){L(r,e,f),w(e,t),w(t,s),a||(o=z(e,"click",n[4]),a=!0)},p(r,f){var u;f&1&&l!==(l=(((u=r[0].unique_name)==null?void 0:u.at(0))??"u")+"")&&Le(s,l),f&1&&$(e,"background-color",it(r[0].unique_name))},i:J,o:J,d(r){r&&p(e),a=!1,o()}}}function Yl(n){let e,t;return e=new Dl({props:{src:rt(n[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",n[3]),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.src=rt(l[0].profile_image_url,500)),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function ot(n){let e,t="•",l,s,a=n[0].is_following?"팔로잉":"팔로우",o,i,r,f;return{c(){e=D("div"),e.textContent=t,l=j(),s=D("div"),o=_e(a),this.h()},l(u){e=M(u,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-168vif2"&&(e.textContent=t),l=F(u),s=M(u,"DIV",{class:!0});var g=A(s);o=be(g,a),g.forEach(p),this.h()},h(){h(e,"class","text-xs text-white/60"),h(s,"class",i=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(u,g){L(u,e,g),L(u,l,g),L(u,s,g),w(s,o),r||(f=z(s,"click",function(){He(n[0].is_following?n[2]:n[1])&&(n[0].is_following?n[2]:n[1]).apply(this,arguments)}),r=!0)},p(u,g){n=u,g&1&&a!==(a=n[0].is_following?"팔로잉":"팔로우")&&Le(o,a),g&1&&i!==(i=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&h(s,"class",i)},d(u){u&&(p(e),p(l),p(s)),r=!1,f()}}}function zl(n){let e,t,l=n[0].idx&&n[0].unique_name&&at(n);return{c(){l&&l.c(),e=se()},l(s){l&&l.l(s),e=se()},m(s,a){l&&l.m(s,a),L(s,e,a),t=!0},p(s,[a]){s[0].idx&&s[0].unique_name?l?(l.p(s,a),a&1&&y(l,1)):(l=at(s),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(te(),R(l,1,1,()=>{l=null}),le())},i(s){t||(y(l),t=!0)},o(s){R(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function Xl(n,e,t){let{post:l}=e,s=!1;async function a(){s||(s=!0,await yl({targetIdx:l.user_idx,subjectIdx:Me()}),t(0,l.is_following=!0,l),s=!1)}async function o(){s||(s=!0,await Tl({targetIdx:l.user_idx,subjectIdx:Me()}),t(0,l.is_following=!1,l),s=!1)}const i=()=>{Xe(`/users/${l.user_idx}`)},r=()=>{Xe(`/users/${l.user_idx}`)},f=()=>{Xe(`/users/${l.user_idx}`)};return n.$$set=u=>{"post"in u&&t(0,l=u.post)},[l,a,o,i,r,f]}class Hl extends fe{constructor(e){super(),ue(this,e,Xl,zl,oe,{post:0})}}function Zl(n){let e,t,l,s;return{c(){e=Ce("svg"),t=Ce("path"),l=Ce("path"),this.h()},l(a){e=xe(a,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var o=A(e);t=xe(o,"path",{d:!0,fill:!0}),A(t).forEach(p),l=xe(o,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),A(l).forEach(p),o.forEach(p),this.h()},h(){h(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),h(t,"fill",n[0]),h(l,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),h(l,"stroke",n[1]),h(l,"stroke-width","2"),h(l,"stroke-linejoin","round"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width",n[2]),h(e,"height",n[2]),h(e,"viewBox",s="0 0 "+n[2]+" "+n[2]),h(e,"fill","none")},m(a,o){L(a,e,o),w(e,t),w(e,l)},p(a,[o]){o&1&&h(t,"fill",a[0]),o&2&&h(l,"stroke",a[1]),o&4&&h(e,"width",a[2]),o&4&&h(e,"height",a[2]),o&4&&s!==(s="0 0 "+a[2]+" "+a[2])&&h(e,"viewBox",s)},i:J,o:J,d(a){a&&p(e)}}}function Gl(n,e,t){let l,{fill:s="#FF4F1E"}=e,{stroke:a="#FF4F1E"}=e,{length:o=1.5}=e;return n.$$set=i=>{"fill"in i&&t(0,s=i.fill),"stroke"in i&&t(1,a=i.stroke),"length"in i&&t(3,o=i.length)},n.$$.update=()=>{n.$$.dirty&8&&t(2,l=Ie(o))},[s,a,l,o]}class Wl extends fe{constructor(e){super(),ue(this,e,Gl,Zl,oe,{fill:0,stroke:1,length:3})}}function ze(n){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const s=a=>a.stopPropagation();return n.addEventListener(l,s),{event:l,handler:s}});return{destroy(){t.forEach(({event:l,handler:s})=>{n.removeEventListener(l,s)})}}}function ft(n){let e,t;return e=new qt({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Ml,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:n[0].name}}),e.$on("click",n[1]),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.value=l[0].name),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Jl(n){let e,t,l=n[0].idx&&ft(n);return{c(){l&&l.c(),e=se()},l(s){l&&l.l(s),e=se()},m(s,a){l&&l.m(s,a),L(s,e,a),t=!0},p(s,[a]){s[0].idx?l?(l.p(s,a),a&1&&y(l,1)):(l=ft(s),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(te(),R(l,1,1,()=>{l=null}),le())},i(s){t||(y(l),t=!0)},o(s){R(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function Kl(n,e,t){let{place:l}=e;const s=async()=>{await Ze(`/places/${l.idx}`)};return n.$$set=a=>{"place"in a&&t(0,l=a.place)},[l,s]}class Ql extends fe{constructor(e){super(),ue(this,e,Kl,Jl,oe,{place:0})}}function $l(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=xe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=A(e);t=xe(s,"path",{d:!0}),A(t).forEach(p),s.forEach(p),this.h()},h(){h(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",n[1]),h(e,"height",n[1]),h(e,"fill",n[0])},m(l,s){L(l,e,s),w(e,t)},p(l,[s]){s&2&&h(e,"width",l[1]),s&2&&h(e,"height",l[1]),s&1&&h(e,"fill",l[0])},i:J,o:J,d(l){l&&p(e)}}}function en(n,e,t){let l,{fill:s="#5f6368"}=e,{length:a="1.75"}=e,{alt:o="Edit"}=e;return n.$$set=i=>{"fill"in i&&t(0,s=i.fill),"length"in i&&t(2,a=i.length),"alt"in i&&t(3,o=i.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=Ie(a))},[s,l,a,o]}class tn extends fe{constructor(e){super(),ue(this,e,en,$l,oe,{fill:0,length:2,alt:3})}}function ln(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=xe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=A(e);t=xe(s,"path",{d:!0}),A(t).forEach(p),s.forEach(p),this.h()},h(){h(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",n[1]),h(e,"height",n[1]),h(e,"fill",n[0])},m(l,s){L(l,e,s),w(e,t)},p(l,[s]){s&2&&h(e,"width",l[1]),s&2&&h(e,"height",l[1]),s&1&&h(e,"fill",l[0])},i:J,o:J,d(l){l&&p(e)}}}function nn(n,e,t){let l,{fill:s="#5f6368"}=e,{length:a="1.75"}=e,{alt:o="Delete"}=e;return n.$$set=i=>{"fill"in i&&t(0,s=i.fill),"length"in i&&t(2,a=i.length),"alt"in i&&t(3,o=i.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=Ie(a))},[s,l,a,o]}class sn extends fe{constructor(e){super(),ue(this,e,nn,ln,oe,{fill:0,length:2,alt:3})}}function rn(n){let e,t=(n[0].text||"")+"",l,s,a;return{c(){e=D("p"),l=_e(t),this.h()},l(o){e=M(o,"P",{class:!0,style:!0});var i=A(e);l=be(i,t),i.forEach(p),this.h()},h(){h(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),h(e,"style",`
      overflow: hidden;
      height: ${n[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(o,i){L(o,e,i),w(e,l),s||(a=[Se(ze.call(null,e)),z(e,"click",n[2])],s=!0)},p(o,[i]){i&1&&t!==(t=(o[0].text||"")+"")&&Le(l,t)},i:J,o:J,d(o){o&&p(e),s=!1,ve(a)}}}function an(n,e,t){const l=Ge();let{post:s}=e;const a=Ie(1),o=Ie(6);function i(r){const f=r.currentTarget;if(f)if(f.style.height===`${a}px`||!f.style.height){if(f.scrollHeight>a){const u=f.scrollHeight<o?f.scrollHeight:o;f.style.height=`${u}px`,f.style.overflow="scroll",f.style.display="block",f.style.webkitLineClamp="unset",l("textExpanded",{expanded:!0})}}else f.style.height=`${a}px`,f.style.overflow="hidden",f.style.display="-webkit-box",f.style.webkitLineClamp="1",l("textExpanded",{expanded:!1})}return At(()=>{l("textExpanded",{expanded:!1})}),n.$$set=r=>{"post"in r&&t(0,s=r.post)},[s,a,i]}class on extends fe{constructor(e){super(),ue(this,e,an,rn,oe,{post:0})}}function fn(n){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),A(e).forEach(p),this.h()},h(){h(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),$(e,"opacity","0.6"),$(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,l){L(t,e,l)},d(t){t&&p(e)}}}function un(n){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),A(e).forEach(p),this.h()},h(){h(e,"class","fixed inset-0 pointer-events-none z-30"),$(e,"opacity","0.7"),$(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,l){L(t,e,l)},d(t){t&&p(e)}}}function cn(n){let e;function t(a,o){return a[0]?un:fn}let l=t(n),s=l(n);return{c(){s.c(),e=se()},l(a){s.l(a),e=se()},m(a,o){s.m(a,o),L(a,e,o)},p(a,[o]){l!==(l=t(a))&&(s.d(1),s=l(a),s&&(s.c(),s.m(e.parentNode,e)))},i:J,o:J,d(a){a&&p(e),s.d(a)}}}function dn(n,e,t){let{isTextExpanded:l=!1}=e;return n.$$set=s=>{"isTextExpanded"in s&&t(0,l=s.isTextExpanded)},[l]}class hn extends fe{constructor(e){super(),ue(this,e,dn,cn,oe,{isTextExpanded:0})}}function ut(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function ct(n,e){let t,l,s,a,o,i=J;return{key:n,first:null,c(){t=D("span"),l=D("span"),a=j(),this.h()},l(r){t=M(r,"SPAN",{class:!0,style:!0});var f=A(t);l=M(f,"SPAN",{class:!0,style:!0}),A(l).forEach(p),a=F(f),f.forEach(p),this.h()},h(){h(l,"class",s=Ue(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),$(l,"transform","scale("+e[4](e[7])+")"),$(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),h(t,"class","flex items-center justify-center"),$(t,"width","0.375rem"),$(t,"height","0.375rem"),this.first=t},m(r,f){L(r,t,f),w(t,l),w(t,a)},p(r,f){e=r,f&13&&s!==(s=Ue(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&h(l,"class",s),f&8&&$(l,"transform","scale("+e[4](e[7])+")"),f&13&&$(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){o=t.getBoundingClientRect()},f(){Ll(t),i()},a(){i(),i=Nl(t,o,ql,{})},d(r){r&&p(t)}}}function mn(n){let e,t=[],l=new Map,s,a=de(n[3]);const o=i=>i[5];for(let i=0;i<a.length;i+=1){let r=ut(n,a,i),f=o(r);l.set(f,t[i]=ct(f,r))}return{c(){e=D("div");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=M(i,"DIV",{class:!0});var r=A(e);for(let f=0;f<t.length;f+=1)t[f].l(r);r.forEach(p),this.h()},h(){h(e,"class",s=Ue(`
    ${n[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(i,r){L(i,e,r);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(i,[r]){if(r&29){a=de(i[3]);for(let f=0;f<t.length;f+=1)t[f].r();t=We(t,r,o,1,i,a,l,e,Cl,ct,null,ut);for(let f=0;f<t.length;f+=1)t[f].a()}r&2&&s!==(s=Ue(`
    ${i[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&h(e,"class",s)},i:J,o:J,d(i){i&&p(e);for(let r=0;r<t.length;r+=1)t[r].d()}}}const Te=7;function pn(n,e,t){let{post:l}=e,{fixed:s=!0}=e,a=[],o=0;function i(r){const f=l.mediaIdx-o,u=a.length;if(u<=1)return 1;const g=Math.max(f,u-1-f);return g===0?1:1-Math.abs(r-f)/g*.5}return n.$$set=r=>{"post"in r&&t(0,l=r.post),"fixed"in r&&t(1,s=r.fixed)},n.$$.update=()=>{n.$$.dirty&5&&(l.media.length>Te?(l.mediaIdx<=Math.floor(Te/2)?t(2,o=0):l.mediaIdx>=l.media.length-Math.ceil(Te/2)?t(2,o=l.media.length-Te):t(2,o=l.mediaIdx-Math.floor(Te/2)),t(3,a=l.media.slice(o,o+Te))):(t(2,o=0),t(3,a=l.media)))},[l,s,o,a,i]}class Ft extends fe{constructor(e){super(),ue(this,e,pn,mn,oe,{post:0,fixed:1})}}function dt(n,e,t){const l=n.slice();return l[13]=e[t].text,l[14]=e[t].value,l[15]=e[t].custom,l[17]=t,l}function ht(n){let e,t,l,s,a=n[13]+"",o,i,r,f;return{c(){e=D("label"),t=D("input"),l=j(),s=D("span"),o=_e(a),i=j(),this.h()},l(u){e=M(u,"LABEL",{class:!0});var g=A(e);t=M(g,"INPUT",{type:!0,name:!0,class:!0}),l=F(g),s=M(g,"SPAN",{class:!0});var v=A(s);o=be(v,a),v.forEach(p),i=F(g),g.forEach(p),this.h()},h(){h(t,"type","radio"),h(t,"name","report"),h(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=n[14],h(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"class","flex gap-2 py-2")},m(u,g){L(u,e,g),w(e,t),w(e,l),w(e,s),w(s,o),w(e,i),r||(f=z(t,"change",n[7]),r=!0)},p:J,d(u){u&&p(e),r=!1,f()}}}function mt(n){let e,t,l,s;return{c(){e=D("div"),t=D("textarea"),this.h()},l(a){e=M(a,"DIV",{class:!0});var o=A(e);t=M(o,"TEXTAREA",{class:!0,placeholder:!0}),A(t).forEach(p),o.forEach(p),this.h()},h(){h(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal"),h(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),h(e,"class","px-5 py-2.5")},m(a,o){L(a,e,o),w(e,t),nt(t,n[2]),l||(s=z(t,"input",n[8]),l=!0)},p(a,o){o&4&&nt(t,a[2])},d(a){a&&p(e),l=!1,s()}}}function gn(n){let e,t,l="게시물 신고 사유",s,a,o,i,r,f,u="취소",g,v,E="신고",B,_,d=de(n[3]),m=[];for(let T=0;T<d.length;T+=1)m[T]=ht(dt(n,d,T));let k=n[1]==="etc"&&mt(n);return{c(){e=D("div"),t=D("heading"),t.textContent=l,s=j(),a=D("div");for(let T=0;T<m.length;T+=1)m[T].c();o=j(),k&&k.c(),i=j(),r=D("div"),f=D("button"),f.textContent=u,g=j(),v=D("button"),v.textContent=E,this.h()},l(T){e=M(T,"DIV",{class:!0});var I=A(e);t=M(I,"HEADING",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-z3puxq"&&(t.textContent=l),s=F(I),a=M(I,"DIV",{class:!0});var x=A(a);for(let P=0;P<m.length;P+=1)m[P].l(x);x.forEach(p),o=F(I),k&&k.l(I),i=F(I),r=M(I,"DIV",{class:!0});var U=A(r);f=M(U,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(f)!=="svelte-xb8aop"&&(f.textContent=u),g=F(U),v=M(U,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-1fehi46"&&(v.textContent=E),U.forEach(p),I.forEach(p),this.h()},h(){h(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),h(a,"class","px-5"),h(f,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),h(v,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),h(r,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),h(e,"class","flex flex-col gap-2.5")},m(T,I){L(T,e,I),w(e,t),w(e,s),w(e,a);for(let x=0;x<m.length;x+=1)m[x]&&m[x].m(a,null);w(e,o),k&&k.m(e,null),w(e,i),w(e,r),w(r,f),w(r,g),w(r,v),B||(_=[z(f,"click",n[9]),z(v,"click",n[4]),Se(ze.call(null,e))],B=!0)},p(T,I){if(I&10){d=de(T[3]);let x;for(x=0;x<d.length;x+=1){const U=dt(T,d,x);m[x]?m[x].p(U,I):(m[x]=ht(U),m[x].c(),m[x].m(a,null))}for(;x<m.length;x+=1)m[x].d(1);m.length=d.length}T[1]==="etc"?k?k.p(T,I):(k=mt(T),k.c(),k.m(e,i)):k&&(k.d(1),k=null)},d(T){T&&p(e),St(m,T),k&&k.d(),B=!1,ve(_)}}}function _n(n){let e,t,l;function s(o){n[10](o)}let a={noHandle:!0,fixed:!0,$$slots:{default:[gn]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.isOpen=n[0]),e=new jt({props:a}),De.push(()=>Re(e,"isOpen",s)),{c(){H(e.$$.fragment)},l(o){Z(e.$$.fragment,o)},m(o,i){G(e,o,i),l=!0},p(o,[i]){const r={};i&262151&&(r.$$scope={dirty:i,ctx:o}),!t&&i&1&&(t=!0,r.isOpen=o[0],Oe(()=>t=!1)),e.$set(r)},i(o){l||(y(e.$$.fragment,o),l=!0)},o(o){R(e.$$.fragment,o),l=!1},d(o){W(e,o)}}}function bn(n,e,t){const l=Ge();let{isOpen:s}=e,{selectedValue:a=""}=e,{targetTable:o=""}=e,{targetIdx:i=""}=e;const r=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let f="",u=!1;async function g(){const d=r.findIndex(m=>m.value===a);if(d===-1){alert("신고 사유를 선택해주세요.");return}if(!u){u=!0,ge.emit("loading",!0);try{const m=r[d],k=new URL(`${Ae}/auth/permissions`);k.searchParams.set("targetTable",o),k.searchParams.set("targetIdx",i),k.searchParams.set("relation","reported"),k.searchParams.set("subjectTable","users"),k.searchParams.set("subjectIdx",Nt().sub),k.searchParams.set("metadata",JSON.stringify({...m,customReason:f})),t(0,s=!1),t(2,f=""),await fetch(k,{method:"PUT",headers:{Authorization:`Bearer ${Ye()}`}}),l("reported")}finally{u=!1,ge.emit("loading",!1)}}}const v=d=>{t(1,a=d.target.value)};function E(){f=this.value,t(2,f)}const B=()=>{t(0,s=!1)};function _(d){s=d,t(0,s)}return n.$$set=d=>{"isOpen"in d&&t(0,s=d.isOpen),"selectedValue"in d&&t(1,a=d.selectedValue),"targetTable"in d&&t(5,o=d.targetTable),"targetIdx"in d&&t(6,i=d.targetIdx)},[s,a,f,r,g,o,i,v,E,B,_]}class vn extends fe{constructor(e){super(),ue(this,e,bn,_n,oe,{isOpen:0,selectedValue:1,targetTable:5,targetIdx:6})}}function pt(n){let e,t,l,s="이 게시물을 신고해 주셔서 감사합니다.",a,o,i="신고 취소하기",r,f;return{c(){e=D("div"),t=D("div"),l=D("div"),l.textContent=s,a=j(),o=D("div"),o.textContent=i,this.h()},l(u){e=M(u,"DIV",{class:!0});var g=A(e);t=M(g,"DIV",{class:!0});var v=A(t);l=M(v,"DIV",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-179ijsk"&&(l.textContent=s),a=F(v),o=M(v,"DIV",{class:!0,"data-svelte-h":!0}),ee(o)!=="svelte-1haiztv"&&(o.textContent=i),v.forEach(p),g.forEach(p),this.h()},h(){h(l,"class","text-white text-[0.9375rem] font-semibold"),h(o,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),h(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),h(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(u,g){L(u,e,g),w(e,t),w(t,l),w(t,a),w(t,o),r||(f=z(o,"click",n[1]),r=!0)},p:J,d(u){u&&p(e),r=!1,f()}}}function wn(n){let e,t=n[0]&&pt(n);return{c(){t&&t.c(),e=se()},l(l){t&&t.l(l),e=se()},m(l,s){t&&t.m(l,s),L(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=pt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:J,o:J,d(l){l&&p(e),t&&t.d(l)}}}function kn(n,e,t){const l=Ge();let{isVisible:s=!1}=e,{targetTable:a=""}=e,{targetIdx:o=""}=e,i=!1;async function r(){if(i!==!0){i=!0,ge.emit("loading",!0);try{const f=new URL(`${Ae}/auth/permissions`);f.searchParams.set("targetTable",a),f.searchParams.set("targetIdx",o),f.searchParams.set("relation","reported"),f.searchParams.set("subjectTable","users"),f.searchParams.set("subjectIdx",Nt().sub),await fetch(f,{method:"DELETE",headers:{Authorization:`Bearer ${Ye()}`}}),t(0,s=!1),l("unreported")}finally{i=!1,ge.emit("loading",!1)}}}return n.$$set=f=>{"isVisible"in f&&t(0,s=f.isVisible),"targetTable"in f&&t(2,a=f.targetTable),"targetIdx"in f&&t(3,o=f.targetIdx)},[s,r,a,o]}class Cn extends fe{constructor(e){super(),ue(this,e,kn,wn,oe,{isVisible:0,targetTable:2,targetIdx:3})}}function gt(n,e,t){const l=n.slice();return l[79]=e[t],l[80]=e,l[81]=t,l}function _t(n,e,t){const l=n.slice();return l[82]=e[t],l}function bt(n,e,t){const l=n.slice();return l[85]=e[t],l[87]=t,l}function vt(n){let e,t,l;return{c(){e=D("div"),this.h()},l(s){e=M(s,"DIV",{class:!0}),A(e).forEach(p),this.h()},h(){h(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,a){L(s,e,a),t||(l=z(e,"contextmenu",wl(n[23])),t=!0)},d(s){s&&p(e),t=!1,l()}}}function wt(n){let e,t,l,s=[],a=new Map,o,i,r,f,u,g,v,E=de(n[79].media);const B=d=>d[85];for(let d=0;d<E.length;d+=1){let m=bt(n,E,d),k=B(m);a.set(k,s[d]=kt(k,m))}let _=!n[5]&&Ct(n);return{c(){e=D("section"),t=D("div"),l=D("div");for(let d=0;d<s.length;d+=1)s[d].c();i=j(),_&&_.c(),r=j(),this.h()},l(d){e=M(d,"SECTION",{class:!0,style:!0});var m=A(e);t=M(m,"DIV",{class:!0});var k=A(t);l=M(k,"DIV",{class:!0,style:!0});var T=A(l);for(let I=0;I<s.length;I+=1)s[I].l(T);T.forEach(p),k.forEach(p),i=F(m),_&&_.l(m),r=F(m),m.forEach(p),this.h()},h(){h(l,"class",o="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")),$(l,"transform","translateX("+(-n[79].mediaIdx*n[11].width+n[10])+"px)"),h(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),h(e,"class",f=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`),$(e,"top","0"),$(e,"transform","translateY("+((n[81]-n[1])*n[11].height+n[9])+"px)")},m(d,m){L(d,e,m),w(e,t),w(t,l);for(let k=0;k<s.length;k+=1)s[k]&&s[k].m(l,null);w(e,i),_&&_.m(e,null),w(e,r),u=!0,g||(v=[z(l,"transitionend",function(){He(n[79].mediaIdx===n[0][n[1]].mediaIdx?n[14]:void 0)&&(n[79].mediaIdx===n[0][n[1]].mediaIdx?n[14]:void 0).apply(this,arguments)}),z(e,"transitionend",function(){He(n[81]===n[1]?n[14]:void 0)&&(n[81]===n[1]?n[14]:void 0).apply(this,arguments)})],g=!0)},p(d,m){n=d,m[0]&35&&(E=de(n[79].media),te(),s=We(s,m,B,1,n,E,a,l,Lt,kt,null,bt),le()),(!u||m[0]&256&&o!==(o="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")))&&h(l,"class",o),(!u||m[0]&3073)&&$(l,"transform","translateX("+(-n[79].mediaIdx*n[11].width+n[10])+"px)"),n[5]?_&&(te(),R(_,1,1,()=>{_=null}),le()):_?(_.p(n,m),m[0]&32&&y(_,1)):(_=Ct(n),_.c(),y(_,1),_.m(e,r)),(!u||m[0]&256&&f!==(f=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`))&&h(e,"class",f),(!u||m[0]&2563)&&$(e,"transform","translateY("+((n[81]-n[1])*n[11].height+n[9])+"px)")},i(d){if(!u){for(let m=0;m<E.length;m+=1)y(s[m]);y(_),u=!0}},o(d){for(let m=0;m<s.length;m+=1)R(s[m]);R(_),u=!1},d(d){d&&p(e);for(let m=0;m<s.length;m+=1)s[m].d();_&&_.d(),g=!1,ve(v)}}}function kt(n,e){let t,l,s,a,o,i;return s=new jl({props:{src:e[85],isEdit:e[5],post:e[0][e[1]],autoplay:e[1]===e[81]&&e[0][e[1]].mediaIdx===e[87],isRightOrderForYoutube:e[1]===e[81]}}),{key:n,first:null,c(){t=D("div"),l=D("div"),H(s.$$.fragment),o=j(),this.h()},l(r){t=M(r,"DIV",{class:!0});var f=A(t);l=M(f,"DIV",{class:!0});var u=A(l);Z(s.$$.fragment,u),u.forEach(p),o=F(f),f.forEach(p),this.h()},h(){h(l,"class",a=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `),h(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(r,f){L(r,t,f),w(t,l),G(s,l,null),w(t,o),i=!0},p(r,f){e=r;const u={};f[0]&1&&(u.src=e[85]),f[0]&32&&(u.isEdit=e[5]),f[0]&3&&(u.post=e[0][e[1]]),f[0]&3&&(u.autoplay=e[1]===e[81]&&e[0][e[1]].mediaIdx===e[87]),f[0]&3&&(u.isRightOrderForYoutube=e[1]===e[81]),s.$set(u),(!i||f[0]&32&&a!==(a=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `))&&h(l,"class",a)},i(r){i||(y(s.$$.fragment,r),i=!0)},o(r){R(s.$$.fragment,r),i=!1},d(r){r&&p(t),W(s)}}}function Ct(n){var U;let e,t,l,s,a,o,i,r,f,u,g,v,E,B,_=n[79].media.length>1&&xt(n),d=((U=n[79].reactions)==null?void 0:U.length)>0&&!n[6]&&It(n);function m(P){n[25](P,n[79],n[80],n[81])}let k={};n[79]!==void 0&&(k.post=n[79]),a=new Hl({props:k}),De.push(()=>Re(a,"post",m));function T(...P){return n[26](n[79],n[80],n[81],...P)}r=new on({props:{post:n[79]}}),r.$on("textExpanded",T),u=new Ql({props:{place:{idx:n[79].place_idx,name:n[79].place_name}}});let I=!n[6]&&yt(n),x=n[1]===n[81]&&Dt(n);return{c(){_&&_.c(),e=j(),t=D("div"),l=D("div"),d&&d.c(),s=j(),H(a.$$.fragment),i=j(),H(r.$$.fragment),f=j(),H(u.$$.fragment),g=j(),I&&I.c(),v=j(),x&&x.c(),E=se(),this.h()},l(P){_&&_.l(P),e=F(P),t=M(P,"DIV",{class:!0});var C=A(t);l=M(C,"DIV",{class:!0});var N=A(l);d&&d.l(N),s=F(N),Z(a.$$.fragment,N),i=F(N),Z(r.$$.fragment,N),f=F(N),Z(u.$$.fragment,N),N.forEach(p),g=F(C),I&&I.l(C),C.forEach(p),v=F(P),x&&x.l(P),E=se(),this.h()},h(){h(l,"class","flex-grow text-white text-md flex flex-col items-start gap-2 transition-transform text-base "),h(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(P,C){_&&_.m(P,C),L(P,e,C),L(P,t,C),w(t,l),d&&d.m(l,null),w(l,s),G(a,l,null),w(l,i),G(r,l,null),w(l,f),G(u,l,null),w(t,g),I&&I.m(t,null),L(P,v,C),x&&x.m(P,C),L(P,E,C),B=!0},p(P,C){var ie;n=P,n[79].media.length>1?_?(_.p(n,C),C[0]&1&&y(_,1)):(_=xt(n),_.c(),y(_,1),_.m(e.parentNode,e)):_&&(te(),R(_,1,1,()=>{_=null}),le()),((ie=n[79].reactions)==null?void 0:ie.length)>0&&!n[6]?d?(d.p(n,C),C[0]&65&&y(d,1)):(d=It(n),d.c(),y(d,1),d.m(l,s)):d&&(te(),R(d,1,1,()=>{d=null}),le());const N={};!o&&C[0]&1&&(o=!0,N.post=n[79],Oe(()=>o=!1)),a.$set(N);const K={};C[0]&1&&(K.post=n[79]),r.$set(K);const Q={};C[0]&1&&(Q.place={idx:n[79].place_idx,name:n[79].place_name}),u.$set(Q),n[6]?I&&(te(),R(I,1,1,()=>{I=null}),le()):I?(I.p(n,C),C[0]&64&&y(I,1)):(I=yt(n),I.c(),y(I,1),I.m(t,null)),n[1]===n[81]?x?(x.p(n,C),C[0]&3&&y(x,1)):(x=Dt(n),x.c(),y(x,1),x.m(E.parentNode,E)):x&&(te(),R(x,1,1,()=>{x=null}),le())},i(P){B||(y(_),y(d),y(a.$$.fragment,P),y(r.$$.fragment,P),y(u.$$.fragment,P),y(I),y(x),B=!0)},o(P){R(_),R(d),R(a.$$.fragment,P),R(r.$$.fragment,P),R(u.$$.fragment,P),R(I),R(x),B=!1},d(P){P&&(p(e),p(t),p(v),p(E)),_&&_.d(P),d&&d.d(),W(a),W(r),W(u),I&&I.d(),x&&x.d(P)}}}function xt(n){let e,t;return e=new Ft({props:{post:n[79]}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&1&&(a.post=l[79]),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function It(n){let e,t,l=de(n[79].reactions),s=[];for(let o=0;o<l.length;o+=1)s[o]=Et(_t(n,l,o));const a=o=>R(s[o],1,1,()=>{s[o]=null});return{c(){e=D("div");for(let o=0;o<s.length;o+=1)s[o].c();this.h()},l(o){e=M(o,"DIV",{class:!0});var i=A(e);for(let r=0;r<s.length;r+=1)s[r].l(i);i.forEach(p),this.h()},h(){h(e,"class","flex gap-1 justify-center items-center mb-1")},m(o,i){L(o,e,i);for(let r=0;r<s.length;r+=1)s[r]&&s[r].m(e,null);t=!0},p(o,i){if(i[0]&65537){l=de(o[79].reactions);let r;for(r=0;r<l.length;r+=1){const f=_t(o,l,r);s[r]?(s[r].p(f,i),y(s[r],1)):(s[r]=Et(f),s[r].c(),y(s[r],1),s[r].m(e,null))}for(te(),r=l.length;r<s.length;r+=1)a(r);le()}},i(o){if(!t){for(let i=0;i<l.length;i+=1)y(s[i]);t=!0}},o(o){s=s.filter(Boolean);for(let i=0;i<s.length;i+=1)R(s[i]);t=!1},d(o){o&&p(e),St(s,o)}}}function Et(n){let e,t;function l(){return n[24](n[79],n[82])}return e=new qt({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:n[82].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:n[82].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",l),{c(){H(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,a){G(e,s,a),t=!0},p(s,a){n=s;const o={};a[0]&1&&(o.prefix=n[82].type),a[0]&1&&(o.value=n[82].count),e.$set(o)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){R(e.$$.fragment,s),t=!1},d(s){W(e,s)}}}function yt(n){var P;let e,t,l,s,a,o,i,r,f=((P=n[79].reactions)!=null&&P.length?n[79].reactions.reduce(n[32],0):0)+"",u,g,v,E,B,_,d,m=n[79].onReactionShowcase&&Tt(n);const k=[In,xn],T=[];function I(C,N){return C[79].myReaction?0:1}a=I(n),o=T[a]=k[a](n);function x(){return n[33](n[79])}function U(){return n[34](n[79],n[80],n[81])}return E=new Al({props:{fill:"white",length:1.5}}),{c(){e=D("div"),t=D("div"),m&&m.c(),l=j(),s=D("button"),o.c(),i=j(),r=D("span"),u=_e(f),g=j(),v=D("button"),H(E.$$.fragment),this.h()},l(C){e=M(C,"DIV",{class:!0});var N=A(e);t=M(N,"DIV",{class:!0});var K=A(t);m&&m.l(K),l=F(K),s=M(K,"BUTTON",{class:!0});var Q=A(s);o.l(Q),i=F(Q),r=M(Q,"SPAN",{class:!0});var ie=A(r);u=be(ie,f),ie.forEach(p),Q.forEach(p),K.forEach(p),g=F(N),v=M(N,"BUTTON",{});var re=A(v);Z(E.$$.fragment,re),re.forEach(p),N.forEach(p),this.h()},h(){h(r,"class","text-xs text-white h-4"),h(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),h(t,"class","flex gap-4 relative"),h(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(C,N){L(C,e,N),w(e,t),m&&m.m(t,null),w(t,l),w(t,s),T[a].m(s,null),w(s,i),w(s,r),w(r,u),w(e,g),w(e,v),G(E,v,null),B=!0,_||(d=[z(s,"click",x),Se(ze.call(null,s)),Se(Ol.call(null,s,500)),z(s,"longpress",U),z(v,"click",n[35])],_=!0)},p(C,N){var Q;n=C,n[79].onReactionShowcase?m?m.p(n,N):(m=Tt(n),m.c(),m.m(t,l)):m&&(m.d(1),m=null);let K=a;a=I(n),a!==K&&(te(),R(T[K],1,1,()=>{T[K]=null}),le(),o=T[a],o||(o=T[a]=k[a](n),o.c()),y(o,1),o.m(s,i)),(!B||N[0]&1)&&f!==(f=((Q=n[79].reactions)!=null&&Q.length?n[79].reactions.reduce(n[32],0):0)+"")&&Le(u,f)},i(C){B||(y(o),y(E.$$.fragment,C),B=!0)},o(C){R(o),R(E.$$.fragment,C),B=!1},d(C){C&&p(e),m&&m.d(),T[a].d(),W(E),_=!1,ve(d)}}}function Tt(n){let e,t,l="👍",s,a,o="🔥",i,r,f="😍",u,g,v="😋",E,B,_="😊️️",d,m;function k(){return n[27](n[79])}function T(){return n[28](n[79])}function I(){return n[29](n[79])}function x(){return n[30](n[79])}function U(){return n[31](n[79])}return{c(){e=D("div"),t=D("button"),t.textContent=l,s=j(),a=D("button"),a.textContent=o,i=j(),r=D("button"),r.textContent=f,u=j(),g=D("button"),g.textContent=v,E=j(),B=D("button"),B.textContent=_,this.h()},l(P){e=M(P,"DIV",{class:!0});var C=A(e);t=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-3oecln"&&(t.textContent=l),s=F(C),a=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-131qbu2"&&(a.textContent=o),i=F(C),r=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(r)!=="svelte-lq90i3"&&(r.textContent=f),u=F(C),g=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(g)!=="svelte-l73y87"&&(g.textContent=v),E=F(C),B=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(B)!=="svelte-11szxsj"&&(B.textContent=_),C.forEach(p),this.h()},h(){h(t,"class","text-2xl/[26px]"),h(a,"class","text-2xl/[26px]"),h(r,"class","text-2xl/[26px]"),h(g,"class","text-2xl/[26px]"),h(B,"class","text-2xl/[26px]"),h(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(P,C){L(P,e,C),w(e,t),w(e,s),w(e,a),w(e,i),w(e,r),w(e,u),w(e,g),w(e,E),w(e,B),d||(m=[z(t,"click",k),z(a,"click",T),z(r,"click",I),z(g,"click",x),z(B,"click",U)],d=!0)},p(P,C){n=P},d(P){P&&p(e),d=!1,ve(m)}}}function xn(n){let e,t;return e=new Bl({props:{fill:"white",length:1.5}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function In(n){let e,t;return e=new Pl({props:{fill:"#EA3323",length:1.5}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Dt(n){let e,t;return e=new hn({props:{isTextExpanded:n[79].isTextExpanded}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&1&&(a.isTextExpanded=l[79].isTextExpanded),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Mt(n,e){let t,l=Math.abs(e[1]-e[81])<=1,s,a,o=l&&wt(e);return{key:n,first:null,c(){t=se(),o&&o.c(),s=se(),this.h()},l(i){t=se(),o&&o.l(i),s=se(),this.h()},h(){this.first=t},m(i,r){L(i,t,r),o&&o.m(i,r),L(i,s,r),a=!0},p(i,r){e=i,r[0]&3&&(l=Math.abs(e[1]-e[81])<=1),l?o?(o.p(e,r),r[0]&3&&y(o,1)):(o=wt(e),o.c(),y(o,1),o.m(s.parentNode,s)):o&&(te(),R(o,1,1,()=>{o=null}),le())},i(i){a||(y(o),a=!0)},o(i){R(o),a=!1},d(i){i&&(p(t),p(s)),o&&o.d(i)}}}function Vt(n){let e,t;return e=new Ft({props:{post:n[0][n[1]],fixed:!1}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&3&&(a.post=l[0][l[1]]),e.$set(a)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Bt(n){let e,t;return e=new Vl({}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){R(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Pt(n){let e,t,l,s,a="수정",o,i,r,f,u,g="삭제",v,E,B;return t=new tn({props:{fill:"white",length:1.5}}),r=new sn({props:{fill:"white",length:1.5}}),{c(){e=D("button"),H(t.$$.fragment),l=j(),s=D("span"),s.textContent=a,o=j(),i=D("button"),H(r.$$.fragment),f=j(),u=D("span"),u.textContent=g,this.h()},l(_){e=M(_,"BUTTON",{class:!0});var d=A(e);Z(t.$$.fragment,d),l=F(d),s=M(d,"SPAN",{"data-svelte-h":!0}),ee(s)!=="svelte-17aljrl"&&(s.textContent=a),d.forEach(p),o=F(_),i=M(_,"BUTTON",{class:!0});var m=A(i);Z(r.$$.fragment,m),f=F(m),u=M(m,"SPAN",{"data-svelte-h":!0}),ee(u)!=="svelte-1k1dgz"&&(u.textContent=g),m.forEach(p),this.h()},h(){h(e,"class","flex items-center gap-2 text-white text-sm"),h(i,"class","flex items-center gap-2 text-white text-sm")},m(_,d){L(_,e,d),G(t,e,null),w(e,l),w(e,s),L(_,o,d),L(_,i,d),G(r,i,null),w(i,f),w(i,u),v=!0,E||(B=[z(e,"click",n[37]),z(i,"click",n[38])],E=!0)},p:J,i(_){v||(y(t.$$.fragment,_),y(r.$$.fragment,_),v=!0)},o(_){R(t.$$.fragment,_),R(r.$$.fragment,_),v=!1},d(_){_&&(p(e),p(o),p(i)),W(t),W(r),E=!1,ve(B)}}}function Ot(n){let e,t,l,s,a,o;return t=new Wl({}),{c(){e=D("button"),H(t.$$.fragment),l=_e(`
        신고`),this.h()},l(i){e=M(i,"BUTTON",{class:!0});var r=A(e);Z(t.$$.fragment,r),l=be(r,`
        신고`),r.forEach(p),this.h()},h(){h(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(i,r){L(i,e,r),G(t,e,null),w(e,l),s=!0,a||(o=z(e,"click",n[40]),a=!0)},p:J,i(i){s||(y(t.$$.fragment,i),s=!0)},o(i){R(t.$$.fragment,i),s=!1},d(i){i&&p(e),W(t),a=!1,o()}}}function En(n){let e,t,l,s,a,o,i,r,f,u=n[13]&&Pt(n);s=new Fl({props:{length:1.5,fill:"white"}});let g=!n[13]&&Ot(n);return{c(){e=D("div"),u&&u.c(),t=j(),l=D("button"),H(s.$$.fragment),a=_e(`
      링크 복사`),o=j(),g&&g.c(),this.h()},l(v){e=M(v,"DIV",{id:!0,class:!0});var E=A(e);u&&u.l(E),t=F(E),l=M(E,"BUTTON",{class:!0});var B=A(l);Z(s.$$.fragment,B),a=be(B,`
      링크 복사`),B.forEach(p),o=F(E),g&&g.l(E),E.forEach(p),this.h()},h(){h(l,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"id","test"),h(e,"class","flex flex-col px-5 gap-3")},m(v,E){L(v,e,E),u&&u.m(e,null),w(e,t),w(e,l),G(s,l,null),w(l,a),w(e,o),g&&g.m(e,null),i=!0,r||(f=[z(l,"click",n[39]),Se(ze.call(null,e))],r=!0)},p(v,E){v[13]?u?(u.p(v,E),E[0]&8192&&y(u,1)):(u=Pt(v),u.c(),y(u,1),u.m(e,t)):u&&(te(),R(u,1,1,()=>{u=null}),le()),v[13]?g&&(te(),R(g,1,1,()=>{g=null}),le()):g?(g.p(v,E),E[0]&8192&&y(g,1)):(g=Ot(v),g.c(),y(g,1),g.m(e,null))},i(v){i||(y(u),y(s.$$.fragment,v),y(g),i=!0)},o(v){R(u),R(s.$$.fragment,v),R(g),i=!1},d(v){v&&p(e),u&&u.d(),W(s),g&&g.d(),r=!1,ve(f)}}}function yn(n){let e,t,l="정말로 삭제하시겠습니까?",s,a,o="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",i,r,f,u="삭제",g,v,E="취소",B,_;return{c(){e=D("div"),t=D("h2"),t.textContent=l,s=j(),a=D("p"),a.textContent=o,i=j(),r=D("div"),f=D("button"),f.textContent=u,g=j(),v=D("button"),v.textContent=E,this.h()},l(d){e=M(d,"DIV",{class:!0});var m=A(e);t=M(m,"H2",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1yzhdkj"&&(t.textContent=l),s=F(m),a=M(m,"P",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-26p028"&&(a.textContent=o),i=F(m),r=M(m,"DIV",{class:!0});var k=A(r);f=M(k,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(f)!=="svelte-1q4epan"&&(f.textContent=u),g=F(k),v=M(k,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-1rzg9yy"&&(v.textContent=E),k.forEach(p),m.forEach(p),this.h()},h(){h(t,"class","text-lg font-semibold mb-2"),h(a,"class","text-gray-600 mb-4"),h(f,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),h(v,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),h(r,"class","flex justify-center space-x-4"),h(e,"class","text-center")},m(d,m){L(d,e,m),w(e,t),w(e,s),w(e,a),w(e,i),w(e,r),w(r,f),w(r,g),w(r,v),B||(_=[z(f,"click",n[45]),z(v,"click",n[46])],B=!0)},p:J,d(d){d&&p(e),B=!1,ve(_)}}}function Tn(n){var ae;let e,t,l,s=[],a=new Map,o,i,r,f,u,g,v,E,B,_,d,m,k,T,I,x=!n[5]&&vt(n),U=de(n[0]);const P=b=>b[79].idx;for(let b=0;b<U.length;b+=1){let V=gt(n,U,b),X=P(V);a.set(X,s[b]=Mt(X,V))}let C=n[5]&&((ae=n[0][n[1]])==null?void 0:ae.media.length)>1&&Vt(n),N=!n[5]&&Bt();function K(b){n[41](b)}let Q={fixed:!0,noHandle:!0,$$slots:{default:[En]},$$scope:{ctx:n}};n[2]!==void 0&&(Q.isOpen=n[2]),u=new jt({props:Q}),De.push(()=>Re(u,"isOpen",K));function ie(b){n[42](b)}let re={targetTable:"posts",targetIdx:n[0][n[1]].idx};n[3]!==void 0&&(re.isOpen=n[3]),E=new vn({props:re}),De.push(()=>Re(E,"isOpen",ie)),E.$on("reported",n[43]),d=new Cn({props:{isVisible:n[0][n[1]].permission_signer==="reported",targetTable:"posts",targetIdx:n[0][n[1]].idx}}),d.$on("unreported",n[44]);function he(b){n[47](b)}let we={$$slots:{default:[yn]},$$scope:{ctx:n}};return n[4]!==void 0&&(we.modalVisible=n[4]),k=new Sl({props:we}),De.push(()=>Re(k,"modalVisible",he)),{c(){x&&x.c(),e=j(),t=D("div"),l=D("div");for(let b=0;b<s.length;b+=1)s[b].c();o=j(),C&&C.c(),i=j(),N&&N.c(),f=j(),H(u.$$.fragment),v=j(),H(E.$$.fragment),_=j(),H(d.$$.fragment),m=j(),H(k.$$.fragment),this.h()},l(b){x&&x.l(b),e=F(b),t=M(b,"DIV",{class:!0});var V=A(t);l=M(V,"DIV",{class:!0});var X=A(l);for(let me=0;me<s.length;me+=1)s[me].l(X);X.forEach(p),o=F(V),C&&C.l(V),i=F(V),N&&N.l(V),V.forEach(p),f=F(b),Z(u.$$.fragment,b),v=F(b),Z(E.$$.fragment,b),_=F(b),Z(d.$$.fragment,b),m=F(b),Z(k.$$.fragment,b),this.h()},h(){h(l,"class","flex flex-grow relative w-full h-full bg-black"),h(t,"class",r="viewer bg-black select-none flex flex-col "+(n[5]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen safe-area-pt"))},m(b,V){x&&x.m(b,V),L(b,e,V),L(b,t,V),w(t,l);for(let X=0;X<s.length;X+=1)s[X]&&s[X].m(l,null);w(t,o),C&&C.m(t,null),w(t,i),N&&N.m(t,null),n[36](t),L(b,f,V),G(u,b,V),L(b,v,V),G(E,b,V),L(b,_,V),G(d,b,V),L(b,m,V),G(k,b,V),I=!0},p(b,V){var Ne;b[5]?x&&(x.d(1),x=null):x||(x=vt(b),x.c(),x.m(e.parentNode,e)),V[0]&85863&&(U=de(b[0]),te(),s=We(s,V,P,1,b,U,a,l,Lt,Mt,null,gt),le()),b[5]&&((Ne=b[0][b[1]])==null?void 0:Ne.media.length)>1?C?(C.p(b,V),V[0]&35&&y(C,1)):(C=Vt(b),C.c(),y(C,1),C.m(t,i)):C&&(te(),R(C,1,1,()=>{C=null}),le()),b[5]?N&&(te(),R(N,1,1,()=>{N=null}),le()):N?V[0]&32&&y(N,1):(N=Bt(),N.c(),y(N,1),N.m(t,null)),(!I||V[0]&32&&r!==(r="viewer bg-black select-none flex flex-col "+(b[5]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen safe-area-pt")))&&h(t,"class",r);const X={};V[0]&8348|V[2]&67108864&&(X.$$scope={dirty:V,ctx:b}),!g&&V[0]&4&&(g=!0,X.isOpen=b[2],Oe(()=>g=!1)),u.$set(X);const me={};V[0]&3&&(me.targetIdx=b[0][b[1]].idx),!B&&V[0]&8&&(B=!0,me.isOpen=b[3],Oe(()=>B=!1)),E.$set(me);const Ve={};V[0]&3&&(Ve.isVisible=b[0][b[1]].permission_signer==="reported"),V[0]&3&&(Ve.targetIdx=b[0][b[1]].idx),d.$set(Ve);const Be={};V[0]&16|V[2]&67108864&&(Be.$$scope={dirty:V,ctx:b}),!T&&V[0]&16&&(T=!0,Be.modalVisible=b[4],Oe(()=>T=!1)),k.$set(Be)},i(b){if(!I){for(let V=0;V<U.length;V+=1)y(s[V]);y(C),y(N),y(u.$$.fragment,b),y(E.$$.fragment,b),y(d.$$.fragment,b),y(k.$$.fragment,b),I=!0}},o(b){for(let V=0;V<s.length;V+=1)R(s[V]);R(C),R(N),R(u.$$.fragment,b),R(E.$$.fragment,b),R(d.$$.fragment,b),R(k.$$.fragment,b),I=!1},d(b){b&&(p(e),p(t),p(f),p(v),p(_),p(m)),x&&x.d(b);for(let V=0;V<s.length;V+=1)s[V].d();C&&C.d(),N&&N.d(),n[36](null),W(u,b),W(E,b),W(d,b),W(k,b)}}}const Dn=30,Mn=10,Rt=150;function Pe(n){return"touches"in n||"changedTouches"in n}function Vn(n){return Pe(n)?[n.touches[0].clientX,n.touches[0].clientY]:[n.clientX,n.clientY]}function Bn(n,e,t){let l,s,a;bl(n,xl,c=>t(7,a=c));const o=Il.isNativePlatform();let{posts:i=[]}=e,{index:r=0}=e,{type:f=a.url.searchParams.get("type")}=e,{isEdit:u=!1}=e,{dontMoveVertically:g=!1}=e,{selectedReaction:v=void 0}=e,{hideActionButtons:E=!1}=e,B=!0,_=!1,d=!1,m=0,k=0,T={width:0,height:0},I=!1,x=!1,{actionSheetMoreIsOpen:U=!1}=e,{actionSheetReportIsOpen:P=!1}=e,{modalVisible:C=!1}=e;function N(c){if(!c)return!1;const O=Me();return O!==null&&String(O)===c}let K=!1,Q=!1,ie=-1,re=-1,he,we=!1,ae=[],b=[],V;async function X(){El({mediaIdx:`${i[r].mediaIdx||0}`,postIdx:`${i[r].idx}`},{replace:!0})}async function me(){t(20,K=!0);const c=i.length,O=a.url.searchParams.get("userIdx"),S=a.url.searchParams.get("placeIdx"),q=`&offset=${c}`,Y=`&limit=${Dn}`,ne=O?`&userIdx=${O}`:"",ye=S?`&placeIdx=${S}`:"",ce=(await fetch(`${Ae}/posts?${ne}${ye}${q}${Y}`).then(ke=>ke.json()).then(ke=>{var lt;return((lt=ke.data)==null?void 0:lt.posts)??[]})).map(ke=>({...ke,mediaIdx:0}));ce.length===0&&t(21,Q=!0),t(0,i=[...i,...ce]),t(20,K=!1)}function Ve(c){const{height:O}=T;if(r===0&&c>0||r===i.length-1&&c<0){t(9,m=c*.3);return}t(9,m=Math.max(Math.min(c,O),-O))}function Be(c){t(8,B=!1);const O=Ie(2),S=Pe(c)?c.changedTouches[0].clientY-re:c.clientY-re;S>O&&r>0?(t(1,r-=1),_=!0,X()):-S>O&&r<i.length-1&&(t(1,r+=1),_=!0,X()),t(9,m=0)}function Ne(c){const{width:O}=T,S=i[r].mediaIdx,q=i[r].media.length-1;if(S===0&&c>0||S===q&&c<0){t(10,k=c*.3);return}t(10,k=Math.max(Math.min(c,O),-O))}function Ut(c){t(8,B=!1);const O=Ie(2),S=Pe(c)?c.changedTouches[0].clientX-ie:c.clientX-ie,q=i[r].mediaIdx,Y=i[r].media.length-1;S>O&&q>0?Ee(q-1):-S>O&&q<Y&&Ee(q+1),t(10,k=0)}function Ee(c){t(0,i[r]={...i[r],mediaIdx:c},i),t(0,i=[...i]),d=!0,X()}function qe(c){_||d||(we=!0,he=void 0,Pe(c)?(ie=c.touches[0].clientX,re=c.touches[0].clientY):(ie=c.clientX,re=c.clientY,window.addEventListener("mousemove",je,{passive:!1}),window.addEventListener("mouseup",Fe)))}function je(c){if(!we||_||d)return;const[O,S]=Vn(c),q=O-ie,Y=S-re;he===void 0&&(he=Math.abs(Y)>=Math.abs(q)?"post":"media"),!g&&he==="post"?Ve(Y):he==="media"&&Ne(q)}function Fe(c){!we||_||d||(we=!1,he==="post"?Be(c):he==="media"&&Ut(c),Pe(c)||(window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",Fe)))}function Je(c){if(_||d)return;c.preventDefault();const O=Date.now(),S=Math.abs(c.deltaX),q=Math.abs(c.deltaY);if(S>q){if(b.push({deltaX:c.deltaX,timestamp:O}),b=b.filter(Y=>O-Y.timestamp<=Rt),b.length>=2){const Y=b[0],ne=b[b.length-1];if(Math.abs(ne.deltaX)-Math.abs(Y.deltaX)>=0&&Math.abs(ne.deltaX)>=30){const ce=i[r].mediaIdx,ke=i[r].media.length-1;ne.deltaX>0&&ce<ke?Ee(ce+1):ne.deltaX<0&&ce>0&&Ee(ce-1),b=[],d=!0}}}else if(ae.push({deltaY:c.deltaY,timestamp:O}),ae=ae.filter(Y=>O-Y.timestamp<=Rt),ae.length>=2){const Y=ae[0],ne=ae[ae.length-1];Math.abs(ne.deltaY)-Math.abs(Y.deltaY)>=0&&Math.abs(ne.deltaY)>=30&&(ne.deltaY>0&&r<i.length-1?(t(8,B=!1),t(1,r+=1),X(),_=!0):ne.deltaY<0&&r>0&&(t(8,B=!1),t(1,r-=1),X(),_=!0),ae=[])}}function Ke(c){if(_||d)return;const O=i[r].mediaIdx,S=i[r].media.length-1;switch(c.key){case"ArrowUp":r>0&&(t(8,B=!1),t(1,r--,r),_=!0,X());break;case"ArrowDown":r<i.length-1&&(t(8,B=!1),t(1,r++,r),_=!0,X());break;case"ArrowLeft":O>0&&(t(8,B=!1),d=!0,Ee(O-1));break;case"ArrowRight":O<S&&(t(8,B=!1),d=!0,Ee(O+1));break}}function Yt(){t(8,B=!0),_=!1,d=!1}function Qe(){V&&t(11,T={width:V.clientWidth,height:V.clientHeight})}function zt(){var S,q;const c=Number(a.url.searchParams.get("mediaIdx")||0),O=((q=(S=i.at(r))==null?void 0:S.media)==null?void 0:q.length)||0;c&&c<O?t(0,i[r]={...i[r],mediaIdx:c},i):t(0,i[r]={...i[r],mediaIdx:0},i),t(0,i=[...i]),X()}function Xt(){document.addEventListener("touchstart",qe,{passive:!1}),document.addEventListener("touchmove",je,{passive:!1}),document.addEventListener("touchend",Fe),document.addEventListener("mousedown",qe,{passive:!1}),document.addEventListener("wheel",Je,{passive:!1}),document.addEventListener("keydown",Ke)}function Ht(){document.removeEventListener("touchstart",qe),document.removeEventListener("touchmove",je),document.removeEventListener("touchend",Fe),document.removeEventListener("mousedown",qe),document.removeEventListener("wheel",Je),document.removeEventListener("keydown",Ke)}vl(()=>{Qe();const c=new ResizeObserver(()=>Qe());return V&&c.observe(V),Xt(),zt(),()=>{c.disconnect()}}),At(()=>{Ht()});function $e(){var q;if(x)return;x=!0;const c=Ye(),O=Me(),S=(q=i[r])==null?void 0:q.idx;if(!c||!O||!S)return x=!1;fetch(`${Ae}/posts/${S}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}}).then(Y=>Y.json()).then(()=>Ze(`/users/${O}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{x=!1})}async function et(c){var Y,ne,ye;const O=(Y=i[c])==null?void 0:Y.idx;if(O===void 0||u||((ne=i[c])==null?void 0:ne.needReactionReload)!==!0&&((ye=i[c])!=null&&ye.reactions))return;const S=Ye(),q=await fetch(`${Ae}/vote/reactions?targetTable=posts&targetId=${O}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+S}});if(q.ok){const ce=await q.json();t(0,i[c].reactions=ce.data.reactions,i),t(0,i[c].myReaction=ce.data.myReaction,i)}}function pe(c,O){if(I)return;I=!0;const S=r,q=i[S];if((q==null?void 0:q.idx)!==c)return I=!1;if(!st())return q.needReactionReload=!0,I=!1,ge.emit("showSignInModal",{removable:!0,callback:o?()=>{et(S)}:void 0});q.myReaction===O?ge.emit("setReaction",{target:"posts",targetId:c,reaction:null,callback:()=>{t(0,i[S].myReaction=null,i),tt(S,O),I=!1}}):(q.myReaction&&tt(S,q.myReaction),ge.emit("setReaction",{target:"posts",targetId:c,reaction:O,callback:()=>{t(0,i[S].myReaction=O,i),i[S].reactions.some(Y=>Y.type===O)?t(0,i[S].reactions=i[S].reactions.map(Y=>Y.type===O?{...Y,count:Number(Y.count)+1}:Y),i):t(0,i[S].reactions=[...i[S].reactions,{type:O,count:1}],i),I=!1}}))}function tt(c,O){let S=[];for(const q of i[c].reactions)if(q.type===O){const Y=Number(q.count);Y>1&&S.push({...q,count:Y-1})}else S.push(q);t(0,i[c].reactions=S,i)}function Zt(c){kl.call(this,n,c)}const Gt=(c,O)=>{pe(c.idx,O.type)};function Wt(c,O,S,q){S[q]=c,t(0,i)}const Jt=(c,O,S,q)=>{t(0,O[S].isTextExpanded=q.detail.expanded,i)},Kt=c=>{pe(c.idx,"👍")},Qt=c=>{pe(c.idx,"️🔥")},$t=c=>{pe(c.idx,"😍")},el=c=>{pe(c.idx,"😋")},tl=c=>{pe(c.idx,"😊️️")},ll=(c,O)=>c+Number(O.count),nl=c=>{pe(c.idx,c.myReaction||"❤️")},sl=(c,O,S)=>{t(0,O[S].onReactionShowcase=!0,i);const q=()=>{t(0,O[S].onReactionShowcase=!1,i),window.removeEventListener("click",q)};setTimeout(()=>{window.addEventListener("click",q)},500)},il=()=>{if(!st())return ge.emit("showSignInModal",{removable:!0});t(2,U=!0)};function rl(c){De[c?"unshift":"push"](()=>{V=c,t(12,V)})}const al=()=>{var c;t(2,U=!1),Ze(`/viewer/edit?type=patch&postIdx=${(c=window.location.search.split("postIdx=")[1])==null?void 0:c.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},ol=()=>{t(2,U=!1),t(4,C=!0)},fl=()=>{Rl(a.url),isOpenActionSheet=!1},ul=()=>{t(2,U=!1),t(3,P=!0)};function cl(c){U=c,t(2,U)}function dl(c){P=c,t(3,P)}const hl=()=>{t(0,i[r].permission_signer="reported",i)},ml=()=>{t(0,i[r].permission_signer=null,i)},pl=()=>{$e(),t(4,C=!1)},gl=()=>{t(4,C=!1)};function _l(c){C=c,t(4,C)}return n.$$set=c=>{"posts"in c&&t(0,i=c.posts),"index"in c&&t(1,r=c.index),"type"in c&&t(17,f=c.type),"isEdit"in c&&t(5,u=c.isEdit),"dontMoveVertically"in c&&t(18,g=c.dontMoveVertically),"selectedReaction"in c&&t(19,v=c.selectedReaction),"hideActionButtons"in c&&t(6,E=c.hideActionButtons),"actionSheetMoreIsOpen"in c&&t(2,U=c.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in c&&t(3,P=c.actionSheetReportIsOpen),"modalVisible"in c&&t(4,C=c.modalVisible)},n.$$.update=()=>{var c;n.$$.dirty[0]&128&&a&&X(),n.$$.dirty[0]&524288&&v&&pe(v.postIdx,v.reaction),n.$$.dirty[0]&2&&et(r),n.$$.dirty[0]&3&&t(22,l=(c=i[r])==null?void 0:c.user_idx),n.$$.dirty[0]&4194304&&t(13,s=N(l)),n.$$.dirty[0]&3407875&&!g&&r>=i.length-Mn&&!K&&!Q&&me()},[i,r,U,P,C,u,E,a,B,m,k,T,V,s,Yt,$e,pe,f,g,v,K,Q,l,Zt,Gt,Wt,Jt,Kt,Qt,$t,el,tl,ll,nl,sl,il,rl,al,ol,fl,ul,cl,dl,hl,ml,pl,gl,_l]}class as extends fe{constructor(e){super(),ue(this,e,Bn,Tn,oe,{posts:0,index:1,type:17,isEdit:5,dontMoveVertically:18,selectedReaction:19,hideActionButtons:6,actionSheetMoreIsOpen:2,actionSheetReportIsOpen:3,modalVisible:4},null,[-1,-1,-1])}}export{as as V};
