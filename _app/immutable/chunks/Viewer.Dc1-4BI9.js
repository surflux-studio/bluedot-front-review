import{s as ue,D as re,i as F,f as _,e as T,a as q,t as be,c as y,b as B,g as j,d as ve,v as h,h as w,A as H,j as Ae,z as le,H as Ze,C as ee,n as $,q as Ce,r as Ee,E as Se,I as we,ag as We,B as Ge,K as Ue,w as Ie,x as Be,y as jt,T as Dn,M as Xt,Q as it,k as rt,U as Mn,F as Ln,J as Vn}from"./scheduler.B7IswjaW.js";import{S as ce,i as de,t as E,g as te,a as V,e as ne,c as K,d as W,m as G,f as J,b as Oe}from"./index.Bhf26fYQ.js";import{e as pe,u as Je,f as Pn,o as Ut}from"./each.CHeoyyv3.js";import{e as _e,A as Re,m as at,b as ot,I as Xe}from"./store.DzamesA2.js";import{g as Ke}from"./entry.CtRq8kOV.js";import{p as Bn}from"./stores.CSI25ST9.js";import{g as He,u as On}from"./searchParams.BevfY9c6.js";/* empty css                                                     *//* empty css                                                  */import{f as Rn,u as Sn}from"./follow.sjkCclOY.js";import{a as Le,b as Yt,g as Ye,i as ft}from"./sign.9qKuSyHg.js";import{C as An}from"./CircleImage.ClftpraO.js";import{g as ut}from"./color.C_Jm4JAr.js";import{s as ct}from"./s32cloudfront.RDEBwLXG.js";import{r as xe}from"./units.BJZU6p1c.js";import"./ActionSheet.svelte_svelte_type_style_lang.BF2rwJlf.js";import{i as Nn}from"./device.Dtp4J0Ng.js";import"./index.B5KU9kEZ.js";import{a as Fn}from"./NavigationBar.BFXKjZrX.js";import{C as zt}from"./Chip.CElMkW2W.js";import{B as qn}from"./BottomNavigationPadder.BzCNSg0T.js";import{C as jn,I as Xn,a as Un}from"./ChipInstagram.DeHinc6P.js";import{I as Yn}from"./IconMore.Bo4_A0rp.js";import{A as Ht,o as zn,a as Hn}from"./ActionSheet.sXPPua0_.js";import{M as Zn}from"./Modal.OE6FBgX_.js";import{f as Kn,c as Wn,a as Gn}from"./ActionSheetReport.svelte_svelte_type_style_lang.D_DSHjxt.js";import{F as Jn}from"./Figure.CBBiazvc.js";import{w as Qn,I as $n}from"./utils.DIcBnvnG.js";function dt(l){let e,t,n,s,a,r,f=l[0].unique_name+"",i,o,c,m=String(l[0].user_idx)!==String(Le()),b,C,O;const I=[tl,el],p=[];function d(k,P){return k[0].profile_image_url?0:1}t=d(l),n=p[t]=I[t](l);let g=m&&ht(l);return{c(){e=T("div"),n.c(),s=q(),a=T("div"),r=T("div"),i=be(f),o=q(),c=T("div"),g&&g.c(),this.h()},l(k){e=y(k,"DIV",{class:!0});var P=B(e);n.l(P),s=j(P),a=y(P,"DIV",{class:!0});var x=B(a);r=y(x,"DIV",{class:!0});var S=B(r);i=ve(S,f),S.forEach(_),o=j(x),c=y(x,"DIV",{class:!0});var N=B(c);g&&g.l(N),N.forEach(_),x.forEach(_),P.forEach(_),this.h()},h(){h(r,"class","text-sm text-white"),h(c,"class","flex gap-1 items-center"),h(a,"class","flex gap-1 items-center"),h(e,"class","flex gap-[0.625rem] justify-center items-center")},m(k,P){F(k,e,P),p[t].m(e,null),w(e,s),w(e,a),w(a,r),w(r,i),w(a,o),w(a,c),g&&g.m(c,null),b=!0,C||(O=H(r,"click",l[7]),C=!0)},p(k,P){let x=t;t=d(k),t===x?p[t].p(k,P):(te(),V(p[x],1,1,()=>{p[x]=null}),ne(),n=p[t],n?n.p(k,P):(n=p[t]=I[t](k),n.c()),E(n,1),n.m(e,s)),(!b||P&1)&&f!==(f=k[0].unique_name+"")&&Ae(i,f),P&1&&(m=String(k[0].user_idx)!==String(Le())),m?g?g.p(k,P):(g=ht(k),g.c(),g.m(c,null)):g&&(g.d(1),g=null)},i(k){b||(E(n),b=!0)},o(k){V(n),b=!1},d(k){k&&_(e),p[t].d(),g&&g.d(),C=!1,O()}}}function el(l){var f;let e,t,n=(((f=l[0].unique_name)==null?void 0:f.at(0))??"u")+"",s,a,r;return{c(){e=T("div"),t=T("span"),s=be(n),this.h()},l(i){e=y(i,"DIV",{class:!0,style:!0});var o=B(e);t=y(o,"SPAN",{class:!0});var c=B(t);s=ve(c,n),c.forEach(_),o.forEach(_),this.h()},h(){h(t,"class","text-base font-semibold text-black"),h(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),ee(e,"background-color",ut(l[0].unique_name))},m(i,o){F(i,e,o),w(e,t),w(t,s),a||(r=H(e,"click",l[6]),a=!0)},p(i,o){var c;o&1&&n!==(n=(((c=i[0].unique_name)==null?void 0:c.at(0))??"u")+"")&&Ae(s,n),o&1&&ee(e,"background-color",ut(i[0].unique_name))},i:$,o:$,d(i){i&&_(e),a=!1,r()}}}function tl(l){let e,t;return e=new An({props:{src:ct(l[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",l[5]),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){const a={};s&1&&(a.src=ct(n[0].profile_image_url,500)),e.$set(a)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function ht(l){let e,t="•",n,s,a=l[0].is_following?"팔로잉":"팔로우",r,f,i,o;return{c(){e=T("div"),e.textContent=t,n=q(),s=T("div"),r=be(a),this.h()},l(c){e=y(c,"DIV",{class:!0,"data-svelte-h":!0}),le(e)!=="svelte-168vif2"&&(e.textContent=t),n=j(c),s=y(c,"DIV",{class:!0});var m=B(s);r=ve(m,a),m.forEach(_),this.h()},h(){h(e,"class","text-xs text-white/60"),h(s,"class",f=`text-[0.8125rem] ${l[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(c,m){F(c,e,m),F(c,n,m),F(c,s,m),w(s,r),i||(o=H(s,"click",function(){Ze(l[0].is_following?l[2]:l[1])&&(l[0].is_following?l[2]:l[1]).apply(this,arguments)}),i=!0)},p(c,m){l=c,m&1&&a!==(a=l[0].is_following?"팔로잉":"팔로우")&&Ae(r,a),m&1&&f!==(f=`text-[0.8125rem] ${l[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&h(s,"class",f)},d(c){c&&(_(e),_(n),_(s)),i=!1,o()}}}function nl(l){let e,t,n=l[0].idx&&l[0].unique_name&&dt(l);return{c(){n&&n.c(),e=re()},l(s){n&&n.l(s),e=re()},m(s,a){n&&n.m(s,a),F(s,e,a),t=!0},p(s,[a]){s[0].idx&&s[0].unique_name?n?(n.p(s,a),a&1&&E(n,1)):(n=dt(s),n.c(),E(n,1),n.m(e.parentNode,e)):n&&(te(),V(n,1,1,()=>{n=null}),ne())},i(s){t||(E(n),t=!0)},o(s){V(n),t=!1},d(s){s&&_(e),n&&n.d(s)}}}function ll(l,e,t){let{post:n}=e,{allowFollow:s=!0}=e,{whenCancelFollow:a=()=>{}}=e,r=!1;async function f(){if(!s)return a();r||(r=!0,await Rn({targetIdx:n.user_idx,subjectIdx:Le()}),t(0,n.is_following=!0,n),r=!1)}async function i(){if(!s)return a();r||(r=!0,await Sn({targetIdx:n.user_idx,subjectIdx:Le()}),t(0,n.is_following=!1,n),r=!1)}const o=()=>{He(`/users/${n.user_idx}`)},c=()=>{He(`/users/${n.user_idx}`)},m=()=>{He(`/users/${n.user_idx}`)};return l.$$set=b=>{"post"in b&&t(0,n=b.post),"allowFollow"in b&&t(3,s=b.allowFollow),"whenCancelFollow"in b&&t(4,a=b.whenCancelFollow)},[n,f,i,s,a,o,c,m]}class sl extends ce{constructor(e){super(),de(this,e,ll,nl,ue,{post:0,allowFollow:3,whenCancelFollow:4})}}function il(l){let e,t,n,s;return{c(){e=Ce("svg"),t=Ce("path"),n=Ce("path"),this.h()},l(a){e=Ee(a,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var r=B(e);t=Ee(r,"path",{d:!0,fill:!0}),B(t).forEach(_),n=Ee(r,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),B(n).forEach(_),r.forEach(_),this.h()},h(){h(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),h(t,"fill",l[0]),h(n,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),h(n,"stroke",l[1]),h(n,"stroke-width","2"),h(n,"stroke-linejoin","round"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width",l[2]),h(e,"height",l[2]),h(e,"viewBox",s="0 0 "+l[2]+" "+l[2]),h(e,"fill","none")},m(a,r){F(a,e,r),w(e,t),w(e,n)},p(a,[r]){r&1&&h(t,"fill",a[0]),r&2&&h(n,"stroke",a[1]),r&4&&h(e,"width",a[2]),r&4&&h(e,"height",a[2]),r&4&&s!==(s="0 0 "+a[2]+" "+a[2])&&h(e,"viewBox",s)},i:$,o:$,d(a){a&&_(e)}}}function rl(l,e,t){let n,{fill:s="#FF4F1E"}=e,{stroke:a="#FF4F1E"}=e,{length:r=1.5}=e;return l.$$set=f=>{"fill"in f&&t(0,s=f.fill),"stroke"in f&&t(1,a=f.stroke),"length"in f&&t(3,r=f.length)},l.$$.update=()=>{l.$$.dirty&8&&t(2,n=xe(r))},[s,a,n,r]}class al extends ce{constructor(e){super(),de(this,e,rl,il,ue,{fill:0,stroke:1,length:3})}}function ze(l){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(n=>{const s=a=>a.stopPropagation();return l.addEventListener(n,s),{event:n,handler:s}});return{destroy(){t.forEach(({event:n,handler:s})=>{l.removeEventListener(n,s)})}}}function mt(l){let e,t;return e=new zt({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Fn,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:l[0].name}}),e.$on("click",l[1]),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){const a={};s&1&&(a.value=n[0].name),e.$set(a)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function ol(l){let e,t,n=l[0].idx&&mt(l);return{c(){n&&n.c(),e=re()},l(s){n&&n.l(s),e=re()},m(s,a){n&&n.m(s,a),F(s,e,a),t=!0},p(s,[a]){s[0].idx?n?(n.p(s,a),a&1&&E(n,1)):(n=mt(s),n.c(),E(n,1),n.m(e.parentNode,e)):n&&(te(),V(n,1,1,()=>{n=null}),ne())},i(s){t||(E(n),t=!0)},o(s){V(n),t=!1},d(s){s&&_(e),n&&n.d(s)}}}function fl(l,e,t){let{place:n}=e;const s=async()=>{await Ke(`/places/${n.idx}`)};return l.$$set=a=>{"place"in a&&t(0,n=a.place)},[n,s]}class ul extends ce{constructor(e){super(),de(this,e,fl,ol,ue,{place:0})}}function cl(l,e=500,t=10){let n,s,a;const r=o=>{if("TouchEvent"in window&&o instanceof TouchEvent&&o.touches.length>=2)return clearTimeout(n);const{clientX:c,clientY:m}=o instanceof MouseEvent?o:o.touches[0];s=c,a=m,n=setTimeout(()=>{l.dispatchEvent(new CustomEvent("longpress",{detail:o}))},e)},f=o=>{if("TouchEvent"in window&&o instanceof TouchEvent&&o.touches.length>=2)return clearTimeout(n);const{clientX:c,clientY:m}=o instanceof MouseEvent?o:o.touches[0],b=Math.abs(c-s),C=Math.abs(m-a);(b>t||C>t)&&clearTimeout(n)},i=()=>{clearTimeout(n)};return l.addEventListener("mousedown",r),l.addEventListener("mousemove",f),l.addEventListener("mouseup",i),l.addEventListener("mouseleave",i),l.addEventListener("touchstart",r),l.addEventListener("touchmove",f),l.addEventListener("touchend",i),l.addEventListener("touchcancel",i),{destroy(){l.removeEventListener("mousedown",r),l.removeEventListener("mousemove",f),l.removeEventListener("mouseup",i),l.removeEventListener("mouseleave",i),l.removeEventListener("touchstart",r),l.removeEventListener("touchmove",f),l.removeEventListener("touchend",i),l.removeEventListener("touchcancel",i)}}}function dl(l){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(n){e=Ee(n,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=B(e);t=Ee(s,"path",{d:!0}),B(t).forEach(_),s.forEach(_),this.h()},h(){h(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",l[1]),h(e,"height",l[1]),h(e,"fill",l[0])},m(n,s){F(n,e,s),w(e,t)},p(n,[s]){s&2&&h(e,"width",n[1]),s&2&&h(e,"height",n[1]),s&1&&h(e,"fill",n[0])},i:$,o:$,d(n){n&&_(e)}}}function hl(l,e,t){let n,{fill:s="#5f6368"}=e,{length:a="1.75"}=e,{alt:r="Edit"}=e;return l.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,a=f.length),"alt"in f&&t(3,r=f.alt)},l.$$.update=()=>{l.$$.dirty&4&&t(1,n=xe(a))},[s,n,a,r]}class ml extends ce{constructor(e){super(),de(this,e,hl,dl,ue,{fill:0,length:2,alt:3})}}function pl(l){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(n){e=Ee(n,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=B(e);t=Ee(s,"path",{d:!0}),B(t).forEach(_),s.forEach(_),this.h()},h(){h(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",l[1]),h(e,"height",l[1]),h(e,"fill",l[0])},m(n,s){F(n,e,s),w(e,t)},p(n,[s]){s&2&&h(e,"width",n[1]),s&2&&h(e,"height",n[1]),s&1&&h(e,"fill",n[0])},i:$,o:$,d(n){n&&_(e)}}}function gl(l,e,t){let n,{fill:s="#5f6368"}=e,{length:a="1.75"}=e,{alt:r="Delete"}=e;return l.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,a=f.length),"alt"in f&&t(3,r=f.alt)},l.$$.update=()=>{l.$$.dirty&4&&t(1,n=xe(a))},[s,n,a,r]}class _l extends ce{constructor(e){super(),de(this,e,gl,pl,ue,{fill:0,length:2,alt:3})}}function bl(l){let e,t=(l[0].text||"")+"",n,s,a;return{c(){e=T("p"),n=be(t),this.h()},l(r){e=y(r,"P",{class:!0,style:!0});var f=B(e);n=ve(f,t),f.forEach(_),this.h()},h(){h(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),h(e,"style",`
      overflow: hidden;
      height: ${l[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(r,f){F(r,e,f),w(e,n),s||(a=[Se(ze.call(null,e)),H(e,"click",l[2])],s=!0)},p(r,[f]){f&1&&t!==(t=(r[0].text||"")+"")&&Ae(n,t)},i:$,o:$,d(r){r&&_(e),s=!1,we(a)}}}function vl(l,e,t){const n=We();let{post:s}=e;const a=xe(1),r=xe(6);function f(i){const o=i.currentTarget;if(o)if(o.style.height===`${a}px`||!o.style.height){if(o.scrollHeight>a){const c=o.scrollHeight<r?o.scrollHeight:r;o.style.height=`${c}px`,o.style.overflow="scroll",o.style.display="block",o.style.webkitLineClamp="unset",n("textExpanded",{expanded:!0})}}else o.style.height=`${a}px`,o.style.overflow="hidden",o.style.display="-webkit-box",o.style.webkitLineClamp="1",n("textExpanded",{expanded:!1})}return Ge(()=>{n("textExpanded",{expanded:!1})}),l.$$set=i=>{"post"in i&&t(0,s=i.post)},[s,a,f]}class wl extends ce{constructor(e){super(),de(this,e,vl,bl,ue,{post:0})}}function kl(l){let e;return{c(){e=T("div"),this.h()},l(t){e=y(t,"DIV",{class:!0,style:!0}),B(e).forEach(_),this.h()},h(){h(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),ee(e,"opacity","0.6"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,n){F(t,e,n)},d(t){t&&_(e)}}}function Cl(l){let e;return{c(){e=T("div"),this.h()},l(t){e=y(t,"DIV",{class:!0,style:!0}),B(e).forEach(_),this.h()},h(){h(e,"class","fixed inset-0 pointer-events-none z-30"),ee(e,"opacity","0.7"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,n){F(t,e,n)},d(t){t&&_(e)}}}function El(l){let e;function t(a,r){return a[0]?Cl:kl}let n=t(l),s=n(l);return{c(){s.c(),e=re()},l(a){s.l(a),e=re()},m(a,r){s.m(a,r),F(a,e,r)},p(a,[r]){n!==(n=t(a))&&(s.d(1),s=n(a),s&&(s.c(),s.m(e.parentNode,e)))},i:$,o:$,d(a){a&&_(e),s.d(a)}}}function Il(l,e,t){let{isTextExpanded:n=!1}=e;return l.$$set=s=>{"isTextExpanded"in s&&t(0,n=s.isTextExpanded)},[n]}class xl extends ce{constructor(e){super(),de(this,e,Il,El,ue,{isTextExpanded:0})}}function pt(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function gt(l,e){let t,n,s,a,r,f=$;return{key:l,first:null,c(){t=T("span"),n=T("span"),a=q(),this.h()},l(i){t=y(i,"SPAN",{class:!0,style:!0});var o=B(t);n=y(o,"SPAN",{class:!0,style:!0}),B(n).forEach(_),a=j(o),o.forEach(_),this.h()},h(){h(n,"class",s=Ue(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),ee(n,"transform","scale("+e[4](e[7])+")"),ee(n,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),h(t,"class","flex items-center justify-center"),ee(t,"width","0.375rem"),ee(t,"height","0.375rem"),this.first=t},m(i,o){F(i,t,o),w(t,n),w(t,a)},p(i,o){e=i,o&13&&s!==(s=Ue(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&h(n,"class",s),o&8&&ee(n,"transform","scale("+e[4](e[7])+")"),o&13&&ee(n,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){r=t.getBoundingClientRect()},f(){Kn(t),f()},a(){f(),f=Wn(t,r,Gn,{})},d(i){i&&_(t)}}}function Tl(l){let e,t=[],n=new Map,s,a=pe(l[3]);const r=f=>f[5];for(let f=0;f<a.length;f+=1){let i=pt(l,a,f),o=r(i);n.set(o,t[f]=gt(o,i))}return{c(){e=T("div");for(let f=0;f<t.length;f+=1)t[f].c();this.h()},l(f){e=y(f,"DIV",{class:!0});var i=B(e);for(let o=0;o<t.length;o+=1)t[o].l(i);i.forEach(_),this.h()},h(){h(e,"class",s=Ue(`
    ${l[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(f,i){F(f,e,i);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(f,[i]){if(i&29){a=pe(f[3]);for(let o=0;o<t.length;o+=1)t[o].r();t=Je(t,i,r,1,f,a,n,e,Pn,gt,null,pt);for(let o=0;o<t.length;o+=1)t[o].a()}i&2&&s!==(s=Ue(`
    ${f[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&h(e,"class",s)},i:$,o:$,d(f){f&&_(e);for(let i=0;i<t.length;i+=1)t[i].d()}}}const Me=7;function yl(l,e,t){let{post:n}=e,{fixed:s=!0}=e,a=[],r=0;function f(i){const o=n.mediaIdx-r,c=a.length;if(c<=1)return 1;const m=Math.max(o,c-1-o);return m===0?1:1-Math.abs(i-o)/m*.5}return l.$$set=i=>{"post"in i&&t(0,n=i.post),"fixed"in i&&t(1,s=i.fixed)},l.$$.update=()=>{l.$$.dirty&5&&(n.media.length>Me?(n.mediaIdx<=Math.floor(Me/2)?t(2,r=0):n.mediaIdx>=n.media.length-Math.ceil(Me/2)?t(2,r=n.media.length-Me):t(2,r=n.mediaIdx-Math.floor(Me/2)),t(3,a=n.media.slice(r,r+Me))):(t(2,r=0),t(3,a=n.media)))},[n,s,r,a,f]}class Zt extends ce{constructor(e){super(),de(this,e,yl,Tl,ue,{post:0,fixed:1})}}function _t(l,e,t){const n=l.slice();return n[16]=e[t].text,n[17]=e[t].value,n[18]=e[t].custom,n[20]=t,n}function bt(l){let e,t,n,s,a=l[16]+"",r,f,i,o;return{c(){e=T("label"),t=T("input"),n=q(),s=T("span"),r=be(a),f=q(),this.h()},l(c){e=y(c,"LABEL",{class:!0});var m=B(e);t=y(m,"INPUT",{type:!0,name:!0,class:!0}),n=j(m),s=y(m,"SPAN",{class:!0});var b=B(s);r=ve(b,a),b.forEach(_),f=j(m),m.forEach(_),this.h()},h(){h(t,"type","radio"),h(t,"name","report"),h(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=l[17],h(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"class","flex gap-2 py-2")},m(c,m){F(c,e,m),w(e,t),w(e,n),w(e,s),w(s,r),w(e,f),i||(o=H(t,"change",l[8]),i=!0)},p:$,d(c){c&&_(e),i=!1,o()}}}function vt(l){let e,t,n,s;return{c(){e=T("div"),t=T("textarea"),this.h()},l(a){e=y(a,"DIV",{class:!0});var r=B(e);t=y(r,"TEXTAREA",{class:!0,style:!0,placeholder:!0}),B(t).forEach(_),r.forEach(_),this.h()},h(){h(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal focus:outline-none focus:ring-0 appearance-none "),ee(t,"-webkit-tap-highlight-color","transparent"),h(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),h(e,"class","px-5 py-2.5")},m(a,r){F(a,e,r),w(e,t),l[9](t),it(t,l[3]),n||(s=H(t,"input",l[10]),n=!0)},p(a,r){r&8&&it(t,a[3])},d(a){a&&_(e),l[9](null),n=!1,s()}}}function Dl(l){let e,t,n="게시물 신고 사유",s,a,r,f,i,o,c="취소",m,b,C="신고",O,I,p=pe(l[4]),d=[];for(let k=0;k<p.length;k+=1)d[k]=bt(_t(l,p,k));let g=l[1]==="etc"&&vt(l);return{c(){e=T("div"),t=T("heading"),t.textContent=n,s=q(),a=T("div");for(let k=0;k<d.length;k+=1)d[k].c();r=q(),g&&g.c(),f=q(),i=T("div"),o=T("button"),o.textContent=c,m=q(),b=T("button"),b.textContent=C,this.h()},l(k){e=y(k,"DIV",{class:!0});var P=B(e);t=y(P,"HEADING",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-z3puxq"&&(t.textContent=n),s=j(P),a=y(P,"DIV",{class:!0});var x=B(a);for(let N=0;N<d.length;N+=1)d[N].l(x);x.forEach(_),r=j(P),g&&g.l(P),f=j(P),i=y(P,"DIV",{class:!0});var S=B(i);o=y(S,"BUTTON",{class:!0,"data-svelte-h":!0}),le(o)!=="svelte-xb8aop"&&(o.textContent=c),m=j(S),b=y(S,"BUTTON",{class:!0,"data-svelte-h":!0}),le(b)!=="svelte-1fehi46"&&(b.textContent=C),S.forEach(_),P.forEach(_),this.h()},h(){h(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),h(a,"class","px-5"),h(o,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),h(b,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),h(i,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),h(e,"class","flex flex-col gap-2.5")},m(k,P){F(k,e,P),w(e,t),w(e,s),w(e,a);for(let x=0;x<d.length;x+=1)d[x]&&d[x].m(a,null);w(e,r),g&&g.m(e,null),w(e,f),w(e,i),w(i,o),w(i,m),w(i,b),O||(I=[H(o,"click",l[11]),H(b,"click",l[5]),Se(ze.call(null,e))],O=!0)},p(k,P){if(P&18){p=pe(k[4]);let x;for(x=0;x<p.length;x+=1){const S=_t(k,p,x);d[x]?d[x].p(S,P):(d[x]=bt(S),d[x].c(),d[x].m(a,null))}for(;x<d.length;x+=1)d[x].d(1);d.length=p.length}k[1]==="etc"?g?g.p(k,P):(g=vt(k),g.c(),g.m(e,f)):g&&(g.d(1),g=null)},d(k){k&&_(e),Xt(d,k),g&&g.d(),O=!1,we(I)}}}function Ml(l){let e,t,n;function s(r){l[12](r)}let a={noHandle:!0,fixed:!0,$$slots:{default:[Dl]},$$scope:{ctx:l}};return l[0]!==void 0&&(a.isOpen=l[0]),e=new Ht({props:a}),Ie.push(()=>Oe(e,"isOpen",s)),{c(){K(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,f){G(e,r,f),n=!0},p(r,[f]){const i={};f&2097167&&(i.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,i.isOpen=r[0],Be(()=>t=!1)),e.$set(i)},i(r){n||(E(e.$$.fragment,r),n=!0)},o(r){V(e.$$.fragment,r),n=!1},d(r){J(e,r)}}}function Ll(l,e,t){const n=We();let{isOpen:s}=e,{selectedValue:a=""}=e,{targetTable:r=""}=e,{targetIdx:f=""}=e,i=null;const o=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let c="",m=!1;function b(){Dn().then(()=>{i==null||i.scrollIntoView({behavior:"smooth",block:"start"})})}jt(()=>{zn(()=>{},b,()=>{})}),Ge(()=>{Hn()});async function C(){const k=o.findIndex(P=>P.value===a);if(k===-1){alert("신고 사유를 선택해주세요.");return}if(!m){m=!0,_e.emit("loading",!0);try{const P=o[k],x=new URL(`${Re}/auth/permissions`);x.searchParams.set("targetTable",r),x.searchParams.set("targetIdx",f),x.searchParams.set("relation","reported"),x.searchParams.set("subjectTable","users"),x.searchParams.set("subjectIdx",Yt().sub),x.searchParams.set("metadata",JSON.stringify({...P,customReason:c})),t(0,s=!1),t(3,c=""),await fetch(x,{method:"PUT",headers:{Authorization:`Bearer ${Ye()}`}}),n("reported")}finally{m=!1,_e.emit("loading",!1)}}}const O=k=>{t(1,a=k.target.value)};function I(k){Ie[k?"unshift":"push"](()=>{i=k,t(2,i)})}function p(){c=this.value,t(3,c)}const d=()=>{t(0,s=!1)};function g(k){s=k,t(0,s)}return l.$$set=k=>{"isOpen"in k&&t(0,s=k.isOpen),"selectedValue"in k&&t(1,a=k.selectedValue),"targetTable"in k&&t(6,r=k.targetTable),"targetIdx"in k&&t(7,f=k.targetIdx)},[s,a,i,c,o,C,r,f,O,I,p,d,g]}class Vl extends ce{constructor(e){super(),de(this,e,Ll,Ml,ue,{isOpen:0,selectedValue:1,targetTable:6,targetIdx:7})}}function wt(l){let e,t,n,s="이 게시물을 신고해 주셔서 감사합니다.",a,r,f="신고 취소하기",i,o;return{c(){e=T("div"),t=T("div"),n=T("div"),n.textContent=s,a=q(),r=T("div"),r.textContent=f,this.h()},l(c){e=y(c,"DIV",{class:!0});var m=B(e);t=y(m,"DIV",{class:!0});var b=B(t);n=y(b,"DIV",{class:!0,"data-svelte-h":!0}),le(n)!=="svelte-179ijsk"&&(n.textContent=s),a=j(b),r=y(b,"DIV",{class:!0,"data-svelte-h":!0}),le(r)!=="svelte-1haiztv"&&(r.textContent=f),b.forEach(_),m.forEach(_),this.h()},h(){h(n,"class","text-white text-[0.9375rem] font-semibold"),h(r,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),h(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),h(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(c,m){F(c,e,m),w(e,t),w(t,n),w(t,a),w(t,r),i||(o=H(r,"click",l[1]),i=!0)},p:$,d(c){c&&_(e),i=!1,o()}}}function Pl(l){let e,t=l[0]&&wt(l);return{c(){t&&t.c(),e=re()},l(n){t&&t.l(n),e=re()},m(n,s){t&&t.m(n,s),F(n,e,s)},p(n,[s]){n[0]?t?t.p(n,s):(t=wt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(n){n&&_(e),t&&t.d(n)}}}function Bl(l,e,t){const n=We();let{isVisible:s=!1}=e,{targetTable:a=""}=e,{targetIdx:r=""}=e,f=!1;async function i(){if(f!==!0){f=!0,_e.emit("loading",!0);try{const o=new URL(`${Re}/auth/permissions`);o.searchParams.set("targetTable",a),o.searchParams.set("targetIdx",r),o.searchParams.set("relation","reported"),o.searchParams.set("subjectTable","users"),o.searchParams.set("subjectIdx",Yt().sub),await fetch(o,{method:"DELETE",headers:{Authorization:`Bearer ${Ye()}`}}),t(0,s=!1),n("unreported")}finally{f=!1,_e.emit("loading",!1)}}}return l.$$set=o=>{"isVisible"in o&&t(0,s=o.isVisible),"targetTable"in o&&t(2,a=o.targetTable),"targetIdx"in o&&t(3,r=o.targetIdx)},[s,i,a,r]}class Ol extends ce{constructor(e){super(),de(this,e,Bl,Pl,ue,{isVisible:0,targetTable:2,targetIdx:3})}}function kt(l,e,t){const n=l.slice();return n[82]=e[t],n[83]=e,n[84]=t,n}function Ct(l,e,t){const n=l.slice();return n[85]=e[t],n}function Et(l,e,t){const n=l.slice();return n[88]=e[t],n[90]=t,n}function It(l){let e,t,n;return{c(){e=T("div"),this.h()},l(s){e=y(s,"DIV",{class:!0}),B(e).forEach(_),this.h()},h(){h(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,a){F(s,e,a),t||(n=H(e,"contextmenu",Ln(l[25])),t=!0)},d(s){s&&_(e),t=!1,n()}}}function xt(l){let e,t,n,s=[],a=new Map,r,f,i,o,c,m,b,C=pe(l[82].media);const O=p=>p[88];for(let p=0;p<C.length;p+=1){let d=Et(l,C,p),g=O(d);a.set(g,s[p]=Tt(g,d))}let I=!l[4]&&yt(l);return{c(){e=T("section"),t=T("div"),n=T("div");for(let p=0;p<s.length;p+=1)s[p].c();f=q(),I&&I.c(),i=q(),this.h()},l(p){e=y(p,"SECTION",{class:!0,style:!0});var d=B(e);t=y(d,"DIV",{class:!0});var g=B(t);n=y(g,"DIV",{class:!0,style:!0});var k=B(n);for(let P=0;P<s.length;P+=1)s[P].l(k);k.forEach(_),g.forEach(_),f=j(d),I&&I.l(d),i=j(d),d.forEach(_),this.h()},h(){h(n,"class",r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(l[8]?"duration-0 transition-duration-0":"")),ee(n,"transform","translateX("+(-l[82].mediaIdx*l[11].width+l[10])+"px)"),h(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),h(e,"class",o=`w-full h-full absolute content-center transition-transform
            ${l[8]?"duration-0 transition-duration-0":""}`),ee(e,"top","0"),ee(e,"transform","translateY("+((l[84]-l[0])*l[11].height+l[9])+"px)")},m(p,d){F(p,e,d),w(e,t),w(t,n);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(n,null);w(e,f),I&&I.m(e,null),w(e,i),c=!0,m||(b=[H(n,"transitionend",function(){Ze(l[82].mediaIdx===l[7][l[0]].mediaIdx?l[15]:void 0)&&(l[82].mediaIdx===l[7][l[0]].mediaIdx?l[15]:void 0).apply(this,arguments)}),H(e,"transitionend",function(){Ze(l[84]===l[0]?l[15]:void 0)&&(l[84]===l[0]?l[15]:void 0).apply(this,arguments)})],m=!0)},p(p,d){l=p,d[0]&16529&&(C=pe(l[82].media),te(),s=Je(s,d,O,1,l,C,a,n,Ut,Tt,null,Et),ne()),(!c||d[0]&256&&r!==(r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(l[8]?"duration-0 transition-duration-0":"")))&&h(n,"class",r),(!c||d[0]&3200)&&ee(n,"transform","translateX("+(-l[82].mediaIdx*l[11].width+l[10])+"px)"),l[4]?I&&(te(),V(I,1,1,()=>{I=null}),ne()):I?(I.p(l,d),d[0]&16&&E(I,1)):(I=yt(l),I.c(),E(I,1),I.m(e,i)),(!c||d[0]&256&&o!==(o=`w-full h-full absolute content-center transition-transform
            ${l[8]?"duration-0 transition-duration-0":""}`))&&h(e,"class",o),(!c||d[0]&2689)&&ee(e,"transform","translateY("+((l[84]-l[0])*l[11].height+l[9])+"px)")},i(p){if(!c){for(let d=0;d<C.length;d+=1)E(s[d]);E(I),c=!0}},o(p){for(let d=0;d<s.length;d+=1)V(s[d]);V(I),c=!1},d(p){p&&_(e);for(let d=0;d<s.length;d+=1)s[d].d();I&&I.d(),m=!1,we(b)}}}function Tt(l,e){let t,n,s,a,r,f;return s=new Jn({props:{src:e[88],isEdit:e[4],post:e[7][e[0]],muted:e[14],autoplay:e[0]===e[84]&&e[7][e[0]].mediaIdx===e[90],isRightOrder:e[0]===e[84]}}),{key:l,first:null,c(){t=T("div"),n=T("div"),K(s.$$.fragment),r=q(),this.h()},l(i){t=y(i,"DIV",{class:!0});var o=B(t);n=y(o,"DIV",{class:!0});var c=B(n);W(s.$$.fragment,c),c.forEach(_),r=j(o),o.forEach(_),this.h()},h(){h(n,"class",a=`
                      w-full h-full flex justify-center items-center relative
                      ${e[4]?"px-5 pt-5 pb-3":""}
                    `),h(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(i,o){F(i,t,o),w(t,n),G(s,n,null),w(t,r),f=!0},p(i,o){e=i;const c={};o[0]&128&&(c.src=e[88]),o[0]&16&&(c.isEdit=e[4]),o[0]&129&&(c.post=e[7][e[0]]),o[0]&16384&&(c.muted=e[14]),o[0]&129&&(c.autoplay=e[0]===e[84]&&e[7][e[0]].mediaIdx===e[90]),o[0]&129&&(c.isRightOrder=e[0]===e[84]),s.$set(c),(!f||o[0]&16&&a!==(a=`
                      w-full h-full flex justify-center items-center relative
                      ${e[4]?"px-5 pt-5 pb-3":""}
                    `))&&h(n,"class",a)},i(i){f||(E(s.$$.fragment,i),f=!0)},o(i){V(s.$$.fragment,i),f=!1},d(i){i&&_(t),J(s)}}}function yt(l){var D,U;let e,t,n,s,a,r,f,i,o,c,m,b,C,O,I,p=l[82].media.length>1&&Dt(l),d=((D=l[82].reference)==null?void 0:D.origin)==="instagram"&&Mt(l),g=((U=l[82].reactions)==null?void 0:U.length)>0&&!l[5]&&Lt(l);function k(R){l[28](R,l[82],l[83],l[84])}let P={allowFollow:!Xe,whenCancelFollow:l[27]};l[82]!==void 0&&(P.post=l[82]),r=new sl({props:P}),Ie.push(()=>Oe(r,"post",k));function x(...R){return l[29](l[82],l[83],l[84],...R)}o=new wl({props:{post:l[82]}}),o.$on("textExpanded",x),m=new ul({props:{place:{idx:l[82].place_idx,name:l[82].place_name}}});let S=!l[5]&&Pt(l),N=l[0]===l[84]&&Ot(l);return{c(){p&&p.c(),e=q(),t=T("div"),n=T("div"),d&&d.c(),s=q(),g&&g.c(),a=q(),K(r.$$.fragment),i=q(),K(o.$$.fragment),c=q(),K(m.$$.fragment),b=q(),S&&S.c(),C=q(),N&&N.c(),O=re(),this.h()},l(R){p&&p.l(R),e=j(R),t=y(R,"DIV",{class:!0});var Y=B(t);n=y(Y,"DIV",{class:!0});var Z=B(n);d&&d.l(Z),s=j(Z),g&&g.l(Z),a=j(Z),W(r.$$.fragment,Z),i=j(Z),W(o.$$.fragment,Z),c=j(Z),W(m.$$.fragment,Z),Z.forEach(_),b=j(Y),S&&S.l(Y),Y.forEach(_),C=j(R),N&&N.l(R),O=re(),this.h()},h(){h(n,"class","flex-grow text-white text-md flex flex-col items-start gap-3 transition-transform text-base "),h(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(R,Y){p&&p.m(R,Y),F(R,e,Y),F(R,t,Y),w(t,n),d&&d.m(n,null),w(n,s),g&&g.m(n,null),w(n,a),G(r,n,null),w(n,i),G(o,n,null),w(n,c),G(m,n,null),w(t,b),S&&S.m(t,null),F(R,C,Y),N&&N.m(R,Y),F(R,O,Y),I=!0},p(R,Y){var fe,ae;l=R,l[82].media.length>1?p?(p.p(l,Y),Y[0]&128&&E(p,1)):(p=Dt(l),p.c(),E(p,1),p.m(e.parentNode,e)):p&&(te(),V(p,1,1,()=>{p=null}),ne()),((fe=l[82].reference)==null?void 0:fe.origin)==="instagram"?d?(d.p(l,Y),Y[0]&128&&E(d,1)):(d=Mt(l),d.c(),E(d,1),d.m(n,s)):d&&(te(),V(d,1,1,()=>{d=null}),ne()),((ae=l[82].reactions)==null?void 0:ae.length)>0&&!l[5]?g?(g.p(l,Y),Y[0]&160&&E(g,1)):(g=Lt(l),g.c(),E(g,1),g.m(n,a)):g&&(te(),V(g,1,1,()=>{g=null}),ne());const Z={};Y[0]&64&&(Z.whenCancelFollow=l[27]),!f&&Y[0]&128&&(f=!0,Z.post=l[82],Be(()=>f=!1)),r.$set(Z);const oe={};Y[0]&128&&(oe.post=l[82]),o.$set(oe);const he={};Y[0]&128&&(he.place={idx:l[82].place_idx,name:l[82].place_name}),m.$set(he),l[5]?S&&(te(),V(S,1,1,()=>{S=null}),ne()):S?(S.p(l,Y),Y[0]&32&&E(S,1)):(S=Pt(l),S.c(),E(S,1),S.m(t,null)),l[0]===l[84]?N?(N.p(l,Y),Y[0]&129&&E(N,1)):(N=Ot(l),N.c(),E(N,1),N.m(O.parentNode,O)):N&&(te(),V(N,1,1,()=>{N=null}),ne())},i(R){I||(E(p),E(d),E(g),E(r.$$.fragment,R),E(o.$$.fragment,R),E(m.$$.fragment,R),E(S),E(N),I=!0)},o(R){V(p),V(d),V(g),V(r.$$.fragment,R),V(o.$$.fragment,R),V(m.$$.fragment,R),V(S),V(N),I=!1},d(R){R&&(_(e),_(t),_(C),_(O)),p&&p.d(R),d&&d.d(),g&&g.d(),J(r),J(o),J(m),S&&S.d(),N&&N.d(R)}}}function Dt(l){let e,t;return e=new Zt({props:{post:l[82]}}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){const a={};s[0]&128&&(a.post=n[82]),e.$set(a)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Mt(l){let e,t;return e=new jn({props:{url:l[82].reference.url,name:l[82].reference.name}}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){const a={};s[0]&128&&(a.url=n[82].reference.url),s[0]&128&&(a.name=n[82].reference.name),e.$set(a)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Lt(l){let e,t,n=pe(l[82].reactions),s=[];for(let r=0;r<n.length;r+=1)s[r]=Vt(Ct(l,n,r));const a=r=>V(s[r],1,1,()=>{s[r]=null});return{c(){e=T("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=y(r,"DIV",{class:!0});var f=B(e);for(let i=0;i<s.length;i+=1)s[i].l(f);f.forEach(_),this.h()},h(){h(e,"class","flex gap-1 justify-center items-center mb-1")},m(r,f){F(r,e,f);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);t=!0},p(r,f){if(f[0]&131200){n=pe(r[82].reactions);let i;for(i=0;i<n.length;i+=1){const o=Ct(r,n,i);s[i]?(s[i].p(o,f),E(s[i],1)):(s[i]=Vt(o),s[i].c(),E(s[i],1),s[i].m(e,null))}for(te(),i=n.length;i<s.length;i+=1)a(i);ne()}},i(r){if(!t){for(let f=0;f<n.length;f+=1)E(s[f]);t=!0}},o(r){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)V(s[f]);t=!1},d(r){r&&_(e),Xt(s,r)}}}function Vt(l){let e,t;function n(){return l[26](l[82],l[85])}return e=new zt({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:l[85].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:l[85].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",n),{c(){K(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,a){G(e,s,a),t=!0},p(s,a){l=s;const r={};a[0]&128&&(r.prefix=l[85].type),a[0]&128&&(r.value=l[85].count),e.$set(r)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){V(e.$$.fragment,s),t=!1},d(s){J(e,s)}}}function Pt(l){var N;let e,t,n,s,a,r,f,i,o=((N=l[82].reactions)!=null&&N.length?l[82].reactions.reduce(l[35],0):0)+"",c,m,b,C,O,I,p,d=l[82].onReactionShowcase&&Bt(l);const g=[Sl,Rl],k=[];function P(D,U){return D[82].myReaction?0:1}a=P(l),r=k[a]=g[a](l);function x(){return l[36](l[82])}function S(){return l[37](l[82],l[83],l[84])}return C=new Yn({props:{fill:"white",length:1.5}}),{c(){e=T("div"),t=T("div"),d&&d.c(),n=q(),s=T("button"),r.c(),f=q(),i=T("span"),c=be(o),m=q(),b=T("button"),K(C.$$.fragment),this.h()},l(D){e=y(D,"DIV",{class:!0});var U=B(e);t=y(U,"DIV",{class:!0});var R=B(t);d&&d.l(R),n=j(R),s=y(R,"BUTTON",{class:!0});var Y=B(s);r.l(Y),f=j(Y),i=y(Y,"SPAN",{class:!0});var Z=B(i);c=ve(Z,o),Z.forEach(_),Y.forEach(_),R.forEach(_),m=j(U),b=y(U,"BUTTON",{});var oe=B(b);W(C.$$.fragment,oe),oe.forEach(_),U.forEach(_),this.h()},h(){h(i,"class","text-xs text-white h-4"),h(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),h(t,"class","flex gap-4 relative"),h(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(D,U){F(D,e,U),w(e,t),d&&d.m(t,null),w(t,n),w(t,s),k[a].m(s,null),w(s,f),w(s,i),w(i,c),w(e,m),w(e,b),G(C,b,null),O=!0,I||(p=[H(s,"click",x),Se(ze.call(null,s)),Se(cl.call(null,s,500)),H(s,"longpress",S),H(b,"click",l[38])],I=!0)},p(D,U){var Y;l=D,l[82].onReactionShowcase?d?d.p(l,U):(d=Bt(l),d.c(),d.m(t,n)):d&&(d.d(1),d=null);let R=a;a=P(l),a!==R&&(te(),V(k[R],1,1,()=>{k[R]=null}),ne(),r=k[a],r||(r=k[a]=g[a](l),r.c()),E(r,1),r.m(s,f)),(!O||U[0]&128)&&o!==(o=((Y=l[82].reactions)!=null&&Y.length?l[82].reactions.reduce(l[35],0):0)+"")&&Ae(c,o)},i(D){O||(E(r),E(C.$$.fragment,D),O=!0)},o(D){V(r),V(C.$$.fragment,D),O=!1},d(D){D&&_(e),d&&d.d(),k[a].d(),J(C),I=!1,we(p)}}}function Bt(l){let e,t,n="👍",s,a,r="🔥",f,i,o="😍",c,m,b="😋",C,O,I="😊️️",p,d;function g(){return l[30](l[82])}function k(){return l[31](l[82])}function P(){return l[32](l[82])}function x(){return l[33](l[82])}function S(){return l[34](l[82])}return{c(){e=T("div"),t=T("button"),t.textContent=n,s=q(),a=T("button"),a.textContent=r,f=q(),i=T("button"),i.textContent=o,c=q(),m=T("button"),m.textContent=b,C=q(),O=T("button"),O.textContent=I,this.h()},l(N){e=y(N,"DIV",{class:!0});var D=B(e);t=y(D,"BUTTON",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-3oecln"&&(t.textContent=n),s=j(D),a=y(D,"BUTTON",{class:!0,"data-svelte-h":!0}),le(a)!=="svelte-131qbu2"&&(a.textContent=r),f=j(D),i=y(D,"BUTTON",{class:!0,"data-svelte-h":!0}),le(i)!=="svelte-lq90i3"&&(i.textContent=o),c=j(D),m=y(D,"BUTTON",{class:!0,"data-svelte-h":!0}),le(m)!=="svelte-l73y87"&&(m.textContent=b),C=j(D),O=y(D,"BUTTON",{class:!0,"data-svelte-h":!0}),le(O)!=="svelte-11szxsj"&&(O.textContent=I),D.forEach(_),this.h()},h(){h(t,"class","text-2xl/[26px]"),h(a,"class","text-2xl/[26px]"),h(i,"class","text-2xl/[26px]"),h(m,"class","text-2xl/[26px]"),h(O,"class","text-2xl/[26px]"),h(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(N,D){F(N,e,D),w(e,t),w(e,s),w(e,a),w(e,f),w(e,i),w(e,c),w(e,m),w(e,C),w(e,O),p||(d=[H(t,"click",g),H(a,"click",k),H(i,"click",P),H(m,"click",x),H(O,"click",S)],p=!0)},p(N,D){l=N},d(N){N&&_(e),p=!1,we(d)}}}function Rl(l){let e,t;return e=new Xn({props:{fill:"white",length:1.5}}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Sl(l){let e,t;return e=new Un({props:{fill:"#EA3323",length:1.5}}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Ot(l){let e,t;return e=new xl({props:{isTextExpanded:l[82].isTextExpanded}}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){const a={};s[0]&128&&(a.isTextExpanded=n[82].isTextExpanded),e.$set(a)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Rt(l,e){let t,n=Math.abs(e[0]-e[84])<=5,s,a,r=n&&xt(e);return{key:l,first:null,c(){t=re(),r&&r.c(),s=re(),this.h()},l(f){t=re(),r&&r.l(f),s=re(),this.h()},h(){this.first=t},m(f,i){F(f,t,i),r&&r.m(f,i),F(f,s,i),a=!0},p(f,i){e=f,i[0]&129&&(n=Math.abs(e[0]-e[84])<=5),n?r?(r.p(e,i),i[0]&129&&E(r,1)):(r=xt(e),r.c(),E(r,1),r.m(s.parentNode,s)):r&&(te(),V(r,1,1,()=>{r=null}),ne())},i(f){a||(E(r),a=!0)},o(f){V(r),a=!1},d(f){f&&(_(t),_(s)),r&&r.d(f)}}}function St(l){let e,t;return e=new Zt({props:{post:l[7][l[0]],fixed:!1}}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},p(n,s){const a={};s[0]&129&&(a.post=n[7][n[0]]),e.$set(a)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function At(l){let e,t;return e=new qn({}),{c(){K(e.$$.fragment)},l(n){W(e.$$.fragment,n)},m(n,s){G(e,n,s),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){V(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Nt(l){let e,t,n,s,a="수정",r,f,i,o,c,m="삭제",b,C,O;return t=new ml({props:{fill:"white",length:1.5}}),i=new _l({props:{fill:"white",length:1.5}}),{c(){e=T("button"),K(t.$$.fragment),n=q(),s=T("span"),s.textContent=a,r=q(),f=T("button"),K(i.$$.fragment),o=q(),c=T("span"),c.textContent=m,this.h()},l(I){e=y(I,"BUTTON",{class:!0});var p=B(e);W(t.$$.fragment,p),n=j(p),s=y(p,"SPAN",{"data-svelte-h":!0}),le(s)!=="svelte-17aljrl"&&(s.textContent=a),p.forEach(_),r=j(I),f=y(I,"BUTTON",{class:!0});var d=B(f);W(i.$$.fragment,d),o=j(d),c=y(d,"SPAN",{"data-svelte-h":!0}),le(c)!=="svelte-1k1dgz"&&(c.textContent=m),d.forEach(_),this.h()},h(){h(e,"class","flex items-center gap-2 text-white text-sm"),h(f,"class","flex items-center gap-2 text-white text-sm")},m(I,p){F(I,e,p),G(t,e,null),w(e,n),w(e,s),F(I,r,p),F(I,f,p),G(i,f,null),w(f,o),w(f,c),b=!0,C||(O=[H(e,"click",l[40]),H(f,"click",l[41])],C=!0)},p:$,i(I){b||(E(t.$$.fragment,I),E(i.$$.fragment,I),b=!0)},o(I){V(t.$$.fragment,I),V(i.$$.fragment,I),b=!1},d(I){I&&(_(e),_(r),_(f)),J(t),J(i),C=!1,we(O)}}}function Ft(l){let e,t,n,s,a,r;return t=new al({}),{c(){e=T("button"),K(t.$$.fragment),n=be(`
        신고`),this.h()},l(f){e=y(f,"BUTTON",{class:!0});var i=B(e);W(t.$$.fragment,i),n=ve(i,`
        신고`),i.forEach(_),this.h()},h(){h(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(f,i){F(f,e,i),G(t,e,null),w(e,n),s=!0,a||(r=H(e,"click",l[43]),a=!0)},p:$,i(f){s||(E(t.$$.fragment,f),s=!0)},o(f){V(t.$$.fragment,f),s=!1},d(f){f&&_(e),J(t),a=!1,r()}}}function Al(l){let e,t,n,s,a,r,f,i,o,c=l[13]&&Nt(l);s=new $n({props:{length:1.5,fill:"white"}});let m=!l[13]&&Ft(l);return{c(){e=T("div"),c&&c.c(),t=q(),n=T("button"),K(s.$$.fragment),a=be(`
      링크 복사`),r=q(),m&&m.c(),this.h()},l(b){e=y(b,"DIV",{id:!0,class:!0});var C=B(e);c&&c.l(C),t=j(C),n=y(C,"BUTTON",{class:!0});var O=B(n);W(s.$$.fragment,O),a=ve(O,`
      링크 복사`),O.forEach(_),r=j(C),m&&m.l(C),C.forEach(_),this.h()},h(){h(n,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"id","test"),h(e,"class","flex flex-col px-5 gap-3")},m(b,C){F(b,e,C),c&&c.m(e,null),w(e,t),w(e,n),G(s,n,null),w(n,a),w(e,r),m&&m.m(e,null),f=!0,i||(o=[H(n,"click",l[42]),Se(ze.call(null,e))],i=!0)},p(b,C){b[13]?c?(c.p(b,C),C[0]&8192&&E(c,1)):(c=Nt(b),c.c(),E(c,1),c.m(e,t)):c&&(te(),V(c,1,1,()=>{c=null}),ne()),b[13]?m&&(te(),V(m,1,1,()=>{m=null}),ne()):m?(m.p(b,C),C[0]&8192&&E(m,1)):(m=Ft(b),m.c(),E(m,1),m.m(e,null))},i(b){f||(E(c),E(s.$$.fragment,b),E(m),f=!0)},o(b){V(c),V(s.$$.fragment,b),V(m),f=!1},d(b){b&&_(e),c&&c.d(),J(s),m&&m.d(),i=!1,we(o)}}}function Nl(l){let e,t,n="정말로 삭제하시겠습니까?",s,a,r="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",f,i,o,c="삭제",m,b,C="취소",O,I;return{c(){e=T("div"),t=T("h2"),t.textContent=n,s=q(),a=T("p"),a.textContent=r,f=q(),i=T("div"),o=T("button"),o.textContent=c,m=q(),b=T("button"),b.textContent=C,this.h()},l(p){e=y(p,"DIV",{class:!0});var d=B(e);t=y(d,"H2",{class:!0,"data-svelte-h":!0}),le(t)!=="svelte-1yzhdkj"&&(t.textContent=n),s=j(d),a=y(d,"P",{class:!0,"data-svelte-h":!0}),le(a)!=="svelte-26p028"&&(a.textContent=r),f=j(d),i=y(d,"DIV",{class:!0});var g=B(i);o=y(g,"BUTTON",{class:!0,"data-svelte-h":!0}),le(o)!=="svelte-1q4epan"&&(o.textContent=c),m=j(g),b=y(g,"BUTTON",{class:!0,"data-svelte-h":!0}),le(b)!=="svelte-1rzg9yy"&&(b.textContent=C),g.forEach(_),d.forEach(_),this.h()},h(){h(t,"class","text-lg font-semibold mb-2"),h(a,"class","text-gray-600 mb-4"),h(o,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),h(b,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),h(i,"class","flex justify-center space-x-4"),h(e,"class","text-center")},m(p,d){F(p,e,d),w(e,t),w(e,s),w(e,a),w(e,f),w(e,i),w(i,o),w(i,m),w(i,b),O||(I=[H(o,"click",l[48]),H(b,"click",l[49])],O=!0)},p:$,d(p){p&&_(e),O=!1,we(I)}}}function Fl(l){var ae;let e,t,n,s=[],a=new Map,r,f,i,o,c,m,b,C,O,I,p,d,g,k,P,x=!l[4]&&It(l),S=pe(l[7]);const N=v=>v[82].idx;for(let v=0;v<S.length;v+=1){let M=kt(l,S,v),Q=N(M);a.set(Q,s[v]=Rt(Q,M))}let D=l[4]&&((ae=l[7][l[0]])==null?void 0:ae.media.length)>1&&St(l),U=!l[4]&&At();function R(v){l[44](v)}let Y={fixed:!0,noHandle:!0,$$slots:{default:[Al]},$$scope:{ctx:l}};l[1]!==void 0&&(Y.isOpen=l[1]),c=new Ht({props:Y}),Ie.push(()=>Oe(c,"isOpen",R));function Z(v){l[45](v)}let oe={targetTable:"posts",targetIdx:l[7][l[0]].idx};l[2]!==void 0&&(oe.isOpen=l[2]),C=new Vl({props:oe}),Ie.push(()=>Oe(C,"isOpen",Z)),C.$on("reported",l[46]),p=new Ol({props:{isVisible:l[7][l[0]].permission_signer==="reported",targetTable:"posts",targetIdx:l[7][l[0]].idx}}),p.$on("unreported",l[47]);function he(v){l[50](v)}let fe={$$slots:{default:[Nl]},$$scope:{ctx:l}};return l[3]!==void 0&&(fe.modalVisible=l[3]),g=new Zn({props:fe}),Ie.push(()=>Oe(g,"modalVisible",he)),{c(){x&&x.c(),e=q(),t=T("div"),n=T("div");for(let v=0;v<s.length;v+=1)s[v].c();r=q(),D&&D.c(),f=q(),U&&U.c(),o=q(),K(c.$$.fragment),b=q(),K(C.$$.fragment),I=q(),K(p.$$.fragment),d=q(),K(g.$$.fragment),this.h()},l(v){x&&x.l(v),e=j(v),t=y(v,"DIV",{class:!0});var M=B(t);n=y(M,"DIV",{class:!0});var Q=B(n);for(let se=0;se<s.length;se+=1)s[se].l(Q);Q.forEach(_),r=j(M),D&&D.l(M),f=j(M),U&&U.l(M),M.forEach(_),o=j(v),W(c.$$.fragment,v),b=j(v),W(C.$$.fragment,v),I=j(v),W(p.$$.fragment,v),d=j(v),W(g.$$.fragment,v),this.h()},h(){h(n,"class","flex flex-grow relative w-full h-full bg-black"),h(t,"class",i="viewer bg-black select-none flex flex-col "+(l[4]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh"))},m(v,M){x&&x.m(v,M),F(v,e,M),F(v,t,M),w(t,n);for(let Q=0;Q<s.length;Q+=1)s[Q]&&s[Q].m(n,null);w(t,r),D&&D.m(t,null),w(t,f),U&&U.m(t,null),l[39](t),F(v,o,M),G(c,v,M),F(v,b,M),G(C,v,M),F(v,I,M),G(p,v,M),F(v,d,M),G(g,v,M),P=!0},p(v,M){var Ne;v[4]?x&&(x.d(1),x=null):x||(x=It(v),x.c(),x.m(e.parentNode,e)),M[0]&184307&&(S=pe(v[7]),te(),s=Je(s,M,N,1,v,S,a,n,Ut,Rt,null,kt),ne()),v[4]&&((Ne=v[7][v[0]])==null?void 0:Ne.media.length)>1?D?(D.p(v,M),M[0]&145&&E(D,1)):(D=St(v),D.c(),E(D,1),D.m(t,f)):D&&(te(),V(D,1,1,()=>{D=null}),ne()),v[4]?U&&(te(),V(U,1,1,()=>{U=null}),ne()):U?M[0]&16&&E(U,1):(U=At(),U.c(),E(U,1),U.m(t,null)),(!P||M[0]&16&&i!==(i="viewer bg-black select-none flex flex-col "+(v[4]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh")))&&h(t,"class",i);const Q={};M[0]&8206|M[2]&536870912&&(Q.$$scope={dirty:M,ctx:v}),!m&&M[0]&2&&(m=!0,Q.isOpen=v[1],Be(()=>m=!1)),c.$set(Q);const se={};M[0]&129&&(se.targetIdx=v[7][v[0]].idx),!O&&M[0]&4&&(O=!0,se.isOpen=v[2],Be(()=>O=!1)),C.$set(se);const Te={};M[0]&129&&(Te.isVisible=v[7][v[0]].permission_signer==="reported"),M[0]&129&&(Te.targetIdx=v[7][v[0]].idx),p.$set(Te);const Ve={};M[0]&8|M[2]&536870912&&(Ve.$$scope={dirty:M,ctx:v}),!k&&M[0]&8&&(k=!0,Ve.modalVisible=v[3],Be(()=>k=!1)),g.$set(Ve)},i(v){if(!P){for(let M=0;M<S.length;M+=1)E(s[M]);E(D),E(U),E(c.$$.fragment,v),E(C.$$.fragment,v),E(p.$$.fragment,v),E(g.$$.fragment,v),P=!0}},o(v){for(let M=0;M<s.length;M+=1)V(s[M]);V(D),V(U),V(c.$$.fragment,v),V(C.$$.fragment,v),V(p.$$.fragment,v),V(g.$$.fragment,v),P=!1},d(v){v&&(_(e),_(t),_(o),_(b),_(I),_(d)),x&&x.d(v);for(let M=0;M<s.length;M+=1)s[M].d();D&&D.d(),U&&U.d(),l[39](null),J(c,v),J(C,v),J(p,v),J(g,v)}}}const ql=30,jl=10,qt=150;function Pe(l){return"touches"in l||"changedTouches"in l}function Xl(l){return Pe(l)?[l.touches[0].clientX,l.touches[0].clientY]:[l.clientX,l.clientY]}function Ul(l,e,t){let n,s,a,r;rt(l,at,u=>t(14,a=u)),rt(l,Bn,u=>t(62,r=u));let{posts:f=[]}=e,i=f,{index:o=0}=e,{type:c=r.url.searchParams.get("type")}=e,{isEdit:m=!1}=e,{dontMoveVertically:b=!1}=e,{selectedReaction:C=void 0}=e,{hideActionButtons:O=!1}=e,{whenCancelForExternalLink:I=()=>{}}=e,p=!0,d=!1,g=!1,k=0,P=0,x={width:0,height:0},S=!1,N=!1,{actionSheetMoreIsOpen:D=!1}=e,{actionSheetReportIsOpen:U=!1}=e,{modalVisible:R=!1}=e;function Y(u){if(!u)return!1;const L=Le();return L!==null&&String(L)===u}let Z=!1,oe=!1,he=-1,fe=-1,ae,v=!1,M=[],Q=[],se;async function Te(){var u,L;i[o]&&On({mediaIdx:`${((u=i[o])==null?void 0:u.mediaIdx)||0}`,postIdx:`${(L=i[o])==null?void 0:L.idx}`},{replace:!0})}async function Ve(){t(22,Z=!0);const u=i.length,L=r.url.searchParams.get("userIdx"),A=r.url.searchParams.get("placeIdx"),X=`&offset=${u}`,z=`&limit=${ql}`,ie=L?`&userIdx=${L}`:"",De=A?`&placeIdx=${A}`:"",me=(await fetch(`${Re}/posts?${ie}${De}${X}${z}`,{headers:{"x-api-version":ot.POST}}).then(ke=>ke.json()).then(ke=>{var st;return((st=ke.data)==null?void 0:st.posts)??[]})).map(ke=>({...ke,mediaIdx:0}));me.length===0&&t(23,oe=!0),t(7,i=[...i,...me]),t(22,Z=!1)}function Ne(u){const{height:L}=x;if(o===0&&u>0||o===i.length-1&&u<0){t(9,k=u*.3);return}t(9,k=Math.max(Math.min(u,L),-L))}function Kt(u){t(8,p=!1);const L=xe(2),A=Pe(u)?u.changedTouches[0].clientY-fe:u.clientY-fe;A>L&&o>0?(t(0,o-=1),d=!0):-A>L&&o<i.length-1&&(t(0,o+=1),d=!0),t(9,k=0)}function Wt(u){const{width:L}=x,A=i[o].mediaIdx,X=i[o].media.length-1;if(A===0&&u>0||A===X&&u<0){t(10,P=u*.3);return}t(10,P=Math.max(Math.min(u,L),-L))}function Gt(u){t(8,p=!1);const L=xe(2),A=Pe(u)?u.changedTouches[0].clientX-he:u.clientX-he,X=i[o].mediaIdx,z=i[o].media.length-1;A>L&&X>0?ye(X-1):-A>L&&X<z&&ye(X+1),t(10,P=0)}function ye(u){t(7,i[o]={...i[o],mediaIdx:u},i),t(7,i=[...i]),g=!0,Te()}function Fe(u){d||g||(v=!0,ae=void 0,Pe(u)?(he=u.touches[0].clientX,fe=u.touches[0].clientY):(he=u.clientX,fe=u.clientY,window.addEventListener("mousemove",qe,{passive:!1}),window.addEventListener("mouseup",je)))}function qe(u){if(!v||d||g)return;const[L,A]=Xl(u),X=L-he,z=A-fe;ae===void 0&&(ae=Math.abs(z)>=Math.abs(X)?"post":"media"),!b&&ae==="post"?Ne(z):ae==="media"&&Wt(X)}function je(u){!v||d||g||(v=!1,ae==="post"?Kt(u):ae==="media"&&Gt(u),Pe(u)||(window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",je)))}function Qe(u){if(d||g)return;u.preventDefault();const L=Date.now(),A=Math.abs(u.deltaX),X=Math.abs(u.deltaY);if(A>X){if(Q.push({deltaX:u.deltaX,timestamp:L}),Q=Q.filter(z=>L-z.timestamp<=qt),Q.length>=2){const z=Q[0],ie=Q[Q.length-1];if(Math.abs(ie.deltaX)-Math.abs(z.deltaX)>=0&&Math.abs(ie.deltaX)>=30){const me=i[o].mediaIdx,ke=i[o].media.length-1;ie.deltaX>0&&me<ke?ye(me+1):ie.deltaX<0&&me>0&&ye(me-1),Q=[],g=!0}}}else if(M.push({deltaY:u.deltaY,timestamp:L}),M=M.filter(z=>L-z.timestamp<=qt),M.length>=2){const z=M[0],ie=M[M.length-1];Math.abs(ie.deltaY)-Math.abs(z.deltaY)>=0&&Math.abs(ie.deltaY)>=30&&(ie.deltaY>0&&o<i.length-1?(t(8,p=!1),t(0,o+=1),d=!0):ie.deltaY<0&&o>0&&(t(8,p=!1),t(0,o-=1),d=!0),M=[])}}function $e(u){if(d||g)return;const L=i[o].mediaIdx,A=i[o].media.length-1;switch(u.key){case"ArrowUp":o>0&&(t(8,p=!1),t(0,o--,o),d=!0);break;case"ArrowDown":o<i.length-1&&(t(8,p=!1),t(0,o++,o),d=!0);break;case"ArrowLeft":L>0&&(t(8,p=!1),g=!0,ye(L-1));break;case"ArrowRight":L<A&&(t(8,p=!1),g=!0,ye(L+1));break}}function Jt(){t(8,p=!0),d=!1,g=!1}function et(){se&&t(11,x={width:se.clientWidth,height:se.clientHeight})}function Qt(){var A,X;const u=Number(r.url.searchParams.get("mediaIdx")||0),L=((X=(A=i.at(o))==null?void 0:A.media)==null?void 0:X.length)||0;u&&u<L?t(7,i[o]={...i[o],mediaIdx:u},i):t(7,i[o]={...i[o],mediaIdx:0},i),t(7,i=[...i])}function $t(){document.addEventListener("touchstart",Fe,{passive:!1}),document.addEventListener("touchmove",qe,{passive:!1}),document.addEventListener("touchend",je),document.addEventListener("mousedown",Fe,{passive:!1}),document.addEventListener("wheel",Qe,{passive:!1}),document.addEventListener("keydown",$e)}function en(){document.removeEventListener("touchstart",Fe),document.removeEventListener("touchmove",qe),document.removeEventListener("touchend",je),document.removeEventListener("mousedown",Fe),document.removeEventListener("wheel",Qe),document.removeEventListener("keydown",$e)}jt(()=>{Mn(at,a=!0,a),et();const u=new ResizeObserver(()=>et());return se&&u.observe(se),$t(),Qt(),()=>{u.disconnect()}}),Ge(()=>{en()});function tt(){var X;if(N)return;N=!0;const u=Ye(),L=Le(),A=(X=i[o])==null?void 0:X.idx;if(!u||!L||!A)return N=!1;fetch(`${Re}/posts/${A}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`,"x-api-version":ot.POST}}).then(z=>z.json()).then(()=>Ke(`/users/${L}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{N=!1})}async function nt(u){var z,ie,De;const L=(z=i[u])==null?void 0:z.idx;if(L===void 0||m||((ie=i[u])==null?void 0:ie.needReactionReload)!==!0&&((De=i[u])!=null&&De.reactions))return;const A=Ye(),X=await fetch(`${Re}/vote/reactions?targetTable=posts&targetId=${L}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+A}});if(X.ok){const me=await X.json();t(7,i[u].reactions=me.data.reactions,i),t(7,i[u].myReaction=me.data.myReaction,i)}}function ge(u,L){if(Xe)return I();if(S)return;S=!0;const A=o,X=i[A];if((X==null?void 0:X.idx)!==u)return S=!1;if(!ft())return X.needReactionReload=!0,S=!1,_e.emit("showSignInModal",{removable:!0,callback:Nn?()=>{nt(A)}:void 0});X.myReaction===L?_e.emit("setReaction",{target:"posts",targetId:u,reaction:null,callback:()=>{t(7,i[A].myReaction=null,i),lt(A,L),S=!1}}):(X.myReaction&&lt(A,X.myReaction),_e.emit("setReaction",{target:"posts",targetId:u,reaction:L,callback:()=>{t(7,i[A].myReaction=L,i),i[A].reactions.some(z=>z.type===L)?t(7,i[A].reactions=i[A].reactions.map(z=>z.type===L?{...z,count:Number(z.count)+1}:z),i):t(7,i[A].reactions=[...i[A].reactions,{type:L,count:1}],i),S=!1}}))}function lt(u,L){let A=[];for(const X of i[u].reactions)if(X.type===L){const z=Number(X.count);z>1&&A.push({...X,count:z-1})}else A.push(X);t(7,i[u].reactions=A,i)}function tn(u){Vn.call(this,l,u)}const nn=(u,L)=>{ge(u.idx,L.type)},ln=()=>{if(Xe)return I()};function sn(u,L,A,X){A[X]=u,t(7,i)}const rn=(u,L,A,X)=>{t(7,L[A].isTextExpanded=X.detail.expanded,i)},an=u=>{ge(u.idx,"👍")},on=u=>{ge(u.idx,"️🔥")},fn=u=>{ge(u.idx,"😍")},un=u=>{ge(u.idx,"😋")},cn=u=>{ge(u.idx,"😊️️")},dn=(u,L)=>u+Number(L.count),hn=u=>{ge(u.idx,u.myReaction||"❤️")},mn=(u,L,A)=>{t(7,L[A].onReactionShowcase=!0,i);const X=()=>{t(7,L[A].onReactionShowcase=!1,i),window.removeEventListener("click",X)};setTimeout(()=>{window.addEventListener("click",X)},500)},pn=()=>{if(Xe)return I();if(!ft())return _e.emit("showSignInModal",{removable:!0});t(1,D=!0)};function gn(u){Ie[u?"unshift":"push"](()=>{se=u,t(12,se)})}const _n=()=>{var u;t(1,D=!1),Ke(`/viewer/edit?type=patch&postIdx=${(u=window.location.search.split("postIdx=")[1])==null?void 0:u.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},bn=()=>{t(1,D=!1),t(3,R=!0)},vn=()=>{Qn(`${location.pathname}${location.search}`),t(1,D=!1)},wn=()=>{t(1,D=!1),t(2,U=!0)};function kn(u){D=u,t(1,D)}function Cn(u){U=u,t(2,U)}const En=()=>{t(7,i[o].permission_signer="reported",i)},In=()=>{t(7,i[o].permission_signer=null,i)},xn=()=>{tt(),t(3,R=!1)},Tn=()=>{t(3,R=!1)};function yn(u){R=u,t(3,R)}return l.$$set=u=>{"posts"in u&&t(18,f=u.posts),"index"in u&&t(0,o=u.index),"type"in u&&t(19,c=u.type),"isEdit"in u&&t(4,m=u.isEdit),"dontMoveVertically"in u&&t(20,b=u.dontMoveVertically),"selectedReaction"in u&&t(21,C=u.selectedReaction),"hideActionButtons"in u&&t(5,O=u.hideActionButtons),"whenCancelForExternalLink"in u&&t(6,I=u.whenCancelForExternalLink),"actionSheetMoreIsOpen"in u&&t(1,D=u.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in u&&t(2,U=u.actionSheetReportIsOpen),"modalVisible"in u&&t(3,R=u.modalVisible)},l.$$.update=()=>{var u;l.$$.dirty[0]&1&&o!==void 0&&Te(),l.$$.dirty[0]&2097152&&C&&ge(C.postIdx,C.reaction),l.$$.dirty[0]&1&&nt(o),l.$$.dirty[0]&129&&t(24,n=(u=i[o])==null?void 0:u.user_idx),l.$$.dirty[0]&16777216&&t(13,s=Y(n)),l.$$.dirty[0]&13631617&&!b&&o>=i.length-jl&&!Z&&!oe&&(console.log("pushPosts"),Ve())},[o,D,U,R,m,O,I,i,p,k,P,x,se,s,a,Jt,tt,ge,f,c,b,C,Z,oe,n,tn,nn,ln,sn,rn,an,on,fn,un,cn,dn,hn,mn,pn,gn,_n,bn,vn,wn,kn,Cn,En,In,xn,Tn,yn]}class bs extends ce{constructor(e){super(),de(this,e,Ul,Fl,ue,{posts:18,index:0,type:19,isEdit:4,dontMoveVertically:20,selectedReaction:21,hideActionButtons:5,whenCancelForExternalLink:6,actionSheetMoreIsOpen:1,actionSheetReportIsOpen:2,modalVisible:3},null,[-1,-1,-1])}}export{bs as V};
