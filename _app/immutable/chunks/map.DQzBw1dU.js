var Ad=Object.defineProperty;var _d=(s,t,e)=>t in s?Ad(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var K=(s,t,e)=>_d(s,typeof t!="symbol"?t+"":t,e);import{b as wt,g as yt,d as Wt,e as pd,h as Se,i as La,r as yd,j as Zt,k as wr,l as Ma,m as ui,s as Pi,n as le,o as xd,p as an,q as Pa,u as Jh,v as Fa,w as Ed,x as vt,y as Ri,z as Cd,A as Fi,B as ba,C as Oa,D as Le,E as Ii,F as Na,G as $h,H as Wo,I as Da,J as jo,K as Zo,M as tc,L as wd,N as ka,O as ce,P as ec,Q as bn,R as ic,S as Td,T as Un,U as nc,V as sc,W as rc,X as _s,Y as Tr,Z as yr,_ as oc,$ as Xl,c as On,a0 as ac,a1 as Sd,a2 as Ga,a3 as Nn,a4 as Js,a5 as $s,a6 as Rd,a7 as vn,a8 as be,a9 as Vl,aa as Id,ab as vd,ac as lc,ad as Ld,ae as Md,af as Pd,ag as Fd,ah as bd,ai as hc,f as Ba}from"./proj.De7y6nwv.js";import{p as Vr,q as Od,r as Nd,t as Dd,G as za,P as kd,e as ln}from"./store.DeGgwmPs.js";import{g as Gd}from"./entry.DgabBo5R.js";import{c as Bd,a as zd,b as Yd}from"./ImageShaper.DEAJmI5j.js";import{L as Ud}from"./location.tSjDH3qa.js";class De{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}}const Dn={PROPERTYCHANGE:"propertychange"};class Ya{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}}function Xd(s,t,e){let i,n;e=e||je;let r=0,o=s.length,a=!1;for(;r<o;)i=r+(o-r>>1),n=+e(s[i],t),n<0?r=i+1:(o=i,a=!n);return a?r:~r}function je(s,t){return s>t?1:s<t?-1:0}function Ua(s,t,e){if(s[0]<=t)return 0;const i=s.length;if(t<=s[i-1])return i-1;if(typeof e=="function"){for(let n=1;n<i;++n){const r=s[n];if(r===t)return n;if(r<t)return e(t,s[n-1],r)>0?n-1:n}return i-1}if(e>0){for(let n=1;n<i;++n)if(s[n]<t)return n-1;return i-1}if(e<0){for(let n=1;n<i;++n)if(s[n]<=t)return n;return i-1}for(let n=1;n<i;++n){if(s[n]==t)return n;if(s[n]<t)return s[n-1]-t<t-s[n]?n-1:n}return i-1}function Vd(s,t,e){for(;t<e;){const i=s[t];s[t]=s[e],s[e]=i,++t,--e}}function Ce(s,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let n=0;n<i;n++)s[s.length]=e[n]}function zi(s,t){const e=s.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(s[i]!==t[i])return!1;return!0}function Kd(s,t,e){const i=t||je;return s.every(function(n,r){if(r===0)return!0;const o=i(s[r-1],n);return!(o>0||o===0)})}function Di(){return!0}function Xn(){return!1}function kn(){}function cc(s){let t,e,i;return function(){const n=Array.prototype.slice.call(arguments);return(!e||this!==i||!zi(n,e))&&(i=this,e=n,t=s.apply(this,arguments)),t}}function Wd(s){function t(){let e;try{e=s()}catch(i){return Promise.reject(i)}return e instanceof Promise?e:Promise.resolve(e)}return t()}function Vn(s){for(const t in s)delete s[t]}function ki(s){let t;for(t in s)return!1;return!t}class Kr extends Ya{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),n=i[t]||(i[t]=[]);n.includes(e)||n.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,n=this.listeners_&&this.listeners_[i];if(!n)return;const r=e?new De(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,a[i]=0),++o[i];let l;for(let h=0,c=n.length;h<c;++h)if("handleEvent"in n[h]?l=n[h].handleEvent(r):l=n[h].call(this,r),l===!1||r.propagationStopped){l=!1;break}if(--o[i]===0){let h=a[i];for(delete a[i];h--;)this.removeEventListener(i,kn);delete o[i]}return l}disposeInternal(){this.listeners_&&Vn(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const n=i.indexOf(e);n!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[n]=kn,++this.pendingRemovals_[t]):(i.splice(n,1),i.length===0&&delete this.listeners_[t]))}}const j={CHANGE:"change",ERROR:"error",BLUR:"blur",CLEAR:"clear",CONTEXTMENU:"contextmenu",CLICK:"click",DBLCLICK:"dblclick",DRAGENTER:"dragenter",DRAGOVER:"dragover",DROP:"drop",FOCUS:"focus",KEYDOWN:"keydown",KEYPRESS:"keypress",LOAD:"load",RESIZE:"resize",TOUCHMOVE:"touchmove",WHEEL:"wheel"};function at(s,t,e,i,n){if(n){const o=e;e=function(){s.removeEventListener(t,e),o.apply(i??this,arguments)}}else i&&i!==s&&(e=e.bind(i));const r={target:s,type:t,listener:e};return s.addEventListener(t,e),r}function Sr(s,t,e,i){return at(s,t,e,i,!0)}function _t(s){s&&s.target&&(s.target.removeEventListener(s.type,s.listener),Vn(s))}class Ds extends Kr{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(j.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=at(this,t[r],e);return n}return at(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const n=t.length;i=new Array(n);for(let r=0;r<n;++r)i[r]=Sr(this,t[r],e)}else i=Sr(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)jd(i);else if(Array.isArray(t))for(let n=0,r=t.length;n<r;++n)this.removeEventListener(t[n],e);else this.removeEventListener(t,e)}}Ds.prototype.on;Ds.prototype.once;Ds.prototype.un;function jd(s){if(Array.isArray(s))for(let t=0,e=s.length;t<e;++t)_t(s[t]);else _t(s)}function q(){throw new Error("Unimplemented abstract method.")}let Zd=0;function J(s){return s.ol_uid||(s.ol_uid=String(++Zd))}class Kl extends De{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}class ke extends Ds{constructor(t){super(),this.on,this.once,this.un,J(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Kl(i,t,e)),i=Dn.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Kl(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const n=this.values_||(this.values_={});if(i)n[t]=e;else{const r=n[t];n[t]=e,r!==e&&this.notify(t,r)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],ki(this.values_)&&(this.values_=null),e||this.notify(t,i)}}}const Dt={ADD:"add",REMOVE:"remove"},Wl={LENGTH:"length"};class tr extends De{constructor(t,e,i){super(t),this.element=e,this.index=i}}let Fe=class extends ke{constructor(t,e){if(super(),this.on,this.once,this.un,e=e||{},this.unique_=!!e.unique,this.array_=t||[],this.unique_)for(let i=0,n=this.array_.length;i<n;++i)this.assertUnique_(this.array_[i],i);this.updateLength_()}clear(){for(;this.getLength()>0;)this.pop()}extend(t){for(let e=0,i=t.length;e<i;++e)this.push(t[e]);return this}forEach(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)t(e[i],i,e)}getArray(){return this.array_}item(t){return this.array_[t]}getLength(){return this.get(Wl.LENGTH)}insertAt(t,e){if(t<0||t>this.getLength())throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e),this.array_.splice(t,0,e),this.updateLength_(),this.dispatchEvent(new tr(Dt.ADD,e,t))}pop(){return this.removeAt(this.getLength()-1)}push(t){this.unique_&&this.assertUnique_(t);const e=this.getLength();return this.insertAt(e,t),this.getLength()}remove(t){const e=this.array_;for(let i=0,n=e.length;i<n;++i)if(e[i]===t)return this.removeAt(i)}removeAt(t){if(t<0||t>=this.getLength())return;const e=this.array_[t];return this.array_.splice(t,1),this.updateLength_(),this.dispatchEvent(new tr(Dt.REMOVE,e,t)),e}setAt(t,e){const i=this.getLength();if(t>=i){this.insertAt(t,e);return}if(t<0)throw new Error("Index out of bounds: "+t);this.unique_&&this.assertUnique_(e,t);const n=this.array_[t];this.array_[t]=e,this.dispatchEvent(new tr(Dt.REMOVE,n,t)),this.dispatchEvent(new tr(Dt.ADD,e,t))}updateLength_(){this.set(Wl.LENGTH,this.array_.length)}assertUnique_(t,e){for(let i=0,n=this.array_.length;i<n;++i)if(this.array_[i]===t&&i!==e)throw new Error("Duplicate item added to a unique collection")}};const gt={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};function lt(s,t){if(!s)throw new Error(t)}class uc extends ke{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[gt.OPACITY]=t.opacity!==void 0?t.opacity:1,lt(typeof e[gt.OPACITY]=="number","Layer opacity must be a number"),e[gt.VISIBLE]=t.visible!==void 0?t.visible:!0,e[gt.Z_INDEX]=t.zIndex,e[gt.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[gt.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[gt.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[gt.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=wt(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return q()}getLayerStatesArray(t){return q()}getExtent(){return this.get(gt.EXTENT)}getMaxResolution(){return this.get(gt.MAX_RESOLUTION)}getMinResolution(){return this.get(gt.MIN_RESOLUTION)}getMinZoom(){return this.get(gt.MIN_ZOOM)}getMaxZoom(){return this.get(gt.MAX_ZOOM)}getOpacity(){return this.get(gt.OPACITY)}getSourceState(){return q()}getVisible(){return this.get(gt.VISIBLE)}getZIndex(){return this.get(gt.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(gt.EXTENT,t)}setMaxResolution(t){this.set(gt.MAX_RESOLUTION,t)}setMinResolution(t){this.set(gt.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(gt.MAX_ZOOM,t)}setMinZoom(t){this.set(gt.MIN_ZOOM,t)}setOpacity(t){lt(typeof t=="number","Layer opacity must be a number"),this.set(gt.OPACITY,t)}setVisible(t){this.set(gt.VISIBLE,t)}setZIndex(t){this.set(gt.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}const Ee={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose",POSTCOMPOSE:"postcompose",RENDERCOMPLETE:"rendercomplete"},St={ANIMATING:0,INTERACTING:1},Ie={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"},dc=42,Xa=256;function fc(s,t){const e=(""+s).split("."),i=(""+t).split(".");for(let n=0;n<Math.max(e.length,i.length);n++){const r=parseInt(e[n]||"0",10),o=parseInt(i[n]||"0",10);if(r>o)return 1;if(o>r)return-1}return 0}function jl(s,t,e){return function(i,n,r,o,a){if(!i)return;if(!n&&!t)return i;const l=t?0:r[0]*n,h=t?0:r[1]*n,c=a?a[0]:0,u=a?a[1]:0;let d=s[0]+l/2+c,f=s[2]-l/2+c,m=s[1]+h/2+u,p=s[3]-h/2+u;d>f&&(d=(f+d)/2,f=d),m>p&&(m=(p+m)/2,p=m);let x=wt(i[0],d,f),T=wt(i[1],m,p);if(o&&e&&n){const _=30*n;x+=-_*Math.log(1+Math.max(0,d-i[0])/_)+_*Math.log(1+Math.max(0,i[0]-f)/_),T+=-_*Math.log(1+Math.max(0,m-i[1])/_)+_*Math.log(1+Math.max(0,i[1]-p)/_)}return[x,T]}}function Qd(s){return s}function Va(s,t,e,i){const n=yt(t)/e[0],r=Wt(t)/e[1];return i?Math.min(s,Math.max(n,r)):Math.min(s,Math.min(n,r))}function Ka(s,t,e){let i=Math.min(s,t);const n=50;return i*=Math.log(1+n*Math.max(0,s/t-1))/n+1,e&&(i=Math.max(i,e),i/=Math.log(1+n*Math.max(0,e/s-1))/n+1),wt(i,e/2,t*2)}function qd(s,t,e,i){return t=t!==void 0?t:!0,function(n,r,o,a){if(n!==void 0){const l=s[0],h=s[s.length-1],c=e?Va(l,e,o,i):l;if(a)return t?Ka(n,c,h):wt(n,h,c);const u=Math.min(c,n),d=Math.floor(Ua(s,u,r));return s[d]>c&&d<s.length-1?s[d+1]:s[d]}}}function Hd(s,t,e,i,n,r){return i=i!==void 0?i:!0,e=e!==void 0?e:0,function(o,a,l,h){if(o!==void 0){const c=n?Va(t,n,l,r):t;if(h)return i?Ka(o,c,e):wt(o,e,c);const u=1e-9,d=Math.ceil(Math.log(t/c)/Math.log(s)-u),f=-a*(.5-u)+.5,m=Math.min(c,o),p=Math.floor(Math.log(t/m)/Math.log(s)+f),x=Math.max(d,p),T=t/Math.pow(s,x);return wt(T,e,c)}}}function Zl(s,t,e,i,n){return e=e!==void 0?e:!0,function(r,o,a,l){if(r!==void 0){const h=i?Va(s,i,a,n):s;return!e||!l?wt(r,t,h):Ka(r,h,t)}}}function Wa(s){if(s!==void 0)return 0}function Ql(s){if(s!==void 0)return s}function Jd(s){const t=2*Math.PI/s;return function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function $d(s){const t=pd(5);return function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e}}function gc(s){return Math.pow(s,3)}function Kn(s){return 1-gc(1-s)}function tf(s){return 3*s*s-2*s*s*s}function ef(s){return s}const mc=new Array(6);function we(){return[1,0,0,1,0,0]}function ql(s){return Za(s,1,0,0,1,0,0)}function ja(s,t){const e=s[0],i=s[1],n=s[2],r=s[3],o=s[4],a=s[5],l=t[0],h=t[1],c=t[2],u=t[3],d=t[4],f=t[5];return s[0]=e*l+n*h,s[1]=i*l+r*h,s[2]=e*c+n*u,s[3]=i*c+r*u,s[4]=e*d+n*f+o,s[5]=i*d+r*f+a,s}function Za(s,t,e,i,n,r,o){return s[0]=t,s[1]=e,s[2]=i,s[3]=n,s[4]=r,s[5]=o,s}function nf(s,t){return s[0]=t[0],s[1]=t[1],s[2]=t[2],s[3]=t[3],s[4]=t[4],s[5]=t[5],s}function Nt(s,t){const e=t[0],i=t[1];return t[0]=s[0]*e+s[2]*i+s[4],t[1]=s[1]*e+s[3]*i+s[5],t}function _o(s,t,e){return ja(s,Za(mc,t,0,0,e,0,0))}function sf(s,t,e){return ja(s,Za(mc,1,0,0,1,t,e))}function di(s,t,e,i,n,r,o,a){const l=Math.sin(r),h=Math.cos(r);return s[0]=i*h,s[1]=n*l,s[2]=-i*l,s[3]=n*h,s[4]=o*i*h-a*i*l+t,s[5]=o*n*l+a*n*h+e,s}function Ac(s,t){const e=rf(t);lt(e!==0,"Transformation matrix cannot be inverted");const i=t[0],n=t[1],r=t[2],o=t[3],a=t[4],l=t[5];return s[0]=o/e,s[1]=-n/e,s[2]=-r/e,s[3]=i/e,s[4]=(r*l-o*a)/e,s[5]=-(i*l-n*a)/e,s}function rf(s){return s[0]*s[3]-s[1]*s[2]}const Hl=[1e6,1e6,1e6,1e6,2,2];function of(s){return"matrix("+s.map((e,i)=>Math.round(e*Hl[i])/Hl[i]).join(", ")+")"}function bi(s,t,e,i,n,r,o){r=r||[],o=o||2;let a=0;for(let l=t;l<e;l+=i){const h=s[l],c=s[l+1];r[a++]=n[0]*h+n[2]*c+n[4],r[a++]=n[1]*h+n[3]*c+n[5];for(let u=2;u<o;u++)r[a++]=s[l+u]}return r&&r.length!=a&&(r.length=a),r}function Qa(s,t,e,i,n,r,o){o=o||[];const a=Math.cos(n),l=Math.sin(n),h=r[0],c=r[1];let u=0;for(let d=t;d<e;d+=i){const f=s[d]-h,m=s[d+1]-c;o[u++]=h+f*a-m*l,o[u++]=c+f*l+m*a;for(let p=d+2;p<d+i;++p)o[u++]=s[p]}return o&&o.length!=u&&(o.length=u),o}function af(s,t,e,i,n,r,o,a){a=a||[];const l=o[0],h=o[1];let c=0;for(let u=t;u<e;u+=i){const d=s[u]-l,f=s[u+1]-h;a[c++]=l+n*d,a[c++]=h+r*f;for(let m=u+2;m<u+i;++m)a[c++]=s[m]}return a&&a.length!=c&&(a.length=c),a}function lf(s,t,e,i,n,r,o){o=o||[];let a=0;for(let l=t;l<e;l+=i){o[a++]=s[l]+n,o[a++]=s[l+1]+r;for(let h=l+2;h<l+i;++h)o[a++]=s[h]}return o&&o.length!=a&&(o.length=a),o}const Jl=we();let _c=class extends ke{constructor(){super(),this.extent_=Se(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=cc((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const n=this.clone();return n.applyTransform(i),n.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return q()}closestPointXY(t,e,i,n){return q()}containsXY(t,e){const i=this.getClosestPoint([t,e]);return i[0]===t&&i[1]===e}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return q()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&La(e),this.extentRevision_=this.getRevision()}return yd(this.extent_,t)}rotate(t,e){q()}scale(t,e,i){q()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return q()}getType(){return q()}applyTransform(t){q()}intersectsExtent(t){return q()}translate(t,e){q()}transform(t,e){const i=Zt(t),n=i.getUnits()=="tile-pixels"?function(r,o,a){const l=i.getExtent(),h=i.getWorldExtent(),c=Wt(h)/Wt(l);return di(Jl,h[0],h[3],c,-c,0,0,0),bi(r,0,r.length,a,Jl,o),wr(i,e)(r,o,a)}:wr(i,e);return this.applyTransform(n),this}};class Yi extends _c{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Ma(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return q()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Rr(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){q()}setLayout(t,e,i){let n;if(t)n=Rr(t);else{for(let r=0;r<i;++r){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}n=e.length,t=hn(n)}this.layout=t,this.stride=n}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();Qa(i,0,i.length,n,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=ui(this.getExtent()));const n=this.getFlatCoordinates();if(n){const r=this.getStride();af(n,0,n.length,r,t,e,i,n),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const n=this.getStride();lf(i,0,i.length,n,t,e,i),this.changed()}}}function hn(s){let t;return s==2?t="XY":s==3?t="XYZ":s==4&&(t="XYZM"),t}function Rr(s){let t;return s=="XY"?t=2:s=="XYZ"||s=="XYM"?t=3:s=="XYZM"&&(t=4),t}function hf(s,t,e){const i=s.getFlatCoordinates();if(!i)return null;const n=s.getStride();return bi(i,0,i.length,n,t,e)}function $l(s,t,e,i,n,r,o){const a=s[t],l=s[t+1],h=s[e]-a,c=s[e+1]-l;let u;if(h===0&&c===0)u=t;else{const d=((n-a)*h+(r-l)*c)/(h*h+c*c);if(d>1)u=e;else if(d>0){for(let f=0;f<i;++f)o[f]=le(s[t+f],s[e+f],d);o.length=i;return}else u=t}for(let d=0;d<i;++d)o[d]=s[u+d];o.length=i}function qa(s,t,e,i,n){let r=s[t],o=s[t+1];for(t+=i;t<e;t+=i){const a=s[t],l=s[t+1],h=Pi(r,o,a,l);h>n&&(n=h),r=a,o=l}return n}function Ha(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];n=qa(s,t,a,i,n),t=a}return n}function cf(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];n=Ha(s,t,a,i,n),t=a[a.length-1]}return n}function Ja(s,t,e,i,n,r,o,a,l,h,c){if(t==e)return h;let u,d;if(n===0){if(d=Pi(o,a,s[t],s[t+1]),d<h){for(u=0;u<i;++u)l[u]=s[t+u];return l.length=i,d}return h}c=c||[NaN,NaN];let f=t+i;for(;f<e;)if($l(s,f-i,f,i,o,a,c),d=Pi(o,a,c[0],c[1]),d<h){for(h=d,u=0;u<i;++u)l[u]=c[u];l.length=i,f+=i}else f+=i*Math.max((Math.sqrt(d)-Math.sqrt(h))/n|0,1);if(r&&($l(s,e-i,t,i,o,a,c),d=Pi(o,a,c[0],c[1]),d<h)){for(h=d,u=0;u<i;++u)l[u]=c[u];l.length=i}return h}function $a(s,t,e,i,n,r,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const f=e[u];h=Ja(s,t,f,i,n,r,o,a,l,h,c),t=f}return h}function uf(s,t,e,i,n,r,o,a,l,h,c){c=c||[NaN,NaN];for(let u=0,d=e.length;u<d;++u){const f=e[u];h=$a(s,t,f,i,n,r,o,a,l,h,c),t=f[f.length-1]}return h}function pc(s,t,e,i){for(let n=0,r=e.length;n<r;++n)s[t++]=e[n];return t}function Wr(s,t,e,i){for(let n=0,r=e.length;n<r;++n){const o=e[n];for(let a=0;a<i;++a)s[t++]=o[a]}return t}function ks(s,t,e,i,n){n=n||[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=Wr(s,t,e[o],i);n[r++]=l,t=l}return n.length=r,n}function yc(s,t,e,i,n){n=n||[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=ks(s,t,e[o],i,n[r]);l.length===0&&(l[0]=t),n[r++]=l,t=l[l.length-1]}return n.length=r,n}function jr(s,t,e,i,n,r,o){const a=(e-t)/i;if(a<3){for(;t<e;t+=i)r[o++]=s[t],r[o++]=s[t+1];return o}const l=new Array(a);l[0]=1,l[a-1]=1;const h=[t,e-i];let c=0;for(;h.length>0;){const u=h.pop(),d=h.pop();let f=0;const m=s[d],p=s[d+1],x=s[u],T=s[u+1];for(let _=d+i;_<u;_+=i){const v=s[_],P=s[_+1],F=xd(v,P,m,p,x,T);F>f&&(c=_,f=F)}f>n&&(l[(c-t)/i]=1,d+i<c&&h.push(d,c),c+i<u&&h.push(c,u))}for(let u=0;u<a;++u)l[u]&&(r[o++]=s[t+u*i],r[o++]=s[t+u*i+1]);return o}function xc(s,t,e,i,n,r,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=jr(s,t,c,i,n,r,o),a.push(o),t=c}return o}function Qi(s,t){return t*Math.round(s/t)}function df(s,t,e,i,n,r,o){if(t==e)return o;let a=Qi(s[t],n),l=Qi(s[t+1],n);t+=i,r[o++]=a,r[o++]=l;let h,c;do if(h=Qi(s[t],n),c=Qi(s[t+1],n),t+=i,t==e)return r[o++]=h,r[o++]=c,o;while(h==a&&c==l);for(;t<e;){const u=Qi(s[t],n),d=Qi(s[t+1],n);if(t+=i,u==h&&d==c)continue;const f=h-a,m=c-l,p=u-a,x=d-l;if(f*x==m*p&&(f<0&&p<f||f==p||f>0&&p>f)&&(m<0&&x<m||m==x||m>0&&x>m)){h=u,c=d;continue}r[o++]=h,r[o++]=c,a=h,l=c,h=u,c=d}return r[o++]=h,r[o++]=c,o}function tl(s,t,e,i,n,r,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l];o=df(s,t,c,i,n,r,o),a.push(o),t=c}return o}function ff(s,t,e,i,n,r,o,a){for(let l=0,h=e.length;l<h;++l){const c=e[l],u=[];o=tl(s,t,c,i,n,r,o,u),a.push(u),t=c[c.length-1]}return o}function vi(s,t,e,i,n){n=n!==void 0?n:[];let r=0;for(let o=t;o<e;o+=i)n[r++]=s.slice(o,o+i);return n.length=r,n}function ps(s,t,e,i,n){n=n!==void 0?n:[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];n[r++]=vi(s,t,l,i,n[r]),t=l}return n.length=r,n}function Qo(s,t,e,i,n){n=n!==void 0?n:[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o];n[r++]=l.length===1&&l[0]===t?[]:ps(s,t,l,i,n[r]),t=l[l.length-1]}return n.length=r,n}function Ec(s,t,e,i){let n=0;const r=s[e-i],o=s[e-i+1];let a=0,l=0;for(;t<e;t+=i){const h=s[t]-r,c=s[t+1]-o;n+=l*h-a*c,a=h,l=c}return n/2}function Cc(s,t,e,i){let n=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];n+=Ec(s,t,a,i),t=a}return n}function gf(s,t,e,i){let n=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];n+=Cc(s,t,a,i),t=a[a.length-1]}return n}let qo=class Ho extends Yi{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Ho(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,n){return n<an(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ja(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,n))}getArea(){return Ec(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=jr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ho(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wr(this.flatCoordinates,0,t,this.stride),this.changed()}},ue=class wc extends Yi{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new wc(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,o=Pi(t,e,r[0],r[1]);if(o<n){const a=this.stride;for(let l=0;l<a;++l)i[l]=r[l];return i.length=a,o}return n}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Pa(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return Jh(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=pc(this.flatCoordinates,0,t,this.stride),this.changed()}};function mf(s,t,e,i,n){return!Fa(n,function(o){return!Hi(s,t,e,i,o[0],o[1])})}function Hi(s,t,e,i,n,r){let o=0,a=s[e-i],l=s[e-i+1];for(;t<e;t+=i){const h=s[t],c=s[t+1];l<=r?c>r&&(h-a)*(r-l)-(n-a)*(c-l)>0&&o++:c<=r&&(h-a)*(r-l)-(n-a)*(c-l)<0&&o--,a=h,l=c}return o!==0}function el(s,t,e,i,n,r){if(e.length===0||!Hi(s,t,e[0],i,n,r))return!1;for(let o=1,a=e.length;o<a;++o)if(Hi(s,e[o-1],e[o],i,n,r))return!1;return!0}function Af(s,t,e,i,n,r){if(e.length===0)return!1;for(let o=0,a=e.length;o<a;++o){const l=e[o];if(el(s,t,l,i,n,r))return!0;t=l[l.length-1]}return!1}function il(s,t,e,i,n,r,o){let a,l,h,c,u,d,f;const m=n[r+1],p=[];for(let _=0,v=e.length;_<v;++_){const P=e[_];for(c=s[P-i],d=s[P-i+1],a=t;a<P;a+=i)u=s[a],f=s[a+1],(m<=d&&f<=m||d<=m&&m<=f)&&(h=(m-d)/(f-d)*(u-c)+c,p.push(h)),c=u,d=f}let x=NaN,T=-1/0;for(p.sort(je),c=p[0],a=1,l=p.length;a<l;++a){u=p[a];const _=Math.abs(u-c);_>T&&(h=(c+u)/2,el(s,t,e,i,h,m)&&(x=h,T=_)),c=u}return isNaN(x)&&(x=n[r]),o?(o.push(x,m,T),o):[x,m,T]}function Tc(s,t,e,i,n){let r=[];for(let o=0,a=e.length;o<a;++o){const l=e[o];r=il(s,t,l,i,n,2*o,r),t=l[l.length-1]}return r}function Sc(s,t,e,i,n){let r;for(t+=i;t<e;t+=i)if(r=n(s.slice(t-i,t),s.slice(t,t+i)),r)return r;return!1}function Zr(s,t,e,i,n){const r=Ed(Se(),s,t,e,i);return vt(n,r)?Ri(n,r)||r[0]>=n[0]&&r[2]<=n[2]||r[1]>=n[1]&&r[3]<=n[3]?!0:Sc(s,t,e,i,function(o,a){return Cd(n,o,a)}):!1}function _f(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){if(Zr(s,t,e[r],i,n))return!0;t=e[r]}return!1}function Rc(s,t,e,i,n){return!!(Zr(s,t,e,i,n)||Hi(s,t,e,i,n[0],n[1])||Hi(s,t,e,i,n[0],n[3])||Hi(s,t,e,i,n[2],n[1])||Hi(s,t,e,i,n[2],n[3]))}function Ic(s,t,e,i,n){if(!Rc(s,t,e[0],i,n))return!1;if(e.length===1)return!0;for(let r=1,o=e.length;r<o;++r)if(mf(s,e[r-1],e[r],i,n)&&!Zr(s,e[r-1],e[r],i,n))return!1;return!0}function pf(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(Ic(s,t,a,i,n))return!0;t=a[a.length-1]}return!1}function yf(s,t,e,i){for(;t<e-i;){for(let n=0;n<i;++n){const r=s[t+n];s[t+n]=s[e-i+n],s[e-i+n]=r}t+=i,e-=i}}function nl(s,t,e,i){let n=0,r=s[e-i],o=s[e-i+1];for(;t<e;t+=i){const a=s[t],l=s[t+1];n+=(a-r)*(l+o),r=a,o=l}return n===0?void 0:n>0}function sl(s,t,e,i,n){n=n!==void 0?n:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],l=nl(s,t,a,i);if(r===0){if(n&&l||!n&&!l)return!1}else if(n&&!l||!n&&l)return!1;t=a}return!0}function vc(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r){const a=e[r];if(!sl(s,t,a,i,n))return!1;a.length&&(t=a[a.length-1])}return!0}function Ir(s,t,e,i,n){n=n!==void 0?n:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],l=nl(s,t,a,i);(r===0?n&&l||!n&&!l:n&&!l||!n&&l)&&yf(s,t,a,i),t=a}return t}function Jo(s,t,e,i,n){for(let r=0,o=e.length;r<o;++r)t=Ir(s,t,e[r],i,n);return t}function Lc(s,t){const e=[];let i=0,n=0,r;for(let o=0,a=t.length;o<a;++o){const l=t[o],h=nl(s,i,l,2);if(r===void 0&&(r=h),h===r)e.push(t.slice(n,o+1));else{if(e.length===0)continue;e[e.length-1].push(t[n])}n=o+1,i=l}return e}let Oe=class $o extends Yi{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?Ce(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new $o(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<an(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ha(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$a(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return el(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Cc(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ir(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,ps(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ui(this.getExtent());this.flatInteriorPoint_=il(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new ue(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new qo(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o],h=new qo(e.slice(r,l),t);n.push(h),r=l}return n}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;sl(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ir(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=tl(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new $o(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return Ic(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=ks(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}};function th(s){if(ba(s))throw new Error("Cannot create polygon from empty extent");const t=s[0],e=s[1],i=s[2],n=s[3],r=[t,e,t,n,i,n,i,e,t,e];return new Oe(r,"XY",[r.length])}function xf(s,t,e){t=t||32;const i=s.getStride(),n=s.getLayout(),r=s.getCenter(),o=i*(t+1),a=new Array(o);for(let c=0;c<o;c+=i){a[c]=0,a[c+1]=0;for(let u=2;u<i;u++)a[c+u]=r[u]}const l=[a.length],h=new Oe(a,n,l);return Ef(h,r,s.getRadius()),h}function Ef(s,t,e,i){const n=s.getFlatCoordinates(),r=s.getStride(),o=n.length/r-1,a=0;for(let l=0;l<=o;++l){const h=l*r,c=a+Fi(l,o)*2*Math.PI/o;n[h]=t[0]+e*Math.cos(c),n[h+1]=t[1]+e*Math.sin(c)}s.changed()}const po=0;class Xe extends ke{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Oa(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&wd(),t.center&&(t.center=Le(t.center,this.projection_)),t.extent&&(t.extent=Ii(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in Ie)delete e[a];this.setProperties(e,!0);const i=wf(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const n=Cf(t),r=i.constraint,o=Tf(t);this.constraints_={center:n,resolution:r,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const n=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(n[3]-e[3]+e[1]-n[1]),a=r/2*(n[0]-e[0]+e[2]-n[2]);this.setCenterInternal([i[0]+o,i[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let n=arguments[i];n.center&&(n=Object.assign({},n),n.center=Le(n.center,this.getProjection())),n.anchor&&(n=Object.assign({},n),n.anchor=Le(n.anchor,this.getProjection())),e[i]=n}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let n=0;for(;n<e&&!this.isDef();++n){const c=arguments[n];c.center&&this.setCenterInternal(c.center),c.zoom!==void 0?this.setZoom(c.zoom):c.resolution&&this.setResolution(c.resolution),c.rotation!==void 0&&this.setRotation(c.rotation)}if(n===e){i&&er(i,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,l=this.targetRotation_;const h=[];for(;n<e;++n){const c=arguments[n],u={start:r,complete:!1,anchor:c.anchor,duration:c.duration!==void 0?c.duration:1e3,easing:c.easing||tf,callback:i};if(c.center&&(u.sourceCenter=o,u.targetCenter=c.center.slice(),o=u.targetCenter),c.zoom!==void 0?(u.sourceResolution=a,u.targetResolution=this.getResolutionForZoom(c.zoom),a=u.targetResolution):c.resolution&&(u.sourceResolution=a,u.targetResolution=c.resolution,a=u.targetResolution),c.rotation!==void 0){u.sourceRotation=l;const d=Fi(c.rotation-l+Math.PI,2*Math.PI)-Math.PI;u.targetRotation=l+d,l=u.targetRotation}Sf(u)?u.complete=!0:r+=u.duration,h.push(u)}this.animations_.push(h),this.setHint(St.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[St.ANIMATING]>0}getInteracting(){return this.hints_[St.INTERACTING]>0}cancelAnimations(){this.setHint(St.ANIMATING,-this.hints_[St.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const n=this.animations_[e];if(n[0].callback&&er(n[0].callback,!1),!t)for(let r=0,o=n.length;r<o;++r){const a=n[r];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const n=this.animations_[i];let r=!0;for(let o=0,a=n.length;o<a;++o){const l=n[o];if(l.complete)continue;const h=t-l.start;let c=l.duration>0?h/l.duration:1;c>=1?(l.complete=!0,c=1):r=!1;const u=l.easing(c);if(l.sourceCenter){const d=l.sourceCenter[0],f=l.sourceCenter[1],m=l.targetCenter[0],p=l.targetCenter[1];this.nextCenter_=l.targetCenter;const x=d+u*(m-d),T=f+u*(p-f);this.targetCenter_=[x,T]}if(l.sourceResolution&&l.targetResolution){const d=u===1?l.targetResolution:l.sourceResolution+u*(l.targetResolution-l.sourceResolution);if(l.anchor){const f=this.getViewportSize_(this.getRotation()),m=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(m,l.anchor)}this.nextResolution_=l.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(l.sourceRotation!==void 0&&l.targetRotation!==void 0){const d=u===1?Fi(l.targetRotation+Math.PI,2*Math.PI)-Math.PI:l.sourceRotation+u*(l.targetRotation-l.sourceRotation);if(l.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,l.anchor)}this.nextRotation_=l.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!l.complete)break}if(r){this.animations_[i]=null,this.setHint(St.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=n[0].callback;o&&er(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const n=this.getCenterInternal();return n!==void 0&&(i=[n[0]-e[0],n[1]-e[1]],Na(i,t-this.getRotation()),$h(i,e)),i}calculateCenterZoom(t,e){let i;const n=this.getCenterInternal(),r=this.getResolution();if(n!==void 0&&r!==void 0){const o=e[0]-t*(e[0]-n[0])/r,a=e[1]-t*(e[1]-n[1])/r;i=[o,a]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],n=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(n*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(n*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Wo(t,this.getProjection())}getCenterInternal(){return this.get(Ie.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Da(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();lt(e,"The view center is not defined");const i=this.getResolution();lt(i!==void 0,"The view resolution is not defined");const n=this.getRotation();return lt(n!==void 0,"The view rotation is not defined"),jo(e,i,n,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(Ie.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Ii(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=yt(t)/e[0],n=Wt(t)/e[1];return Math.max(i,n)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,n=Math.log(e/i)/Math.log(t);return function(r){return e/Math.pow(t,r*n)}}getRotation(){return this.get(Ie.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,r=Math.log(i/n)/e;return function(o){return Math.log(i/o)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let n=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();n=yo(n,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,i)}return{center:n.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,n;if(this.resolutions_){const r=Ua(this.resolutions_,t,1);e=r,i=this.resolutions_[r],r==this.resolutions_.length-1?n=2:n=i/this.resolutions_[r+1]}else i=this.maxResolution_,n=this.zoomFactor_;return e+Math.log(i/t)/Math.log(n)}getResolutionForZoom(t){if(this.resolutions_){if(this.resolutions_.length<=1)return 0;const e=wt(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,wt(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(lt(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){lt(!ba(t),"Cannot fit empty extent provided as `geometry`");const n=Ii(t,this.getProjection());i=th(n)}else if(t.getType()==="Circle"){const n=Ii(t.getExtent(),this.getProjection());i=th(n),i.rotate(this.getRotation(),ui(n))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),n=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let a=1/0,l=1/0,h=-1/0,c=-1/0;for(let u=0,d=r.length;u<d;u+=o){const f=r[u]*i-r[u+1]*n,m=r[u]*n+r[u+1]*i;a=Math.min(a,f),l=Math.min(l,m),h=Math.max(h,f),c=Math.max(c,m)}return[a,l,h,c]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const n=e.padding!==void 0?e.padding:[0,0,0,0],r=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let l=this.getResolutionForExtentInternal(a,[i[0]-n[1]-n[3],i[1]-n[0]-n[2]]);l=isNaN(l)?o:Math.max(l,o),l=this.getConstrainedResolution(l,r?0:1);const h=this.getRotation(),c=Math.sin(h),u=Math.cos(h),d=ui(a);d[0]+=(n[1]-n[3])/2*l,d[1]+=(n[0]-n[2])/2*l;const f=d[0]*u-d[1]*c,m=d[1]*u+d[0]*c,p=this.getConstrainedCenter([f,m],l),x=e.callback?e.callback:kn;e.duration!==void 0?this.animateInternal({resolution:l,center:p,duration:e.duration,easing:e.easing},x):(this.targetResolution_=l,this.targetCenter_=p,this.applyTargetState_(!1,!0),er(x,!0))}centerOn(t,e,i){this.centerOnInternal(Le(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(yo(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,n){let r;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-i),l=yo(t,n,[a[0]/2+o[3],a[1]/2+o[0]],e,i);r=[t[0]-l[0],t[1]-l[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Wo(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&Le(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,n,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=Le(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),n=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(n,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&Le(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,n=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(n),o=this.constraints_.resolution(this.targetResolution_,0,r,i),a=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,n,r));this.get(Ie.ROTATION)!==n&&this.set(Ie.ROTATION,n),this.get(Ie.RESOLUTION)!==o&&(this.set(Ie.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(Ie.CENTER)||!Zo(this.get(Ie.CENTER),a))&&this.set(Ie.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const n=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,n,o),l=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=l,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!Zo(this.getCenterInternal(),l))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:l,resolution:a,duration:t,easing:Kn,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(St.INTERACTING,1)}endInteraction(t,e,i){i=i&&Le(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(St.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function er(s,t){setTimeout(function(){s(t)},0)}function Cf(s){if(s.extent!==void 0){const e=s.smoothExtentConstraint!==void 0?s.smoothExtentConstraint:!0;return jl(s.extent,s.constrainOnlyCenter,e)}const t=Oa(s.projection,"EPSG:3857");if(s.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,jl(e,!1,!1)}return Qd}function wf(s){let t,e,i,o=s.minZoom!==void 0?s.minZoom:po,a=s.maxZoom!==void 0?s.maxZoom:28;const l=s.zoomFactor!==void 0?s.zoomFactor:2,h=s.multiWorld!==void 0?s.multiWorld:!1,c=s.smoothResolutionConstraint!==void 0?s.smoothResolutionConstraint:!0,u=s.showFullExtent!==void 0?s.showFullExtent:!1,d=Oa(s.projection,"EPSG:3857"),f=d.getExtent();let m=s.constrainOnlyCenter,p=s.extent;if(!h&&!p&&d.isGlobal()&&(m=!1,p=f),s.resolutions!==void 0){const x=s.resolutions;e=x[o],i=x[a]!==void 0?x[a]:x[x.length-1],s.constrainResolution?t=qd(x,c,!m&&p,u):t=Zl(e,i,c,!m&&p,u)}else{const T=(f?Math.max(yt(f),Wt(f)):360*tc.degrees/d.getMetersPerUnit())/Xa/Math.pow(2,po),_=T/Math.pow(2,28-po);e=s.maxResolution,e!==void 0?o=0:e=T/Math.pow(l,o),i=s.minResolution,i===void 0&&(s.maxZoom!==void 0?s.maxResolution!==void 0?i=e/Math.pow(l,a):i=T/Math.pow(l,a):i=_),a=o+Math.floor(Math.log(e/i)/Math.log(l)),i=e/Math.pow(l,a-o),s.constrainResolution?t=Hd(l,e,i,c,!m&&p,u):t=Zl(e,i,c,!m&&p,u)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:o,zoomFactor:l}}function Tf(s){if(s.enableRotation!==void 0?s.enableRotation:!0){const e=s.constrainRotation;return e===void 0||e===!0?$d():e===!1?Ql:typeof e=="number"?Jd(e):Ql}return Wa}function Sf(s){return!(s.sourceCenter&&s.targetCenter&&!Zo(s.sourceCenter,s.targetCenter)||s.sourceResolution!==s.targetResolution||s.sourceRotation!==s.targetRotation)}function yo(s,t,e,i,n){const r=Math.cos(-n);let o=Math.sin(-n),a=s[0]*r-s[1]*o,l=s[1]*r+s[0]*o;a+=(t[0]/2-e[0])*i,l+=(e[1]-t[1]/2)*i,o=-o;const h=a*r-l*o,c=l*r+a*o;return[h,c]}class Qr extends uc{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(gt.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(gt.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(_t(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=at(t,j.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0))),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof Xe?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let n;e.layerStatesArray?n=e.layerStatesArray.find(o=>o.layer===this):n=this.getLayerState();const r=this.getExtent();return rl(n,e.viewState)&&(!r||vt(r,e.extent))}getAttributions(t){var r;if(!this.isVisible(t))return[];const e=(r=this.getSource())==null?void 0:r.getAttributions();if(!e)return[];const i=t instanceof Xe?t.getViewStateAndExtent():t;let n=e(i);return Array.isArray(n)||(n=[n]),n}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(gt.MAP,t)}getMapInternal(){return this.get(gt.MAP)}setMap(t){this.mapPrecomposeKey_&&(_t(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(_t(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=at(t,Ee.PRECOMPOSE,e=>{const n=e.frameState.layerStatesArray,r=this.getLayerState(!1);lt(!n.some(function(o){return o.layer===r.layer}),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),n.push(r)}),this.mapRenderKey_=at(this,j.CHANGE,t.render,t),this.changed())}setSource(t){this.set(gt.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}function rl(s,t){if(!s.visible)return!1;const e=t.resolution;if(e<s.minResolution||e>=s.maxResolution)return!1;const i=t.zoom;return i>s.minZoom&&i<=s.maxZoom}function Mc(s,t,e=0,i=s.length-1,n=Rf){for(;i>e;){if(i-e>600){const l=i-e+1,h=t-e+1,c=Math.log(l),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(l-u)/l)*(h-l/2<0?-1:1),f=Math.max(e,Math.floor(t-h*u/l+d)),m=Math.min(i,Math.floor(t+(l-h)*u/l+d));Mc(s,t,f,m,n)}const r=s[t];let o=e,a=i;for($n(s,e,t),n(s[i],r)>0&&$n(s,e,i);o<a;){for($n(s,o,a),o++,a--;n(s[o],r)<0;)o++;for(;n(s[a],r)>0;)a--}n(s[e],r)===0?$n(s,e,a):(a++,$n(s,a,i)),a<=t&&(e=a+1),t<=a&&(i=a-1)}}function $n(s,t,e){const i=s[t];s[t]=s[e],s[e]=i}function Rf(s,t){return s<t?-1:s>t?1:0}let Pc=class{constructor(t=9){this._maxEntries=Math.max(4,t),this._minEntries=Math.max(2,Math.ceil(this._maxEntries*.4)),this.clear()}all(){return this._all(this.data,[])}search(t){let e=this.data;const i=[];if(!nr(t,e))return i;const n=this.toBBox,r=[];for(;e;){for(let o=0;o<e.children.length;o++){const a=e.children[o],l=e.leaf?n(a):a;nr(t,l)&&(e.leaf?i.push(a):Eo(t,l)?this._all(a,i):r.push(a))}e=r.pop()}return i}collides(t){let e=this.data;if(!nr(t,e))return!1;const i=[];for(;e;){for(let n=0;n<e.children.length;n++){const r=e.children[n],o=e.leaf?this.toBBox(r):r;if(nr(t,o)){if(e.leaf||Eo(t,o))return!0;i.push(r)}}e=i.pop()}return!1}load(t){if(!(t&&t.length))return this;if(t.length<this._minEntries){for(let i=0;i<t.length;i++)this.insert(t[i]);return this}let e=this._build(t.slice(),0,t.length-1,0);if(!this.data.children.length)this.data=e;else if(this.data.height===e.height)this._splitRoot(this.data,e);else{if(this.data.height<e.height){const i=this.data;this.data=e,e=i}this._insert(e,this.data.height-e.height-1,!0)}return this}insert(t){return t&&this._insert(t,this.data.height-1),this}clear(){return this.data=Tn([]),this}remove(t,e){if(!t)return this;let i=this.data;const n=this.toBBox(t),r=[],o=[];let a,l,h;for(;i||r.length;){if(i||(i=r.pop(),l=r[r.length-1],a=o.pop(),h=!0),i.leaf){const c=If(t,i.children,e);if(c!==-1)return i.children.splice(c,1),r.push(i),this._condense(r),this}!h&&!i.leaf&&Eo(i,n)?(r.push(i),o.push(a),a=0,l=i,i=i.children[0]):l?(a++,i=l.children[a],h=!1):i=null}return this}toBBox(t){return t}compareMinX(t,e){return t.minX-e.minX}compareMinY(t,e){return t.minY-e.minY}toJSON(){return this.data}fromJSON(t){return this.data=t,this}_all(t,e){const i=[];for(;t;)t.leaf?e.push(...t.children):i.push(...t.children),t=i.pop();return e}_build(t,e,i,n){const r=i-e+1;let o=this._maxEntries,a;if(r<=o)return a=Tn(t.slice(e,i+1)),An(a,this.toBBox),a;n||(n=Math.ceil(Math.log(r)/Math.log(o)),o=Math.ceil(r/Math.pow(o,n-1))),a=Tn([]),a.leaf=!1,a.height=n;const l=Math.ceil(r/o),h=l*Math.ceil(Math.sqrt(o));eh(t,e,i,h,this.compareMinX);for(let c=e;c<=i;c+=h){const u=Math.min(c+h-1,i);eh(t,c,u,l,this.compareMinY);for(let d=c;d<=u;d+=l){const f=Math.min(d+l-1,u);a.children.push(this._build(t,d,f,n-1))}}return An(a,this.toBBox),a}_chooseSubtree(t,e,i,n){for(;n.push(e),!(e.leaf||n.length-1===i);){let r=1/0,o=1/0,a;for(let l=0;l<e.children.length;l++){const h=e.children[l],c=xo(h),u=Mf(t,h)-c;u<o?(o=u,r=c<r?c:r,a=h):u===o&&c<r&&(r=c,a=h)}e=a||e.children[0]}return e}_insert(t,e,i){const n=i?t:this.toBBox(t),r=[],o=this._chooseSubtree(n,this.data,e,r);for(o.children.push(t),hs(o,n);e>=0&&r[e].children.length>this._maxEntries;)this._split(r,e),e--;this._adjustParentBBoxes(n,r,e)}_split(t,e){const i=t[e],n=i.children.length,r=this._minEntries;this._chooseSplitAxis(i,r,n);const o=this._chooseSplitIndex(i,r,n),a=Tn(i.children.splice(o,i.children.length-o));a.height=i.height,a.leaf=i.leaf,An(i,this.toBBox),An(a,this.toBBox),e?t[e-1].children.push(a):this._splitRoot(i,a)}_splitRoot(t,e){this.data=Tn([t,e]),this.data.height=t.height+1,this.data.leaf=!1,An(this.data,this.toBBox)}_chooseSplitIndex(t,e,i){let n,r=1/0,o=1/0;for(let a=e;a<=i-e;a++){const l=ls(t,0,a,this.toBBox),h=ls(t,a,i,this.toBBox),c=Pf(l,h),u=xo(l)+xo(h);c<r?(r=c,n=a,o=u<o?u:o):c===r&&u<o&&(o=u,n=a)}return n||i-e}_chooseSplitAxis(t,e,i){const n=t.leaf?this.compareMinX:vf,r=t.leaf?this.compareMinY:Lf,o=this._allDistMargin(t,e,i,n),a=this._allDistMargin(t,e,i,r);o<a&&t.children.sort(n)}_allDistMargin(t,e,i,n){t.children.sort(n);const r=this.toBBox,o=ls(t,0,e,r),a=ls(t,i-e,i,r);let l=ir(o)+ir(a);for(let h=e;h<i-e;h++){const c=t.children[h];hs(o,t.leaf?r(c):c),l+=ir(o)}for(let h=i-e-1;h>=e;h--){const c=t.children[h];hs(a,t.leaf?r(c):c),l+=ir(a)}return l}_adjustParentBBoxes(t,e,i){for(let n=i;n>=0;n--)hs(e[n],t)}_condense(t){for(let e=t.length-1,i;e>=0;e--)t[e].children.length===0?e>0?(i=t[e-1].children,i.splice(i.indexOf(t[e]),1)):this.clear():An(t[e],this.toBBox)}};function If(s,t,e){if(!e)return t.indexOf(s);for(let i=0;i<t.length;i++)if(e(s,t[i]))return i;return-1}function An(s,t){ls(s,0,s.children.length,t,s)}function ls(s,t,e,i,n){n||(n=Tn(null)),n.minX=1/0,n.minY=1/0,n.maxX=-1/0,n.maxY=-1/0;for(let r=t;r<e;r++){const o=s.children[r];hs(n,s.leaf?i(o):o)}return n}function hs(s,t){return s.minX=Math.min(s.minX,t.minX),s.minY=Math.min(s.minY,t.minY),s.maxX=Math.max(s.maxX,t.maxX),s.maxY=Math.max(s.maxY,t.maxY),s}function vf(s,t){return s.minX-t.minX}function Lf(s,t){return s.minY-t.minY}function xo(s){return(s.maxX-s.minX)*(s.maxY-s.minY)}function ir(s){return s.maxX-s.minX+(s.maxY-s.minY)}function Mf(s,t){return(Math.max(t.maxX,s.maxX)-Math.min(t.minX,s.minX))*(Math.max(t.maxY,s.maxY)-Math.min(t.minY,s.minY))}function Pf(s,t){const e=Math.max(s.minX,t.minX),i=Math.max(s.minY,t.minY),n=Math.min(s.maxX,t.maxX),r=Math.min(s.maxY,t.maxY);return Math.max(0,n-e)*Math.max(0,r-i)}function Eo(s,t){return s.minX<=t.minX&&s.minY<=t.minY&&t.maxX<=s.maxX&&t.maxY<=s.maxY}function nr(s,t){return t.minX<=s.maxX&&t.minY<=s.maxY&&t.maxX>=s.minX&&t.maxY>=s.minY}function Tn(s){return{children:s,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function eh(s,t,e,i,n){const r=[t,e];for(;r.length;){if(e=r.pop(),t=r.pop(),e-t<=i)continue;const o=t+Math.ceil((e-t)/i/2)*i;Mc(s,o,t,e,n),r.push(t,o,o,e)}}const nt={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ih(s){return s[0]>0&&s[1]>0}function Ff(s,t,e){return e===void 0&&(e=[0,0]),e[0]=s[0]*t+.5|0,e[1]=s[1]*t+.5|0,e}function Bt(s,t){return Array.isArray(s)?s:(t===void 0?t=[s,s]:(t[0]=s,t[1]=s),t)}class qr{constructor(t){this.opacity_=t.opacity,this.rotateWithView_=t.rotateWithView,this.rotation_=t.rotation,this.scale_=t.scale,this.scaleArray_=Bt(t.scale),this.displacement_=t.displacement,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new qr({opacity:this.getOpacity(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getOpacity(){return this.opacity_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getDisplacement(){return this.displacement_}getDeclutterMode(){return this.declutterMode_}getAnchor(){return q()}getImage(t){return q()}getHitDetectionImage(){return q()}getPixelRatio(t){return 1}getImageState(){return q()}getImageSize(){return q()}getOrigin(){return q()}getSize(){return q()}setDisplacement(t){this.displacement_=t}setOpacity(t){this.opacity_=t}setRotateWithView(t){this.rotateWithView_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Bt(t)}listenImageChange(t){q()}load(){q()}unlistenImageChange(t){q()}ready(){return Promise.resolve()}}const ys={name:"rgb",min:[0,0,0],max:[255,255,255],channel:["red","green","blue"],alias:["RGB"]};var zt={name:"xyz",min:[0,0,0],channel:["X","Y","Z"],alias:["XYZ","ciexyz","cie1931"]};zt.whitepoint={2:{A:[109.85,100,35.585],C:[98.074,100,118.232],D50:[96.422,100,82.521],D55:[95.682,100,92.149],D65:[95.045592705167,100,108.9057750759878],D75:[94.972,100,122.638],F2:[99.187,100,67.395],F7:[95.044,100,108.755],F11:[100.966,100,64.37],E:[100,100,100]},10:{A:[111.144,100,35.2],C:[97.285,100,116.145],D50:[96.72,100,81.427],D55:[95.799,100,90.926],D65:[94.811,100,107.304],D75:[94.416,100,120.641],F2:[103.28,100,69.026],F7:[95.792,100,107.687],F11:[103.866,100,65.627],E:[100,100,100]}};zt.max=zt.whitepoint[2].D65;zt.rgb=function(s,t){t=t||zt.whitepoint[2].E;var e=s[0]/t[0],i=s[1]/t[1],n=s[2]/t[2],r,o,a;return r=e*3.240969941904521+i*-1.537383177570093+n*-.498610760293,o=e*-.96924363628087+i*1.87596750150772+n*.041555057407175,a=e*.055630079696993+i*-.20397695888897+n*1.056971514242878,r=r>.0031308?1.055*Math.pow(r,1/2.4)-.055:r=r*12.92,o=o>.0031308?1.055*Math.pow(o,1/2.4)-.055:o=o*12.92,a=a>.0031308?1.055*Math.pow(a,1/2.4)-.055:a=a*12.92,r=Math.min(Math.max(0,r),1),o=Math.min(Math.max(0,o),1),a=Math.min(Math.max(0,a),1),[r*255,o*255,a*255]};ys.xyz=function(s,t){var e=s[0]/255,i=s[1]/255,n=s[2]/255;e=e>.04045?Math.pow((e+.055)/1.055,2.4):e/12.92,i=i>.04045?Math.pow((i+.055)/1.055,2.4):i/12.92,n=n>.04045?Math.pow((n+.055)/1.055,2.4):n/12.92;var r=e*.41239079926595+i*.35758433938387+n*.18048078840183,o=e*.21263900587151+i*.71516867876775+n*.072192315360733,a=e*.019330818715591+i*.11919477979462+n*.95053215224966;return t=t||zt.whitepoint[2].E,[r*t[0],o*t[1],a*t[2]]};const al={name:"luv",min:[0,-134,-140],max:[100,224,122],channel:["lightness","u","v"],alias:["LUV","cieluv","cie1976"],xyz:function(s,t,e){var i,n,r,o,a,l,h,c,u,d,f,m,p;if(r=s[0],o=s[1],a=s[2],r===0)return[0,0,0];var x=.0011070564598794539;return t=t||"D65",e=e||2,u=zt.whitepoint[e][t][0],d=zt.whitepoint[e][t][1],f=zt.whitepoint[e][t][2],m=4*u/(u+15*d+3*f),p=9*d/(u+15*d+3*f),i=o/(13*r)+m||0,n=a/(13*r)+p||0,h=r>8?d*Math.pow((r+16)/116,3):d*r*x,l=h*9*i/(4*n)||0,c=h*(12-3*i-20*n)/(4*n)||0,[l,h,c]}};zt.luv=function(s,t,e){var i,n,r,o,a,l,h,c,u,d,f,m,p,x=.008856451679035631,T=903.2962962962961;t=t||"D65",e=e||2,u=zt.whitepoint[e][t][0],d=zt.whitepoint[e][t][1],f=zt.whitepoint[e][t][2],m=4*u/(u+15*d+3*f),p=9*d/(u+15*d+3*f),l=s[0],h=s[1],c=s[2],i=4*l/(l+15*h+3*c)||0,n=9*h/(l+15*h+3*c)||0;var _=h/d;return r=_<=x?T*_:116*Math.pow(_,1/3)-16,o=13*r*(i-m),a=13*r*(n-p),[r,o,a]};var Fc={name:"lchuv",channel:["lightness","chroma","hue"],alias:["LCHuv","cielchuv"],min:[0,0,0],max:[100,100,360],luv:function(s){var t=s[0],e=s[1],i=s[2],n,r,o;return o=i/360*2*Math.PI,n=e*Math.cos(o),r=e*Math.sin(o),[t,n,r]},xyz:function(s){return al.xyz(Fc.luv(s))}};al.lchuv=function(s){var t=s[0],e=s[1],i=s[2],n=Math.sqrt(e*e+i*i),r=Math.atan2(i,e),o=r*360/2/Math.PI;return o<0&&(o+=360),[t,n,o]};zt.lchuv=function(s){return al.lchuv(zt.luv(s))};const nh={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};var sh={red:0,orange:60,yellow:120,green:180,blue:240,purple:300};function bf(s){var c,u;var t,e=[],i=1,n;if(typeof s=="number")return{space:"rgb",values:[s>>>16,(s&65280)>>>8,s&255],alpha:1};if(typeof s=="number")return{space:"rgb",values:[s>>>16,(s&65280)>>>8,s&255],alpha:1};if(s=String(s).toLowerCase(),nh[s])e=nh[s].slice(),n="rgb";else if(s==="transparent")i=0,n="rgb",e=[0,0,0];else if(s[0]==="#"){var r=s.slice(1),o=r.length,a=o<=4;i=1,a?(e=[parseInt(r[0]+r[0],16),parseInt(r[1]+r[1],16),parseInt(r[2]+r[2],16)],o===4&&(i=parseInt(r[3]+r[3],16)/255)):(e=[parseInt(r[0]+r[1],16),parseInt(r[2]+r[3],16),parseInt(r[4]+r[5],16)],o===8&&(i=parseInt(r[6]+r[7],16)/255)),e[0]||(e[0]=0),e[1]||(e[1]=0),e[2]||(e[2]=0),n="rgb"}else if(t=/^((?:rgba?|hs[lvb]a?|hwba?|cmyk?|xy[zy]|gray|lab|lchu?v?|[ly]uv|lms|oklch|oklab|color))\s*\(([^\)]*)\)/.exec(s)){var l=t[1];n=l.replace(/a$/,"");var h=n==="cmyk"?4:n==="gray"?1:3;e=t[2].trim().split(/\s*[,\/]\s*|\s+/),n==="color"&&(n=e.shift()),e=e.map(function(d,f){if(d[d.length-1]==="%")return d=parseFloat(d)/100,f===3?d:n==="rgb"?d*255:n[0]==="h"||n[0]==="l"&&!f?d*100:n==="lab"?d*125:n==="lch"?f<2?d*150:d*360:n[0]==="o"&&!f?d:n==="oklab"?d*.4:n==="oklch"?f<2?d*.4:d*360:d;if(n[f]==="h"||f===2&&n[n.length-1]==="h"){if(sh[d]!==void 0)return sh[d];if(d.endsWith("deg"))return parseFloat(d);if(d.endsWith("turn"))return parseFloat(d)*360;if(d.endsWith("grad"))return parseFloat(d)*360/400;if(d.endsWith("rad"))return parseFloat(d)*180/Math.PI}return d==="none"?0:parseFloat(d)}),i=e.length>h?e.pop():1}else/[0-9](?:\s|\/|,)/.test(s)&&(e=s.match(/([0-9]+)/g).map(function(d){return parseFloat(d)}),n=((u=(c=s.match(/([a-z])/ig))==null?void 0:c.join(""))==null?void 0:u.toLowerCase())||"rgb");return{space:n,values:e,alpha:i}}const Co={name:"hsl",min:[0,0,0],max:[360,100,100],channel:["hue","saturation","lightness"],alias:["HSL"],rgb:function(s){var t=s[0]/360,e=s[1]/100,i=s[2]/100,n,r,o,a,l,h=0;if(e===0)return l=i*255,[l,l,l];for(r=i<.5?i*(1+e):i+e-i*e,n=2*i-r,a=[0,0,0];h<3;)o=t+1/3*-(h-1),o<0?o++:o>1&&o--,l=6*o<1?n+(r-n)*6*o:2*o<1?r:3*o<2?n+(r-n)*(2/3-o)*6:n,a[h++]=l*255;return a}};ys.hsl=function(s){var t=s[0]/255,e=s[1]/255,i=s[2]/255,n=Math.min(t,e,i),r=Math.max(t,e,i),o=r-n,a,l,h;return r===n?a=0:t===r?a=(e-i)/o:e===r?a=2+(i-t)/o:i===r&&(a=4+(t-e)/o),a=Math.min(a*60,360),a<0&&(a+=360),h=(n+r)/2,r===n?l=0:h<=.5?l=o/(r+n):l=o/(2-r-n),[a,l*100,h*100]};function Of(s){Array.isArray(s)&&s.raw&&(s=String.raw(...arguments)),s instanceof Number&&(s=+s);var t,e=bf(s);if(!e.space)return[];const i=e.space[0]==="h"?Co.min:ys.min,n=e.space[0]==="h"?Co.max:ys.max;return t=Array(3),t[0]=Math.min(Math.max(e.values[0],i[0]),n[0]),t[1]=Math.min(Math.max(e.values[1],i[1]),n[1]),t[2]=Math.min(Math.max(e.values[2],i[2]),n[2]),e.space[0]==="h"&&(t=Co.rgb(t)),t.push(Math.min(Math.max(e.alpha,0),1)),t}const ll=[NaN,NaN,NaN,0];function Nf(s){return typeof s=="string"?s:cl(s)}const Df=1024,ts={};let wo=0;function kf(s){if(s.length===4)return s;const t=s.slice();return t[3]=1,t}function rh(s){const t=zt.lchuv(ys.xyz(s));return t[3]=s[3],t}function Gf(s){const t=zt.rgb(Fc.xyz(s));return t[3]=s[3],t}function hl(s){if(s==="none")return ll;if(ts.hasOwnProperty(s))return ts[s];if(wo>=Df){let e=0;for(const i in ts)e++&3||(delete ts[i],--wo)}const t=Of(s);if(t.length!==4)throw new Error('failed to parse "'+s+'" as color');for(const e of t)if(isNaN(e))throw new Error('failed to parse "'+s+'" as color');return bc(t),ts[s]=t,++wo,t}function xs(s){return Array.isArray(s)?s:hl(s)}function bc(s){return s[0]=wt(s[0]+.5|0,0,255),s[1]=wt(s[1]+.5|0,0,255),s[2]=wt(s[2]+.5|0,0,255),s[3]=wt(s[3],0,1),s}function cl(s){let t=s[0];t!=(t|0)&&(t=t+.5|0);let e=s[1];e!=(e|0)&&(e=e+.5|0);let i=s[2];i!=(i|0)&&(i=i+.5|0);const n=s[3]===void 0?1:Math.round(s[3]*1e3)/1e3;return"rgba("+t+","+e+","+i+","+n+")"}const Gi=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Bf=Gi.includes("firefox"),zf=Gi.includes("safari")&&!Gi.includes("chrom");zf&&(Gi.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Gi));const Yf=Gi.includes("webkit")&&!Gi.includes("edge"),Oc=Gi.includes("macintosh"),Nc=typeof devicePixelRatio<"u"?devicePixelRatio:1,Dc=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,kc=typeof Image<"u"&&Image.prototype.decode,Gc=function(){let s=!1;try{const t=Object.defineProperty({},"passive",{get:function(){s=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return s}();function Rt(s,t,e,i){let n;return e&&e.length?n=e.shift():Dc?n=new OffscreenCanvas(s||300,t||300):n=document.createElement("canvas"),s&&(n.width=s),t&&(n.height=t),n.getContext("2d",i)}let To;function vr(){return To||(To=Rt(1,1)),To}function sn(s){const t=s.canvas;t.width=1,t.height=1,s.clearRect(0,0,1,1)}function Uf(s){let t=s.offsetWidth;const e=getComputedStyle(s);return t+=parseInt(e.marginLeft,10)+parseInt(e.marginRight,10),t}function Xf(s){let t=s.offsetHeight;const e=getComputedStyle(s);return t+=parseInt(e.marginTop,10)+parseInt(e.marginBottom,10),t}function oh(s,t){const e=t.parentNode;e&&e.replaceChild(s,t)}function Bc(s){for(;s.lastChild;)s.lastChild.remove()}function Vf(s,t){const e=s.childNodes;for(let i=0;;++i){const n=e[i],r=t[i];if(!n&&!r)break;if(n!==r){if(!n){s.appendChild(r);continue}if(!r){s.removeChild(n),--i;continue}s.insertBefore(r,n)}}}function Kf(s,t,e){const i=s;let n=!0,r=!1,o=!1;const a=[Sr(i,j.LOAD,function(){o=!0,r||t()})];return i.src&&kc?(r=!0,i.decode().then(function(){n&&t()}).catch(function(l){n&&(o?t():e())})):a.push(Sr(i,j.ERROR,e)),function(){n=!1,a.forEach(_t)}}function Wf(s,t){return new Promise((e,i)=>{function n(){o(),e(s)}function r(){o(),i(new Error("Image load error"))}function o(){s.removeEventListener("load",n),s.removeEventListener("error",r)}s.addEventListener("load",n),s.addEventListener("error",r)})}function jf(s,t){return t&&(s.src=t),s.src&&kc?new Promise((e,i)=>s.decode().then(()=>e(s)).catch(n=>s.complete&&s.width?e(s):i(n))):Wf(s)}class Zf{constructor(){this.cache_={},this.patternCache_={},this.cacheSize_=0,this.maxCacheSize_=32}clear(){this.cache_={},this.patternCache_={},this.cacheSize_=0}canExpireCache(){return this.cacheSize_>this.maxCacheSize_}expire(){if(this.canExpireCache()){let t=0;for(const e in this.cache_){const i=this.cache_[e];!(t++&3)&&!i.hasListener()&&(delete this.cache_[e],delete this.patternCache_[e],--this.cacheSize_)}}}get(t,e,i){const n=So(t,e,i);return n in this.cache_?this.cache_[n]:null}getPattern(t,e,i){const n=So(t,e,i);return n in this.patternCache_?this.patternCache_[n]:null}set(t,e,i,n,r){const o=So(t,e,i),a=o in this.cache_;this.cache_[o]=n,r&&(n.getImageState()===nt.IDLE&&n.load(),n.getImageState()===nt.LOADING?n.ready().then(()=>{this.patternCache_[o]=vr().createPattern(n.getImage(1),"repeat")}):this.patternCache_[o]=vr().createPattern(n.getImage(1),"repeat")),a||++this.cacheSize_}setSize(t){this.maxCacheSize_=t,this.expire()}}function So(s,t,e){const i=e?xs(e):"null";return t+":"+s+":"+i}const Ve=new Zf;let es=null;class Qf extends Kr{constructor(t,e,i,n,r){super(),this.hitDetectionImage_=null,this.image_=t,this.crossOrigin_=i,this.canvas_={},this.color_=r,this.imageState_=n===void 0?nt.IDLE:n,this.size_=t&&t.width&&t.height?[t.width,t.height]:null,this.src_=e,this.tainted_,this.ready_=null}initializeImage_(){this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)}isTainted_(){if(this.tainted_===void 0&&this.imageState_===nt.LOADED){es||(es=Rt(1,1,void 0,{willReadFrequently:!0})),es.drawImage(this.image_,0,0);try{es.getImageData(0,0,1,1),this.tainted_=!1}catch{es=null,this.tainted_=!0}}return this.tainted_===!0}dispatchChangeEvent_(){this.dispatchEvent(j.CHANGE)}handleImageError_(){this.imageState_=nt.ERROR,this.dispatchChangeEvent_()}handleImageLoad_(){this.imageState_=nt.LOADED,this.size_=[this.image_.width,this.image_.height],this.dispatchChangeEvent_()}getImage(t){return this.image_||this.initializeImage_(),this.replaceColor_(t),this.canvas_[t]?this.canvas_[t]:this.image_}getPixelRatio(t){return this.replaceColor_(t),this.canvas_[t]?t:1}getImageState(){return this.imageState_}getHitDetectionImage(){if(this.image_||this.initializeImage_(),!this.hitDetectionImage_)if(this.isTainted_()){const t=this.size_[0],e=this.size_[1],i=Rt(t,e);i.fillRect(0,0,t,e),this.hitDetectionImage_=i.canvas}else this.hitDetectionImage_=this.image_;return this.hitDetectionImage_}getSize(){return this.size_}getSrc(){return this.src_}load(){if(this.imageState_===nt.IDLE){this.image_||this.initializeImage_(),this.imageState_=nt.LOADING;try{this.src_!==void 0&&(this.image_.src=this.src_)}catch{this.handleImageError_()}this.image_ instanceof HTMLImageElement&&jf(this.image_,this.src_).then(t=>{this.image_=t,this.handleImageLoad_()}).catch(this.handleImageError_.bind(this))}}replaceColor_(t){if(!this.color_||this.canvas_[t]||this.imageState_!==nt.LOADED)return;const e=this.image_,i=document.createElement("canvas");i.width=Math.ceil(e.width*t),i.height=Math.ceil(e.height*t);const n=i.getContext("2d");n.scale(t,t),n.drawImage(e,0,0),n.globalCompositeOperation="multiply",n.fillStyle=Nf(this.color_),n.fillRect(0,0,i.width/t,i.height/t),n.globalCompositeOperation="destination-in",n.drawImage(e,0,0),this.canvas_[t]=i}ready(){return this.ready_||(this.ready_=new Promise(t=>{if(this.imageState_===nt.LOADED||this.imageState_===nt.ERROR)t();else{const e=()=>{(this.imageState_===nt.LOADED||this.imageState_===nt.ERROR)&&(this.removeEventListener(j.CHANGE,e),t())};this.addEventListener(j.CHANGE,e)}})),this.ready_}}function ul(s,t,e,i,n,r){let o=t===void 0?void 0:Ve.get(t,e,n);return o||(o=new Qf(s,s&&"src"in s?s.src||void 0:t,e,i,n),Ve.set(t,e,n,o,r)),r&&o&&!Ve.getPattern(t,e,n)&&Ve.set(t,e,n,o,r),o}function Ke(s){return s?Array.isArray(s)?cl(s):typeof s=="object"&&"src"in s?qf(s):s:null}function qf(s){if(!s.offset||!s.size)return Ve.getPattern(s.src,"anonymous",s.color);const t=s.src+":"+s.offset,e=Ve.getPattern(t,void 0,s.color);if(e)return e;const i=Ve.get(s.src,"anonymous",null);if(i.getImageState()!==nt.LOADED)return null;const n=Rt(s.size[0],s.size[1]);return n.drawImage(i.getImage(1),s.offset[0],s.offset[1],s.size[0],s.size[1],0,0,s.size[0],s.size[1]),ul(n.canvas,t,void 0,nt.LOADED,s.color,!0),Ve.getPattern(t,void 0,s.color)}const sr="ol-hidden",Hf="ol-selectable",Hr="ol-unselectable",dl="ol-control",ah="ol-collapsed",Jf=new RegExp(["^\\s*(?=(?:(?:[-a-z]+\\s*){0,2}(italic|oblique))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(small-caps))?)","(?=(?:(?:[-a-z]+\\s*){0,2}(bold(?:er)?|lighter|[1-9]00 ))?)","(?:(?:normal|\\1|\\2|\\3)\\s*){0,3}((?:xx?-)?","(?:small|large)|medium|smaller|larger|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx]))","(?:\\s*\\/\\s*(normal|[\\.\\d]+(?:\\%|in|[cem]m|ex|p[ctx])?))",`?\\s*([-,\\"\\'\\sa-z]+?)\\s*$`].join(""),"i"),lh=["style","variant","weight","size","lineHeight","family"],zc=function(s){const t=s.match(Jf);if(!t)return null;const e={lineHeight:"normal",size:"1.2em",style:"normal",weight:"normal",variant:"normal"};for(let i=0,n=lh.length;i<n;++i){const r=t[i+1];r!==void 0&&(e[lh[i]]=r)}return e.families=e.family.split(/,\s?/),e},Yc="10px sans-serif",ne="#000",Gn="round",ai=[],li=0,Bn="round",Es=10,Cs="#000",ws="center",Lr="middle",Ji=[0,0,0,0],Ts=1,ei=new ke;let Sn=null,ta;const ea={},$f=function(){const t="32px ",e=["monospace","serif"],i=e.length,n="wmytzilWMYTZIL@#/&?$%10";let r,o;function a(h,c,u){let d=!0;for(let f=0;f<i;++f){const m=e[f];if(o=Mr(h+" "+c+" "+t+m,n),u!=m){const p=Mr(h+" "+c+" "+t+u+","+m,n);d=d&&p!=o}}return!!d}function l(){let h=!0;const c=ei.getKeys();for(let u=0,d=c.length;u<d;++u){const f=c[u];if(ei.get(f)<100){const[m,p,x]=f.split(`
`);a(m,p,x)?(Vn(ea),Sn=null,ta=void 0,ei.set(f,100)):(ei.set(f,ei.get(f)+1,!0),h=!1)}}h&&(clearInterval(r),r=void 0)}return function(h){const c=zc(h);if(!c)return;const u=c.families;for(let d=0,f=u.length;d<f;++d){const m=u[d],p=c.style+`
`+c.weight+`
`+m;ei.get(p)===void 0&&(ei.set(p,100,!0),a(c.style,c.weight,m)||(ei.set(p,0,!0),r===void 0&&(r=setInterval(l,32))))}}}(),tg=function(){let s;return function(t){let e=ea[t];if(e==null){if(Dc){const i=zc(t),n=Uc(t,"g");e=(isNaN(Number(i.lineHeight))?1.2:Number(i.lineHeight))*(n.actualBoundingBoxAscent+n.actualBoundingBoxDescent)}else s||(s=document.createElement("div"),s.innerHTML="M",s.style.minHeight="0",s.style.maxHeight="none",s.style.height="auto",s.style.padding="0",s.style.border="none",s.style.position="absolute",s.style.display="block",s.style.left="-99999px"),s.style.font=t,document.body.appendChild(s),e=s.offsetHeight,document.body.removeChild(s);ea[t]=e}return e}}();function Uc(s,t){return Sn||(Sn=Rt(1,1)),s!=ta&&(Sn.font=s,ta=Sn.font),Sn.measureText(t)}function Mr(s,t){return Uc(s,t).width}function hh(s,t,e){if(t in e)return e[t];const i=t.split(`
`).reduce((n,r)=>Math.max(n,Mr(s,r)),0);return e[t]=i,i}function eg(s,t){const e=[],i=[],n=[];let r=0,o=0,a=0,l=0;for(let h=0,c=t.length;h<=c;h+=2){const u=t[h];if(u===`
`||h===c){r=Math.max(r,o),n.push(o),o=0,a+=l,l=0;continue}const d=t[h+1]||s.font,f=Mr(d,u);e.push(f),o+=f;const m=tg(d);i.push(m),l=Math.max(l,m)}return{width:r,height:a,widths:e,heights:i,lineWidths:n}}function ig(s,t,e,i,n,r,o,a,l,h,c){s.save(),e!==1&&(s.globalAlpha===void 0?s.globalAlpha=u=>u.globalAlpha*=e:s.globalAlpha*=e),t&&s.transform.apply(s,t),i.contextInstructions?(s.translate(l,h),s.scale(c[0],c[1]),ng(i,s)):c[0]<0||c[1]<0?(s.translate(l,h),s.scale(c[0],c[1]),s.drawImage(i,n,r,o,a,0,0,o,a)):s.drawImage(i,n,r,o,a,l,h,o*c[0],a*c[1]),s.restore()}function ng(s,t){const e=s.contextInstructions;for(let i=0,n=e.length;i<n;i+=2)Array.isArray(e[i+1])?t[e[i]].apply(t,e[i+1]):t[e[i]]=e[i+1]}class Jr extends qr{constructor(t){super({opacity:1,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,rotation:t.rotation!==void 0?t.rotation:0,scale:t.scale!==void 0?t.scale:1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode}),this.canvases_,this.hitDetectionCanvas_=null,this.fill_=t.fill!==void 0?t.fill:null,this.origin_=[0,0],this.points_=t.points,this.radius=t.radius,this.radius2_=t.radius2,this.angle_=t.angle!==void 0?t.angle:0,this.stroke_=t.stroke!==void 0?t.stroke:null,this.size_,this.renderOptions_,this.imageState_=this.fill_&&this.fill_.loading()?nt.LOADING:nt.LOADED,this.imageState_===nt.LOADING&&this.ready().then(()=>this.imageState_=nt.LOADED),this.render()}clone(){const t=this.getScale(),e=new Jr({fill:this.getFill()?this.getFill().clone():void 0,points:this.getPoints(),radius:this.getRadius(),radius2:this.getRadius2(),angle:this.getAngle(),stroke:this.getStroke()?this.getStroke().clone():void 0,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}getAnchor(){const t=this.size_,e=this.getDisplacement(),i=this.getScaleArray();return[t[0]/2-e[0]/i[0],t[1]/2+e[1]/i[1]]}getAngle(){return this.angle_}getFill(){return this.fill_}setFill(t){this.fill_=t,this.render()}getHitDetectionImage(){return this.hitDetectionCanvas_||(this.hitDetectionCanvas_=this.createHitDetectionCanvas_(this.renderOptions_)),this.hitDetectionCanvas_}getImage(t){let e=this.canvases_[t];if(!e){const i=this.renderOptions_,n=Rt(i.size*t,i.size*t);this.draw_(i,n,t),e=n.canvas,this.canvases_[t]=e}return e}getPixelRatio(t){return t}getImageSize(){return this.size_}getImageState(){return this.imageState_}getOrigin(){return this.origin_}getPoints(){return this.points_}getRadius(){return this.radius}getRadius2(){return this.radius2_}getSize(){return this.size_}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t,this.render()}listenImageChange(t){}load(){}unlistenImageChange(t){}calculateLineJoinSize_(t,e,i){if(e===0||this.points_===1/0||t!=="bevel"&&t!=="miter")return e;let n=this.radius,r=this.radius2_===void 0?n:this.radius2_;if(n<r){const k=n;n=r,r=k}const o=this.radius2_===void 0?this.points_:this.points_*2,a=2*Math.PI/o,l=r*Math.sin(a),h=Math.sqrt(r*r-l*l),c=n-h,u=Math.sqrt(l*l+c*c),d=u/l;if(t==="miter"&&d<=i)return d*e;const f=e/2/d,m=e/2*(c/u),x=Math.sqrt((n+f)*(n+f)+m*m)-n;if(this.radius2_===void 0||t==="bevel")return x*2;const T=n*Math.sin(a),_=Math.sqrt(n*n-T*T),v=r-_,F=Math.sqrt(T*T+v*v)/T;if(F<=i){const k=F*e/2-r-n;return 2*Math.max(x,k)}return x*2}createRenderOptions(){let t=Gn,e=Bn,i=0,n=null,r=0,o,a=0;this.stroke_&&(o=Ke(this.stroke_.getColor()??Cs),a=this.stroke_.getWidth()??Ts,n=this.stroke_.getLineDash(),r=this.stroke_.getLineDashOffset()??0,e=this.stroke_.getLineJoin()??Bn,t=this.stroke_.getLineCap()??Gn,i=this.stroke_.getMiterLimit()??Es);const l=this.calculateLineJoinSize_(e,a,i),h=Math.max(this.radius,this.radius2_||0),c=Math.ceil(2*h+l);return{strokeStyle:o,strokeWidth:a,size:c,lineCap:t,lineDash:n,lineDashOffset:r,lineJoin:e,miterLimit:i}}render(){this.renderOptions_=this.createRenderOptions();const t=this.renderOptions_.size;this.canvases_={},this.hitDetectionCanvas_=null,this.size_=[t,t]}draw_(t,e,i){if(e.scale(i,i),e.translate(t.size/2,t.size/2),this.createPath_(e),this.fill_){let n=this.fill_.getColor();n===null&&(n=ne),e.fillStyle=Ke(n),e.fill()}t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}createHitDetectionCanvas_(t){let e;if(this.fill_){let i=this.fill_.getColor(),n=0;typeof i=="string"&&(i=xs(i)),i===null?n=1:Array.isArray(i)&&(n=i.length===4?i[3]:1),n===0&&(e=Rt(t.size,t.size),this.drawHitDetectionCanvas_(t,e))}return e?e.canvas:this.getImage(1)}createPath_(t){let e=this.points_;const i=this.radius;if(e===1/0)t.arc(0,0,i,0,2*Math.PI);else{const n=this.radius2_===void 0?i:this.radius2_;this.radius2_!==void 0&&(e*=2);const r=this.angle_-Math.PI/2,o=2*Math.PI/e;for(let a=0;a<e;a++){const l=r+a*o,h=a%2===0?i:n;t.lineTo(h*Math.cos(l),h*Math.sin(l))}t.closePath()}}drawHitDetectionCanvas_(t,e){e.translate(t.size/2,t.size/2),this.createPath_(e),e.fillStyle=ne,e.fill(),t.strokeStyle&&(e.strokeStyle=t.strokeStyle,e.lineWidth=t.strokeWidth,t.lineDash&&(e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset),e.lineJoin=t.lineJoin,e.miterLimit=t.miterLimit,e.stroke())}ready(){return this.fill_?this.fill_.ready():Promise.resolve()}}class cn extends Jr{constructor(t){t=t||{radius:5},super({points:1/0,fill:t.fill,radius:t.radius,stroke:t.stroke,scale:t.scale!==void 0?t.scale:1,rotation:t.rotation!==void 0?t.rotation:0,rotateWithView:t.rotateWithView!==void 0?t.rotateWithView:!1,displacement:t.displacement!==void 0?t.displacement:[0,0],declutterMode:t.declutterMode})}clone(){const t=this.getScale(),e=new cn({fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,radius:this.getRadius(),scale:Array.isArray(t)?t.slice():t,rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()});return e.setOpacity(this.getOpacity()),e}setRadius(t){this.radius=t,this.render()}}class Ct{constructor(t){t=t||{},this.patternImage_=null,this.color_=null,t.color!==void 0&&this.setColor(t.color)}clone(){const t=this.getColor();return new Ct({color:Array.isArray(t)?t.slice():t||void 0})}getColor(){return this.color_}setColor(t){if(t!==null&&typeof t=="object"&&"src"in t){const e=ul(null,t.src,"anonymous",void 0,t.offset?null:t.color?t.color:null,!(t.offset&&t.size));e.ready().then(()=>{this.patternImage_=null}),e.getImageState()===nt.IDLE&&e.load(),e.getImageState()===nt.LOADING&&(this.patternImage_=e)}this.color_=t}loading(){return!!this.patternImage_}ready(){return this.patternImage_?this.patternImage_.ready():Promise.resolve()}}class oe{constructor(t){t=t||{},this.color_=t.color!==void 0?t.color:null,this.lineCap_=t.lineCap,this.lineDash_=t.lineDash!==void 0?t.lineDash:null,this.lineDashOffset_=t.lineDashOffset,this.lineJoin_=t.lineJoin,this.miterLimit_=t.miterLimit,this.width_=t.width}clone(){const t=this.getColor();return new oe({color:Array.isArray(t)?t.slice():t||void 0,lineCap:this.getLineCap(),lineDash:this.getLineDash()?this.getLineDash().slice():void 0,lineDashOffset:this.getLineDashOffset(),lineJoin:this.getLineJoin(),miterLimit:this.getMiterLimit(),width:this.getWidth()})}getColor(){return this.color_}getLineCap(){return this.lineCap_}getLineDash(){return this.lineDash_}getLineDashOffset(){return this.lineDashOffset_}getLineJoin(){return this.lineJoin_}getMiterLimit(){return this.miterLimit_}getWidth(){return this.width_}setColor(t){this.color_=t}setLineCap(t){this.lineCap_=t}setLineDash(t){this.lineDash_=t}setLineDashOffset(t){this.lineDashOffset_=t}setLineJoin(t){this.lineJoin_=t}setMiterLimit(t){this.miterLimit_=t}setWidth(t){this.width_=t}}class At{constructor(t){t=t||{},this.geometry_=null,this.geometryFunction_=ch,t.geometry!==void 0&&this.setGeometry(t.geometry),this.fill_=t.fill!==void 0?t.fill:null,this.image_=t.image!==void 0?t.image:null,this.renderer_=t.renderer!==void 0?t.renderer:null,this.hitDetectionRenderer_=t.hitDetectionRenderer!==void 0?t.hitDetectionRenderer:null,this.stroke_=t.stroke!==void 0?t.stroke:null,this.text_=t.text!==void 0?t.text:null,this.zIndex_=t.zIndex}clone(){let t=this.getGeometry();return t&&typeof t=="object"&&(t=t.clone()),new At({geometry:t??void 0,fill:this.getFill()?this.getFill().clone():void 0,image:this.getImage()?this.getImage().clone():void 0,renderer:this.getRenderer()??void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,text:this.getText()?this.getText().clone():void 0,zIndex:this.getZIndex()})}getRenderer(){return this.renderer_}setRenderer(t){this.renderer_=t}setHitDetectionRenderer(t){this.hitDetectionRenderer_=t}getHitDetectionRenderer(){return this.hitDetectionRenderer_}getGeometry(){return this.geometry_}getGeometryFunction(){return this.geometryFunction_}getFill(){return this.fill_}setFill(t){this.fill_=t}getImage(){return this.image_}setImage(t){this.image_=t}getStroke(){return this.stroke_}setStroke(t){this.stroke_=t}getText(){return this.text_}setText(t){this.text_=t}getZIndex(){return this.zIndex_}setGeometry(t){typeof t=="function"?this.geometryFunction_=t:typeof t=="string"?this.geometryFunction_=function(e){return e.get(t)}:t?t!==void 0&&(this.geometryFunction_=function(){return t}):this.geometryFunction_=ch,this.geometry_=t}setZIndex(t){this.zIndex_=t}}function sg(s){let t;if(typeof s=="function")t=s;else{let e;Array.isArray(s)?e=s:(lt(typeof s.getZIndex=="function","Expected an `Style` or an array of `Style`"),e=[s]),t=function(){return e}}return t}let Ro=null;function Xc(s,t){if(!Ro){const e=new Ct({color:"rgba(255,255,255,0.4)"}),i=new oe({color:"#3399CC",width:1.25});Ro=[new At({image:new cn({fill:e,stroke:i,radius:5}),fill:e,stroke:i})]}return Ro}function Vc(){const s={},t=[255,255,255,1],e=[0,153,255,1],i=3;return s.Polygon=[new At({fill:new Ct({color:[255,255,255,.5]})})],s.MultiPolygon=s.Polygon,s.LineString=[new At({stroke:new oe({color:t,width:i+2})}),new At({stroke:new oe({color:e,width:i})})],s.MultiLineString=s.LineString,s.Circle=s.Polygon.concat(s.LineString),s.Point=[new At({image:new cn({radius:i*2,fill:new Ct({color:e}),stroke:new oe({color:t,width:i/2})}),zIndex:1/0})],s.MultiPoint=s.Point,s.GeometryCollection=s.Polygon.concat(s.LineString,s.Point),s}function ch(s){return s.getGeometry()}function uh(s,t,e,i){return e!==void 0&&i!==void 0?[e/s,i/t]:e!==void 0?e/s:i!==void 0?i/t:1}class fi extends qr{constructor(t){t=t||{};const e=t.opacity!==void 0?t.opacity:1,i=t.rotation!==void 0?t.rotation:0,n=t.scale!==void 0?t.scale:1,r=t.rotateWithView!==void 0?t.rotateWithView:!1;super({opacity:e,rotation:i,scale:n,displacement:t.displacement!==void 0?t.displacement:[0,0],rotateWithView:r,declutterMode:t.declutterMode}),this.anchor_=t.anchor!==void 0?t.anchor:[.5,.5],this.normalizedAnchor_=null,this.anchorOrigin_=t.anchorOrigin!==void 0?t.anchorOrigin:"top-left",this.anchorXUnits_=t.anchorXUnits!==void 0?t.anchorXUnits:"fraction",this.anchorYUnits_=t.anchorYUnits!==void 0?t.anchorYUnits:"fraction",this.crossOrigin_=t.crossOrigin!==void 0?t.crossOrigin:null;const o=t.img!==void 0?t.img:null;let a=t.src;lt(!(a!==void 0&&o),"`image` and `src` cannot be provided at the same time"),(a===void 0||a.length===0)&&o&&(a=o.src||J(o)),lt(a!==void 0&&a.length>0,"A defined and non-empty `src` or `image` must be provided"),lt(!((t.width!==void 0||t.height!==void 0)&&t.scale!==void 0),"`width` or `height` cannot be provided together with `scale`");let l;if(t.src!==void 0?l=nt.IDLE:o!==void 0&&("complete"in o?o.complete?l=o.src?nt.LOADED:nt.IDLE:l=nt.LOADING:l=nt.LOADED),this.color_=t.color!==void 0?xs(t.color):null,this.iconImage_=ul(o,a,this.crossOrigin_,l,this.color_),this.offset_=t.offset!==void 0?t.offset:[0,0],this.offsetOrigin_=t.offsetOrigin!==void 0?t.offsetOrigin:"top-left",this.origin_=null,this.size_=t.size!==void 0?t.size:null,this.initialOptions_,t.width!==void 0||t.height!==void 0){let h,c;if(t.size)[h,c]=t.size;else{const u=this.getImage(1);if(u.width&&u.height)h=u.width,c=u.height;else if(u instanceof HTMLImageElement){this.initialOptions_=t;const d=()=>{if(this.unlistenImageChange(d),!this.initialOptions_)return;const f=this.iconImage_.getSize();this.setScale(uh(f[0],f[1],t.width,t.height))};this.listenImageChange(d);return}}h!==void 0&&this.setScale(uh(h,c,t.width,t.height))}}clone(){let t,e,i;return this.initialOptions_?(e=this.initialOptions_.width,i=this.initialOptions_.height):(t=this.getScale(),t=Array.isArray(t)?t.slice():t),new fi({anchor:this.anchor_.slice(),anchorOrigin:this.anchorOrigin_,anchorXUnits:this.anchorXUnits_,anchorYUnits:this.anchorYUnits_,color:this.color_&&this.color_.slice?this.color_.slice():this.color_||void 0,crossOrigin:this.crossOrigin_,offset:this.offset_.slice(),offsetOrigin:this.offsetOrigin_,opacity:this.getOpacity(),rotateWithView:this.getRotateWithView(),rotation:this.getRotation(),scale:t,width:e,height:i,size:this.size_!==null?this.size_.slice():void 0,src:this.getSrc(),displacement:this.getDisplacement().slice(),declutterMode:this.getDeclutterMode()})}getAnchor(){let t=this.normalizedAnchor_;if(!t){t=this.anchor_;const n=this.getSize();if(this.anchorXUnits_=="fraction"||this.anchorYUnits_=="fraction"){if(!n)return null;t=this.anchor_.slice(),this.anchorXUnits_=="fraction"&&(t[0]*=n[0]),this.anchorYUnits_=="fraction"&&(t[1]*=n[1])}if(this.anchorOrigin_!="top-left"){if(!n)return null;t===this.anchor_&&(t=this.anchor_.slice()),(this.anchorOrigin_=="top-right"||this.anchorOrigin_=="bottom-right")&&(t[0]=-t[0]+n[0]),(this.anchorOrigin_=="bottom-left"||this.anchorOrigin_=="bottom-right")&&(t[1]=-t[1]+n[1])}this.normalizedAnchor_=t}const e=this.getDisplacement(),i=this.getScaleArray();return[t[0]-e[0]/i[0],t[1]+e[1]/i[1]]}setAnchor(t){this.anchor_=t,this.normalizedAnchor_=null}getColor(){return this.color_}getImage(t){return this.iconImage_.getImage(t)}getPixelRatio(t){return this.iconImage_.getPixelRatio(t)}getImageSize(){return this.iconImage_.getSize()}getImageState(){return this.iconImage_.getImageState()}getHitDetectionImage(){return this.iconImage_.getHitDetectionImage()}getOrigin(){if(this.origin_)return this.origin_;let t=this.offset_;if(this.offsetOrigin_!="top-left"){const e=this.getSize(),i=this.iconImage_.getSize();if(!e||!i)return null;t=t.slice(),(this.offsetOrigin_=="top-right"||this.offsetOrigin_=="bottom-right")&&(t[0]=i[0]-e[0]-t[0]),(this.offsetOrigin_=="bottom-left"||this.offsetOrigin_=="bottom-right")&&(t[1]=i[1]-e[1]-t[1])}return this.origin_=t,this.origin_}getSrc(){return this.iconImage_.getSrc()}getSize(){return this.size_?this.size_:this.iconImage_.getSize()}getWidth(){const t=this.getScaleArray();if(this.size_)return this.size_[0]*t[0];if(this.iconImage_.getImageState()==nt.LOADED)return this.iconImage_.getSize()[0]*t[0]}getHeight(){const t=this.getScaleArray();if(this.size_)return this.size_[1]*t[1];if(this.iconImage_.getImageState()==nt.LOADED)return this.iconImage_.getSize()[1]*t[1]}setScale(t){delete this.initialOptions_,super.setScale(t)}listenImageChange(t){this.iconImage_.addEventListener(j.CHANGE,t)}load(){this.iconImage_.load()}unlistenImageChange(t){this.iconImage_.removeEventListener(j.CHANGE,t)}ready(){return this.iconImage_.ready()}}const rg="#333";class ie{constructor(t){t=t||{},this.font_=t.font,this.rotation_=t.rotation,this.rotateWithView_=t.rotateWithView,this.scale_=t.scale,this.scaleArray_=Bt(t.scale!==void 0?t.scale:1),this.text_=t.text,this.textAlign_=t.textAlign,this.justify_=t.justify,this.repeat_=t.repeat,this.textBaseline_=t.textBaseline,this.fill_=t.fill!==void 0?t.fill:new Ct({color:rg}),this.maxAngle_=t.maxAngle!==void 0?t.maxAngle:Math.PI/4,this.placement_=t.placement!==void 0?t.placement:"point",this.overflow_=!!t.overflow,this.stroke_=t.stroke!==void 0?t.stroke:null,this.offsetX_=t.offsetX!==void 0?t.offsetX:0,this.offsetY_=t.offsetY!==void 0?t.offsetY:0,this.backgroundFill_=t.backgroundFill?t.backgroundFill:null,this.backgroundStroke_=t.backgroundStroke?t.backgroundStroke:null,this.padding_=t.padding===void 0?null:t.padding,this.declutterMode_=t.declutterMode}clone(){const t=this.getScale();return new ie({font:this.getFont(),placement:this.getPlacement(),repeat:this.getRepeat(),maxAngle:this.getMaxAngle(),overflow:this.getOverflow(),rotation:this.getRotation(),rotateWithView:this.getRotateWithView(),scale:Array.isArray(t)?t.slice():t,text:this.getText(),textAlign:this.getTextAlign(),justify:this.getJustify(),textBaseline:this.getTextBaseline(),fill:this.getFill()?this.getFill().clone():void 0,stroke:this.getStroke()?this.getStroke().clone():void 0,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),backgroundFill:this.getBackgroundFill()?this.getBackgroundFill().clone():void 0,backgroundStroke:this.getBackgroundStroke()?this.getBackgroundStroke().clone():void 0,padding:this.getPadding()||void 0,declutterMode:this.getDeclutterMode()})}getOverflow(){return this.overflow_}getFont(){return this.font_}getMaxAngle(){return this.maxAngle_}getPlacement(){return this.placement_}getRepeat(){return this.repeat_}getOffsetX(){return this.offsetX_}getOffsetY(){return this.offsetY_}getFill(){return this.fill_}getRotateWithView(){return this.rotateWithView_}getRotation(){return this.rotation_}getScale(){return this.scale_}getScaleArray(){return this.scaleArray_}getStroke(){return this.stroke_}getText(){return this.text_}getTextAlign(){return this.textAlign_}getJustify(){return this.justify_}getTextBaseline(){return this.textBaseline_}getBackgroundFill(){return this.backgroundFill_}getBackgroundStroke(){return this.backgroundStroke_}getPadding(){return this.padding_}getDeclutterMode(){return this.declutterMode_}setOverflow(t){this.overflow_=t}setFont(t){this.font_=t}setMaxAngle(t){this.maxAngle_=t}setOffsetX(t){this.offsetX_=t}setOffsetY(t){this.offsetY_=t}setPlacement(t){this.placement_=t}setRepeat(t){this.repeat_=t}setRotateWithView(t){this.rotateWithView_=t}setFill(t){this.fill_=t}setRotation(t){this.rotation_=t}setScale(t){this.scale_=t,this.scaleArray_=Bt(t!==void 0?t:1)}setStroke(t){this.stroke_=t}setText(t){this.text_=t}setTextAlign(t){this.textAlign_=t}setJustify(t){this.justify_=t}setTextBaseline(t){this.textBaseline_=t}setBackgroundFill(t){this.backgroundFill_=t}setBackgroundStroke(t){this.backgroundStroke_=t}setPadding(t){this.padding_=t}}let un=0;const Jt=1<<un++,ot=1<<un++,se=1<<un++,Pe=1<<un++,rn=1<<un++,cs=1<<un++,rr=Math.pow(2,un)-1,fl={[Jt]:"boolean",[ot]:"number",[se]:"string",[Pe]:"color",[rn]:"number[]",[cs]:"size"},og=Object.keys(fl).map(Number).sort(je);function ag(s){return s in fl}function us(s){const t=[];for(const e of og)ds(s,e)&&t.push(fl[e]);return t.length===0?"untyped":t.length<3?t.join(" or "):t.slice(0,-1).join(", ")+", or "+t[t.length-1]}function ds(s,t){return(s&t)===t}function pi(s,t){return s===t}class Pt{constructor(t,e){if(!ag(t))throw new Error(`literal expressions must have a specific type, got ${us(t)}`);this.type=t,this.value=e}}class lg{constructor(t,e,...i){this.type=t,this.operator=e,this.args=i}}function Kc(){return{variables:new Set,properties:new Set,featureId:!1,geometryType:!1}}function Yt(s,t,e){switch(typeof s){case"boolean":{if(pi(t,se))return new Pt(se,s?"true":"false");if(!ds(t,Jt))throw new Error(`got a boolean, but expected ${us(t)}`);return new Pt(Jt,s)}case"number":{if(pi(t,cs))return new Pt(cs,Bt(s));if(pi(t,Jt))return new Pt(Jt,!!s);if(pi(t,se))return new Pt(se,s.toString());if(!ds(t,ot))throw new Error(`got a number, but expected ${us(t)}`);return new Pt(ot,s)}case"string":{if(pi(t,Pe))return new Pt(Pe,hl(s));if(pi(t,Jt))return new Pt(Jt,!!s);if(!ds(t,se))throw new Error(`got a string, but expected ${us(t)}`);return new Pt(se,s)}}if(!Array.isArray(s))throw new Error("expression must be an array or a primitive value");if(s.length===0)throw new Error("empty expression");if(typeof s[0]=="string")return yg(s,t,e);for(const i of s)if(typeof i!="number")throw new Error("expected an array of numbers");if(pi(t,cs)){if(s.length!==2)throw new Error(`expected an array of two values for a size, got ${s.length}`);return new Pt(cs,s)}if(pi(t,Pe)){if(s.length===3)return new Pt(Pe,[...s,1]);if(s.length===4)return new Pt(Pe,s);throw new Error(`expected an array of 3 or 4 values for a color, got ${s.length}`)}if(!ds(t,rn))throw new Error(`got an array of numbers, but expected ${us(t)}`);return new Pt(rn,s)}const D={Get:"get",Var:"var",Concat:"concat",GeometryType:"geometry-type",LineMetric:"line-metric",Any:"any",All:"all",Not:"!",Resolution:"resolution",Zoom:"zoom",Time:"time",Equal:"==",NotEqual:"!=",GreaterThan:">",GreaterThanOrEqualTo:">=",LessThan:"<",LessThanOrEqualTo:"<=",Multiply:"*",Divide:"/",Add:"+",Subtract:"-",Clamp:"clamp",Mod:"%",Pow:"^",Abs:"abs",Floor:"floor",Ceil:"ceil",Round:"round",Sin:"sin",Cos:"cos",Atan:"atan",Sqrt:"sqrt",Match:"match",Between:"between",Interpolate:"interpolate",Coalesce:"coalesce",Case:"case",In:"in",Number:"number",String:"string",Array:"array",Color:"color",Id:"id",Band:"band",Palette:"palette",ToString:"to-string",Has:"has"},hg={[D.Get]:Q(et(1,1/0),dh),[D.Var]:Q(et(1,1),cg),[D.Has]:Q(et(1,1/0),dh),[D.Id]:Q(ug,_n),[D.Concat]:Q(et(2,1/0),ct(se)),[D.GeometryType]:Q(dg,_n),[D.LineMetric]:Q(_n),[D.Resolution]:Q(_n),[D.Zoom]:Q(_n),[D.Time]:Q(_n),[D.Any]:Q(et(2,1/0),ct(Jt)),[D.All]:Q(et(2,1/0),ct(Jt)),[D.Not]:Q(et(1,1),ct(Jt)),[D.Equal]:Q(et(2,2),ct(rr)),[D.NotEqual]:Q(et(2,2),ct(rr)),[D.GreaterThan]:Q(et(2,2),ct(ot)),[D.GreaterThanOrEqualTo]:Q(et(2,2),ct(ot)),[D.LessThan]:Q(et(2,2),ct(ot)),[D.LessThanOrEqualTo]:Q(et(2,2),ct(ot)),[D.Multiply]:Q(et(2,1/0),fh),[D.Coalesce]:Q(et(2,1/0),fh),[D.Divide]:Q(et(2,2),ct(ot)),[D.Add]:Q(et(2,1/0),ct(ot)),[D.Subtract]:Q(et(2,2),ct(ot)),[D.Clamp]:Q(et(3,3),ct(ot)),[D.Mod]:Q(et(2,2),ct(ot)),[D.Pow]:Q(et(2,2),ct(ot)),[D.Abs]:Q(et(1,1),ct(ot)),[D.Floor]:Q(et(1,1),ct(ot)),[D.Ceil]:Q(et(1,1),ct(ot)),[D.Round]:Q(et(1,1),ct(ot)),[D.Sin]:Q(et(1,1),ct(ot)),[D.Cos]:Q(et(1,1),ct(ot)),[D.Atan]:Q(et(1,2),ct(ot)),[D.Sqrt]:Q(et(1,1),ct(ot)),[D.Match]:Q(et(4,1/0),gh,gg),[D.Between]:Q(et(3,3),ct(ot)),[D.Interpolate]:Q(et(6,1/0),gh,mg),[D.Case]:Q(et(3,1/0),fg,Ag),[D.In]:Q(et(2,2),_g),[D.Number]:Q(et(1,1/0),ct(rr)),[D.String]:Q(et(1,1/0),ct(rr)),[D.Array]:Q(et(1,1/0),ct(ot)),[D.Color]:Q(et(1,4),ct(ot)),[D.Band]:Q(et(1,3),ct(ot)),[D.Palette]:Q(et(2,2),pg),[D.ToString]:Q(et(1,1),ct(Jt|ot|se|Pe))};function dh(s,t,e){const i=s.length-1,n=new Array(i);for(let r=0;r<i;++r){const o=s[r+1];switch(typeof o){case"number":{n[r]=new Pt(ot,o);break}case"string":{n[r]=new Pt(se,o);break}default:throw new Error(`expected a string key or numeric array index for a get operation, got ${o}`)}r===0&&e.properties.add(String(o))}return n}function cg(s,t,e){const i=s[1];if(typeof i!="string")throw new Error("expected a string argument for var operation");return e.variables.add(i),[new Pt(se,i)]}function ug(s,t,e){e.featureId=!0}function dg(s,t,e){e.geometryType=!0}function _n(s,t,e){const i=s[0];if(s.length!==1)throw new Error(`expected no arguments for ${i} operation`);return[]}function et(s,t){return function(e,i,n){const r=e[0],o=e.length-1;if(s===t){if(o!==s){const a=s===1?"":"s";throw new Error(`expected ${s} argument${a} for ${r}, got ${o}`)}}else if(o<s||o>t){const a=t===1/0?`${s} or more`:`${s} to ${t}`;throw new Error(`expected ${a} arguments for ${r}, got ${o}`)}}}function fh(s,t,e){const i=s.length-1,n=new Array(i);for(let r=0;r<i;++r){const o=Yt(s[r+1],t,e);n[r]=o}return n}function ct(s){return function(t,e,i){const n=t.length-1,r=new Array(n);for(let o=0;o<n;++o){const a=Yt(t[o+1],s,i);r[o]=a}return r}}function fg(s,t,e){const i=s[0],n=s.length-1;if(n%2===0)throw new Error(`expected an odd number of arguments for ${i}, got ${n} instead`)}function gh(s,t,e){const i=s[0],n=s.length-1;if(n%2===1)throw new Error(`expected an even number of arguments for operation ${i}, got ${n} instead`)}function gg(s,t,e){const i=s.length-1,n=se|ot|Jt,r=Yt(s[1],n,e),o=Yt(s[s.length-1],t,e),a=new Array(i-2);for(let l=0;l<i-2;l+=2){try{const h=Yt(s[l+2],r.type,e);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+1} of match expression: ${h.message}`)}try{const h=Yt(s[l+3],o.type,e);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+2} of match expression: ${h.message}`)}}return[r,...a,o]}function mg(s,t,e){const i=s[1];let n;switch(i[0]){case"linear":n=1;break;case"exponential":const l=i[1];if(typeof l!="number"||l<=0)throw new Error(`expected a number base for exponential interpolation, got ${JSON.stringify(l)} instead`);n=l;break;default:throw new Error(`invalid interpolation type: ${JSON.stringify(i)}`)}const r=new Pt(ot,n);let o;try{o=Yt(s[2],ot,e)}catch(l){throw new Error(`failed to parse argument 1 in interpolate expression: ${l.message}`)}const a=new Array(s.length-3);for(let l=0;l<a.length;l+=2){try{const h=Yt(s[l+3],ot,e);a[l]=h}catch(h){throw new Error(`failed to parse argument ${l+2} for interpolate expression: ${h.message}`)}try{const h=Yt(s[l+4],t,e);a[l+1]=h}catch(h){throw new Error(`failed to parse argument ${l+3} for interpolate expression: ${h.message}`)}}return[r,o,...a]}function Ag(s,t,e){const i=Yt(s[s.length-1],t,e),n=new Array(s.length-1);for(let r=0;r<n.length-1;r+=2){try{const o=Yt(s[r+1],Jt,e);n[r]=o}catch(o){throw new Error(`failed to parse argument ${r} of case expression: ${o.message}`)}try{const o=Yt(s[r+2],i.type,e);n[r+1]=o}catch(o){throw new Error(`failed to parse argument ${r+1} of case expression: ${o.message}`)}}return n[n.length-1]=i,n}function _g(s,t,e){let i=s[2];if(!Array.isArray(i))throw new Error('the second argument for the "in" operator must be an array');let n;if(typeof i[0]=="string"){if(i[0]!=="literal")throw new Error('for the "in" operator, a string array should be wrapped in a "literal" operator to disambiguate from expressions');if(!Array.isArray(i[1]))throw new Error('failed to parse "in" expression: the literal operator must be followed by an array');i=i[1],n=se}else n=ot;const r=new Array(i.length);for(let a=0;a<r.length;a++)try{const l=Yt(i[a],n,e);r[a]=l}catch(l){throw new Error(`failed to parse haystack item ${a} for "in" expression: ${l.message}`)}return[Yt(s[1],n,e),...r]}function pg(s,t,e){let i;try{i=Yt(s[1],ot,e)}catch(o){throw new Error(`failed to parse first argument in palette expression: ${o.message}`)}const n=s[2];if(!Array.isArray(n))throw new Error("the second argument of palette must be an array");const r=new Array(n.length);for(let o=0;o<r.length;o++){let a;try{a=Yt(n[o],Pe,e)}catch(l){throw new Error(`failed to parse color at index ${o} in palette expression: ${l.message}`)}if(!(a instanceof Pt))throw new Error(`the palette color at index ${o} must be a literal value`);r[o]=a}return[i,...r]}function Q(...s){return function(t,e,i){const n=t[0];let r;for(let o=0;o<s.length;o++){const a=s[o](t,e,i);if(o==s.length-1){if(!a)throw new Error("expected last argument validator to return the parsed args");r=a}}return new lg(e,n,...r)}}function yg(s,t,e){const i=s[0],n=hg[i];if(!n)throw new Error(`unknown operator: ${i}`);return n(s,t,e)}function Wc(s){if(!s)return"";const t=s.getType();switch(t){case"Point":case"LineString":case"Polygon":return t;case"MultiPoint":case"MultiLineString":case"MultiPolygon":return t.substring(5);case"Circle":return"Polygon";case"GeometryCollection":return Wc(s.getGeometries()[0]);default:return""}}function jc(){return{variables:{},properties:{},resolution:NaN,featureId:null,geometryType:""}}function Ai(s,t,e){const i=Yt(s,t,e);return Ne(i)}function Ne(s,t){if(s instanceof Pt){if(s.type===Pe&&typeof s.value=="string"){const i=hl(s.value);return function(){return i}}return function(){return s.value}}const e=s.operator;switch(e){case D.Number:case D.String:case D.Coalesce:return xg(s);case D.Get:case D.Var:case D.Has:return Eg(s);case D.Id:return i=>i.featureId;case D.GeometryType:return i=>i.geometryType;case D.Concat:{const i=s.args.map(n=>Ne(n));return n=>"".concat(...i.map(r=>r(n).toString()))}case D.Resolution:return i=>i.resolution;case D.Any:case D.All:case D.Between:case D.In:case D.Not:return wg(s);case D.Equal:case D.NotEqual:case D.LessThan:case D.LessThanOrEqualTo:case D.GreaterThan:case D.GreaterThanOrEqualTo:return Cg(s);case D.Multiply:case D.Divide:case D.Add:case D.Subtract:case D.Clamp:case D.Mod:case D.Pow:case D.Abs:case D.Floor:case D.Ceil:case D.Round:case D.Sin:case D.Cos:case D.Atan:case D.Sqrt:return Tg(s);case D.Case:return Sg(s);case D.Match:return Rg(s);case D.Interpolate:return Ig(s);case D.ToString:return vg(s);default:throw new Error(`Unsupported operator ${e}`)}}function xg(s,t){const e=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ne(s.args[r]);switch(e){case D.Coalesce:return r=>{for(let o=0;o<i;++o){const a=n[o](r);if(typeof a<"u"&&a!==null)return a}throw new Error("Expected one of the values to be non-null")};case D.Number:case D.String:return r=>{for(let o=0;o<i;++o){const a=n[o](r);if(typeof a===e)return a}throw new Error(`Expected one of the values to be a ${e}`)};default:throw new Error(`Unsupported assertion operator ${e}`)}}function Eg(s,t){const i=s.args[0].value;switch(s.operator){case D.Get:return n=>{const r=s.args;let o=n.properties[i];for(let a=1,l=r.length;a<l;++a){const c=r[a].value;o=o[c]}return o};case D.Var:return n=>n.variables[i];case D.Has:return n=>{const r=s.args;if(!(i in n.properties))return!1;let o=n.properties[i];for(let a=1,l=r.length;a<l;++a){const c=r[a].value;if(!o||!Object.hasOwn(o,c))return!1;o=o[c]}return!0};default:throw new Error(`Unsupported accessor operator ${s.operator}`)}}function Cg(s,t){const e=s.operator,i=Ne(s.args[0]),n=Ne(s.args[1]);switch(e){case D.Equal:return r=>i(r)===n(r);case D.NotEqual:return r=>i(r)!==n(r);case D.LessThan:return r=>i(r)<n(r);case D.LessThanOrEqualTo:return r=>i(r)<=n(r);case D.GreaterThan:return r=>i(r)>n(r);case D.GreaterThanOrEqualTo:return r=>i(r)>=n(r);default:throw new Error(`Unsupported comparison operator ${e}`)}}function wg(s,t){const e=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ne(s.args[r]);switch(e){case D.Any:return r=>{for(let o=0;o<i;++o)if(n[o](r))return!0;return!1};case D.All:return r=>{for(let o=0;o<i;++o)if(!n[o](r))return!1;return!0};case D.Between:return r=>{const o=n[0](r),a=n[1](r),l=n[2](r);return o>=a&&o<=l};case D.In:return r=>{const o=n[0](r);for(let a=1;a<i;++a)if(o===n[a](r))return!0;return!1};case D.Not:return r=>!n[0](r);default:throw new Error(`Unsupported logical operator ${e}`)}}function Tg(s,t){const e=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ne(s.args[r]);switch(e){case D.Multiply:return r=>{let o=1;for(let a=0;a<i;++a)o*=n[a](r);return o};case D.Divide:return r=>n[0](r)/n[1](r);case D.Add:return r=>{let o=0;for(let a=0;a<i;++a)o+=n[a](r);return o};case D.Subtract:return r=>n[0](r)-n[1](r);case D.Clamp:return r=>{const o=n[0](r),a=n[1](r);if(o<a)return a;const l=n[2](r);return o>l?l:o};case D.Mod:return r=>n[0](r)%n[1](r);case D.Pow:return r=>Math.pow(n[0](r),n[1](r));case D.Abs:return r=>Math.abs(n[0](r));case D.Floor:return r=>Math.floor(n[0](r));case D.Ceil:return r=>Math.ceil(n[0](r));case D.Round:return r=>Math.round(n[0](r));case D.Sin:return r=>Math.sin(n[0](r));case D.Cos:return r=>Math.cos(n[0](r));case D.Atan:return i===2?r=>Math.atan2(n[0](r),n[1](r)):r=>Math.atan(n[0](r));case D.Sqrt:return r=>Math.sqrt(n[0](r));default:throw new Error(`Unsupported numeric operator ${e}`)}}function Sg(s,t){const e=s.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Ne(s.args[n]);return n=>{for(let r=0;r<e-1;r+=2)if(i[r](n))return i[r+1](n);return i[e-1](n)}}function Rg(s,t){const e=s.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Ne(s.args[n]);return n=>{const r=i[0](n);for(let o=1;o<e;o+=2)if(r===i[o](n))return i[o+1](n);return i[e-1](n)}}function Ig(s,t){const e=s.args.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Ne(s.args[n]);return n=>{const r=i[0](n),o=i[1](n);let a,l;for(let h=2;h<e;h+=2){const c=i[h](n);let u=i[h+1](n);const d=Array.isArray(u);if(d&&(u=kf(u)),c>=o)return h===2?u:d?Lg(r,o,a,l,c,u):fs(r,o,a,l,c,u);a=c,l=u}return l}}function vg(s,t){const e=s.operator,i=s.args.length,n=new Array(i);for(let r=0;r<i;++r)n[r]=Ne(s.args[r]);switch(e){case D.ToString:return r=>{const o=n[0](r);return s.args[0].type===Pe?cl(o):o.toString()};default:throw new Error(`Unsupported convert operator ${e}`)}}function fs(s,t,e,i,n,r){const o=n-e;if(o===0)return i;const a=t-e,l=s===1?a/o:(Math.pow(s,a)-1)/(Math.pow(s,o)-1);return i+l*(r-i)}function Lg(s,t,e,i,n,r){if(n-e===0)return i;const a=rh(i),l=rh(r);let h=l[2]-a[2];h>180?h-=360:h<-180&&(h+=360);const c=[fs(s,t,e,a[0],n,l[0]),fs(s,t,e,a[1],n,l[1]),a[2]+fs(s,t,e,0,n,h),fs(s,t,e,i[3],n,r[3])];return bc(Gf(c))}function Mg(s){return!0}function Pg(s){const t=Kc(),e=Fg(s,t),i=jc();return function(n,r){if(i.properties=n.getPropertiesInternal(),i.resolution=r,t.featureId){const o=n.getId();o!==void 0?i.featureId=o:i.featureId=null}return t.geometryType&&(i.geometryType=Wc(n.getGeometry())),e(i)}}function mh(s){const t=Kc(),e=s.length,i=new Array(e);for(let o=0;o<e;++o)i[o]=ia(s[o],t);const n=jc(),r=new Array(e);return function(o,a){if(n.properties=o.getPropertiesInternal(),n.resolution=a,t.featureId){const h=o.getId();h!==void 0?n.featureId=h:n.featureId=null}let l=0;for(let h=0;h<e;++h){const c=i[h](n);c&&(r[l]=c,l+=1)}return r.length=l,r}}function Fg(s,t){const e=s.length,i=new Array(e);for(let n=0;n<e;++n){const r=s[n],o="filter"in r?Ai(r.filter,Jt,t):Mg;let a;if(Array.isArray(r.style)){const l=r.style.length;a=new Array(l);for(let h=0;h<l;++h)a[h]=ia(r.style[h],t)}else a=[ia(r.style,t)];i[n]={filter:o,styles:a}}return function(n){const r=[];let o=!1;for(let a=0;a<e;++a){const l=i[a].filter;if(l(n)&&!(s[a].else&&o)){o=!0;for(const h of i[a].styles){const c=h(n);c&&r.push(c)}}}return r}}function ia(s,t){const e=Ss(s,"",t),i=Rs(s,"",t),n=bg(s,t),r=Og(s,t),o=re(s,"z-index",t);if(!e&&!i&&!n&&!r&&!ki(s))throw new Error("No fill, stroke, point, or text symbolizer properties in style: "+JSON.stringify(s));const a=new At;return function(l){let h=!0;if(e){const c=e(l);c&&(h=!1),a.setFill(c)}if(i){const c=i(l);c&&(h=!1),a.setStroke(c)}if(n){const c=n(l);c&&(h=!1),a.setText(c)}if(r){const c=r(l);c&&(h=!1),a.setImage(c)}return o&&a.setZIndex(o(l)),h?null:a}}function Ss(s,t,e){let i;if(t+"fill-pattern-src"in s)i=Gg(s,t+"fill-",e);else{if(s[t+"fill-color"]==="none")return r=>null;i=gl(s,t+"fill-color",e)}if(!i)return null;const n=new Ct;return function(r){const o=i(r);return o===ll?null:(n.setColor(o),n)}}function Rs(s,t,e){const i=re(s,t+"stroke-width",e),n=gl(s,t+"stroke-color",e);if(!i&&!n)return null;const r=si(s,t+"stroke-line-cap",e),o=si(s,t+"stroke-line-join",e),a=Zc(s,t+"stroke-line-dash",e),l=re(s,t+"stroke-line-dash-offset",e),h=re(s,t+"stroke-miter-limit",e),c=new oe;return function(u){if(n){const d=n(u);if(d===ll)return null;c.setColor(d)}if(i&&c.setWidth(i(u)),r){const d=r(u);if(d!=="butt"&&d!=="round"&&d!=="square")throw new Error("Expected butt, round, or square line cap");c.setLineCap(d)}if(o){const d=o(u);if(d!=="bevel"&&d!=="round"&&d!=="miter")throw new Error("Expected bevel, round, or miter line join");c.setLineJoin(d)}return a&&c.setLineDash(a(u)),l&&c.setLineDashOffset(l(u)),h&&c.setMiterLimit(h(u)),c}}function bg(s,t){const e="text-",i=si(s,e+"value",t);if(!i)return null;const n=Ss(s,e,t),r=Ss(s,e+"background-",t),o=Rs(s,e,t),a=Rs(s,e+"background-",t),l=si(s,e+"font",t),h=re(s,e+"max-angle",t),c=re(s,e+"offset-x",t),u=re(s,e+"offset-y",t),d=Is(s,e+"overflow",t),f=si(s,e+"placement",t),m=re(s,e+"repeat",t),p=$r(s,e+"scale",t),x=Is(s,e+"rotate-with-view",t),T=re(s,e+"rotation",t),_=si(s,e+"align",t),v=si(s,e+"justify",t),P=si(s,e+"baseline",t),F=Zc(s,e+"padding",t),k=to(s,e+"declutter-mode"),O=new ie({declutterMode:k});return function(g){if(O.setText(i(g)),n&&O.setFill(n(g)),r&&O.setBackgroundFill(r(g)),o&&O.setStroke(o(g)),a&&O.setBackgroundStroke(a(g)),l&&O.setFont(l(g)),h&&O.setMaxAngle(h(g)),c&&O.setOffsetX(c(g)),u&&O.setOffsetY(u(g)),d&&O.setOverflow(d(g)),f){const A=f(g);if(A!=="point"&&A!=="line")throw new Error("Expected point or line for text-placement");O.setPlacement(A)}if(m&&O.setRepeat(m(g)),p&&O.setScale(p(g)),x&&O.setRotateWithView(x(g)),T&&O.setRotation(T(g)),_){const A=_(g);if(A!=="left"&&A!=="center"&&A!=="right"&&A!=="end"&&A!=="start")throw new Error("Expected left, right, center, start, or end for text-align");O.setTextAlign(A)}if(v){const A=v(g);if(A!=="left"&&A!=="right"&&A!=="center")throw new Error("Expected left, right, or center for text-justify");O.setJustify(A)}if(P){const A=P(g);if(A!=="bottom"&&A!=="top"&&A!=="middle"&&A!=="alphabetic"&&A!=="hanging")throw new Error("Expected bottom, top, middle, alphabetic, or hanging for text-baseline");O.setTextBaseline(A)}return F&&O.setPadding(F(g)),O}}function Og(s,t){return"icon-src"in s?Ng(s,t):"shape-points"in s?Dg(s,t):"circle-radius"in s?kg(s,t):null}function Ng(s,t){const e="icon-",i=e+"src",n=Qc(s[i],i),r=Pr(s,e+"anchor",t),o=$r(s,e+"scale",t),a=re(s,e+"opacity",t),l=Pr(s,e+"displacement",t),h=re(s,e+"rotation",t),c=Is(s,e+"rotate-with-view",t),u=_h(s,e+"anchor-origin"),d=ph(s,e+"anchor-x-units"),f=ph(s,e+"anchor-y-units"),m=Ug(s,e+"color"),p=zg(s,e+"cross-origin"),x=Yg(s,e+"offset"),T=_h(s,e+"offset-origin"),_=Fr(s,e+"width"),v=Fr(s,e+"height"),P=Bg(s,e+"size"),F=to(s,e+"declutter-mode"),k=new fi({src:n,anchorOrigin:u,anchorXUnits:d,anchorYUnits:f,color:m,crossOrigin:p,offset:x,offsetOrigin:T,height:v,width:_,size:P,declutterMode:F});return function(O){return a&&k.setOpacity(a(O)),l&&k.setDisplacement(l(O)),h&&k.setRotation(h(O)),c&&k.setRotateWithView(c(O)),o&&k.setScale(o(O)),r&&k.setAnchor(r(O)),k}}function Dg(s,t){const e="shape-",i=e+"points",n=e+"radius",r=na(s[i],i),o=na(s[n],n),a=Ss(s,e,t),l=Rs(s,e,t),h=$r(s,e+"scale",t),c=Pr(s,e+"displacement",t),u=re(s,e+"rotation",t),d=Is(s,e+"rotate-with-view",t),f=Fr(s,e+"radius2"),m=Fr(s,e+"angle"),p=to(s,e+"declutter-mode"),x=new Jr({points:r,radius:o,radius2:f,angle:m,declutterMode:p});return function(T){return a&&x.setFill(a(T)),l&&x.setStroke(l(T)),c&&x.setDisplacement(c(T)),u&&x.setRotation(u(T)),d&&x.setRotateWithView(d(T)),h&&x.setScale(h(T)),x}}function kg(s,t){const e="circle-",i=Ss(s,e,t),n=Rs(s,e,t),r=re(s,e+"radius",t),o=$r(s,e+"scale",t),a=Pr(s,e+"displacement",t),l=re(s,e+"rotation",t),h=Is(s,e+"rotate-with-view",t),c=to(s,e+"declutter-mode"),u=new cn({radius:5,declutterMode:c});return function(d){return r&&u.setRadius(r(d)),i&&u.setFill(i(d)),n&&u.setStroke(n(d)),a&&u.setDisplacement(a(d)),l&&u.setRotation(l(d)),h&&u.setRotateWithView(h(d)),o&&u.setScale(o(d)),u}}function re(s,t,e){if(!(t in s))return;const i=Ai(s[t],ot,e);return function(n){return na(i(n),t)}}function si(s,t,e){if(!(t in s))return null;const i=Ai(s[t],se,e);return function(n){return Qc(i(n),t)}}function Gg(s,t,e){const i=si(s,t+"pattern-src",e),n=Ah(s,t+"pattern-offset",e),r=Ah(s,t+"pattern-size",e),o=gl(s,t+"color",e);return function(a){return{src:i(a),offset:n&&n(a),size:r&&r(a),color:o&&o(a)}}}function Is(s,t,e){if(!(t in s))return null;const i=Ai(s[t],Jt,e);return function(n){const r=i(n);if(typeof r!="boolean")throw new Error(`Expected a boolean for ${t}`);return r}}function gl(s,t,e){if(!(t in s))return null;const i=Ai(s[t],Pe,e);return function(n){return qc(i(n),t)}}function Zc(s,t,e){if(!(t in s))return null;const i=Ai(s[t],rn,e);return function(n){return Gs(i(n),t)}}function Pr(s,t,e){if(!(t in s))return null;const i=Ai(s[t],rn,e);return function(n){const r=Gs(i(n),t);if(r.length!==2)throw new Error(`Expected two numbers for ${t}`);return r}}function Ah(s,t,e){if(!(t in s))return null;const i=Ai(s[t],rn,e);return function(n){return Hc(i(n),t)}}function $r(s,t,e){if(!(t in s))return null;const i=Ai(s[t],rn|ot,e);return function(n){return Xg(i(n),t)}}function Fr(s,t){const e=s[t];if(e!==void 0){if(typeof e!="number")throw new Error(`Expected a number for ${t}`);return e}}function Bg(s,t){const e=s[t];if(e!==void 0){if(typeof e=="number")return Bt(e);if(!Array.isArray(e))throw new Error(`Expected a number or size array for ${t}`);if(e.length!==2||typeof e[0]!="number"||typeof e[1]!="number")throw new Error(`Expected a number or size array for ${t}`);return e}}function zg(s,t){const e=s[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);return e}}function _h(s,t){const e=s[t];if(e!==void 0){if(e!=="bottom-left"&&e!=="bottom-right"&&e!=="top-left"&&e!=="top-right")throw new Error(`Expected bottom-left, bottom-right, top-left, or top-right for ${t}`);return e}}function ph(s,t){const e=s[t];if(e!==void 0){if(e!=="pixels"&&e!=="fraction")throw new Error(`Expected pixels or fraction for ${t}`);return e}}function Yg(s,t){const e=s[t];if(e!==void 0)return Gs(e,t)}function to(s,t){const e=s[t];if(e!==void 0){if(typeof e!="string")throw new Error(`Expected a string for ${t}`);if(e!=="declutter"&&e!=="obstacle"&&e!=="none")throw new Error(`Expected declutter, obstacle, or none for ${t}`);return e}}function Ug(s,t){const e=s[t];if(e!==void 0)return qc(e,t)}function Gs(s,t){if(!Array.isArray(s))throw new Error(`Expected an array for ${t}`);const e=s.length;for(let i=0;i<e;++i)if(typeof s[i]!="number")throw new Error(`Expected an array of numbers for ${t}`);return s}function Qc(s,t){if(typeof s!="string")throw new Error(`Expected a string for ${t}`);return s}function na(s,t){if(typeof s!="number")throw new Error(`Expected a number for ${t}`);return s}function qc(s,t){if(typeof s=="string")return s;const e=Gs(s,t),i=e.length;if(i<3||i>4)throw new Error(`Expected a color with 3 or 4 values for ${t}`);return e}function Hc(s,t){const e=Gs(s,t);if(e.length!==2)throw new Error(`Expected an array of two numbers for ${t}`);return e}function Xg(s,t){return typeof s=="number"?s:Hc(s,t)}const yh={RENDER_ORDER:"renderOrder"};class ml extends Qr{constructor(t){t=t||{};const e=Object.assign({},t);delete e.style,delete e.renderBuffer,delete e.updateWhileAnimating,delete e.updateWhileInteracting,super(e),this.declutter_=t.declutter?String(t.declutter):void 0,this.renderBuffer_=t.renderBuffer!==void 0?t.renderBuffer:100,this.style_=null,this.styleFunction_=void 0,this.setStyle(t.style),this.updateWhileAnimating_=t.updateWhileAnimating!==void 0?t.updateWhileAnimating:!1,this.updateWhileInteracting_=t.updateWhileInteracting!==void 0?t.updateWhileInteracting:!1}getDeclutter(){return this.declutter_}getFeatures(t){return super.getFeatures(t)}getRenderBuffer(){return this.renderBuffer_}getRenderOrder(){return this.get(yh.RENDER_ORDER)}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}getUpdateWhileAnimating(){return this.updateWhileAnimating_}getUpdateWhileInteracting(){return this.updateWhileInteracting_}renderDeclutter(t,e){const i=this.getDeclutter();i in t.declutter||(t.declutter[i]=new Pc(9)),this.getRenderer().renderDeclutter(t,e)}setRenderOrder(t){this.set(yh.RENDER_ORDER,t)}setStyle(t){this.style_=t===void 0?Xc:t;const e=Vg(t);this.styleFunction_=t===null?void 0:sg(e),this.changed()}}function Vg(s){if(s===void 0)return Xc;if(!s)return null;if(typeof s=="function"||s instanceof At)return s;if(!Array.isArray(s))return mh([s]);if(s.length===0)return[];const t=s.length,e=s[0];if(e instanceof At){const n=new Array(t);for(let r=0;r<t;++r){const o=s[r];if(!(o instanceof At))throw new Error("Expected a list of style instances");n[r]=o}return n}if("style"in e){const n=new Array(t);for(let r=0;r<t;++r){const o=s[r];if(!("style"in o))throw new Error("Expected a list of rules with a style property");n[r]=o}return Pg(n)}return mh(s)}class Kg extends Ya{constructor(t){super(),this.map_=t}dispatchRenderEvent(t,e){q()}calculateMatrices2D(t){const e=t.viewState,i=t.coordinateToPixelTransform,n=t.pixelToCoordinateTransform;di(i,t.size[0]/2,t.size[1]/2,1/e.resolution,-1/e.resolution,-e.rotation,-e.center[0],-e.center[1]),Ac(n,i)}forEachFeatureAtCoordinate(t,e,i,n,r,o,a,l){let h;const c=e.viewState;function u(P,F,k,O){return r.call(o,F,P?k:null,O)}const d=c.projection,f=ka(t.slice(),d),m=[[0,0]];if(d.canWrapX()&&n){const P=d.getExtent(),F=yt(P);m.push([-F,0],[F,0])}const p=e.layerStatesArray,x=p.length,T=[],_=[];for(let P=0;P<m.length;P++)for(let F=x-1;F>=0;--F){const k=p[F],O=k.layer;if(O.hasRenderer()&&rl(k,c)&&a.call(l,O)){const g=O.getRenderer(),A=O.getSource();if(g&&A){const y=A.getWrapX()?f:t,S=u.bind(null,k.managed);_[0]=y[0]+m[P][0],_[1]=y[1]+m[P][1],h=g.forEachFeatureAtCoordinate(_,e,i,S,T)}if(h)return h}}if(T.length===0)return;const v=1/T.length;return T.forEach((P,F)=>P.distanceSq+=F*v),T.sort((P,F)=>P.distanceSq-F.distanceSq),T.some(P=>h=P.callback(P.feature,P.layer,P.geometry)),h}hasFeatureAtCoordinate(t,e,i,n,r,o){return this.forEachFeatureAtCoordinate(t,e,i,n,Di,this,r,o)!==void 0}getMap(){return this.map_}renderFrame(t){q()}scheduleExpireIconCache(t){Ve.canExpireCache()&&t.postRenderFunctions.push(Wg)}}function Wg(s,t){Ve.expire()}class Jc extends De{constructor(t,e,i,n){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=n}}class jg extends Kg{constructor(t){super(t),this.fontChangeListenerKey_=at(ei,Dn.PROPERTYCHANGE,t.redrawText.bind(t)),this.element_=document.createElement("div");const e=this.element_.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex="0",this.element_.className=Hr+" ol-layers";const i=t.getViewport();i.insertBefore(this.element_,i.firstChild||null),this.children_=[],this.renderedVisible_=!0}dispatchRenderEvent(t,e){const i=this.getMap();if(i.hasListener(t)){const n=new Jc(t,void 0,e);i.dispatchEvent(n)}}disposeInternal(){_t(this.fontChangeListenerKey_),this.element_.remove(),super.disposeInternal()}renderFrame(t){if(!t){this.renderedVisible_&&(this.element_.style.display="none",this.renderedVisible_=!1);return}this.calculateMatrices2D(t),this.dispatchRenderEvent(Ee.PRECOMPOSE,t);const e=t.layerStatesArray.sort((a,l)=>a.zIndex-l.zIndex);e.some(a=>a.layer instanceof ml&&a.layer.getDeclutter())&&(t.declutter={});const n=t.viewState;this.children_.length=0;const r=[];let o=null;for(let a=0,l=e.length;a<l;++a){const h=e[a];t.layerIndex=a;const c=h.layer,u=c.getSourceState();if(!rl(h,n)||u!="ready"&&u!="undefined"){c.unrender();continue}const d=c.render(t,o);d&&(d!==o&&(this.children_.push(d),o=d),r.push(h))}this.declutter(t,r),Vf(this.element_,this.children_),this.dispatchRenderEvent(Ee.POSTCOMPOSE,t),this.renderedVisible_||(this.element_.style.display="",this.renderedVisible_=!0),this.scheduleExpireIconCache(t)}declutter(t,e){if(t.declutter){for(let i=e.length-1;i>=0;--i){const n=e[i],r=n.layer;r.getDeclutter()&&r.renderDeclutter(t,n)}e.forEach(i=>i.layer.renderDeferred(t))}}}class Si extends De{constructor(t,e){super(t),this.layer=e}}const Io={LAYERS:"layers"};class Wn extends uc{constructor(t){t=t||{};const e=Object.assign({},t);delete e.layers;let i=t.layers;super(e),this.on,this.once,this.un,this.layersListenerKeys_=[],this.listenerKeys_={},this.addChangeListener(Io.LAYERS,this.handleLayersChanged_),i?Array.isArray(i)?i=new Fe(i.slice(),{unique:!0}):lt(typeof i.getArray=="function","Expected `layers` to be an array or a `Collection`"):i=new Fe(void 0,{unique:!0}),this.setLayers(i)}handleLayerChange_(){this.changed()}handleLayersChanged_(){this.layersListenerKeys_.forEach(_t),this.layersListenerKeys_.length=0;const t=this.getLayers();this.layersListenerKeys_.push(at(t,Dt.ADD,this.handleLayersAdd_,this),at(t,Dt.REMOVE,this.handleLayersRemove_,this));for(const i in this.listenerKeys_)this.listenerKeys_[i].forEach(_t);Vn(this.listenerKeys_);const e=t.getArray();for(let i=0,n=e.length;i<n;i++){const r=e[i];this.registerLayerListeners_(r),this.dispatchEvent(new Si("addlayer",r))}this.changed()}registerLayerListeners_(t){const e=[at(t,Dn.PROPERTYCHANGE,this.handleLayerChange_,this),at(t,j.CHANGE,this.handleLayerChange_,this)];t instanceof Wn&&e.push(at(t,"addlayer",this.handleLayerGroupAdd_,this),at(t,"removelayer",this.handleLayerGroupRemove_,this)),this.listenerKeys_[J(t)]=e}handleLayerGroupAdd_(t){this.dispatchEvent(new Si("addlayer",t.layer))}handleLayerGroupRemove_(t){this.dispatchEvent(new Si("removelayer",t.layer))}handleLayersAdd_(t){const e=t.element;this.registerLayerListeners_(e),this.dispatchEvent(new Si("addlayer",e)),this.changed()}handleLayersRemove_(t){const e=t.element,i=J(e);this.listenerKeys_[i].forEach(_t),delete this.listenerKeys_[i],this.dispatchEvent(new Si("removelayer",e)),this.changed()}getLayers(){return this.get(Io.LAYERS)}setLayers(t){const e=this.getLayers();if(e){const i=e.getArray();for(let n=0,r=i.length;n<r;++n)this.dispatchEvent(new Si("removelayer",i[n]))}this.set(Io.LAYERS,t)}getLayersArray(t){return t=t!==void 0?t:[],this.getLayers().forEach(function(e){e.getLayersArray(t)}),t}getLayerStatesArray(t){const e=t!==void 0?t:[],i=e.length;this.getLayers().forEach(function(o){o.getLayerStatesArray(e)});const n=this.getLayerState();let r=n.zIndex;!t&&n.zIndex===void 0&&(r=0);for(let o=i,a=e.length;o<a;o++){const l=e[o];l.opacity*=n.opacity,l.visible=l.visible&&n.visible,l.maxResolution=Math.min(l.maxResolution,n.maxResolution),l.minResolution=Math.max(l.minResolution,n.minResolution),l.minZoom=Math.max(l.minZoom,n.minZoom),l.maxZoom=Math.min(l.maxZoom,n.maxZoom),n.extent!==void 0&&(l.extent!==void 0?l.extent=ce(l.extent,n.extent):l.extent=n.extent),l.zIndex===void 0&&(l.zIndex=r)}return e}getSourceState(){return"ready"}}class Rn extends De{constructor(t,e,i){super(t),this.map=e,this.frameState=i!==void 0?i:null}}class ii extends Rn{constructor(t,e,i,n,r,o){super(t,e,r),this.originalEvent=i,this.pixel_=null,this.coordinate_=null,this.dragging=n!==void 0?n:!1,this.activePointers=o}get pixel(){return this.pixel_||(this.pixel_=this.map.getEventPixel(this.originalEvent)),this.pixel_}set pixel(t){this.pixel_=t}get coordinate(){return this.coordinate_||(this.coordinate_=this.map.getCoordinateFromPixel(this.pixel)),this.coordinate_}set coordinate(t){this.coordinate_=t}preventDefault(){super.preventDefault(),"preventDefault"in this.originalEvent&&this.originalEvent.preventDefault()}stopPropagation(){super.stopPropagation(),"stopPropagation"in this.originalEvent&&this.originalEvent.stopPropagation()}}const ut={SINGLECLICK:"singleclick",CLICK:j.CLICK,DBLCLICK:j.DBLCLICK,POINTERDRAG:"pointerdrag",POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"},sa={POINTERMOVE:"pointermove",POINTERDOWN:"pointerdown",POINTERUP:"pointerup",POINTEROVER:"pointerover",POINTEROUT:"pointerout",POINTERENTER:"pointerenter",POINTERLEAVE:"pointerleave",POINTERCANCEL:"pointercancel"};class Zg extends Kr{constructor(t,e){super(t),this.map_=t,this.clickTimeoutId_,this.emulateClicks_=!1,this.dragging_=!1,this.dragListenerKeys_=[],this.moveTolerance_=e===void 0?1:e,this.down_=null;const i=this.map_.getViewport();this.activePointers_=[],this.trackedTouches_={},this.element_=i,this.pointerdownListenerKey_=at(i,sa.POINTERDOWN,this.handlePointerDown_,this),this.originalPointerMoveEvent_,this.relayedListenerKey_=at(i,sa.POINTERMOVE,this.relayMoveEvent_,this),this.boundHandleTouchMove_=this.handleTouchMove_.bind(this),this.element_.addEventListener(j.TOUCHMOVE,this.boundHandleTouchMove_,Gc?{passive:!1}:!1)}emulateClick_(t){let e=new ii(ut.CLICK,this.map_,t);this.dispatchEvent(e),this.clickTimeoutId_!==void 0?(clearTimeout(this.clickTimeoutId_),this.clickTimeoutId_=void 0,e=new ii(ut.DBLCLICK,this.map_,t),this.dispatchEvent(e)):this.clickTimeoutId_=setTimeout(()=>{this.clickTimeoutId_=void 0;const i=new ii(ut.SINGLECLICK,this.map_,t);this.dispatchEvent(i)},250)}updateActivePointers_(t){const e=t,i=e.pointerId;if(e.type==ut.POINTERUP||e.type==ut.POINTERCANCEL){delete this.trackedTouches_[i];for(const n in this.trackedTouches_)if(this.trackedTouches_[n].target!==e.target){delete this.trackedTouches_[n];break}}else(e.type==ut.POINTERDOWN||e.type==ut.POINTERMOVE)&&(this.trackedTouches_[i]=e);this.activePointers_=Object.values(this.trackedTouches_)}handlePointerUp_(t){this.updateActivePointers_(t);const e=new ii(ut.POINTERUP,this.map_,t,void 0,void 0,this.activePointers_);this.dispatchEvent(e),this.emulateClicks_&&!e.defaultPrevented&&!this.dragging_&&this.isMouseActionButton_(t)&&this.emulateClick_(this.down_),this.activePointers_.length===0&&(this.dragListenerKeys_.forEach(_t),this.dragListenerKeys_.length=0,this.dragging_=!1,this.down_=null)}isMouseActionButton_(t){return t.button===0}handlePointerDown_(t){this.emulateClicks_=this.activePointers_.length===0,this.updateActivePointers_(t);const e=new ii(ut.POINTERDOWN,this.map_,t,void 0,void 0,this.activePointers_);if(this.dispatchEvent(e),this.down_=new PointerEvent(t.type,t),Object.defineProperty(this.down_,"target",{writable:!1,value:t.target}),this.dragListenerKeys_.length===0){const i=this.map_.getOwnerDocument();this.dragListenerKeys_.push(at(i,ut.POINTERMOVE,this.handlePointerMove_,this),at(i,ut.POINTERUP,this.handlePointerUp_,this),at(this.element_,ut.POINTERCANCEL,this.handlePointerUp_,this)),this.element_.getRootNode&&this.element_.getRootNode()!==i&&this.dragListenerKeys_.push(at(this.element_.getRootNode(),ut.POINTERUP,this.handlePointerUp_,this))}}handlePointerMove_(t){if(this.isMoving_(t)){this.updateActivePointers_(t),this.dragging_=!0;const e=new ii(ut.POINTERDRAG,this.map_,t,this.dragging_,void 0,this.activePointers_);this.dispatchEvent(e)}}relayMoveEvent_(t){this.originalPointerMoveEvent_=t;const e=!!(this.down_&&this.isMoving_(t));this.dispatchEvent(new ii(ut.POINTERMOVE,this.map_,t,e))}handleTouchMove_(t){const e=this.originalPointerMoveEvent_;(!e||e.defaultPrevented)&&(typeof t.cancelable!="boolean"||t.cancelable===!0)&&t.preventDefault()}isMoving_(t){return this.dragging_||Math.abs(t.clientX-this.down_.clientX)>this.moveTolerance_||Math.abs(t.clientY-this.down_.clientY)>this.moveTolerance_}disposeInternal(){this.relayedListenerKey_&&(_t(this.relayedListenerKey_),this.relayedListenerKey_=null),this.element_.removeEventListener(j.TOUCHMOVE,this.boundHandleTouchMove_),this.pointerdownListenerKey_&&(_t(this.pointerdownListenerKey_),this.pointerdownListenerKey_=null),this.dragListenerKeys_.forEach(_t),this.dragListenerKeys_.length=0,this.element_=null,super.disposeInternal()}}const ni={POSTRENDER:"postrender",MOVESTART:"movestart",MOVEEND:"moveend",LOADSTART:"loadstart",LOADEND:"loadend"},Kt={LAYERGROUP:"layergroup",SIZE:"size",TARGET:"target",VIEW:"view"},br=1/0;class Qg{constructor(t,e){this.priorityFunction_=t,this.keyFunction_=e,this.elements_=[],this.priorities_=[],this.queuedElements_={}}clear(){this.elements_.length=0,this.priorities_.length=0,Vn(this.queuedElements_)}dequeue(){const t=this.elements_,e=this.priorities_,i=t[0];t.length==1?(t.length=0,e.length=0):(t[0]=t.pop(),e[0]=e.pop(),this.siftUp_(0));const n=this.keyFunction_(i);return delete this.queuedElements_[n],i}enqueue(t){lt(!(this.keyFunction_(t)in this.queuedElements_),"Tried to enqueue an `element` that was already added to the queue");const e=this.priorityFunction_(t);return e!=br?(this.elements_.push(t),this.priorities_.push(e),this.queuedElements_[this.keyFunction_(t)]=!0,this.siftDown_(0,this.elements_.length-1),!0):!1}getCount(){return this.elements_.length}getLeftChildIndex_(t){return t*2+1}getRightChildIndex_(t){return t*2+2}getParentIndex_(t){return t-1>>1}heapify_(){let t;for(t=(this.elements_.length>>1)-1;t>=0;t--)this.siftUp_(t)}isEmpty(){return this.elements_.length===0}isKeyQueued(t){return t in this.queuedElements_}isQueued(t){return this.isKeyQueued(this.keyFunction_(t))}siftUp_(t){const e=this.elements_,i=this.priorities_,n=e.length,r=e[t],o=i[t],a=t;for(;t<n>>1;){const l=this.getLeftChildIndex_(t),h=this.getRightChildIndex_(t),c=h<n&&i[h]<i[l]?h:l;e[t]=e[c],i[t]=i[c],t=c}e[t]=r,i[t]=o,this.siftDown_(a,t)}siftDown_(t,e){const i=this.elements_,n=this.priorities_,r=i[e],o=n[e];for(;e>t;){const a=this.getParentIndex_(e);if(n[a]>o)i[e]=i[a],n[e]=n[a],e=a;else break}i[e]=r,n[e]=o}reprioritize(){const t=this.priorityFunction_,e=this.elements_,i=this.priorities_;let n=0;const r=e.length;let o,a,l;for(a=0;a<r;++a)o=e[a],l=t(o),l==br?delete this.queuedElements_[this.keyFunction_(o)]:(i[n]=l,e[n++]=o);e.length=n,i.length=n,this.heapify_()}}const Y={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};class qg extends Qg{constructor(t,e){super(function(i){return t.apply(null,i)},function(i){return i[0].getKey()}),this.boundHandleTileChange_=this.handleTileChange.bind(this),this.tileChangeCallback_=e,this.tilesLoading_=0,this.tilesLoadingKeys_={}}enqueue(t){const e=super.enqueue(t);return e&&t[0].addEventListener(j.CHANGE,this.boundHandleTileChange_),e}getTilesLoading(){return this.tilesLoading_}handleTileChange(t){const e=t.target,i=e.getState();if(i===Y.LOADED||i===Y.ERROR||i===Y.EMPTY){i!==Y.ERROR&&e.removeEventListener(j.CHANGE,this.boundHandleTileChange_);const n=e.getKey();n in this.tilesLoadingKeys_&&(delete this.tilesLoadingKeys_[n],--this.tilesLoading_),this.tileChangeCallback_()}}loadMoreTiles(t,e){let i=0;for(;this.tilesLoading_<t&&i<e&&this.getCount()>0;){const n=this.dequeue()[0],r=n.getKey();n.getState()===Y.IDLE&&!(r in this.tilesLoadingKeys_)&&(this.tilesLoadingKeys_[r]=!0,++this.tilesLoading_,++i,n.load())}}}function Hg(s,t,e,i,n){if(!s||!(e in s.wantedTiles)||!s.wantedTiles[e][t.getKey()])return br;const r=s.viewState.center,o=i[0]-r[0],a=i[1]-r[1];return 65536*Math.log(n)+Math.sqrt(o*o+a*a)/n}class Al extends ke{constructor(t){super();const e=t.element;e&&!t.target&&!e.style.pointerEvents&&(e.style.pointerEvents="auto"),this.element=e||null,this.target_=null,this.map_=null,this.listenerKeys=[],t.render&&(this.render=t.render),t.target&&this.setTarget(t.target)}disposeInternal(){var t;(t=this.element)==null||t.remove(),super.disposeInternal()}getMap(){return this.map_}setMap(t){var e;this.map_&&((e=this.element)==null||e.remove());for(let i=0,n=this.listenerKeys.length;i<n;++i)_t(this.listenerKeys[i]);this.listenerKeys.length=0,this.map_=t,t&&((this.target_??t.getOverlayContainerStopEvent()).appendChild(this.element),this.render!==kn&&this.listenerKeys.push(at(t,ni.POSTRENDER,this.render,this)),t.render())}render(t){}setTarget(t){this.target_=typeof t=="string"?document.getElementById(t):t}}class Jg extends Al{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target}),this.ulElement_=document.createElement("ul"),this.collapsed_=t.collapsed!==void 0?t.collapsed:!0,this.userCollapsed_=this.collapsed_,this.overrideCollapsible_=t.collapsible!==void 0,this.collapsible_=t.collapsible!==void 0?t.collapsible:!0,this.collapsible_||(this.collapsed_=!1),this.attributions_=t.attributions;const e=t.className!==void 0?t.className:"ol-attribution",i=t.tipLabel!==void 0?t.tipLabel:"Attributions",n=t.expandClassName!==void 0?t.expandClassName:e+"-expand",r=t.collapseLabel!==void 0?t.collapseLabel:"",o=t.collapseClassName!==void 0?t.collapseClassName:e+"-collapse";typeof r=="string"?(this.collapseLabel_=document.createElement("span"),this.collapseLabel_.textContent=r,this.collapseLabel_.className=o):this.collapseLabel_=r;const a=t.label!==void 0?t.label:"i";typeof a=="string"?(this.label_=document.createElement("span"),this.label_.textContent=a,this.label_.className=n):this.label_=a;const l=this.collapsible_&&!this.collapsed_?this.collapseLabel_:this.label_;this.toggleButton_=document.createElement("button"),this.toggleButton_.setAttribute("type","button"),this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_)),this.toggleButton_.title=i,this.toggleButton_.appendChild(l),this.toggleButton_.addEventListener(j.CLICK,this.handleClick_.bind(this),!1);const h=e+" "+Hr+" "+dl+(this.collapsed_&&this.collapsible_?" "+ah:"")+(this.collapsible_?"":" ol-uncollapsible"),c=this.element;c.className=h,c.appendChild(this.toggleButton_),c.appendChild(this.ulElement_),this.renderedAttributions_=[],this.renderedVisible_=!0}collectSourceAttributions_(t){const e=this.getMap().getAllLayers(),i=new Set(e.flatMap(n=>n.getAttributions(t)));if(this.attributions_!==void 0&&(Array.isArray(this.attributions_)?this.attributions_.forEach(n=>i.add(n)):i.add(this.attributions_)),!this.overrideCollapsible_){const n=!e.some(r=>{var o;return((o=r.getSource())==null?void 0:o.getAttributionsCollapsible())===!1});this.setCollapsible(n)}return Array.from(i)}async updateElement_(t){if(!t){this.renderedVisible_&&(this.element.style.display="none",this.renderedVisible_=!1);return}const e=await Promise.all(this.collectSourceAttributions_(t).map(n=>Wd(()=>n))),i=e.length>0;if(this.renderedVisible_!=i&&(this.element.style.display=i?"":"none",this.renderedVisible_=i),!zi(e,this.renderedAttributions_)){Bc(this.ulElement_);for(let n=0,r=e.length;n<r;++n){const o=document.createElement("li");o.innerHTML=e[n],this.ulElement_.appendChild(o)}this.renderedAttributions_=e}}handleClick_(t){t.preventDefault(),this.handleToggle_(),this.userCollapsed_=this.collapsed_}handleToggle_(){this.element.classList.toggle(ah),this.collapsed_?oh(this.collapseLabel_,this.label_):oh(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_,this.toggleButton_.setAttribute("aria-expanded",String(!this.collapsed_))}getCollapsible(){return this.collapsible_}setCollapsible(t){this.collapsible_!==t&&(this.collapsible_=t,this.element.classList.toggle("ol-uncollapsible"),this.userCollapsed_&&this.handleToggle_())}setCollapsed(t){this.userCollapsed_=t,!(!this.collapsible_||this.collapsed_===t)&&this.handleToggle_()}getCollapsed(){return this.collapsed_}render(t){this.updateElement_(t.frameState)}}class $g extends Al{constructor(t){t=t||{},super({element:document.createElement("div"),render:t.render,target:t.target});const e=t.className!==void 0?t.className:"ol-rotate",i=t.label!==void 0?t.label:"",n=t.compassClassName!==void 0?t.compassClassName:"ol-compass";this.label_=null,typeof i=="string"?(this.label_=document.createElement("span"),this.label_.className=n,this.label_.textContent=i):(this.label_=i,this.label_.classList.add(n));const r=t.tipLabel?t.tipLabel:"Reset rotation",o=document.createElement("button");o.className=e+"-reset",o.setAttribute("type","button"),o.title=r,o.appendChild(this.label_),o.addEventListener(j.CLICK,this.handleClick_.bind(this),!1);const a=e+" "+Hr+" "+dl,l=this.element;l.className=a,l.appendChild(o),this.callResetNorth_=t.resetNorth?t.resetNorth:void 0,this.duration_=t.duration!==void 0?t.duration:250,this.autoHide_=t.autoHide!==void 0?t.autoHide:!0,this.rotation_=void 0,this.autoHide_&&this.element.classList.add(sr)}handleClick_(t){t.preventDefault(),this.callResetNorth_!==void 0?this.callResetNorth_():this.resetNorth_()}resetNorth_(){const e=this.getMap().getView();if(!e)return;const i=e.getRotation();i!==void 0&&(this.duration_>0&&i%(2*Math.PI)!==0?e.animate({rotation:0,duration:this.duration_,easing:Kn}):e.setRotation(0))}render(t){const e=t.frameState;if(!e)return;const i=e.viewState.rotation;if(i!=this.rotation_){const n="rotate("+i+"rad)";if(this.autoHide_){const r=this.element.classList.contains(sr);!r&&i===0?this.element.classList.add(sr):r&&i!==0&&this.element.classList.remove(sr)}this.label_.style.transform=n}this.rotation_=i}}class tm extends Al{constructor(t){t=t||{},super({element:document.createElement("div"),target:t.target});const e=t.className!==void 0?t.className:"ol-zoom",i=t.delta!==void 0?t.delta:1,n=t.zoomInClassName!==void 0?t.zoomInClassName:e+"-in",r=t.zoomOutClassName!==void 0?t.zoomOutClassName:e+"-out",o=t.zoomInLabel!==void 0?t.zoomInLabel:"+",a=t.zoomOutLabel!==void 0?t.zoomOutLabel:"",l=t.zoomInTipLabel!==void 0?t.zoomInTipLabel:"Zoom in",h=t.zoomOutTipLabel!==void 0?t.zoomOutTipLabel:"Zoom out",c=document.createElement("button");c.className=n,c.setAttribute("type","button"),c.title=l,c.appendChild(typeof o=="string"?document.createTextNode(o):o),c.addEventListener(j.CLICK,this.handleClick_.bind(this,i),!1);const u=document.createElement("button");u.className=r,u.setAttribute("type","button"),u.title=h,u.appendChild(typeof a=="string"?document.createTextNode(a):a),u.addEventListener(j.CLICK,this.handleClick_.bind(this,-i),!1);const d=e+" "+Hr+" "+dl,f=this.element;f.className=d,f.appendChild(c),f.appendChild(u),this.duration_=t.duration!==void 0?t.duration:250}handleClick_(t,e){e.preventDefault(),this.zoomByDelta_(t)}zoomByDelta_(t){const i=this.getMap().getView();if(!i)return;const n=i.getZoom();if(n!==void 0){const r=i.getConstrainedZoom(n+t);this.duration_>0?(i.getAnimating()&&i.cancelAnimations(),i.animate({zoom:r,duration:this.duration_,easing:Kn})):i.setZoom(r)}}}function em(s){s=s||{};const t=new Fe;return(s.zoom!==void 0?s.zoom:!0)&&t.push(new tm(s.zoomOptions)),(s.rotate!==void 0?s.rotate:!0)&&t.push(new $g(s.rotateOptions)),(s.attribution!==void 0?s.attribution:!0)&&t.push(new Jg(s.attributionOptions)),t}const ra={ACTIVE:"active"};class jn extends ke{constructor(t){super(),this.on,this.once,this.un,t&&t.handleEvent&&(this.handleEvent=t.handleEvent),this.map_=null,this.setActive(!0)}getActive(){return this.get(ra.ACTIVE)}getMap(){return this.map_}handleEvent(t){return!0}setActive(t){this.set(ra.ACTIVE,t)}setMap(t){this.map_=t}}function im(s,t,e){const i=s.getCenterInternal();if(i){const n=[i[0]+t[0],i[1]+t[1]];s.animateInternal({duration:e!==void 0?e:250,easing:ef,center:s.getConstrainedCenter(n)})}}function _l(s,t,e,i){const n=s.getZoom();if(n===void 0)return;const r=s.getConstrainedZoom(n+t),o=s.getResolutionForZoom(r);s.getAnimating()&&s.cancelAnimations(),s.animate({resolution:o,anchor:e,duration:i!==void 0?i:250,easing:Kn})}class nm extends jn{constructor(t){super(),t=t||{},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:250}handleEvent(t){let e=!1;if(t.type==ut.DBLCLICK){const i=t.originalEvent,n=t.map,r=t.coordinate,o=i.shiftKey?-this.delta_:this.delta_,a=n.getView();_l(a,o,r,this.duration_),i.preventDefault(),e=!0}return!e}}class Zn extends jn{constructor(t){t=t||{},super(t),t.handleDownEvent&&(this.handleDownEvent=t.handleDownEvent),t.handleDragEvent&&(this.handleDragEvent=t.handleDragEvent),t.handleMoveEvent&&(this.handleMoveEvent=t.handleMoveEvent),t.handleUpEvent&&(this.handleUpEvent=t.handleUpEvent),t.stopDown&&(this.stopDown=t.stopDown),this.handlingDownUpSequence=!1,this.targetPointers=[]}getPointerCount(){return this.targetPointers.length}handleDownEvent(t){return!1}handleDragEvent(t){}handleEvent(t){if(!t.originalEvent)return!0;let e=!1;if(this.updateTrackedPointers_(t),this.handlingDownUpSequence){if(t.type==ut.POINTERDRAG)this.handleDragEvent(t),t.originalEvent.preventDefault();else if(t.type==ut.POINTERUP){const i=this.handleUpEvent(t);this.handlingDownUpSequence=i&&this.targetPointers.length>0}}else if(t.type==ut.POINTERDOWN){const i=this.handleDownEvent(t);this.handlingDownUpSequence=i,e=this.stopDown(i)}else t.type==ut.POINTERMOVE&&this.handleMoveEvent(t);return!e}handleMoveEvent(t){}handleUpEvent(t){return!1}stopDown(t){return t}updateTrackedPointers_(t){t.activePointers&&(this.targetPointers=t.activePointers)}}function pl(s){const t=s.length;let e=0,i=0;for(let n=0;n<t;n++)e+=s[n].clientX,i+=s[n].clientY;return{clientX:e/t,clientY:i/t}}function oa(s){const t=arguments;return function(e){let i=!0;for(let n=0,r=t.length;n<r&&(i=i&&t[n](e),!!i);++n);return i}}const sm=function(s){const t=s.originalEvent;return t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},rm=function(s){const t=s.map.getTargetElement(),e=t.getRootNode(),i=s.map.getOwnerDocument().activeElement;return e instanceof ShadowRoot?e.host.contains(i):t.contains(i)},$c=function(s){const t=s.map.getTargetElement(),e=t.getRootNode();return(e instanceof ShadowRoot?e.host:t).hasAttribute("tabindex")?rm(s):!0},aa=Di,tu=function(s){const t=s.originalEvent;return t.button==0&&!(Yf&&Oc&&t.ctrlKey)},la=Xn,om=function(s){return s.type==ut.SINGLECLICK},yl=function(s){const t=s.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&!t.shiftKey},am=function(s){const t=s.originalEvent;return Oc?t.metaKey:t.ctrlKey},xl=function(s){const t=s.originalEvent;return!t.altKey&&!(t.metaKey||t.ctrlKey)&&t.shiftKey},eu=function(s){const t=s.originalEvent,e=t.target.tagName;return e!=="INPUT"&&e!=="SELECT"&&e!=="TEXTAREA"&&!t.target.isContentEditable},vo=function(s){const t=s.originalEvent;return lt(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.pointerType=="mouse"},lm=function(s){const t=s.originalEvent;return lt(t!==void 0,"mapBrowserEvent must originate from a pointer event"),t.isPrimary&&t.button===0};class hm extends Zn{constructor(t){super({stopDown:Xn}),t=t||{},this.kinetic_=t.kinetic,this.lastCentroid=null,this.lastPointersCount_,this.panning_=!1;const e=t.condition?t.condition:oa(yl,lm);this.condition_=t.onFocusOnly?oa($c,e):e,this.noKinetic_=!1}handleDragEvent(t){const e=t.map;this.panning_||(this.panning_=!0,e.getView().beginInteraction());const i=this.targetPointers,n=e.getEventPixel(pl(i));if(i.length==this.lastPointersCount_){if(this.kinetic_&&this.kinetic_.update(n[0],n[1]),this.lastCentroid){const r=[this.lastCentroid[0]-n[0],n[1]-this.lastCentroid[1]],a=t.map.getView();ec(r,a.getResolution()),Na(r,a.getRotation()),a.adjustCenterInternal(r)}}else this.kinetic_&&this.kinetic_.begin();this.lastCentroid=n,this.lastPointersCount_=i.length,t.originalEvent.preventDefault()}handleUpEvent(t){const e=t.map,i=e.getView();if(this.targetPointers.length===0){if(!this.noKinetic_&&this.kinetic_&&this.kinetic_.end()){const n=this.kinetic_.getDistance(),r=this.kinetic_.getAngle(),o=i.getCenterInternal(),a=e.getPixelFromCoordinateInternal(o),l=e.getCoordinateFromPixelInternal([a[0]-n*Math.cos(r),a[1]-n*Math.sin(r)]);i.animateInternal({center:i.getConstrainedCenter(l),duration:500,easing:Kn})}return this.panning_&&(this.panning_=!1,i.endInteraction()),!1}return this.kinetic_&&this.kinetic_.begin(),this.lastCentroid=null,!0}handleDownEvent(t){if(this.targetPointers.length>0&&this.condition_(t)){const i=t.map.getView();return this.lastCentroid=null,i.getAnimating()&&i.cancelAnimations(),this.kinetic_&&this.kinetic_.begin(),this.noKinetic_=this.targetPointers.length>1,!0}return!1}}class cm extends Zn{constructor(t){t=t||{},super({stopDown:Xn}),this.condition_=t.condition?t.condition:sm,this.lastAngle_=void 0,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){if(!vo(t))return;const e=t.map,i=e.getView();if(i.getConstraints().rotation===Wa)return;const n=e.getSize(),r=t.pixel,o=Math.atan2(n[1]/2-r[1],r[0]-n[0]/2);if(this.lastAngle_!==void 0){const a=o-this.lastAngle_;i.adjustRotationInternal(-a)}this.lastAngle_=o}handleUpEvent(t){return vo(t)?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){return vo(t)&&tu(t)&&this.condition_(t)?(t.map.getView().beginInteraction(),this.lastAngle_=void 0,!0):!1}}class um extends Ya{constructor(t){super(),this.geometry_=null,this.element_=document.createElement("div"),this.element_.style.position="absolute",this.element_.style.pointerEvents="auto",this.element_.className="ol-box "+t,this.map_=null,this.startPixel_=null,this.endPixel_=null}disposeInternal(){this.setMap(null)}render_(){const t=this.startPixel_,e=this.endPixel_,i="px",n=this.element_.style;n.left=Math.min(t[0],e[0])+i,n.top=Math.min(t[1],e[1])+i,n.width=Math.abs(e[0]-t[0])+i,n.height=Math.abs(e[1]-t[1])+i}setMap(t){if(this.map_){this.map_.getOverlayContainer().removeChild(this.element_);const e=this.element_.style;e.left="inherit",e.top="inherit",e.width="inherit",e.height="inherit"}this.map_=t,this.map_&&this.map_.getOverlayContainer().appendChild(this.element_)}setPixels(t,e){this.startPixel_=t,this.endPixel_=e,this.createOrUpdateGeometry(),this.render_()}createOrUpdateGeometry(){if(!this.map_)return;const t=this.startPixel_,e=this.endPixel_,n=[t,[t[0],e[1]],e,[e[0],t[1]]].map(this.map_.getCoordinateFromPixelInternal,this.map_);n[4]=n[0].slice(),this.geometry_?this.geometry_.setCoordinates([n]):this.geometry_=new Oe([n])}getGeometry(){return this.geometry_}}const pn={BOXSTART:"boxstart",BOXDRAG:"boxdrag",BOXEND:"boxend",BOXCANCEL:"boxcancel"};class is extends De{constructor(t,e,i){super(t),this.coordinate=e,this.mapBrowserEvent=i}}class dm extends Zn{constructor(t){super(),this.on,this.once,this.un,t=t??{},this.box_=new um(t.className||"ol-dragbox"),this.minArea_=t.minArea??64,t.onBoxEnd&&(this.onBoxEnd=t.onBoxEnd),this.startPixel_=null,this.condition_=t.condition??tu,this.boxEndCondition_=t.boxEndCondition??this.defaultBoxEndCondition}defaultBoxEndCondition(t,e,i){const n=i[0]-e[0],r=i[1]-e[1];return n*n+r*r>=this.minArea_}getGeometry(){return this.box_.getGeometry()}handleDragEvent(t){this.startPixel_&&(this.box_.setPixels(this.startPixel_,t.pixel),this.dispatchEvent(new is(pn.BOXDRAG,t.coordinate,t)))}handleUpEvent(t){if(!this.startPixel_)return!1;const e=this.boxEndCondition_(t,this.startPixel_,t.pixel);return e&&this.onBoxEnd(t),this.dispatchEvent(new is(e?pn.BOXEND:pn.BOXCANCEL,t.coordinate,t)),this.box_.setMap(null),this.startPixel_=null,!1}handleDownEvent(t){return this.condition_(t)?(this.startPixel_=t.pixel,this.box_.setMap(t.map),this.box_.setPixels(this.startPixel_,this.startPixel_),this.dispatchEvent(new is(pn.BOXSTART,t.coordinate,t)),!0):!1}onBoxEnd(t){}setActive(t){t||(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new is(pn.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setActive(t)}setMap(t){this.getMap()&&(this.box_.setMap(null),this.startPixel_&&(this.dispatchEvent(new is(pn.BOXCANCEL,this.startPixel_,null)),this.startPixel_=null)),super.setMap(t)}}class fm extends dm{constructor(t){t=t||{};const e=t.condition?t.condition:xl;super({condition:e,className:t.className||"ol-dragzoom",minArea:t.minArea}),this.duration_=t.duration!==void 0?t.duration:200,this.out_=t.out!==void 0?t.out:!1}onBoxEnd(t){const i=this.getMap().getView();let n=this.getGeometry();if(this.out_){const r=i.rotatedExtentForGeometry(n),o=i.getResolutionForExtentInternal(r),a=i.getResolution()/o;n=n.clone(),n.scale(a*a)}i.fitInternal(n,{duration:this.duration_,easing:Kn})}}const ji={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",DOWN:"ArrowDown"};class gm extends jn{constructor(t){super(),t=t||{},this.defaultCondition_=function(e){return yl(e)&&eu(e)},this.condition_=t.condition!==void 0?t.condition:this.defaultCondition_,this.duration_=t.duration!==void 0?t.duration:100,this.pixelDelta_=t.pixelDelta!==void 0?t.pixelDelta:128}handleEvent(t){let e=!1;if(t.type==j.KEYDOWN){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==ji.DOWN||n==ji.LEFT||n==ji.RIGHT||n==ji.UP)){const o=t.map.getView(),a=o.getResolution()*this.pixelDelta_;let l=0,h=0;n==ji.DOWN?h=-a:n==ji.LEFT?l=-a:n==ji.RIGHT?l=a:h=a;const c=[l,h];Na(c,o.getRotation()),im(o,c,this.duration_),i.preventDefault(),e=!0}}return!e}}class mm extends jn{constructor(t){super(),t=t||{},this.condition_=t.condition?t.condition:function(e){return!am(e)&&eu(e)},this.delta_=t.delta?t.delta:1,this.duration_=t.duration!==void 0?t.duration:100}handleEvent(t){let e=!1;if(t.type==j.KEYDOWN||t.type==j.KEYPRESS){const i=t.originalEvent,n=i.key;if(this.condition_(t)&&(n==="+"||n==="-")){const r=t.map,o=n==="+"?this.delta_:-this.delta_,a=r.getView();_l(a,o,void 0,this.duration_),i.preventDefault(),e=!0}}return!e}}class Am{constructor(t,e,i){this.decay_=t,this.minVelocity_=e,this.delay_=i,this.points_=[],this.angle_=0,this.initialVelocity_=0}begin(){this.points_.length=0,this.angle_=0,this.initialVelocity_=0}update(t,e){this.points_.push(t,e,Date.now())}end(){if(this.points_.length<6)return!1;const t=Date.now()-this.delay_,e=this.points_.length-3;if(this.points_[e+2]<t)return!1;let i=e-3;for(;i>0&&this.points_[i+2]>t;)i-=3;const n=this.points_[e+2]-this.points_[i+2];if(n<1e3/60)return!1;const r=this.points_[e]-this.points_[i],o=this.points_[e+1]-this.points_[i+1];return this.angle_=Math.atan2(o,r),this.initialVelocity_=Math.sqrt(r*r+o*o)/n,this.initialVelocity_>this.minVelocity_}getDistance(){return(this.minVelocity_-this.initialVelocity_)/this.decay_}getAngle(){return this.angle_}}class _m extends jn{constructor(t){t=t||{},super(t),this.totalDelta_=0,this.lastDelta_=0,this.maxDelta_=t.maxDelta!==void 0?t.maxDelta:1,this.duration_=t.duration!==void 0?t.duration:250,this.timeout_=t.timeout!==void 0?t.timeout:80,this.useAnchor_=t.useAnchor!==void 0?t.useAnchor:!0,this.constrainResolution_=t.constrainResolution!==void 0?t.constrainResolution:!1;const e=t.condition?t.condition:aa;this.condition_=t.onFocusOnly?oa($c,e):e,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_,this.mode_=void 0,this.trackpadEventGap_=400,this.trackpadTimeoutId_,this.deltaPerZoom_=300}endInteraction_(){this.trackpadTimeoutId_=void 0;const t=this.getMap();if(!t)return;t.getView().endInteraction(void 0,this.lastDelta_?this.lastDelta_>0?1:-1:0,this.lastAnchor_)}handleEvent(t){if(!this.condition_(t)||t.type!==j.WHEEL)return!0;const i=t.map,n=t.originalEvent;n.preventDefault(),this.useAnchor_&&(this.lastAnchor_=t.coordinate);let r;if(t.type==j.WHEEL&&(r=n.deltaY,Bf&&n.deltaMode===WheelEvent.DOM_DELTA_PIXEL&&(r/=Nc),n.deltaMode===WheelEvent.DOM_DELTA_LINE&&(r*=40)),r===0)return!1;this.lastDelta_=r;const o=Date.now();this.startTime_===void 0&&(this.startTime_=o),(!this.mode_||o-this.startTime_>this.trackpadEventGap_)&&(this.mode_=Math.abs(r)<4?"trackpad":"wheel");const a=i.getView();if(this.mode_==="trackpad"&&!(a.getConstrainResolution()||this.constrainResolution_))return this.trackpadTimeoutId_?clearTimeout(this.trackpadTimeoutId_):(a.getAnimating()&&a.cancelAnimations(),a.beginInteraction()),this.trackpadTimeoutId_=setTimeout(this.endInteraction_.bind(this),this.timeout_),a.adjustZoom(-r/this.deltaPerZoom_,this.lastAnchor_),this.startTime_=o,!1;this.totalDelta_+=r;const l=Math.max(this.timeout_-(o-this.startTime_),0);return clearTimeout(this.timeoutId_),this.timeoutId_=setTimeout(this.handleWheelZoom_.bind(this,i),l),!1}handleWheelZoom_(t){const e=t.getView();e.getAnimating()&&e.cancelAnimations();let i=-wt(this.totalDelta_,-this.maxDelta_*this.deltaPerZoom_,this.maxDelta_*this.deltaPerZoom_)/this.deltaPerZoom_;(e.getConstrainResolution()||this.constrainResolution_)&&(i=i?i>0?1:-1:0),_l(e,i,this.lastAnchor_,this.duration_),this.mode_=void 0,this.totalDelta_=0,this.lastAnchor_=null,this.startTime_=void 0,this.timeoutId_=void 0}setMouseAnchor(t){this.useAnchor_=t,t||(this.lastAnchor_=null)}}class pm extends Zn{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Xn),super(e),this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.threshold_=t.threshold!==void 0?t.threshold:.3,this.duration_=t.duration!==void 0?t.duration:250}handleDragEvent(t){let e=0;const i=this.targetPointers[0],n=this.targetPointers[1],r=Math.atan2(n.clientY-i.clientY,n.clientX-i.clientX);if(this.lastAngle_!==void 0){const l=r-this.lastAngle_;this.rotationDelta_+=l,!this.rotating_&&Math.abs(this.rotationDelta_)>this.threshold_&&(this.rotating_=!0),e=l}this.lastAngle_=r;const o=t.map,a=o.getView();a.getConstraints().rotation!==Wa&&(this.anchor_=o.getCoordinateFromPixelInternal(o.getEventPixel(pl(this.targetPointers))),this.rotating_&&(o.render(),a.adjustRotationInternal(e,this.anchor_)))}handleUpEvent(t){return this.targetPointers.length<2?(t.map.getView().endInteraction(this.duration_),!1):!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastAngle_=void 0,this.rotating_=!1,this.rotationDelta_=0,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}class ym extends Zn{constructor(t){t=t||{};const e=t;e.stopDown||(e.stopDown=Xn),super(e),this.anchor_=null,this.duration_=t.duration!==void 0?t.duration:400,this.lastDistance_=void 0,this.lastScaleDelta_=1}handleDragEvent(t){let e=1;const i=this.targetPointers[0],n=this.targetPointers[1],r=i.clientX-n.clientX,o=i.clientY-n.clientY,a=Math.sqrt(r*r+o*o);this.lastDistance_!==void 0&&(e=this.lastDistance_/a),this.lastDistance_=a;const l=t.map,h=l.getView();e!=1&&(this.lastScaleDelta_=e),this.anchor_=l.getCoordinateFromPixelInternal(l.getEventPixel(pl(this.targetPointers))),l.render(),h.adjustResolutionInternal(e,this.anchor_)}handleUpEvent(t){if(this.targetPointers.length<2){const i=t.map.getView(),n=this.lastScaleDelta_>1?1:-1;return i.endInteraction(this.duration_,n),!1}return!0}handleDownEvent(t){if(this.targetPointers.length>=2){const e=t.map;return this.anchor_=null,this.lastDistance_=void 0,this.lastScaleDelta_=1,this.handlingDownUpSequence||e.getView().beginInteraction(),!0}return!1}}function xm(s){s=s||{};const t=new Fe,e=new Am(-.005,.05,100);return(s.altShiftDragRotate!==void 0?s.altShiftDragRotate:!0)&&t.push(new cm),(s.doubleClickZoom!==void 0?s.doubleClickZoom:!0)&&t.push(new nm({delta:s.zoomDelta,duration:s.zoomDuration})),(s.dragPan!==void 0?s.dragPan:!0)&&t.push(new hm({onFocusOnly:s.onFocusOnly,kinetic:e})),(s.pinchRotate!==void 0?s.pinchRotate:!0)&&t.push(new pm),(s.pinchZoom!==void 0?s.pinchZoom:!0)&&t.push(new ym({duration:s.zoomDuration})),(s.keyboard!==void 0?s.keyboard:!0)&&(t.push(new gm),t.push(new mm({delta:s.zoomDelta,duration:s.zoomDuration}))),(s.mouseWheelZoom!==void 0?s.mouseWheelZoom:!0)&&t.push(new _m({onFocusOnly:s.onFocusOnly,duration:s.zoomDuration})),(s.shiftDragZoom!==void 0?s.shiftDragZoom:!0)&&t.push(new fm({duration:s.zoomDuration})),t}function iu(s){if(s instanceof Qr){s.setMapInternal(null);return}s instanceof Wn&&s.getLayers().forEach(iu)}function nu(s,t){if(s instanceof Qr){s.setMapInternal(t);return}if(s instanceof Wn){const e=s.getLayers().getArray();for(let i=0,n=e.length;i<n;++i)nu(e[i],t)}}let Em=class extends ke{constructor(t){super(),t=t||{},this.on,this.once,this.un;const e=Cm(t);this.renderComplete_=!1,this.loaded_=!0,this.boundHandleBrowserEvent_=this.handleBrowserEvent.bind(this),this.maxTilesLoading_=t.maxTilesLoading!==void 0?t.maxTilesLoading:16,this.pixelRatio_=t.pixelRatio!==void 0?t.pixelRatio:Nc,this.postRenderTimeoutHandle_,this.animationDelayKey_,this.animationDelay_=this.animationDelay_.bind(this),this.coordinateToPixelTransform_=we(),this.pixelToCoordinateTransform_=we(),this.frameIndex_=0,this.frameState_=null,this.previousExtent_=null,this.viewPropertyListenerKey_=null,this.viewChangeListenerKey_=null,this.layerGroupPropertyListenerKeys_=null,this.viewport_=document.createElement("div"),this.viewport_.className="ol-viewport"+("ontouchstart"in window?" ol-touch":""),this.viewport_.style.position="relative",this.viewport_.style.overflow="hidden",this.viewport_.style.width="100%",this.viewport_.style.height="100%",this.overlayContainer_=document.createElement("div"),this.overlayContainer_.style.position="absolute",this.overlayContainer_.style.zIndex="0",this.overlayContainer_.style.width="100%",this.overlayContainer_.style.height="100%",this.overlayContainer_.style.pointerEvents="none",this.overlayContainer_.className="ol-overlaycontainer",this.viewport_.appendChild(this.overlayContainer_),this.overlayContainerStopEvent_=document.createElement("div"),this.overlayContainerStopEvent_.style.position="absolute",this.overlayContainerStopEvent_.style.zIndex="0",this.overlayContainerStopEvent_.style.width="100%",this.overlayContainerStopEvent_.style.height="100%",this.overlayContainerStopEvent_.style.pointerEvents="none",this.overlayContainerStopEvent_.className="ol-overlaycontainer-stopevent",this.viewport_.appendChild(this.overlayContainerStopEvent_),this.mapBrowserEventHandler_=null,this.moveTolerance_=t.moveTolerance,this.keyboardEventTarget_=e.keyboardEventTarget,this.targetChangeHandlerKeys_=null,this.targetElement_=null,this.resizeObserver_=new ResizeObserver(()=>this.updateSize()),this.controls=e.controls||em(),this.interactions=e.interactions||xm({onFocusOnly:!0}),this.overlays_=e.overlays,this.overlayIdIndex_={},this.renderer_=null,this.postRenderFunctions_=[],this.tileQueue_=new qg(this.getTilePriority.bind(this),this.handleTileChange_.bind(this)),this.addChangeListener(Kt.LAYERGROUP,this.handleLayerGroupChanged_),this.addChangeListener(Kt.VIEW,this.handleViewChanged_),this.addChangeListener(Kt.SIZE,this.handleSizeChanged_),this.addChangeListener(Kt.TARGET,this.handleTargetChanged_),this.setProperties(e.values);const i=this;t.view&&!(t.view instanceof Xe)&&t.view.then(function(n){i.setView(new Xe(n))}),this.controls.addEventListener(Dt.ADD,n=>{n.element.setMap(this)}),this.controls.addEventListener(Dt.REMOVE,n=>{n.element.setMap(null)}),this.interactions.addEventListener(Dt.ADD,n=>{n.element.setMap(this)}),this.interactions.addEventListener(Dt.REMOVE,n=>{n.element.setMap(null)}),this.overlays_.addEventListener(Dt.ADD,n=>{this.addOverlayInternal_(n.element)}),this.overlays_.addEventListener(Dt.REMOVE,n=>{const r=n.element.getId();r!==void 0&&delete this.overlayIdIndex_[r.toString()],n.element.setMap(null)}),this.controls.forEach(n=>{n.setMap(this)}),this.interactions.forEach(n=>{n.setMap(this)}),this.overlays_.forEach(this.addOverlayInternal_.bind(this))}addControl(t){this.getControls().push(t)}addInteraction(t){this.getInteractions().push(t)}addLayer(t){this.getLayerGroup().getLayers().push(t)}handleLayerAdd_(t){nu(t.layer,this)}addOverlay(t){this.getOverlays().push(t)}addOverlayInternal_(t){const e=t.getId();e!==void 0&&(this.overlayIdIndex_[e.toString()]=t),t.setMap(this)}disposeInternal(){this.controls.clear(),this.interactions.clear(),this.overlays_.clear(),this.resizeObserver_.disconnect(),this.setTarget(null),super.disposeInternal()}forEachFeatureAtPixel(t,e,i){if(!this.frameState_||!this.renderer_)return;const n=this.getCoordinateFromPixelInternal(t);i=i!==void 0?i:{};const r=i.hitTolerance!==void 0?i.hitTolerance:0,o=i.layerFilter!==void 0?i.layerFilter:Di,a=i.checkWrapped!==!1;return this.renderer_.forEachFeatureAtCoordinate(n,this.frameState_,r,a,e,null,o,null)}getFeaturesAtPixel(t,e){const i=[];return this.forEachFeatureAtPixel(t,function(n){i.push(n)},e),i}getAllLayers(){const t=[];function e(i){i.forEach(function(n){n instanceof Wn?e(n.getLayers()):t.push(n)})}return e(this.getLayers()),t}hasFeatureAtPixel(t,e){if(!this.frameState_||!this.renderer_)return!1;const i=this.getCoordinateFromPixelInternal(t);e=e!==void 0?e:{};const n=e.layerFilter!==void 0?e.layerFilter:Di,r=e.hitTolerance!==void 0?e.hitTolerance:0,o=e.checkWrapped!==!1;return this.renderer_.hasFeatureAtCoordinate(i,this.frameState_,r,o,n,null)}getEventCoordinate(t){return this.getCoordinateFromPixel(this.getEventPixel(t))}getEventCoordinateInternal(t){return this.getCoordinateFromPixelInternal(this.getEventPixel(t))}getEventPixel(t){const i=this.viewport_.getBoundingClientRect(),n=this.getSize(),r=i.width/n[0],o=i.height/n[1],a="changedTouches"in t?t.changedTouches[0]:t;return[(a.clientX-i.left)/r,(a.clientY-i.top)/o]}getTarget(){return this.get(Kt.TARGET)}getTargetElement(){return this.targetElement_}getCoordinateFromPixel(t){return Wo(this.getCoordinateFromPixelInternal(t),this.getView().getProjection())}getCoordinateFromPixelInternal(t){const e=this.frameState_;return e?Nt(e.pixelToCoordinateTransform,t.slice()):null}getControls(){return this.controls}getOverlays(){return this.overlays_}getOverlayById(t){const e=this.overlayIdIndex_[t.toString()];return e!==void 0?e:null}getInteractions(){return this.interactions}getLayerGroup(){return this.get(Kt.LAYERGROUP)}setLayers(t){const e=this.getLayerGroup();if(t instanceof Fe){e.setLayers(t);return}const i=e.getLayers();i.clear(),i.extend(t)}getLayers(){return this.getLayerGroup().getLayers()}getLoadingOrNotReady(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const n=t[e];if(!n.visible)continue;const r=n.layer.getRenderer();if(r&&!r.ready)return!0;const o=n.layer.getSource();if(o&&o.loading)return!0}return!1}getPixelFromCoordinate(t){const e=Le(t,this.getView().getProjection());return this.getPixelFromCoordinateInternal(e)}getPixelFromCoordinateInternal(t){const e=this.frameState_;return e?Nt(e.coordinateToPixelTransform,t.slice(0,2)):null}getRenderer(){return this.renderer_}getSize(){return this.get(Kt.SIZE)}getView(){return this.get(Kt.VIEW)}getViewport(){return this.viewport_}getOverlayContainer(){return this.overlayContainer_}getOverlayContainerStopEvent(){return this.overlayContainerStopEvent_}getOwnerDocument(){const t=this.getTargetElement();return t?t.ownerDocument:document}getTilePriority(t,e,i,n){return Hg(this.frameState_,t,e,i,n)}handleBrowserEvent(t,e){e=e||t.type;const i=new ii(e,this,t);this.handleMapBrowserEvent(i)}handleMapBrowserEvent(t){if(!this.frameState_)return;const e=t.originalEvent,i=e.type;if(i===sa.POINTERDOWN||i===j.WHEEL||i===j.KEYDOWN){const n=this.getOwnerDocument(),r=this.viewport_.getRootNode?this.viewport_.getRootNode():n,o=e.target,a=r instanceof ShadowRoot?r.host===o?r.host.ownerDocument:r:r===n?n.documentElement:r;if(this.overlayContainerStopEvent_.contains(o)||!a.contains(o))return}if(t.frameState=this.frameState_,this.dispatchEvent(t)!==!1){const n=this.getInteractions().getArray().slice();for(let r=n.length-1;r>=0;r--){const o=n[r];if(o.getMap()!==this||!o.getActive()||!this.getTargetElement())continue;if(!o.handleEvent(t)||t.propagationStopped)break}}}handlePostRender(){const t=this.frameState_,e=this.tileQueue_;if(!e.isEmpty()){let n=this.maxTilesLoading_,r=n;if(t){const o=t.viewHints;if(o[St.ANIMATING]||o[St.INTERACTING]){const a=Date.now()-t.time>8;n=a?0:8,r=a?0:2}}e.getTilesLoading()<n&&(e.reprioritize(),e.loadMoreTiles(n,r))}t&&this.renderer_&&!t.animate&&(this.renderComplete_?(this.hasListener(Ee.RENDERCOMPLETE)&&this.renderer_.dispatchRenderEvent(Ee.RENDERCOMPLETE,t),this.loaded_===!1&&(this.loaded_=!0,this.dispatchEvent(new Rn(ni.LOADEND,this,t)))):this.loaded_===!0&&(this.loaded_=!1,this.dispatchEvent(new Rn(ni.LOADSTART,this,t))));const i=this.postRenderFunctions_;for(let n=0,r=i.length;n<r;++n)i[n](this,t);i.length=0}handleSizeChanged_(){this.getView()&&!this.getView().getAnimating()&&this.getView().resolveConstraints(0),this.render()}handleTargetChanged_(){if(this.mapBrowserEventHandler_){for(let i=0,n=this.targetChangeHandlerKeys_.length;i<n;++i)_t(this.targetChangeHandlerKeys_[i]);this.targetChangeHandlerKeys_=null,this.viewport_.removeEventListener(j.CONTEXTMENU,this.boundHandleBrowserEvent_),this.viewport_.removeEventListener(j.WHEEL,this.boundHandleBrowserEvent_),this.mapBrowserEventHandler_.dispose(),this.mapBrowserEventHandler_=null,this.viewport_.remove()}if(this.targetElement_){this.resizeObserver_.unobserve(this.targetElement_);const i=this.targetElement_.getRootNode();i instanceof ShadowRoot&&this.resizeObserver_.unobserve(i.host),this.setSize(void 0)}const t=this.getTarget(),e=typeof t=="string"?document.getElementById(t):t;if(this.targetElement_=e,!e)this.renderer_&&(clearTimeout(this.postRenderTimeoutHandle_),this.postRenderTimeoutHandle_=void 0,this.postRenderFunctions_.length=0,this.renderer_.dispose(),this.renderer_=null),this.animationDelayKey_&&(cancelAnimationFrame(this.animationDelayKey_),this.animationDelayKey_=void 0);else{e.appendChild(this.viewport_),this.renderer_||(this.renderer_=new jg(this)),this.mapBrowserEventHandler_=new Zg(this,this.moveTolerance_);for(const r in ut)this.mapBrowserEventHandler_.addEventListener(ut[r],this.handleMapBrowserEvent.bind(this));this.viewport_.addEventListener(j.CONTEXTMENU,this.boundHandleBrowserEvent_,!1),this.viewport_.addEventListener(j.WHEEL,this.boundHandleBrowserEvent_,Gc?{passive:!1}:!1);let i;if(this.keyboardEventTarget_)i=this.keyboardEventTarget_;else{const r=e.getRootNode();i=r instanceof ShadowRoot?r.host:e}this.targetChangeHandlerKeys_=[at(i,j.KEYDOWN,this.handleBrowserEvent,this),at(i,j.KEYPRESS,this.handleBrowserEvent,this)];const n=e.getRootNode();n instanceof ShadowRoot&&this.resizeObserver_.observe(n.host),this.resizeObserver_.observe(e)}this.updateSize()}handleTileChange_(){this.render()}handleViewPropertyChanged_(){this.render()}handleViewChanged_(){this.viewPropertyListenerKey_&&(_t(this.viewPropertyListenerKey_),this.viewPropertyListenerKey_=null),this.viewChangeListenerKey_&&(_t(this.viewChangeListenerKey_),this.viewChangeListenerKey_=null);const t=this.getView();t&&(this.updateViewportSize_(this.getSize()),this.viewPropertyListenerKey_=at(t,Dn.PROPERTYCHANGE,this.handleViewPropertyChanged_,this),this.viewChangeListenerKey_=at(t,j.CHANGE,this.handleViewPropertyChanged_,this),t.resolveConstraints(0)),this.render()}handleLayerGroupChanged_(){this.layerGroupPropertyListenerKeys_&&(this.layerGroupPropertyListenerKeys_.forEach(_t),this.layerGroupPropertyListenerKeys_=null);const t=this.getLayerGroup();t&&(this.handleLayerAdd_(new Si("addlayer",t)),this.layerGroupPropertyListenerKeys_=[at(t,Dn.PROPERTYCHANGE,this.render,this),at(t,j.CHANGE,this.render,this),at(t,"addlayer",this.handleLayerAdd_,this),at(t,"removelayer",this.handleLayerRemove_,this)]),this.render()}isRendered(){return!!this.frameState_}animationDelay_(){this.animationDelayKey_=void 0,this.renderFrame_(Date.now())}renderSync(){this.animationDelayKey_&&cancelAnimationFrame(this.animationDelayKey_),this.animationDelay_()}redrawText(){const t=this.getLayerGroup().getLayerStatesArray();for(let e=0,i=t.length;e<i;++e){const n=t[e].layer;n.hasRenderer()&&n.getRenderer().handleFontsChanged()}}render(){this.renderer_&&this.animationDelayKey_===void 0&&(this.animationDelayKey_=requestAnimationFrame(this.animationDelay_))}removeControl(t){return this.getControls().remove(t)}removeInteraction(t){return this.getInteractions().remove(t)}removeLayer(t){return this.getLayerGroup().getLayers().remove(t)}handleLayerRemove_(t){iu(t.layer)}removeOverlay(t){return this.getOverlays().remove(t)}renderFrame_(t){const e=this.getSize(),i=this.getView(),n=this.frameState_;let r=null;if(e!==void 0&&ih(e)&&i&&i.isDef()){const o=i.getHints(this.frameState_?this.frameState_.viewHints:void 0),a=i.getState();if(r={animate:!1,coordinateToPixelTransform:this.coordinateToPixelTransform_,declutter:null,extent:jo(a.center,a.resolution,a.rotation,e),index:this.frameIndex_++,layerIndex:0,layerStatesArray:this.getLayerGroup().getLayerStatesArray(),pixelRatio:this.pixelRatio_,pixelToCoordinateTransform:this.pixelToCoordinateTransform_,postRenderFunctions:[],size:e,tileQueue:this.tileQueue_,time:t,usedTiles:{},viewState:a,viewHints:o,wantedTiles:{},mapId:J(this),renderTargets:{}},a.nextCenter&&a.nextResolution){const l=isNaN(a.nextRotation)?a.rotation:a.nextRotation;r.nextExtent=jo(a.nextCenter,a.nextResolution,l,e)}}this.frameState_=r,this.renderer_.renderFrame(r),r&&(r.animate&&this.render(),Array.prototype.push.apply(this.postRenderFunctions_,r.postRenderFunctions),n&&(!this.previousExtent_||!ba(this.previousExtent_)&&!bn(r.extent,this.previousExtent_))&&(this.dispatchEvent(new Rn(ni.MOVESTART,this,n)),this.previousExtent_=La(this.previousExtent_)),this.previousExtent_&&!r.viewHints[St.ANIMATING]&&!r.viewHints[St.INTERACTING]&&!bn(r.extent,this.previousExtent_)&&(this.dispatchEvent(new Rn(ni.MOVEEND,this,r)),ic(r.extent,this.previousExtent_))),this.dispatchEvent(new Rn(ni.POSTRENDER,this,r)),this.renderComplete_=(this.hasListener(ni.LOADSTART)||this.hasListener(ni.LOADEND)||this.hasListener(Ee.RENDERCOMPLETE))&&!this.tileQueue_.getTilesLoading()&&!this.tileQueue_.getCount()&&!this.getLoadingOrNotReady(),this.postRenderTimeoutHandle_||(this.postRenderTimeoutHandle_=setTimeout(()=>{this.postRenderTimeoutHandle_=void 0,this.handlePostRender()},0))}setLayerGroup(t){const e=this.getLayerGroup();e&&this.handleLayerRemove_(new Si("removelayer",e)),this.set(Kt.LAYERGROUP,t)}setSize(t){this.set(Kt.SIZE,t)}setTarget(t){this.set(Kt.TARGET,t)}setView(t){if(!t||t instanceof Xe){this.set(Kt.VIEW,t);return}this.set(Kt.VIEW,new Xe);const e=this;t.then(function(i){e.setView(new Xe(i))})}updateSize(){const t=this.getTargetElement();let e;if(t){const n=getComputedStyle(t),r=t.offsetWidth-parseFloat(n.borderLeftWidth)-parseFloat(n.paddingLeft)-parseFloat(n.paddingRight)-parseFloat(n.borderRightWidth),o=t.offsetHeight-parseFloat(n.borderTopWidth)-parseFloat(n.paddingTop)-parseFloat(n.paddingBottom)-parseFloat(n.borderBottomWidth);!isNaN(r)&&!isNaN(o)&&(e=[Math.max(0,r),Math.max(0,o)],!ih(e)&&(t.offsetWidth||t.offsetHeight||t.getClientRects().length)&&Td("No map visible because the map container's width or height are 0."))}const i=this.getSize();e&&(!i||!zi(e,i))&&(this.setSize(e),this.updateViewportSize_(e))}updateViewportSize_(t){const e=this.getView();e&&e.setViewportSize(t)}};function Cm(s){let t=null;s.keyboardEventTarget!==void 0&&(t=typeof s.keyboardEventTarget=="string"?document.getElementById(s.keyboardEventTarget):s.keyboardEventTarget);const e={},i=s.layers&&typeof s.layers.getLayers=="function"?s.layers:new Wn({layers:s.layers});e[Kt.LAYERGROUP]=i,e[Kt.TARGET]=s.target,e[Kt.VIEW]=s.view instanceof Xe?s.view:new Xe;let n;s.controls!==void 0&&(Array.isArray(s.controls)?n=new Fe(s.controls.slice()):(lt(typeof s.controls.getArray=="function","Expected `controls` to be an array or an `ol/Collection.js`"),n=s.controls));let r;s.interactions!==void 0&&(Array.isArray(s.interactions)?r=new Fe(s.interactions.slice()):(lt(typeof s.interactions.getArray=="function","Expected `interactions` to be an array or an `ol/Collection.js`"),r=s.interactions));let o;return s.overlays!==void 0?Array.isArray(s.overlays)?o=new Fe(s.overlays.slice()):(lt(typeof s.overlays.getArray=="function","Expected `overlays` to be an array or an `ol/Collection.js`"),o=s.overlays):o=new Fe,{controls:n,interactions:r,keyboardEventTarget:t,overlays:o,values:e}}const wm="data:image/svg+xml,%3csvg%20width='30'%20height='30'%20viewBox='0%200%2030%2030'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20opacity='0.2'%20cx='15'%20cy='15'%20r='15'%20fill='%230C79FE'%20/%3e%3ccircle%20cx='15'%20cy='15'%20r='7'%20fill='%230C79FE'%20stroke='white'%20stroke-width='2'%20/%3e%3c/svg%3e",Tm=""+new URL("../assets/add-marker.CpezPS16.svg",import.meta.url).href;class su{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.pop()}clear(){this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const i=this.entries_[t];return lt(i!==void 0,"Tried to get a value for a key that does not exist in the cache"),i===this.newest_||(i===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(i.newer.older=i.older,i.older.newer=i.newer),i.newer=null,i.older=this.newest_,this.newest_.newer=i,this.newest_=i),i.value_}remove(t){const e=this.entries_[t];return lt(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.key_;return t}getValues(){const t=new Array(this.count_);let e=0,i;for(i=this.newest_;i;i=i.older)t[e++]=i.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){var e;return(e=this.entries_[t])==null?void 0:e.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){lt(!(t in this.entries_),"Tried to set a value for a key that is used already");const i={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=i:this.oldest_=i,this.newest_=i,this.entries_[t]=i,++this.count_}setSize(t){this.highWaterMark=t}}class Bs extends Kr{constructor(t,e,i){super(),i=i||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=i.transition===void 0?250:i.transition,this.transitionStarts_={},this.interpolate=!!i.interpolate}changed(){this.dispatchEvent(j.CHANGE)}release(){this.state===Y.ERROR&&this.setState(Y.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==Y.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}load(){q()}getAlpha(t,e){if(!this.transition_)return 1;let i=this.transitionStarts_[t];if(!i)i=e,this.transitionStarts_[t]=i;else if(i===-1)return 1;const n=e-i+1e3/60;return n>=this.transition_?1:gc(n/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}}class ru extends Bs{constructor(t,e,i,n,r,o){super(t,e,o),this.crossOrigin_=n,this.src_=i,this.key=i,this.image_=new Image,n!==null&&(this.image_.crossOrigin=n),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=Y.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=Y.ERROR,this.unlistenImage_(),this.image_=Sm(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=Y.LOADED:this.state=Y.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==Y.ERROR&&(this.state=Y.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==Y.IDLE&&(this.state=Y.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Kf(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}function Sm(){const s=Rt(1,1);return s.fillStyle="rgba(0,0,0,0)",s.fillRect(0,0,1,1),s.canvas}const ou=.5,Rm=10,xh=.25;class au{constructor(t,e,i,n,r,o){this.sourceProj_=t,this.targetProj_=e;let a={};const l=wr(this.targetProj_,this.sourceProj_);this.transformInv_=function(_){const v=_[0]+"/"+_[1];return a[v]||(a[v]=l(_)),a[v]},this.maxSourceExtent_=n,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!n&&!!this.sourceProj_.getExtent()&&yt(n)>=yt(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?yt(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?yt(this.targetProj_.getExtent()):null;const h=Un(i),c=nc(i),u=sc(i),d=rc(i),f=this.transformInv_(h),m=this.transformInv_(c),p=this.transformInv_(u),x=this.transformInv_(d),T=Rm+(o?Math.max(0,Math.ceil(Math.log2(_s(i)/(o*o*256*256)))):0);if(this.addQuad_(h,c,u,d,f,m,p,x,T),this.wrapsXInSource_){let _=1/0;this.triangles_.forEach(function(v,P,F){_=Math.min(_,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-_>this.sourceWorldWidth_/2){const P=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];P[0][0]-_>this.sourceWorldWidth_/2&&(P[0][0]-=this.sourceWorldWidth_),P[1][0]-_>this.sourceWorldWidth_/2&&(P[1][0]-=this.sourceWorldWidth_),P[2][0]-_>this.sourceWorldWidth_/2&&(P[2][0]-=this.sourceWorldWidth_);const F=Math.min(P[0][0],P[1][0],P[2][0]);Math.max(P[0][0],P[1][0],P[2][0])-F<this.sourceWorldWidth_/2&&(v.source=P)}})}a={}}addTriangle_(t,e,i,n,r,o){this.triangles_.push({source:[n,r,o],target:[t,e,i]})}addQuad_(t,e,i,n,r,o,a,l,h){const c=Tr([r,o,a,l]),u=this.sourceWorldWidth_?yt(c)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&u>.5&&u<1;let m=!1;if(h>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const x=Tr([t,e,i,n]);m=yt(x)/this.targetWorldWidth_>xh||m}!f&&this.sourceProj_.isGlobal()&&u&&(m=u>xh||m)}if(!m&&this.maxSourceExtent_&&isFinite(c[0])&&isFinite(c[1])&&isFinite(c[2])&&isFinite(c[3])&&!vt(c,this.maxSourceExtent_))return;let p=0;if(!m&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(l[0])||!isFinite(l[1]))){if(h>0)m=!0;else if(p=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(l[0])||!isFinite(l[1])?1:0),p!=1&&p!=2&&p!=4&&p!=8)return}if(h>0){if(!m){const x=[(t[0]+i[0])/2,(t[1]+i[1])/2],T=this.transformInv_(x);let _;f?_=(Fi(r[0],d)+Fi(a[0],d))/2-Fi(T[0],d):_=(r[0]+a[0])/2-T[0];const v=(r[1]+a[1])/2-T[1];m=_*_+v*v>this.errorThresholdSquared_}if(m){if(Math.abs(t[0]-i[0])<=Math.abs(t[1]-i[1])){const x=[(e[0]+i[0])/2,(e[1]+i[1])/2],T=this.transformInv_(x),_=[(n[0]+t[0])/2,(n[1]+t[1])/2],v=this.transformInv_(_);this.addQuad_(t,e,x,_,r,o,T,v,h-1),this.addQuad_(_,x,i,n,v,T,a,l,h-1)}else{const x=[(t[0]+e[0])/2,(t[1]+e[1])/2],T=this.transformInv_(x),_=[(i[0]+n[0])/2,(i[1]+n[1])/2],v=this.transformInv_(_);this.addQuad_(t,x,_,n,r,T,v,l,h-1),this.addQuad_(x,e,i,_,T,o,a,v,h-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}p&11||this.addTriangle_(t,i,n,r,a,l),p&14||this.addTriangle_(t,i,e,r,a,o),p&&(p&13||this.addTriangle_(e,n,t,o,l,r),p&7||this.addTriangle_(e,n,i,o,l,a))}calculateSourceExtent(){const t=Se();return this.triangles_.forEach(function(e,i,n){const r=e.source;yr(t,r[0]),yr(t,r[1]),yr(t,r[2])}),t}getTriangles(){return this.triangles_}}let Lo;const hi=[];function Eh(s,t,e,i,n){s.beginPath(),s.moveTo(0,0),s.lineTo(t,e),s.lineTo(i,n),s.closePath(),s.save(),s.clip(),s.fillRect(0,0,Math.max(t,i)+1,Math.max(e,n)),s.restore()}function Mo(s,t){return Math.abs(s[t*4]-210)>2||Math.abs(s[t*4+3]-.75*255)>2}function Im(){if(Lo===void 0){const s=Rt(6,6,hi);s.globalCompositeOperation="lighter",s.fillStyle="rgba(210, 0, 0, 0.75)",Eh(s,4,5,4,0),Eh(s,4,5,0,5);const t=s.getImageData(0,0,3,3).data;Lo=Mo(t,0)||Mo(t,4)||Mo(t,8),sn(s),hi.push(s.canvas)}return Lo}function ha(s,t,e,i){const n=oc(e,t,s);let r=Xl(t,i,e);const o=t.getMetersPerUnit();o!==void 0&&(r*=o);const a=s.getMetersPerUnit();a!==void 0&&(r/=a);const l=s.getExtent();if(!l||On(l,n)){const h=Xl(s,r,n)/r;isFinite(h)&&h>0&&(r/=h)}return r}function lu(s,t,e,i){const n=ui(e);let r=ha(s,t,n,i);return(!isFinite(r)||r<=0)&&Fa(e,function(o){return r=ha(s,t,o,i),isFinite(r)&&r>0}),r}function hu(s,t,e,i,n,r,o,a,l,h,c,u,d,f){const m=Rt(Math.round(e*s),Math.round(e*t),hi);if(u||(m.imageSmoothingEnabled=!1),l.length===0)return m.canvas;m.scale(e,e);function p(F){return Math.round(F*e)/e}m.globalCompositeOperation="lighter";const x=Se();l.forEach(function(F,k,O){ac(x,F.extent)});let T;const _=e/i,v=(u?1:1+Math.pow(2,-24))/_;if(!d||l.length!==1||h!==0){if(T=Rt(Math.round(yt(x)*_),Math.round(Wt(x)*_),hi),u||(T.imageSmoothingEnabled=!1),n&&f){const F=(n[0]-x[0])*_,k=-(n[3]-x[3])*_,O=yt(n)*_,g=Wt(n)*_;T.rect(F,k,O,g),T.clip()}l.forEach(function(F,k,O){if(F.image.width>0&&F.image.height>0){if(F.clipExtent){T.save();const C=(F.clipExtent[0]-x[0])*_,I=-(F.clipExtent[3]-x[3])*_,R=yt(F.clipExtent)*_,w=Wt(F.clipExtent)*_;T.rect(u?C:Math.round(C),u?I:Math.round(I),u?R:Math.round(C+R)-Math.round(C),u?w:Math.round(I+w)-Math.round(I)),T.clip()}const g=(F.extent[0]-x[0])*_,A=-(F.extent[3]-x[3])*_,y=yt(F.extent)*_,S=Wt(F.extent)*_;T.drawImage(F.image,h,h,F.image.width-2*h,F.image.height-2*h,u?g:Math.round(g),u?A:Math.round(A),u?y:Math.round(g+y)-Math.round(g),u?S:Math.round(A+S)-Math.round(A)),F.clipExtent&&T.restore()}})}const P=Un(o);return a.getTriangles().forEach(function(F,k,O){const g=F.source,A=F.target;let y=g[0][0],S=g[0][1],C=g[1][0],I=g[1][1],R=g[2][0],w=g[2][1];const E=p((A[0][0]-P[0])/r),M=p(-(A[0][1]-P[1])/r),L=p((A[1][0]-P[0])/r),b=p(-(A[1][1]-P[1])/r),B=p((A[2][0]-P[0])/r),z=p(-(A[2][1]-P[1])/r),X=y,it=S;y=0,S=0,C-=X,I-=it,R-=X,w-=it;const G=[[C,I,0,0,L-E],[R,w,0,0,B-E],[0,0,C,I,b-M],[0,0,R,w,z-M]],Z=Sd(G);if(!Z)return;if(m.save(),m.beginPath(),Im()||!u){m.moveTo(L,b);const rt=4,Qt=E-L,ae=M-b;for(let Xt=0;Xt<rt;Xt++)m.lineTo(L+p((Xt+1)*Qt/rt),b+p(Xt*ae/(rt-1))),Xt!=rt-1&&m.lineTo(L+p((Xt+1)*Qt/rt),b+p((Xt+1)*ae/(rt-1)));m.lineTo(B,z)}else m.moveTo(L,b),m.lineTo(E,M),m.lineTo(B,z);m.clip(),m.transform(Z[0],Z[2],Z[1],Z[3],E,M),m.translate(x[0]-X,x[3]-it);let H;if(T)H=T.canvas,m.scale(v,-v);else{const rt=l[0],Qt=rt.extent;H=rt.image,m.scale(yt(Qt)/H.width,-Wt(Qt)/H.height)}m.drawImage(H,0,0),m.restore()}),T&&(sn(T),hi.push(T.canvas)),c&&(m.save(),m.globalCompositeOperation="source-over",m.strokeStyle="black",m.lineWidth=1,a.getTriangles().forEach(function(F,k,O){const g=F.target,A=(g[0][0]-P[0])/r,y=-(g[0][1]-P[1])/r,S=(g[1][0]-P[0])/r,C=-(g[1][1]-P[1])/r,I=(g[2][0]-P[0])/r,R=-(g[2][1]-P[1])/r;m.beginPath(),m.moveTo(S,C),m.lineTo(A,y),m.lineTo(I,R),m.closePath(),m.stroke()}),m.restore()),m.canvas}class cu extends Bs{constructor(t,e,i,n,r,o,a,l,h,c,u,d){super(r,Y.IDLE,d),this.renderEdges_=u!==void 0?u:!1,this.pixelRatio_=a,this.gutter_=l,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=n,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const f=n.getTileCoordExtent(this.wrappedTileCoord_),m=this.targetTileGrid_.getExtent();let p=this.sourceTileGrid_.getExtent();const x=m?ce(f,m):f;if(_s(x)===0){this.state=Y.EMPTY;return}const T=t.getExtent();T&&(p?p=ce(p,T):p=T);const _=n.getResolution(this.wrappedTileCoord_[0]),v=lu(t,i,x,_);if(!isFinite(v)||v<=0){this.state=Y.EMPTY;return}const P=c!==void 0?c:ou;if(this.triangulation_=new au(t,i,x,p,v*P,_),this.triangulation_.getTriangles().length===0){this.state=Y.EMPTY;return}this.sourceZ_=e.getZForResolution(v);let F=this.triangulation_.calculateSourceExtent();if(p&&(t.canWrapX()?(F[1]=wt(F[1],p[1],p[3]),F[3]=wt(F[3],p[1],p[3])):F=ce(F,p)),!_s(F))this.state=Y.EMPTY;else{let k=0,O=0;t.canWrapX()&&(k=yt(T),O=Math.floor((F[0]-T[0])/k)),Ga(F.slice(),t,!0).forEach(A=>{const y=e.getTileRangeForExtentAndZ(A,this.sourceZ_);for(let S=y.minX;S<=y.maxX;S++)for(let C=y.minY;C<=y.maxY;C++){const I=h(this.sourceZ_,S,C,a);if(I){const R=O*k;this.sourceTiles_.push({tile:I,offset:R})}}++O}),this.sourceTiles_.length===0&&(this.state=Y.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{var n;const i=e.tile;if(i&&i.getState()==Y.LOADED){const r=this.sourceTileGrid_.getTileCoordExtent(i.tileCoord);r[0]+=e.offset,r[2]+=e.offset;const o=(n=this.clipExtent_)==null?void 0:n.slice();o&&(o[0]+=e.offset,o[2]+=e.offset),t.push({extent:r,clipExtent:o,image:i.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=Y.ERROR;else{const e=this.wrappedTileCoord_[0],i=this.targetTileGrid_.getTileSize(e),n=typeof i=="number"?i:i[0],r=typeof i=="number"?i:i[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),l=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=hu(n,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,l,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=Y.LOADED}this.changed()}load(){if(this.state==Y.IDLE){this.state=Y.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i==Y.IDLE||i==Y.LOADING){t++;const n=at(e,j.CHANGE,r=>{const o=e.getState();(o==Y.LOADED||o==Y.ERROR||o==Y.EMPTY)&&(_t(n),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},i,n){e.getState()==Y.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(_t),this.sourcesListenerKeys_=null}release(){this.canvas_&&(sn(this.canvas_.getContext("2d")),hi.push(this.canvas_),this.canvas_=null),super.release()}}function Or(s,t,e,i){return i!==void 0?(i[0]=s,i[1]=t,i[2]=e,i):[s,t,e]}function zs(s,t,e){return s+"/"+t+"/"+e}function uu(s){return zs(s[0],s[1],s[2])}function vm(s){const[t,e,i]=s.substring(s.lastIndexOf("/")+1,s.length).split(",").map(Number);return zs(t,e,i)}function Lm(s){return s.split("/").map(Number)}function du(s){return Mm(s[0],s[1],s[2])}function Mm(s,t,e){return(t<<s)+e}function Pm(s,t){const e=s[0],i=s[1],n=s[2];if(t.getMinZoom()>e||e>t.getMaxZoom())return!1;const r=t.getFullTileRange(e);return r?r.containsXY(i,n):!0}class El extends su{clear(){for(;this.getCount()>0;)this.pop().release();super.clear()}expireCache(t){for(;this.canExpireCache()&&!(this.peekLast().getKey()in t);)this.pop().release()}pruneExceptNewestZ(){if(this.getCount()===0)return;const t=this.peekFirstKey(),i=Lm(t)[0];this.forEach(n=>{n.tileCoord[0]!==i&&(this.remove(uu(n.tileCoord)),n.release())})}}const Po={TILELOADSTART:"tileloadstart",TILELOADEND:"tileloadend",TILELOADERROR:"tileloaderror"};class fu extends ke{constructor(t){super(),this.projection=Zt(t.projection),this.attributions_=Ch(t.attributions),this.attributionsCollapsible_=t.attributionsCollapsible??!0,this.loading=!1,this.state_=t.state!==void 0?t.state:"ready",this.wrapX_=t.wrapX!==void 0?t.wrapX:!1,this.interpolate_=!!t.interpolate,this.viewResolver=null,this.viewRejector=null;const e=this;this.viewPromise_=new Promise(function(i,n){e.viewResolver=i,e.viewRejector=n})}getAttributions(){return this.attributions_}getAttributionsCollapsible(){return this.attributionsCollapsible_}getProjection(){return this.projection}getResolutions(t){return null}getView(){return this.viewPromise_}getState(){return this.state_}getWrapX(){return this.wrapX_}getInterpolate(){return this.interpolate_}refresh(){this.changed()}setAttributions(t){this.attributions_=Ch(t),this.changed()}setState(t){this.state_=t,this.changed()}}function Ch(s){return s?typeof s=="function"?s:(Array.isArray(s)||(s=[s]),t=>s):null}class Cl{constructor(t,e,i,n){this.minX=t,this.maxX=e,this.minY=i,this.maxY=n}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}}function yn(s,t,e,i,n){return n!==void 0?(n.minX=s,n.maxX=t,n.minY=e,n.maxY=i,n):new Cl(s,t,e,i)}const xn=[0,0,0],yi=5;class wl{constructor(t){this.minZoom=t.minZoom!==void 0?t.minZoom:0,this.resolutions_=t.resolutions,lt(Kd(this.resolutions_,(n,r)=>r-n),"`resolutions` must be sorted in descending order");let e;if(!t.origins){for(let n=0,r=this.resolutions_.length-1;n<r;++n)if(!e)e=this.resolutions_[n]/this.resolutions_[n+1];else if(this.resolutions_[n]/this.resolutions_[n+1]!==e){e=void 0;break}}this.zoomFactor_=e,this.maxZoom=this.resolutions_.length-1,this.origin_=t.origin!==void 0?t.origin:null,this.origins_=null,t.origins!==void 0&&(this.origins_=t.origins,lt(this.origins_.length==this.resolutions_.length,"Number of `origins` and `resolutions` must be equal"));const i=t.extent;i!==void 0&&!this.origin_&&!this.origins_&&(this.origin_=Un(i)),lt(!this.origin_&&this.origins_||this.origin_&&!this.origins_,"Either `origin` or `origins` must be configured, never both"),this.tileSizes_=null,t.tileSizes!==void 0&&(this.tileSizes_=t.tileSizes,lt(this.tileSizes_.length==this.resolutions_.length,"Number of `tileSizes` and `resolutions` must be equal")),this.tileSize_=t.tileSize!==void 0?t.tileSize:this.tileSizes_?null:Xa,lt(!this.tileSize_&&this.tileSizes_||this.tileSize_&&!this.tileSizes_,"Either `tileSize` or `tileSizes` must be configured, never both"),this.extent_=i!==void 0?i:null,this.fullTileRanges_=null,this.tmpSize_=[0,0],this.tmpExtent_=[0,0,0,0],t.sizes!==void 0?this.fullTileRanges_=t.sizes.map((n,r)=>{const o=new Cl(Math.min(0,n[0]),Math.max(n[0]-1,-1),Math.min(0,n[1]),Math.max(n[1]-1,-1));if(i){const a=this.getTileRangeForExtentAndZ(i,r);o.minX=Math.max(a.minX,o.minX),o.maxX=Math.min(a.maxX,o.maxX),o.minY=Math.max(a.minY,o.minY),o.maxY=Math.min(a.maxY,o.maxY)}return o}):i&&this.calculateTileRanges_(i)}forEachTileCoord(t,e,i){const n=this.getTileRangeForExtentAndZ(t,e);for(let r=n.minX,o=n.maxX;r<=o;++r)for(let a=n.minY,l=n.maxY;a<=l;++a)i([e,r,a])}forEachTileCoordParentTileRange(t,e,i,n){let r,o,a,l=null,h=t[0]-1;for(this.zoomFactor_===2?(o=t[1],a=t[2]):l=this.getTileCoordExtent(t,n);h>=this.minZoom;){if(o!==void 0&&a!==void 0?(o=Math.floor(o/2),a=Math.floor(a/2),r=yn(o,o,a,a,i)):r=this.getTileRangeForExtentAndZ(l,h,i),e(h,r))return!0;--h}return!1}getExtent(){return this.extent_}getMaxZoom(){return this.maxZoom}getMinZoom(){return this.minZoom}getOrigin(t){return this.origin_?this.origin_:this.origins_[t]}getResolution(t){return this.resolutions_[t]}getResolutions(){return this.resolutions_}getTileCoordChildTileRange(t,e,i){if(t[0]<this.maxZoom){if(this.zoomFactor_===2){const r=t[1]*2,o=t[2]*2;return yn(r,r+1,o,o+1,e)}const n=this.getTileCoordExtent(t,i||this.tmpExtent_);return this.getTileRangeForExtentAndZ(n,t[0]+1,e)}return null}getTileRangeForTileCoordAndZ(t,e,i){if(e>this.maxZoom||e<this.minZoom)return null;const n=t[0],r=t[1],o=t[2];if(e===n)return yn(r,o,r,o,i);if(this.zoomFactor_){const l=Math.pow(this.zoomFactor_,e-n),h=Math.floor(r*l),c=Math.floor(o*l);if(e<n)return yn(h,h,c,c,i);const u=Math.floor(l*(r+1))-1,d=Math.floor(l*(o+1))-1;return yn(h,u,c,d,i)}const a=this.getTileCoordExtent(t,this.tmpExtent_);return this.getTileRangeForExtentAndZ(a,e,i)}getTileRangeForExtentAndZ(t,e,i){this.getTileCoordForXYAndZ_(t[0],t[3],e,!1,xn);const n=xn[1],r=xn[2];this.getTileCoordForXYAndZ_(t[2],t[1],e,!0,xn);const o=xn[1],a=xn[2];return yn(n,o,r,a,i)}getTileCoordCenter(t){const e=this.getOrigin(t[0]),i=this.getResolution(t[0]),n=Bt(this.getTileSize(t[0]),this.tmpSize_);return[e[0]+(t[1]+.5)*n[0]*i,e[1]-(t[2]+.5)*n[1]*i]}getTileCoordExtent(t,e){const i=this.getOrigin(t[0]),n=this.getResolution(t[0]),r=Bt(this.getTileSize(t[0]),this.tmpSize_),o=i[0]+t[1]*r[0]*n,a=i[1]-(t[2]+1)*r[1]*n,l=o+r[0]*n,h=a+r[1]*n;return Nn(o,a,l,h,e)}getTileCoordForCoordAndResolution(t,e,i){return this.getTileCoordForXYAndResolution_(t[0],t[1],e,!1,i)}getTileCoordForXYAndResolution_(t,e,i,n,r){const o=this.getZForResolution(i),a=i/this.getResolution(o),l=this.getOrigin(o),h=Bt(this.getTileSize(o),this.tmpSize_);let c=a*(t-l[0])/i/h[0],u=a*(l[1]-e)/i/h[1];return n?(c=Js(c,yi)-1,u=Js(u,yi)-1):(c=$s(c,yi),u=$s(u,yi)),Or(o,c,u,r)}getTileCoordForXYAndZ_(t,e,i,n,r){const o=this.getOrigin(i),a=this.getResolution(i),l=Bt(this.getTileSize(i),this.tmpSize_);let h=(t-o[0])/a/l[0],c=(o[1]-e)/a/l[1];return n?(h=Js(h,yi)-1,c=Js(c,yi)-1):(h=$s(h,yi),c=$s(c,yi)),Or(i,h,c,r)}getTileCoordForCoordAndZ(t,e,i){return this.getTileCoordForXYAndZ_(t[0],t[1],e,!1,i)}getTileCoordResolution(t){return this.resolutions_[t[0]]}getTileSize(t){return this.tileSize_?this.tileSize_:this.tileSizes_[t]}getFullTileRange(t){return this.fullTileRanges_?this.fullTileRanges_[t]:this.extent_?this.getTileRangeForExtentAndZ(this.extent_,t):null}getZForResolution(t,e){const i=Ua(this.resolutions_,t,e||0);return wt(i,this.minZoom,this.maxZoom)}tileCoordIntersectsViewport(t,e){return Rc(e,0,e.length,2,this.getTileCoordExtent(t))}calculateTileRanges_(t){const e=this.resolutions_.length,i=new Array(e);for(let n=this.minZoom;n<e;++n)i[n]=this.getTileRangeForExtentAndZ(t,n);this.fullTileRanges_=i}}function gu(s){let t=s.getDefaultTileGrid();return t||(t=Om(s),s.setDefaultTileGrid(t)),t}function Fm(s,t,e){const i=t[0],n=s.getTileCoordCenter(t),r=eo(e);if(!On(r,n)){const o=yt(r),a=Math.ceil((r[0]-n[0])/o);return n[0]+=o*a,s.getTileCoordForCoordAndZ(n,i)}return t}function bm(s,t,e,i){i=i!==void 0?i:"top-left";const n=Au(s,t,e);return new wl({extent:s,origin:Rd(s,i),resolutions:n,tileSize:e})}function mu(s){const t=s||{},e=t.extent||Zt("EPSG:3857").getExtent(),i={extent:e,minZoom:t.minZoom,tileSize:t.tileSize,resolutions:Au(e,t.maxZoom,t.tileSize,t.maxResolution)};return new wl(i)}function Au(s,t,e,i){t=t!==void 0?t:dc,e=Bt(e!==void 0?e:Xa);const n=Wt(s),r=yt(s);i=i>0?i:Math.max(r/e[0],n/e[1]);const o=t+1,a=new Array(o);for(let l=0;l<o;++l)a[l]=i/Math.pow(2,l);return a}function Om(s,t,e,i){const n=eo(s);return bm(n,t,e,i)}function eo(s){s=Zt(s);let t=s.getExtent();if(!t){const e=180*tc.degrees/s.getMetersPerUnit();t=Nn(-e,-e,e,e)}return t}class Nm extends fu{constructor(t){super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,projection:t.projection,state:t.state,wrapX:t.wrapX,interpolate:t.interpolate}),this.on,this.once,this.un,this.tilePixelRatio_=t.tilePixelRatio!==void 0?t.tilePixelRatio:1,this.tileGrid=t.tileGrid!==void 0?t.tileGrid:null;const e=[256,256];this.tileGrid&&Bt(this.tileGrid.getTileSize(this.tileGrid.getMinZoom()),e),this.tileCache=new El(t.cacheSize||0),this.tmpSize=[0,0],this.key_=t.key||"",this.tileOptions={transition:t.transition,interpolate:t.interpolate},this.zDirection=t.zDirection?t.zDirection:0}canExpireCache(){return this.tileCache.canExpireCache()}expireCache(t,e){const i=this.getTileCacheForProjection(t);i&&i.expireCache(e)}getGutterForProjection(t){return 0}getKey(){return this.key_}setKey(t){this.key_!==t&&(this.key_=t,this.changed())}getResolutions(t){const e=t?this.getTileGridForProjection(t):this.tileGrid;return e?e.getResolutions():null}getTile(t,e,i,n,r){return q()}getTileGrid(){return this.tileGrid}getTileGridForProjection(t){return this.tileGrid?this.tileGrid:gu(t)}getTileCacheForProjection(t){const e=this.getProjection();return lt(e===null||vn(e,t),"A VectorTile source can only be rendered if it has a projection compatible with the view projection."),this.tileCache}getTilePixelRatio(t){return this.tilePixelRatio_}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=this.getTilePixelRatio(e),o=Bt(n.getTileSize(t),this.tmpSize);return r==1?o:Ff(o,r,this.tmpSize)}getTileCoordForTileUrlFunction(t,e){e=e!==void 0?e:this.getProjection();const i=this.getTileGridForProjection(e);return this.getWrapX()&&e.isGlobal()&&(t=Fm(i,t,e)),Pm(t,i)?t:null}clear(){this.tileCache.clear()}refresh(){this.clear(),super.refresh()}useTile(t,e,i,n){}}class Dm extends De{constructor(t,e){super(t),this.tile=e}}function _u(s,t){const e=[];Object.keys(t).forEach(function(n){t[n]!==null&&t[n]!==void 0&&e.push(n+"="+encodeURIComponent(t[n]))});const i=e.join("&");return s=s.replace(/[?&]$/,""),s+=s.includes("?")?"&":"?",s+i}const km=/\{z\}/g,Gm=/\{x\}/g,Bm=/\{y\}/g,zm=/\{-y\}/g;function Ym(s,t,e,i,n){return s.replace(km,t.toString()).replace(Gm,e.toString()).replace(Bm,i.toString()).replace(zm,function(){if(n===void 0)throw new Error("If the URL template has a {-y} placeholder, the grid extent must be known");return(n-i).toString()})}function Um(s){const t=[];let e=/\{([a-z])-([a-z])\}/.exec(s);if(e){const i=e[1].charCodeAt(0),n=e[2].charCodeAt(0);let r;for(r=i;r<=n;++r)t.push(s.replace(e[0],String.fromCharCode(r)));return t}if(e=/\{(\d+)-(\d+)\}/.exec(s),e){const i=parseInt(e[2],10);for(let n=parseInt(e[1],10);n<=i;n++)t.push(s.replace(e[0],n.toString()));return t}return t.push(s),t}function Xm(s,t){return function(e,i,n){if(!e)return;let r;const o=e[0];if(t){const a=t.getFullTileRange(o);a&&(r=a.getHeight()-1)}return Ym(s,o,e[1],e[2],r)}}function Vm(s,t){const e=s.length,i=new Array(e);for(let n=0;n<e;++n)i[n]=Xm(s[n],t);return Km(i)}function Km(s){return s.length===1?s[0]:function(t,e,i){if(!t)return;const n=du(t),r=Fi(n,s.length);return s[r](t,e,i)}}class io extends Nm{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tilePixelRatio:t.tilePixelRatio,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.generateTileUrlFunction_=this.tileUrlFunction===io.prototype.tileUrlFunction,this.tileLoadFunction=t.tileLoadFunction,t.tileUrlFunction&&(this.tileUrlFunction=t.tileUrlFunction),this.urls=null,t.urls?this.setUrls(t.urls):t.url&&this.setUrl(t.url),this.tileLoadingKeys_={}}getTileLoadFunction(){return this.tileLoadFunction}getTileUrlFunction(){return Object.getPrototypeOf(this).tileUrlFunction===this.tileUrlFunction?this.tileUrlFunction.bind(this):this.tileUrlFunction}getUrls(){return this.urls}handleTileChange(t){const e=t.target,i=J(e),n=e.getState();let r;n==Y.LOADING?(this.tileLoadingKeys_[i]=!0,r=Po.TILELOADSTART):i in this.tileLoadingKeys_&&(delete this.tileLoadingKeys_[i],r=n==Y.ERROR?Po.TILELOADERROR:n==Y.LOADED?Po.TILELOADEND:void 0),r!=null&&this.dispatchEvent(new Dm(r,e))}setTileLoadFunction(t){this.tileCache.clear(),this.tileLoadFunction=t,this.changed()}setTileUrlFunction(t,e){this.tileUrlFunction=t,this.tileCache.pruneExceptNewestZ(),typeof e<"u"?this.setKey(e):this.changed()}setUrl(t){const e=Um(t);this.urls=e,this.setUrls(e)}setUrls(t){this.urls=t;const e=t.join(`
`);this.generateTileUrlFunction_?this.setTileUrlFunction(Vm(t,this.tileGrid),e):this.setKey(e)}tileUrlFunction(t,e,i){}useTile(t,e,i){const n=zs(t,e,i);this.tileCache.containsKey(n)&&this.tileCache.get(n)}}class pu extends io{constructor(t){super({attributions:t.attributions,cacheSize:t.cacheSize,projection:t.projection,state:t.state,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:Wm,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX,transition:t.transition,interpolate:t.interpolate!==void 0?t.interpolate:!0,key:t.key,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.crossOrigin=t.crossOrigin!==void 0?t.crossOrigin:null,this.tileClass=t.tileClass!==void 0?t.tileClass:ru,this.tileCacheForProjection={},this.tileGridForProjection={},this.reprojectionErrorThreshold_=t.reprojectionErrorThreshold,this.renderReprojectionEdges_=!1}canExpireCache(){if(this.tileCache.canExpireCache())return!0;for(const t in this.tileCacheForProjection)if(this.tileCacheForProjection[t].canExpireCache())return!0;return!1}expireCache(t,e){const i=this.getTileCacheForProjection(t);this.tileCache.expireCache(this.tileCache==i?e:{});for(const n in this.tileCacheForProjection){const r=this.tileCacheForProjection[n];r.expireCache(r==i?e:{})}}getGutterForProjection(t){return this.getProjection()&&t&&!vn(this.getProjection(),t)?0:this.getGutter()}getGutter(){return 0}getKey(){let t=super.getKey();return this.getInterpolate()||(t+=":disable-interpolation"),t}getTileGridForProjection(t){const e=this.getProjection();if(this.tileGrid&&(!e||vn(e,t)))return this.tileGrid;const i=J(t);return i in this.tileGridForProjection||(this.tileGridForProjection[i]=gu(t)),this.tileGridForProjection[i]}getTileCacheForProjection(t){const e=this.getProjection();if(!e||vn(e,t))return this.tileCache;const i=J(t);return i in this.tileCacheForProjection||(this.tileCacheForProjection[i]=new El(this.tileCache.highWaterMark)),this.tileCacheForProjection[i]}createTile_(t,e,i,n,r,o){const a=[t,e,i],l=this.getTileCoordForTileUrlFunction(a,r),h=l?this.tileUrlFunction(l,n,r):void 0,c=new this.tileClass(a,h!==void 0?Y.IDLE:Y.EMPTY,h!==void 0?h:"",this.crossOrigin,this.tileLoadFunction,this.tileOptions);return c.key=o,c.addEventListener(j.CHANGE,this.handleTileChange.bind(this)),c}getTile(t,e,i,n,r){const o=this.getProjection();if(!o||!r||vn(o,r))return this.getTileInternal(t,e,i,n,o||r);const a=this.getTileCacheForProjection(r),l=[t,e,i];let h;const c=uu(l);a.containsKey(c)&&(h=a.get(c));const u=this.getKey();if(h&&h.key==u)return h;const d=this.getTileGridForProjection(o),f=this.getTileGridForProjection(r),m=this.getTileCoordForTileUrlFunction(l,r),p=new cu(o,d,r,f,l,m,this.getTilePixelRatio(n),this.getGutter(),(x,T,_,v)=>this.getTileInternal(x,T,_,v,o),this.reprojectionErrorThreshold_,this.renderReprojectionEdges_,this.tileOptions);return p.key=u,h?a.replace(c,p):a.set(c,p),p}getTileInternal(t,e,i,n,r){const o=zs(t,e,i),a=this.getKey();if(!this.tileCache.containsKey(o)){const h=this.createTile_(t,e,i,n,r,a);return this.tileCache.set(o,h),h}let l=this.tileCache.get(o);return l.key!=a&&(l=this.createTile_(t,e,i,n,r,a),this.tileCache.replace(o,l)),l}setRenderReprojectionEdges(t){if(this.renderReprojectionEdges_!=t){this.renderReprojectionEdges_=t;for(const e in this.tileCacheForProjection)this.tileCacheForProjection[e].clear();this.changed()}}setTileGridForProjection(t,e){const i=Zt(t);if(i){const n=J(i);n in this.tileGridForProjection||(this.tileGridForProjection[n]=e)}}clear(){super.clear();for(const t in this.tileCacheForProjection)this.tileCacheForProjection[t].clear()}}function Wm(s,t){s.getImage().src=t}class jm extends pu{constructor(t){t=t||{};const e=t.projection!==void 0?t.projection:"EPSG:3857",i=t.tileGrid!==void 0?t.tileGrid:mu({extent:eo(e),maxResolution:t.maxResolution,maxZoom:t.maxZoom,minZoom:t.minZoom,tileSize:t.tileSize});super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:e,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileGrid:i,tileLoadFunction:t.tileLoadFunction,tilePixelRatio:t.tilePixelRatio,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,attributionsCollapsible:t.attributionsCollapsible,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0}getGutter(){return this.gutter_}}class jt extends ke{constructor(t){if(super(),this.on,this.once,this.un,this.id_=void 0,this.geometryName_="geometry",this.style_=null,this.styleFunction_=void 0,this.geometryChangeKey_=null,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),t)if(typeof t.getSimplifiedGeometry=="function"){const e=t;this.setGeometry(e)}else{const e=t;this.setProperties(e)}}clone(){const t=new jt(this.hasProperties()?this.getProperties():null);t.setGeometryName(this.getGeometryName());const e=this.getGeometry();e&&t.setGeometry(e.clone());const i=this.getStyle();return i&&t.setStyle(i),t}getGeometry(){return this.get(this.geometryName_)}getId(){return this.id_}getGeometryName(){return this.geometryName_}getStyle(){return this.style_}getStyleFunction(){return this.styleFunction_}handleGeometryChange_(){this.changed()}handleGeometryChanged_(){this.geometryChangeKey_&&(_t(this.geometryChangeKey_),this.geometryChangeKey_=null);const t=this.getGeometry();t&&(this.geometryChangeKey_=at(t,j.CHANGE,this.handleGeometryChange_,this)),this.changed()}setGeometry(t){this.set(this.geometryName_,t)}setStyle(t){this.style_=t,this.styleFunction_=t?Zm(t):void 0,this.changed()}setId(t){this.id_=t,this.changed()}setGeometryName(t){this.removeChangeListener(this.geometryName_,this.handleGeometryChanged_),this.geometryName_=t,this.addChangeListener(this.geometryName_,this.handleGeometryChanged_),this.handleGeometryChanged_()}}function Zm(s){if(typeof s=="function")return s;let t;return Array.isArray(s)?t=s:(lt(typeof s.getZIndex=="function","Expected an `ol/style/Style` or an array of `ol/style/Style.js`"),t=[s]),function(){return t}}class wh{constructor(t){this.rbush_=new Pc(t),this.items_={}}insert(t,e){const i={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3],value:e};this.rbush_.insert(i),this.items_[J(e)]=i}load(t,e){const i=new Array(e.length);for(let n=0,r=e.length;n<r;n++){const o=t[n],a=e[n],l={minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],value:a};i[n]=l,this.items_[J(a)]=l}this.rbush_.load(i)}remove(t){const e=J(t),i=this.items_[e];return delete this.items_[e],this.rbush_.remove(i)!==null}update(t,e){const i=this.items_[J(e)],n=[i.minX,i.minY,i.maxX,i.maxY];bn(n,t)||(this.remove(e),this.insert(t,e))}getAll(){return this.rbush_.all().map(function(e){return e.value})}getInExtent(t){const e={minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]};return this.rbush_.search(e).map(function(n){return n.value})}forEach(t){return this.forEach_(this.getAll(),t)}forEachInExtent(t,e){return this.forEach_(this.getInExtent(t),e)}forEach_(t,e){let i;for(let n=0,r=t.length;n<r;n++)if(i=e(t[n]),i)return i;return i}isEmpty(){return ki(this.items_)}clear(){this.rbush_.clear(),this.items_={}}getExtent(t){const e=this.rbush_.toJSON();return Nn(e.minX,e.minY,e.maxX,e.maxY,t)}concat(t){this.rbush_.load(t.rbush_.all());for(const e in t.items_)this.items_[e]=t.items_[e]}}class no extends Yi{constructor(t,e,i){super(),i!==void 0&&e===void 0?this.setFlatCoordinates(i,t):(e=e||0,this.setCenterAndRadius(t,e,i))}clone(){const t=new no(this.flatCoordinates.slice(),void 0,this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){const r=this.flatCoordinates,o=t-r[0],a=e-r[1],l=o*o+a*a;if(l<n){if(l===0)for(let h=0;h<this.stride;++h)i[h]=r[h];else{const h=this.getRadius()/Math.sqrt(l);i[0]=r[0]+h*o,i[1]=r[1]+h*a;for(let c=2;c<this.stride;++c)i[c]=r[c]}return i.length=this.stride,l}return n}containsXY(t,e){const i=this.flatCoordinates,n=t-i[0],r=e-i[1];return n*n+r*r<=this.getRadiusSquared_()}getCenter(){return this.flatCoordinates.slice(0,this.stride)}computeExtent(t){const e=this.flatCoordinates,i=e[this.stride]-e[0];return Nn(e[0]-i,e[1]-i,e[0]+i,e[1]+i,t)}getRadius(){return Math.sqrt(this.getRadiusSquared_())}getRadiusSquared_(){const t=this.flatCoordinates[this.stride]-this.flatCoordinates[0],e=this.flatCoordinates[this.stride+1]-this.flatCoordinates[1];return t*t+e*e}getType(){return"Circle"}intersectsExtent(t){const e=this.getExtent();if(vt(t,e)){const i=this.getCenter();return t[0]<=i[0]&&t[2]>=i[0]||t[1]<=i[1]&&t[3]>=i[1]?!0:Fa(t,this.intersectsCoordinate.bind(this))}return!1}setCenter(t){const e=this.stride,i=this.flatCoordinates[e]-this.flatCoordinates[0],n=t.slice();n[e]=n[0]+i;for(let r=1;r<e;++r)n[e+r]=t[r];this.setFlatCoordinates(this.layout,n),this.changed()}setCenterAndRadius(t,e,i){this.setLayout(i,t,0),this.flatCoordinates||(this.flatCoordinates=[]);const n=this.flatCoordinates;let r=pc(n,0,t,this.stride);n[r++]=n[0]+e;for(let o=1,a=this.stride;o<a;++o)n[r++]=n[o];n.length=r,this.changed()}getCoordinates(){return null}setCoordinates(t,e){}setRadius(t){this.flatCoordinates[this.stride]=this.flatCoordinates[0]+t,this.changed()}rotate(t,e){const i=this.getCenter(),n=this.getStride();this.setCenter(Qa(i,0,i.length,n,t,e,i)),this.changed()}}no.prototype.transform;let Tl=class ca extends _c{constructor(t){super(),this.geometries_=t,this.changeEventsKeys_=[],this.listenGeometriesChange_()}unlistenGeometriesChange_(){this.changeEventsKeys_.forEach(_t),this.changeEventsKeys_.length=0}listenGeometriesChange_(){const t=this.geometries_;for(let e=0,i=t.length;e<i;++e)this.changeEventsKeys_.push(at(t[e],j.CHANGE,this.changed,this))}clone(){const t=new ca(Fo(this.geometries_));return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<an(this.getExtent(),t,e))return n;const r=this.geometries_;for(let o=0,a=r.length;o<a;++o)n=r[o].closestPointXY(t,e,i,n);return n}containsXY(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)if(i[n].containsXY(t,e))return!0;return!1}computeExtent(t){La(t);const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)ac(t,e[i].getExtent());return t}getGeometries(){return Fo(this.geometries_)}getGeometriesArray(){return this.geometries_}getGeometriesArrayRecursive(){let t=[];const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].getType()===this.getType()?t=t.concat(e[i].getGeometriesArrayRecursive()):t.push(e[i]);return t}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=[],i=this.geometries_;let n=!1;for(let r=0,o=i.length;r<o;++r){const a=i[r],l=a.getSimplifiedGeometry(t);e.push(l),l!==a&&(n=!0)}return n?new ca(e):(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getType(){return"GeometryCollection"}intersectsExtent(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)if(e[i].intersectsExtent(t))return!0;return!1}isEmpty(){return this.geometries_.length===0}rotate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].rotate(t,e);this.changed()}scale(t,e,i){i||(i=ui(this.getExtent()));const n=this.geometries_;for(let r=0,o=n.length;r<o;++r)n[r].scale(t,e,i);this.changed()}setGeometries(t){this.setGeometriesArray(Fo(t))}setGeometriesArray(t){this.unlistenGeometriesChange_(),this.geometries_=t,this.listenGeometriesChange_(),this.changed()}applyTransform(t){const e=this.geometries_;for(let i=0,n=e.length;i<n;++i)e[i].applyTransform(t);this.changed()}translate(t,e){const i=this.geometries_;for(let n=0,r=i.length;n<r;++n)i[n].translate(t,e);this.changed()}disposeInternal(){this.unlistenGeometriesChange_(),super.disposeInternal()}};function Fo(s){return s.map(t=>t.clone())}function Nr(s,t,e,i,n,r,o){let a,l;const h=(e-t)/i;if(h===1)a=t;else if(h===2)a=t,l=n;else if(h!==0){let c=s[t],u=s[t+1],d=0;const f=[0];for(let x=t+i;x<e;x+=i){const T=s[x],_=s[x+1];d+=Math.sqrt((T-c)*(T-c)+(_-u)*(_-u)),f.push(d),c=T,u=_}const m=n*d,p=Xd(f,m);p<0?(l=(m-f[-p-2])/(f[-p-1]-f[-p-2]),a=t+(-p-2)*i):a=t+p*i}o=o>1?o:2,r=r||new Array(o);for(let c=0;c<o;++c)r[c]=a===void 0?NaN:l===void 0?s[a+c]:le(s[a+c],s[a+i+c],l);return r}function ua(s,t,e,i,n,r){if(e==t)return null;let o;if(n<s[t+i-1])return r?(o=s.slice(t,t+i),o[i-1]=n,o):null;if(s[e-1]<n)return r?(o=s.slice(e-i,e),o[i-1]=n,o):null;if(n==s[t+i-1])return s.slice(t,t+i);let a=t/i,l=e/i;for(;a<l;){const d=a+l>>1;n<s[(d+1)*i-1]?l=d:a=d+1}const h=s[a*i-1];if(n==h)return s.slice((a-1)*i,(a-1)*i+i);const c=s[(a+1)*i-1],u=(n-h)/(c-h);o=[];for(let d=0;d<i-1;++d)o.push(le(s[(a-1)*i+d],s[a*i+d],u));return o.push(n),o}function Qm(s,t,e,i,n,r,o){if(o)return ua(s,t,e[e.length-1],i,n,r);let a;if(n<s[i-1])return r?(a=s.slice(0,i),a[i-1]=n,a):null;if(s[s.length-1]<n)return r?(a=s.slice(s.length-i),a[i-1]=n,a):null;for(let l=0,h=e.length;l<h;++l){const c=e[l];if(t!=c){if(n<s[t+i-1])return null;if(n<=s[c-1])return ua(s,t,c,i,n,!1);t=c}}return null}function yu(s,t,e,i){let n=s[t],r=s[t+1],o=0;for(let a=t+i;a<e;a+=i){const l=s[a],h=s[a+1];o+=Math.sqrt((l-n)*(l-n)+(h-r)*(h-r)),n=l,r=h}return o}let ci=class da extends Yi{constructor(t,e){super(),this.flatMidpoint_=null,this.flatMidpointRevision_=-1,this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendCoordinate(t){Ce(this.flatCoordinates,t),this.changed()}clone(){const t=new da(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<an(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(qa(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ja(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!1,t,e,i,n))}forEachSegment(t){return Sc(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinateAtM(t,e){return this.layout!="XYM"&&this.layout!="XYZM"?null:(e=e!==void 0?e:!1,ua(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e))}getCoordinates(){return vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinateAt(t,e){return Nr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,this.stride)}getLength(){return yu(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getFlatMidpoint(){return this.flatMidpointRevision_!=this.getRevision()&&(this.flatMidpoint_=this.getCoordinateAt(.5,this.flatMidpoint_??void 0),this.flatMidpointRevision_=this.getRevision()),this.flatMidpoint_}getSimplifiedGeometryInternal(t){const e=[];return e.length=jr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new da(e,"XY")}getType(){return"LineString"}intersectsExtent(t){return Zr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wr(this.flatCoordinates,0,t,this.stride),this.changed()}},Ys=class fa extends Yi{constructor(t,e,i){if(super(),this.ends_=[],this.maxDelta_=-1,this.maxDeltaRevision_=-1,Array.isArray(t[0]))this.setCoordinates(t,e);else if(e!==void 0&&i)this.setFlatCoordinates(e,t),this.ends_=i;else{const n=t,r=[],o=[];for(let l=0,h=n.length;l<h;++l){const c=n[l];Ce(r,c.getFlatCoordinates()),o.push(r.length)}const a=n.length===0?this.getLayout():n[0].getLayout();this.setFlatCoordinates(a,r),this.ends_=o}}appendLineString(t){Ce(this.flatCoordinates,t.getFlatCoordinates().slice()),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new fa(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,n){return n<an(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ha(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),$a(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!1,t,e,i,n))}getCoordinateAtM(t,e,i){return this.layout!="XYM"&&this.layout!="XYZM"||this.flatCoordinates.length===0?null:(e=e!==void 0?e:!1,i=i!==void 0?i:!1,Qm(this.flatCoordinates,0,this.ends_,this.stride,t,e,i))}getCoordinates(){return ps(this.flatCoordinates,0,this.ends_,this.stride)}getEnds(){return this.ends_}getLineString(t){return t<0||this.ends_.length<=t?null:new ci(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLineStrings(){const t=this.flatCoordinates,e=this.ends_,i=this.layout,n=[];let r=0;for(let o=0,a=e.length;o<a;++o){const l=e[o],h=new ci(t.slice(r,l),i);n.push(h),r=l}return n}getFlatMidpoints(){const t=[],e=this.flatCoordinates;let i=0;const n=this.ends_,r=this.stride;for(let o=0,a=n.length;o<a;++o){const l=n[o],h=Nr(e,i,l,r,.5);Ce(t,h),i=l}return t}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=xc(this.flatCoordinates,0,this.ends_,this.stride,t,e,0,i),new fa(e,"XY",i)}getType(){return"MultiLineString"}intersectsExtent(t){return _f(this.flatCoordinates,0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=ks(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}},Us=class xu extends Yi{constructor(t,e){super(),e&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}appendPoint(t){Ce(this.flatCoordinates,t.getFlatCoordinates()),this.changed()}clone(){const t=new xu(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,n){if(n<an(this.getExtent(),t,e))return n;const r=this.flatCoordinates,o=this.stride;for(let a=0,l=r.length;a<l;a+=o){const h=Pi(t,e,r[a],r[a+1]);if(h<n){n=h;for(let c=0;c<o;++c)i[c]=r[a+c];i.length=o}}return n}getCoordinates(){return vi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getPoint(t){const e=this.flatCoordinates.length/this.stride;return t<0||e<=t?null:new ue(this.flatCoordinates.slice(t*this.stride,(t+1)*this.stride),this.layout)}getPoints(){const t=this.flatCoordinates,e=this.layout,i=this.stride,n=[];for(let r=0,o=t.length;r<o;r+=i){const a=new ue(t.slice(r,r+i),e);n.push(a)}return n}getType(){return"MultiPoint"}intersectsExtent(t){const e=this.flatCoordinates,i=this.stride;for(let n=0,r=e.length;n<r;n+=i){const o=e[n],a=e[n+1];if(Jh(t,o,a))return!0}return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Wr(this.flatCoordinates,0,t,this.stride),this.changed()}};function Eu(s,t,e,i){const n=[];let r=Se();for(let o=0,a=e.length;o<a;++o){const l=e[o];r=Ma(s,t,l[0],i),n.push((r[0]+r[2])/2,(r[1]+r[3])/2),t=l[l.length-1]}return n}let Xs=class ga extends Yi{constructor(t,e,i){if(super(),this.endss_=[],this.flatInteriorPointsRevision_=-1,this.flatInteriorPoints_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,!i&&!Array.isArray(t[0])){const n=t,r=[],o=[];for(let a=0,l=n.length;a<l;++a){const h=n[a],c=r.length,u=h.getEnds();for(let d=0,f=u.length;d<f;++d)u[d]+=c;Ce(r,h.getFlatCoordinates()),o.push(u)}e=n.length===0?this.getLayout():n[0].getLayout(),t=r,i=o}e!==void 0&&i?(this.setFlatCoordinates(e,t),this.endss_=i):this.setCoordinates(t,e)}appendPolygon(t){let e;if(!this.flatCoordinates)this.flatCoordinates=t.getFlatCoordinates().slice(),e=t.getEnds().slice(),this.endss_.push();else{const i=this.flatCoordinates.length;Ce(this.flatCoordinates,t.getFlatCoordinates()),e=t.getEnds().slice();for(let n=0,r=e.length;n<r;++n)e[n]+=i}this.endss_.push(e),this.changed()}clone(){const t=this.endss_.length,e=new Array(t);for(let n=0;n<t;++n)e[n]=this.endss_[n].slice();const i=new ga(this.flatCoordinates.slice(),this.layout,e);return i.applyProperties(this),i}closestPointXY(t,e,i,n){return n<an(this.getExtent(),t,e)?n:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(cf(this.flatCoordinates,0,this.endss_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),uf(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,this.maxDelta_,!0,t,e,i,n))}containsXY(t,e){return Af(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t,e)}getArea(){return gf(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Jo(e,0,this.endss_,this.stride,t)):e=this.flatCoordinates,Qo(e,0,this.endss_,this.stride)}getEndss(){return this.endss_}getFlatInteriorPoints(){if(this.flatInteriorPointsRevision_!=this.getRevision()){const t=Eu(this.flatCoordinates,0,this.endss_,this.stride);this.flatInteriorPoints_=Tc(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t),this.flatInteriorPointsRevision_=this.getRevision()}return this.flatInteriorPoints_}getInteriorPoints(){return new Us(this.getFlatInteriorPoints().slice(),"XYM")}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;vc(t,0,this.endss_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Jo(this.orientedFlatCoordinates_,0,this.endss_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=ff(this.flatCoordinates,0,this.endss_,this.stride,Math.sqrt(t),e,0,i),new ga(e,"XY",i)}getPolygon(t){if(t<0||this.endss_.length<=t)return null;let e;if(t===0)e=0;else{const r=this.endss_[t-1];e=r[r.length-1]}const i=this.endss_[t].slice(),n=i[i.length-1];if(e!==0)for(let r=0,o=i.length;r<o;++r)i[r]-=e;return new Oe(this.flatCoordinates.slice(e,n),this.layout,i)}getPolygons(){const t=this.layout,e=this.flatCoordinates,i=this.endss_,n=[];let r=0;for(let o=0,a=i.length;o<a;++o){const l=i[o].slice(),h=l[l.length-1];if(r!==0)for(let u=0,d=l.length;u<d;++u)l[u]-=r;const c=new Oe(e.slice(r,h),t,l);n.push(c),r=h}return n}getType(){return"MultiPolygon"}intersectsExtent(t){return pf(this.getOrientedFlatCoordinates(),0,this.endss_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,3),this.flatCoordinates||(this.flatCoordinates=[]);const i=yc(this.flatCoordinates,0,t,this.stride,this.endss_);if(i.length===0)this.flatCoordinates.length=0;else{const n=i[i.length-1];this.flatCoordinates.length=n.length===0?0:n[n.length-1]}this.changed()}};const Th=we();class $t{constructor(t,e,i,n,r,o){this.styleFunction,this.extent_,this.id_=o,this.type_=t,this.flatCoordinates_=e,this.flatInteriorPoints_=null,this.flatMidpoints_=null,this.ends_=i||null,this.properties_=r,this.squaredTolerance_,this.stride_=n,this.simplifiedGeometry_}get(t){return this.properties_[t]}getExtent(){return this.extent_||(this.extent_=this.type_==="Point"?Pa(this.flatCoordinates_):Ma(this.flatCoordinates_,0,this.flatCoordinates_.length,2)),this.extent_}getFlatInteriorPoint(){if(!this.flatInteriorPoints_){const t=ui(this.getExtent());this.flatInteriorPoints_=il(this.flatCoordinates_,0,this.ends_,2,t,0)}return this.flatInteriorPoints_}getFlatInteriorPoints(){if(!this.flatInteriorPoints_){const t=Lc(this.flatCoordinates_,this.ends_),e=Eu(this.flatCoordinates_,0,t,2);this.flatInteriorPoints_=Tc(this.flatCoordinates_,0,t,2,e)}return this.flatInteriorPoints_}getFlatMidpoint(){return this.flatMidpoints_||(this.flatMidpoints_=Nr(this.flatCoordinates_,0,this.flatCoordinates_.length,2,.5)),this.flatMidpoints_}getFlatMidpoints(){if(!this.flatMidpoints_){this.flatMidpoints_=[];const t=this.flatCoordinates_;let e=0;const i=this.ends_;for(let n=0,r=i.length;n<r;++n){const o=i[n],a=Nr(t,e,o,2,.5);Ce(this.flatMidpoints_,a),e=o}}return this.flatMidpoints_}getId(){return this.id_}getOrientedFlatCoordinates(){return this.flatCoordinates_}getGeometry(){return this}getSimplifiedGeometry(t){return this}simplifyTransformed(t,e){return this}getProperties(){return this.properties_}getPropertiesInternal(){return this.properties_}getStride(){return this.stride_}getStyleFunction(){return this.styleFunction}getType(){return this.type_}transform(t){t=Zt(t);const e=t.getExtent(),i=t.getWorldExtent();if(e&&i){const n=Wt(i)/Wt(e);di(Th,i[0],i[3],n,-n,0,0,0),bi(this.flatCoordinates_,0,this.flatCoordinates_.length,2,Th,this.flatCoordinates_)}}applyTransform(t){t(this.flatCoordinates_,this.flatCoordinates_,this.stride_)}clone(){var t;return new $t(this.type_,this.flatCoordinates_.slice(),(t=this.ends_)==null?void 0:t.slice(),this.stride_,Object.assign({},this.properties_),this.id_)}getEnds(){return this.ends_}enableSimplifyTransformed(){return this.simplifyTransformed=cc((t,e)=>{if(t===this.squaredTolerance_)return this.simplifiedGeometry_;this.simplifiedGeometry_=this.clone(),e&&this.simplifiedGeometry_.applyTransform(e);const i=this.simplifiedGeometry_.getFlatCoordinates();let n;switch(this.type_){case"LineString":i.length=jr(i,0,this.simplifiedGeometry_.flatCoordinates_.length,this.simplifiedGeometry_.stride_,t,i,0),n=[i.length];break;case"MultiLineString":n=[],i.length=xc(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,t,i,0,n);break;case"Polygon":n=[],i.length=tl(i,0,this.simplifiedGeometry_.ends_,this.simplifiedGeometry_.stride_,Math.sqrt(t),i,0,n);break}return n&&(this.simplifiedGeometry_=new $t(this.type_,i,n,2,this.properties_,this.id_)),this.squaredTolerance_=t,this.simplifiedGeometry_}),this}}$t.prototype.getFlatCoordinates=$t.prototype.getOrientedFlatCoordinates;const _e={ADDFEATURE:"addfeature",CHANGEFEATURE:"changefeature",CLEAR:"clear",REMOVEFEATURE:"removefeature",FEATURESLOADSTART:"featuresloadstart",FEATURESLOADEND:"featuresloadend",FEATURESLOADERROR:"featuresloaderror"};function qm(s,t){return[[-1/0,-1/0,1/0,1/0]]}function Cu(s,t){return[s]}let Hm=!1;function wu(s,t,e,i,n,r,o){const a=new XMLHttpRequest;a.open("GET",typeof s=="function"?s(e,i,n):s,!0),t.getType()=="arraybuffer"&&(a.responseType="arraybuffer"),a.withCredentials=Hm,a.onload=function(l){if(!a.status||a.status>=200&&a.status<300){const h=t.getType();try{let c;h=="text"||h=="json"?c=a.responseText:h=="xml"?c=a.responseXML||a.responseText:h=="arraybuffer"&&(c=a.response),c?r(t.readFeatures(c,{extent:e,featureProjection:n}),t.readProjection(c)):o()}catch{o()}}else o()},a.onerror=o,a.send()}function Sh(s,t){return function(e,i,n,r,o){const a=this;wu(s,t,e,i,n,function(l,h){a.addFeatures(l),r!==void 0&&r(l)},o||kn)}}class xi extends De{constructor(t,e,i){super(t),this.feature=e,this.features=i}}class Ge extends fu{constructor(t){t=t||{},super({attributions:t.attributions,interpolate:!0,projection:void 0,state:"ready",wrapX:t.wrapX!==void 0?t.wrapX:!0}),this.on,this.once,this.un,this.loader_=kn,this.format_=t.format||null,this.overlaps_=t.overlaps===void 0?!0:t.overlaps,this.url_=t.url,t.loader!==void 0?this.loader_=t.loader:this.url_!==void 0&&(lt(this.format_,"`format` must be set when `url` is set"),this.loader_=Sh(this.url_,this.format_)),this.strategy_=t.strategy!==void 0?t.strategy:qm;const e=t.useSpatialIndex!==void 0?t.useSpatialIndex:!0;this.featuresRtree_=e?new wh:null,this.loadedExtentsRtree_=new wh,this.loadingExtentsCount_=0,this.nullGeometryFeatures_={},this.idIndex_={},this.uidIndex_={},this.featureChangeKeys_={},this.featuresCollection_=null;let i,n;Array.isArray(t.features)?n=t.features:t.features&&(i=t.features,n=i.getArray()),!e&&i===void 0&&(i=new Fe(n)),n!==void 0&&this.addFeaturesInternal(n),i!==void 0&&this.bindFeaturesCollection_(i)}addFeature(t){this.addFeatureInternal(t),this.changed()}addFeatureInternal(t){const e=J(t);if(!this.addToIndex_(e,t)){this.featuresCollection_&&this.featuresCollection_.remove(t);return}this.setupChangeEvents_(e,t);const i=t.getGeometry();if(i){const n=i.getExtent();this.featuresRtree_&&this.featuresRtree_.insert(n,t)}else this.nullGeometryFeatures_[e]=t;this.dispatchEvent(new xi(_e.ADDFEATURE,t))}setupChangeEvents_(t,e){e instanceof $t||(this.featureChangeKeys_[t]=[at(e,j.CHANGE,this.handleFeatureChange_,this),at(e,Dn.PROPERTYCHANGE,this.handleFeatureChange_,this)])}addToIndex_(t,e){let i=!0;if(e.getId()!==void 0){const n=String(e.getId());if(!(n in this.idIndex_))this.idIndex_[n]=e;else if(e instanceof $t){const r=this.idIndex_[n];r instanceof $t?Array.isArray(r)?r.push(e):this.idIndex_[n]=[r,e]:i=!1}else i=!1}return i&&(lt(!(t in this.uidIndex_),"The passed `feature` was already added to the source"),this.uidIndex_[t]=e),i}addFeatures(t){this.addFeaturesInternal(t),this.changed()}addFeaturesInternal(t){const e=[],i=[],n=[];for(let r=0,o=t.length;r<o;r++){const a=t[r],l=J(a);this.addToIndex_(l,a)&&i.push(a)}for(let r=0,o=i.length;r<o;r++){const a=i[r],l=J(a);this.setupChangeEvents_(l,a);const h=a.getGeometry();if(h){const c=h.getExtent();e.push(c),n.push(a)}else this.nullGeometryFeatures_[l]=a}if(this.featuresRtree_&&this.featuresRtree_.load(e,n),this.hasListener(_e.ADDFEATURE))for(let r=0,o=i.length;r<o;r++)this.dispatchEvent(new xi(_e.ADDFEATURE,i[r]))}bindFeaturesCollection_(t){let e=!1;this.addEventListener(_e.ADDFEATURE,function(i){e||(e=!0,t.push(i.feature),e=!1)}),this.addEventListener(_e.REMOVEFEATURE,function(i){e||(e=!0,t.remove(i.feature),e=!1)}),t.addEventListener(Dt.ADD,i=>{e||(e=!0,this.addFeature(i.element),e=!1)}),t.addEventListener(Dt.REMOVE,i=>{e||(e=!0,this.removeFeature(i.element),e=!1)}),this.featuresCollection_=t}clear(t){if(t){for(const i in this.featureChangeKeys_)this.featureChangeKeys_[i].forEach(_t);this.featuresCollection_||(this.featureChangeKeys_={},this.idIndex_={},this.uidIndex_={})}else if(this.featuresRtree_){const i=n=>{this.removeFeatureInternal(n)};this.featuresRtree_.forEach(i);for(const n in this.nullGeometryFeatures_)this.removeFeatureInternal(this.nullGeometryFeatures_[n])}this.featuresCollection_&&this.featuresCollection_.clear(),this.featuresRtree_&&this.featuresRtree_.clear(),this.nullGeometryFeatures_={};const e=new xi(_e.CLEAR);this.dispatchEvent(e),this.changed()}forEachFeature(t){if(this.featuresRtree_)return this.featuresRtree_.forEach(t);this.featuresCollection_&&this.featuresCollection_.forEach(t)}forEachFeatureAtCoordinateDirect(t,e){const i=[t[0],t[1],t[0],t[1]];return this.forEachFeatureInExtent(i,function(n){const r=n.getGeometry();if(r instanceof $t||r.intersectsCoordinate(t))return e(n)})}forEachFeatureInExtent(t,e){if(this.featuresRtree_)return this.featuresRtree_.forEachInExtent(t,e);this.featuresCollection_&&this.featuresCollection_.forEach(e)}forEachFeatureIntersectingExtent(t,e){return this.forEachFeatureInExtent(t,function(i){const n=i.getGeometry();if(n instanceof $t||n.intersectsExtent(t)){const r=e(i);if(r)return r}})}getFeaturesCollection(){return this.featuresCollection_}getFeatures(){let t;return this.featuresCollection_?t=this.featuresCollection_.getArray().slice(0):this.featuresRtree_&&(t=this.featuresRtree_.getAll(),ki(this.nullGeometryFeatures_)||Ce(t,Object.values(this.nullGeometryFeatures_))),t}getFeaturesAtCoordinate(t){const e=[];return this.forEachFeatureAtCoordinateDirect(t,function(i){e.push(i)}),e}getFeaturesInExtent(t,e){if(this.featuresRtree_){if(!(e&&e.canWrapX()&&this.getWrapX()))return this.featuresRtree_.getInExtent(t);const n=Ga(t,e);return[].concat(...n.map(r=>this.featuresRtree_.getInExtent(r)))}return this.featuresCollection_?this.featuresCollection_.getArray().slice(0):[]}getClosestFeatureToCoordinate(t,e){const i=t[0],n=t[1];let r=null;const o=[NaN,NaN];let a=1/0;const l=[-1/0,-1/0,1/0,1/0];return e=e||Di,this.featuresRtree_.forEachInExtent(l,function(h){if(e(h)){const c=h.getGeometry(),u=a;if(a=c instanceof $t?0:c.closestPointXY(i,n,o,a),a<u){r=h;const d=Math.sqrt(a);l[0]=i-d,l[1]=n-d,l[2]=i+d,l[3]=n+d}}}),r}getExtent(t){return this.featuresRtree_.getExtent(t)}getFeatureById(t){const e=this.idIndex_[t.toString()];return e!==void 0?e:null}getFeatureByUid(t){const e=this.uidIndex_[t];return e!==void 0?e:null}getFormat(){return this.format_}getOverlaps(){return this.overlaps_}getUrl(){return this.url_}handleFeatureChange_(t){const e=t.target,i=J(e),n=e.getGeometry();if(!n)i in this.nullGeometryFeatures_||(this.featuresRtree_&&this.featuresRtree_.remove(e),this.nullGeometryFeatures_[i]=e);else{const o=n.getExtent();i in this.nullGeometryFeatures_?(delete this.nullGeometryFeatures_[i],this.featuresRtree_&&this.featuresRtree_.insert(o,e)):this.featuresRtree_&&this.featuresRtree_.update(o,e)}const r=e.getId();if(r!==void 0){const o=r.toString();this.idIndex_[o]!==e&&(this.removeFromIdIndex_(e),this.idIndex_[o]=e)}else this.removeFromIdIndex_(e),this.uidIndex_[i]=e;this.changed(),this.dispatchEvent(new xi(_e.CHANGEFEATURE,e))}hasFeature(t){const e=t.getId();return e!==void 0?e in this.idIndex_:J(t)in this.uidIndex_}isEmpty(){return this.featuresRtree_?this.featuresRtree_.isEmpty()&&ki(this.nullGeometryFeatures_):this.featuresCollection_?this.featuresCollection_.getLength()===0:!0}loadFeatures(t,e,i){const n=this.loadedExtentsRtree_,r=this.strategy_(t,e,i);for(let o=0,a=r.length;o<a;++o){const l=r[o];n.forEachInExtent(l,function(c){return Ri(c.extent,l)})||(++this.loadingExtentsCount_,this.dispatchEvent(new xi(_e.FEATURESLOADSTART)),this.loader_.call(this,l,e,i,c=>{--this.loadingExtentsCount_,this.dispatchEvent(new xi(_e.FEATURESLOADEND,void 0,c))},()=>{--this.loadingExtentsCount_,this.dispatchEvent(new xi(_e.FEATURESLOADERROR))}),n.insert(l,{extent:l.slice()}))}this.loading=this.loader_.length<4?!1:this.loadingExtentsCount_>0}refresh(){this.clear(!0),this.loadedExtentsRtree_.clear(),super.refresh()}removeLoadedExtent(t){const e=this.loadedExtentsRtree_;let i;e.forEachInExtent(t,function(n){if(bn(n.extent,t))return i=n,!0}),i&&e.remove(i)}removeFeatures(t){let e=!1;for(let i=0,n=t.length;i<n;++i)e=this.removeFeatureInternal(t[i])||e;e&&this.changed()}removeFeature(t){if(!t)return;this.removeFeatureInternal(t)&&this.changed()}removeFeatureInternal(t){const e=J(t);if(!(e in this.uidIndex_))return!1;e in this.nullGeometryFeatures_?delete this.nullGeometryFeatures_[e]:this.featuresRtree_&&this.featuresRtree_.remove(t);const i=this.featureChangeKeys_[e];i==null||i.forEach(_t),delete this.featureChangeKeys_[e];const n=t.getId();if(n!==void 0){const r=n.toString(),o=this.idIndex_[r];o===t?delete this.idIndex_[r]:Array.isArray(o)&&(o.splice(o.indexOf(t),1),o.length===1&&(this.idIndex_[r]=o[0]))}return delete this.uidIndex_[e],this.hasListener(_e.REMOVEFEATURE)&&this.dispatchEvent(new xi(_e.REMOVEFEATURE,t)),!0}removeFromIdIndex_(t){for(const e in this.idIndex_)if(this.idIndex_[e]===t){delete this.idIndex_[e];break}}setLoader(t){this.loader_=t}setUrl(t){lt(this.format_,"`format` must be set when `url` is set"),this.url_=t,this.setLoader(Sh(t,this.format_))}}class Tu extends Ge{constructor(t){t=t||{},super({attributions:t.attributions,wrapX:t.wrapX}),this.resolution=void 0,this.distance=t.distance!==void 0?t.distance:20,this.minDistance=t.minDistance||0,this.interpolationRatio=0,this.features=[],this.geometryFunction=t.geometryFunction||function(e){const i=e.getGeometry();return lt(!i||i.getType()==="Point","The default `geometryFunction` can only handle `Point` or null geometries"),i},this.createCustomCluster_=t.createCluster,this.source=null,this.boundRefresh_=this.refresh.bind(this),this.updateDistance(this.distance,this.minDistance),this.setSource(t.source||null)}clear(t){this.features.length=0,super.clear(t)}getDistance(){return this.distance}getSource(){return this.source}loadFeatures(t,e,i){var n;(n=this.source)==null||n.loadFeatures(t,e,i),e!==this.resolution&&(this.resolution=e,this.refresh())}setDistance(t){this.updateDistance(t,this.minDistance)}setMinDistance(t){this.updateDistance(this.distance,t)}getMinDistance(){return this.minDistance}setSource(t){this.source&&this.source.removeEventListener(j.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(j.CHANGE,this.boundRefresh_),this.refresh()}refresh(){this.clear(),this.cluster(),this.addFeatures(this.features)}updateDistance(t,e){const i=t===0?0:Math.min(e,t)/t,n=t!==this.distance||this.interpolationRatio!==i;this.distance=t,this.minDistance=e,this.interpolationRatio=i,n&&this.refresh()}cluster(){if(this.resolution===void 0||!this.source)return;const t=Se(),e=this.distance*this.resolution,i=this.source.getFeatures(),n={};for(let r=0,o=i.length;r<o;r++){const a=i[r];if(!(J(a)in n)){const l=this.geometryFunction(a);if(l){const h=l.getCoordinates();Pa(h,t),be(t,e,t);const c=this.source.getFeaturesInExtent(t).filter(function(u){const d=J(u);return d in n?!1:(n[d]=!0,!0)});this.features.push(this.createCluster(c,t))}}}}createCluster(t,e){const i=[0,0];for(let a=t.length-1;a>=0;--a){const l=this.geometryFunction(t[a]);l?$h(i,l.getCoordinates()):t.splice(a,1)}ec(i,1/t.length);const n=ui(e),r=this.interpolationRatio,o=new ue([i[0]*(1-r)+n[0]*r,i[1]*(1-r)+n[1]*r]);return this.createCustomCluster_?this.createCustomCluster_(o,t):new jt({geometry:o,features:t})}}function Dr(s){return s instanceof Image||s instanceof HTMLCanvasElement||s instanceof HTMLVideoElement||s instanceof ImageBitmap?s:null}function Jm(s){return s instanceof Uint8Array||s instanceof Uint8ClampedArray||s instanceof Float32Array||s instanceof DataView?s:null}const $m=new Error("disposed");let En=null;function t0(s){En||(En=Rt(s.width,s.height,void 0,{willReadFrequently:!0}));const t=En.canvas,e=s.width;t.width!==e&&(t.width=e);const i=s.height;return t.height!==i&&(t.height=i),En.clearRect(0,0,e,i),En.drawImage(s,0,0),En.getImageData(0,0,e,i).data}const e0=[256,256];class ma extends Bs{constructor(t){const e=Y.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=Dr(this.data_);return t?[t.width,t.height]:e0}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==Y.IDLE&&this.state!==Y.ERROR)return;this.state=Y.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=Y.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=Y.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort($m),this.controller_=null),super.disposeInternal()}}class i0 extends ma{constructor(t){super({tileCoord:t.tileCoord,loader:()=>Promise.resolve(new Uint8ClampedArray(4)),interpolate:t.interpolate,transition:t.transition}),this.pixelRatio_=t.pixelRatio,this.gutter_=t.gutter,this.reprojData_=null,this.reprojError_=null,this.reprojSize_=void 0,this.sourceTileGrid_=t.sourceTileGrid,this.targetTileGrid_=t.targetTileGrid,this.wrappedTileCoord_=t.wrappedTileCoord||t.tileCoord,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0;const e=t.sourceProj,i=e.getExtent(),n=t.sourceTileGrid.getExtent();this.clipExtent_=e.canWrapX()?n?ce(i,n):i:n;const r=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_),o=this.targetTileGrid_.getExtent();let a=this.sourceTileGrid_.getExtent();const l=o?ce(r,o):r;if(_s(l)===0){this.state=Y.EMPTY;return}i&&(a?a=ce(a,i):a=i);const h=this.targetTileGrid_.getResolution(this.wrappedTileCoord_[0]),c=t.targetProj,u=lu(e,c,l,h);if(!isFinite(u)||u<=0){this.state=Y.EMPTY;return}const d=t.errorThreshold!==void 0?t.errorThreshold:ou;if(this.triangulation_=new au(e,c,l,a,u*d,h),this.triangulation_.getTriangles().length===0){this.state=Y.EMPTY;return}this.sourceZ_=this.sourceTileGrid_.getZForResolution(u);let f=this.triangulation_.calculateSourceExtent();if(a&&(e.canWrapX()?(f[1]=wt(f[1],a[1],a[3]),f[3]=wt(f[3],a[1],a[3])):f=ce(f,a)),!_s(f))this.state=Y.EMPTY;else{let m=0,p=0;e.canWrapX()&&(m=yt(i),p=Math.floor((f[0]-i[0])/m)),Ga(f.slice(),e,!0).forEach(T=>{const _=this.sourceTileGrid_.getTileRangeForExtentAndZ(T,this.sourceZ_),v=t.getTileFunction;for(let P=_.minX;P<=_.maxX;P++)for(let F=_.minY;F<=_.maxY;F++){const k=v(this.sourceZ_,P,F,this.pixelRatio_);if(k){const O=p*m;this.sourceTiles_.push({tile:k,offset:O})}}++p}),this.sourceTiles_.length===0&&(this.state=Y.EMPTY)}}getSize(){return this.reprojSize_}getData(){return this.reprojData_}getError(){return this.reprojError_}reproject_(){const t=[];let e=!1;if(this.sourceTiles_.forEach(m=>{var M;const p=m.tile;if(!p||p.getState()!==Y.LOADED)return;const x=p.getSize(),T=this.gutter_;let _;const v=Jm(p.getData());v?_=v:(e=!0,_=t0(Dr(p.getData())));const P=[x[0]+2*T,x[1]+2*T],F=_ instanceof Float32Array,k=P[0]*P[1],O=F?Float32Array:Uint8ClampedArray,g=new O(_.buffer),A=O.BYTES_PER_ELEMENT,y=A*g.length/k,S=g.byteLength/P[1],C=Math.floor(S/A/P[0]),I=k*C;let R=g;if(g.length!==I){R=new O(I);let L=0,b=0;const B=P[0]*C;for(let z=0;z<P[1];++z){for(let X=0;X<B;++X)R[L++]=g[b+X];b+=S/A}}const w=this.sourceTileGrid_.getTileCoordExtent(p.tileCoord);w[0]+=m.offset,w[2]+=m.offset;const E=(M=this.clipExtent_)==null?void 0:M.slice();E&&(E[0]+=m.offset,E[2]+=m.offset),t.push({extent:w,clipExtent:E,data:new Uint8ClampedArray(R.buffer),dataType:O,bytesPerPixel:y,pixelSize:P})}),this.sourceTiles_.length=0,t.length===0){this.state=Y.ERROR,this.changed();return}const i=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(i),r=typeof n=="number"?n:n[0],o=typeof n=="number"?n:n[1],a=this.targetTileGrid_.getResolution(i),l=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);let c,u;const d=t[0].bytesPerPixel,f=Math.ceil(d/3);for(let m=f-1;m>=0;--m){const p=[];for(let F=0,k=t.length;F<k;++F){const O=t[F],g=O.data,A=O.pixelSize,y=A[0],S=A[1],C=Rt(y,S,hi),I=C.createImageData(y,S),R=I.data;let w=m*3;for(let E=0,M=R.length;E<M;E+=4)R[E]=g[w],R[E+1]=g[w+1],R[E+2]=g[w+2],R[E+3]=255,w+=d;C.putImageData(I,0,0),p.push({extent:O.extent,clipExtent:O.clipExtent,image:C.canvas})}const x=hu(r,o,this.pixelRatio_,l,this.sourceTileGrid_.getExtent(),a,h,this.triangulation_,p,this.gutter_,!1,!1,!1);for(let F=0,k=p.length;F<k;++F){const g=p[F].image.getContext("2d");sn(g),hi.push(g.canvas)}const T=x.getContext("2d"),_=T.getImageData(0,0,x.width,x.height);sn(T),hi.push(x),c||(u=new Uint8ClampedArray(d*_.width*_.height),c=new t[0].dataType(u.buffer));const v=_.data;let P=m*3;for(let F=0,k=v.length;F<k;F+=4)v[F+3]===255?(u[P]=v[F],u[P+1]=v[F+1],u[P+2]=v[F+2]):(u[P]=0,u[P+1]=0,u[P+2]=0),P+=d}if(e){const m=Rt(r,o),p=new ImageData(c,r);m.putImageData(p,0,0),this.reprojData_=m.canvas}else this.reprojData_=c;this.reprojSize_=[Math.round(r*this.pixelRatio_),Math.round(o*this.pixelRatio_)],this.state=Y.LOADED,this.changed()}load(){if(this.state!==Y.IDLE&&this.state!==Y.ERROR)return;this.state=Y.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const i=e.getState();if(i!==Y.IDLE&&i!==Y.LOADING)return;t++;const n=at(e,j.CHANGE,()=>{const r=e.getState();(r==Y.LOADED||r==Y.ERROR||r==Y.EMPTY)&&(_t(n),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(n)}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e}){e.getState()==Y.IDLE&&e.load()})}unlistenSources_(){this.sourcesListenerKeys_.forEach(_t),this.sourcesListenerKeys_=null}}const Rh=4,Aa="1.3.0";function n0(s,t,e,i,n){n.WIDTH=e[0],n.HEIGHT=e[1];const r=i.getAxisOrientation(),o=fc(n.VERSION,"1.3")>=0;n[o?"CRS":"SRS"]=i.getCode();const a=o&&r.startsWith("ne")?[t[1],t[0],t[3],t[2]]:t;return n.BBOX=a.join(","),_u(s,n)}function s0(s,t,e,i,n,r,o){r=Object.assign({REQUEST:"GetMap"},r);const a=t/e,l=[Vl(yt(s)/a,Rh),Vl(Wt(s)/a,Rh)];if(e!=1)switch(o){case"geoserver":const c=90*e+.5|0;"FORMAT_OPTIONS"in r?r.FORMAT_OPTIONS+=";dpi:"+c:r.FORMAT_OPTIONS="dpi:"+c;break;case"mapserver":r.MAP_RESOLUTION=90*e;break;case"carmentaserver":case"qgis":r.DPI=90*e;break;default:throw new Error("Unknown `serverType` configured")}return n0(n,s,l,i,r)}function Ih(s,t){return Object.assign({REQUEST:t,SERVICE:"WMS",VERSION:Aa,FORMAT:"image/png",STYLES:"",TRANSPARENT:!0},s)}let r0=class extends Bs{constructor(t,e,i,n,r,o){super(t,e,o),this.extent=null,this.format_=n,this.features_=null,this.loader_,this.projection=null,this.resolution,this.tileLoadFunction_=r,this.url_=i,this.key=i}getFormat(){return this.format_}getFeatures(){return this.features_}load(){this.state==Y.IDLE&&(this.setState(Y.LOADING),this.tileLoadFunction_(this,this.url_),this.loader_&&this.loader_(this.extent,this.resolution,this.projection))}onLoad(t,e){this.setFeatures(t)}onError(){this.setState(Y.ERROR)}setFeatures(t){this.features_=t,this.setState(Y.LOADED)}setLoader(t){this.loader_=t}};const vh=[];class o0 extends Bs{constructor(t,e,i,n){super(t,e,{transition:0}),this.context_=null,this.executorGroups=[],this.loadingSourceTiles=0,this.hitDetectionImageData={},this.replayState_={},this.sourceTiles=[],this.errorTileKeys={},this.wantedResolution,this.getSourceTiles=n.bind(void 0,this),this.wrappedTileCoord=i}getContext(){return this.context_||(this.context_=Rt(1,1,vh)),this.context_}hasContext(){return!!this.context_}getImage(){return this.hasContext()?this.getContext().canvas:null}getReplayState(t){const e=J(t);return e in this.replayState_||(this.replayState_[e]={dirty:!1,renderedRenderOrder:null,renderedResolution:NaN,renderedRevision:-1,renderedTileResolution:NaN,renderedTileRevision:-1,renderedTileZ:-1}),this.replayState_[e]}load(){this.getSourceTiles()}release(){sn(this.context_),vh.push(this.context_.canvas),this.context_=null,super.release()}}class a0 extends io{constructor(t){const e=t.projection||"EPSG:3857",i=t.extent||eo(e),n=t.tileGrid||mu({extent:i,maxResolution:t.maxResolution,maxZoom:t.maxZoom!==void 0?t.maxZoom:22,minZoom:t.minZoom,tileSize:t.tileSize||512});super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,interpolate:!0,projection:e,state:t.state,tileGrid:n,tileLoadFunction:t.tileLoadFunction?t.tileLoadFunction:l0,tileUrlFunction:t.tileUrlFunction,url:t.url,urls:t.urls,wrapX:t.wrapX===void 0?!0:t.wrapX,transition:t.transition,zDirection:t.zDirection===void 0?1:t.zDirection}),this.format_=t.format?t.format:null,this.sourceTileCache_=new El(128),this.overlaps_=t.overlaps==null?!0:t.overlaps,this.tileClass=t.tileClass?t.tileClass:r0,this.tileGrids_={}}getOverlaps(){return this.overlaps_}clear(){this.sourceTileCache_.clear()}expireCache(t,e){const i=this.getTileCacheForProjection(t),n=Object.keys(e).reduce((r,o)=>{const a=vm(o),l=i.peek(a);if(l){const h=l.sourceTiles;for(let c=0,u=h.length;c<u;++c)r[h[c].getKey()]=!0}return r},{});super.expireCache(t,e),this.sourceTileCache_.expireCache(n)}getSourceTiles(t,e,i){if(i.getState()===Y.IDLE){i.setState(Y.LOADING);const n=i.wrappedTileCoord,r=this.getTileGridForProjection(e),o=r.getTileCoordExtent(n),a=n[0],l=r.getResolution(a);be(o,-l,o);const h=this.tileGrid,c=h.getExtent();c&&ce(o,c,o);const u=h.getZForResolution(l,this.zDirection);h.forEachTileCoord(o,u,d=>{const f=this.tileUrlFunction(d,t,e),m=this.sourceTileCache_.containsKey(f)?this.sourceTileCache_.get(f):new this.tileClass(d,f?Y.IDLE:Y.EMPTY,f,this.format_,this.tileLoadFunction);i.sourceTiles.push(m);const p=m.getState();if(p<Y.LOADED){const x=T=>{this.handleTileChange(T);const _=m.getState();if(_===Y.LOADED||_===Y.ERROR){const v=m.getKey();v in i.errorTileKeys?m.getState()===Y.LOADED&&delete i.errorTileKeys[v]:i.loadingSourceTiles--,_===Y.ERROR?i.errorTileKeys[v]=!0:m.removeEventListener(j.CHANGE,x),i.loadingSourceTiles===0&&i.setState(ki(i.errorTileKeys)?Y.LOADED:Y.ERROR)}};m.addEventListener(j.CHANGE,x),i.loadingSourceTiles++}p===Y.IDLE&&(m.extent=h.getTileCoordExtent(d),m.projection=e,m.resolution=h.getResolution(d[0]),this.sourceTileCache_.set(f,m),m.load())}),i.loadingSourceTiles||i.setState(i.sourceTiles.some(d=>d.getState()===Y.ERROR)?Y.ERROR:Y.LOADED)}return i.sourceTiles}getTile(t,e,i,n,r){const o=[t,e,i];let a=this.getTileCoordForTileUrlFunction(o,r);const l=this.getTileGrid().getExtent(),h=this.getTileGridForProjection(r);if(a&&l){const d=h.getTileCoordExtent(a);be(d,-h.getResolution(t),d),vt(l,d)||(a=null)}let c=!0;if(a!==null){const d=this.tileGrid,f=h.getResolution(t),m=d.getZForResolution(f,1),p=h.getTileCoordExtent(a);be(p,-f,p),d.forEachTileCoord(p,m,x=>{c=c&&!this.tileUrlFunction(x,n,r)})}const u=new o0(o,c?Y.EMPTY:Y.IDLE,a,this.getSourceTiles.bind(this,n,r));return u.key=this.getKey(),u}getTileGridForProjection(t){const e=t.getCode();let i=this.tileGrids_[e];if(!i){const n=this.tileGrid,r=n.getResolutions().slice(),o=r.map(function(h,c){return n.getOrigin(c)}),a=r.map(function(h,c){return n.getTileSize(c)}),l=dc+1;for(let h=r.length;h<l;++h)r.push(r[h-1]/2),o.push(o[h-1]),a.push(a[h-1]);i=new wl({extent:n.getExtent(),origins:o,resolutions:r,tileSizes:a}),this.tileGrids_[e]=i}return i}getTilePixelRatio(t){return t}getTilePixelSize(t,e,i){const n=this.getTileGridForProjection(i),r=Bt(n.getTileSize(t),this.tmpSize);return[Math.round(r[0]*e),Math.round(r[1]*e)]}}function l0(s,t){s.setLoader(function(e,i,n){wu(t,s.getFormat(),e,i,n,s.onLoad.bind(s),s.onError.bind(s))})}const h0=5;class c0 extends Ds{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=h0}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return q()}getData(t){return null}prepareFrame(t){return q()}renderFrame(t,e){return q()}forEachFeatureAtCoordinate(t,e,i,n,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===nt.LOADED||e.getState()===nt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=nt.LOADED&&e!=nt.ERROR&&t.addEventListener(j.CHANGE,this.boundHandleImageChange_),e==nt.IDLE&&(t.load(),e=t.getState()),e==nt.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}}class Sl{constructor(){K(this,"pushMethodArgs_",(...t)=>(this.instructions_[this.zIndex+this.offset_].push(t),this));this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(vr(),{get:(t,e)=>{if(typeof vr()[e]=="function")return this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e),this.pushMethodArgs_},set:(t,e,i)=>(this.instructions_[this.zIndex+this.offset_]||(this.instructions_[this.zIndex+this.offset_]=[]),this.instructions_[this.zIndex+this.offset_].push(e,i),!0)})}pushFunction(t){this.instructions_[this.zIndex+this.offset_].push(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,n=e.length;i<n;++i){const r=e[i];if(typeof r=="function"){r(t);continue}const o=e[++i];if(typeof t[r]=="function")t[r](...o);else{if(typeof o=="function"){t[r]=o(t);continue}t[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}}const Lh=[];let In=null;function u0(){In=Rt(1,1,void 0,{willReadFrequently:!0})}class Su extends c0{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=we(),this.pixelTransform=we(),this.inversePixelTransform=we(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){In||u0(),In.clearRect(0,0,1,1);let n;try{In.drawImage(t,e,i,1,1,0,0,1,1),n=In.getImageData(0,0,1,1).data}catch{return In=null,null}return n}getBackground(t){let i=this.getLayer().getBackground();return typeof i=="function"&&(i=i(t.viewState.resolution)),i||void 0}useContainer(t,e,i){const n=this.getLayer().getClassName();let r,o;if(t&&t.className===n&&(!i||t&&t.style.backgroundColor&&zi(xs(t.style.backgroundColor),xs(i)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&o.canvas.style.transform===e?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=n;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=Rt();const l=o.canvas;r.appendChild(l),a=l.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const n=Un(i),r=nc(i),o=sc(i),a=rc(i);Nt(e.coordinateToPixelTransform,n),Nt(e.coordinateToPixelTransform,r),Nt(e.coordinateToPixelTransform,o),Nt(e.coordinateToPixelTransform,a);const l=this.inversePixelTransform;Nt(l,n),Nt(l,r),Nt(l,o),Nt(l,a),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const i=t.extent,n=t.viewState.resolution,r=t.viewState.rotation,o=t.pixelRatio,a=Math.round(yt(i)/n*o),l=Math.round(Wt(i)/n*o);di(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,r,-a/2,-l/2),Ac(this.inversePixelTransform,this.pixelTransform);const h=of(this.pixelTransform);if(this.useContainer(e,h,this.getBackground(t)),!this.containerReused){const c=this.context.canvas;c.width!=a||c.height!=l?(c.width=a,c.height=l):this.context.clearRect(0,0,a,l),h!==c.style.transform&&(c.style.transform=h)}}dispatchRenderEvent_(t,e,i){const n=this.getLayer();if(n.hasListener(t)){const r=new Jc(t,this.inversePixelTransform,i,e);n.dispatchEvent(r)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Ee.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Ee.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new Sl),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Ee.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Ee.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,n,r,o,a){const l=r/2,h=o/2,c=n/e,u=-c,d=-t[0]+a,f=-t[1];return di(this.tempTransform,l,h,c,u,-i,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}}const Li={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};class d0 extends Qr{constructor(t){t=t||{};const e=Object.assign({},t),i=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(Li.PRELOAD)}setPreload(t){this.set(Li.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(Li.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(Li.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}}function bo(s,t,e,i){return`${s},${zs(t,e,i)}`}function Oo(s,t,e){if(!(e in s))return s[e]=new Set([t]),!0;const i=s[e],n=i.has(t);return n||i.add(t),!n}function f0(s,t,e){const i=s[e];return i?i.delete(t):!1}function Mh(s,t){const e=s.layerStatesArray[s.layerIndex];e.extent&&(t=ce(t,Ii(e.extent,s.viewState.projection)));const i=e.layer.getRenderSource();if(!i.getWrapX()){const n=i.getTileGridForProjection(s.viewState.projection).getExtent();n&&(t=ce(t,n))}return t}class Ru extends Su{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=Se(),this.tempTileRange_=new Cl(0,0,0,0),this.tempTileCoord_=Or(0,0,0);const i=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new su(i),this.maxStaleKeys=i*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,i,n){const r=this.tileCache_,a=this.getLayer().getSource(),l=bo(a.getKey(),t,e,i);let h;if(r.containsKey(l))h=r.get(l);else{if(h=a.getTile(t,e,i,n.pixelRatio,n.viewState.projection),!h)return null;r.set(l,h)}return h}getTile(t,e,i,n){const r=this.getOrCreateTile(t,e,i,n);return r||null}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),n=Nt(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!On(r,n))return null;const o=e.viewState,a=i.getRenderSource(),l=a.getTileGridForProjection(o.projection),h=a.getTilePixelRatio(e.pixelRatio);for(let c=l.getZForResolution(o.resolution);c>=l.getMinZoom();--c){const u=l.getTileCoordForCoordAndZ(n,c),d=this.getTile(c,u[1],u[2],e);if(!d||d.getState()!==Y.LOADED)continue;const f=l.getOrigin(c),m=Bt(l.getTileSize(c)),p=l.getResolution(c);let x;if(d instanceof ru)x=d.getImage();else if(d instanceof ma){if(x=Dr(d.getData()),!x)continue}else continue;const T=Math.floor(h*((n[0]-f[0])/p-u[1]*m[0])),_=Math.floor(h*((f[1]-n[1])/p-u[2]*m[1])),v=Math.round(h*a.getGutterForProjection(o.projection));return this.getImageData(x,T+v,_+v)}return null}prepareFrame(t){const e=this.getLayer().getSource();if(!e)return!1;const i=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==i&&(this.renderedRevision_=i,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=i,!0}enqueueTiles(t,e,i,n,r){const o=t.viewState,a=this.getLayer(),l=a.getRenderSource(),h=l.getTileGridForProjection(o.projection),c=J(l);c in t.wantedTiles||(t.wantedTiles[c]={});const u=t.wantedTiles[c],d=a.getMapInternal(),f=Math.max(i-r,h.getMinZoom(),h.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):h.getResolution(0)),l.zDirection));for(let m=i;m>=f;--m){const p=h.getTileRangeForExtentAndZ(e,m,this.tempTileRange_),x=h.getResolution(m);for(let T=p.minX;T<=p.maxX;++T)for(let _=p.minY;_<=p.maxY;++_){const v=this.getTile(m,T,_,t);if(!v||!Oo(n,v,m))continue;const F=v.getKey();if(u[F]=!0,v.getState()===Y.IDLE&&!t.tileQueue.isKeyQueued(F)){const k=Or(m,T,_,this.tempTileCoord_);t.tileQueue.enqueue([v,c,h.getTileCoordCenter(k),x])}}}}findStaleTile_(t,e){const i=this.tileCache_,n=t[0],r=t[1],o=t[2],a=this.getStaleKeys();for(let l=0;l<a.length;++l){const h=bo(a[l],n,r,o);if(i.containsKey(h)){const c=i.get(h);if(c.getState()===Y.LOADED)return c.endTransition(J(this)),Oo(e,c,n),!0}}return!1}findAltTiles_(t,e,i,n){const r=t.getTileRangeForTileCoordAndZ(e,i,this.tempTileRange_);if(!r)return!1;let o=!0;const a=this.tileCache_,h=this.getLayer().getRenderSource().getKey();for(let c=r.minX;c<=r.maxX;++c)for(let u=r.minY;u<=r.maxY;++u){const d=bo(h,i,c,u);let f=!1;if(a.containsKey(d)){const m=a.get(d);m.getState()===Y.LOADED&&(Oo(n,m,i),f=!0)}f||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const i=t.layerStatesArray[t.layerIndex],n=t.viewState,r=n.projection,o=n.resolution,a=n.center,l=t.pixelRatio,h=this.getLayer(),c=h.getSource(),u=c.getRevision(),d=c.getTileGridForProjection(r),f=d.getZForResolution(o,c.zDirection),m=d.getResolution(f),p=c.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==p&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=p):this.renderedSourceKey_=p;let x=t.extent;const T=c.getTilePixelRatio(l);this.prepareContainer(t,e);const _=this.context.canvas.width,v=this.context.canvas.height,P=i.extent&&Ii(i.extent);P&&(x=ce(x,Ii(i.extent)));const F=m*_/2/T,k=m*v/2/T,O=[a[0]-F,a[1]-k,a[0]+F,a[1]+k],g={};this.renderedTiles.length=0;const A=h.getPreload();if(t.nextExtent){const B=d.getZForResolution(n.nextResolution,c.zDirection),z=Mh(t,t.nextExtent);this.enqueueTiles(t,z,B,g,A)}const y=Mh(t,x);if(this.enqueueTiles(t,y,f,g,0),A>0&&setTimeout(()=>{this.enqueueTiles(t,y,f-1,g,A-1)},0),!(f in g))return this.container;const S=J(this),C=t.time;for(const B of g[f]){const z=B.getState();if((B instanceof cu||B instanceof i0)&&z===Y.EMPTY)continue;const X=B.tileCoord;if(z===Y.LOADED&&B.getAlpha(S,C)===1){B.endTransition(S);continue}if(this.renderComplete=!1,this.findStaleTile_(X,g)){f0(g,B,f),t.animate=!0;continue}if(this.findAltTiles_(d,X,f+1,g))continue;const Z=d.getMinZoom();for(let H=f-1;H>=Z&&!this.findAltTiles_(d,X,H,g);--H);}const I=m/o*l/T,R=this.getRenderContext(t);di(this.tempTransform,_/2,v/2,I,I,0,-_/2,-v/2),i.extent&&this.clipUnrotated(R,t,P),c.getInterpolate()||(R.imageSmoothingEnabled=!1),this.preRender(R,t);const w=Object.keys(g).map(Number);w.sort(je);let E;const M=[],L=[];for(let B=w.length-1;B>=0;--B){const z=w[B],X=c.getTilePixelSize(z,l,r),G=d.getResolution(z)/m,Z=X[0]*G*I,H=X[1]*G*I,rt=d.getTileCoordForCoordAndZ(Un(O),z),Qt=d.getTileCoordExtent(rt),ae=Nt(this.tempTransform,[T*(Qt[0]-O[0])/m,T*(O[3]-Qt[3])/m]),Xt=T*c.getGutterForProjection(r);for(const Lt of g[z]){if(Lt.getState()!==Y.LOADED)continue;const Re=Lt.tileCoord,kt=rt[1]-Re[1],Mt=Math.round(ae[0]-(kt-1)*Z),mt=rt[2]-Re[2],Vi=Math.round(ae[1]-(mt-1)*H),fe=Math.round(ae[0]-kt*Z),ze=Math.round(ae[1]-mt*H),dn=Mt-fe,fn=Vi-ze,Qn=w.length===1;let Ki=!1;E=[fe,ze,fe+dn,ze,fe+dn,ze+fn,fe,ze+fn];for(let gn=0,mn=M.length;gn<mn;++gn)if(!Qn&&z<L[gn]){const bt=M[gn];vt([fe,ze,fe+dn,ze+fn],[bt[0],bt[3],bt[4],bt[7]])&&(Ki||(R.save(),Ki=!0),R.beginPath(),R.moveTo(E[0],E[1]),R.lineTo(E[2],E[3]),R.lineTo(E[4],E[5]),R.lineTo(E[6],E[7]),R.moveTo(bt[6],bt[7]),R.lineTo(bt[4],bt[5]),R.lineTo(bt[2],bt[3]),R.lineTo(bt[0],bt[1]),R.clip())}M.push(E),L.push(z),this.drawTile(Lt,t,fe,ze,dn,fn,Xt,Qn),Ki&&R.restore(),this.renderedTiles.unshift(Lt),this.updateUsedTiles(t.usedTiles,c,Lt)}}this.renderedRevision=u,this.renderedResolution=m,this.extentChanged=!this.renderedExtent_||!bn(this.renderedExtent_,O),this.renderedExtent_=O,this.renderedPixelRatio=l,this.renderedProjection=r,this.postRender(this.context,t),i.extent&&R.restore(),R.imageSmoothingEnabled=!0;const b=(B,z)=>{const X=J(c),it=z.wantedTiles[X],G=it?Object.keys(it).length:0;this.updateCacheSize(G),this.tileCache_.expireCache()};return t.postRenderFunctions.push(b),this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,i,n,r,o,a,l){let h;if(t instanceof ma){if(h=Dr(t.getData()),!h)throw new Error("Rendering array data is not yet supported")}else h=this.getTileImage(t);if(!h)return;const c=this.getRenderContext(e),u=J(this),d=e.layerStatesArray[e.layerIndex],f=d.opacity*(l?t.getAlpha(u,e.time):1),m=f!==c.globalAlpha;m&&(c.save(),c.globalAlpha=f),c.drawImage(h,a,a,h.width-2*a,h.height-2*a,i,n,r,o),m&&c.restore(),f!==d.opacity?e.animate=!0:l&&t.endTransition(u)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,i){const n=J(e);n in t||(t[n]={}),t[n][i.getKey()]=!0}}class Iu extends d0{constructor(t){super(t)}createRenderer(){return new Ru(this,{cacheSize:this.getCacheSize()})}}class g0 extends jm{constructor(t){t=t||{},super({projection:t.projection,tileGrid:t.tileGrid,wrapX:t.wrapX!==void 0?t.wrapX:!0,zDirection:t.zDirection,url:t.template||"z:{z} x:{x} y:{y}",tileLoadFunction:(e,i)=>{const n=e.getTileCoord()[0],r=Bt(this.tileGrid.getTileSize(n)),o=Rt(r[0],r[1]);o.strokeStyle="grey",o.strokeRect(.5,.5,r[0]+.5,r[1]+.5),o.fillStyle="grey",o.strokeStyle="white",o.textAlign="center",o.textBaseline="middle",o.font="24px sans-serif",o.lineWidth=4,o.strokeText(i,r[0]/2,r[1]/2,r[0]),o.fillText(i,r[0]/2,r[1]/2,r[0]),e.setImage(o.canvas)}})}}class m0 extends pu{constructor(t){t=t||{};const e=Object.assign({},t.params);super({attributions:t.attributions,attributionsCollapsible:t.attributionsCollapsible,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:t.interpolate,projection:t.projection,reprojectionErrorThreshold:t.reprojectionErrorThreshold,tileClass:t.tileClass,tileGrid:t.tileGrid,tileLoadFunction:t.tileLoadFunction,url:t.url,urls:t.urls,wrapX:t.wrapX!==void 0?t.wrapX:!0,transition:t.transition,zDirection:t.zDirection}),this.gutter_=t.gutter!==void 0?t.gutter:0,this.params_=e,this.v13_=!0,this.serverType_=t.serverType,this.hidpi_=t.hidpi!==void 0?t.hidpi:!0,this.tmpExtent_=Se(),this.updateV13_(),this.setKey(this.getKeyForParams_())}getFeatureInfoUrl(t,e,i,n){const r=Zt(i),o=this.getProjection()||r;let a=this.getTileGrid();a||(a=this.getTileGridForProjection(o));const l=oc(t,r,o),h=ha(o,r,t,e),c=a.getZForResolution(h,this.zDirection),u=a.getResolution(c),d=a.getTileCoordForCoordAndZ(l,c);if(a.getResolutions().length<=d[0])return;let f=a.getTileCoordExtent(d,this.tmpExtent_);const m=this.gutter_;m!==0&&(f=be(f,u*m,f));const p={QUERY_LAYERS:this.params_.LAYERS};Object.assign(p,Ih(this.params_,"GetFeatureInfo"),n);const x=Math.floor((l[0]-f[0])/u),T=Math.floor((f[3]-l[1])/u);return p[this.v13_?"I":"X"]=x,p[this.v13_?"J":"Y"]=T,this.getRequestUrl_(d,f,1,o||r,p)}getLegendUrl(t,e){if(this.urls[0]===void 0)return;const i={SERVICE:"WMS",VERSION:Aa,REQUEST:"GetLegendGraphic",FORMAT:"image/png"};if(e===void 0||e.LAYER===void 0){const n=this.params_.LAYERS;if(!(!Array.isArray(n)||n.length===1))return;i.LAYER=n}if(t!==void 0){const n=this.getProjection()?this.getProjection().getMetersPerUnit():1,r=28e-5;i.SCALE=t*n/r}return Object.assign(i,e),_u(this.urls[0],i)}getGutter(){return this.gutter_}getParams(){return this.params_}getRequestUrl_(t,e,i,n,r){const o=this.urls;if(!o)return;let a;if(o.length==1)a=o[0];else{const l=Fi(du(t),o.length);a=o[l]}return s0(e,(this.tileGrid||this.getTileGridForProjection(n)).getResolution(t[0]),i,n,a,r,this.serverType_)}getTilePixelRatio(t){return!this.hidpi_||this.serverType_===void 0?1:t}getKeyForParams_(){let t=0;const e=[];for(const i in this.params_)e[t++]=i+"-"+this.params_[i];return e.join("/")}updateParams(t){Object.assign(this.params_,t),this.updateV13_(),this.setKey(this.getKeyForParams_())}updateV13_(){const t=this.params_.VERSION||Aa;this.v13_=fc(t,"1.3")>=0}tileUrlFunction(t,e,i){let n=this.getTileGrid();if(n||(n=this.getTileGridForProjection(i)),n.getResolutions().length<=t[0])return;e!=1&&(!this.hidpi_||this.serverType_===void 0)&&(e=1);const r=n.getResolution(t[0]);let o=n.getTileCoordExtent(t,this.tmpExtent_);const a=this.gutter_;a!==0&&(o=be(o,r*a,o));const l=Object.assign({},Ih(this.params_,"GetMap"));return this.getRequestUrl_(t,o,e,i,l)}}const W={BEGIN_GEOMETRY:0,BEGIN_PATH:1,CIRCLE:2,CLOSE_PATH:3,CUSTOM:4,DRAW_CHARS:5,DRAW_IMAGE:6,END_GEOMETRY:7,FILL:8,MOVE_TO_LINE_TO:9,SET_FILL_STYLE:10,SET_STROKE_STYLE:11,STROKE:12},or=[W.FILL],Mi=[W.STROKE],$i=[W.BEGIN_PATH],Ph=[W.CLOSE_PATH];class vu{drawCustom(t,e,i,n,r){}drawGeometry(t){}setStyle(t){}drawCircle(t,e,i){}drawFeature(t,e,i){}drawGeometryCollection(t,e,i){}drawLineString(t,e,i){}drawMultiLineString(t,e,i){}drawMultiPoint(t,e,i){}drawMultiPolygon(t,e,i){}drawPoint(t,e,i){}drawPolygon(t,e,i){}drawText(t,e,i){}setFillStrokeStyle(t,e){}setImageStyle(t,e){}setTextStyle(t,e){}}class Vs extends vu{constructor(t,e,i,n){super(),this.tolerance=t,this.maxExtent=e,this.pixelRatio=n,this.maxLineWidth=0,this.resolution=i,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_=null,this.bufferedMaxExtent_=null,this.instructions=[],this.coordinates=[],this.tmpCoordinate_=[],this.hitDetectionInstructions=[],this.state={}}applyPixelRatio(t){const e=this.pixelRatio;return e==1?t:t.map(function(i){return i*e})}appendFlatPointCoordinates(t,e){const i=this.getBufferedMaxExtent(),n=this.tmpCoordinate_,r=this.coordinates;let o=r.length;for(let a=0,l=t.length;a<l;a+=e)n[0]=t[a],n[1]=t[a+1],On(i,n)&&(r[o++]=n[0],r[o++]=n[1]);return o}appendFlatLineCoordinates(t,e,i,n,r,o){const a=this.coordinates;let l=a.length;const h=this.getBufferedMaxExtent();o&&(e+=n);let c=t[e],u=t[e+1];const d=this.tmpCoordinate_;let f=!0,m,p,x;for(m=e+n;m<i;m+=n)d[0]=t[m],d[1]=t[m+1],x=Id(h,d),x!==p?(f&&(a[l++]=c,a[l++]=u,f=!1),a[l++]=d[0],a[l++]=d[1]):x===vd.INTERSECTING?(a[l++]=d[0],a[l++]=d[1],f=!1):f=!0,c=d[0],u=d[1],p=x;return(r&&f||m===e+n)&&(a[l++]=c,a[l++]=u),l}drawCustomCoordinates_(t,e,i,n,r){for(let o=0,a=i.length;o<a;++o){const l=i[o],h=this.appendFlatLineCoordinates(t,e,l,n,!1,!1);r.push(h),e=l}return e}drawCustom(t,e,i,n,r){this.beginGeometry(t,e,r);const o=t.getType(),a=t.getStride(),l=this.coordinates.length;let h,c,u,d,f;switch(o){case"MultiPolygon":h=t.getOrientedFlatCoordinates(),d=[];const m=t.getEndss();f=0;for(let p=0,x=m.length;p<x;++p){const T=[];f=this.drawCustomCoordinates_(h,f,m[p],a,T),d.push(T)}this.instructions.push([W.CUSTOM,l,d,t,i,Qo,r]),this.hitDetectionInstructions.push([W.CUSTOM,l,d,t,n||i,Qo,r]);break;case"Polygon":case"MultiLineString":u=[],h=o=="Polygon"?t.getOrientedFlatCoordinates():t.getFlatCoordinates(),f=this.drawCustomCoordinates_(h,0,t.getEnds(),a,u),this.instructions.push([W.CUSTOM,l,u,t,i,ps,r]),this.hitDetectionInstructions.push([W.CUSTOM,l,u,t,n||i,ps,r]);break;case"LineString":case"Circle":h=t.getFlatCoordinates(),c=this.appendFlatLineCoordinates(h,0,h.length,a,!1,!1),this.instructions.push([W.CUSTOM,l,c,t,i,vi,r]),this.hitDetectionInstructions.push([W.CUSTOM,l,c,t,n||i,vi,r]);break;case"MultiPoint":h=t.getFlatCoordinates(),c=this.appendFlatPointCoordinates(h,a),c>l&&(this.instructions.push([W.CUSTOM,l,c,t,i,vi,r]),this.hitDetectionInstructions.push([W.CUSTOM,l,c,t,n||i,vi,r]));break;case"Point":h=t.getFlatCoordinates(),this.coordinates.push(h[0],h[1]),c=this.coordinates.length,this.instructions.push([W.CUSTOM,l,c,t,i,void 0,r]),this.hitDetectionInstructions.push([W.CUSTOM,l,c,t,n||i,void 0,r]);break}this.endGeometry(e)}beginGeometry(t,e,i){this.beginGeometryInstruction1_=[W.BEGIN_GEOMETRY,e,0,t,i],this.instructions.push(this.beginGeometryInstruction1_),this.beginGeometryInstruction2_=[W.BEGIN_GEOMETRY,e,0,t,i],this.hitDetectionInstructions.push(this.beginGeometryInstruction2_)}finish(){return{instructions:this.instructions,hitDetectionInstructions:this.hitDetectionInstructions,coordinates:this.coordinates}}reverseHitDetectionInstructions(){const t=this.hitDetectionInstructions;t.reverse();let e;const i=t.length;let n,r,o=-1;for(e=0;e<i;++e)n=t[e],r=n[0],r==W.END_GEOMETRY?o=e:r==W.BEGIN_GEOMETRY&&(n[2]=e,Vd(this.hitDetectionInstructions,o,e),o=-1)}setFillStrokeStyle(t,e){const i=this.state;if(t){const n=t.getColor();i.fillPatternScale=n&&typeof n=="object"&&"src"in n?this.pixelRatio:1,i.fillStyle=Ke(n||ne)}else i.fillStyle=void 0;if(e){const n=e.getColor();i.strokeStyle=Ke(n||Cs);const r=e.getLineCap();i.lineCap=r!==void 0?r:Gn;const o=e.getLineDash();i.lineDash=o?o.slice():ai;const a=e.getLineDashOffset();i.lineDashOffset=a||li;const l=e.getLineJoin();i.lineJoin=l!==void 0?l:Bn;const h=e.getWidth();i.lineWidth=h!==void 0?h:Ts;const c=e.getMiterLimit();i.miterLimit=c!==void 0?c:Es,i.lineWidth>this.maxLineWidth&&(this.maxLineWidth=i.lineWidth,this.bufferedMaxExtent_=null)}else i.strokeStyle=void 0,i.lineCap=void 0,i.lineDash=null,i.lineDashOffset=void 0,i.lineJoin=void 0,i.lineWidth=void 0,i.miterLimit=void 0}createFill(t){const e=t.fillStyle,i=[W.SET_FILL_STYLE,e];return typeof e!="string"&&i.push(t.fillPatternScale),i}applyStroke(t){this.instructions.push(this.createStroke(t))}createStroke(t){return[W.SET_STROKE_STYLE,t.strokeStyle,t.lineWidth*this.pixelRatio,t.lineCap,t.lineJoin,t.miterLimit,this.applyPixelRatio(t.lineDash),t.lineDashOffset*this.pixelRatio]}updateFillStyle(t,e){const i=t.fillStyle;(typeof i!="string"||t.currentFillStyle!=i)&&(i!==void 0&&this.instructions.push(e.call(this,t)),t.currentFillStyle=i)}updateStrokeStyle(t,e){const i=t.strokeStyle,n=t.lineCap,r=t.lineDash,o=t.lineDashOffset,a=t.lineJoin,l=t.lineWidth,h=t.miterLimit;(t.currentStrokeStyle!=i||t.currentLineCap!=n||r!=t.currentLineDash&&!zi(t.currentLineDash,r)||t.currentLineDashOffset!=o||t.currentLineJoin!=a||t.currentLineWidth!=l||t.currentMiterLimit!=h)&&(i!==void 0&&e.call(this,t),t.currentStrokeStyle=i,t.currentLineCap=n,t.currentLineDash=r,t.currentLineDashOffset=o,t.currentLineJoin=a,t.currentLineWidth=l,t.currentMiterLimit=h)}endGeometry(t){this.beginGeometryInstruction1_[2]=this.instructions.length,this.beginGeometryInstruction1_=null,this.beginGeometryInstruction2_[2]=this.hitDetectionInstructions.length,this.beginGeometryInstruction2_=null;const e=[W.END_GEOMETRY,t];this.instructions.push(e),this.hitDetectionInstructions.push(e)}getBufferedMaxExtent(){if(!this.bufferedMaxExtent_&&(this.bufferedMaxExtent_=ic(this.maxExtent),this.maxLineWidth>0)){const t=this.resolution*(this.maxLineWidth+1)/2;be(this.bufferedMaxExtent_,t,this.bufferedMaxExtent_)}return this.bufferedMaxExtent_}}class A0 extends Vs{constructor(t,e,i,n){super(t,e,i,n),this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.anchorX_=void 0,this.anchorY_=void 0,this.height_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.scale_=void 0,this.width_=void 0,this.declutterMode_=void 0,this.declutterImageWithText_=void 0}drawPoint(t,e,i){if(!this.image_||this.maxExtent&&!On(this.maxExtent,t.getFlatCoordinates()))return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=t.getStride(),o=this.coordinates.length,a=this.appendFlatPointCoordinates(n,r);this.instructions.push([W.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([W.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}drawMultiPoint(t,e,i){if(!this.image_)return;this.beginGeometry(t,e,i);const n=t.getFlatCoordinates(),r=[];for(let l=0,h=n.length;l<h;l+=t.getStride())(!this.maxExtent||On(this.maxExtent,n.slice(l,l+2)))&&r.push(n[l],n[l+1]);const o=this.coordinates.length,a=this.appendFlatPointCoordinates(r,2);this.instructions.push([W.DRAW_IMAGE,o,a,this.image_,this.anchorX_*this.imagePixelRatio_,this.anchorY_*this.imagePixelRatio_,Math.ceil(this.height_*this.imagePixelRatio_),this.opacity_,this.originX_*this.imagePixelRatio_,this.originY_*this.imagePixelRatio_,this.rotateWithView_,this.rotation_,[this.scale_[0]*this.pixelRatio/this.imagePixelRatio_,this.scale_[1]*this.pixelRatio/this.imagePixelRatio_],Math.ceil(this.width_*this.imagePixelRatio_),this.declutterMode_,this.declutterImageWithText_]),this.hitDetectionInstructions.push([W.DRAW_IMAGE,o,a,this.hitDetectionImage_,this.anchorX_,this.anchorY_,this.height_,1,this.originX_,this.originY_,this.rotateWithView_,this.rotation_,this.scale_,this.width_,this.declutterMode_,this.declutterImageWithText_]),this.endGeometry(e)}finish(){return this.reverseHitDetectionInstructions(),this.anchorX_=void 0,this.anchorY_=void 0,this.hitDetectionImage_=null,this.image_=null,this.imagePixelRatio_=void 0,this.height_=void 0,this.scale_=void 0,this.opacity_=void 0,this.originX_=void 0,this.originY_=void 0,this.rotateWithView_=void 0,this.rotation_=void 0,this.width_=void 0,super.finish()}setImageStyle(t,e){const i=t.getAnchor(),n=t.getSize(),r=t.getOrigin();this.imagePixelRatio_=t.getPixelRatio(this.pixelRatio),this.anchorX_=i[0],this.anchorY_=i[1],this.hitDetectionImage_=t.getHitDetectionImage(),this.image_=t.getImage(this.pixelRatio),this.height_=n[1],this.opacity_=t.getOpacity(),this.originX_=r[0],this.originY_=r[1],this.rotateWithView_=t.getRotateWithView(),this.rotation_=t.getRotation(),this.scale_=t.getScaleArray(),this.width_=n[0],this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}class _0 extends Vs{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinates_(t,e,i,n){const r=this.coordinates.length,o=this.appendFlatLineCoordinates(t,e,i,n,!1,!1),a=[W.MOVE_TO_LINE_TO,r,o];return this.instructions.push(a),this.hitDetectionInstructions.push(a),i}drawLineString(t,e,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([W.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ai,li],$i);const a=t.getFlatCoordinates(),l=t.getStride();this.drawFlatCoordinates_(a,0,a.length,l),this.hitDetectionInstructions.push(Mi),this.endGeometry(e)}drawMultiLineString(t,e,i){const n=this.state,r=n.strokeStyle,o=n.lineWidth;if(r===void 0||o===void 0)return;this.updateStrokeStyle(n,this.applyStroke),this.beginGeometry(t,e,i),this.hitDetectionInstructions.push([W.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ai,li],$i);const a=t.getEnds(),l=t.getFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,d=a.length;u<d;++u)c=this.drawFlatCoordinates_(l,c,a[u],h);this.hitDetectionInstructions.push(Mi),this.endGeometry(e)}finish(){const t=this.state;return t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&this.instructions.push(Mi),this.reverseHitDetectionInstructions(),this.state=null,super.finish()}applyStroke(t){t.lastStroke!=null&&t.lastStroke!=this.coordinates.length&&(this.instructions.push(Mi),t.lastStroke=this.coordinates.length),t.lastStroke=0,super.applyStroke(t),this.instructions.push($i)}}class Fh extends Vs{constructor(t,e,i,n){super(t,e,i,n)}drawFlatCoordinatess_(t,e,i,n){const r=this.state,o=r.fillStyle!==void 0,a=r.strokeStyle!==void 0,l=i.length;this.instructions.push($i),this.hitDetectionInstructions.push($i);for(let h=0;h<l;++h){const c=i[h],u=this.coordinates.length,d=this.appendFlatLineCoordinates(t,e,c,n,!0,!a),f=[W.MOVE_TO_LINE_TO,u,d];this.instructions.push(f),this.hitDetectionInstructions.push(f),a&&(this.instructions.push(Ph),this.hitDetectionInstructions.push(Ph)),e=c}return o&&(this.instructions.push(or),this.hitDetectionInstructions.push(or)),a&&(this.instructions.push(Mi),this.hitDetectionInstructions.push(Mi)),e}drawCircle(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([W.SET_FILL_STYLE,ne]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([W.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ai,li]);const a=t.getFlatCoordinates(),l=t.getStride(),h=this.coordinates.length;this.appendFlatLineCoordinates(a,0,a.length,l,!1,!1);const c=[W.CIRCLE,h];this.instructions.push($i,c),this.hitDetectionInstructions.push($i,c),n.fillStyle!==void 0&&(this.instructions.push(or),this.hitDetectionInstructions.push(or)),n.strokeStyle!==void 0&&(this.instructions.push(Mi),this.hitDetectionInstructions.push(Mi)),this.endGeometry(e)}drawPolygon(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([W.SET_FILL_STYLE,ne]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([W.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ai,li]);const a=t.getEnds(),l=t.getOrientedFlatCoordinates(),h=t.getStride();this.drawFlatCoordinatess_(l,0,a,h),this.endGeometry(e)}drawMultiPolygon(t,e,i){const n=this.state,r=n.fillStyle,o=n.strokeStyle;if(r===void 0&&o===void 0)return;this.setFillStrokeStyles_(),this.beginGeometry(t,e,i),n.fillStyle!==void 0&&this.hitDetectionInstructions.push([W.SET_FILL_STYLE,ne]),n.strokeStyle!==void 0&&this.hitDetectionInstructions.push([W.SET_STROKE_STYLE,n.strokeStyle,n.lineWidth,n.lineCap,n.lineJoin,n.miterLimit,ai,li]);const a=t.getEndss(),l=t.getOrientedFlatCoordinates(),h=t.getStride();let c=0;for(let u=0,d=a.length;u<d;++u)c=this.drawFlatCoordinatess_(l,c,a[u],h);this.endGeometry(e)}finish(){this.reverseHitDetectionInstructions(),this.state=null;const t=this.tolerance;if(t!==0){const e=this.coordinates;for(let i=0,n=e.length;i<n;++i)e[i]=Qi(e[i],t)}return super.finish()}setFillStrokeStyles_(){const t=this.state;t.fillStyle!==void 0&&this.updateFillStyle(t,this.createFill),t.strokeStyle!==void 0&&this.updateStrokeStyle(t,this.applyStroke)}}function p0(s,t,e,i,n){const r=[];let o=e,a=0,l=t.slice(e,2);for(;a<s&&o+n<i;){const[h,c]=l.slice(-2),u=t[o+n],d=t[o+n+1],f=Math.sqrt((u-h)*(u-h)+(d-c)*(d-c));if(a+=f,a>=s){const m=(s-a+f)/f,p=le(h,u,m),x=le(c,d,m);l.push(p,x),r.push(l),l=[p,x],a==s&&(o+=n),a=0}else if(a<s)l.push(t[o+n],t[o+n+1]),o+=n;else{const m=f-a,p=le(h,u,m/f),x=le(c,d,m/f);l.push(p,x),r.push(l),l=[p,x],a=0,o+=n}}return a>0&&r.push(l),r}function y0(s,t,e,i,n){let r=e,o=e,a=0,l=0,h=e,c,u,d,f,m,p,x,T,_,v;for(u=e;u<i;u+=n){const P=t[u],F=t[u+1];m!==void 0&&(_=P-m,v=F-p,f=Math.sqrt(_*_+v*v),x!==void 0&&(l+=d,c=Math.acos((x*_+T*v)/(d*f)),c>s&&(l>a&&(a=l,r=h,o=u),l=0,h=u-n)),d=f,x=_,T=v),m=P,p=F}return l+=f,l>a?[h,u]:[r,o]}const kr={left:0,center:.5,right:1,top:0,middle:.5,hanging:.2,alphabetic:.8,ideographic:.8,bottom:1};class x0 extends Vs{constructor(t,e,i,n){super(t,e,i,n),this.labels_=null,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=void 0,this.textRotation_=0,this.textFillState_=null,this.fillStates={},this.fillStates[ne]={fillStyle:ne},this.textStrokeState_=null,this.strokeStates={},this.textState_={},this.textStates={},this.textKey_="",this.fillKey_="",this.strokeKey_="",this.declutterMode_=void 0,this.declutterImageWithText_=void 0}finish(){const t=super.finish();return t.textStates=this.textStates,t.fillStates=this.fillStates,t.strokeStates=this.strokeStates,t}drawText(t,e,i){const n=this.textFillState_,r=this.textStrokeState_,o=this.textState_;if(this.text_===""||!o||!n&&!r)return;const a=this.coordinates;let l=a.length;const h=t.getType();let c=null,u=t.getStride();if(o.placement==="line"&&(h=="LineString"||h=="MultiLineString"||h=="Polygon"||h=="MultiPolygon")){if(!vt(this.maxExtent,t.getExtent()))return;let d;if(c=t.getFlatCoordinates(),h=="LineString")d=[c.length];else if(h=="MultiLineString")d=t.getEnds();else if(h=="Polygon")d=t.getEnds().slice(0,1);else if(h=="MultiPolygon"){const x=t.getEndss();d=[];for(let T=0,_=x.length;T<_;++T)d.push(x[T][0])}this.beginGeometry(t,e,i);const f=o.repeat,m=f?void 0:o.textAlign;let p=0;for(let x=0,T=d.length;x<T;++x){let _;f?_=p0(f*this.resolution,c,p,d[x],u):_=[c.slice(p,d[x])];for(let v=0,P=_.length;v<P;++v){const F=_[v];let k=0,O=F.length;if(m==null){const A=y0(o.maxAngle,F,0,F.length,2);k=A[0],O=A[1]}for(let A=k;A<O;A+=u)a.push(F[A],F[A+1]);const g=a.length;p=d[x],this.drawChars_(l,g),l=g}}this.endGeometry(e)}else{let d=o.overflow?null:[];switch(h){case"Point":case"MultiPoint":c=t.getFlatCoordinates();break;case"LineString":c=t.getFlatMidpoint();break;case"Circle":c=t.getCenter();break;case"MultiLineString":c=t.getFlatMidpoints(),u=2;break;case"Polygon":c=t.getFlatInteriorPoint(),o.overflow||d.push(c[2]/this.resolution),u=3;break;case"MultiPolygon":const _=t.getFlatInteriorPoints();c=[];for(let v=0,P=_.length;v<P;v+=3)o.overflow||d.push(_[v+2]/this.resolution),c.push(_[v],_[v+1]);if(c.length===0)return;u=2;break}const f=this.appendFlatPointCoordinates(c,u);if(f===l)return;if(d&&(f-l)/2!==c.length/u){let _=l/2;d=d.filter((v,P)=>{const F=a[(_+P)*2]===c[P*u]&&a[(_+P)*2+1]===c[P*u+1];return F||--_,F})}this.saveTextStates_(),(o.backgroundFill||o.backgroundStroke)&&(this.setFillStrokeStyle(o.backgroundFill,o.backgroundStroke),o.backgroundFill&&this.updateFillStyle(this.state,this.createFill),o.backgroundStroke&&(this.updateStrokeStyle(this.state,this.applyStroke),this.hitDetectionInstructions.push(this.createStroke(this.state)))),this.beginGeometry(t,e,i);let m=o.padding;if(m!=Ji&&(o.scale[0]<0||o.scale[1]<0)){let _=o.padding[0],v=o.padding[1],P=o.padding[2],F=o.padding[3];o.scale[0]<0&&(v=-v,F=-F),o.scale[1]<0&&(_=-_,P=-P),m=[_,v,P,F]}const p=this.pixelRatio;this.instructions.push([W.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[1,1],NaN,this.declutterMode_,this.declutterImageWithText_,m==Ji?Ji:m.map(function(_){return _*p}),!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]);const x=1/p,T=this.state.fillStyle;o.backgroundFill&&(this.state.fillStyle=ne,this.hitDetectionInstructions.push(this.createFill(this.state))),this.hitDetectionInstructions.push([W.DRAW_IMAGE,l,f,null,NaN,NaN,NaN,1,0,0,this.textRotateWithView_,this.textRotation_,[x,x],NaN,this.declutterMode_,this.declutterImageWithText_,m,!!o.backgroundFill,!!o.backgroundStroke,this.text_,this.textKey_,this.strokeKey_,this.fillKey_?ne:this.fillKey_,this.textOffsetX_,this.textOffsetY_,d]),o.backgroundFill&&(this.state.fillStyle=T,this.hitDetectionInstructions.push(this.createFill(this.state))),this.endGeometry(e)}}saveTextStates_(){const t=this.textStrokeState_,e=this.textState_,i=this.textFillState_,n=this.strokeKey_;t&&(n in this.strokeStates||(this.strokeStates[n]={strokeStyle:t.strokeStyle,lineCap:t.lineCap,lineDashOffset:t.lineDashOffset,lineWidth:t.lineWidth,lineJoin:t.lineJoin,miterLimit:t.miterLimit,lineDash:t.lineDash}));const r=this.textKey_;r in this.textStates||(this.textStates[r]={font:e.font,textAlign:e.textAlign||ws,justify:e.justify,textBaseline:e.textBaseline||Lr,scale:e.scale});const o=this.fillKey_;i&&(o in this.fillStates||(this.fillStates[o]={fillStyle:i.fillStyle}))}drawChars_(t,e){const i=this.textStrokeState_,n=this.textState_,r=this.strokeKey_,o=this.textKey_,a=this.fillKey_;this.saveTextStates_();const l=this.pixelRatio,h=kr[n.textBaseline],c=this.textOffsetY_*l,u=this.text_,d=i?i.lineWidth*Math.abs(n.scale[0])/2:0;this.instructions.push([W.DRAW_CHARS,t,e,h,n.overflow,a,n.maxAngle,l,c,r,d*l,u,o,1,this.declutterMode_]),this.hitDetectionInstructions.push([W.DRAW_CHARS,t,e,h,n.overflow,a&&ne,n.maxAngle,l,c,r,d*l,u,o,1/l,this.declutterMode_])}setTextStyle(t,e){let i,n,r;if(!t)this.text_="";else{const o=t.getFill();o?(n=this.textFillState_,n||(n={},this.textFillState_=n),n.fillStyle=Ke(o.getColor()||ne)):(n=null,this.textFillState_=n);const a=t.getStroke();if(!a)r=null,this.textStrokeState_=r;else{r=this.textStrokeState_,r||(r={},this.textStrokeState_=r);const m=a.getLineDash(),p=a.getLineDashOffset(),x=a.getWidth(),T=a.getMiterLimit();r.lineCap=a.getLineCap()||Gn,r.lineDash=m?m.slice():ai,r.lineDashOffset=p===void 0?li:p,r.lineJoin=a.getLineJoin()||Bn,r.lineWidth=x===void 0?Ts:x,r.miterLimit=T===void 0?Es:T,r.strokeStyle=Ke(a.getColor()||Cs)}i=this.textState_;const l=t.getFont()||Yc;$f(l);const h=t.getScaleArray();i.overflow=t.getOverflow(),i.font=l,i.maxAngle=t.getMaxAngle(),i.placement=t.getPlacement(),i.textAlign=t.getTextAlign(),i.repeat=t.getRepeat(),i.justify=t.getJustify(),i.textBaseline=t.getTextBaseline()||Lr,i.backgroundFill=t.getBackgroundFill(),i.backgroundStroke=t.getBackgroundStroke(),i.padding=t.getPadding()||Ji,i.scale=h===void 0?[1,1]:h;const c=t.getOffsetX(),u=t.getOffsetY(),d=t.getRotateWithView(),f=t.getRotation();this.text_=t.getText()||"",this.textOffsetX_=c===void 0?0:c,this.textOffsetY_=u===void 0?0:u,this.textRotateWithView_=d===void 0?!1:d,this.textRotation_=f===void 0?0:f,this.strokeKey_=r?(typeof r.strokeStyle=="string"?r.strokeStyle:J(r.strokeStyle))+r.lineCap+r.lineDashOffset+"|"+r.lineWidth+r.lineJoin+r.miterLimit+"["+r.lineDash.join()+"]":"",this.textKey_=i.font+i.scale+(i.textAlign||"?")+(i.repeat||"?")+(i.justify||"?")+(i.textBaseline||"?"),this.fillKey_=n&&n.fillStyle?typeof n.fillStyle=="string"?n.fillStyle:"|"+J(n.fillStyle):""}this.declutterMode_=t.getDeclutterMode(),this.declutterImageWithText_=e}}const E0={Circle:Fh,Default:Vs,Image:A0,LineString:_0,Polygon:Fh,Text:x0};class Lu{constructor(t,e,i,n){this.tolerance_=t,this.maxExtent_=e,this.pixelRatio_=n,this.resolution_=i,this.buildersByZIndex_={}}finish(){const t={};for(const e in this.buildersByZIndex_){t[e]=t[e]||{};const i=this.buildersByZIndex_[e];for(const n in i){const r=i[n].finish();t[e][n]=r}}return t}getBuilder(t,e){const i=t!==void 0?t.toString():"0";let n=this.buildersByZIndex_[i];n===void 0&&(n={},this.buildersByZIndex_[i]=n);let r=n[e];if(r===void 0){const o=E0[e];r=new o(this.tolerance_,this.maxExtent_,this.resolution_,this.pixelRatio_),n[e]=r}return r}}function C0(s,t,e,i,n,r,o,a,l,h,c,u){let d=s[t],f=s[t+1],m=0,p=0,x=0,T=0;function _(){m=d,p=f,t+=i,d=s[t],f=s[t+1],T+=x,x=Math.sqrt((d-m)*(d-m)+(f-p)*(f-p))}do _();while(t<e-i&&T+x<r);let v=x===0?0:(r-T)/x;const P=le(m,d,v),F=le(p,f,v),k=t-i,O=T,g=r+a*l(h,n,c);for(;t<e-i&&T+x<g;)_();v=x===0?0:(g-T)/x;const A=le(m,d,v),y=le(p,f,v);let S;if(u){const E=[P,F,A,y];Qa(E,0,4,2,u,E,E),S=E[0]>E[2]}else S=P>A;const C=Math.PI,I=[],R=k+i===t;t=k,x=0,T=O,d=s[t],f=s[t+1];let w;if(R){_(),w=Math.atan2(f-p,d-m),S&&(w+=w>0?-C:C);const E=(A+P)/2,M=(y+F)/2;return I[0]=[E,M,(g-r)/2,w,n],I}n=n.replace(/\n/g," ");for(let E=0,M=n.length;E<M;){_();let L=Math.atan2(f-p,d-m);if(S&&(L+=L>0?-C:C),w!==void 0){let G=L-w;if(G+=G>C?-2*C:G<-C?2*C:0,Math.abs(G)>o)return null}w=L;const b=E;let B=0;for(;E<M;++E){const G=S?M-E-1:E,Z=a*l(h,n[G],c);if(t+i<e&&T+x<r+B+Z/2)break;B+=Z}if(E===b)continue;const z=S?n.substring(M-b,M-E):n.substring(b,E);v=x===0?0:(r+B/2-T)/x;const X=le(m,d,v),it=le(p,f,v);I.push([X,it,B/2,L,z]),r+=B}return I}const Cn=Se(),Ei=[],Je=[],$e=[],Ci=[];function bh(s){return s[3].declutterBox}const Oh=new RegExp("[-----]");function No(s,t){return t==="start"?t=Oh.test(s)?"right":"left":t==="end"&&(t=Oh.test(s)?"left":"right"),kr[t]}function w0(s,t,e){return e>0&&s.push(`
`,""),s.push(t,""),s}class T0{constructor(t,e,i,n,r){this.overlaps=i,this.pixelRatio=e,this.resolution=t,this.alignAndScaleFill_,this.instructions=n.instructions,this.coordinates=n.coordinates,this.coordinateCache_={},this.renderedTransform_=we(),this.hitDetectionInstructions=n.hitDetectionInstructions,this.pixelCoordinates_=null,this.viewRotation_=0,this.fillStates=n.fillStates||{},this.strokeStates=n.strokeStates||{},this.textStates=n.textStates||{},this.widths_={},this.labels_={},this.zIndexContext_=r?new Sl:null}getZIndexContext(){return this.zIndexContext_}createLabel(t,e,i,n){const r=t+e+i+n;if(this.labels_[r])return this.labels_[r];const o=n?this.strokeStates[n]:null,a=i?this.fillStates[i]:null,l=this.textStates[e],h=this.pixelRatio,c=[l.scale[0]*h,l.scale[1]*h],u=l.justify?kr[l.justify]:No(Array.isArray(t)?t[0]:t,l.textAlign||ws),d=n&&o.lineWidth?o.lineWidth:0,f=Array.isArray(t)?t:String(t).split(`
`).reduce(w0,[]),{width:m,height:p,widths:x,heights:T,lineWidths:_}=eg(l,f),v=m+d,P=[],F=(v+2)*c[0],k=(p+d)*c[1],O={width:F<0?Math.floor(F):Math.ceil(F),height:k<0?Math.floor(k):Math.ceil(k),contextInstructions:P};(c[0]!=1||c[1]!=1)&&P.push("scale",c),n&&(P.push("strokeStyle",o.strokeStyle),P.push("lineWidth",d),P.push("lineCap",o.lineCap),P.push("lineJoin",o.lineJoin),P.push("miterLimit",o.miterLimit),P.push("setLineDash",[o.lineDash]),P.push("lineDashOffset",o.lineDashOffset)),i&&P.push("fillStyle",a.fillStyle),P.push("textBaseline","middle"),P.push("textAlign","center");const g=.5-u;let A=u*v+g*d;const y=[],S=[];let C=0,I=0,R=0,w=0,E;for(let M=0,L=f.length;M<L;M+=2){const b=f[M];if(b===`
`){I+=C,C=0,A=u*v+g*d,++w;continue}const B=f[M+1]||l.font;B!==E&&(n&&y.push("font",B),i&&S.push("font",B),E=B),C=Math.max(C,T[R]);const z=[b,A+g*x[R]+u*(x[R]-_[w]),.5*(d+C)+I];A+=x[R],n&&y.push("strokeText",z),i&&S.push("fillText",z),++R}return Array.prototype.push.apply(P,y),Array.prototype.push.apply(P,S),this.labels_[r]=O,O}replayTextBackground_(t,e,i,n,r,o,a){t.beginPath(),t.moveTo.apply(t,e),t.lineTo.apply(t,i),t.lineTo.apply(t,n),t.lineTo.apply(t,r),t.lineTo.apply(t,e),o&&(this.alignAndScaleFill_=o[2],this.fill_(t)),a&&(this.setStrokeStyle_(t,a),t.stroke())}calculateImageOrLabelDimensions_(t,e,i,n,r,o,a,l,h,c,u,d,f,m,p,x){a*=d[0],l*=d[1];let T=i-a,_=n-l;const v=r+h>t?t-h:r,P=o+c>e?e-c:o,F=m[3]+v*d[0]+m[1],k=m[0]+P*d[1]+m[2],O=T-m[3],g=_-m[0];(p||u!==0)&&(Ei[0]=O,Ci[0]=O,Ei[1]=g,Je[1]=g,Je[0]=O+F,$e[0]=Je[0],$e[1]=g+k,Ci[1]=$e[1]);let A;return u!==0?(A=di(we(),i,n,1,1,u,-i,-n),Nt(A,Ei),Nt(A,Je),Nt(A,$e),Nt(A,Ci),Nn(Math.min(Ei[0],Je[0],$e[0],Ci[0]),Math.min(Ei[1],Je[1],$e[1],Ci[1]),Math.max(Ei[0],Je[0],$e[0],Ci[0]),Math.max(Ei[1],Je[1],$e[1],Ci[1]),Cn)):Nn(Math.min(O,O+F),Math.min(g,g+k),Math.max(O,O+F),Math.max(g,g+k),Cn),f&&(T=Math.round(T),_=Math.round(_)),{drawImageX:T,drawImageY:_,drawImageW:v,drawImageH:P,originX:h,originY:c,declutterBox:{minX:Cn[0],minY:Cn[1],maxX:Cn[2],maxY:Cn[3],value:x},canvasTransform:A,scale:d}}replayImageOrLabel_(t,e,i,n,r,o,a){const l=!!(o||a),h=n.declutterBox,c=a?a[2]*n.scale[0]/2:0;return h.minX-c<=e[0]&&h.maxX+c>=0&&h.minY-c<=e[1]&&h.maxY+c>=0&&(l&&this.replayTextBackground_(t,Ei,Je,$e,Ci,o,a),ig(t,n.canvasTransform,r,i,n.originX,n.originY,n.drawImageW,n.drawImageH,n.drawImageX,n.drawImageY,n.scale)),!0}fill_(t){const e=this.alignAndScaleFill_;if(e){const i=Nt(this.renderedTransform_,[0,0]),n=512*this.pixelRatio;t.save(),t.translate(i[0]%n,i[1]%n),e!==1&&t.scale(e,e),t.rotate(this.viewRotation_)}t.fill(),e&&t.restore()}setStrokeStyle_(t,e){t.strokeStyle=e[1],t.lineWidth=e[2],t.lineCap=e[3],t.lineJoin=e[4],t.miterLimit=e[5],t.lineDashOffset=e[7],t.setLineDash(e[6])}drawLabelWithPointPlacement_(t,e,i,n){const r=this.textStates[e],o=this.createLabel(t,e,n,i),a=this.strokeStates[i],l=this.pixelRatio,h=No(Array.isArray(t)?t[0]:t,r.textAlign||ws),c=kr[r.textBaseline||Lr],u=a&&a.lineWidth?a.lineWidth:0,d=o.width/l-2*r.scale[0],f=h*d+2*(.5-h)*u,m=c*o.height/l+2*(.5-c)*u;return{label:o,anchorX:f,anchorY:m}}execute_(t,e,i,n,r,o,a,l){const h=this.zIndexContext_;let c;this.pixelCoordinates_&&zi(i,this.renderedTransform_)?c=this.pixelCoordinates_:(this.pixelCoordinates_||(this.pixelCoordinates_=[]),c=bi(this.coordinates,0,this.coordinates.length,2,i,this.pixelCoordinates_),nf(this.renderedTransform_,i));let u=0;const d=n.length;let f=0,m,p,x,T,_,v,P,F,k,O,g,A,y,S=0,C=0,I=null,R=null;const w=this.coordinateCache_,E=this.viewRotation_,M=Math.round(Math.atan2(-i[1],i[0])*1e12)/1e12,L={context:t,pixelRatio:this.pixelRatio,resolution:this.resolution,rotation:E},b=this.instructions!=n||this.overlaps?0:200;let B,z,X,it;for(;u<d;){const G=n[u];switch(G[0]){case W.BEGIN_GEOMETRY:B=G[1],it=G[3],B.getGeometry()?a!==void 0&&!vt(a,it.getExtent())?u=G[2]+1:++u:u=G[2],h&&(h.zIndex=G[4]);break;case W.BEGIN_PATH:S>b&&(this.fill_(t),S=0),C>b&&(t.stroke(),C=0),!S&&!C&&(t.beginPath(),_=NaN,v=NaN),++u;break;case W.CIRCLE:f=G[1];const H=c[f],rt=c[f+1],Qt=c[f+2],ae=c[f+3],Xt=Qt-H,Lt=ae-rt,Re=Math.sqrt(Xt*Xt+Lt*Lt);t.moveTo(H+Re,rt),t.arc(H,rt,Re,0,2*Math.PI,!0),++u;break;case W.CLOSE_PATH:t.closePath(),++u;break;case W.CUSTOM:f=G[1],m=G[2];const kt=G[3],Mt=G[4],mt=G[5];L.geometry=kt,L.feature=B,u in w||(w[u]=[]);const Vi=w[u];mt?mt(c,f,m,2,Vi):(Vi[0]=c[f],Vi[1]=c[f+1],Vi.length=2),h&&(h.zIndex=G[6]),Mt(Vi,L),++u;break;case W.DRAW_IMAGE:f=G[1],m=G[2],k=G[3],p=G[4],x=G[5];let fe=G[6];const ze=G[7],dn=G[8],fn=G[9],Qn=G[10];let Ki=G[11];const gn=G[12];let mn=G[13];T=G[14]||"declutter";const bt=G[15];if(!k&&G.length>=20){O=G[19],g=G[20],A=G[21],y=G[22];const ge=this.drawLabelWithPointPlacement_(O,g,A,y);k=ge.label,G[3]=k;const Wi=G[23];p=(ge.anchorX-Wi)*this.pixelRatio,G[4]=p;const me=G[24];x=(ge.anchorY-me)*this.pixelRatio,G[5]=x,fe=k.height,G[6]=fe,mn=k.width,G[13]=mn}let uo;G.length>25&&(uo=G[25]);let fo,qs,Hs;G.length>17?(fo=G[16],qs=G[17],Hs=G[18]):(fo=Ji,qs=!1,Hs=!1),Qn&&M?Ki+=E:!Qn&&!M&&(Ki-=E);let dd=0;for(;f<m;f+=2){if(uo&&uo[dd++]<mn/this.pixelRatio)continue;const ge=this.calculateImageOrLabelDimensions_(k.width,k.height,c[f],c[f+1],mn,fe,p,x,dn,fn,Ki,gn,r,fo,qs||Hs,B),Wi=[t,e,k,ge,ze,qs?I:null,Hs?R:null];if(l){let me,Ye,Ae;if(bt){const Tt=m-f;if(!bt[Tt]){bt[Tt]={args:Wi,declutterMode:T};continue}const qt=bt[Tt];me=qt.args,Ye=qt.declutterMode,delete bt[Tt],Ae=bh(me)}let Qe,qe;if(me&&(Ye!=="declutter"||!l.collides(Ae))&&(Qe=!0),(T!=="declutter"||!l.collides(ge.declutterBox))&&(qe=!0),Ye==="declutter"&&T==="declutter"){const Tt=Qe&&qe;Qe=Tt,qe=Tt}Qe&&(Ye!=="none"&&l.insert(Ae),this.replayImageOrLabel_.apply(this,me)),qe&&(T!=="none"&&l.insert(ge.declutterBox),this.replayImageOrLabel_.apply(this,Wi))}else this.replayImageOrLabel_.apply(this,Wi)}++u;break;case W.DRAW_CHARS:const Dl=G[1],kl=G[2],go=G[3],fd=G[4];y=G[5];const gd=G[6],Gl=G[7],Bl=G[8];A=G[9];const mo=G[10];O=G[11],g=G[12];const zl=[G[13],G[13]];T=G[14]||"declutter";const Ao=this.textStates[g],qn=Ao.font,Hn=[Ao.scale[0]*Gl,Ao.scale[1]*Gl];let Jn;qn in this.widths_?Jn=this.widths_[qn]:(Jn={},this.widths_[qn]=Jn);const Yl=yu(c,Dl,kl,2),Ul=Math.abs(Hn[0])*hh(qn,O,Jn);if(fd||Ul<=Yl){const ge=this.textStates[g].textAlign,Wi=(Yl-Ul)*No(O,ge),me=C0(c,Dl,kl,2,O,Wi,gd,Math.abs(Hn[0]),hh,qn,Jn,M?0:this.viewRotation_);t:if(me){const Ye=[];let Ae,Qe,qe,Tt,qt;if(A)for(Ae=0,Qe=me.length;Ae<Qe;++Ae){qt=me[Ae],qe=qt[4],Tt=this.createLabel(qe,g,"",A),p=qt[2]+(Hn[0]<0?-mo:mo),x=go*Tt.height+(.5-go)*2*mo*Hn[1]/Hn[0]-Bl;const He=this.calculateImageOrLabelDimensions_(Tt.width,Tt.height,qt[0],qt[1],Tt.width,Tt.height,p,x,0,0,qt[3],zl,!1,Ji,!1,B);if(l&&T==="declutter"&&l.collides(He.declutterBox))break t;Ye.push([t,e,Tt,He,1,null,null])}if(y)for(Ae=0,Qe=me.length;Ae<Qe;++Ae){qt=me[Ae],qe=qt[4],Tt=this.createLabel(qe,g,y,""),p=qt[2],x=go*Tt.height-Bl;const He=this.calculateImageOrLabelDimensions_(Tt.width,Tt.height,qt[0],qt[1],Tt.width,Tt.height,p,x,0,0,qt[3],zl,!1,Ji,!1,B);if(l&&T==="declutter"&&l.collides(He.declutterBox))break t;Ye.push([t,e,Tt,He,1,null,null])}l&&T!=="none"&&l.load(Ye.map(bh));for(let He=0,md=Ye.length;He<md;++He)this.replayImageOrLabel_.apply(this,Ye[He])}}++u;break;case W.END_GEOMETRY:if(o!==void 0){B=G[1];const ge=o(B,it,T);if(ge)return ge}++u;break;case W.FILL:b?S++:this.fill_(t),++u;break;case W.MOVE_TO_LINE_TO:for(f=G[1],m=G[2],z=c[f],X=c[f+1],t.moveTo(z,X),_=z+.5|0,v=X+.5|0,f+=2;f<m;f+=2)z=c[f],X=c[f+1],P=z+.5|0,F=X+.5|0,(f==m-2||P!==_||F!==v)&&(t.lineTo(z,X),_=P,v=F);++u;break;case W.SET_FILL_STYLE:I=G,this.alignAndScaleFill_=G[2],S&&(this.fill_(t),S=0,C&&(t.stroke(),C=0)),t.fillStyle=G[1],++u;break;case W.SET_STROKE_STYLE:R=G,C&&(t.stroke(),C=0),this.setStrokeStyle_(t,G),++u;break;case W.STROKE:b?C++:t.stroke(),++u;break;default:++u;break}}S&&this.fill_(t),C&&t.stroke()}execute(t,e,i,n,r,o){this.viewRotation_=n,this.execute_(t,e,i,this.instructions,r,void 0,void 0,o)}executeHitDetection(t,e,i,n,r){return this.viewRotation_=i,this.execute_(t,[t.canvas.width,t.canvas.height],e,this.hitDetectionInstructions,!0,n,r)}}const Ln=["Polygon","Circle","LineString","Image","Text","Default"],Gr=["Image","Text"],S0=Ln.filter(s=>!Gr.includes(s));class Mu{constructor(t,e,i,n,r,o,a){this.maxExtent_=t,this.overlaps_=n,this.pixelRatio_=i,this.resolution_=e,this.renderBuffer_=o,this.executorsByZIndex_={},this.hitDetectionContext_=null,this.hitDetectionTransform_=we(),this.renderedContext_=null,this.deferredZIndexContexts_={},this.createExecutors_(r,a)}clip(t,e){const i=this.getClipCoords(e);t.beginPath(),t.moveTo(i[0],i[1]),t.lineTo(i[2],i[3]),t.lineTo(i[4],i[5]),t.lineTo(i[6],i[7]),t.clip()}createExecutors_(t,e){for(const i in t){let n=this.executorsByZIndex_[i];n===void 0&&(n={},this.executorsByZIndex_[i]=n);const r=t[i];for(const o in r){const a=r[o];n[o]=new T0(this.resolution_,this.pixelRatio_,this.overlaps_,a,e)}}}hasExecutors(t){for(const e in this.executorsByZIndex_){const i=this.executorsByZIndex_[e];for(let n=0,r=t.length;n<r;++n)if(t[n]in i)return!0}return!1}forEachFeatureAtCoordinate(t,e,i,n,r,o){n=Math.round(n);const a=n*2+1,l=di(this.hitDetectionTransform_,n+.5,n+.5,1/e,-1/e,-i,-t[0],-t[1]),h=!this.hitDetectionContext_;h&&(this.hitDetectionContext_=Rt(a,a,void 0,{willReadFrequently:!0}));const c=this.hitDetectionContext_;c.canvas.width!==a||c.canvas.height!==a?(c.canvas.width=a,c.canvas.height=a):h||c.clearRect(0,0,a,a);let u;this.renderBuffer_!==void 0&&(u=Se(),yr(u,t),be(u,e*(this.renderBuffer_+n),u));const d=R0(n);let f;function m(F,k,O){const g=c.getImageData(0,0,a,a).data;for(let A=0,y=d.length;A<y;A++)if(g[d[A]]>0){if(!o||O==="none"||f!=="Image"&&f!=="Text"||o.includes(F)){const S=(d[A]-3)/4,C=n-S%a,I=n-(S/a|0),R=r(F,k,C*C+I*I);if(R)return R}c.clearRect(0,0,a,a);break}}const p=Object.keys(this.executorsByZIndex_).map(Number);p.sort(je);let x,T,_,v,P;for(x=p.length-1;x>=0;--x){const F=p[x].toString();for(_=this.executorsByZIndex_[F],T=Ln.length-1;T>=0;--T)if(f=Ln[T],v=_[f],v!==void 0&&(P=v.executeHitDetection(c,l,i,m,u),P))return P}}getClipCoords(t){const e=this.maxExtent_;if(!e)return null;const i=e[0],n=e[1],r=e[2],o=e[3],a=[i,n,i,o,r,o,r,n];return bi(a,0,8,2,t,a),a}isEmpty(){return ki(this.executorsByZIndex_)}execute(t,e,i,n,r,o,a){const l=Object.keys(this.executorsByZIndex_).map(Number);l.sort(je),o=o||Ln;const h=Ln.length;let c,u,d,f,m;for(a&&l.reverse(),c=0,u=l.length;c<u;++c){const p=l[c].toString();for(m=this.executorsByZIndex_[p],d=0,f=o.length;d<f;++d){const x=o[d],T=m[x];if(T!==void 0){const _=a===null?void 0:T.getZIndexContext(),v=_?_.getContext():t,P=this.maxExtent_&&x!=="Image"&&x!=="Text";if(P&&(v.save(),this.clip(v,i)),!_||x==="Text"||x==="Image"?T.execute(v,e,i,n,r,a):_.pushFunction(F=>T.execute(F,e,i,n,r,a)),P&&v.restore(),_){_.offset();const F=l[c]*h+d;this.deferredZIndexContexts_[F]||(this.deferredZIndexContexts_[F]=[]),this.deferredZIndexContexts_[F].push(_)}}}}this.renderedContext_=t}getDeferredZIndexContexts(){return this.deferredZIndexContexts_}getRenderedContext(){return this.renderedContext_}renderDeferred(){const t=this.deferredZIndexContexts_,e=Object.keys(t).map(Number).sort(je);for(let i=0,n=e.length;i<n;++i)t[e[i]].forEach(r=>{r.draw(this.renderedContext_),r.clear()}),t[e[i]].length=0}}const Do={};function R0(s){if(Do[s]!==void 0)return Do[s];const t=s*2+1,e=s*s,i=new Array(e+1);for(let r=0;r<=s;++r)for(let o=0;o<=s;++o){const a=r*r+o*o;if(a>e)break;let l=i[a];l||(l=[],i[a]=l),l.push(((s+r)*t+(s+o))*4+3),r>0&&l.push(((s-r)*t+(s+o))*4+3),o>0&&(l.push(((s+r)*t+(s-o))*4+3),r>0&&l.push(((s-r)*t+(s-o))*4+3))}const n=[];for(let r=0,o=i.length;r<o;++r)i[r]&&n.push(...i[r]);return Do[s]=n,n}class I0 extends vu{constructor(t,e,i,n,r,o,a){super(),this.context_=t,this.pixelRatio_=e,this.extent_=i,this.transform_=n,this.transformRotation_=n?lc(Math.atan2(n[1],n[0]),10):0,this.viewRotation_=r,this.squaredTolerance_=o,this.userTransform_=a,this.contextFillState_=null,this.contextStrokeState_=null,this.contextTextState_=null,this.fillState_=null,this.strokeState_=null,this.image_=null,this.imageAnchorX_=0,this.imageAnchorY_=0,this.imageHeight_=0,this.imageOpacity_=0,this.imageOriginX_=0,this.imageOriginY_=0,this.imageRotateWithView_=!1,this.imageRotation_=0,this.imageScale_=[0,0],this.imageWidth_=0,this.text_="",this.textOffsetX_=0,this.textOffsetY_=0,this.textRotateWithView_=!1,this.textRotation_=0,this.textScale_=[0,0],this.textFillState_=null,this.textStrokeState_=null,this.textState_=null,this.pixelCoordinates_=[],this.tmpLocalTransform_=we()}drawImages_(t,e,i,n){if(!this.image_)return;const r=bi(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_,a=this.tmpLocalTransform_,l=o.globalAlpha;this.imageOpacity_!=1&&(o.globalAlpha=l*this.imageOpacity_);let h=this.imageRotation_;this.transformRotation_===0&&(h-=this.viewRotation_),this.imageRotateWithView_&&(h+=this.viewRotation_);for(let c=0,u=r.length;c<u;c+=2){const d=r[c]-this.imageAnchorX_,f=r[c+1]-this.imageAnchorY_;if(h!==0||this.imageScale_[0]!=1||this.imageScale_[1]!=1){const m=d+this.imageAnchorX_,p=f+this.imageAnchorY_;di(a,m,p,1,1,h,-m,-p),o.save(),o.transform.apply(o,a),o.translate(m,p),o.scale(this.imageScale_[0],this.imageScale_[1]),o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,-this.imageAnchorX_,-this.imageAnchorY_,this.imageWidth_,this.imageHeight_),o.restore()}else o.drawImage(this.image_,this.imageOriginX_,this.imageOriginY_,this.imageWidth_,this.imageHeight_,d,f,this.imageWidth_,this.imageHeight_)}this.imageOpacity_!=1&&(o.globalAlpha=l)}drawText_(t,e,i,n){if(!this.textState_||this.text_==="")return;this.textFillState_&&this.setContextFillState_(this.textFillState_),this.textStrokeState_&&this.setContextStrokeState_(this.textStrokeState_),this.setContextTextState_(this.textState_);const r=bi(t,e,i,n,this.transform_,this.pixelCoordinates_),o=this.context_;let a=this.textRotation_;for(this.transformRotation_===0&&(a-=this.viewRotation_),this.textRotateWithView_&&(a+=this.viewRotation_);e<i;e+=n){const l=r[e]+this.textOffsetX_,h=r[e+1]+this.textOffsetY_;a!==0||this.textScale_[0]!=1||this.textScale_[1]!=1?(o.save(),o.translate(l-this.textOffsetX_,h-this.textOffsetY_),o.rotate(a),o.translate(this.textOffsetX_,this.textOffsetY_),o.scale(this.textScale_[0],this.textScale_[1]),this.textStrokeState_&&o.strokeText(this.text_,0,0),this.textFillState_&&o.fillText(this.text_,0,0),o.restore()):(this.textStrokeState_&&o.strokeText(this.text_,l,h),this.textFillState_&&o.fillText(this.text_,l,h))}}moveToLineTo_(t,e,i,n,r){const o=this.context_,a=bi(t,e,i,n,this.transform_,this.pixelCoordinates_);o.moveTo(a[0],a[1]);let l=a.length;r&&(l-=2);for(let h=2;h<l;h+=2)o.lineTo(a[h],a[h+1]);return r&&o.closePath(),i}drawRings_(t,e,i,n){for(let r=0,o=i.length;r<o;++r)e=this.moveToLineTo_(t,e,i[r],n,!0);return e}drawCircle(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vt(this.extent_,t.getExtent())){if(this.fillState_||this.strokeState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=hf(t,this.transform_,this.pixelCoordinates_),i=e[2]-e[0],n=e[3]-e[1],r=Math.sqrt(i*i+n*n),o=this.context_;o.beginPath(),o.arc(e[0],e[1],r,0,2*Math.PI),this.fillState_&&o.fill(),this.strokeState_&&o.stroke()}this.text_!==""&&this.drawText_(t.getCenter(),0,2,2)}}setStyle(t){this.setFillStrokeStyle(t.getFill(),t.getStroke()),this.setImageStyle(t.getImage()),this.setTextStyle(t.getText())}setTransform(t){this.transform_=t}drawGeometry(t){switch(t.getType()){case"Point":this.drawPoint(t);break;case"LineString":this.drawLineString(t);break;case"Polygon":this.drawPolygon(t);break;case"MultiPoint":this.drawMultiPoint(t);break;case"MultiLineString":this.drawMultiLineString(t);break;case"MultiPolygon":this.drawMultiPolygon(t);break;case"GeometryCollection":this.drawGeometryCollection(t);break;case"Circle":this.drawCircle(t);break}}drawFeature(t,e){const i=e.getGeometryFunction()(t);i&&(this.setStyle(e),this.drawGeometry(i))}drawGeometryCollection(t){const e=t.getGeometriesArray();for(let i=0,n=e.length;i<n;++i)this.drawGeometry(e[i])}drawPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawMultiPoint(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getFlatCoordinates(),i=t.getStride();this.image_&&this.drawImages_(e,0,e.length,i),this.text_!==""&&this.drawText_(e,0,e.length,i)}drawLineString(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vt(this.extent_,t.getExtent())){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getFlatCoordinates();e.beginPath(),this.moveToLineTo_(i,0,i.length,t.getStride(),!1),e.stroke()}if(this.text_!==""){const e=t.getFlatMidpoint();this.drawText_(e,0,2,2)}}}drawMultiLineString(t){this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_));const e=t.getExtent();if(vt(this.extent_,e)){if(this.strokeState_){this.setContextStrokeState_(this.strokeState_);const i=this.context_,n=t.getFlatCoordinates();let r=0;const o=t.getEnds(),a=t.getStride();i.beginPath();for(let l=0,h=o.length;l<h;++l)r=this.moveToLineTo_(n,r,o[l],a,!1);i.stroke()}if(this.text_!==""){const i=t.getFlatMidpoints();this.drawText_(i,0,i.length,2)}}}drawPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_;e.beginPath(),this.drawRings_(t.getOrientedFlatCoordinates(),0,t.getEnds(),t.getStride()),this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoint();this.drawText_(e,0,2,2)}}}drawMultiPolygon(t){if(this.squaredTolerance_&&(t=t.simplifyTransformed(this.squaredTolerance_,this.userTransform_)),!!vt(this.extent_,t.getExtent())){if(this.strokeState_||this.fillState_){this.fillState_&&this.setContextFillState_(this.fillState_),this.strokeState_&&this.setContextStrokeState_(this.strokeState_);const e=this.context_,i=t.getOrientedFlatCoordinates();let n=0;const r=t.getEndss(),o=t.getStride();e.beginPath();for(let a=0,l=r.length;a<l;++a){const h=r[a];n=this.drawRings_(i,n,h,o)}this.fillState_&&e.fill(),this.strokeState_&&e.stroke()}if(this.text_!==""){const e=t.getFlatInteriorPoints();this.drawText_(e,0,e.length,2)}}}setContextFillState_(t){const e=this.context_,i=this.contextFillState_;i?i.fillStyle!=t.fillStyle&&(i.fillStyle=t.fillStyle,e.fillStyle=t.fillStyle):(e.fillStyle=t.fillStyle,this.contextFillState_={fillStyle:t.fillStyle})}setContextStrokeState_(t){const e=this.context_,i=this.contextStrokeState_;i?(i.lineCap!=t.lineCap&&(i.lineCap=t.lineCap,e.lineCap=t.lineCap),zi(i.lineDash,t.lineDash)||e.setLineDash(i.lineDash=t.lineDash),i.lineDashOffset!=t.lineDashOffset&&(i.lineDashOffset=t.lineDashOffset,e.lineDashOffset=t.lineDashOffset),i.lineJoin!=t.lineJoin&&(i.lineJoin=t.lineJoin,e.lineJoin=t.lineJoin),i.lineWidth!=t.lineWidth&&(i.lineWidth=t.lineWidth,e.lineWidth=t.lineWidth),i.miterLimit!=t.miterLimit&&(i.miterLimit=t.miterLimit,e.miterLimit=t.miterLimit),i.strokeStyle!=t.strokeStyle&&(i.strokeStyle=t.strokeStyle,e.strokeStyle=t.strokeStyle)):(e.lineCap=t.lineCap,e.setLineDash(t.lineDash),e.lineDashOffset=t.lineDashOffset,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.strokeStyle=t.strokeStyle,this.contextStrokeState_={lineCap:t.lineCap,lineDash:t.lineDash,lineDashOffset:t.lineDashOffset,lineJoin:t.lineJoin,lineWidth:t.lineWidth,miterLimit:t.miterLimit,strokeStyle:t.strokeStyle})}setContextTextState_(t){const e=this.context_,i=this.contextTextState_,n=t.textAlign?t.textAlign:ws;i?(i.font!=t.font&&(i.font=t.font,e.font=t.font),i.textAlign!=n&&(i.textAlign=n,e.textAlign=n),i.textBaseline!=t.textBaseline&&(i.textBaseline=t.textBaseline,e.textBaseline=t.textBaseline)):(e.font=t.font,e.textAlign=n,e.textBaseline=t.textBaseline,this.contextTextState_={font:t.font,textAlign:n,textBaseline:t.textBaseline})}setFillStrokeStyle(t,e){if(!t)this.fillState_=null;else{const i=t.getColor();this.fillState_={fillStyle:Ke(i||ne)}}if(!e)this.strokeState_=null;else{const i=e.getColor(),n=e.getLineCap(),r=e.getLineDash(),o=e.getLineDashOffset(),a=e.getLineJoin(),l=e.getWidth(),h=e.getMiterLimit(),c=r||ai;this.strokeState_={lineCap:n!==void 0?n:Gn,lineDash:this.pixelRatio_===1?c:c.map(u=>u*this.pixelRatio_),lineDashOffset:(o||li)*this.pixelRatio_,lineJoin:a!==void 0?a:Bn,lineWidth:(l!==void 0?l:Ts)*this.pixelRatio_,miterLimit:h!==void 0?h:Es,strokeStyle:Ke(i||Cs)}}}setImageStyle(t){let e;if(!t||!(e=t.getSize())){this.image_=null;return}const i=t.getPixelRatio(this.pixelRatio_),n=t.getAnchor(),r=t.getOrigin();this.image_=t.getImage(this.pixelRatio_),this.imageAnchorX_=n[0]*i,this.imageAnchorY_=n[1]*i,this.imageHeight_=e[1]*i,this.imageOpacity_=t.getOpacity(),this.imageOriginX_=r[0],this.imageOriginY_=r[1],this.imageRotateWithView_=t.getRotateWithView(),this.imageRotation_=t.getRotation();const o=t.getScaleArray();this.imageScale_=[o[0]*this.pixelRatio_/i,o[1]*this.pixelRatio_/i],this.imageWidth_=e[0]*i}setTextStyle(t){if(!t)this.text_="";else{const e=t.getFill();if(!e)this.textFillState_=null;else{const f=e.getColor();this.textFillState_={fillStyle:Ke(f||ne)}}const i=t.getStroke();if(!i)this.textStrokeState_=null;else{const f=i.getColor(),m=i.getLineCap(),p=i.getLineDash(),x=i.getLineDashOffset(),T=i.getLineJoin(),_=i.getWidth(),v=i.getMiterLimit();this.textStrokeState_={lineCap:m!==void 0?m:Gn,lineDash:p||ai,lineDashOffset:x||li,lineJoin:T!==void 0?T:Bn,lineWidth:_!==void 0?_:Ts,miterLimit:v!==void 0?v:Es,strokeStyle:Ke(f||Cs)}}const n=t.getFont(),r=t.getOffsetX(),o=t.getOffsetY(),a=t.getRotateWithView(),l=t.getRotation(),h=t.getScaleArray(),c=t.getText(),u=t.getTextAlign(),d=t.getTextBaseline();this.textState_={font:n!==void 0?n:Yc,textAlign:u!==void 0?u:ws,textBaseline:d!==void 0?d:Lr},this.text_=c!==void 0?Array.isArray(c)?c.reduce((f,m,p)=>f+=p%2?" ":m,""):c:"",this.textOffsetX_=r!==void 0?this.pixelRatio_*r:0,this.textOffsetY_=o!==void 0?this.pixelRatio_*o:0,this.textRotateWithView_=a!==void 0?a:!1,this.textRotation_=l!==void 0?l:0,this.textScale_=[this.pixelRatio_*h[0],this.pixelRatio_*h[1]]}}}const he=.5;function Pu(s,t,e,i,n,r,o,a,l){const h=l?Da(n):n,c=s[0]*he,u=s[1]*he,d=Rt(c,u);d.imageSmoothingEnabled=!1;const f=d.canvas,m=new I0(d,he,n,null,o,a,l?Ld(Md(),l):null),p=e.length,x=Math.floor((256*256*256-1)/p),T={};for(let v=1;v<=p;++v){const P=e[v-1],F=P.getStyleFunction()||i;if(!F)continue;let k=F(P,r);if(!k)continue;Array.isArray(k)||(k=[k]);const g=(v*x).toString(16).padStart(7,"#00000");for(let A=0,y=k.length;A<y;++A){const S=k[A],C=S.getGeometryFunction()(P);if(!C||!vt(h,C.getExtent()))continue;const I=S.clone(),R=I.getFill();R&&R.setColor(g);const w=I.getStroke();w&&(w.setColor(g),w.setLineDash(null)),I.setText(void 0);const E=S.getImage();if(E){const B=E.getImageSize();if(!B)continue;const z=Rt(B[0],B[1],void 0,{alpha:!1}),X=z.canvas;z.fillStyle=g,z.fillRect(0,0,X.width,X.height),I.setImage(new fi({img:X,anchor:E.getAnchor(),anchorXUnits:"pixels",anchorYUnits:"pixels",offset:E.getOrigin(),opacity:1,size:E.getSize(),scale:E.getScale(),rotation:E.getRotation(),rotateWithView:E.getRotateWithView()}))}const M=I.getZIndex()||0;let L=T[M];L||(L={},T[M]=L,L.Polygon=[],L.Circle=[],L.LineString=[],L.Point=[]);const b=C.getType();if(b==="GeometryCollection"){const B=C.getGeometriesArrayRecursive();for(let z=0,X=B.length;z<X;++z){const it=B[z];L[it.getType().replace("Multi","")].push(it,I)}}else L[b.replace("Multi","")].push(C,I)}}const _=Object.keys(T).map(Number).sort(je);for(let v=0,P=_.length;v<P;++v){const F=T[_[v]];for(const k in F){const O=F[k];for(let g=0,A=O.length;g<A;g+=2){m.setStyle(O[g+1]);for(let y=0,S=t.length;y<S;++y)m.setTransform(t[y]),m.drawGeometry(O[g])}}}return d.getImageData(0,0,f.width,f.height)}function Fu(s,t,e){const i=[];if(e){const n=Math.floor(Math.round(s[0])*he),r=Math.floor(Math.round(s[1])*he),o=(wt(n,0,e.width-1)+wt(r,0,e.height-1)*e.width)*4,a=e.data[o],l=e.data[o+1],c=e.data[o+2]+256*(l+256*a),u=Math.floor((256*256*256-1)/t.length);c&&c%u===0&&i.push(t[c/u-1])}return i}const v0=.5,bu={Point:D0,LineString:b0,Polygon:G0,MultiPoint:k0,MultiLineString:O0,MultiPolygon:N0,GeometryCollection:F0,Circle:M0};function L0(s,t){return parseInt(J(s),10)-parseInt(J(t),10)}function _a(s,t){const e=Ou(s,t);return e*e}function Ou(s,t){return v0*s/t}function M0(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const l=s.getBuilder(e.getZIndex(),"Circle");l.setFillStrokeStyle(r,o),l.drawCircle(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i)}}function Br(s,t,e,i,n,r,o,a){const l=[],h=e.getImage();if(h){let d=!0;const f=h.getImageState();f==nt.LOADED||f==nt.ERROR?d=!1:f==nt.IDLE&&h.load(),d&&l.push(h.ready())}const c=e.getFill();c&&c.loading()&&l.push(c.ready());const u=l.length>0;return u&&Promise.all(l).then(()=>n(null)),P0(s,t,e,i,r,o,a),u}function P0(s,t,e,i,n,r,o){const a=e.getGeometryFunction()(t);if(!a)return;const l=a.simplifyTransformed(i,n);if(e.getRenderer())Nu(s,l,e,t,o);else{const c=bu[l.getType()];c(s,l,e,t,o,r)}}function Nu(s,t,e,i,n){if(t.getType()=="GeometryCollection"){const o=t.getGeometries();for(let a=0,l=o.length;a<l;++a)Nu(s,o[a],e,i,n);return}s.getBuilder(e.getZIndex(),"Default").drawCustom(t,i,e.getRenderer(),e.getHitDetectionRenderer(),n)}function F0(s,t,e,i,n,r){const o=t.getGeometriesArray();let a,l;for(a=0,l=o.length;a<l;++a){const h=bu[o[a].getType()];h(s,o[a],e,i,n,r)}}function b0(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=s.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function O0(s,t,e,i,n){const r=e.getStroke();if(r){const a=s.getBuilder(e.getZIndex(),"LineString");a.setFillStrokeStyle(null,r),a.drawMultiLineString(t,i,n)}const o=e.getText();if(o&&o.getText()){const a=s.getBuilder(e.getZIndex(),"Text");a.setTextStyle(o),a.drawText(t,i,n)}}function N0(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(o||r){const l=s.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawMultiPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}function D0(s,t,e,i,n,r){const o=e.getImage(),a=e.getText(),l=a&&a.getText(),h=r&&o&&l?{}:void 0;if(o){if(o.getImageState()!=nt.LOADED)return;const c=s.getBuilder(e.getZIndex(),"Image");c.setImageStyle(o,h),c.drawPoint(t,i,n)}if(l){const c=s.getBuilder(e.getZIndex(),"Text");c.setTextStyle(a,h),c.drawText(t,i,n)}}function k0(s,t,e,i,n,r){const o=e.getImage(),a=o&&o.getOpacity()!==0,l=e.getText(),h=l&&l.getText(),c=r&&a&&h?{}:void 0;if(a){if(o.getImageState()!=nt.LOADED)return;const u=s.getBuilder(e.getZIndex(),"Image");u.setImageStyle(o,c),u.drawMultiPoint(t,i,n)}if(h){const u=s.getBuilder(e.getZIndex(),"Text");u.setTextStyle(l,c),u.drawText(t,i,n)}}function G0(s,t,e,i,n){const r=e.getFill(),o=e.getStroke();if(r||o){const l=s.getBuilder(e.getZIndex(),"Polygon");l.setFillStrokeStyle(r,o),l.drawPolygon(t,i,n)}const a=e.getText();if(a&&a.getText()){const l=s.getBuilder(e.getZIndex(),"Text");l.setTextStyle(a),l.drawText(t,i,n)}}class B0 extends Su{constructor(t){super(t),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.animatingOrInteracting_,this.hitDetectionImageData_=null,this.clipped_=!1,this.renderedFeatures_=null,this.renderedRevision_=-1,this.renderedResolution_=NaN,this.renderedExtent_=Se(),this.wrappedRenderedExtent_=Se(),this.renderedRotation_,this.renderedCenter_=null,this.renderedProjection_=null,this.renderedPixelRatio_=1,this.renderedRenderOrder_=null,this.renderedFrameDeclutter_,this.replayGroup_=null,this.replayGroupChanged=!0,this.clipping=!0,this.targetContext_=null,this.opacity_=1}renderWorlds(t,e,i){const n=e.extent,r=e.viewState,o=r.center,a=r.resolution,l=r.projection,h=r.rotation,c=l.getExtent(),u=this.getLayer().getSource(),d=this.getLayer().getDeclutter(),f=e.pixelRatio,m=e.viewHints,p=!(m[St.ANIMATING]||m[St.INTERACTING]),x=this.context,T=Math.round(yt(n)/a*f),_=Math.round(Wt(n)/a*f),v=u.getWrapX()&&l.canWrapX(),P=v?yt(c):null,F=v?Math.ceil((n[2]-c[2])/P)+1:1;let k=v?Math.floor((n[0]-c[0])/P):0;do{let O=this.getRenderTransform(o,a,0,f,T,_,k*P);e.declutter&&(O=O.slice(0)),t.execute(x,[x.canvas.width,x.canvas.height],O,h,p,i===void 0?Ln:i?Gr:S0,i?d&&e.declutter[d]:void 0)}while(++k<F)}setDrawContext_(){this.opacity_!==1&&(this.targetContext_=this.context,this.context=Rt(this.context.canvas.width,this.context.canvas.height,Lh))}resetDrawContext_(){if(this.opacity_!==1){const t=this.targetContext_.globalAlpha;this.targetContext_.globalAlpha=this.opacity_,this.targetContext_.drawImage(this.context.canvas,0,0),this.targetContext_.globalAlpha=t,sn(this.context),Lh.push(this.context.canvas),this.context=this.targetContext_,this.targetContext_=null}}renderDeclutter(t){!this.replayGroup_||!this.getLayer().getDeclutter()||this.renderWorlds(this.replayGroup_,t,!0)}renderDeferredInternal(t){this.replayGroup_&&(this.replayGroup_.renderDeferred(),this.clipped_&&this.context.restore(),this.resetDrawContext_())}renderFrame(t,e){const i=t.layerStatesArray[t.layerIndex];this.opacity_=i.opacity;const n=t.viewState;this.prepareContainer(t,e);const r=this.context,o=this.replayGroup_;let a=o&&!o.isEmpty();if(!a&&!(this.getLayer().hasListener(Ee.PRERENDER)||this.getLayer().hasListener(Ee.POSTRENDER)))return null;if(this.setDrawContext_(),this.preRender(r,t),n.projection,this.clipped_=!1,a&&i.extent&&this.clipping){const l=Ii(i.extent);a=vt(l,t.extent),this.clipped_=a&&!Ri(l,t.extent),this.clipped_&&this.clipUnrotated(r,t,l)}return a&&this.renderWorlds(o,t,this.getLayer().getDeclutter()?!1:void 0),!t.declutter&&this.clipped_&&r.restore(),this.postRender(r,t),this.renderedRotation_!==n.rotation&&(this.renderedRotation_=n.rotation,this.hitDetectionImageData_=null),t.declutter||this.resetDrawContext_(),this.container}getFeatures(t){return new Promise(e=>{if(this.frameState&&!this.hitDetectionImageData_&&!this.animatingOrInteracting_){const i=this.frameState.size.slice(),n=this.renderedCenter_,r=this.renderedResolution_,o=this.renderedRotation_,a=this.renderedProjection_,l=this.wrappedRenderedExtent_,h=this.getLayer(),c=[],u=i[0]*he,d=i[1]*he;c.push(this.getRenderTransform(n,r,o,he,u,d,0).slice());const f=h.getSource(),m=a.getExtent();if(f.getWrapX()&&a.canWrapX()&&!Ri(m,l)){let p=l[0];const x=yt(m);let T=0,_;for(;p<m[0];)--T,_=x*T,c.push(this.getRenderTransform(n,r,o,he,u,d,_).slice()),p+=x;for(T=0,p=l[2];p>m[2];)++T,_=x*T,c.push(this.getRenderTransform(n,r,o,he,u,d,_).slice()),p-=x}this.hitDetectionImageData_=Pu(i,c,this.renderedFeatures_,h.getStyleFunction(),l,r,o,_a(r,this.renderedPixelRatio_),null)}e(Fu(t,this.renderedFeatures_,this.hitDetectionImageData_))})}forEachFeatureAtCoordinate(t,e,i,n,r){if(!this.replayGroup_)return;const o=e.viewState.resolution,a=e.viewState.rotation,l=this.getLayer(),h={},c=function(m,p,x){const T=J(m),_=h[T];if(_){if(_!==!0&&x<_.distanceSq){if(x===0)return h[T]=!0,r.splice(r.lastIndexOf(_),1),n(m,l,p);_.geometry=p,_.distanceSq=x}}else{if(x===0)return h[T]=!0,n(m,l,p);r.push(h[T]={feature:m,layer:l,geometry:p,distanceSq:x,callback:n})}};let u;const d=[this.replayGroup_],f=this.getLayer().getDeclutter();return d.some(m=>u=m.forEachFeatureAtCoordinate(t,o,a,i,c,f&&e.declutter[f]?e.declutter[f].all().map(p=>p.value):null)),u}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.replayGroup_&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}prepareFrame(t){const e=this.getLayer(),i=e.getSource();if(!i)return!1;const n=t.viewHints[St.ANIMATING],r=t.viewHints[St.INTERACTING],o=e.getUpdateWhileAnimating(),a=e.getUpdateWhileInteracting();if(this.ready&&!o&&n||!a&&r)return this.animatingOrInteracting_=!0,!0;this.animatingOrInteracting_=!1;const l=t.extent,h=t.viewState,c=h.projection,u=h.resolution,d=t.pixelRatio,f=e.getRevision(),m=e.getRenderBuffer();let p=e.getRenderOrder();p===void 0&&(p=L0);const x=h.center.slice(),T=be(l,m*u),_=T.slice(),v=[T.slice()],P=c.getExtent();if(i.getWrapX()&&c.canWrapX()&&!Ri(P,t.extent)){const R=yt(P),w=Math.max(yt(T)/2,R);T[0]=P[0]-w,T[2]=P[2]+w,ka(x,c);const E=Pd(v[0],c);E[0]<P[0]&&E[2]<P[2]?v.push([E[0]+R,E[1],E[2]+R,E[3]]):E[0]>P[0]&&E[2]>P[2]&&v.push([E[0]-R,E[1],E[2]-R,E[3]])}if(this.ready&&this.renderedResolution_==u&&this.renderedRevision_==f&&this.renderedRenderOrder_==p&&this.renderedFrameDeclutter_===!!t.declutter&&Ri(this.wrappedRenderedExtent_,T))return zi(this.renderedExtent_,_)||(this.hitDetectionImageData_=null,this.renderedExtent_=_),this.renderedCenter_=x,this.replayGroupChanged=!1,!0;this.replayGroup_=null;const F=new Lu(Ou(u,d),T,u,d);let k;for(let R=0,w=v.length;R<w;++R)i.loadFeatures(v[R],u,c);const O=_a(u,d);let g=!0;const A=(R,w)=>{let E;const M=R.getStyleFunction()||e.getStyleFunction();if(M&&(E=M(R,u)),E){const L=this.renderFeature(R,O,E,F,k,this.getLayer().getDeclutter(),w);g=g&&!L}},y=Da(T),S=i.getFeaturesInExtent(y);p&&S.sort(p);for(let R=0,w=S.length;R<w;++R)A(S[R],R);this.renderedFeatures_=S,this.ready=g;const C=F.finish(),I=new Mu(T,u,d,i.getOverlaps(),C,e.getRenderBuffer(),!!t.declutter);return this.renderedResolution_=u,this.renderedRevision_=f,this.renderedRenderOrder_=p,this.renderedFrameDeclutter_=!!t.declutter,this.renderedExtent_=_,this.wrappedRenderedExtent_=T,this.renderedCenter_=x,this.renderedProjection_=c,this.renderedPixelRatio_=d,this.replayGroup_=I,this.hitDetectionImageData_=null,this.replayGroupChanged=!0,!0}renderFeature(t,e,i,n,r,o,a){if(!i)return!1;let l=!1;if(Array.isArray(i))for(let h=0,c=i.length;h<c;++h)l=Br(n,t,i[h],e,this.boundHandleStyleImageChange_,r,o,a)||l;else l=Br(n,t,i,e,this.boundHandleStyleImageChange_,r,o,a);return l}}class Be extends ml{constructor(t){super(t)}createRenderer(){return new B0(this)}}const z0={image:["Polygon","Circle","LineString","Image","Text"],hybrid:["Polygon","LineString"],vector:[]},Nh={hybrid:["Image","Text","Default"],vector:["Polygon","Circle","LineString","Image","Text","Default"]};class Y0 extends Ru{constructor(t,e){super(t,e),this.boundHandleStyleImageChange_=this.handleStyleImageChange_.bind(this),this.renderedLayerRevision_,this.renderedPixelToCoordinateTransform_=null,this.renderedRotation_,this.renderedOpacity_=1,this.tmpTransform_=we(),this.tileClipContexts_=null}drawTile(t,e,i,n,r,o,a,l){this.updateExecutorGroup_(t,e.pixelRatio,e.viewState.projection),this.tileImageNeedsRender_(t)&&this.renderTileImage_(t,e),super.drawTile(t,e,i,n,r,o,a,l)}getTile(t,e,i,n){const r=this.getOrCreateTile(t,e,i,n);if(!r)return null;const a=n.viewState.resolution,l=n.viewHints;return(!(l[St.ANIMATING]||l[St.INTERACTING])||!r.wantedResolution)&&(r.wantedResolution=a),r}prepareFrame(t){const e=this.getLayer().getRevision();return this.renderedLayerRevision_!==e&&(this.renderedLayerRevision_=e,this.renderedTiles.length=0),super.prepareFrame(t)}updateExecutorGroup_(t,e,i){const n=this.getLayer(),r=n.getRevision(),o=n.getRenderOrder()||null,a=t.wantedResolution,l=t.getReplayState(n);if(!l.dirty&&l.renderedResolution===a&&l.renderedRevision==r&&l.renderedRenderOrder==o)return;const h=n.getSource(),c=!!n.getDeclutter(),u=h.getTileGrid(),f=h.getTileGridForProjection(i).getTileCoordExtent(t.wrappedTileCoord),m=h.getSourceTiles(e,i,t),p=J(n);delete t.hitDetectionImageData[p],t.executorGroups[p]=[],l.dirty=!1;for(let x=0,T=m.length;x<T;++x){const _=m[x];if(_.getState()!=Y.LOADED)continue;const v=_.tileCoord,P=u.getTileCoordExtent(v),F=ce(f,P),k=be(F,n.getRenderBuffer()*a,this.tempExtent),O=bn(P,F)?null:k,g=new Lu(0,F,a,e),A=_a(a,e),y=function(w,E){let M;const L=w.getStyleFunction()||n.getStyleFunction();if(L&&(M=L(w,a)),M){const b=this.renderFeature(w,A,M,g,c,E);l.dirty=l.dirty||b}},S=_.getFeatures();o&&o!==l.renderedRenderOrder&&S.sort(o);for(let w=0,E=S.length;w<E;++w){const M=S[w];(!O||vt(O,M.getGeometry().getExtent()))&&y.call(this,M,w)}const C=g.finish(),I=n.getRenderMode()!=="vector"&&c&&m.length===1?null:F,R=new Mu(I,a,e,h.getOverlaps(),C,n.getRenderBuffer(),!0);t.executorGroups[p].push(R)}l.renderedRevision=r,l.renderedRenderOrder=o,l.renderedResolution=a}forEachFeatureAtCoordinate(t,e,i,n,r){const o=e.viewState.resolution,a=e.viewState.rotation;i=i??0;const l=this.getLayer(),c=l.getSource().getTileGridForProjection(e.viewState.projection),u=Tr([t]);be(u,o*i,u);const d={},f=function(x,T,_){let v=x.getId();v===void 0&&(v=J(x));const P=d[v];if(P){if(P!==!0&&_<P.distanceSq){if(_===0)return d[v]=!0,r.splice(r.lastIndexOf(P),1),n(x,l,T);P.geometry=T,P.distanceSq=_}}else{if(_===0)return d[v]=!0,n(x,l,T);r.push(d[v]={feature:x,layer:l,geometry:T,distanceSq:_,callback:n})}},m=this.renderedTiles;let p;for(let x=0,T=m.length;!p&&x<T;++x){const _=m[x],v=c.getTileCoordExtent(_.wrappedTileCoord);if(!vt(v,u))continue;const P=J(l),F=[_.executorGroups[P]],k=l.getDeclutter();F.some(O=>{const g=k?e.declutter[k].all().map(A=>A.value):null;for(let A=0,y=O.length;A<y;++A)if(p=O[A].forEachFeatureAtCoordinate(t,o,a,i,f,g),p)return!0})}return p}getFeatures(t){return new Promise((e,i)=>{const n=this.getLayer(),r=J(n),o=n.getSource(),a=this.renderedProjection,l=a.getExtent(),h=this.renderedResolution,c=o.getTileGridForProjection(a),u=Nt(this.renderedPixelToCoordinateTransform_,t.slice()),d=c.getTileCoordForCoordAndResolution(u,h);let f;for(let v=0,P=this.renderedTiles.length;v<P;++v)if(d.toString()===this.renderedTiles[v].tileCoord.toString()){if(f=this.renderedTiles[v],f.getState()===Y.LOADED){const F=c.getTileCoordExtent(f.tileCoord);o.getWrapX()&&a.canWrapX()&&!Ri(l,F)&&ka(u,a);break}f=void 0}if(!f||f.loadingSourceTiles>0){e([]);return}const m=c.getTileCoordExtent(f.wrappedTileCoord),p=Un(m),x=[(u[0]-p[0])/h,(p[1]-u[1])/h],T=f.getSourceTiles().reduce(function(v,P){return v.concat(P.getFeatures())},[]);let _=f.hitDetectionImageData[r];if(!_){const v=Bt(c.getTileSize(c.getZForResolution(h,o.zDirection))),P=this.renderedRotation_,F=[this.getRenderTransform(c.getTileCoordCenter(f.wrappedTileCoord),h,0,he,v[0]*he,v[1]*he,0)];_=Pu(v,F,T,n.getStyleFunction(),c.getTileCoordExtent(f.wrappedTileCoord),f.getReplayState(n).renderedResolution,P),f.hitDetectionImageData[r]=_}e(Fu(x,T,_))})}getFeaturesInExtent(t){const e=[],i=this.getTileCache();if(i.getCount()===0)return e;const n=this.getLayer().getSource().tileGrid,r=n.getZForResolution(this.renderedResolution);return i.forEach(o=>{if(o.tileCoord[0]!==r||o.getState()!==Y.LOADED)return;const a=o.getSourceTiles();for(let l=0,h=a.length;l<h;++l){const c=a[l],u=c.tileCoord;if(vt(t,n.getTileCoordExtent(u))){const d=c.getFeatures();if(d)for(let f=0,m=d.length;f<m;++f){const p=d[f],x=p.getGeometry();vt(t,x.getExtent())&&e.push(p)}}}}),e}handleFontsChanged(){const t=this.getLayer();t.getVisible()&&this.renderedLayerRevision_!==void 0&&t.changed()}handleStyleImageChange_(t){this.renderIfReadyAndVisible()}renderDeclutter(t,e){const i=this.context,n=i.globalAlpha;i.globalAlpha=e.opacity;const r=t.viewHints,o=!(r[St.ANIMATING]||r[St.INTERACTING]),a=this.renderedTiles;for(let l=0,h=a.length;l<h;++l){const c=a[l],u=c.executorGroups[J(this.getLayer())],d=this.getLayer().getDeclutter();if(u)for(let f=u.length-1;f>=0;--f)u[f].execute(this.context,[this.context.canvas.width,this.context.canvas.height],this.getTileRenderTransform(c,t),t.viewState.rotation,o,Gr,d?t.declutter[d]:void 0)}i.globalAlpha=n}renderDeferredInternal(t){const i=this.renderedTiles.reduce((a,l,h)=>(l.executorGroups[J(this.getLayer())].forEach(c=>a.push({executorGroup:c,index:h})),a),[]),n=i.map(({executorGroup:a})=>a.getDeferredZIndexContexts()),r={};for(let a=0,l=i.length;a<l;++a){const h=i[a].executorGroup.getDeferredZIndexContexts();for(const c in h)r[c]=!0}Object.keys(r).sort(je).map(Number).forEach(a=>{n.forEach((l,h)=>{l[a]&&(l[a].forEach(c=>{const{executorGroup:u,index:d}=i[h],f=u.getRenderedContext(),m=f.globalAlpha;f.globalAlpha=this.renderedOpacity_;const p=this.tileClipContexts_[d];p&&p.draw(f),c.draw(f),p&&f.restore(),f.globalAlpha=m,c.clear()}),l[a].length=0)})})}getTileRenderTransform(t,e){const i=e.pixelRatio,n=e.viewState,r=n.center,o=n.resolution,a=n.rotation,l=e.size,h=Math.round(l[0]*i),c=Math.round(l[1]*i),d=this.getLayer().getSource().getTileGridForProjection(e.viewState.projection),f=t.tileCoord,m=d.getTileCoordExtent(t.wrappedTileCoord),p=d.getTileCoordExtent(f,this.tempExtent)[0]-m[0];return ja(_o(this.inversePixelTransform.slice(),1/i,1/i),this.getRenderTransform(r,o,a,i,h,c,p))}postRender(t,e){var P;const i=e.viewHints,n=!(i[St.ANIMATING]||i[St.INTERACTING]);this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice(),this.renderedRotation_=e.viewState.rotation,this.renderedOpacity_=e.layerStatesArray[e.layerIndex].opacity;const r=this.getLayer(),o=r.getRenderMode(),a=t.globalAlpha;t.globalAlpha=this.renderedOpacity_;const l=r.getDeclutter(),h=l?Nh[o].filter(F=>!Gr.includes(F)):Nh[o],c=e.viewState,u=c.rotation,d=r.getSource(),m=d.getTileGridForProjection(c.projection).getZForResolution(c.resolution,d.zDirection),p=this.renderedTiles,x=[],T=[],_=[];let v=!0;for(let F=p.length-1;F>=0;--F){const k=p[F];v=v&&!k.getReplayState(r).dirty;const O=k.executorGroups[J(r)].filter(R=>R.hasExecutors(h));if(O.length===0)continue;const g=this.getTileRenderTransform(k,e),A=k.tileCoord[0];let y=!1;const S=O[0].getClipCoords(g);let C=t,I;if(S){I=new Sl,C=I.getContext();for(let R=0,w=x.length;R<w;++R)if(m!==A&&A<T[R]){const E=x[R];vt([S[0],S[3],S[4],S[7]],[E[0],E[3],E[4],E[7]])&&(y||(C.save(),y=!0),C.beginPath(),C.moveTo(S[0],S[1]),C.lineTo(S[2],S[3]),C.lineTo(S[4],S[5]),C.lineTo(S[6],S[7]),C.moveTo(E[6],E[7]),C.lineTo(E[4],E[5]),C.lineTo(E[2],E[3]),C.lineTo(E[0],E[1]),C.clip())}x.push(S),T.push(A)}for(let R=0,w=O.length;R<w;++R)O[R].execute(t,[t.canvas.width,t.canvas.height],g,u,n,h,(P=e.declutter)==null?void 0:P[l]);y&&(C===t?C.restore():_[F]=I)}t.globalAlpha=a,this.ready=v,this.tileClipContexts_=_,e.declutter||this.renderDeferredInternal(e),super.postRender(t,e)}renderFeature(t,e,i,n,r,o){if(!i)return!1;let a=!1;if(Array.isArray(i))for(let l=0,h=i.length;l<h;++l)a=Br(n,t,i[l],e,this.boundHandleStyleImageChange_,void 0,r,o)||a;else a=Br(n,t,i,e,this.boundHandleStyleImageChange_,void 0,r,o);return a}tileImageNeedsRender_(t){const e=this.getLayer();if(e.getRenderMode()==="vector")return!1;const i=t.getReplayState(e),n=e.getRevision(),r=t.wantedResolution;return i.renderedTileResolution!==r||i.renderedTileRevision!==n}renderTileImage_(t,e){const i=this.getLayer(),n=t.getReplayState(i),r=i.getRevision(),o=t.executorGroups[J(i)];n.renderedTileRevision=r;const a=t.wrappedTileCoord,l=a[0],h=i.getSource();let c=e.pixelRatio;const d=e.viewState.projection,f=h.getTileGridForProjection(d),m=f.getResolution(t.tileCoord[0]),p=e.pixelRatio/t.wantedResolution*m,x=f.getResolution(l),T=t.getContext();c=Math.round(Math.max(c,p/c));const _=h.getTilePixelSize(l,c,d);T.canvas.width=_[0],T.canvas.height=_[1];const v=c/p;if(v!==1){const O=ql(this.tmpTransform_);_o(O,v,v),T.setTransform.apply(T,O)}const P=f.getTileCoordExtent(a,this.tempExtent),F=p/x,k=ql(this.tmpTransform_);_o(k,F,-F),sf(k,-P[0],-P[3]);for(let O=0,g=o.length;O<g;++O)o[O].execute(T,[T.canvas.width*v,T.canvas.height*v],k,0,!0,z0[i.getRenderMode()],null);n.renderedTileResolution=t.wantedResolution}}class U0 extends ml{constructor(t){t=t||{};const e=Object.assign({},t);delete e.preload;const i=t.cacheSize===void 0?0:t.cacheSize;delete t.cacheSize,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=i;const n=t.renderMode||"hybrid";lt(n=="hybrid"||n=="vector","`renderMode` must be `'hybrid'` or `'vector'`"),this.renderMode_=n,this.setPreload(t.preload?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0),this.getBackground,this.setBackground}createRenderer(){return new Y0(this,{cacheSize:this.cacheSize_})}getFeatures(t){return super.getFeatures(t)}getFeaturesInExtent(t){return this.getRenderer().getFeaturesInExtent(t)}getRenderMode(){return this.renderMode_}getPreload(){return this.get(Li.PRELOAD)}getUseInterimTilesOnError(){return this.get(Li.USE_INTERIM_TILES_ON_ERROR)}setPreload(t){this.set(Li.PRELOAD,t)}setUseInterimTilesOnError(t){this.set(Li.USE_INTERIM_TILES_ON_ERROR,t)}}const X0={SELECT:"select"};class V0 extends De{constructor(t,e,i,n){super(t),this.selected=e,this.deselected=i,this.mapBrowserEvent=n}}const ar={};class Rl extends jn{constructor(t){super(),this.on,this.once,this.un,t=t||{},this.boundAddFeature_=this.addFeature_.bind(this),this.boundRemoveFeature_=this.removeFeature_.bind(this),this.condition_=t.condition?t.condition:om,this.addCondition_=t.addCondition?t.addCondition:la,this.removeCondition_=t.removeCondition?t.removeCondition:la,this.toggleCondition_=t.toggleCondition?t.toggleCondition:xl,this.multi_=t.multi?t.multi:!1,this.filter_=t.filter?t.filter:Di,this.hitTolerance_=t.hitTolerance?t.hitTolerance:0,this.style_=t.style!==void 0?t.style:K0(),this.features_=t.features||new Fe;let e;if(t.layers)if(typeof t.layers=="function")e=t.layers;else{const i=t.layers;e=function(n){return i.includes(n)}}else e=Di;this.layerFilter_=e,this.featureLayerAssociation_={}}addFeatureLayerAssociation_(t,e){this.featureLayerAssociation_[J(t)]=e}getFeatures(){return this.features_}getHitTolerance(){return this.hitTolerance_}getLayer(t){return this.featureLayerAssociation_[J(t)]}setHitTolerance(t){this.hitTolerance_=t}setMap(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),super.setMap(t),t?(this.features_.addEventListener(Dt.ADD,this.boundAddFeature_),this.features_.addEventListener(Dt.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(Dt.ADD,this.boundAddFeature_),this.features_.removeEventListener(Dt.REMOVE,this.boundRemoveFeature_))}addFeature_(t){const e=t.element;if(this.style_&&this.applySelectedStyle_(e),!this.getLayer(e)){const i=this.getMap().getAllLayers().find(function(n){if(n instanceof Be&&n.getSource()&&n.getSource().hasFeature(e))return n});i&&this.addFeatureLayerAssociation_(e,i)}}removeFeature_(t){this.style_&&this.restorePreviousStyle_(t.element)}getStyle(){return this.style_}applySelectedStyle_(t){const e=J(t);e in ar||(ar[e]=t.getStyle()),t.setStyle(this.style_)}restorePreviousStyle_(t){const e=this.getMap().getInteractions().getArray();for(let n=e.length-1;n>=0;--n){const r=e[n];if(r!==this&&r instanceof Rl&&r.getStyle()&&r.getFeatures().getArray().lastIndexOf(t)!==-1){t.setStyle(r.getStyle());return}}const i=J(t);t.setStyle(ar[i]),delete ar[i]}removeFeatureLayerAssociation_(t){delete this.featureLayerAssociation_[J(t)]}handleEvent(t){if(!this.condition_(t))return!0;const e=this.addCondition_(t),i=this.removeCondition_(t),n=this.toggleCondition_(t),r=!e&&!i&&!n,o=t.map,a=this.getFeatures(),l=[],h=[];if(r){Vn(this.featureLayerAssociation_),o.forEachFeatureAtPixel(t.pixel,(c,u)=>{if(!(!(c instanceof jt)||!this.filter_(c,u)))return this.addFeatureLayerAssociation_(c,u),h.push(c),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=a.getLength()-1;c>=0;--c){const u=a.item(c),d=h.indexOf(u);d>-1?h.splice(d,1):(a.remove(u),l.push(u))}h.length!==0&&a.extend(h)}else{o.forEachFeatureAtPixel(t.pixel,(c,u)=>{if(!(!(c instanceof jt)||!this.filter_(c,u)))return(e||n)&&!a.getArray().includes(c)?(this.addFeatureLayerAssociation_(c,u),h.push(c)):(i||n)&&a.getArray().includes(c)&&(l.push(c),this.removeFeatureLayerAssociation_(c)),!this.multi_},{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(let c=l.length-1;c>=0;--c)a.remove(l[c]);a.extend(h)}return(h.length>0||l.length>0)&&this.dispatchEvent(new V0(X0.SELECT,h,l,t)),!0}}function K0(){const s=Vc();return Ce(s.Polygon,s.LineString),Ce(s.GeometryCollection,s.LineString),function(t){return t.getGeometry()?s[t.getGeometry().getType()]:null}}const zr="data:image/svg+xml,%3csvg%20width='56'%20height='58'%20viewBox='0%200%2056%2058'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%20%3e%3cpath%20d='M43.1568%2038.1549L27.6001%2052.7999L12.0434%2038.1549C8.96671%2035.2584%206.87153%2031.5681%206.02275%2027.5507C5.17397%2023.5332%205.60971%2019.369%207.27487%2015.5847C8.94003%2011.8004%2011.7598%208.5659%2015.3777%206.29023C18.9955%204.01456%2023.249%202.79993%2027.6001%202.79993C31.9512%202.79993%2036.2047%204.01456%2039.8225%206.29023C43.4404%208.5659%2046.2602%2011.8004%2047.9253%2015.5847C49.5905%2019.369%2050.0262%2023.5332%2049.1774%2027.5507C48.3287%2031.5681%2046.2335%2035.2584%2043.1568%2038.1549Z'%20fill='gray'%20shape-rendering='crispEdges'%20/%3e%3cpath%20d='M43.1568%2038.1549L27.6001%2052.7999L12.0434%2038.1549C8.96671%2035.2584%206.87153%2031.5681%206.02275%2027.5507C5.17397%2023.5332%205.60971%2019.369%207.27487%2015.5847C8.94003%2011.8004%2011.7598%208.5659%2015.3777%206.29023C18.9955%204.01456%2023.249%202.79993%2027.6001%202.79993C31.9512%202.79993%2036.2047%204.01456%2039.8225%206.29023C43.4404%208.5659%2046.2602%2011.8004%2047.9253%2015.5847C49.5905%2019.369%2050.0262%2023.5332%2049.1774%2027.5507C48.3287%2031.5681%2046.2335%2035.2584%2043.1568%2038.1549Z'%20stroke='white'%20stroke-width='3'%20shape-rendering='crispEdges'%20/%3e%3c/svg%3e",Du="data:image/svg+xml,%3csvg%20width='50'%20height='58'%20viewBox='0%200%2050%2058'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%20xmlns:xlink='http://www.w3.org/1999/xlink'%3e%3cg%20filter='url(%23filter0_d_1215_8322)'%3e%3cpath%20fill-rule='evenodd'%20clip-rule='evenodd'%20d='M43%2024.0345C43%2025.4836%2042.8384%2026.8948%2042.5322%2028.2511C39.9336%2041.6768%2027.2737%2051.0001%2024%2051.0001C20.7263%2051.0001%208.06645%2041.6768%205.46782%2028.2511C5.16163%2026.8948%205%2025.4836%205%2024.0345C5%2023.9377%205.00072%2023.8411%205.00216%2023.7447C5.00072%2023.6356%205%2023.5263%205%2023.4167H5.00982C5.33529%2013.1902%2013.7129%205%2024%205C34.2871%205%2042.6647%2013.1902%2042.9902%2023.4167H43C43%2023.5263%2042.9993%2023.6356%2042.9978%2023.7447C42.9993%2023.8411%2043%2023.9377%2043%2024.0345Z'%20fill='white'%20/%3e%3crect%20x='8.1665'%20y='8.17188'%20width='31.6667'%20height='31.7241'%20rx='15.8333'%20fill='%23D9D9D9'%20/%3e%3crect%20x='8.1665'%20y='8.17188'%20width='31.6667'%20height='31.7241'%20rx='15.8333'%20fill='url(%23pattern_img)'%20/%3e%3c/g%3e%3cdefs%3e%3cfilter%20id='filter0_d_1215_8322'%20x='0'%20y='0'%20width='50'%20height='58'%20filterUnits='userSpaceOnUse'%20color-interpolation-filters='sRGB'%3e%3cfeFlood%20flood-opacity='0'%20result='BackgroundImageFix'%20/%3e%3cfeColorMatrix%20in='SourceAlpha'%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%20127%200'%20result='hardAlpha'%20/%3e%3cfeOffset%20dx='1'%20dy='1'%20/%3e%3cfeGaussianBlur%20stdDeviation='3'%20/%3e%3cfeComposite%20in2='hardAlpha'%20operator='out'%20/%3e%3cfeColorMatrix%20type='matrix'%20values='0%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200%200.1%200'%20/%3e%3cfeBlend%20mode='normal'%20in2='BackgroundImageFix'%20result='effect1_dropShadow_1215_8322'%20/%3e%3cfeBlend%20mode='normal'%20in='SourceGraphic'%20in2='effect1_dropShadow_1215_8322'%20result='shape'%20/%3e%3c/filter%3e%3cpattern%20id='pattern_img'%20width='1'%20height='1'%3e%3cimage%20width='31.6667'%20height='31.7241'%20xlink:href='dataURL'%20preserveAspectRatio='xMidYMid%20slice'%20/%3e%3c/pattern%3e%3c/defs%3e%3c/svg%3e";let Me;Vr.subscribe(s=>{Me=s,Me&&(Me.addInteraction(vl),Me.getView().on("change:resolution",()=>{if(!Me)return;const t=Me.getView().getZoom();if(!t)return;const e=80*(17/t);ku.setDistance(e)}))});const Bi=new Ge({attributions:[],wrapX:!1}),ku=new Tu({source:Bi,distance:80,createCluster:(s,t)=>{const e=t.sort((i,n)=>Number(i.getId())-Number(n.getId()));return new jt({geometry:e[0].getGeometry(),features:e})}}),Il=new Be({source:ku,zIndex:10,style:Gu,renderBuffer:100,updateWhileAnimating:!1,updateWhileInteracting:!0});Bi.on("change",()=>{Bi.getState()==="ready"&&Il.changed()});const W0="iconSelector",vl=new Rl({layers:[Il],style:Gu});vl.setProperties({name:W0});vl.on("select",s=>{const t=s.mapBrowserEvent.coordinate,e=s.selected[0];let i=null,n=1/0;const r=e.get("features");r.forEach(o=>{var h;const a=(h=o.getGeometry())==null?void 0:h.getCoordinates();if(!a)return;const l=j0(t,a);l<n&&(i=o,n=l)}),Gd((i??r[0]).get("link"))});function j0(s,t){const e=s[0]-t[0],i=s[1]-t[1];return Math.sqrt(e*e+i*i)}function Gu(s){const t=s.get("features"),e=[];let i;for(let n=0;n<t.length;n++){const r=t[n],o=Number(r.getId());if(Number.isNaN(o))continue;const a=r.getGeometry();if(a)if(n===0){if(i=Z0(r),r.get("onlyMain")===!0)break}else e.push(new At({image:new cn({radius:3,fill:new Ct({color:"#3490FF"})}),geometry:a}))}return i&&e.push(i),e}const lr={};function Z0(s){const t=`${s.get("type")}_${s.getId()}`,e=s.get("width"),i=s.get("height");let n;if(!lr[t]){const r=s.get("image");r&&(n=H0({shape:s.get("shape"),image:r,width:e,height:i}));const o=s.get("src"),a=new At({image:o?new fi({src:o,width:e,height:i,displacement:[0,s.get("offsetY")]}):void 0,text:new ie({font:'400 12px/1.8 "Pretendard Variable"',textBaseline:"top",offsetY:-1.75862,fill:new Ct({color:"#25272A"}),stroke:new oe({color:"white",width:1.5}),text:s.get("name")})});lr[t]=a}return n==null||n.then(r=>{lr[t].setImage(new fi({src:r,width:e,height:i,displacement:[0,s.get("offsetY")]})),Bi.changed()}),lr[t]}async function Q0(s){if(!Me)return;const t=[],e=s.map(async i=>{if(i.idx&&Bi.getFeatureById(i.idx))return;const n=i.shape==="waterdrop"?zr:i.shape==="point"?Du:"";t.push(Bu(i,n))});await Promise.allSettled(e),Bi.addFeatures(t)}async function q0(s){if(!Me||s.idx&&Bi.getFeatureById(s.idx))return;const t=s.shape==="waterdrop"?zr:s.shape==="point"?Du:"",e=Bu(s,t);Bi.addFeature(e)}function Bu(s,t){const e=new jt({width:s.width,height:s.height,offsetY:s.height/2,name:s.name.replace(/(.{8})/g,`$1
`),link:s.link,rank:s.rank,src:t,type:s.type,shape:s.shape,image:s.image,onlyMain:s.onlyMain});if(s.coordinate)e.setGeometry(new ue(s.coordinate));else if(Me){const i=Me.getView().calculateExtent(Me.getSize()),n=ui(i);e.setGeometry(new ue(n))}return e.setId(s.idx),e}async function H0(s){let t;return s.shape==="circle"?t=await Bd(s.image,s.width):s.shape==="waterdrop"?t=s.image===""?zr:await zd(s.image,s.width,s.height):s.shape==="point"?t=await Yd(s.image):t=zr,t}const J0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAAB60lEQVQ4Ea1VwS4DURS9BBvCsKlNk2FLolaiq1qQhoVKWBt/UF/Q9gMEX9CxRdJaENKFdlPLToQlKrXQDUPYsOCc6bxGeKrUSe686X33nd659533RPQw4I7DMrAr2JtvJd9nYdSiTeONwZeOhAPG8tKwRMKDYga7vTDn7F6c83vZO6pI9rBShjMFs2F1fCZcN4M98fT6JIgC9SDdS7nyLFOLOSlXnpKYJ7GHj4SJ0OhA8nh3WozeTjXfcHQfXzxSZL6BwFUGK0ILmaVLubmmydQ/kXR8+oCZLsCXbfcnEo0yS62dytBEBnW7UTz10ejtEpYISMMMElqxaNBUheeMAus0PnMg+ZOquA+v8oBsdGC92UTMWSScn48GdXHo6J2w0172fY3ryjgg0oGHGRrp1xIic61f5+T2AsaYYeg7Qt3C73x+yUwS/itIWGbxWwUVBDgkdAroYqugLIFrEhbs7YtW+Tx9g8Tb2Ha+WHVhfyZlyfzDwlbSi0F6mVJuFtLr+hWx+/gK6e1TeitYaKsuZ+HY5OlBbTYLkvknTopkXKcI+R5HYVM1of/cdZaImTlnd5tYmyQBoT659qv2tDAkqG8qZQwqUhuftcoXb2Vr5xJj1UUcPzMLawoWongF8NhXVwCvA/riMB4GX/AO0EK4gq4xIIQAAAAASUVORK5CYII=",$0="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACXElEQVQ4EY1VPW/TUBS9RdCFqjIsRUiRXDYEIumEyBSGSBUdmkp8jHUkfoCj7sT5BW1/gYPEBEh1BxBVBtIlEQIpHgpigRhloQzEVHQpgznnJc91HVN6pJv3fO99x/fdj1gkGwbUNmQL0odEY+mNdRbWTExlaCvQuaXinLH64JqUilfEzF1Ubv7eUPyPQ9neGYj3ZhBA2YA0ITHShOtmbsZ21++AaC52ytoEg0O5e78lweC3AzuJFZKE9cLNy87bl2UxZi9o+6lreHCkSBH5BhxrdNaEFiJze62lM5PpN5F0ofyaka5A550bG+pZkelrTV19JpRqrYuDh5pLrcbstDBFgAsxSGhVFnOmTjwtGsxR/sYlGX5+JP13KxJFEUg72hyvzDeLCIVFwuXlxVxs1JtRJJHYj6+rNPCFzlpe2p194TXTYEcApfP4MQuIIg0SMKokkCe00AxeMJ1Uqz3bC8gzwkIWofJK/IQHf1QOVx+qSBKW0XacMpOE/wXJmE++2Fm7dao/CYN05dInak/eK5W7UUyb4mdOEOCT0N/t7seG9KZqd8T/FEpWWyV9OZbANxLuNp9/Sdrifa3+QdrdH9JEn4W/jlQP/us2nG/A46Swf/qIwEjOLw/O3+afzSQYbYZvAM95PXoVtMNWr3UvsyUmKY81LNhC+RVHrwptU1fZg2KTlcxq2uPjJ3e6+jjbIBmtmpB7G4ltjAb95LzSmAYnhpH5ez83YXO0XV9ZP3O1IHXON0TNsm585rXd+S5PX3zlCIbw4zU9yJlgwYtV6UH0J4CfA+psCIs5gb9vzOmWEVmx1QAAAABJRU5ErkJggg==",tA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACiElEQVQ4EY1Vz2sTURCe+qMKLXXjJSINbPQkFpqCqM3FeAgEPSQFf926Ae8mf0GSv6DpWSQpeKpC0oPSkoPpJUVQskILOWgTCYi9NGmxl3rQ79vsW7Kbpe3AZF5m5n078943uyL+osGdgVagbeg/W5u2z4D1lTEfbwq+Uiwa1Baf3pBY9JrooQkrzdzuibnTk7WNrlTXux04C9Ay1BEv4JIemsyUluYBFHSS/Bad7pE8fFKTTvdPHnECWzIMmIvMXM1/eh8Xbeqiip9o+4fHFigqLyIxy2QFaKCyUrP2+Mxg6kkEnYt/ZKUL8FXP2YGcX2WqrbHrb4U6aPFIYVlWmxoXHhGkBNUIaKQSIV0dPCNKCDB7OyC91nNpf16QCNbpbEOFHcvz5iXCYRAwmUyEnKBasDomFgt3rGPgA1+9vCX1xh7ac1fJPWQEJEZAnU/2CgHsVpzQ2noXFJp0aOQEsCC9ILMX8BPxA2RUSTq7xUOX/uFfqbx5oNwuax+ZzgpPFX16QmLzQekfHMvKu90T80mbNg7c91K8O0mR8N2qlIpRSSWmXWFO0Fz8g8kKzc2tPVeQfzhmy69bLj8pEpkJyLedfZdf5cP+JOBmefXHSAKryeS+uEBXVnetW158dnMkn/MNqbJl8qcNYmve+cULQLK5r9aFMNsisU+7pFH4XqWDlLAavRToUGnWHlmbuHlYFO/8yM+bx9nxoWnsKZ+3N7bQYmCj/uv+i6Quly8p9yCqXRkXqlcIxmlqfT8oIMYXhAzTJoOLKAwGfXQSvGCcGFZmbu8vI5ZXcdWy+k9rQHOcb6g1y4r4bL3e+G1xEYB95LHNKvRMYiCLnwC+9tUnoG37MrAadET+A5b38dBIuf2xAAAAAElFTkSuQmCC",eA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACP0lEQVQ4EZ1VsW4TQRAdUKABhYMmNJYuSYMEIk6FcOUUlqJQxJFCKNkgUXMRH+DzByDHNcWZEhHJpiACuUjSOE0kn6IgpQJHpiANOSLcOAW8t9yenPM5NjxpvHezs8+zb2f2RJJhwe3AqrCvsN+hNUOfwpiISwnePHxeNjNhPX08JdnMbbFT13SYf3Ai/ucTef+pLbWP7RacRVgFFiFOWLJT1x2v9BBEE1FQ0kOr3ZG55bq02r9czJNYo5ewkL53y93ayIk1fsXMXzgGp11NiszXEbjGYEOokJnXrD8amcz8E0lnc5vMdAm+2uVwojAss+KrfZl8UNUaGjKO1vhVoUSAx1cSqvx8yjbCcyYO6rX++lCCn2ewbnxa681DxIQi4eLifKovqNdB8V88vyPWjcHasiKALAnt9N2bvevPPZeRGeG+vH/OH39heQEzY/hJDyLkVl1ox8MahlAymxkOxFphT2/1In3ji0nYYiZxVN5+ke3GsaiVaZRERxtjjr51JDg9i4eb0/e5ZX9n9xinrEWNAuHDwq4ulciJB+U0RD2ZNqUSTbEtgSMWtoMjL7EOh4F16JUyiW259GyH/b3KLVewtYDb+19QkvCyqJjWy6P1qs36gq78fyGmnrO5D2y9VSZnTrkGR5kFTN1GBcnCG6dIMq4zhHx2IGzxb6P3nzoDekGJmJl/8KMMv2vmzJbNO0cFK7C/YTKDLjKFT622G9/lzTtdUgHiuM0abCQoRPETwGvffAL4OaDPgfEy6MMf5Dvf2UslcMoAAAAASUVORK5CYII=",iA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACf0lEQVQ4EY1VTWsTURS99RuUdtqFdTM40Y3QYlMQ1KziIlh0kQRU3HWK7p3iD0jyA0rStULiVoXEhWLJwmQTEYQMUjULNSMRsRuTlnZTF3rOdN6QzIzaA3fee/fdOe+++zEjEg0NagtShXQhvz1pezoTYyTGIrQZ6MrJxLS2ePOMJBOnxNCPu2b2el/s9315ttaT2sueA2UBUoH4CBIWDf2EVS5eBtG0bxQ1cXo7cuVGXZzedh77JHYxTJiLz07lXz1NiTZ+WO3/cxxs7bqk8LwEw2UaK0ITnpXb9ev7JlMnkXQ+9YKeZqGrKcJu903WULFSxqsPOlJ6+FEt3REHC28xjEZrg54OoIsdwsPMLOghMr7ABMRnpuTe3XNcutDGj6ipPzLeTCKITRKm0wu6vzk8cb5tS+aq/t8E8R1WBAiTJDTiM5PDPP4ccZHTuCKvTvDgYFiUMcsLmDuAR/zvhDuyZLXE/tCXxusNiV2sSmHlneIYGb2DDHoYCWYvf/+8LN4663vlBX9EF3yZHjos0iAY/BwIh6/I4HPdhLdBMIGATUI7yoAeRl9vTCYiMs22BL6SsFl5/JmLEEpIhiIdbP2S5dxb1yaZOBmyZX8DbmFrmHRRrFqwf3lq9k6TXeAScL+YvyDx2dGqYMiQMAdGMdUpGXRAtV2/htYLFy69G2zujsTTPQEP7s2nnvPQJSwrB72NDmI2udb4ful22pBjR5V6b5drbSL6IH5xOp82C7DkB0IYQwULVyzsNXo468pIjSwhemav/1yFLq/06spqzdGE5NjfEJlDF6nCZ6warR/y6MkXthk/BrxmDbIvmLDiL4CfffUL4O+AOguiQUL4AxQW8ADbO5FsAAAAAElFTkSuQmCC",nA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACrUlEQVQ4EY1VQWsTYRCd2loFJW56iYiBrXgItNgUBW0vbQ+xRQ+JqKgntwcPgocUDx43+QES/QGSCF6sSlKkYsihKUh6ERKlhR5sm5Ii9tKkxRxakfreJt8SNhvpg9lvd2b27eyb+XZF3KHBHYWlYRuww6YVmz4Dqyu6XLwR+JLjoz7t4d0LMj56VnT/KSuttFyV0kpV5rIVyXyulOGMw1IwG07ChO4/HU0mRkDks5PcTsqVukzcyUm58juGOIkttBKawcG+2ML7kGie4yr+37W2d2CRovIXSJxhsiI0UFmymLt5ZDL1JJIOhz6x0lvwZY41A2anyuLPv4s3MCtd597I8PV5S0NFxlXz9AolApK8JKERmfLrSnhGFGbMr5LJbsnCh5BUV+9JeNIvE7dzwqpaQb3ZRPiMbhzMZ08GA8EBb2sOXqEuDx5/kaWPUxK46JGTJ7qtRu3v/8V5j915+yYM1lx2a78HDt1JxqRvKzsWgXamV1Jv12Rzqy5jIz4xn16yOVpPOF7AEAmDboScN2I4NG9VQ61Ss+sCeSQRv2zFWg9NyXQSdkS+sI2br0j0UcDKoQx8QHjyfMc5ZVPKTHSCFQUH+mwyxlkFG7C4tO1MV90vkbDkljCEJmG22m5kh/kwJ7gtgU0SLqZm15xxuyGcw9reHyvOc94Yho5OcH8DGe4Uzs8GBltz7l9KMT1TEGpJYDdJ+tWYBAfbR6z/arqMlH619SJIThdzN1xfhxXWdg/aZw8MjLFRkGcalykONrEKbbzZ/M9r98O6NcQNd+PIoeY8OkEyfnFWf+zGEeMHQqihQhT6xBsbvb3rKkmtlIGVlZZ3XsIXU371yuqaqwEzub85xOy2Gnxqmi/8ktfv1qlrDXl8zQzsSDCQxV8AP/vqF7DR9EWxarA2/APTqP6lLyWxXQAAAABJRU5ErkJggg==",sA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACN0lEQVQ4EY1VPU8bQRCdoCQNETI0pLF0mBIEThlXToGEoMCWAilZ+AVn5Qec/Qfi8AfiS5kPyeciEcgFduMoEshWREqw0TXQBAuFJimS9+zbk41XZz9pbm/fzr6bnd3ZEzEjBtqGlWFt2L/AmgGn0BrxwMBmwJXSqfnY7nZC0qmnYsWne26tsxtp/byRypEv3qHfAVmAubAQ9wWLVvyJXSo+h9B86GR66fh38uJlVTr+7zzGKdzDoKCTXJ7LH39ek9jMIz0e2XZv//REEflbOOborAUVIis1q5sTi+kvUfTZ2ldGmgXnacF2+3vW0rmic+XQF9s50fOG2vK7tCSXZkOu1rhmpF0QCw/xUJn1+JAYPVeX5qRUTPE1BPO2l2tgFY9Dji/MNzcRwoqCW1vr8SEHdhjtYMTksvt1Ua8WR3iO8URAME1BazB8DprAZfHIcNNM4PECVqfwSE4iWHjzQ3Z3EsboqBSsxqLgWOAQYxfvRO0sjvWlYIfOUcg5p5HRcS7TwYaCrfq3a3aMcD9c9Pj86xXjuCZZlsAlBevux3PNj7TMnTNGjJNY34BHQRc72OUu3oeOTmEzosCUBZeFqyslg9IrN6sbI4c2Sohj3du/KL0vLL09dF1GSHggDnh7sDYnBcWCG6eAOS7naUG+20hsoV/o0btOZ6aIkbXOfh2gmydH6CX3e/2nQuOwvmGo6dnwImCuao0ref/pgoK8DLhMDzYRFLz4C+C1r38B/B2Qs2Ex2Aj+A+Wp1NVgc0jkAAAAAElFTkSuQmCC",rA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAAClklEQVQ4EY1VQWsTURCeqo2Cod16iYiRTU+KxcaL2l4aD8Wgh6Sg1IPgCno2xR+Q5A9Y/QGSFLxYhawHpSUH00tFELJKCzlok5JS7KWJpbnoIX7fZl+a7G6lHwxvd2be92bmzeyK+EODOgUpQKqQtiNlR2dg9cWAjzYJXS42GdIe3huV2ORZ0cOnbTdrrSHWekPeL9fFXKrXoMxC8pAu3ITzejiYys1PgCjUdfJ7qNVbcvNuUWr1/QzsJLbRS5iOjp3JfHo3LdrQoLL/d23u/bFJEfkLOM7RWREaiCxXLt45Mpk6iaRXpz8y0hnozGOOIe0XmUpr4NxroXRSbCkue9WGAsISATmIRkIjGQ/rqvC0KJBg/PKINCqzUv0yI1E8U+cG681LhN4gYSIRD7t9kEKLaUjm2RW7DDzw6eNLto42N9gRQIyEOk92QxseBFFA2CoKpdUdtFCw20ZKz5XtBYzzUtrt7Qd88YBkTJEpsfiMrPBqSqJj3gC4mXVmhIdiLvNV9AtBmZoISeJWpywLbzcO9afhBKSGkz2Xkn+zYUfU20rG7KhErpn2Acn4+T5iThBgMUJr5fNOn5Evm1v7dg17m5w1Zbrf1nc9/k6tN0m4kl/86XFgmhY2LiwepGgubQkvxq8rON+AyUth/1TR2Jp7fpl29vl3u1XozQjTaKPUk4t87YKXFbleqEERUaOXRDsUysXb9qaup/Og+s6v+Zt7fzF6H3joI7jnjzt7KmiLkeXS9o37CV1OnVTqjlUbDgjFDZKxrSo/fmdh4weir21SKGy2M+jeSXCTsZaMzFrbfQlbRtlVyuqdqwFJc74h9iyrSWLqpdVfwl4EYRN+TNOEHAkGvPgL4Gdf/QL4O6AuBdEgHvwD/oD7on0nGz4AAAAASUVORK5CYII=",oA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACqUlEQVQ4EY1VTWsTURS9VVuFSjvpJiJGproRKyRFQZONcREJukgCSt05QVyb/IIkP0CSrl1MBFdaSFwolizabFoEJVFayEJNSkTspklLuqkLPeclL0zHoD1w5713v+a++zEjMhoG2ClQCdQE/R5QbcCzsI7E2AhuHDw7HPIaD+9fkHDojJi+SaVW3+hIfbMjr5fbUn7XboGZAxVBQ7gd5k3f6ZSdD8KRd6g0atNq78utexVptXtZyOlYwekwE7gyk11ZiogxNa7l/1y7ewfKKSIvQDFNZe3QQmR2rXL3yM70m+h0PvKWkSbAKx8bCDKjImPOeK2xsy8UJdPrMNzXvtRqTE0IUwTYIIMOrXjUZ+rEU0LQMPGoKv45j3QaC9J8n5Du7oEk02t9BceT+WYRwbLoMBaL+hzi/nZ1bVttCrlrKg18oV0ICqPWMqcROwII06EZQBRubH3viZvP6xnT4/IJreMG2wvw02HAbUjJzaBXReLMGaPjmYVwY5Ay84RboM/MSyx6ThUFOVZO6ps7/+1PRthyRqEdci0WQpLPXVU59F/2yMrSbSX2z8041dSeEwTUGWG9ur6NKqukKqGS4Hrgy5PHl4QREnwxC2LnQ+rsfDAdwBYjrBZffnXK1N48PynZp59l8VlDnbt7vySd+SDWwsXhbDuNON9AmZPC/mmisQ33/OIDACcfEVmPyipSG2lwjyYjn71eakFlVo9eHKNXqlXuQHmCtodAA2MaLTNixhn5fOQNX5qEUfH4wLKBVvAsr/648SBmyqmTmt2X0pmbRwmdcTQbX3ZzOPIDIcyhRgqJzfUH/fC8agXnyuIwsvrGziL4WS3TV9ZnrhYow/lmdTnLuvH7Vf4pz199Y7W70OM1y6AjwYJWCVQD6V8AfwfkpUAG6C/8AeTBAxu3Ro0CAAAAAElFTkSuQmCC",aA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACiUlEQVQ4Ea1Vz2sTQRR+9UcVLLrrpSIGVk8FC01Pai+Nh0DRQ1JQ8eb2P0j+giR/gLSeBRPBi20l8aBYcmhzaRGErFAlBzWRFLEXsy3NpR70+97uxJAmoQc/eDM7b9588+a9N7Mi/WFBnYIUIXXIn1Cqoc5F3xcjfbRJ6PKxmXHr0f1rEpu5JE7knJp52y3xPrXk9VpTSu+aDShzkAKkg17CRScylsov3gLReMeo30ej2Zbb98rSaB5kMU9iRTdhJjp5Mbu+Ghfr/GkzP7T39w+VFJ4vwTBNY0PowrN8tXz32GRmJ5JOx9/S03noSifCiYzxzN//LenMB7l6o6jx+rcw0NsTyzJy+YUspLdA0oYDo8IQAXmIRUI3ORdxGHgGfTr+Rg1p7O8d0lCRe/wRidiR9Vdxqb+fp0cg3dQ5xptJxMAlYSIxF9EJ73NLdys+m9WxaXispac1oT563das83tjc7dzClYEEDuFxqER4T5QpX53N/ScRzN2nNPxpC0VkFLP8gKm6GG025DaXvB4SFqvWpwrY0LvibBWHRL+V5CwwQQMg31hVJPQa0PveHSCN4gdCb3K1i4HAzGLLHJxuEjt6ASTMhXGn3EGvpOwUlj+qkaDGnrB0mCZaDmhVllGjKu5orzfgBZ2ATv53G0YWCZMAgvenngpjZ228DIQ3CR8LArm6iWxW7FavtOJySBy3iQWvHmBOA4uw8EC1hROhgtriJG9tvHj5sOEI2fPGPVRWs5ZSBJBMr44tS97OQz5QEh32aQQ2Fxw0YdnnQsZInrmbf96gmGWOsIcORgFrYsuw/sN0Syawg8y+1Oer3wjoQ87HrMEORZcWPEXwGff/ALqoS6F3oIcwV8sRRZkeZzwewAAAABJRU5ErkJggg==",lA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACFUlEQVQ4Ea1VsU4bQRCdIEIDIgcNaU66UCEFyaaKoHIKCwsKOxKpuUjpsb/A9heAawpf2iSSLwXIyAWmIU0kuwCJhmBkCtzA2UoaU8B761vrFFvG4DxpbvdmZ9/Nze7bFekPA+4krAC7gN37VvF9Ntq+eNHHm4AvH1mZMzY/zktk5bVY5qQKq57cSvX0Vn4c1MUt1mtwZmEOrIt/CbctcyqZ314G0Vw3qF+nVv8r7zdKUqv/yWCcxApBwnR4cTZz+D0qxvRLPT6w9VptRYrMdxCYYrAmtJFZvlJaH5pMf4mkS9F9ZvoBPnfMH0gHM/Nad5JK/5I37wqqZnoy29zumfK7xSvlNqYnhCUC8jCDhHYiZlq68KzNUnRPEbHvNdsMRgadmrlYEK95J01kpsF6cxHxbpMwHo+ZegxEN7L1eUGYcRD8tfiqqfzGq94ac0cAkXE8rPDbme5cZNvtBzuMCcYFx9jn9gJCzDA8KJBRw8AvmUXC/woS1ljwUUEFAVUSVo9+NkblE8oSuCThkfP1fGRC6htQG9spHzc82LNJWTL/sHC09BKQXqFSWoP0Jp5ETFVRCJDeJ0x09Cq7cOR4enADDwuS+SdOlmScpwnZT6Kw2Y7QH191lkhJ9OQmh7kZEhD6lztvnaeNJk19UzWhgEJYq/LxtXz59httw0Mcf9OFDQUbUbwCeOzrK4DXAX1JGA+DHjwAVtbTH+z+42MAAAAASUVORK5CYII=",hA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACcUlEQVQ4EZVVz2sTQRR+Fc1FsVsvFSGweiooNgVBzMV4CBQ9NAG9CW4E7xv8Azb7B0jSs0gieKpC4kFRcjC5pChCFmnFiyYSEOuhWYu51MP6fZOdEJLVxA/ezuybN9++eT9mRaJhQG1DqpAOJAilHeosjJFYiNBmoCunksvGnVvnJJU8LWb8uDLzdvri7fbl+eue1F71ulC6kApkhEnCohk/YZeLV0C0PDKKmnR7A7l2sy7d3q8C1kmsME7oJC6cKrx5lhbj5DG9/s/RPzhUpPC8BMM8jTWhBc/K7fqNucn0l0i6ln5JT7PQ1Y6EC472zD/4LXnnvZy9XFXx0hv1EZdWtmThzJPwuAM4EBOGCChDDBJamfW4ycAz6GvpF4qIBP7PQxoq8CPc3HmXlc7brCTOL0ku31JrjDeTiBeLhBsb63G10Njek6J7SejtOHgsb3dfnPsXVUj4cc4brT0cdaBMWRFA6igeJr9G2PdW1Dj5UJ7Bq3FoImNxmECWF7BKDxOacHzDrHn2bjP0OKZMw1o1SfjfyNktMRZjUsCxJ0HCrnZ/cjHqnWTeR38qzuwgwCOh10Qy5oH74IM0tn9I9dHVqXplhQBfSdisbH2eyUey0sNPqLmksuWpKKxbgv0N1Phg/fRRKkHw7fZIoAu0DnWnb5upsVJKBuF6h2S69TJovWq7fl0VLxfmBT1kM6D1cthT0VmuQbHJ24NFPC9IFt44Lsm4TxNybiOw7rDRh9VP5d/ALlFturO/CZuCttNH1u8cLYjD/obIKrpIFz6T0Gh9l8dPv7DtfNjxmCoRGGfCggV/Abz2dTIYeOpsCJM5hT/w/RU/0O92gQAAAABJRU5ErkJggg==",cA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACpklEQVQ4EY1US2sTURQ+9Q0pduKmIo1MXRWUNoKgdmNcFIoukoKiC8Fx4dqoP2CSH1Bi1wWTghurkLjwUbIw3VQEIUEqZKFNJFJ00ySl2TSL8ftu5o6TB6kfnHvvnHvmu/e8rshgGFDHIVlIBeK4UnR1FuaBGBmgjUGXjsyOG/dvn5PI7GkxQwFlVtqsS+lbXd6s1ST3oVaFMgnJQDz0EqbM0Gg8nboKonHPaNCiWmvJ9Vt5qdb2EtgnsYKf0A5fOJX4+HpOjJNH9f7QubG7r0hx82cwfExjTWjhZuli/uZ/k+mTSHpx7h1vugBd7pC7YeubaVcmLzMf/6D1walVGTnzwnW3hQscE4YISEMMElqx+ZDJwGdebuG0t9zEiS0164HxmjkfFHpRL9+RMNbUEYw3k4ilRcJodD5EvVR/7Un2+TWxn0yrbz3QLf6UeDqtMs4Y21jDTe9gVgQQOYLB5GkEfyAKG3/UrAefW1qlbBB3McY6CWR5ATMkDGtCz3rIIm5/keZuG/W4I6nkJRVDmru1auqkDKHo3pqcGBVzIiCNZlsVOMPhBwmrvQnwG/SuHz2cUvEr5m9I7n1NVpBIgh3EiYSl9U/dMeOOH2y5peWyX6VcZaL0DWkD/CThemb1R5dx74d5NiCJxa+ShGgwcehn0RXC/gZyHFg/dRS242zfU8I1dN439SgnB1nVr46DzDtIirKpfF6gvgLxWi8G4yzjwhIZhgYy3Gju66zC5bZqBtTkA/yXOez+XEYsgmuF7St3o6acOK7V/dTcM8Y6h5KM3VL+3uRrwwdC/GUTR2CTnUbvbrt+2k7xs01LmztL2E9oG/3a6G/OFsRmf0NU/+rCZ3kVNn7LyqstdkoDdnRTJQLzgbBgwSenCNHJYOCpi0MMSB/+AqyMIb5pMY78AAAAAElFTkSuQmCC",uA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACZ0lEQVQ4EY1VQWsTQRR+inqx6OqlPRhY66VgsSkI0pziIRD0kAjqSXALeu6KPyDZH6BJzh52PaqFrgelkoPppb0ICaWCF3UlRczFJqW9pIf6fdOdZZtsZT94u7Pfe/PlzZt5E5FkGKBt2ArsJ+wwtHbIWXgn4lQCWwbn5nOTxuMH05LPTYmZOa/COls70vm6I+8/dcVf7QYgHZgHizAqWDMzE7ZbW4DQZBSUNAi6+3L7flOC7l4VfgorxAUr2dnL1c/LBTEunNX+/777u0MliszrCHzGYC1oITO33bybWkz/EkXnCx+Z6T1w/unQUdGZ6aVcvcX9SEbj1Teh31/dRgLnhCUCXJhBQatczJgsPAPnCx9UEIWTQL76YlP6gwMZIDuC9eYmYmhRsFQqZshLsL0nzHTpyYz6Tno4EFt6OiPGxeN15okA8hQ0s9cvqbk156ZkZ4/Gihh5eG9+SGujJ9XnN0Y8zHKK3BwFs1pwLCpGcKnOy021ghgdDcOzalIwFbjUUvFKdMhPmkTB4KQN0JO4VHSGLD68huOxr4y+/mAo/d0DFcYOAjpn+Fjb6GGXp5Uj6QE/Jg4lixMQh135Ij7akBvJtgR+McM17+33eNzY2K0vyOHvR8eMNfPquaim7G9AHWyvtd7rw8aE0hIsQ3hZeLr1ymi9lXbzjjrUaYUYxxqyGdB6i/j09C77IBq8PVirtKBYeOM4FOM8LcixjcI6R42e3HYM0mCJmFln628DXFXzesn6m28LVmF/w2QOXaQPPmvVWv8jr9+hY1B3xHGZPiwVLETxymnD9F8A/w7I2TBeBmP4BxL//+/DOFLuAAAAAElFTkSuQmCC",dA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACp0lEQVQ4EY1Uz09TQRAef6GJBF694IEmT7yYSKTchIv1ACFyKCRKPJjwjPH+jHfh/QGInD1QjyJJ8YAROdBeMCYmbRVJD0qf1hC50ELgAof6fdu3m5Y+lElmZ3dm9tvZ2ZkVCScLahecAhfB1YCzgc6BDKVTIdoR6Gbj/R3W+L0uifdfFjt6Ubnl1sqS+1aWt0slWXhf8qH0wEmwoaOA03a01Z2d7gNQh3EKm/ilfbl9d1n80t4k7ARWVA84Eeu+NLkyPyBW2zlt/6es7B4oUET+Ao5P6KwBHUQ2m10ePjGYPomgvQPvGOkodAsasFj8NGozV5XdQ/Gm8syRrMwPmvwlX2+I9zyvcYzEPkmvbjHSCpRXzmJwRoaiCoxJH32UkcRQJ07cN5s4ya9vi93ZKhNPbzTouWC++YgAdgiYSAxFlVNuvSz6QWZeFpRODzwg2KhVDZIVAcA4Ae3Y9YgyOmNdDU71C//3nuAmwoOYt1t9KirjwvIC9ZzGENOAxhoy8X/ti/vss/AWrEWWjDf1xXgGtWozwhOR+/iajI9dNY/EfPcOLjZFygj9ow8QdgIfQ3cM7bHuiOI8oiUxagoC5jIft7g4lpgzXo/yKLW3tygVIwb9JGAmOfdDKY8brLYWSc6hDqe+KpdareKAnUOJ43FI7G/QAgcLXEbLVaubDwxDV0XRmjXn6Cb961Rx5Wr2w7Cy0wZ//kqm9UbgnMou30Hr1a5AYxgxusrOgckn170Di2y9h/BPngk2FZCfyFJ68+b9hC0Xzmt1MyRtVpA3grF8Ct93PHjygxDmUJOLxHq1Rm9sO+1QL9m/jCy3tj0D/aS26c9Brykd8AT7m53Rgy7Shc/ySq/+kVdvNthm/Ax4TfUQkP8lBx4pcBasH4OJp84FW+Am+gsT+CdBBSasZgAAAABJRU5ErkJggg==",fA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACv0lEQVQ4EY1Vv29SURQ+9Uc1qbHQBWNKfLVLkzYWolHLUhwwRAcgseoGNXF/jX8A8AcY7GxSXhMX0QQcMDYMwtLGwYCmJgy2pcEYu1hoZGkH/b7bdwlSxH7J4fLOPed759e9T6Q3HFCbkCxkC/LblrKti2HtiYEe2jB0ab/P5YjOXRa/74IY7iFlVlnflcqXXXmzUpfcu3oNyiTEgrTRTZgy3OfMdGoGRK62Ua8/tXpLbt0rSK3+K4F9Eit0EsY9UyOJ968D4jh/Wu/3XRt7+4oUkT+D4QKNNWEMkaXLhbvHJtNvIqk38JaRRqDLnbA34jqyxt6BRB6VZOxGFkYt7afW5NPP4pzIyMDFF+K9nWcdEcCgsERAGuIgYSwcdBssfHF1R8auZ2UYKfciszKbkl2ald3qA4nOjcu8uabsWG82kVyn8BMKBd1YRIprO8oB6csynDWYVgLRbX2ItDtuPp6QJvR8MYPhRCAgPwkNz6RT+SaeXFFrd3QcF8/kiDiGB8V6uSHb31oyO+OSuG1PJ44XME1Cjyakphc+YfYOi59X0bBuTB+lklTyqnKxZ9Ug4X9BMnQRzteEqRLMwhvIq0jDwdE2B5tS606xvWv/uTQ6pLqpyahmRIyQp4bgCeJCwkoJzegHDLzaZqSd4LOBlxGsM7BNwpKV2eDDP8Eae6acshD/qFKl4eLzqprD6P1x5WdHqgbbQrsbnMF+SKd80mjuq4HnYHOMskt+lTpLZl8Wlj56Ycxetly4o2rVj5gnicR2V9H9A9UcNG0eftZJ27mKejhXit9vPgwZcvaMVh+l5h7nkSAZb5zq12YSj7wghDXUMFHY5OFB//sMa4POlSXi2FTWfy5Cn9B7OmX9zDUGifN8cyym2RD7JLFWxdUfsvxqk8esATummYMcCzFY8RPAa19/Avg5oM6EOCBH8AelXiRum6PHbAAAAABJRU5ErkJggg==",gA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACU0lEQVQ4EZVVMW/TQBR+RcACqlyWsERy2wVERdOxWUiHSFUZmkpQxroSzLj8gcQ/ANLMIGJGoFLMAAIy0C5BTLGqIlhogrLQhZoKljLA9118VkIs13zSu7Pffffd87t7Z5F4GHDbsAasA/sTWjv0WehjMRbjLcFXL+QzxtrNKSnkL4qZPado/t6h+B8P5cWbnnive104HZgLi/CvYNXMnrfr1XkIZSJS3EO390sWbjSl2/tZwTiFFQYFy7mZC5V3W0Uxxs/o8cQ+ODpWooh8E8QNkrWghcjq7eb11GJ6JYrOFV8x0hX4PC3Y6XxYMXWuag8/y+ajT2Lfvix371yS7daBrG+0tMZQ33hckOCHijTAwORpNFZpMavEmBdODI5+wz2G/lhNzs1MSL2aV8+60Vxj/Kzkrkww5wYWtk6BsLy8mFU8hC3X5jPSfrsU7SwHOImbNGg77w/EujUd8XgigAIjNLmCegsnqZeEhtG5z74I0hSxeLyAWUaY04LR6AkPzv3doehID/NvMsL/Qlx0gwKMsEtSWnDTBnOn57GCAJ+CPhOcBjw+XLx87+oInWUJfKXgDhOcBs6DXVlbndL5GprC+gY8CrpYOeDqSXCf7qvorNXpERqjDi8LV1dKCaXXaDeX1JkbmZHgYBHMFV+y9NZBcxkh4cFR4+2hq6PvTm4pFt44Dpgu2VqQzzYS6/QL/eRdZ4oYmb/3vYa5FQoQ+pP7b/3WQldmfcNkFlWkDz5ztd36Jk+e7/PC4GXAz/RgqWCBxV8Ar339C+DvgD4bZsBG8BdTQPJbZdBgiQAAAABJRU5ErkJggg==",mA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACs0lEQVQ4EY1UTWsTURS99aMKLXbSTUQanLpSKyYFUZtN4iJQdJEEFF0IRqH7SH9Akl/QZu1HUnDjB0y6UCxZmGxausoILWahTSRSrIsmlmaji3jOS1462LH2wJ03c999Z+49774n4g4D7iTMgtVgnZ5Ver4ERlcMuHhj8OXCQa/x4M45CQdPi+kbUmH2WlPs9aYsLjWk8L5RhzMDy8P6+JtwzvQNJ3NzUyDy9oPcXuqNtty4XZR6YzeNeRIrOAlTgUuj6Q9vImKcOq7nDxxbO78UKTKfR+BjBmvCBDLLVYq3Dk2m/0TSycg7ZhqHr3CkN5HSmbV2fkv8UVnGr1kIaut16p0lDpx5oaxbbhsJDAolAnIwg4SJ2LTPpPCl5S0Zv2rJCEp2kjGaBGfHhqRZvassNOVVPmZIvbmJ5CJhNDrt4xoprWyJ9Twk6Vm/+tYPLkJJkpy5oCShxsmZ88qnf8yOAMIkNAMTHrU2PXvZdXdZFjSWj2gZDbZQ199tKbYX4D+GR0AT6mC30XoWUiWi/8QYGVTy5OaDipTxvV41meGhkH36SRFRO//FbkX0UQ4nSFjXOjgnnO+LyKq08kPYCdSOVluNKbKFlxsqlCcIsElol7EZB4E/dOqlY82xYal/21Wf1BT4SsJy/tUX5fzXw49Ns9e3Jfuk2g9hi1FP/8So8vF8AwU+2D9NlNPpbN5XVluNq9uFo/ahnTrYaX3rdJBxZy5zxRlfI5k+ejEEW5Xizf6ucdINWm99A/FkTUbesicfIj5/tLeoit3yLJU2r9+LmnLyhHbvp2TL0AiS8QRVP//M4JMXhDjbJglhM92DvneGGeQGasjM7LXtLObTOkaXrL85JmApnm8YRPeIbnyWW1r+LguvN9jYLcSxTLURGP+LBCIsWAWmN4PC05eEGbB9+AMiziwWYWCsOQAAAABJRU5ErkJggg==",AA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACq0lEQVQ4EY1VTWsTURS99aMKKe3ETUUanXZVsJgUxY9sjItI0UUSUHRnKrg20h+QyQ+QxD9gRnBjLUxcKJYummxSXCVKC11oG4lIu2nTYjd1oee8zIthMpEeuPNx750z951374yIPwy4MzAHtgn741rN9aVx9sWAjzcJXzEWHTUe3Z+QWPSsmKGASquv7kp9bVfeLTal9LHZgDMHs2EdeAnzZmgoU8zfANFoJ8nvotE8kFv3lqTR/GUhTmKFbsJsZOqMtbwQF2P4pI7/99zaP1SkqLyAxGdM1oRpVFasLd09Mpl+E0mn4x9YaQq+0jE3kNWVtfZ/S+pxRcavOUg60M+pay5x4NxrZcxh3BgeFEoEFGEGCdPJmZBJ4cvVbRm/6sgIluxHFr4YlM1PKWXM4QsI6s1NJBcJE4mZEP1SXtkW5+VNsebC6l4fPq/tqMtC7oracb7cLkSltXeoimCQHQHESGhG8GbCmrvku7t6aSqp6xCZCkoFRRBsLyBMwogmpMcPXCpE75GBEjV+tHV2e9U84Ufg9VGj9IMJpRmvuRHllS21Gm+LscJG9wZ4yfR9Hvrlc5fFHAvIBdjywm1FbI4NqRROEFBnhXXogF1Woqqg98CRo1ZPn0wKOqITJkkWuhPMAb6zwoo9/403fWGeD4j1/IvkYAR7dTZTFWqv9ed8A6qxbYjbosD9QM3YTvb8hmrq4OQbtRmUgaBk7sfC1qOXxOg5taU7Spd+xPphY2QQee15Z7XT8ffsglnE7ePuw+uYyeBi+ef1hwlTTp/S7l5qkuk4yTgt61/3csjkB0KooUYGwubag/5vhnXQe6ZErKy+uvMCMUvH9ZL1Pc9pWJbzzR1lU2vhqVW5uiWv3m5w5FrI4zJLsCMhjSwHVoPpXwB/B/RlYAasB38BbTMURenwjkwAAAAASUVORK5CYII=",_A="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACyUlEQVQ4EY1UTU9TURAdNaAJhj5YiBvMC2yIEqk7YAMuSIwsbBMtLkx4xLC2DT+A8gekXWssbv1I60IjdkHZ1JiQtBqIXaitKSGy4bUENnRxPee299HA82OS09s3M/d03syZivibBXcUSANlQLVQaPkcnL52xscbgi81Od5nzd4bkMnxy2L3d+m04qYrxS1X3qxWJfO+WoFzCVgBPDtJuGz3X4ymlsdA1Ocl+X2pVA/l5t2sVKoHccRJrK2dcDE43BtfezUlVneHif/1rO0faVJUnkBijMmG0EFlqUJ2+r/JzC+R9MbUO1Yahi9j/OXyp7AqfJhWeFU9AKu7Uzkzg8otRZTaeeAhOj+kGMNFFbrVr3gPb8VnF7DO4sNBwLYCHRJ+uC4TY33ilmaE1Ra39iT5pISUpsUWNzCMbVl7PSUgkgBaMxfL635ziMhymJlOJcYVCFRwuMerhFVlnk0otMLzIVdXYypm9ayWFWKQrDLDCu3gtR4h8Mp4PDa33kBPO7Ujl9/V39unz5h9pUs+Q0qUF2yEhEGSnTTKYunxF3k0P6RDdTTfCjTJ23ODV3ulsn1gtGqT8JQZjc1GBsQBaG796FSen4OEFRIYayeLL1w3boFGpeZDyur46twgWJGExfWPu/pibb/RmvQlaSdjkOtHzbGXxvjjXEcqgyfsJwnXV158R3JDq55bEl8YgVAPPTCTVTiRQYnFN7Sf+cmnX3VfOSjuN0wLm/pxKWKcvqB4KRXKBKReDpeAMQJ3y4C3eiHoLV3I3vZkwuCfjNWxn802NLB6b1H1wRzyV861LpXQn57V3M7o/Tu2XDhv3P6UjFNCpk2lb3X+2ySYzR4ai6KxS81FP566CZ48ORxWVtzcSyIWN3Hzb2OeeTrAIvcbkJHWFjHAQeXyv+T5yx+cdg0uvqYeBOP/MgcJaaAAmEGw8fRFAQs4Zb8BSBtwJRgqL8cAAAAASUVORK5CYII=",pA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACe0lEQVQ4EY1VTWsTYRCeiHqplNVLRBpYParYFARpLsZDINRDEvDj6Ab/QIo/INk/YJKzh6zQUxWSHipqDjaXFE8JUqEXbSQXvZhY2ks91Od5s7Ok61ozMDvvzsz7vPPOx65INFlQl8BN8B742Oeer3MgIykWoc1D10in4taTh9cknbosdmLOuPV3RtL/PJKNd0NpvR0OoHTBHjigMGDVTlwoNarLAIoHTlGLwfBQ7j1oy2B4UIGdwIamAcvJm5cqH15nxJo/p/ZT5Xj/yIAi8hocV+msgA4ia/Ta92cG05MIupR5w0gL0LXO+IayRqZXiV1ZE3JxdRvOh7rfyPqLXbl6pymU1vx5YYpADbBFQCefTdiaeOZl8cZFGe0+lr2PBRn/OgJolxsMMO3eq694iwmjIzHfLCKWDgFzuWyCej+SY6m5t83VeUgV663uD99+IHeX49J7vxJU3hjwYEeA0mfxsJOIiEQARjVNBEN+jcqPZNocrNleoEVGmFTAwOovmDv3+ScpP7sVNv317qfMJmAkjfd/S+FpR3LZBXEemetE+oWVBByEq0gwU5zrlslneFPUOycI1Cdgv7M9Sbo6FktdsRfmxKulVPVfybEEfSNgx1v/EmwgGE+rIG+MXDlw+MeC8w1qscoeKlkGs4/EW2ePoVKZTSP1weprr6pOJQ/1Pxaejl4erdHstVdM56vjLJL5XsLhGL0i/D1emdSCos5CaPdP1Kc/tXjY68LTo7cCcl1CYt3JoJ+cXRrDxIZnZP2dn3XYKmrXK+s7pQMuc77BZq618Zmrre53eYlZBuAYfrxmCzwTOfDiL4Cfff0F8HdAXQlsigh5gv4ArXr/f4PXeKEAAAAASUVORK5CYII=",yA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACqklEQVQ4EY1Uv29SURQ+GstiU58O4iAJ0aVRIzRxKQs4kBA7AIm2i4mPqLOPdBf4AxQ6GwOuagIOGpVBWCCaJpCmJiwKBmOqgw+butgBv+/CfSk/rJzke/fec8797rnnnvNEposBtQUUgTbQH6Ix1JkYp8qRKdoYdPlQwG3cunFOQoEz4vUcV27NbVuaH2158aYrpdfdDpQZoAA4Mk6Y9XrmrXx2GURux2napNP9LVevl6XT3UvDTmIlBwlT/kun0u+eh8VYmNP2Q8fe7h9FishzcEzSWROaiCzfKK/MTKZPIulS+BUjjUNX0vp2+328T+Cq+gH65tr5vt1a7fe/3VSwW2vKbiy4lA99uQe34toGjKP4mLGIx8vEMye+iycFGwWOPFUSVl0fKsn7m7iBS9of4soeXHarPcw3YJCLhNFoxKNezzgxJ7nMFXVtHmDdWZRK7btDWKnvSGr9smNPY85D+UCsCEjoGD5eP6IiGm9XnM2c2L/2UTLzjo5RHxQSURgIywviY4R+ko0LnTMPt+Te3cVxk7OO364qO9MwrFUvCSekt7uvchONnBVzVV1lwidh1ZQuve4bsZGwo0OnRZMFl0+rfI54DxfJ1KZU6j+k+DjolBk7CNIkYbNaHyRek/kuGFLIBYbbR4fMgy203VdhA+iWpAfbEvKFhNXC009coERq6kReg1FrKCM+JMs9akk+OzhM2xkI+xuiCpv1Y6MEnILGemTO4iXG9XqNAGhrA07rxVAexUb5GiJ0UT+zMLql8EvcZi+BTQVemVKCYoOdwt6cVXTOsZd/mwL3aULOLSQ2M2j0QcFS+S9hBzGy5vbPDfiktZ/+2+g1RxNIsb8B1du68PkIldqOPHn2mS3Zgx+vqR4C43/FhEcRaAD6QZh46iyAjzkhfwH6QzxVDjE9cQAAAABJRU5ErkJggg==",xA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAFKADAAQAAAABAAAAFAAAAACy3fD9AAACz0lEQVQ4EY1VMUxTURS9iCAGAh8TpQON37poJFASB+kCDo1GBtpEwcGEb3Q0sYTBxKXt5mJaZofWFU3AQSN2sCwYE5NWg6aD0poSYhd/ITiIw/ecR1/zU0r1Jve//+497/73zj2vFWluBsIR+BK8CHdqnqvFLIxNra1JNIRYaiIwYMze8MlEwCOmt1vB8uu25D/b8mKlLMuvyyUE4/A0vG6NBROmtyeSSoyh0EAd1OylVP4ll69npFTejSHPwsrcBaP+oROxt8+DYvR26HzLsbqzp4pi50kA5wjWBS3sLJXLTP53Mf0lFh0NvuJOw4gt63ix+D7sYHeOf6hfNcDo7XRi88OOs3Wr7sSACoc5LFRYvQ5zG24cwcMKXfWaGNX27989L3ZhRnj09OKGLDwpMKWMnJ0e7BaehJipK161Bpsg5wZAVjse0Qf3hs6R5DYQ8OjhqHQdaxfPqeOKj+y7itycMlXBj19sic2PqK4Tw8bNRT+ovOdkF7q/+fsokKb/Qr/QrRmfWqgflIjR16mnwu67LbtWUVPKCjTwfYQF/SzWaNRcevGbgKPGlESwq+2dP5Jd+yGpZEAVqxU0yeEB4/HDd1YlEb9YF7UbdGawR0xwSZGsghJ2Whtlww6b+jZowc5O+8DXsMYdOrJRITRnHHyOBl/mucM8v0JrVYy5+ONPCud+8KilzV0hRbDvLLhKrnQxds6aPqvmjNFpRl+HJCEhd1E2BXdaxsc86n4DpoRN/dgULMYDjhtUF3buzaTDucZR4ODZobgRK8LrVy8E4FIuc023n7lDrYoOV7f3VMP4Du5wkt3bWJCmsGkFdKp/Jbt1iSKmaFsZ89Qni7Epha/bceCTXOOWTQTExvcv+j5vrYqSP+4sv/5zAbiYxlI2jWYhEOX9hstI7RYRxAZRzE+fbWCsVBHiMVUjmP+XWQDwL4A/+7oRJJ6xCNyAH7C/V6JHC9VDTDkAAAAASUVORK5CYII=",EA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACnElEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX66FY9uDxVwbHkN0MjFJLwDix8DhIMbo5WPkTZ99gUDRfzwCiYQCYLhgKgOkCCAJAFhoYaAvC5MA0yDJ9oNj7G+EM908GgoKEITDpIIoadA7MkQtW3wNKMWI4MB6YCIHAH8NCUOoS4GdlmNBoAvY1KKXWF+kxgFIePgBylL2lOMP5XV5YUzc0xSuwoBsC8u35Xd4owiDXA+MZRQyd42AlzgDChACGhegaQJaB8hMonkEAFJfI8QMSAwUXsXkWr4UfPv0GJx5/DxlgQaAEMhsMHjz5CmOCaUiCIq6QwGkhzDJ7SzFwfMJsAKW4+f2WMC7JNCjRYAXglKolwLBgghVWeXIFQRY+AMUTMkgsOAbmNhTrA7PEVzhGVkMqG5T6geACKEg3Llx1Nx+WKA4ce8mwYBUoLzGAMzCYASVAeZLYxIGsD8SGZqsLoKLNARgv+++fCgDmOzZ0dVThg9KDoetWUAGiCArSA8BUNrGw/ixVDMdmSGPvRZBlE4FyD2BVwwlgGHt8/PRbwsJYhGo1BshnmeUnGWYsvg2qnhKB+AfMwh9AzsoT595wrtz40EKQHxK0EmKcQGHSASihTZxzgyEy8wgD0EyQz0CWgStgbKYpAAUXADGomUBuEwPUPJkAxA5AjAIA7oMIyaGb3E0AAAAASUVORK5CYII=",CA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACyElEQVRIDa1WX0hTYRQ/Vi7F0C0ihzS41stAqEn/Zi9uD8agBzcIoyezPw8+OfFBelrroeihtr0JRib10CRIH4TEhyWEqURbkjCIugslkIJtMmE5Yv3Obfd273bXdPqDw/2+c77vnO/8+c53iUrhACsAEkH5KimKfWMgAaRBjWpmxNhnbDR4B25Z6VrPCRIsDSrx9oexT0mKrSTJ/2iZEquZIHb6QSnWIBtkY5HenuO24N2zZGysZdmukdrYIv/DZQqOxmNQ5gSl9he03odX7pEH56nuoMzatT1Jl8vZwl6aP64k66Bxhj0UBMshMTp7ac88Kz4qe9p6bpLwde6D0OcbOqkxxjlwXp6lmpbnEvUNvsMpN4v16M7fzK9T+8Vp4j0yUBfkRV0AbjZos7WZZJmk2HNjjk6Bl4xfIXHRQ/l8HgrmlTXlBoO+9+S5PofDGziMmmW9KEKgu8Qgcx0XminoPyN5zZXKFcsnrwSOgrjkIUdHc8nSQsULB4olLBgLdGjYSDjZ2g5reHqTV0869dgaXolBtfRv7jJIdo7UykKjcS4AZWm3y4ID/UuLItAZcEjLQjjWIHmWSm/R+MQXZZ24lqHE2qZCqXROkVUa/NdDrl7GwE0rtXdNUydyI+e3kuJy8hIPuTg4ZGpwXo1NtVJo1fxqxmwwUXzHvCjv8Ymvkj7OH7cnDtt286R3EO6tQIwNTqnzwyEL4ErcgRG++CZrmCZnVinysqvqZi5ZQjNhg9zaHLioEXHJLV1Y5sqQPS/cIZm94y9HiWsAzaCVO3Ui++u3af1H1u5GeathbDIgdwY1q6rx7XtReh35HsLmF/LTsIAYu9IbObP99JE9ezHYs/7hRRp59pmfpz5QVjaYxSS88OFnfXjqm91U8Mp8tB7snYNTEXocp6v9bwk62TM2Jj3AetoEMJ+C+Deh2l8MEXuDIAdIgz9GchluxrTNYQAAAABJRU5ErkJggg==",wA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACgUlEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX6+G0rLD+DIOi+XpwnKAbhI1/4NhLBkO3rQyJhcfh0sB0wVAATBdAEACy0MBAWxAuicwARf6GHU+AQfKV4cPHX8hSWNkgxwUmHQTKMYKCEUVNPDARAoE/XgsDkw8ygHxPLAClTFDUBLjLYGiBpngFkIVYASh1OViJA7OHElZ5bIL717gSzEos2DSCgnDBqnsMIAOwgYmzb4ASAFzK3lIc7Di4AB4GVgsdQ3aDgxJXxr//5AvDx0+/4cbqI7HhgjgYGBaCglKAn43BAehqkE9h4OETYMIBGgwqFCY0msCESaYxLDxw/CXDhSvvwFkB2bSEgmMMCeHKDPP7LZGFSWaDLHwA9Akw80PKTWzxxii1BByfoERELgClYCC4AEqlGxeuukuuOUTrA+VpILgAKtocgCXB/vunAoDxw0a0AaQoBMW9oetWUGGgCPLhAWASn1hYf5YUM0hS29h7EWTZRKCmB7Cq4QQwjD2ASV3CwliEajUGyGeZ5ScZZiy+DaqeEoH4B8zCH0DOyhPn3nCu3PjQQhCYLUBAQowTTJNKgLLTxDk3GCIzjzAAzQT5DGQZuALGZpYCUHABEIOaCeQ2MUDNkwlA7ADEKAAATIH2zR+4T2EAAAAASUVORK5CYII=",TA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAACXElEQVRIDWNgwAQOQKF+IL4PxP/JxOeB+uYDsQIQowBGJJ4AkF0vwMdWkJ+qwZAQpsygIMuNJE0888KV9wwXrr5naOy7xPDg8ZcJQJ2NQPwBZALMQpBl++PDlAwmNJkyCPCxguQoBh8+/WJo7L3EMGH2jQtAwxyB+AMz1NR2oK8CZnSaM3Cww4Qotg9sloejFMiXEhevvucAmrgT5EMFBVme++d3e1PNZ+hOBflU0WwDA5B2ZAJK1tcX68Et27jjMYOi+Xqs+MHjr+hmofA/fPrNUFh/BqwXFIcwAEwXDAXAdAEEASxAwsBAWxAmx6CvLcQwv98KzgcxNu58zLBhxxMGAX7ccQtKKIHJB8EJDeSwDx9/oZgRD0yEDb2X/DEsBKVM9NSZWHicARIKbCiGIHMOHH/J0N9owhDgIcPAKLUEWQrMhpqpALIQL1iw8h5YPiFMCa86aJDhVQOSJGghKC+BfAcDoKADBTEyQJZHFsfGxmshNt+BUtyDJ/gTDzaLYGJ4LUT3HUiTg5U4GMMMIJUGZQusAJvvsCokURBk4QNs+Qub70g0G0U5NF9eAFm4ceGquyiStPAdKLEBwQVQ0eYALAn23z8VACxtcOczFBeRyAGVQIauW0FlqiLIhweAKW9iYf1ZEo0hXnlj70WQZROBOh7AqoYTwDD2+Pjpt4SFsQjVagyQzzLLTzLMWHwbVD0lAvEPmIU/gJyVJ8694Vy58aGFID8kaCXEOIHCpANQIpw45wZDZOYRBqCZIJ+BLANXwNhMUwAKLgBiUDOB3CYGqHkyAYgdgBgFAADj2e234obfjwAAAABJRU5ErkJggg==",SA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAAC20lEQVRIDa1WTWgTURCeqo0tljYBsaE0sK0XQdGU+pN4aXJQAx6SgLR4aqN46MkGD+IpxIPiQbO9FfyJRQ9WD00OxZQeYkCaRtTEYiEguikpQlDIJijEBtGZR3Z52TXSpB0YMm9m3sz73sy8DYCeHKgKIUvIf1rkNO4LIwvIddTGrYwoB4zdhqmrVw7BxOhBECz7OPPWxczHImTWihC8twq5/A8RdwaRZYqgJKRk8fHRQat48wQYu9vJtm2Sy5sQvLsK4v1sBoM5keXdtai3EZVn5s4p6NirqLadj8VyOfsIpfnDWrEDIy4SQkGwdEnppfM7hkx7VEI6cDIC+OvchcZA4NrRumRUA+eFJWjre8rY50/iKX9q4/xz/Wq5AENnF8AfeKfasS9gCvsCyUMJrdbDJtVIp/FeTsAx1BWzYyClvCCXNsHnX1Z9Ggn+wFv0S+LhDYSmzm0cmxDJrUtI6PDOQQweZ6ipU0Mo08n/R3QDNENUGqG/S+da63iBEtaR9YiJnZBPEI3lcUT0QfiNFFA5JK/Xynu0CrqOsGgH76UEOE73squRy1WYfziiulKr8+R2WYAvC2/TyrqEFHz6QRYI6Yi9l/nTevbFF9QNs3Vuo76B5FJVG7fhWpcw8jLPOlJKedRNHkQwdGYB3Of6GepwyK7amhV0NUwkCywoH4jqY+xph3UNMt5nqzIlzPEzRtdIKCOxDTUG1Yx8lCtWDU0I9LYiZShhdPb5Z3XrxNgg0ONNM6UMfmQxD/OPHC0/5iwTjhtShp42B3ZmXHrjYeNAWoUU5LUZUtRN/1IjUg/gfA/QS52r/PptKnyr2Kg5eDL2GLB2Bl7VknzjVhpi8a/TuPmZ8mlYwTt2lcpVs214/459MQjZ5PUUzDz5RJ8nH3JFSVjBxdzK+++dc9F1m6mGynygE9XNE5WCZvfi5GvAmISMksmNIgloeIxMfxNa/Ysh4V4R2YFcR38Bb3Ues5HaWTAAAAAASUVORK5CYII=",RA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAADA0lEQVRIDa1WX0iTURQ/648pim0QOaTRrBcpKCOr5YvbgyT00IQwgkAtevCpSQ/R01wPRQ+57U3QVKiHFoH5EBg+TCH8E9GmpA2CNlGEUbRvQ2Epsc7v5r19m01T94Oze79z7/mde/589xvRRthZ5WWJsmR2KCG262exsmTBoHsy8txtLC9y3bldTa3Nx8lqKdUt//80/ClB4dkEebpmKLaw7GNLD4sGBukQzoItzcdqfA/OkbF8P9Z2DS21Sp4nM+TriYSZzMGi7V1nfcRRObsfX6DiA1K1a3+Cq9FRiSjN07OJYmZ8iwitVktZNDRyuWCR5R4VkVadf008Ovbwott995RyFltYIcfVETJUPheCOXRbYTM77gtycV8wnHBYU3PSpPiabo2y8yJKRK4Jqb9YIQ6AU26Gto5xOnqkVNhEp5oInNBJtHATMq4gpZnM0g2pF1EhvfpDINpcnTLgCQ5zpuENDfbZlR10puqXBOey28GDCLPA9aSx8bjSyXRKI7WgmyAjMiqpzme3T26Q4+DTekJaRyfiZDxYRKPsHCcHKTAQ+Erzi8tyOyHl9roK9YyJllqjpptjhN7IxYYI/b2feY9BEJ0+8ae2nq5pkTYYJzlVscUVJSDPRZtrXBy28x8Os2o4NLxAra4JUS99CtGpzksWwg20FeAsPKdR8FWD6nxps6GGieQqF7hMFVluRDrDcwn5mHfscH/I60waIaWxvwUu4zvwB/l7InJd1BB1RK02A64w1NfbWUsaHxyckhd2uFsx4MfHucarIWSwrz7DUaqvBEeX8Xpq1brcpx+5Q9V+5suac2qFbb+3Dvp+1NDOpMHoe6fqRNaJTsNJ9bWEfidAY+E95Tu1Cjd1LP3zlyn+LW1zNloUHy5xvBaFwP2HIRoOLvmZ64X8NExyjhuTqTWz7eyhgn0xEFn7vSnqfvYFtWtjSUuHaX4ITH78XhIYmreZ1iMzHy5h9faBZvH3Ruh6+ztiTkQGZ1o+JisvDLDgb0JWA2zjOcp7fSx2liz8BkCog304fm8JAAAAAElFTkSuQmCC",IA="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAUCAYAAACeXl35AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAHKADAAQAAAABAAAAFAAAAABUzb9jAAAC0UlEQVRIDa1WTWgTURCe+lNbLDUBaUNpcKMXQdGUqk17MTlUAj00glQ81SoeemqCB/EU40HxoNncCi0kRQ+mCtpDRdtDDIitoiYWiwFpk9IiBMWkoUI0iM63ZpfdbCsxyQdD3pt9b76Zl2/eLpEednb52ZJsvyu0GO8LsglsGtSpZgYeew3N9e6RSwfp/MABEsy7VY/LH8Y/ZCi+mCHfnQVKrW6IvNPHlkUEmRBkkcGB/Vbx+nEyNO/Es6qRzf0k3+0FEscScQ7mYMtuL0a9yVW5Rm91UcMu2VU1nxTL6WhDlab3i5kGjvgMFQqCuSkZm+2rWWWlqaJSy4nHxL+ObfzQ6718REP2/GWaHGdmqa7tnmRDnjksLo2z6Rx7O05Nk8f7VnnOuiA364LhAqHVesioPEytfqfTF6J0lH2ZxFmKzfSxAL5JPmXRFgOP9w0hORCUJjjIImT06wgD4x/J3tNKou+YVLX1sJEiD3sJmSOZfwE9hL9GaG/SLSsqXgChBtn1Ahn21Gt8yBgWnUtr/KUTOclSv3q+Qz3BGMd7jaXs93VKJPAFxhKaI4LU1eh3mqV9at9WYx0hmj70YIk6ep+QiwOxpKUmZiUrMVJr2qPFqZQLHSE2Qiih8DKtrG3Qye5WCoo9rNoZ2tf+9+YJ+rvLja9bpyOEOLhJCZXKgFhwXUFA1QKiSZWqz83ynphclmJLbXIxKiUA4VQK3K2MOAinJiaXlDhoCT+3BISDxrd0PeJjbZHaRFlUwQAnxIjjarNz5pHka5eiSjkeqkOLVHuZZ3MFFuE0BGjBTZ3K//hlTH/J26BKNUBWi8v86o0YPY18DnDs+/KrYZ7P2LmeK5hsnXtrQoLEUdnwlVc0evcTXk9DbHmZMM+T8Py7r43hqRWbsXjTmFoa2f3/wF8RGE/QueEXxDFRGcikF/Bm0QR2htjwmVDpJ0aS94psdjYN/gBLWxwVhmOXcAAAAABJRU5ErkJggg==",ft={exit1:J0,exit2:$0,exit3:tA,exit4:eA,exit5:iA,exit6:nA,exit7:sA,exit8:rA,exit9:oA,exit10:aA,exit11:lA,exit12:hA,exit13:cA,exit14:uA,exit15:dA,exit16:fA,exit17:gA,exit18:mA,exit19:AA,exit20:_A,exit21:pA,exit22:yA,exit23:xA,exit2_1:EA,exit3_1:CA,exit4_1:wA,exit7_1:TA,exit8_1:SA,exit8_2:RA,exit9_1:IA};class vA{constructor(){this.dataProjection=void 0,this.defaultFeatureProjection=void 0,this.featureClass=jt,this.supportedMediaTypes=null}getReadOptions(t,e){if(e){let i=e.dataProjection?Zt(e.dataProjection):this.readProjection(t);e.extent&&i&&i.getUnits()==="tile-pixels"&&(i=Zt(i),i.setWorldExtent(e.extent)),e={dataProjection:i,featureProjection:e.featureProjection}}return this.adaptOptions(e)}adaptOptions(t){return Object.assign({dataProjection:this.dataProjection,featureProjection:this.defaultFeatureProjection,featureClass:this.featureClass},t)}getType(){return q()}readFeature(t,e){return q()}readFeatures(t,e){return q()}readGeometry(t,e){return q()}readProjection(t){return q()}writeFeature(t,e){return q()}writeFeatures(t,e){return q()}writeGeometry(t,e){return q()}}const zu=vA;function so(s,t,e){const i=e?Zt(e.featureProjection):null,n=e?Zt(e.dataProjection):null;let r=s;if(i&&n&&!vn(i,n)){t&&(r=s.clone());const o=t?i:n,a=t?n:i;o.getUnits()==="tile-pixels"?r.transform(o,a):r.applyTransform(wr(o,a))}if(t&&e&&e.decimals!==void 0){const o=Math.pow(10,e.decimals),a=function(l){for(let h=0,c=l.length;h<c;++h)l[h]=Math.round(l[h]*o)/o;return l};r===s&&(r=s.clone()),r.applyTransform(a)}return r}const LA={Point:ue,LineString:ci,Polygon:Oe,MultiPoint:Us,MultiLineString:Ys,MultiPolygon:Xs};function MA(s,t,e){return Array.isArray(t[0])?(vc(s,0,t,e)||(s=s.slice(),Jo(s,0,t,e)),s):(sl(s,0,t,e)||(s=s.slice(),Ir(s,0,t,e)),s)}function Yu(s,t){var r;const e=s.geometry;if(!e)return[];if(Array.isArray(e))return e.map(o=>Yu({...s,geometry:o})).flat();const i=e.type==="MultiPolygon"?"Polygon":e.type;if(i==="GeometryCollection"||i==="Circle")throw new Error("Unsupported geometry type: "+i);const n=e.layout.length;return so(new $t(i,i==="Polygon"?MA(e.flatCoordinates,e.ends,n):e.flatCoordinates,(r=e.ends)==null?void 0:r.flat(),n,s.properties||{},s.id).enableSimplifyTransformed(),!1,t)}function Ll(s,t){if(!s)return null;if(Array.isArray(s)){const i=s.map(n=>Ll(n,t));return new Tl(i)}const e=LA[s.type];return so(new e(s.flatCoordinates,s.layout,s.ends),!1,t)}class PA extends zu{constructor(){super()}getType(){return"json"}readFeature(t,e){return this.readFeatureFromObject(hr(t),this.getReadOptions(t,e))}readFeatures(t,e){return this.readFeaturesFromObject(hr(t),this.getReadOptions(t,e))}readFeatureFromObject(t,e){return q()}readFeaturesFromObject(t,e){return q()}readGeometry(t,e){return this.readGeometryFromObject(hr(t),this.getReadOptions(t,e))}readGeometryFromObject(t,e){return q()}readProjection(t){return this.readProjectionFromObject(hr(t))}readProjectionFromObject(t){return q()}writeFeature(t,e){return JSON.stringify(this.writeFeatureObject(t,e))}writeFeatureObject(t,e){return q()}writeFeatures(t,e){return JSON.stringify(this.writeFeaturesObject(t,e))}writeFeaturesObject(t,e){return q()}writeGeometry(t,e){return JSON.stringify(this.writeGeometryObject(t,e))}writeGeometryObject(t,e){return q()}}function hr(s){if(typeof s=="string"){const t=JSON.parse(s);return t||null}return s!==null?s:null}class ro extends PA{constructor(t){t=t||{},super(),this.dataProjection=Zt(t.dataProjection?t.dataProjection:"EPSG:4326"),t.featureProjection&&(this.defaultFeatureProjection=Zt(t.featureProjection)),t.featureClass&&(this.featureClass=t.featureClass),this.geometryName_=t.geometryName,this.extractGeometryName_=t.extractGeometryName,this.supportedMediaTypes=["application/geo+json","application/vnd.geo+json"]}readFeatureFromObject(t,e){let i=null;t.type==="Feature"?i=t:i={type:"Feature",geometry:t,properties:null};const n=Ml(i.geometry);if(this.featureClass===$t)return Yu({geometry:n,id:i.id,properties:i.properties},e);const r=new jt;return this.geometryName_?r.setGeometryName(this.geometryName_):this.extractGeometryName_&&i.geometry_name&&r.setGeometryName(i.geometry_name),r.setGeometry(Ll(n,e)),"id"in i&&r.setId(i.id),i.properties&&r.setProperties(i.properties,!0),r}readFeaturesFromObject(t,e){const i=t;let n=null;if(i.type==="FeatureCollection"){const r=t;n=[];const o=r.features;for(let a=0,l=o.length;a<l;++a){const h=this.readFeatureFromObject(o[a],e);h&&n.push(h)}}else n=[this.readFeatureFromObject(t,e)];return n.flat()}readGeometryFromObject(t,e){return FA(t,e)}readProjectionFromObject(t){const e=t.crs;let i;if(e)if(e.type=="name")i=Zt(e.properties.name);else if(e.type==="EPSG")i=Zt("EPSG:"+e.properties.code);else throw new Error("Unknown SRS type");else i=this.dataProjection;return i}writeFeatureObject(t,e){e=this.adaptOptions(e);const i={type:"Feature",geometry:null,properties:null},n=t.getId();if(n!==void 0&&(i.id=n),!t.hasProperties())return i;const r=t.getProperties(),o=t.getGeometry();return o&&(i.geometry=pa(o,e),delete r[t.getGeometryName()]),ki(r)||(i.properties=r),i}writeFeaturesObject(t,e){e=this.adaptOptions(e);const i=[];for(let n=0,r=t.length;n<r;++n)i.push(this.writeFeatureObject(t[n],e));return{type:"FeatureCollection",features:i}}writeGeometryObject(t,e){return pa(t,this.adaptOptions(e))}}function Ml(s,t){if(!s)return null;let e;switch(s.type){case"Point":{e=OA(s);break}case"LineString":{e=NA(s);break}case"Polygon":{e=BA(s);break}case"MultiPoint":{e=kA(s);break}case"MultiLineString":{e=DA(s);break}case"MultiPolygon":{e=GA(s);break}case"GeometryCollection":{e=bA(s);break}default:throw new Error("Unsupported GeoJSON type: "+s.type)}return e}function FA(s,t){const e=Ml(s);return Ll(e,t)}function bA(s,t){return s.geometries.map(function(i){return Ml(i)})}function OA(s){const t=s.coordinates;return{type:"Point",flatCoordinates:t,layout:hn(t.length)}}function NA(s){var i;const t=s.coordinates,e=t.flat();return{type:"LineString",flatCoordinates:e,ends:[e.length],layout:hn(((i=t[0])==null?void 0:i.length)||2)}}function DA(s){var r,o;const t=s.coordinates,e=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length)||2,i=[],n=ks(i,0,t,e);return{type:"MultiLineString",flatCoordinates:i,ends:n,layout:hn(e)}}function kA(s){var e;const t=s.coordinates;return{type:"MultiPoint",flatCoordinates:t.flat(),layout:hn(((e=t[0])==null?void 0:e.length)||2)}}function GA(s){var r,o;const t=s.coordinates,e=[],i=((o=(r=t[0])==null?void 0:r[0])==null?void 0:o[0].length)||2,n=yc(e,0,t,i);return{type:"MultiPolygon",flatCoordinates:e,ends:n,layout:hn(i)}}function BA(s){var r,o;const t=s.coordinates,e=[],i=(o=(r=t[0])==null?void 0:r[0])==null?void 0:o.length,n=ks(e,0,t,i);return{type:"Polygon",flatCoordinates:e,ends:n,layout:hn(i)}}function pa(s,t){s=so(s,!0,t);const e=s.getType();let i;switch(e){case"Point":{i=KA(s);break}case"LineString":{i=YA(s);break}case"Polygon":{i=WA(s,t);break}case"MultiPoint":{i=XA(s);break}case"MultiLineString":{i=UA(s);break}case"MultiPolygon":{i=VA(s,t);break}case"GeometryCollection":{i=zA(s,t);break}case"Circle":{i={type:"GeometryCollection",geometries:[]};break}default:throw new Error("Unsupported geometry type: "+e)}return i}function zA(s,t){return t=Object.assign({},t),delete t.featureProjection,{type:"GeometryCollection",geometries:s.getGeometriesArray().map(function(i){return pa(i,t)})}}function YA(s,t){return{type:"LineString",coordinates:s.getCoordinates()}}function UA(s,t){return{type:"MultiLineString",coordinates:s.getCoordinates()}}function XA(s,t){return{type:"MultiPoint",coordinates:s.getCoordinates()}}function VA(s,t){let e;return t&&(e=t.rightHanded),{type:"MultiPolygon",coordinates:s.getCoordinates(e)}}function KA(s,t){return{type:"Point",coordinates:s.getCoordinates()}}function WA(s,t){let e;return t&&(e=t.rightHanded),{type:"Polygon",coordinates:s.getCoordinates(e)}}const ya=65536*65536,Dh=1/ya,jA=12,kh=typeof TextDecoder>"u"?null:new TextDecoder("utf-8"),ko=0,cr=1,ns=2,ur=5;class ZA{constructor(t=new Uint8Array(16)){this.buf=ArrayBuffer.isView(t)?t:new Uint8Array(t),this.dataView=new DataView(this.buf.buffer),this.pos=0,this.type=0,this.length=this.buf.length}readFields(t,e,i=this.length){for(;this.pos<i;){const n=this.readVarint(),r=n>>3,o=this.pos;this.type=n&7,t(r,e,this),this.pos===o&&this.skip(n)}return e}readMessage(t,e){return this.readFields(t,e,this.readVarint()+this.pos)}readFixed32(){const t=this.dataView.getUint32(this.pos,!0);return this.pos+=4,t}readSFixed32(){const t=this.dataView.getInt32(this.pos,!0);return this.pos+=4,t}readFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getUint32(this.pos+4,!0)*ya;return this.pos+=8,t}readSFixed64(){const t=this.dataView.getUint32(this.pos,!0)+this.dataView.getInt32(this.pos+4,!0)*ya;return this.pos+=8,t}readFloat(){const t=this.dataView.getFloat32(this.pos,!0);return this.pos+=4,t}readDouble(){const t=this.dataView.getFloat64(this.pos,!0);return this.pos+=8,t}readVarint(t){const e=this.buf;let i,n;return n=e[this.pos++],i=n&127,n<128||(n=e[this.pos++],i|=(n&127)<<7,n<128)||(n=e[this.pos++],i|=(n&127)<<14,n<128)||(n=e[this.pos++],i|=(n&127)<<21,n<128)?i:(n=e[this.pos],i|=(n&15)<<28,QA(i,t,this))}readVarint64(){return this.readVarint(!0)}readSVarint(){const t=this.readVarint();return t%2===1?(t+1)/-2:t/2}readBoolean(){return!!this.readVarint()}readString(){const t=this.readVarint()+this.pos,e=this.pos;return this.pos=t,t-e>=jA&&kh?kh.decode(this.buf.subarray(e,t)):l_(this.buf,e,t)}readBytes(){const t=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,t);return this.pos=t,e}readPackedVarint(t=[],e){const i=this.readPackedEnd();for(;this.pos<i;)t.push(this.readVarint(e));return t}readPackedSVarint(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSVarint());return t}readPackedBoolean(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readBoolean());return t}readPackedFloat(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFloat());return t}readPackedDouble(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readDouble());return t}readPackedFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed32());return t}readPackedSFixed32(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed32());return t}readPackedFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readFixed64());return t}readPackedSFixed64(t=[]){const e=this.readPackedEnd();for(;this.pos<e;)t.push(this.readSFixed64());return t}readPackedEnd(){return this.type===ns?this.readVarint()+this.pos:this.pos+1}skip(t){const e=t&7;if(e===ko)for(;this.buf[this.pos++]>127;);else if(e===ns)this.pos=this.readVarint()+this.pos;else if(e===ur)this.pos+=4;else if(e===cr)this.pos+=8;else throw new Error(`Unimplemented type: ${e}`)}writeTag(t,e){this.writeVarint(t<<3|e)}realloc(t){let e=this.length||16;for(;e<this.pos+t;)e*=2;if(e!==this.length){const i=new Uint8Array(e);i.set(this.buf),this.buf=i,this.dataView=new DataView(i.buffer),this.length=e}}finish(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)}writeFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeSFixed32(t){this.realloc(4),this.dataView.setInt32(this.pos,t,!0),this.pos+=4}writeFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Dh),!0),this.pos+=8}writeSFixed64(t){this.realloc(8),this.dataView.setInt32(this.pos,t&-1,!0),this.dataView.setInt32(this.pos+4,Math.floor(t*Dh),!0),this.pos+=8}writeVarint(t){if(t=+t||0,t>268435455||t<0){qA(t,this);return}this.realloc(4),this.buf[this.pos++]=t&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=(t>>>=7)&127|(t>127?128:0),!(t<=127)&&(this.buf[this.pos++]=t>>>7&127)))}writeSVarint(t){this.writeVarint(t<0?-t*2-1:t*2)}writeBoolean(t){this.writeVarint(+t)}writeString(t){t=String(t),this.realloc(t.length*4),this.pos++;const e=this.pos;this.pos=h_(this.buf,t,this.pos);const i=this.pos-e;i>=128&&Gh(e,i,this),this.pos=e-1,this.writeVarint(i),this.pos+=i}writeFloat(t){this.realloc(4),this.dataView.setFloat32(this.pos,t,!0),this.pos+=4}writeDouble(t){this.realloc(8),this.dataView.setFloat64(this.pos,t,!0),this.pos+=8}writeBytes(t){const e=t.length;this.writeVarint(e),this.realloc(e);for(let i=0;i<e;i++)this.buf[this.pos++]=t[i]}writeRawMessage(t,e){this.pos++;const i=this.pos;t(e,this);const n=this.pos-i;n>=128&&Gh(i,n,this),this.pos=i-1,this.writeVarint(n),this.pos+=n}writeMessage(t,e,i){this.writeTag(t,ns),this.writeRawMessage(e,i)}writePackedVarint(t,e){e.length&&this.writeMessage(t,$A,e)}writePackedSVarint(t,e){e.length&&this.writeMessage(t,t_,e)}writePackedBoolean(t,e){e.length&&this.writeMessage(t,n_,e)}writePackedFloat(t,e){e.length&&this.writeMessage(t,e_,e)}writePackedDouble(t,e){e.length&&this.writeMessage(t,i_,e)}writePackedFixed32(t,e){e.length&&this.writeMessage(t,s_,e)}writePackedSFixed32(t,e){e.length&&this.writeMessage(t,r_,e)}writePackedFixed64(t,e){e.length&&this.writeMessage(t,o_,e)}writePackedSFixed64(t,e){e.length&&this.writeMessage(t,a_,e)}writeBytesField(t,e){this.writeTag(t,ns),this.writeBytes(e)}writeFixed32Field(t,e){this.writeTag(t,ur),this.writeFixed32(e)}writeSFixed32Field(t,e){this.writeTag(t,ur),this.writeSFixed32(e)}writeFixed64Field(t,e){this.writeTag(t,cr),this.writeFixed64(e)}writeSFixed64Field(t,e){this.writeTag(t,cr),this.writeSFixed64(e)}writeVarintField(t,e){this.writeTag(t,ko),this.writeVarint(e)}writeSVarintField(t,e){this.writeTag(t,ko),this.writeSVarint(e)}writeStringField(t,e){this.writeTag(t,ns),this.writeString(e)}writeFloatField(t,e){this.writeTag(t,ur),this.writeFloat(e)}writeDoubleField(t,e){this.writeTag(t,cr),this.writeDouble(e)}writeBooleanField(t,e){this.writeVarintField(t,+e)}}function QA(s,t,e){const i=e.buf;let n,r;if(r=i[e.pos++],n=(r&112)>>4,r<128||(r=i[e.pos++],n|=(r&127)<<3,r<128)||(r=i[e.pos++],n|=(r&127)<<10,r<128)||(r=i[e.pos++],n|=(r&127)<<17,r<128)||(r=i[e.pos++],n|=(r&127)<<24,r<128)||(r=i[e.pos++],n|=(r&1)<<31,r<128))return wn(s,n,t);throw new Error("Expected varint not more than 10 bytes")}function wn(s,t,e){return e?t*4294967296+(s>>>0):(t>>>0)*4294967296+(s>>>0)}function qA(s,t){let e,i;if(s>=0?(e=s%4294967296|0,i=s/4294967296|0):(e=~(-s%4294967296),i=~(-s/4294967296),e^4294967295?e=e+1|0:(e=0,i=i+1|0)),s>=18446744073709552e3||s<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");t.realloc(10),HA(e,i,t),JA(i,t)}function HA(s,t,e){e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos++]=s&127|128,s>>>=7,e.buf[e.pos]=s&127}function JA(s,t){const e=(s&7)<<4;t.buf[t.pos++]|=e|((s>>>=3)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127|((s>>>=7)?128:0),s&&(t.buf[t.pos++]=s&127)))))}function Gh(s,t,e){const i=t<=16383?1:t<=2097151?2:t<=268435455?3:Math.floor(Math.log(t)/(Math.LN2*7));e.realloc(i);for(let n=e.pos-1;n>=s;n--)e.buf[n+i]=e.buf[n]}function $A(s,t){for(let e=0;e<s.length;e++)t.writeVarint(s[e])}function t_(s,t){for(let e=0;e<s.length;e++)t.writeSVarint(s[e])}function e_(s,t){for(let e=0;e<s.length;e++)t.writeFloat(s[e])}function i_(s,t){for(let e=0;e<s.length;e++)t.writeDouble(s[e])}function n_(s,t){for(let e=0;e<s.length;e++)t.writeBoolean(s[e])}function s_(s,t){for(let e=0;e<s.length;e++)t.writeFixed32(s[e])}function r_(s,t){for(let e=0;e<s.length;e++)t.writeSFixed32(s[e])}function o_(s,t){for(let e=0;e<s.length;e++)t.writeFixed64(s[e])}function a_(s,t){for(let e=0;e<s.length;e++)t.writeSFixed64(s[e])}function l_(s,t,e){let i="",n=t;for(;n<e;){const r=s[n];let o=null,a=r>239?4:r>223?3:r>191?2:1;if(n+a>e)break;let l,h,c;a===1?r<128&&(o=r):a===2?(l=s[n+1],(l&192)===128&&(o=(r&31)<<6|l&63,o<=127&&(o=null))):a===3?(l=s[n+1],h=s[n+2],(l&192)===128&&(h&192)===128&&(o=(r&15)<<12|(l&63)<<6|h&63,(o<=2047||o>=55296&&o<=57343)&&(o=null))):a===4&&(l=s[n+1],h=s[n+2],c=s[n+3],(l&192)===128&&(h&192)===128&&(c&192)===128&&(o=(r&15)<<18|(l&63)<<12|(h&63)<<6|c&63,(o<=65535||o>=1114112)&&(o=null))),o===null?(o=65533,a=1):o>65535&&(o-=65536,i+=String.fromCharCode(o>>>10&1023|55296),o=56320|o&1023),i+=String.fromCharCode(o),n+=a}return i}function h_(s,t,e){for(let i=0,n,r;i<t.length;i++){if(n=t.charCodeAt(i),n>55295&&n<57344)if(r)if(n<56320){s[e++]=239,s[e++]=191,s[e++]=189,r=n;continue}else n=r-55296<<10|n-56320|65536,r=null;else{n>56319||i+1===t.length?(s[e++]=239,s[e++]=191,s[e++]=189):r=n;continue}else r&&(s[e++]=239,s[e++]=191,s[e++]=189,r=null);n<128?s[e++]=n:(n<2048?s[e++]=n>>6|192:(n<65536?s[e++]=n>>12|224:(s[e++]=n>>18|240,s[e++]=n>>12&63|128),s[e++]=n>>6&63|128),s[e++]=n&63|128)}return e}class c_ extends zu{constructor(t){super(),t=t||{},this.dataProjection=new Fd({code:"",units:"tile-pixels"}),this.featureClass=t.featureClass?t.featureClass:$t,this.geometryName_=t.geometryName,this.layerName_=t.layerName?t.layerName:"layer",this.layers_=t.layers?t.layers:null,this.idProperty_=t.idProperty,this.supportedMediaTypes=["application/vnd.mapbox-vector-tile","application/x-protobuf"]}readRawGeometry_(t,e,i,n){t.pos=e.geometry;const r=t.readVarint()+t.pos;let o=1,a=0,l=0,h=0,c=0,u=0;for(;t.pos<r;){if(!a){const d=t.readVarint();o=d&7,a=d>>3}if(a--,o===1||o===2)l+=t.readSVarint(),h+=t.readSVarint(),o===1&&c>u&&(n.push(c),u=c),i.push(l,h),c+=2;else if(o===7)c>u&&(i.push(i[u],i[u+1]),c+=2);else throw new Error("Invalid command found in the PBF")}c>u&&(n.push(c),u=c)}createFeature_(t,e,i){const n=e.type;if(n===0)return null;let r;const o=e.properties;let a;this.idProperty_?(a=o[this.idProperty_],delete o[this.idProperty_]):a=e.id,o[this.layerName_]=e.layer.name;const l=[],h=[];this.readRawGeometry_(t,e,l,h);const c=m_(n,h.length);if(this.featureClass===$t)r=new this.featureClass(c,l,h,2,o,a),r.transform(i.dataProjection);else{let u;if(c=="Polygon"){const m=Lc(l,h);u=m.length>1?new Xs(l,"XY",m):new Oe(l,"XY",h)}else u=c==="Point"?new ue(l,"XY"):c==="LineString"?new ci(l,"XY"):c==="MultiPoint"?new Us(l,"XY"):c==="MultiLineString"?new Ys(l,"XY",h):null;const d=this.featureClass;r=new d,this.geometryName_&&r.setGeometryName(this.geometryName_);const f=so(u,!1,i);r.setGeometry(f),a!==void 0&&r.setId(a),r.setProperties(o,!0)}return r}getType(){return"arraybuffer"}readFeatures(t,e){const i=this.layers_;e=this.adaptOptions(e);const n=Zt(e.dataProjection);n.setWorldExtent(e.extent),e.dataProjection=n;const r=new ZA(t),o=r.readFields(u_,{}),a=[];for(const l in o){if(i&&!i.includes(l))continue;const h=o[l],c=h?[0,0,h.extent,h.extent]:null;n.setExtent(c);for(let u=0,d=h.length;u<d;++u){const f=g_(r,h,u),m=this.createFeature_(r,f,e);m!==null&&a.push(m)}}return a}readProjection(t){return this.dataProjection}setLayers(t){this.layers_=t}}function u_(s,t,e){if(s===3){const i={keys:[],values:[],features:[]},n=e.readVarint()+e.pos;e.readFields(d_,i,n),i.length=i.features.length,i.length&&(t[i.name]=i)}}function d_(s,t,e){if(s===15)t.version=e.readVarint();else if(s===1)t.name=e.readString();else if(s===5)t.extent=e.readVarint();else if(s===2)t.features.push(e.pos);else if(s===3)t.keys.push(e.readString());else if(s===4){let i=null;const n=e.readVarint()+e.pos;for(;e.pos<n;)s=e.readVarint()>>3,i=s===1?e.readString():s===2?e.readFloat():s===3?e.readDouble():s===4?e.readVarint64():s===5?e.readVarint():s===6?e.readSVarint():s===7?e.readBoolean():null;t.values.push(i)}}function f_(s,t,e){if(s==1)t.id=e.readVarint();else if(s==2){const i=e.readVarint()+e.pos;for(;e.pos<i;){const n=t.layer.keys[e.readVarint()],r=t.layer.values[e.readVarint()];t.properties[n]=r}}else s==3?t.type=e.readVarint():s==4&&(t.geometry=e.pos)}function g_(s,t,e){s.pos=t.features[e];const i=s.readVarint()+s.pos,n={layer:t,type:0,properties:{}};return s.readFields(f_,n,i),n}function m_(s,t){let e;return s===1?e=t===1?"Point":"MultiPoint":s===2?e=t===1?"LineString":"MultiLineString":s===3&&(e="Polygon"),e}const Vt={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Uu extends ke{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=t.insertFirst!==void 0?t.insertFirst:!0,this.stopEvent=t.stopEvent!==void 0?t.stopEvent:!0,this.element=document.createElement("div"),this.element.className=t.className!==void 0?t.className:"ol-overlay-container "+Hf,this.element.style.position="absolute",this.element.style.pointerEvents="auto",this.autoPan=t.autoPan===!0?{}:t.autoPan||void 0,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Vt.ELEMENT,this.handleElementChanged),this.addChangeListener(Vt.MAP,this.handleMapChanged),this.addChangeListener(Vt.OFFSET,this.handleOffsetChanged),this.addChangeListener(Vt.POSITION,this.handlePositionChanged),this.addChangeListener(Vt.POSITIONING,this.handlePositioningChanged),t.element!==void 0&&this.setElement(t.element),this.setOffset(t.offset!==void 0?t.offset:[0,0]),this.setPositioning(t.positioning||"top-left"),t.position!==void 0&&this.setPosition(t.position)}getElement(){return this.get(Vt.ELEMENT)}getId(){return this.id}getMap(){return this.get(Vt.MAP)||null}getOffset(){return this.get(Vt.OFFSET)}getPosition(){return this.get(Vt.POSITION)}getPositioning(){return this.get(Vt.POSITIONING)}handleElementChanged(){Bc(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){var e;this.mapPostrenderListenerKey&&((e=this.element)==null||e.remove(),_t(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=at(t,ni.POSTRENDER,this.render,this),this.updatePixelPosition();const i=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?i.insertBefore(this.element,i.childNodes[0]||null):i.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Vt.ELEMENT,t)}setMap(t){this.set(Vt.MAP,t)}setOffset(t){this.set(Vt.OFFSET,t)}setPosition(t){this.set(Vt.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Vt.POSITION))return;const i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),r=this.getRect(n,[Uf(n),Xf(n)]);t=t||{};const o=t.margin===void 0?20:t.margin;if(!Ri(i,r)){const a=r[0]-i[0],l=i[2]-r[2],h=r[1]-i[1],c=i[3]-r[3],u=[0,0];if(a<0?u[0]=a-o:l<0&&(u[0]=Math.abs(l)+o),h<0?u[1]=h-o:c<0&&(u[1]=Math.abs(c)+o),u[0]!==0||u[1]!==0){const d=e.getView().getCenterInternal(),f=e.getPixelFromCoordinateInternal(d);if(!f)return;const m=[f[0]+u[0],f[1]+u[1]],p=t.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(m),duration:p.duration,easing:p.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,r=i.top+window.pageYOffset;return[n,r,n+e[0],r+e[1]]}setPositioning(t){this.set(Vt.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e){this.setVisible(!1);return}const i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}updateRenderedPosition(t,e){const i=this.element.style,n=this.getOffset(),r=this.getPositioning();this.setVisible(!0);const o=Math.round(t[0]+n[0])+"px",a=Math.round(t[1]+n[1])+"px";let l="0%",h="0%";r=="bottom-right"||r=="center-right"||r=="top-right"?l="-100%":(r=="bottom-center"||r=="center-center"||r=="top-center")&&(l="-50%"),r=="bottom-left"||r=="bottom-center"||r=="bottom-right"?h="-100%":(r=="center-left"||r=="center-center"||r=="center-right")&&(h="-50%");const c=`translate(${l}, ${h}) translate(${o}, ${a})`;this.rendered.transform_!=c&&(this.rendered.transform_=c,i.transform=c)}getOptions(){return this.options}}let gi;Vr.subscribe(s=>gi=s);const Pl={1:"#7885BB",2:"#84CD8C",3:"#F5A881",4:"#7AC0E7",5:"#B086E4",6:"#CE9168",7:"#A1A56E",8:"#EA73A3",9:"#D9C593",10:"#71B1E6",11:"#ABD7C4",12:"#91D5C0",13:"#A5CFE9",14:"#C4E29E",15:"#F2E374",16:"#CD7984",17:"#D2D087",18:"#BCA468",19:"#A8D6A5",20:"#FABF78",21:"#A4BDDE",22:"#F8C67E",23:"#66BCB9",24:"#E98D9D",25:"#66CBB3",26:"#FFD066",27:"#65AC91",28:"#F6A665",29:"#B4D992",30:"#D7BA66",31:"#7AB1E0",32:"#B79DCC",33:"#909FC4",34:"#6698C9"},A_={1:ft.exit1,2:ft.exit2,3:ft.exit3,4:ft.exit4,5:ft.exit5,6:ft.exit6,7:ft.exit7,8:ft.exit8,9:ft.exit9,10:ft.exit10,11:ft.exit11,12:ft.exit12,13:ft.exit13,14:ft.exit14,15:ft.exit15,16:ft.exit16,17:ft.exit17,18:ft.exit18,19:ft.exit19,20:ft.exit20,21:ft.exit21,22:ft.exit22,23:ft.exit23,"2-1":ft.exit2_1,"3-1":ft.exit3_1,"4-1":ft.exit4_1,"7-1":ft.exit7_1,"8-1":ft.exit8_1,"8-2":ft.exit8_2,"9-1":ft.exit9_1},Fl=new ro,__=new Be({source:new Ge({format:Fl,url:Od}),style:function(s){if(!gi)return;const t=gi.getView().getZoom();if(t&&t>=15){const e=Pl[s.get("line_id")];return new At({stroke:new oe({color:e,width:1.5})})}else return},zIndex:2,updateWhileAnimating:!0,updateWhileInteracting:!0}),Xu=new Ge,Vu=new Ge;fetch(Nd).then(s=>s.json()).then(s=>{Fl.readFeatures(s).forEach(e=>{Xu.addFeature(e);const i=e.get("center");if(i){const n=new jt({geometry:new ue(i.coordinates),name:e.get("name"),color:Pl[e.get("line_id")]});Vu.addFeature(n)}})}).catch(s=>console.error("Error loading GeoJSON data:",s));const p_=new Be({source:Xu,style:function(s){if(!gi)return;const t=gi.getView().getZoom();if(t&&t>=15.8){const e=Pl[s.get("line_id")];return new At({fill:new Ct({color:e})})}else return},zIndex:4,updateWhileAnimating:!0,updateWhileInteracting:!0}),y_=new Be({source:Vu,style:function(s){if(!gi)return;const t=gi.getView().getZoom();if(!(!t||t<15))return t<15.8?new At({image:new cn({radius:4,fill:new Ct({color:"white"}),stroke:new oe({color:s.get("color"),width:1.5})}),text:new ie({font:'600 14px "Pretendard Variable"',textBaseline:"top",offsetY:8,fill:new Ct({color:"#25272A"}),stroke:new oe({color:"white",width:3}),text:s.get("name")})}):new At({text:new ie({font:'600 14px "Pretendard Variable"',textBaseline:"top",offsetY:8,fill:new Ct({color:"#25272A"}),stroke:new oe({color:"white",width:3}),text:s.get("name")})})},zIndex:6,updateWhileAnimating:!0,updateWhileInteracting:!0,declutter:!0}),Go={},x_=new Be({source:new Ge({format:Fl,url:Dd}),style:function(s){if(!gi)return;const t=gi.getView().getZoom();if(t&&t>=16.2){const e=s.get("id");return Go[e]||(Go[e]=new At({image:new fi({src:A_[s.get("name")],scale:.75})})),Go[e]}else return},zIndex:5,updateWhileAnimating:!0,updateWhileInteracting:!0}),E_="data:image/svg+xml,%3csvg%20width='8'%20height='8'%20viewBox='0%200%208%208'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='4'%20cy='4'%20r='3.5'%20fill='white'%20stroke='%2325272A'%20/%3e%3ccircle%20cx='4'%20cy='4'%20r='1.5'%20fill='%2325272A'%20stroke='%2325272A'%20/%3e%3c/svg%3e",C_="data:image/svg+xml,%3csvg%20width='6'%20height='6'%20viewBox='0%200%206%206'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3ccircle%20cx='3'%20cy='3'%20r='2.5'%20transform='matrix(1%200%200%20-1%200%206)'%20fill='white'%20stroke='%2325272A'%20/%3e%3c/svg%3e";let xa;Vr.subscribe(s=>xa=s);const wi=new oe({color:"white",width:1}),w_=new Ge({format:new ro,url:s=>`${za}/wfs?service=WFS&version=2.0.0&request=GetFeature&typename=bluedot:base_administrative&srsName=EPSG%3A900913&outputFormat=application%2Fjson&exceptions=application%2Fjson&bbox=${s.join(",")},EPSG:900913`,strategy:Cu}),T_=new Tu({source:w_,distance:80,createCluster:(s,t)=>t.length<=1?t[0]:t.sort((i,n)=>i.get("labelrank")-n.get("labelrank"))[0]}),S_=new Be({source:T_,style:function(s){if(!xa)return;const t=xa.getView().getZoom();if(!t||t<6)return;const e=s.get("labelrank"),i=s.get("alias")??s.get("name_ko");if(e===1)return t>=6&&t<7.5?new At({text:new ie({font:'700 14px "Pretendard Variable"',fill:new Ct({color:"#25272A"}),stroke:wi,text:i}),zIndex:10}):void 0;if(e===2){const n=s.get("capital");return t>=6&&t<11?new At({text:new ie({font:`600 ${t<8?"12":"16"}px "Pretendard Variable"`,textAlign:"left",offsetX:7,fill:new Ct({color:"#25272A"}),stroke:wi,text:i}),image:n?new fi({src:E_,width:8}):void 0,zIndex:9}):void 0}else if(e===3){const n=s.get("metropolitan");return t>=7.5&&t<11?new At({text:new ie({font:`600 ${t<8?"10":"14"}px "Pretendard Variable"`,textBaseline:"bottom",offsetY:-5,fill:new Ct({color:"#4B5362"}),stroke:wi,text:i}),image:n?new fi({src:C_,width:6}):void 0,zIndex:8}):void 0}else return e===4?t>=8&&t<9?new At({text:new ie({font:'600 12px "Pretendard Variable"',fill:new Ct({color:"#778195"}),stroke:wi,text:i}),zIndex:7}):void 0:e===5?t>=9&&t<14?new At({text:new ie({font:`600 ${t<11?"12":"14"}px "Pretendard Variable"`,fill:new Ct({color:"#8690A2"}),stroke:wi,text:i}),zIndex:6}):void 0:e===6?t>=11&&t<14?new At({text:new ie({font:'600 14px "Pretendard Variable"',fill:new Ct({color:"#8690A2"}),stroke:wi,text:i}),zIndex:5}):void 0:e===7?t>=14&&t<17.1?new At({text:new ie({font:`600 ${t<13?"10":"12"}px "Pretendard Variable"`,fill:new Ct({color:"#8690A2"}),stroke:wi,text:i}),zIndex:4}):void 0:e===8&&t>=15&&t<17.1?new At({text:new ie({font:'600 10px "Pretendard Variable"',fill:new Ct({color:"#8690A2"}),stroke:wi,text:i}),zIndex:3}):void 0},zIndex:3,renderBuffer:100}),Ku=new At({fill:new Ct({color:"#DAEEFF"}),stroke:new oe({color:"#D1E9FC",width:1})}),R_=new U0({source:new a0({format:new c_,url:kd}),minZoom:17,zIndex:1,renderMode:"vector",style:Ku}),I_=new Be({source:new Ge({format:new ro,url:s=>`${za}/wfs?service=WFS&version=2.0.0&request=GetFeature&typename=bluedot:base_building_big&srsName=EPSG%3A900913&outputFormat=application%2Fjson&exceptions=application%2Fjson&bbox=${s[0]}%2C${s[1]}%2C${s[2]}%2C${s[3]}%2CEPSG%3A900913`,strategy:Cu}),minZoom:16,maxZoom:17,zIndex:1,updateWhileAnimating:!0,updateWhileInteracting:!0,style:Ku}),dr={DRAWSTART:"drawstart",DRAWEND:"drawend",DRAWABORT:"drawabort"};class fr extends De{constructor(t,e){super(t),this.feature=e}}function v_(s,t){const e=[];for(let i=0;i<t.length;++i){const r=t[i].getGeometry();Wu(s,r,e)}return e}function gr(s,t){return Pi(s[0],s[1],t[0],t[1])}function Mn(s,t){const e=s.length;return t<0?s[t+e]:t>=e?s[t-e]:s[t]}function mr(s,t,e){let i,n;t<e?(i=t,n=e):(i=e,n=t);const r=Math.ceil(i),o=Math.floor(n);if(r>o){const l=Pn(s,i),h=Pn(s,n);return gr(l,h)}let a=0;if(i<r){const l=Pn(s,i),h=Mn(s,r);a+=gr(l,h)}if(o<n){const l=Mn(s,o),h=Pn(s,n);a+=gr(l,h)}for(let l=r;l<o-1;++l){const h=Mn(s,l),c=Mn(s,l+1);a+=gr(h,c)}return a}function Wu(s,t,e){if(t instanceof ci){Ar(s,t.getCoordinates(),!1,e);return}if(t instanceof Ys){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n)Ar(s,i[n],!1,e);return}if(t instanceof Oe){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n)Ar(s,i[n],!0,e);return}if(t instanceof Xs){const i=t.getCoordinates();for(let n=0,r=i.length;n<r;++n){const o=i[n];for(let a=0,l=o.length;a<l;++a)Ar(s,o[a],!0,e)}return}if(t instanceof Tl){const i=t.getGeometries();for(let n=0;n<i.length;++n)Wu(s,i[n],e);return}}const Bo={index:-1,endIndex:NaN};function L_(s,t,e,i){const n=s[0],r=s[1];let o=1/0,a=-1,l=NaN;for(let u=0;u<t.targets.length;++u){const d=t.targets[u],f=d.coordinates;let m=1/0,p;for(let x=0;x<f.length-1;++x){const T=f[x],_=f[x+1],v=ju(n,r,T,_);v.squaredDistance<m&&(m=v.squaredDistance,p=x+v.along)}m<o&&(o=m,d.ring&&t.targetIndex===u&&(d.endIndex>d.startIndex?p<d.startIndex&&(p+=f.length):d.endIndex<d.startIndex&&p>d.startIndex&&(p-=f.length)),l=p,a=u)}const h=t.targets[a];let c=h.ring;if(t.targetIndex===a&&c){const u=Pn(h.coordinates,l),d=e.getPixelFromCoordinate(u);hc(d,t.startPx)>i&&(c=!1)}if(c){const u=h.coordinates,d=u.length,f=h.startIndex,m=l;if(f<m){const p=mr(u,f,m);mr(u,f,m-d)<p&&(l-=d)}else{const p=mr(u,f,m);mr(u,f,m+d)<p&&(l+=d)}}return Bo.index=a,Bo.endIndex=l,Bo}function Ar(s,t,e,i){const n=s[0],r=s[1];for(let o=0,a=t.length-1;o<a;++o){const l=t[o],h=t[o+1],c=ju(n,r,l,h);if(c.squaredDistance===0){const u=o+c.along;i.push({coordinates:t,ring:e,startIndex:u,endIndex:u});return}}}const zo={along:0,squaredDistance:0};function ju(s,t,e,i){const n=e[0],r=e[1],o=i[0],a=i[1],l=o-n,h=a-r;let c=0,u=n,d=r;return(l!==0||h!==0)&&(c=wt(((s-n)*l+(t-r)*h)/(l*l+h*h),0,1),u+=l*c,d+=h*c),zo.along=c,zo.squaredDistance=lc(Pi(s,t,u,d),10),zo}function Pn(s,t){const e=s.length;let i=Math.floor(t);const n=t-i;i>=e?i-=e:i<0&&(i+=e);let r=i+1;r>=e&&(r-=e);const o=s[i],a=o[0],l=o[1],h=s[r],c=h[0]-a,u=h[1]-l;return[a+c*n,l+u*n]}class M_ extends Zn{constructor(t){const e=t;e.stopDown||(e.stopDown=Xn),super(e),this.on,this.once,this.un,this.shouldHandle_=!1,this.downPx_=null,this.downTimeout_,this.lastDragTime_,this.pointerType_,this.freehand_=!1,this.source_=t.source?t.source:null,this.features_=t.features?t.features:null,this.snapTolerance_=t.snapTolerance?t.snapTolerance:12,this.type_=t.type,this.mode_=F_(this.type_),this.stopClick_=!!t.stopClick,this.minPoints_=t.minPoints?t.minPoints:this.mode_==="Polygon"?3:2,this.maxPoints_=this.mode_==="Circle"?2:t.maxPoints?t.maxPoints:1/0,this.finishCondition_=t.finishCondition?t.finishCondition:Di,this.geometryLayout_=t.geometryLayout?t.geometryLayout:"XY";let i=t.geometryFunction;if(!i){const n=this.mode_;if(n==="Circle")i=(r,o,a)=>{const l=o||new no([NaN,NaN]),h=Le(r[0]),c=bd(h,Le(r[r.length-1]));return l.setCenterAndRadius(h,Math.sqrt(c),this.geometryLayout_),l};else{let r;n==="Point"?r=ue:n==="LineString"?r=ci:n==="Polygon"&&(r=Oe),i=(o,a,l)=>(a?n==="Polygon"?o[0].length?a.setCoordinates([o[0].concat([o[0][0]])],this.geometryLayout_):a.setCoordinates([],this.geometryLayout_):a.setCoordinates(o,this.geometryLayout_):a=new r(o,this.geometryLayout_),a)}}this.geometryFunction_=i,this.dragVertexDelay_=t.dragVertexDelay!==void 0?t.dragVertexDelay:500,this.finishCoordinate_=null,this.sketchFeature_=null,this.sketchPoint_=null,this.sketchCoords_=null,this.sketchLine_=null,this.sketchLineCoords_=null,this.squaredClickTolerance_=t.clickTolerance?t.clickTolerance*t.clickTolerance:36,this.overlay_=new Be({source:new Ge({useSpatialIndex:!1,wrapX:t.wrapX?t.wrapX:!1}),style:t.style?t.style:P_(),updateWhileInteracting:!0}),this.geometryName_=t.geometryName,this.condition_=t.condition?t.condition:yl,this.freehandCondition_,t.freehand?this.freehandCondition_=aa:this.freehandCondition_=t.freehandCondition?t.freehandCondition:xl,this.traceCondition_,this.setTrace(t.trace||!1),this.traceState_={active:!1},this.traceSource_=t.traceSource||t.source||null,this.addChangeListener(ra.ACTIVE,this.updateState_)}setTrace(t){let e;t?t===!0?e=aa:e=t:e=la,this.traceCondition_=e}setMap(t){super.setMap(t),this.updateState_()}getOverlay(){return this.overlay_}handleEvent(t){t.originalEvent.type===j.CONTEXTMENU&&t.originalEvent.preventDefault(),this.freehand_=this.mode_!=="Point"&&this.freehandCondition_(t);let e=t.type===ut.POINTERMOVE,i=!0;return!this.freehand_&&this.lastDragTime_&&t.type===ut.POINTERDRAG&&(Date.now()-this.lastDragTime_>=this.dragVertexDelay_?(this.downPx_=t.pixel,this.shouldHandle_=!this.freehand_,e=!0):this.lastDragTime_=void 0,this.shouldHandle_&&this.downTimeout_!==void 0&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0)),this.freehand_&&t.type===ut.POINTERDRAG&&this.sketchFeature_!==null?(this.addToDrawing_(t.coordinate),i=!1):this.freehand_&&t.type===ut.POINTERDOWN?i=!1:e&&this.getPointerCount()<2?(i=t.type===ut.POINTERMOVE,i&&this.freehand_?(this.handlePointerMove_(t),this.shouldHandle_&&t.originalEvent.preventDefault()):(t.originalEvent.pointerType==="mouse"||t.type===ut.POINTERDRAG&&this.downTimeout_===void 0)&&this.handlePointerMove_(t)):t.type===ut.DBLCLICK&&(i=!1),super.handleEvent(t)&&i}handleDownEvent(t){return this.shouldHandle_=!this.freehand_,this.freehand_?(this.downPx_=t.pixel,this.finishCoordinate_||this.startDrawing_(t.coordinate),!0):this.condition_(t)?(this.lastDragTime_=Date.now(),this.downTimeout_=setTimeout(()=>{this.handlePointerMove_(new ii(ut.POINTERMOVE,t.map,t.originalEvent,!1,t.frameState))},this.dragVertexDelay_),this.downPx_=t.pixel,!0):(this.lastDragTime_=void 0,!1)}deactivateTrace_(){this.traceState_={active:!1}}toggleTraceState_(t){if(!this.traceSource_||!this.traceCondition_(t))return;if(this.traceState_.active){this.deactivateTrace_();return}const e=this.getMap(),i=e.getCoordinateFromPixel([t.pixel[0]-this.snapTolerance_,t.pixel[1]+this.snapTolerance_]),n=e.getCoordinateFromPixel([t.pixel[0]+this.snapTolerance_,t.pixel[1]-this.snapTolerance_]),r=Tr([i,n]),o=this.traceSource_.getFeaturesInExtent(r);if(o.length===0)return;const a=v_(t.coordinate,o);a.length&&(this.traceState_={active:!0,startPx:t.pixel.slice(),targets:a,targetIndex:-1})}addOrRemoveTracedCoordinates_(t,e){const i=t.startIndex<=t.endIndex,n=t.startIndex<=e;i===n?i&&e>t.endIndex||!i&&e<t.endIndex?this.addTracedCoordinates_(t,t.endIndex,e):(i&&e<t.endIndex||!i&&e>t.endIndex)&&this.removeTracedCoordinates_(e,t.endIndex):(this.removeTracedCoordinates_(t.startIndex,t.endIndex),this.addTracedCoordinates_(t,t.startIndex,e))}removeTracedCoordinates_(t,e){if(t===e)return;let i=0;if(t<e){const n=Math.ceil(t);let r=Math.floor(e);r===e&&(r-=1),i=r-n+1}else{const n=Math.floor(t);let r=Math.ceil(e);r===e&&(r+=1),i=n-r+1}i>0&&this.removeLastPoints_(i)}addTracedCoordinates_(t,e,i){if(e===i)return;const n=[];if(e<i){const r=Math.ceil(e);let o=Math.floor(i);o===i&&(o-=1);for(let a=r;a<=o;++a)n.push(Mn(t.coordinates,a))}else{const r=Math.floor(e);let o=Math.ceil(i);o===i&&(o+=1);for(let a=r;a>=o;--a)n.push(Mn(t.coordinates,a))}n.length&&this.appendCoordinates(n)}updateTrace_(t){const e=this.traceState_;if(!e.active||e.targetIndex===-1&&hc(e.startPx,t.pixel)<this.snapTolerance_)return;const i=L_(t.coordinate,e,this.getMap(),this.snapTolerance_);if(e.targetIndex!==i.index){if(e.targetIndex!==-1){const l=e.targets[e.targetIndex];this.removeTracedCoordinates_(l.startIndex,l.endIndex)}const a=e.targets[i.index];this.addTracedCoordinates_(a,a.startIndex,i.endIndex)}else{const a=e.targets[e.targetIndex];this.addOrRemoveTracedCoordinates_(a,i.endIndex)}e.targetIndex=i.index;const n=e.targets[e.targetIndex];n.endIndex=i.endIndex;const r=Pn(n.coordinates,n.endIndex),o=this.getMap().getPixelFromCoordinate(r);t.coordinate=r,t.pixel=[Math.round(o[0]),Math.round(o[1])]}handleUpEvent(t){let e=!0;if(this.getPointerCount()===0){this.downTimeout_&&(clearTimeout(this.downTimeout_),this.downTimeout_=void 0),this.handlePointerMove_(t);const i=this.traceState_.active;if(this.toggleTraceState_(t),this.shouldHandle_){const n=!this.finishCoordinate_;n&&this.startDrawing_(t.coordinate),!n&&this.freehand_?this.finishDrawing():!this.freehand_&&(!n||this.mode_==="Point")&&(this.atFinish_(t.pixel,i)?this.finishCondition_(t)&&this.finishDrawing():this.addToDrawing_(t.coordinate)),e=!1}else this.freehand_&&this.abortDrawing()}return!e&&this.stopClick_&&t.preventDefault(),e}handlePointerMove_(t){if(this.pointerType_=t.originalEvent.pointerType,this.downPx_&&(!this.freehand_&&this.shouldHandle_||this.freehand_&&!this.shouldHandle_)){const e=this.downPx_,i=t.pixel,n=e[0]-i[0],r=e[1]-i[1],o=n*n+r*r;if(this.shouldHandle_=this.freehand_?o>this.squaredClickTolerance_:o<=this.squaredClickTolerance_,!this.shouldHandle_)return}if(!this.finishCoordinate_){this.createOrUpdateSketchPoint_(t.coordinate.slice());return}this.updateTrace_(t),this.modifyDrawing_(t.coordinate)}atFinish_(t,e){let i=!1;if(this.sketchFeature_){let n=!1,r=[this.finishCoordinate_];const o=this.mode_;if(o==="Point")i=!0;else if(o==="Circle")i=this.sketchCoords_.length===2;else if(o==="LineString")n=!e&&this.sketchCoords_.length>this.minPoints_;else if(o==="Polygon"){const a=this.sketchCoords_;n=a[0].length>this.minPoints_,r=[a[0][0],a[0][a[0].length-2]],e?r=[a[0][0]]:r=[a[0][0],a[0][a[0].length-2]]}if(n){const a=this.getMap();for(let l=0,h=r.length;l<h;l++){const c=r[l],u=a.getPixelFromCoordinate(c),d=t[0]-u[0],f=t[1]-u[1],m=this.freehand_?1:this.snapTolerance_;if(i=Math.sqrt(d*d+f*f)<=m,i){this.finishCoordinate_=c;break}}}}return i}createOrUpdateSketchPoint_(t){this.sketchPoint_?this.sketchPoint_.getGeometry().setCoordinates(t):(this.sketchPoint_=new jt(new ue(t)),this.updateSketchFeatures_())}createOrUpdateCustomSketchLine_(t){this.sketchLine_||(this.sketchLine_=new jt);const e=t.getLinearRing(0);let i=this.sketchLine_.getGeometry();i?(i.setFlatCoordinates(e.getLayout(),e.getFlatCoordinates()),i.changed()):(i=new ci(e.getFlatCoordinates(),e.getLayout()),this.sketchLine_.setGeometry(i))}startDrawing_(t){const e=this.getMap().getView().getProjection(),i=Rr(this.geometryLayout_);for(;t.length<i;)t.push(0);this.finishCoordinate_=t,this.mode_==="Point"?this.sketchCoords_=t.slice():this.mode_==="Polygon"?(this.sketchCoords_=[[t.slice(),t.slice()]],this.sketchLineCoords_=this.sketchCoords_[0]):this.sketchCoords_=[t.slice(),t.slice()],this.sketchLineCoords_&&(this.sketchLine_=new jt(new ci(this.sketchLineCoords_)));const n=this.geometryFunction_(this.sketchCoords_,void 0,e);this.sketchFeature_=new jt,this.geometryName_&&this.sketchFeature_.setGeometryName(this.geometryName_),this.sketchFeature_.setGeometry(n),this.updateSketchFeatures_(),this.dispatchEvent(new fr(dr.DRAWSTART,this.sketchFeature_))}modifyDrawing_(t){const e=this.getMap(),i=this.sketchFeature_.getGeometry(),n=e.getView().getProjection(),r=Rr(this.geometryLayout_);let o,a;for(;t.length<r;)t.push(0);this.mode_==="Point"?a=this.sketchCoords_:this.mode_==="Polygon"?(o=this.sketchCoords_[0],a=o[o.length-1],this.atFinish_(e.getPixelFromCoordinate(t))&&(t=this.finishCoordinate_.slice())):(o=this.sketchCoords_,a=o[o.length-1]),a[0]=t[0],a[1]=t[1],this.geometryFunction_(this.sketchCoords_,i,n),this.sketchPoint_&&this.sketchPoint_.getGeometry().setCoordinates(t),i.getType()==="Polygon"&&this.mode_!=="Polygon"?this.createOrUpdateCustomSketchLine_(i):this.sketchLineCoords_&&this.sketchLine_.getGeometry().setCoordinates(this.sketchLineCoords_),this.updateSketchFeatures_()}addToDrawing_(t){const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection();let n,r;const o=this.mode_;return o==="LineString"||o==="Circle"?(this.finishCoordinate_=t.slice(),r=this.sketchCoords_,r.length>=this.maxPoints_&&(this.freehand_?r.pop():n=!0),r.push(t.slice()),this.geometryFunction_(r,e,i)):o==="Polygon"&&(r=this.sketchCoords_[0],r.length>=this.maxPoints_&&(this.freehand_?r.pop():n=!0),r.push(t.slice()),n&&(this.finishCoordinate_=r[0]),this.geometryFunction_(this.sketchCoords_,e,i)),this.createOrUpdateSketchPoint_(t.slice()),this.updateSketchFeatures_(),n?this.finishDrawing():this.sketchFeature_}removeLastPoints_(t){if(!this.sketchFeature_)return;const e=this.sketchFeature_.getGeometry(),i=this.getMap().getView().getProjection(),n=this.mode_;for(let r=0;r<t;++r){let o;if(n==="LineString"||n==="Circle"){if(o=this.sketchCoords_,o.splice(-2,1),o.length>=2){this.finishCoordinate_=o[o.length-2].slice();const a=this.finishCoordinate_.slice();o[o.length-1]=a,this.createOrUpdateSketchPoint_(a)}this.geometryFunction_(o,e,i),e.getType()==="Polygon"&&this.sketchLine_&&this.createOrUpdateCustomSketchLine_(e)}else if(n==="Polygon"){o=this.sketchCoords_[0],o.splice(-2,1);const a=this.sketchLine_.getGeometry();if(o.length>=2){const l=o[o.length-2].slice();o[o.length-1]=l,this.createOrUpdateSketchPoint_(l)}a.setCoordinates(o),this.geometryFunction_(this.sketchCoords_,e,i)}if(o.length===1){this.abortDrawing();break}}this.updateSketchFeatures_()}removeLastPoint(){this.removeLastPoints_(1)}finishDrawing(){const t=this.abortDrawing_();if(!t)return null;let e=this.sketchCoords_;const i=t.getGeometry(),n=this.getMap().getView().getProjection();return this.mode_==="LineString"?(e.pop(),this.geometryFunction_(e,i,n)):this.mode_==="Polygon"&&(e[0].pop(),this.geometryFunction_(e,i,n),e=i.getCoordinates()),this.type_==="MultiPoint"?t.setGeometry(new Us([e])):this.type_==="MultiLineString"?t.setGeometry(new Ys([e])):this.type_==="MultiPolygon"&&t.setGeometry(new Xs([e])),this.dispatchEvent(new fr(dr.DRAWEND,t)),this.features_&&this.features_.push(t),this.source_&&this.source_.addFeature(t),t}abortDrawing_(){this.finishCoordinate_=null;const t=this.sketchFeature_;return this.sketchFeature_=null,this.sketchPoint_=null,this.sketchLine_=null,this.overlay_.getSource().clear(!0),this.deactivateTrace_(),t}abortDrawing(){const t=this.abortDrawing_();t&&this.dispatchEvent(new fr(dr.DRAWABORT,t))}appendCoordinates(t){const e=this.mode_,i=!this.sketchFeature_;i&&this.startDrawing_(t[0]);let n;if(e==="LineString"||e==="Circle")n=this.sketchCoords_;else if(e==="Polygon")n=this.sketchCoords_&&this.sketchCoords_.length?this.sketchCoords_[0]:[];else return;i&&n.shift(),n.pop();for(let o=0;o<t.length;o++)this.addToDrawing_(t[o]);const r=t[t.length-1];this.sketchFeature_=this.addToDrawing_(r),this.modifyDrawing_(r)}extend(t){const i=t.getGeometry();this.sketchFeature_=t,this.sketchCoords_=i.getCoordinates();const n=this.sketchCoords_[this.sketchCoords_.length-1];this.finishCoordinate_=n.slice(),this.sketchCoords_.push(n.slice()),this.sketchPoint_=new jt(new ue(n)),this.updateSketchFeatures_(),this.dispatchEvent(new fr(dr.DRAWSTART,this.sketchFeature_))}updateSketchFeatures_(){const t=[];this.sketchFeature_&&t.push(this.sketchFeature_),this.sketchLine_&&t.push(this.sketchLine_),this.sketchPoint_&&t.push(this.sketchPoint_);const e=this.overlay_.getSource();e.clear(!0),e.addFeatures(t)}updateState_(){const t=this.getMap(),e=this.getActive();(!t||!e)&&this.abortDrawing(),this.overlay_.setMap(e?t:null)}}function P_(){const s=Vc();return function(t,e){return s[t.getGeometry().getType()]}}function F_(s){switch(s){case"Point":case"MultiPoint":return"Point";case"LineString":case"MultiLineString":return"LineString";case"Polygon":case"MultiPolygon":return"Polygon";case"Circle":return"Circle";default:throw new Error("Invalid type: "+s)}}function Zu(s,t,e={}){const i={type:"Feature"};return(e.id===0||e.id)&&(i.id=e.id),e.bbox&&(i.bbox=e.bbox),i.properties=t||{},i.geometry=s,i}function b_(s,t,e={}){for(const n of s){if(n.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");if(n[n.length-1].length!==n[0].length)throw new Error("First and last Position are not equivalent.");for(let r=0;r<n[n.length-1].length;r++)if(n[n.length-1][r]!==n[0][r])throw new Error("First and last Position are not equivalent.")}return Zu({type:"Polygon",coordinates:s},t,e)}function O_(s,t={}){const e={type:"FeatureCollection"};return t.id&&(e.id=t.id),t.bbox&&(e.bbox=t.bbox),e.features=s,e}function Ea(s,t,e={}){return Zu({type:"MultiPolygon",coordinates:s},t,e)}function N_(s,t){var e,i,n,r,o,a,l,h,c,u,d=0,f=s.type==="FeatureCollection",m=s.type==="Feature",p=f?s.features.length:1;for(e=0;e<p;e++){for(a=f?s.features[e].geometry:m?s.geometry:s,h=f?s.features[e].properties:m?s.properties:{},c=f?s.features[e].bbox:m?s.bbox:void 0,u=f?s.features[e].id:m?s.id:void 0,l=a?a.type==="GeometryCollection":!1,o=l?a.geometries.length:1,n=0;n<o;n++){if(r=l?a.geometries[n]:a,r===null){if(t(null,d,h,c,u)===!1)return!1;continue}switch(r.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(r,d,h,c,u)===!1)return!1;break}case"GeometryCollection":{for(i=0;i<r.geometries.length;i++)if(t(r.geometries[i],d,h,c,u)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}d++}}var D_=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Yo=Math.ceil,ye=Math.floor,te="[BigNumber Error] ",Bh=te+"Number primitive has more than 15 significant digits: ",ve=1e14,tt=14,Uo=9007199254740991,Xo=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Ti=1e7,Ot=1e9;function Qu(s){var t,e,i,n=_.prototype={constructor:_,toString:null,valueOf:null},r=new _(1),o=20,a=4,l=-7,h=21,c=-1e7,u=1e7,d=!1,f=1,m=0,p={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},x="0123456789abcdefghijklmnopqrstuvwxyz",T=!0;function _(g,A){var y,S,C,I,R,w,E,M,L=this;if(!(L instanceof _))return new _(g,A);if(A==null){if(g&&g._isBigNumber===!0){L.s=g.s,!g.c||g.e>u?L.c=L.e=null:g.e<c?L.c=[L.e=0]:(L.e=g.e,L.c=g.c.slice());return}if((w=typeof g=="number")&&g*0==0){if(L.s=1/g<0?(g=-g,-1):1,g===~~g){for(I=0,R=g;R>=10;R/=10,I++);I>u?L.c=L.e=null:(L.e=I,L.c=[g]);return}M=String(g)}else{if(!D_.test(M=String(g)))return i(L,M,w);L.s=M.charCodeAt(0)==45?(M=M.slice(1),-1):1}(I=M.indexOf("."))>-1&&(M=M.replace(".","")),(R=M.search(/e/i))>0?(I<0&&(I=R),I+=+M.slice(R+1),M=M.substring(0,R)):I<0&&(I=M.length)}else{if(Et(A,2,x.length,"Base"),A==10&&T)return L=new _(g),k(L,o+L.e+1,a);if(M=String(g),w=typeof g=="number"){if(g*0!=0)return i(L,M,w,A);if(L.s=1/g<0?(M=M.slice(1),-1):1,_.DEBUG&&M.replace(/^0\.0*|\./,"").length>15)throw Error(Bh+g)}else L.s=M.charCodeAt(0)===45?(M=M.slice(1),-1):1;for(y=x.slice(0,A),I=R=0,E=M.length;R<E;R++)if(y.indexOf(S=M.charAt(R))<0){if(S=="."){if(R>I){I=E;continue}}else if(!C&&(M==M.toUpperCase()&&(M=M.toLowerCase())||M==M.toLowerCase()&&(M=M.toUpperCase()))){C=!0,R=-1,I=0;continue}return i(L,String(g),w,A)}w=!1,M=e(M,A,10,L.s),(I=M.indexOf("."))>-1?M=M.replace(".",""):I=M.length}for(R=0;M.charCodeAt(R)===48;R++);for(E=M.length;M.charCodeAt(--E)===48;);if(M=M.slice(R,++E)){if(E-=R,w&&_.DEBUG&&E>15&&(g>Uo||g!==ye(g)))throw Error(Bh+L.s*g);if((I=I-R-1)>u)L.c=L.e=null;else if(I<c)L.c=[L.e=0];else{if(L.e=I,L.c=[],R=(I+1)%tt,I<0&&(R+=tt),R<E){for(R&&L.c.push(+M.slice(0,R)),E-=tt;R<E;)L.c.push(+M.slice(R,R+=tt));R=tt-(M=M.slice(R)).length}else R-=E;for(;R--;M+="0");L.c.push(+M)}}else L.c=[L.e=0]}_.clone=Qu,_.ROUND_UP=0,_.ROUND_DOWN=1,_.ROUND_CEIL=2,_.ROUND_FLOOR=3,_.ROUND_HALF_UP=4,_.ROUND_HALF_DOWN=5,_.ROUND_HALF_EVEN=6,_.ROUND_HALF_CEIL=7,_.ROUND_HALF_FLOOR=8,_.EUCLID=9,_.config=_.set=function(g){var A,y;if(g!=null)if(typeof g=="object"){if(g.hasOwnProperty(A="DECIMAL_PLACES")&&(y=g[A],Et(y,0,Ot,A),o=y),g.hasOwnProperty(A="ROUNDING_MODE")&&(y=g[A],Et(y,0,8,A),a=y),g.hasOwnProperty(A="EXPONENTIAL_AT")&&(y=g[A],y&&y.pop?(Et(y[0],-Ot,0,A),Et(y[1],0,Ot,A),l=y[0],h=y[1]):(Et(y,-Ot,Ot,A),l=-(h=y<0?-y:y))),g.hasOwnProperty(A="RANGE"))if(y=g[A],y&&y.pop)Et(y[0],-Ot,-1,A),Et(y[1],1,Ot,A),c=y[0],u=y[1];else if(Et(y,-Ot,Ot,A),y)c=-(u=y<0?-y:y);else throw Error(te+A+" cannot be zero: "+y);if(g.hasOwnProperty(A="CRYPTO"))if(y=g[A],y===!!y)if(y)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))d=y;else throw d=!y,Error(te+"crypto unavailable");else d=y;else throw Error(te+A+" not true or false: "+y);if(g.hasOwnProperty(A="MODULO_MODE")&&(y=g[A],Et(y,0,9,A),f=y),g.hasOwnProperty(A="POW_PRECISION")&&(y=g[A],Et(y,0,Ot,A),m=y),g.hasOwnProperty(A="FORMAT"))if(y=g[A],typeof y=="object")p=y;else throw Error(te+A+" not an object: "+y);if(g.hasOwnProperty(A="ALPHABET"))if(y=g[A],typeof y=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(y))T=y.slice(0,10)=="0123456789",x=y;else throw Error(te+A+" invalid: "+y)}else throw Error(te+"Object expected: "+g);return{DECIMAL_PLACES:o,ROUNDING_MODE:a,EXPONENTIAL_AT:[l,h],RANGE:[c,u],CRYPTO:d,MODULO_MODE:f,POW_PRECISION:m,FORMAT:p,ALPHABET:x}},_.isBigNumber=function(g){if(!g||g._isBigNumber!==!0)return!1;if(!_.DEBUG)return!0;var A,y,S=g.c,C=g.e,I=g.s;t:if({}.toString.call(S)=="[object Array]"){if((I===1||I===-1)&&C>=-Ot&&C<=Ot&&C===ye(C)){if(S[0]===0){if(C===0&&S.length===1)return!0;break t}if(A=(C+1)%tt,A<1&&(A+=tt),String(S[0]).length==A){for(A=0;A<S.length;A++)if(y=S[A],y<0||y>=ve||y!==ye(y))break t;if(y!==0)return!0}}}else if(S===null&&C===null&&(I===null||I===1||I===-1))return!0;throw Error(te+"Invalid BigNumber: "+g)},_.maximum=_.max=function(){return P(arguments,-1)},_.minimum=_.min=function(){return P(arguments,1)},_.random=function(){var g=9007199254740992,A=Math.random()*g&2097151?function(){return ye(Math.random()*g)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(y){var S,C,I,R,w,E=0,M=[],L=new _(r);if(y==null?y=o:Et(y,0,Ot),R=Yo(y/tt),d)if(crypto.getRandomValues){for(S=crypto.getRandomValues(new Uint32Array(R*=2));E<R;)w=S[E]*131072+(S[E+1]>>>11),w>=9e15?(C=crypto.getRandomValues(new Uint32Array(2)),S[E]=C[0],S[E+1]=C[1]):(M.push(w%1e14),E+=2);E=R/2}else if(crypto.randomBytes){for(S=crypto.randomBytes(R*=7);E<R;)w=(S[E]&31)*281474976710656+S[E+1]*1099511627776+S[E+2]*4294967296+S[E+3]*16777216+(S[E+4]<<16)+(S[E+5]<<8)+S[E+6],w>=9e15?crypto.randomBytes(7).copy(S,E):(M.push(w%1e14),E+=7);E=R/7}else throw d=!1,Error(te+"crypto unavailable");if(!d)for(;E<R;)w=A(),w<9e15&&(M[E++]=w%1e14);for(R=M[--E],y%=tt,R&&y&&(w=Xo[tt-y],M[E]=ye(R/w)*w);M[E]===0;M.pop(),E--);if(E<0)M=[I=0];else{for(I=-1;M[0]===0;M.splice(0,1),I-=tt);for(E=1,w=M[0];w>=10;w/=10,E++);E<tt&&(I-=tt-E)}return L.e=I,L.c=M,L}}(),_.sum=function(){for(var g=1,A=arguments,y=new _(A[0]);g<A.length;)y=y.plus(A[g++]);return y},e=function(){var g="0123456789";function A(y,S,C,I){for(var R,w=[0],E,M=0,L=y.length;M<L;){for(E=w.length;E--;w[E]*=S);for(w[0]+=I.indexOf(y.charAt(M++)),R=0;R<w.length;R++)w[R]>C-1&&(w[R+1]==null&&(w[R+1]=0),w[R+1]+=w[R]/C|0,w[R]%=C)}return w.reverse()}return function(y,S,C,I,R){var w,E,M,L,b,B,z,X,it=y.indexOf("."),G=o,Z=a;for(it>=0&&(L=m,m=0,y=y.replace(".",""),X=new _(S),B=X.pow(y.length-it),m=L,X.c=A(ti(pe(B.c),B.e,"0"),10,C,g),X.e=X.c.length),z=A(y,S,C,R?(w=x,g):(w=g,x)),M=L=z.length;z[--L]==0;z.pop());if(!z[0])return w.charAt(0);if(it<0?--M:(B.c=z,B.e=M,B.s=I,B=t(B,X,G,Z,C),z=B.c,b=B.r,M=B.e),E=M+G+1,it=z[E],L=C/2,b=b||E<0||z[E+1]!=null,b=Z<4?(it!=null||b)&&(Z==0||Z==(B.s<0?3:2)):it>L||it==L&&(Z==4||b||Z==6&&z[E-1]&1||Z==(B.s<0?8:7)),E<1||!z[0])y=b?ti(w.charAt(1),-G,w.charAt(0)):w.charAt(0);else{if(z.length=E,b)for(--C;++z[--E]>C;)z[E]=0,E||(++M,z=[1].concat(z));for(L=z.length;!z[--L];);for(it=0,y="";it<=L;y+=w.charAt(z[it++]));y=ti(y,M,w.charAt(0))}return y}}(),t=function(){function g(S,C,I){var R,w,E,M,L=0,b=S.length,B=C%Ti,z=C/Ti|0;for(S=S.slice();b--;)E=S[b]%Ti,M=S[b]/Ti|0,R=z*E+M*B,w=B*E+R%Ti*Ti+L,L=(w/I|0)+(R/Ti|0)+z*M,S[b]=w%I;return L&&(S=[L].concat(S)),S}function A(S,C,I,R){var w,E;if(I!=R)E=I>R?1:-1;else for(w=E=0;w<I;w++)if(S[w]!=C[w]){E=S[w]>C[w]?1:-1;break}return E}function y(S,C,I,R){for(var w=0;I--;)S[I]-=w,w=S[I]<C[I]?1:0,S[I]=w*R+S[I]-C[I];for(;!S[0]&&S.length>1;S.splice(0,1));}return function(S,C,I,R,w){var E,M,L,b,B,z,X,it,G,Z,H,rt,Qt,ae,Xt,Lt,Re,kt=S.s==C.s?1:-1,Mt=S.c,mt=C.c;if(!Mt||!Mt[0]||!mt||!mt[0])return new _(!S.s||!C.s||(Mt?mt&&Mt[0]==mt[0]:!mt)?NaN:Mt&&Mt[0]==0||!mt?kt*0:kt/0);for(it=new _(kt),G=it.c=[],M=S.e-C.e,kt=I+M+1,w||(w=ve,M=xe(S.e/tt)-xe(C.e/tt),kt=kt/tt|0),L=0;mt[L]==(Mt[L]||0);L++);if(mt[L]>(Mt[L]||0)&&M--,kt<0)G.push(1),b=!0;else{for(ae=Mt.length,Lt=mt.length,L=0,kt+=2,B=ye(w/(mt[0]+1)),B>1&&(mt=g(mt,B,w),Mt=g(Mt,B,w),Lt=mt.length,ae=Mt.length),Qt=Lt,Z=Mt.slice(0,Lt),H=Z.length;H<Lt;Z[H++]=0);Re=mt.slice(),Re=[0].concat(Re),Xt=mt[0],mt[1]>=w/2&&Xt++;do{if(B=0,E=A(mt,Z,Lt,H),E<0){if(rt=Z[0],Lt!=H&&(rt=rt*w+(Z[1]||0)),B=ye(rt/Xt),B>1)for(B>=w&&(B=w-1),z=g(mt,B,w),X=z.length,H=Z.length;A(z,Z,X,H)==1;)B--,y(z,Lt<X?Re:mt,X,w),X=z.length,E=1;else B==0&&(E=B=1),z=mt.slice(),X=z.length;if(X<H&&(z=[0].concat(z)),y(Z,z,H,w),H=Z.length,E==-1)for(;A(mt,Z,Lt,H)<1;)B++,y(Z,Lt<H?Re:mt,H,w),H=Z.length}else E===0&&(B++,Z=[0]);G[L++]=B,Z[0]?Z[H++]=Mt[Qt]||0:(Z=[Mt[Qt]],H=1)}while((Qt++<ae||Z[0]!=null)&&kt--);b=Z[0]!=null,G[0]||G.splice(0,1)}if(w==ve){for(L=1,kt=G[0];kt>=10;kt/=10,L++);k(it,I+(it.e=L+M*tt-1)+1,R,b)}else it.e=M,it.r=+b;return it}}();function v(g,A,y,S){var C,I,R,w,E;if(y==null?y=a:Et(y,0,8),!g.c)return g.toString();if(C=g.c[0],R=g.e,A==null)E=pe(g.c),E=S==1||S==2&&(R<=l||R>=h)?pr(E,R):ti(E,R,"0");else if(g=k(new _(g),A,y),I=g.e,E=pe(g.c),w=E.length,S==1||S==2&&(A<=I||I<=l)){for(;w<A;E+="0",w++);E=pr(E,I)}else if(A-=R,E=ti(E,I,"0"),I+1>w){if(--A>0)for(E+=".";A--;E+="0");}else if(A+=I-w,A>0)for(I+1==w&&(E+=".");A--;E+="0");return g.s<0&&C?"-"+E:E}function P(g,A){for(var y,S,C=1,I=new _(g[0]);C<g.length;C++)S=new _(g[C]),(!S.s||(y=Zi(I,S))===A||y===0&&I.s===A)&&(I=S);return I}function F(g,A,y){for(var S=1,C=A.length;!A[--C];A.pop());for(C=A[0];C>=10;C/=10,S++);return(y=S+y*tt-1)>u?g.c=g.e=null:y<c?g.c=[g.e=0]:(g.e=y,g.c=A),g}i=function(){var g=/^(-?)0([xbo])(?=\w[\w.]*$)/i,A=/^([^.]+)\.$/,y=/^\.([^.]+)$/,S=/^-?(Infinity|NaN)$/,C=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(I,R,w,E){var M,L=w?R:R.replace(C,"");if(S.test(L))I.s=isNaN(L)?null:L<0?-1:1;else{if(!w&&(L=L.replace(g,function(b,B,z){return M=(z=z.toLowerCase())=="x"?16:z=="b"?2:8,!E||E==M?B:b}),E&&(M=E,L=L.replace(A,"$1").replace(y,"0.$1")),R!=L))return new _(L,M);if(_.DEBUG)throw Error(te+"Not a"+(E?" base "+E:"")+" number: "+R);I.s=null}I.c=I.e=null}}();function k(g,A,y,S){var C,I,R,w,E,M,L,b=g.c,B=Xo;if(b){t:{for(C=1,w=b[0];w>=10;w/=10,C++);if(I=A-C,I<0)I+=tt,R=A,E=b[M=0],L=ye(E/B[C-R-1]%10);else if(M=Yo((I+1)/tt),M>=b.length)if(S){for(;b.length<=M;b.push(0));E=L=0,C=1,I%=tt,R=I-tt+1}else break t;else{for(E=w=b[M],C=1;w>=10;w/=10,C++);I%=tt,R=I-tt+C,L=R<0?0:ye(E/B[C-R-1]%10)}if(S=S||A<0||b[M+1]!=null||(R<0?E:E%B[C-R-1]),S=y<4?(L||S)&&(y==0||y==(g.s<0?3:2)):L>5||L==5&&(y==4||S||y==6&&(I>0?R>0?E/B[C-R]:0:b[M-1])%10&1||y==(g.s<0?8:7)),A<1||!b[0])return b.length=0,S?(A-=g.e+1,b[0]=B[(tt-A%tt)%tt],g.e=-A||0):b[0]=g.e=0,g;if(I==0?(b.length=M,w=1,M--):(b.length=M+1,w=B[tt-I],b[M]=R>0?ye(E/B[C-R]%B[R])*w:0),S)for(;;)if(M==0){for(I=1,R=b[0];R>=10;R/=10,I++);for(R=b[0]+=w,w=1;R>=10;R/=10,w++);I!=w&&(g.e++,b[0]==ve&&(b[0]=1));break}else{if(b[M]+=w,b[M]!=ve)break;b[M--]=0,w=1}for(I=b.length;b[--I]===0;b.pop());}g.e>u?g.c=g.e=null:g.e<c&&(g.c=[g.e=0])}return g}function O(g){var A,y=g.e;return y===null?g.toString():(A=pe(g.c),A=y<=l||y>=h?pr(A,y):ti(A,y,"0"),g.s<0?"-"+A:A)}return n.absoluteValue=n.abs=function(){var g=new _(this);return g.s<0&&(g.s=1),g},n.comparedTo=function(g,A){return Zi(this,new _(g,A))},n.decimalPlaces=n.dp=function(g,A){var y,S,C,I=this;if(g!=null)return Et(g,0,Ot),A==null?A=a:Et(A,0,8),k(new _(I),g+I.e+1,A);if(!(y=I.c))return null;if(S=((C=y.length-1)-xe(this.e/tt))*tt,C=y[C])for(;C%10==0;C/=10,S--);return S<0&&(S=0),S},n.dividedBy=n.div=function(g,A){return t(this,new _(g,A),o,a)},n.dividedToIntegerBy=n.idiv=function(g,A){return t(this,new _(g,A),0,1)},n.exponentiatedBy=n.pow=function(g,A){var y,S,C,I,R,w,E,M,L,b=this;if(g=new _(g),g.c&&!g.isInteger())throw Error(te+"Exponent not an integer: "+O(g));if(A!=null&&(A=new _(A)),w=g.e>14,!b.c||!b.c[0]||b.c[0]==1&&!b.e&&b.c.length==1||!g.c||!g.c[0])return L=new _(Math.pow(+O(b),w?g.s*(2-_r(g)):+O(g))),A?L.mod(A):L;if(E=g.s<0,A){if(A.c?!A.c[0]:!A.s)return new _(NaN);S=!E&&b.isInteger()&&A.isInteger(),S&&(b=b.mod(A))}else{if(g.e>9&&(b.e>0||b.e<-1||(b.e==0?b.c[0]>1||w&&b.c[1]>=24e7:b.c[0]<8e13||w&&b.c[0]<=9999975e7)))return I=b.s<0&&_r(g)?-0:0,b.e>-1&&(I=1/I),new _(E?1/I:I);m&&(I=Yo(m/tt+2))}for(w?(y=new _(.5),E&&(g.s=1),M=_r(g)):(C=Math.abs(+O(g)),M=C%2),L=new _(r);;){if(M){if(L=L.times(b),!L.c)break;I?L.c.length>I&&(L.c.length=I):S&&(L=L.mod(A))}if(C){if(C=ye(C/2),C===0)break;M=C%2}else if(g=g.times(y),k(g,g.e+1,1),g.e>14)M=_r(g);else{if(C=+O(g),C===0)break;M=C%2}b=b.times(b),I?b.c&&b.c.length>I&&(b.c.length=I):S&&(b=b.mod(A))}return S?L:(E&&(L=r.div(L)),A?L.mod(A):I?k(L,m,a,R):L)},n.integerValue=function(g){var A=new _(this);return g==null?g=a:Et(g,0,8),k(A,A.e+1,g)},n.isEqualTo=n.eq=function(g,A){return Zi(this,new _(g,A))===0},n.isFinite=function(){return!!this.c},n.isGreaterThan=n.gt=function(g,A){return Zi(this,new _(g,A))>0},n.isGreaterThanOrEqualTo=n.gte=function(g,A){return(A=Zi(this,new _(g,A)))===1||A===0},n.isInteger=function(){return!!this.c&&xe(this.e/tt)>this.c.length-2},n.isLessThan=n.lt=function(g,A){return Zi(this,new _(g,A))<0},n.isLessThanOrEqualTo=n.lte=function(g,A){return(A=Zi(this,new _(g,A)))===-1||A===0},n.isNaN=function(){return!this.s},n.isNegative=function(){return this.s<0},n.isPositive=function(){return this.s>0},n.isZero=function(){return!!this.c&&this.c[0]==0},n.minus=function(g,A){var y,S,C,I,R=this,w=R.s;if(g=new _(g,A),A=g.s,!w||!A)return new _(NaN);if(w!=A)return g.s=-A,R.plus(g);var E=R.e/tt,M=g.e/tt,L=R.c,b=g.c;if(!E||!M){if(!L||!b)return L?(g.s=-A,g):new _(b?R:NaN);if(!L[0]||!b[0])return b[0]?(g.s=-A,g):new _(L[0]?R:a==3?-0:0)}if(E=xe(E),M=xe(M),L=L.slice(),w=E-M){for((I=w<0)?(w=-w,C=L):(M=E,C=b),C.reverse(),A=w;A--;C.push(0));C.reverse()}else for(S=(I=(w=L.length)<(A=b.length))?w:A,w=A=0;A<S;A++)if(L[A]!=b[A]){I=L[A]<b[A];break}if(I&&(C=L,L=b,b=C,g.s=-g.s),A=(S=b.length)-(y=L.length),A>0)for(;A--;L[y++]=0);for(A=ve-1;S>w;){if(L[--S]<b[S]){for(y=S;y&&!L[--y];L[y]=A);--L[y],L[S]+=ve}L[S]-=b[S]}for(;L[0]==0;L.splice(0,1),--M);return L[0]?F(g,L,M):(g.s=a==3?-1:1,g.c=[g.e=0],g)},n.modulo=n.mod=function(g,A){var y,S,C=this;return g=new _(g,A),!C.c||!g.s||g.c&&!g.c[0]?new _(NaN):!g.c||C.c&&!C.c[0]?new _(C):(f==9?(S=g.s,g.s=1,y=t(C,g,0,3),g.s=S,y.s*=S):y=t(C,g,0,f),g=C.minus(y.times(g)),!g.c[0]&&f==1&&(g.s=C.s),g)},n.multipliedBy=n.times=function(g,A){var y,S,C,I,R,w,E,M,L,b,B,z,X,it,G,Z=this,H=Z.c,rt=(g=new _(g,A)).c;if(!H||!rt||!H[0]||!rt[0])return!Z.s||!g.s||H&&!H[0]&&!rt||rt&&!rt[0]&&!H?g.c=g.e=g.s=null:(g.s*=Z.s,!H||!rt?g.c=g.e=null:(g.c=[0],g.e=0)),g;for(S=xe(Z.e/tt)+xe(g.e/tt),g.s*=Z.s,E=H.length,b=rt.length,E<b&&(X=H,H=rt,rt=X,C=E,E=b,b=C),C=E+b,X=[];C--;X.push(0));for(it=ve,G=Ti,C=b;--C>=0;){for(y=0,B=rt[C]%G,z=rt[C]/G|0,R=E,I=C+R;I>C;)M=H[--R]%G,L=H[R]/G|0,w=z*M+L*B,M=B*M+w%G*G+X[I]+y,y=(M/it|0)+(w/G|0)+z*L,X[I--]=M%it;X[I]=y}return y?++S:X.splice(0,1),F(g,X,S)},n.negated=function(){var g=new _(this);return g.s=-g.s||null,g},n.plus=function(g,A){var y,S=this,C=S.s;if(g=new _(g,A),A=g.s,!C||!A)return new _(NaN);if(C!=A)return g.s=-A,S.minus(g);var I=S.e/tt,R=g.e/tt,w=S.c,E=g.c;if(!I||!R){if(!w||!E)return new _(C/0);if(!w[0]||!E[0])return E[0]?g:new _(w[0]?S:C*0)}if(I=xe(I),R=xe(R),w=w.slice(),C=I-R){for(C>0?(R=I,y=E):(C=-C,y=w),y.reverse();C--;y.push(0));y.reverse()}for(C=w.length,A=E.length,C-A<0&&(y=E,E=w,w=y,A=C),C=0;A;)C=(w[--A]=w[A]+E[A]+C)/ve|0,w[A]=ve===w[A]?0:w[A]%ve;return C&&(w=[C].concat(w),++R),F(g,w,R)},n.precision=n.sd=function(g,A){var y,S,C,I=this;if(g!=null&&g!==!!g)return Et(g,1,Ot),A==null?A=a:Et(A,0,8),k(new _(I),g,A);if(!(y=I.c))return null;if(C=y.length-1,S=C*tt+1,C=y[C]){for(;C%10==0;C/=10,S--);for(C=y[0];C>=10;C/=10,S++);}return g&&I.e+1>S&&(S=I.e+1),S},n.shiftedBy=function(g){return Et(g,-Uo,Uo),this.times("1e"+g)},n.squareRoot=n.sqrt=function(){var g,A,y,S,C,I=this,R=I.c,w=I.s,E=I.e,M=o+4,L=new _("0.5");if(w!==1||!R||!R[0])return new _(!w||w<0&&(!R||R[0])?NaN:R?I:1/0);if(w=Math.sqrt(+O(I)),w==0||w==1/0?(A=pe(R),(A.length+E)%2==0&&(A+="0"),w=Math.sqrt(+A),E=xe((E+1)/2)-(E<0||E%2),w==1/0?A="5e"+E:(A=w.toExponential(),A=A.slice(0,A.indexOf("e")+1)+E),y=new _(A)):y=new _(w+""),y.c[0]){for(E=y.e,w=E+M,w<3&&(w=0);;)if(C=y,y=L.times(C.plus(t(I,C,M,1))),pe(C.c).slice(0,w)===(A=pe(y.c)).slice(0,w))if(y.e<E&&--w,A=A.slice(w-3,w+1),A=="9999"||!S&&A=="4999"){if(!S&&(k(C,C.e+o+2,0),C.times(C).eq(I))){y=C;break}M+=4,w+=4,S=1}else{(!+A||!+A.slice(1)&&A.charAt(0)=="5")&&(k(y,y.e+o+2,1),g=!y.times(y).eq(I));break}}return k(y,y.e+o+1,a,g)},n.toExponential=function(g,A){return g!=null&&(Et(g,0,Ot),g++),v(this,g,A,1)},n.toFixed=function(g,A){return g!=null&&(Et(g,0,Ot),g=g+this.e+1),v(this,g,A)},n.toFormat=function(g,A,y){var S,C=this;if(y==null)g!=null&&A&&typeof A=="object"?(y=A,A=null):g&&typeof g=="object"?(y=g,g=A=null):y=p;else if(typeof y!="object")throw Error(te+"Argument not an object: "+y);if(S=C.toFixed(g,A),C.c){var I,R=S.split("."),w=+y.groupSize,E=+y.secondaryGroupSize,M=y.groupSeparator||"",L=R[0],b=R[1],B=C.s<0,z=B?L.slice(1):L,X=z.length;if(E&&(I=w,w=E,E=I,X-=I),w>0&&X>0){for(I=X%w||w,L=z.substr(0,I);I<X;I+=w)L+=M+z.substr(I,w);E>0&&(L+=M+z.slice(I)),B&&(L="-"+L)}S=b?L+(y.decimalSeparator||"")+((E=+y.fractionGroupSize)?b.replace(new RegExp("\\d{"+E+"}\\B","g"),"$&"+(y.fractionGroupSeparator||"")):b):L}return(y.prefix||"")+S+(y.suffix||"")},n.toFraction=function(g){var A,y,S,C,I,R,w,E,M,L,b,B,z=this,X=z.c;if(g!=null&&(w=new _(g),!w.isInteger()&&(w.c||w.s!==1)||w.lt(r)))throw Error(te+"Argument "+(w.isInteger()?"out of range: ":"not an integer: ")+O(w));if(!X)return new _(z);for(A=new _(r),M=y=new _(r),S=E=new _(r),B=pe(X),I=A.e=B.length-z.e-1,A.c[0]=Xo[(R=I%tt)<0?tt+R:R],g=!g||w.comparedTo(A)>0?I>0?A:M:w,R=u,u=1/0,w=new _(B),E.c[0]=0;L=t(w,A,0,1),C=y.plus(L.times(S)),C.comparedTo(g)!=1;)y=S,S=C,M=E.plus(L.times(C=M)),E=C,A=w.minus(L.times(C=A)),w=C;return C=t(g.minus(y),S,0,1),E=E.plus(C.times(M)),y=y.plus(C.times(S)),E.s=M.s=z.s,I=I*2,b=t(M,S,I,a).minus(z).abs().comparedTo(t(E,y,I,a).minus(z).abs())<1?[M,S]:[E,y],u=R,b},n.toNumber=function(){return+O(this)},n.toPrecision=function(g,A){return g!=null&&Et(g,1,Ot),v(this,g,A,2)},n.toString=function(g){var A,y=this,S=y.s,C=y.e;return C===null?S?(A="Infinity",S<0&&(A="-"+A)):A="NaN":(g==null?A=C<=l||C>=h?pr(pe(y.c),C):ti(pe(y.c),C,"0"):g===10&&T?(y=k(new _(y),o+C+1,a),A=ti(pe(y.c),y.e,"0")):(Et(g,2,x.length,"Base"),A=e(ti(pe(y.c),C,"0"),10,g,S,!0)),S<0&&y.c[0]&&(A="-"+A)),A},n.valueOf=n.toJSON=function(){return O(this)},n._isBigNumber=!0,n[Symbol.toStringTag]="BigNumber",n[Symbol.for("nodejs.util.inspect.custom")]=n.valueOf,s!=null&&_.set(s),_}function xe(s){var t=s|0;return s>0||s===t?t:t-1}function pe(s){for(var t,e,i=1,n=s.length,r=s[0]+"";i<n;){for(t=s[i++]+"",e=tt-t.length;e--;t="0"+t);r+=t}for(n=r.length;r.charCodeAt(--n)===48;);return r.slice(0,n+1||1)}function Zi(s,t){var e,i,n=s.c,r=t.c,o=s.s,a=t.s,l=s.e,h=t.e;if(!o||!a)return null;if(e=n&&!n[0],i=r&&!r[0],e||i)return e?i?0:-a:o;if(o!=a)return o;if(e=o<0,i=l==h,!n||!r)return i?0:!n^e?1:-1;if(!i)return l>h^e?1:-1;for(a=(l=n.length)<(h=r.length)?l:h,o=0;o<a;o++)if(n[o]!=r[o])return n[o]>r[o]^e?1:-1;return l==h?0:l>h^e?1:-1}function Et(s,t,e,i){if(s<t||s>e||s!==ye(s))throw Error(te+(i||"Argument")+(typeof s=="number"?s<t||s>e?" out of range: ":" not an integer: ":" not a primitive number: ")+String(s))}function _r(s){var t=s.c.length-1;return xe(s.e/tt)==t&&s.c[t]%2!=0}function pr(s,t){return(s.length>1?s.charAt(0)+"."+s.slice(1):s)+(t<0?"e":"e+")+t}function ti(s,t,e){var i,n;if(t<0){for(n=e+".";++t;n+=e);s=n+s}else if(i=s.length,++t>i){for(n=e,t-=i;--t;n+=e);s+=n}else t<i&&(s=s.slice(0,t)+"."+s.slice(t));return s}var We=Qu(),k_=class{constructor(s){K(this,"key");K(this,"left",null);K(this,"right",null);this.key=s}},ss=class extends k_{constructor(s){super(s)}},G_=class{constructor(){K(this,"size",0);K(this,"modificationCount",0);K(this,"splayCount",0)}splay(s){const t=this.root;if(t==null)return this.compare(s,s),-1;let e=null,i=null,n=null,r=null,o=t;const a=this.compare;let l;for(;;)if(l=a(o.key,s),l>0){let h=o.left;if(h==null||(l=a(h.key,s),l>0&&(o.left=h.right,h.right=o,o=h,h=o.left,h==null)))break;e==null?i=o:e.left=o,e=o,o=h}else if(l<0){let h=o.right;if(h==null||(l=a(h.key,s),l<0&&(o.right=h.left,h.left=o,o=h,h=o.right,h==null)))break;n==null?r=o:n.right=o,n=o,o=h}else break;return n!=null&&(n.right=o.left,o.left=r),e!=null&&(e.left=o.right,o.right=i),this.root!==o&&(this.root=o,this.splayCount++),l}splayMin(s){let t=s,e=t.left;for(;e!=null;){const i=e;t.left=i.right,i.right=t,t=i,e=t.left}return t}splayMax(s){let t=s,e=t.right;for(;e!=null;){const i=e;t.right=i.left,i.left=t,t=i,e=t.right}return t}_delete(s){if(this.root==null||this.splay(s)!=0)return null;let e=this.root;const i=e,n=e.left;if(this.size--,n==null)this.root=e.right;else{const r=e.right;e=this.splayMax(n),e.right=r,this.root=e}return this.modificationCount++,i}addNewRoot(s,t){this.size++,this.modificationCount++;const e=this.root;if(e==null){this.root=s;return}t<0?(s.left=e,s.right=e.right,e.right=null):(s.right=e,s.left=e.left,e.left=null),this.root=s}_first(){const s=this.root;return s==null?null:(this.root=this.splayMin(s),this.root)}_last(){const s=this.root;return s==null?null:(this.root=this.splayMax(s),this.root)}clear(){this.root=null,this.size=0,this.modificationCount++}has(s){return this.validKey(s)&&this.splay(s)==0}defaultCompare(){return(s,t)=>s<t?-1:s>t?1:0}wrap(){return{getRoot:()=>this.root,setRoot:s=>{this.root=s},getSize:()=>this.size,getModificationCount:()=>this.modificationCount,getSplayCount:()=>this.splayCount,setSplayCount:s=>{this.splayCount=s},splay:s=>this.splay(s),has:s=>this.has(s)}}},qh,Hh,Yr=class gs extends G_{constructor(e,i){super();K(this,"root",null);K(this,"compare");K(this,"validKey");K(this,qh,"[object Set]");this.compare=e??this.defaultCompare(),this.validKey=i??(n=>n!=null&&n!=null)}delete(e){return this.validKey(e)?this._delete(e)!=null:!1}deleteAll(e){for(const i of e)this.delete(i)}forEach(e){const i=this[Symbol.iterator]();let n;for(;n=i.next(),!n.done;)e(n.value,n.value,this)}add(e){const i=this.splay(e);return i!=0&&this.addNewRoot(new ss(e),i),this}addAndReturn(e){const i=this.splay(e);return i!=0&&this.addNewRoot(new ss(e),i),this.root.key}addAll(e){for(const i of e)this.add(i)}isEmpty(){return this.root==null}isNotEmpty(){return this.root!=null}single(){if(this.size==0)throw"Bad state: No element";if(this.size>1)throw"Bad state: Too many element";return this.root.key}first(){if(this.size==0)throw"Bad state: No element";return this._first().key}last(){if(this.size==0)throw"Bad state: No element";return this._last().key}lastBefore(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)<0)return this.root.key;let n=this.root.left;if(n==null)return null;let r=n.right;for(;r!=null;)n=r,r=n.right;return n.key}firstAfter(e){if(e==null)throw"Invalid arguments(s)";if(this.root==null)return null;if(this.splay(e)>0)return this.root.key;let n=this.root.right;if(n==null)return null;let r=n.left;for(;r!=null;)n=r,r=n.left;return n.key}retainAll(e){const i=new gs(this.compare,this.validKey),n=this.modificationCount;for(const r of e){if(n!=this.modificationCount)throw"Concurrent modification during iteration.";this.validKey(r)&&this.splay(r)==0&&i.add(this.root.key)}i.size!=this.size&&(this.root=i.root,this.size=i.size,this.modificationCount++)}lookup(e){return!this.validKey(e)||this.splay(e)!=0?null:this.root.key}intersection(e){const i=new gs(this.compare,this.validKey);for(const n of this)e.has(n)&&i.add(n);return i}difference(e){const i=new gs(this.compare,this.validKey);for(const n of this)e.has(n)||i.add(n);return i}union(e){const i=this.clone();return i.addAll(e),i}clone(){const e=new gs(this.compare,this.validKey);return e.size=this.size,e.root=this.copyNode(this.root),e}copyNode(e){if(e==null)return null;function i(r,o){let a,l;do{if(a=r.left,l=r.right,a!=null){const h=new ss(a.key);o.left=h,i(a,h)}if(l!=null){const h=new ss(l.key);o.right=h,r=l,o=h}}while(l!=null)}const n=new ss(e.key);return i(e,n),n}toSet(){return this.clone()}entries(){return new z_(this.wrap())}keys(){return this[Symbol.iterator]()}values(){return this[Symbol.iterator]()}[(Hh=Symbol.iterator,qh=Symbol.toStringTag,Hh)](){return new B_(this.wrap())}},qu=class{constructor(s){K(this,"tree");K(this,"path",new Array);K(this,"modificationCount",null);K(this,"splayCount");this.tree=s,this.splayCount=s.getSplayCount()}[Symbol.iterator](){return this}next(){return this.moveNext()?{done:!1,value:this.current()}:{done:!0,value:null}}current(){if(!this.path.length)return null;const s=this.path[this.path.length-1];return this.getValue(s)}rebuildPath(s){this.path.splice(0,this.path.length),this.tree.splay(s),this.path.push(this.tree.getRoot()),this.splayCount=this.tree.getSplayCount()}findLeftMostDescendent(s){for(;s!=null;)this.path.push(s),s=s.left}moveNext(){if(this.modificationCount!=this.tree.getModificationCount()){if(this.modificationCount==null){this.modificationCount=this.tree.getModificationCount();let e=this.tree.getRoot();for(;e!=null;)this.path.push(e),e=e.left;return this.path.length>0}throw"Concurrent modification during iteration."}if(!this.path.length)return!1;this.splayCount!=this.tree.getSplayCount()&&this.rebuildPath(this.path[this.path.length-1].key);let s=this.path[this.path.length-1],t=s.right;if(t!=null){for(;t!=null;)this.path.push(t),t=t.left;return!0}for(this.path.pop();this.path.length&&this.path[this.path.length-1].right===s;)s=this.path.pop();return this.path.length>0}},B_=class extends qu{getValue(s){return s.key}},z_=class extends qu{getValue(s){return[s.key,s.key]}},Hu=s=>()=>s,Ca=s=>{const t=s?(e,i)=>i.minus(e).abs().isLessThanOrEqualTo(s):Hu(!1);return(e,i)=>t(e,i)?0:e.comparedTo(i)};function Y_(s){const t=s?(e,i,n,r,o)=>e.exponentiatedBy(2).isLessThanOrEqualTo(r.minus(i).exponentiatedBy(2).plus(o.minus(n).exponentiatedBy(2)).times(s)):Hu(!1);return(e,i,n)=>{const r=e.x,o=e.y,a=n.x,l=n.y,h=o.minus(l).times(i.x.minus(a)).minus(r.minus(a).times(i.y.minus(l)));return t(h,r,o,a,l)?0:h.comparedTo(0)}}var U_=s=>s,X_=s=>{if(s){const t=new Yr(Ca(s)),e=new Yr(Ca(s)),i=(r,o)=>o.addAndReturn(r),n=r=>({x:i(r.x,t),y:i(r.y,e)});return n({x:new We(0),y:new We(0)}),n}return U_},wa=s=>({set:t=>{mi=wa(t)},reset:()=>wa(s),compare:Ca(s),snap:X_(s),orient:Y_(s)}),mi=wa(),rs=(s,t)=>s.ll.x.isLessThanOrEqualTo(t.x)&&t.x.isLessThanOrEqualTo(s.ur.x)&&s.ll.y.isLessThanOrEqualTo(t.y)&&t.y.isLessThanOrEqualTo(s.ur.y),Ta=(s,t)=>{if(t.ur.x.isLessThan(s.ll.x)||s.ur.x.isLessThan(t.ll.x)||t.ur.y.isLessThan(s.ll.y)||s.ur.y.isLessThan(t.ll.y))return null;const e=s.ll.x.isLessThan(t.ll.x)?t.ll.x:s.ll.x,i=s.ur.x.isLessThan(t.ur.x)?s.ur.x:t.ur.x,n=s.ll.y.isLessThan(t.ll.y)?t.ll.y:s.ll.y,r=s.ur.y.isLessThan(t.ur.y)?s.ur.y:t.ur.y;return{ll:{x:e,y:n},ur:{x:i,y:r}}},xr=(s,t)=>s.x.times(t.y).minus(s.y.times(t.x)),Ju=(s,t)=>s.x.times(t.x).plus(s.y.times(t.y)),Ur=s=>Ju(s,s).sqrt(),V_=(s,t,e)=>{const i={x:t.x.minus(s.x),y:t.y.minus(s.y)},n={x:e.x.minus(s.x),y:e.y.minus(s.y)};return xr(n,i).div(Ur(n)).div(Ur(i))},K_=(s,t,e)=>{const i={x:t.x.minus(s.x),y:t.y.minus(s.y)},n={x:e.x.minus(s.x),y:e.y.minus(s.y)};return Ju(n,i).div(Ur(n)).div(Ur(i))},zh=(s,t,e)=>t.y.isZero()?null:{x:s.x.plus(t.x.div(t.y).times(e.minus(s.y))),y:e},Yh=(s,t,e)=>t.x.isZero()?null:{x:e,y:s.y.plus(t.y.div(t.x).times(e.minus(s.x)))},W_=(s,t,e,i)=>{if(t.x.isZero())return Yh(e,i,s.x);if(i.x.isZero())return Yh(s,t,e.x);if(t.y.isZero())return zh(e,i,s.y);if(i.y.isZero())return zh(s,t,e.y);const n=xr(t,i);if(n.isZero())return null;const r={x:e.x.minus(s.x),y:e.y.minus(s.y)},o=xr(r,t).div(n),a=xr(r,i).div(n),l=s.x.plus(a.times(t.x)),h=e.x.plus(o.times(i.x)),c=s.y.plus(a.times(t.y)),u=e.y.plus(o.times(i.y)),d=l.plus(h).div(2),f=c.plus(u).div(2);return{x:d,y:f}},Ue=class $u{constructor(t,e){K(this,"point");K(this,"isLeft");K(this,"segment");K(this,"otherSE");K(this,"consumedBy");t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}static compare(t,e){const i=$u.comparePoints(t.point,e.point);return i!==0?i:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:Xr.compare(t.segment,e.segment))}static comparePoints(t,e){return t.x.isLessThan(e.x)?-1:t.x.isGreaterThan(e.x)?1:t.y.isLessThan(e.y)?-1:t.y.isGreaterThan(e.y)?1:0}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const e=t.point.events;for(let i=0,n=e.length;i<n;i++){const r=e[i];this.point.events.push(r),r.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let e=0;e<t;e++){const i=this.point.events[e];if(i.segment.consumedBy===void 0)for(let n=e+1;n<t;n++){const r=this.point.events[n];r.consumedBy===void 0&&i.otherSE.point.events===r.otherSE.point.events&&i.segment.consume(r.segment)}}}getAvailableLinkedEvents(){const t=[];for(let e=0,i=this.point.events.length;e<i;e++){const n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}getLeftmostComparator(t){const e=new Map,i=n=>{const r=n.otherSE;e.set(n,{sine:V_(this.point,t.point,r.point),cosine:K_(this.point,t.point,r.point)})};return(n,r)=>{e.has(n)||i(n),e.has(r)||i(r);const{sine:o,cosine:a}=e.get(n),{sine:l,cosine:h}=e.get(r);return o.isGreaterThanOrEqualTo(0)&&l.isGreaterThanOrEqualTo(0)?a.isLessThan(h)?1:a.isGreaterThan(h)?-1:0:o.isLessThan(0)&&l.isLessThan(0)?a.isLessThan(h)?-1:a.isGreaterThan(h)?1:0:l.isLessThan(o)?-1:l.isGreaterThan(o)?1:0}}},j_=class Sa{constructor(t){K(this,"events");K(this,"poly");K(this,"_isExteriorRing");K(this,"_enclosingRing");this.events=t;for(let e=0,i=t.length;e<i;e++)t[e].segment.ringOut=this;this.poly=null}static factory(t){const e=[];for(let i=0,n=t.length;i<n;i++){const r=t[i];if(!r.isInResult()||r.ringOut)continue;let o=null,a=r.leftSE,l=r.rightSE;const h=[a],c=a.point,u=[];for(;o=a,a=l,h.push(a),a.point!==c;)for(;;){const d=a.getAvailableLinkedEvents();if(d.length===0){const p=h[0].point,x=h[h.length-1].point;throw new Error(`Unable to complete output ring starting at [${p.x}, ${p.y}]. Last matching segment found ends at [${x.x}, ${x.y}].`)}if(d.length===1){l=d[0].otherSE;break}let f=null;for(let p=0,x=u.length;p<x;p++)if(u[p].point===a.point){f=p;break}if(f!==null){const p=u.splice(f)[0],x=h.splice(p.index);x.unshift(x[0].otherSE),e.push(new Sa(x.reverse()));continue}u.push({index:h.length,point:a.point});const m=a.getLeftmostComparator(o);l=d.sort(m)[0].otherSE;break}e.push(new Sa(h))}return e}getGeom(){let t=this.events[0].point;const e=[t];for(let h=1,c=this.events.length-1;h<c;h++){const u=this.events[h].point,d=this.events[h+1].point;mi.orient(u,t,d)!==0&&(e.push(u),t=u)}if(e.length===1)return null;const i=e[0],n=e[1];mi.orient(i,t,n)===0&&e.shift(),e.push(e[0]);const r=this.isExteriorRing()?1:-1,o=this.isExteriorRing()?0:e.length-1,a=this.isExteriorRing()?e.length:-1,l=[];for(let h=o;h!=a;h+=r)l.push([e[h].x.toNumber(),e[h].y.toNumber()]);return l}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){var n,r;let t=this.events[0];for(let o=1,a=this.events.length;o<a;o++){const l=this.events[o];Ue.compare(t,l)>0&&(t=l)}let e=t.segment.prevInResult(),i=e?e.prevInResult():null;for(;;){if(!e)return null;if(!i)return e.ringOut;if(i.ringOut!==e.ringOut)return((n=i.ringOut)==null?void 0:n.enclosingRing())!==e.ringOut?e.ringOut:(r=e.ringOut)==null?void 0:r.enclosingRing();e=i.prevInResult(),i=e?e.prevInResult():null}}},Uh=class{constructor(s){K(this,"exteriorRing");K(this,"interiorRings");this.exteriorRing=s,s.poly=this,this.interiorRings=[]}addInterior(s){this.interiorRings.push(s),s.poly=this}getGeom(){const s=this.exteriorRing.getGeom();if(s===null)return null;const t=[s];for(let e=0,i=this.interiorRings.length;e<i;e++){const n=this.interiorRings[e].getGeom();n!==null&&t.push(n)}return t}},Z_=class{constructor(s){K(this,"rings");K(this,"polys");this.rings=s,this.polys=this._composePolys(s)}getGeom(){const s=[];for(let t=0,e=this.polys.length;t<e;t++){const i=this.polys[t].getGeom();i!==null&&s.push(i)}return s}_composePolys(s){var e;const t=[];for(let i=0,n=s.length;i<n;i++){const r=s[i];if(!r.poly)if(r.isExteriorRing())t.push(new Uh(r));else{const o=r.enclosingRing();o!=null&&o.poly||t.push(new Uh(o)),(e=o==null?void 0:o.poly)==null||e.addInterior(r)}}return t}},Q_=class{constructor(s,t=Xr.compare){K(this,"queue");K(this,"tree");K(this,"segments");this.queue=s,this.tree=new Yr(t),this.segments=[]}process(s){const t=s.segment,e=[];if(s.consumedBy)return s.isLeft?this.queue.delete(s.otherSE):this.tree.delete(t),e;s.isLeft&&this.tree.add(t);let i=t,n=t;do i=this.tree.lastBefore(i);while(i!=null&&i.consumedBy!=null);do n=this.tree.firstAfter(n);while(n!=null&&n.consumedBy!=null);if(s.isLeft){let r=null;if(i){const a=i.getIntersection(t);if(a!==null&&(t.isAnEndpoint(a)||(r=a),!i.isAnEndpoint(a))){const l=this._splitSafely(i,a);for(let h=0,c=l.length;h<c;h++)e.push(l[h])}}let o=null;if(n){const a=n.getIntersection(t);if(a!==null&&(t.isAnEndpoint(a)||(o=a),!n.isAnEndpoint(a))){const l=this._splitSafely(n,a);for(let h=0,c=l.length;h<c;h++)e.push(l[h])}}if(r!==null||o!==null){let a=null;r===null?a=o:o===null?a=r:a=Ue.comparePoints(r,o)<=0?r:o,this.queue.delete(t.rightSE),e.push(t.rightSE);const l=t.split(a);for(let h=0,c=l.length;h<c;h++)e.push(l[h])}e.length>0?(this.tree.delete(t),e.push(s)):(this.segments.push(t),t.prev=i)}else{if(i&&n){const r=i.getIntersection(n);if(r!==null){if(!i.isAnEndpoint(r)){const o=this._splitSafely(i,r);for(let a=0,l=o.length;a<l;a++)e.push(o[a])}if(!n.isAnEndpoint(r)){const o=this._splitSafely(n,r);for(let a=0,l=o.length;a<l;a++)e.push(o[a])}}}this.tree.delete(t)}return e}_splitSafely(s,t){this.tree.delete(s);const e=s.rightSE;this.queue.delete(e);const i=s.split(t);return i.push(e),s.consumedBy===void 0&&this.tree.add(s),i}},q_=class{constructor(){K(this,"type");K(this,"numMultiPolys")}run(s,t,e){ms.type=s;const i=[new Vh(t,!0)];for(let h=0,c=e.length;h<c;h++)i.push(new Vh(e[h],!1));if(ms.numMultiPolys=i.length,ms.type==="difference"){const h=i[0];let c=1;for(;c<i.length;)Ta(i[c].bbox,h.bbox)!==null?c++:i.splice(c,1)}if(ms.type==="intersection")for(let h=0,c=i.length;h<c;h++){const u=i[h];for(let d=h+1,f=i.length;d<f;d++)if(Ta(u.bbox,i[d].bbox)===null)return[]}const n=new Yr(Ue.compare);for(let h=0,c=i.length;h<c;h++){const u=i[h].getSweepEvents();for(let d=0,f=u.length;d<f;d++)n.add(u[d])}const r=new Q_(n);let o=null;for(n.size!=0&&(o=n.first(),n.delete(o));o;){const h=r.process(o);for(let c=0,u=h.length;c<u;c++){const d=h[c];d.consumedBy===void 0&&n.add(d)}n.size!=0?(o=n.first(),n.delete(o)):o=null}mi.reset();const a=j_.factory(r.segments);return new Z_(a).getGeom()}},ms=new q_,Ra=ms,H_=0,Xr=class Er{constructor(t,e,i,n){K(this,"id");K(this,"leftSE");K(this,"rightSE");K(this,"rings");K(this,"windings");K(this,"ringOut");K(this,"consumedBy");K(this,"prev");K(this,"_prevInResult");K(this,"_beforeState");K(this,"_afterState");K(this,"_isInResult");this.id=++H_,this.leftSE=t,t.segment=this,t.otherSE=e,this.rightSE=e,e.segment=this,e.otherSE=t,this.rings=i,this.windings=n}static compare(t,e){const i=t.leftSE.point.x,n=e.leftSE.point.x,r=t.rightSE.point.x,o=e.rightSE.point.x;if(o.isLessThan(i))return 1;if(r.isLessThan(n))return-1;const a=t.leftSE.point.y,l=e.leftSE.point.y,h=t.rightSE.point.y,c=e.rightSE.point.y;if(i.isLessThan(n)){if(l.isLessThan(a)&&l.isLessThan(h))return 1;if(l.isGreaterThan(a)&&l.isGreaterThan(h))return-1;const u=t.comparePoint(e.leftSE.point);if(u<0)return 1;if(u>0)return-1;const d=e.comparePoint(t.rightSE.point);return d!==0?d:-1}if(i.isGreaterThan(n)){if(a.isLessThan(l)&&a.isLessThan(c))return-1;if(a.isGreaterThan(l)&&a.isGreaterThan(c))return 1;const u=e.comparePoint(t.leftSE.point);if(u!==0)return u;const d=t.comparePoint(e.rightSE.point);return d<0?1:d>0?-1:1}if(a.isLessThan(l))return-1;if(a.isGreaterThan(l))return 1;if(r.isLessThan(o)){const u=e.comparePoint(t.rightSE.point);if(u!==0)return u}if(r.isGreaterThan(o)){const u=t.comparePoint(e.rightSE.point);if(u<0)return 1;if(u>0)return-1}if(!r.eq(o)){const u=h.minus(a),d=r.minus(i),f=c.minus(l),m=o.minus(n);if(u.isGreaterThan(d)&&f.isLessThan(m))return 1;if(u.isLessThan(d)&&f.isGreaterThan(m))return-1}return r.isGreaterThan(o)?1:r.isLessThan(o)||h.isLessThan(c)?-1:h.isGreaterThan(c)?1:t.id<e.id?-1:t.id>e.id?1:0}static fromRing(t,e,i){let n,r,o;const a=Ue.comparePoints(t,e);if(a<0)n=t,r=e,o=1;else if(a>0)n=e,r=t,o=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const l=new Ue(n,!0),h=new Ue(r,!1);return new Er(l,h,[i],[o])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t.isLessThan(e)?t:e},ur:{x:this.rightSE.point.x,y:t.isGreaterThan(e)?t:e}}}vector(){return{x:this.rightSE.point.x.minus(this.leftSE.point.x),y:this.rightSE.point.y.minus(this.leftSE.point.y)}}isAnEndpoint(t){return t.x.eq(this.leftSE.point.x)&&t.y.eq(this.leftSE.point.y)||t.x.eq(this.rightSE.point.x)&&t.y.eq(this.rightSE.point.y)}comparePoint(t){return mi.orient(this.leftSE.point,t,this.rightSE.point)}getIntersection(t){const e=this.bbox(),i=t.bbox(),n=Ta(e,i);if(n===null)return null;const r=this.leftSE.point,o=this.rightSE.point,a=t.leftSE.point,l=t.rightSE.point,h=rs(e,a)&&this.comparePoint(a)===0,c=rs(i,r)&&t.comparePoint(r)===0,u=rs(e,l)&&this.comparePoint(l)===0,d=rs(i,o)&&t.comparePoint(o)===0;if(c&&h)return d&&!u?o:!d&&u?l:null;if(c)return u&&r.x.eq(l.x)&&r.y.eq(l.y)?null:r;if(h)return d&&o.x.eq(a.x)&&o.y.eq(a.y)?null:a;if(d&&u)return null;if(d)return o;if(u)return l;const f=W_(r,this.vector(),a,t.vector());return f===null||!rs(n,f)?null:mi.snap(f)}split(t){const e=[],i=t.events!==void 0,n=new Ue(t,!0),r=new Ue(t,!1),o=this.rightSE;this.replaceRightSE(r),e.push(r),e.push(n);const a=new Er(n,o,this.rings.slice(),this.windings.slice());return Ue.comparePoints(a.leftSE.point,a.rightSE.point)>0&&a.swapEvents(),Ue.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),i&&(n.checkForConsuming(),r.checkForConsuming()),e}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let e=0,i=this.windings.length;e<i;e++)this.windings[e]*=-1}consume(t){let e=this,i=t;for(;e.consumedBy;)e=e.consumedBy;for(;i.consumedBy;)i=i.consumedBy;const n=Er.compare(e,i);if(n!==0){if(n>0){const r=e;e=i,i=r}if(e.prev===i){const r=e;e=i,i=r}for(let r=0,o=i.rings.length;r<o;r++){const a=i.rings[r],l=i.windings[r],h=e.rings.indexOf(a);h===-1?(e.rings.push(a),e.windings.push(l)):e.windings[h]+=l}i.rings=null,i.windings=null,i.consumedBy=e,i.leftSE.consumedBy=e.leftSE,i.rightSE.consumedBy=e.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const e=this._afterState.rings,i=this._afterState.windings,n=this._afterState.multiPolys;for(let a=0,l=this.rings.length;a<l;a++){const h=this.rings[a],c=this.windings[a],u=e.indexOf(h);u===-1?(e.push(h),i.push(c)):i[u]+=c}const r=[],o=[];for(let a=0,l=e.length;a<l;a++){if(i[a]===0)continue;const h=e[a],c=h.poly;if(o.indexOf(c)===-1)if(h.isExterior)r.push(c);else{o.indexOf(c)===-1&&o.push(c);const u=r.indexOf(h.poly);u!==-1&&r.splice(u,1)}}for(let a=0,l=r.length;a<l;a++){const h=r[a].multiPoly;n.indexOf(h)===-1&&n.push(h)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(Ra.type){case"union":{const i=t.length===0,n=e.length===0;this._isInResult=i!==n;break}case"intersection":{let i,n;t.length<e.length?(i=t.length,n=e.length):(i=e.length,n=t.length),this._isInResult=n===Ra.numMultiPolys&&i<n;break}case"xor":{const i=Math.abs(t.length-e.length);this._isInResult=i%2===1;break}case"difference":{const i=n=>n.length===1&&n[0].isSubject;this._isInResult=i(t)!==i(e);break}}return this._isInResult}},Xh=class{constructor(s,t,e){K(this,"poly");K(this,"isExterior");K(this,"segments");K(this,"bbox");if(!Array.isArray(s)||s.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=t,this.isExterior=e,this.segments=[],typeof s[0][0]!="number"||typeof s[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=mi.snap({x:new We(s[0][0]),y:new We(s[0][1])});this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let n=i;for(let r=1,o=s.length;r<o;r++){if(typeof s[r][0]!="number"||typeof s[r][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const a=mi.snap({x:new We(s[r][0]),y:new We(s[r][1])});a.x.eq(n.x)&&a.y.eq(n.y)||(this.segments.push(Xr.fromRing(n,a,this)),a.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=a.x),a.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=a.y),a.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=a.x),a.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=a.y),n=a)}(!i.x.eq(n.x)||!i.y.eq(n.y))&&this.segments.push(Xr.fromRing(n,i,this))}getSweepEvents(){const s=[];for(let t=0,e=this.segments.length;t<e;t++){const i=this.segments[t];s.push(i.leftSE),s.push(i.rightSE)}return s}},J_=class{constructor(s,t){K(this,"multiPoly");K(this,"exteriorRing");K(this,"interiorRings");K(this,"bbox");if(!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new Xh(s[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let e=1,i=s.length;e<i;e++){const n=new Xh(s[e],this,!1);n.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=n.bbox.ur.y),this.interiorRings.push(n)}this.multiPoly=t}getSweepEvents(){const s=this.exteriorRing.getSweepEvents();for(let t=0,e=this.interiorRings.length;t<e;t++){const i=this.interiorRings[t].getSweepEvents();for(let n=0,r=i.length;n<r;n++)s.push(i[n])}return s}},Vh=class{constructor(s,t){K(this,"isSubject");K(this,"polys");K(this,"bbox");if(!Array.isArray(s))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof s[0][0][0]=="number"&&(s=[s])}catch{}this.polys=[],this.bbox={ll:{x:new We(Number.POSITIVE_INFINITY),y:new We(Number.POSITIVE_INFINITY)},ur:{x:new We(Number.NEGATIVE_INFINITY),y:new We(Number.NEGATIVE_INFINITY)}};for(let e=0,i=s.length;e<i;e++){const n=new J_(s[e],this);n.bbox.ll.x.isLessThan(this.bbox.ll.x)&&(this.bbox.ll.x=n.bbox.ll.x),n.bbox.ll.y.isLessThan(this.bbox.ll.y)&&(this.bbox.ll.y=n.bbox.ll.y),n.bbox.ur.x.isGreaterThan(this.bbox.ur.x)&&(this.bbox.ur.x=n.bbox.ur.x),n.bbox.ur.y.isGreaterThan(this.bbox.ur.y)&&(this.bbox.ur.y=n.bbox.ur.y),this.polys.push(n)}this.isSubject=t}getSweepEvents(){const s=[];for(let t=0,e=this.polys.length;t<e;t++){const i=this.polys[t].getSweepEvents();for(let n=0,r=i.length;n<r;n++)s.push(i[n])}return s}},$_=(s,...t)=>Ra.run("difference",s,t);mi.set;function tp(s){const t=[];if(N_(s,n=>{t.push(n.coordinates)}),t.length<2)throw new Error("Must have at least two features");const e=s.features[0].properties||{},i=$_(t[0],...t.slice(1));return i.length===0?null:i.length===1?b_(i[0],e):Ea(i,e)}class Vo{static equalsWithTolerance(t,e,i){return Math.abs(t-e)<=i}}class Ui extends Error{constructor(t){super(t),this.name=Object.keys({Exception:Ui})[0]}toString(){return this.message}}class xt extends Ui{constructor(t){super(t),this.name=Object.keys({IllegalArgumentException:xt})[0]}}class os{constructor(t,e){this.low=e||0,this.high=t||0}static toBinaryString(t){let e,i="";for(e=2147483648;e>0;e>>>=1)i+=(t.high&e)===e?"1":"0";for(e=2147483648;e>0;e>>>=1)i+=(t.low&e)===e?"1":"0";return i}}function st(){}st.NaN=NaN;st.isNaN=s=>Number.isNaN(s);st.isInfinite=s=>!Number.isFinite(s);st.MAX_VALUE=Number.MAX_VALUE;st.POSITIVE_INFINITY=Number.POSITIVE_INFINITY;st.NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY;typeof Float64Array=="function"&&typeof Int32Array=="function"?function(){const e=new Float64Array(1),i=new Int32Array(e.buffer);st.doubleToLongBits=function(n){e[0]=n;let r=i[0]|0,o=i[1]|0;return(o&2146435072)===2146435072&&o&1048575&&r!==0&&(r=0,o=2146959360),new os(o,r)},st.longBitsToDouble=function(n){return i[0]=n.low,i[1]=n.high,e[0]}}():function(){const t=Math.log2,e=Math.floor,i=Math.pow,n=function(){for(let r=53;r>0;r--){const o=i(2,r)-1;if(e(t(o))+1===r)return o}return 0}();st.doubleToLongBits=function(r){let o,a,l,h,c,u,d,f,m;if(r<0||1/r===Number.NEGATIVE_INFINITY?(u=1<<31,r=-r):u=0,r===0)return m=0,f=u,new os(f,m);if(r===1/0)return m=0,f=u|2146435072,new os(f,m);if(r!==r)return m=0,f=2146959360,new os(f,m);if(h=0,m=0,o=e(r),o>1)if(o<=n)h=e(t(o)),h<=20?(m=0,f=o<<20-h&1048575):(l=h-20,a=i(2,l),m=o%a<<32-l,f=o/a&1048575);else for(l=o,m=0;a=l/2,l=e(a),l!==0;)h++,m>>>=1,m|=(f&1)<<31,f>>>=1,a!==l&&(f|=524288);if(d=h+1023,c=o===0,o=r-o,h<52&&o!==0)for(l=0;;){if(a=o*2,a>=1?(o=a-1,c?(d--,c=!1):(l<<=1,l|=1,h++)):(o=a,c?--d===0&&(h++,c=!1):(l<<=1,h++)),h===20)f|=l,l=0;else if(h===52){m|=l;break}if(a===1){h<20?f|=l<<20-h:h<52&&(m|=l<<52-h);break}}return f|=d<<20,f|=u,new os(f,m)},st.longBitsToDouble=function(r){let o,a,l,h;const c=r.high,u=r.low,d=c&1<<31?-1:1;for(l=((c&2146435072)>>20)-1023,h=0,a=1<<19,o=1;o<=20;o++)c&a&&(h+=i(2,-o)),a>>>=1;for(a=1<<31,o=21;o<=52;o++)u&a&&(h+=i(2,-o)),a>>>=1;if(l===-1023){if(h===0)return d*0;l=-1022}else{if(l===1024)return h===0?d/0:NaN;h+=1}return d*h*i(2,l)}}();function Ks(){}function _i(){}class As extends Ui{constructor(t){super(t),this.name=Object.keys({RuntimeException:As})[0]}}class Fn extends As{constructor(){super(),Fn.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)As.constructor_.call(this);else if(arguments.length===1){const t=arguments[0];As.constructor_.call(this,t)}}}class Oi{static isTrue(){if(arguments.length===1){const t=arguments[0];Oi.isTrue(t,null)}else if(arguments.length===2){const t=arguments[0],e=arguments[1];if(!t)throw e===null?new Fn:new Fn(e)}}static shouldNeverReachHere(){if(arguments.length===0)Oi.shouldNeverReachHere(null);else if(arguments.length===1){const t=arguments[0];throw new Fn("Should never reach here"+(t!==null?": "+t:""))}}static equals(){if(arguments.length===2){const t=arguments[0],e=arguments[1];Oi.equals(t,e,null)}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];if(!e.equals(t))throw new Fn("Expected "+t+" but encountered "+e+(i!==null?": "+i:""))}}}function oo(){}function bl(){}const td=new ArrayBuffer(8),ep=new Float64Array(td),Kh=new Int32Array(td);class U{constructor(){U.constructor_.apply(this,arguments)}static constructor_(){if(this.x=null,this.y=null,this.z=null,arguments.length===0)U.constructor_.call(this,0,0);else if(arguments.length===1){const t=arguments[0];U.constructor_.call(this,t.x,t.y,t.getZ())}else if(arguments.length===2){const t=arguments[0],e=arguments[1];U.constructor_.call(this,t,e,U.NULL_ORDINATE)}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];this.x=t,this.y=e,this.z=i}}static hashCode(t){return ep[0]=t,Kh[0]^Kh[1]}equals2D(){if(arguments.length===1){const t=arguments[0];return!(this.x!==t.x||this.y!==t.y)}else if(arguments.length===2){const t=arguments[0],e=arguments[1];return!(!Vo.equalsWithTolerance(this.x,t.x,e)||!Vo.equalsWithTolerance(this.y,t.y,e))}}setM(t){throw new xt("Invalid ordinate index: "+U.M)}equals3D(t){return this.x===t.x&&this.y===t.y&&(this.getZ()===t.getZ()||st.isNaN(this.getZ())&&st.isNaN(t.getZ()))}setX(t){this.x=t}compareTo(t){const e=t;return this.x<e.x?-1:this.x>e.x?1:this.y<e.y?-1:this.y>e.y?1:0}getX(){return this.x}copy(){return new U(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+")"}distance3D(t){const e=this.x-t.x,i=this.y-t.y,n=this.getZ()-t.getZ();return Math.sqrt(e*e+i*i+n*n)}getY(){return this.y}getM(){return st.NaN}setOrdinate(t,e){switch(t){case U.X:this.x=e;break;case U.Y:this.y=e;break;case U.Z:this.setZ(e);break;default:throw new xt("Invalid ordinate index: "+t)}}getZ(){return this.z}getOrdinate(t){switch(t){case U.X:return this.x;case U.Y:return this.y;case U.Z:return this.getZ()}throw new xt("Invalid ordinate index: "+t)}equals(t){return t instanceof U?this.equals2D(t):!1}equalInZ(t,e){return Vo.equalsWithTolerance(this.getZ(),t.getZ(),e)}setZ(t){this.z=t}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return Oi.shouldNeverReachHere("this shouldn't happen because this class is Cloneable"),null;throw t}finally{}}setY(t){this.y=t}distance(t){const e=this.x-t.x,i=this.y-t.y;return Math.sqrt(e*e+i*i)}hashCode(){let t=17;return t=37*t+U.hashCode(this.x),t=37*t+U.hashCode(this.y),t}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}get interfaces_(){return[Ks,oo,_i]}}class qi{constructor(){qi.constructor_.apply(this,arguments)}static constructor_(){if(this._dimensionsToTest=2,arguments.length===0)qi.constructor_.call(this,2);else if(arguments.length===1){const t=arguments[0];if(t!==2&&t!==3)throw new xt("only 2 or 3 dimensions may be specified");this._dimensionsToTest=t}}static compare(t,e){return t<e?-1:t>e?1:st.isNaN(t)?st.isNaN(e)?0:-1:st.isNaN(e)?1:0}compare(t,e){const i=qi.compare(t.x,e.x);if(i!==0)return i;const n=qi.compare(t.y,e.y);return n!==0?n:this._dimensionsToTest<=2?0:qi.compare(t.getZ(),e.getZ())}get interfaces_(){return[bl]}}U.DimensionalComparator=qi;U.NULL_ORDINATE=st.NaN;U.X=0;U.Y=1;U.Z=2;U.M=3;function dt(s,t){return s.interfaces_&&s.interfaces_.indexOf(t)>-1}class ip{static ofLine(t){const e=t.size();if(e<=1)return 0;let i=0;const n=new U;t.getCoordinate(0,n);let r=n.x,o=n.y;for(let a=1;a<e;a++){t.getCoordinate(a,n);const l=n.x,h=n.y,c=l-r,u=h-o;i+=Math.sqrt(c*c+u*u),r=l,o=h}return i}}class Ws{filter(t){}}class Xi extends Ui{constructor(t){super(t),this.name=Object.keys({UnsupportedOperationException:Xi})[0]}}class on{add(){}addAll(){}isEmpty(){}iterator(){}size(){}toArray(){}remove(){}}class Ol extends Ui{constructor(t){super(t),this.name=Object.keys({IndexOutOfBoundsException:Ol})[0]}}class Wh extends on{get(){}set(){}isEmpty(){}}class js extends Ui{constructor(t){super(t),this.name=Object.keys({NoSuchElementException:js})[0]}}class Zs extends Wh{constructor(t){super(),this.array=[],t instanceof on&&this.addAll(t)}get interfaces_(){return[Wh,on]}ensureCapacity(){}add(t){return arguments.length===1?this.array.push(t):this.array.splice(arguments[0],0,arguments[1]),!0}clear(){this.array=[]}addAll(t){for(const e of t)this.array.push(e)}set(t,e){const i=this.array[t];return this.array[t]=e,i}iterator(){return new np(this)}get(t){if(t<0||t>=this.size())throw new Ol;return this.array[t]}isEmpty(){return this.array.length===0}sort(t){t?this.array.sort((e,i)=>t.compare(e,i)):this.array.sort()}size(){return this.array.length}toArray(){return this.array.slice()}remove(t){for(let e=0,i=this.array.length;e<i;e++)if(this.array[e]===t)return!!this.array.splice(e,1);return!1}[Symbol.iterator](){return this.array.values()}}let np=class{constructor(t){this.arrayList=t,this.position=0}next(){if(this.position===this.arrayList.size())throw new js;return this.arrayList.get(this.position++)}hasNext(){return this.position<this.arrayList.size()}set(t){return this.arrayList.set(this.position-1,t)}remove(){this.arrayList.remove(this.arrayList.get(this.position))}};class tn extends Zs{constructor(){super(),tn.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length!==0){if(arguments.length===1){const t=arguments[0];this.ensureCapacity(t.length),this.add(t,!0)}else if(arguments.length===2){const t=arguments[0],e=arguments[1];this.ensureCapacity(t.length),this.add(t,e)}}}getCoordinate(t){return this.get(t)}addAll(){if(arguments.length===2&&typeof arguments[1]=="boolean"&&dt(arguments[0],on)){const t=arguments[0],e=arguments[1];let i=!1;for(let n=t.iterator();n.hasNext();)this.add(n.next(),e),i=!0;return i}else return super.addAll.apply(this,arguments)}clone(){const t=super.clone.call(this);for(let e=0;e<this.size();e++)t.add(e,this.get(e).clone());return t}closeRing(){if(this.size()>0){const t=this.get(0).copy();this.add(t,!1)}}toCoordinateArray(){if(arguments.length===0)return this.toArray(tn.coordArrayType);if(arguments.length===1){if(arguments[0])return this.toArray(tn.coordArrayType);const e=this.size(),i=new Array(e).fill(null);for(let n=0;n<e;n++)i[n]=this.get(e-n-1);return i}}add(){if(arguments.length===1){const t=arguments[0];return super.add.call(this,t)}else if(arguments.length===2){if(arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const t=arguments[0],e=arguments[1];return this.add(t,e,!0),!0}else if(arguments[0]instanceof U&&typeof arguments[1]=="boolean"){const t=arguments[0];if(!arguments[1]&&this.size()>=1&&this.get(this.size()-1).equals2D(t))return null;super.add.call(this,t)}else if(arguments[0]instanceof Object&&typeof arguments[1]=="boolean"){const t=arguments[0],e=arguments[1];return this.add(t,e),!0}}else if(arguments.length===3){if(typeof arguments[2]=="boolean"&&arguments[0]instanceof Array&&typeof arguments[1]=="boolean"){const t=arguments[0],e=arguments[1];if(arguments[2])for(let n=0;n<t.length;n++)this.add(t[n],e);else for(let n=t.length-1;n>=0;n--)this.add(t[n],e);return!0}else if(typeof arguments[2]=="boolean"&&Number.isInteger(arguments[0])&&arguments[1]instanceof U){const t=arguments[0],e=arguments[1];if(!arguments[2]){const n=this.size();if(n>0&&(t>0&&this.get(t-1).equals2D(e)||t<n&&this.get(t).equals2D(e)))return null}super.add.call(this,t,e)}}else if(arguments.length===4){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];let r=1;i>n&&(r=-1);for(let o=i;o!==n;o+=r)this.add(t[o],e);return!0}}}tn.coordArrayType=new Array(0).fill(null);class Ht extends U{constructor(){super(),Ht.constructor_.apply(this,arguments)}static constructor_(){if(arguments.length===0)U.constructor_.call(this);else if(arguments.length===1){if(arguments[0]instanceof Ht){const t=arguments[0];U.constructor_.call(this,t.x,t.y)}else if(arguments[0]instanceof U){const t=arguments[0];U.constructor_.call(this,t.x,t.y)}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];U.constructor_.call(this,t,e,U.NULL_ORDINATE)}}setOrdinate(t,e){switch(t){case Ht.X:this.x=e;break;case Ht.Y:this.y=e;break;default:throw new xt("Invalid ordinate index: "+t)}}setZ(t){throw new xt("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Ht(this)}toString(){return"("+this.x+", "+this.y+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ()}getZ(){return U.NULL_ORDINATE}getOrdinate(t){switch(t){case Ht.X:return this.x;case Ht.Y:return this.y}throw new xt("Invalid ordinate index: "+t)}}Ht.X=0;Ht.Y=1;Ht.Z=-1;Ht.M=-1;class Gt extends U{constructor(){super(),Gt.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)U.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof Gt){const t=arguments[0];U.constructor_.call(this,t.x,t.y),this._m=t._m}else if(arguments[0]instanceof U){const t=arguments[0];U.constructor_.call(this,t.x,t.y),this._m=this.getM()}}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];U.constructor_.call(this,t,e,U.NULL_ORDINATE),this._m=i}}setM(t){this._m=t}setZ(t){throw new xt("CoordinateXY dimension 2 does not support z-ordinate")}copy(){return new Gt(this)}toString(){return"("+this.x+", "+this.y+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}getM(){return this._m}setOrdinate(t,e){switch(t){case Gt.X:this.x=e;break;case Gt.Y:this.y=e;break;case Gt.M:this._m=e;break;default:throw new xt("Invalid ordinate index: "+t)}}getZ(){return U.NULL_ORDINATE}getOrdinate(t){switch(t){case Gt.X:return this.x;case Gt.Y:return this.y;case Gt.M:return this._m}throw new xt("Invalid ordinate index: "+t)}}Gt.X=0;Gt.Y=1;Gt.Z=-1;Gt.M=2;class en extends U{constructor(){super(),en.constructor_.apply(this,arguments)}static constructor_(){if(this._m=null,arguments.length===0)U.constructor_.call(this),this._m=0;else if(arguments.length===1){if(arguments[0]instanceof en){const t=arguments[0];U.constructor_.call(this,t),this._m=t._m}else if(arguments[0]instanceof U){const t=arguments[0];U.constructor_.call(this,t),this._m=this.getM()}}else if(arguments.length===4){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];U.constructor_.call(this,t,e,i),this._m=n}}setM(t){this._m=t}getOrdinate(t){switch(t){case U.X:return this.x;case U.Y:return this.y;case U.Z:return this.getZ();case U.M:return this.getM()}throw new xt("Invalid ordinate index: "+t)}copy(){return new en(this)}toString(){return"("+this.x+", "+this.y+", "+this.getZ()+" m="+this.getM()+")"}setCoordinate(t){this.x=t.x,this.y=t.y,this.z=t.getZ(),this._m=t.getM()}getM(){return this._m}setOrdinate(t,e){switch(t){case U.X:this.x=e;break;case U.Y:this.y=e;break;case U.Z:this.z=e;break;case U.M:this._m=e;break;default:throw new xt("Invalid ordinate index: "+t)}}}class zn{static measures(t){return t instanceof Ht?0:t instanceof Gt||t instanceof en?1:(t instanceof U,0)}static create(){if(arguments.length===1){const t=arguments[0];return zn.create(t,0)}else if(arguments.length===2){const t=arguments[0],e=arguments[1];return t===2?new Ht:t===3&&e===0?new U:t===3&&e===1?new Gt:t===4&&e===1?new en:new U}}static dimension(t){return t instanceof Ht?2:t instanceof Gt?3:t instanceof en?4:(t instanceof U,3)}}class vs{static log10(t){const e=Math.log(t);return st.isInfinite(e)||st.isNaN(e)?e:e/vs.LOG_10}static min(t,e,i,n){let r=t;return e<r&&(r=e),i<r&&(r=i),n<r&&(r=n),r}static clamp(){if(typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],i=arguments[2];return t<e?e:t>i?i:t}}static average(t,e){return(t+e)/2}static wrap(t,e){return t<0?e- -t%e:t%e}static max(){if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];let n=t;return e>n&&(n=e),i>n&&(n=i),n}else if(arguments.length===4){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];let r=t;return e>r&&(r=e),i>r&&(r=i),n>r&&(r=n),r}}}vs.LOG_10=Math.log(10);class Ko{static arraycopy(t,e,i,n,r){let o=0;for(let a=e;a<e+r;a++)i[n+o]=t[a],o++}static getProperty(t){return{"line.separator":`
`}[t]}}class Ft{constructor(){Ft.constructor_.apply(this,arguments)}static constructor_(){if(this._minx=null,this._maxx=null,this._miny=null,this._maxy=null,arguments.length===0)this.init();else if(arguments.length===1){if(arguments[0]instanceof U){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Ft){const t=arguments[0];this.init(t)}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(arguments.length===4){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];this.init(t,e,i,n)}}static intersects(){if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];return i.x>=(t.x<e.x?t.x:e.x)&&i.x<=(t.x>e.x?t.x:e.x)&&i.y>=(t.y<e.y?t.y:e.y)&&i.y<=(t.y>e.y?t.y:e.y)}else if(arguments.length===4){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];let r=Math.min(i.x,n.x),o=Math.max(i.x,n.x),a=Math.min(t.x,e.x),l=Math.max(t.x,e.x);return!(a>o||l<r||(r=Math.min(i.y,n.y),o=Math.max(i.y,n.y),a=Math.min(t.y,e.y),l=Math.max(t.y,e.y),a>o)||l<r)}}getArea(){return this.getWidth()*this.getHeight()}getMinX(){return this._minx}expandToInclude(){if(arguments.length===1){if(arguments[0]instanceof U){const t=arguments[0];this.expandToInclude(t.x,t.y)}else if(arguments[0]instanceof Ft){const t=arguments[0];if(t.isNull())return null;this.isNull()?(this._minx=t.getMinX(),this._maxx=t.getMaxX(),this._miny=t.getMinY(),this._maxy=t.getMaxY()):(t._minx<this._minx&&(this._minx=t._minx),t._maxx>this._maxx&&(this._maxx=t._maxx),t._miny<this._miny&&(this._miny=t._miny),t._maxy>this._maxy&&(this._maxy=t._maxy))}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];this.isNull()?(this._minx=t,this._maxx=t,this._miny=e,this._maxy=e):(t<this._minx&&(this._minx=t),t>this._maxx&&(this._maxx=t),e<this._miny&&(this._miny=e),e>this._maxy&&(this._maxy=e))}}compareTo(t){const e=t;return this.isNull()?e.isNull()?0:-1:e.isNull()?1:this._minx<e._minx?-1:this._minx>e._minx?1:this._miny<e._miny?-1:this._miny>e._miny?1:this._maxx<e._maxx?-1:this._maxx>e._maxx?1:this._maxy<e._maxy?-1:this._maxy>e._maxy?1:0}translate(t,e){if(this.isNull())return null;this.init(this.getMinX()+t,this.getMaxX()+t,this.getMinY()+e,this.getMaxY()+e)}copy(){return new Ft(this)}expandBy(){if(arguments.length===1){const t=arguments[0];this.expandBy(t,t)}else if(arguments.length===2){const t=arguments[0],e=arguments[1];if(this.isNull())return null;this._minx-=t,this._maxx+=t,this._miny-=e,this._maxy+=e,(this._minx>this._maxx||this._miny>this._maxy)&&this.setToNull()}}contains(){if(arguments.length===1){if(arguments[0]instanceof Ft){const t=arguments[0];return this.covers(t)}else if(arguments[0]instanceof U){const t=arguments[0];return this.covers(t)}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];return this.covers(t,e)}}hashCode(){let t=17;return t=37*t+U.hashCode(this._minx),t=37*t+U.hashCode(this._maxx),t=37*t+U.hashCode(this._miny),t=37*t+U.hashCode(this._maxy),t}equals(t){if(!(t instanceof Ft))return!1;const e=t;return this.isNull()?e.isNull():this._maxx===e.getMaxX()&&this._maxy===e.getMaxY()&&this._minx===e.getMinX()&&this._miny===e.getMinY()}intersection(t){if(this.isNull()||t.isNull()||!this.intersects(t))return new Ft;const e=this._minx>t._minx?this._minx:t._minx,i=this._miny>t._miny?this._miny:t._miny,n=this._maxx<t._maxx?this._maxx:t._maxx,r=this._maxy<t._maxy?this._maxy:t._maxy;return new Ft(e,n,i,r)}isNull(){return this._maxx<this._minx}getMaxX(){return this._maxx}covers(){if(arguments.length===1){if(arguments[0]instanceof U){const t=arguments[0];return this.covers(t.x,t.y)}else if(arguments[0]instanceof Ft){const t=arguments[0];return this.isNull()||t.isNull()?!1:t.getMinX()>=this._minx&&t.getMaxX()<=this._maxx&&t.getMinY()>=this._miny&&t.getMaxY()<=this._maxy}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];return this.isNull()?!1:t>=this._minx&&t<=this._maxx&&e>=this._miny&&e<=this._maxy}}intersects(){if(arguments.length===1){if(arguments[0]instanceof Ft){const t=arguments[0];return this.isNull()||t.isNull()?!1:!(t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny)}else if(arguments[0]instanceof U){const t=arguments[0];return this.intersects(t.x,t.y)}}else if(arguments.length===2){if(arguments[0]instanceof U&&arguments[1]instanceof U){const t=arguments[0],e=arguments[1];return!(this.isNull()||(t.x<e.x?t.x:e.x)>this._maxx||(t.x>e.x?t.x:e.x)<this._minx||(t.y<e.y?t.y:e.y)>this._maxy||(t.y>e.y?t.y:e.y)<this._miny)}else if(typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],e=arguments[1];return this.isNull()?!1:!(t>this._maxx||t<this._minx||e>this._maxy||e<this._miny)}}}getMinY(){return this._miny}getDiameter(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return Math.sqrt(t*t+e*e)}minExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t<e?t:e}getWidth(){return this.isNull()?0:this._maxx-this._minx}toString(){return"Env["+this._minx+" : "+this._maxx+", "+this._miny+" : "+this._maxy+"]"}setToNull(){this._minx=0,this._maxx=-1,this._miny=0,this._maxy=-1}disjoint(t){return this.isNull()||t.isNull()?!0:t._minx>this._maxx||t._maxx<this._minx||t._miny>this._maxy||t._maxy<this._miny}getHeight(){return this.isNull()?0:this._maxy-this._miny}maxExtent(){if(this.isNull())return 0;const t=this.getWidth(),e=this.getHeight();return t>e?t:e}centre(){return this.isNull()?null:new U((this.getMinX()+this.getMaxX())/2,(this.getMinY()+this.getMaxY())/2)}init(){if(arguments.length===0)this.setToNull();else if(arguments.length===1){if(arguments[0]instanceof U){const t=arguments[0];this.init(t.x,t.x,t.y,t.y)}else if(arguments[0]instanceof Ft){const t=arguments[0];this._minx=t._minx,this._maxx=t._maxx,this._miny=t._miny,this._maxy=t._maxy}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];this.init(t.x,e.x,t.y,e.y)}else if(arguments.length===4){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];t<e?(this._minx=t,this._maxx=e):(this._minx=e,this._maxx=t),i<n?(this._miny=i,this._maxy=n):(this._miny=n,this._maxy=i)}}getMaxY(){return this._maxy}distance(t){if(this.intersects(t))return 0;let e=0;this._maxx<t._minx?e=t._minx-this._maxx:this._minx>t._maxx&&(e=this._minx-t._maxx);let i=0;return this._maxy<t._miny?i=t._miny-this._maxy:this._miny>t._maxy&&(i=this._miny-t._maxy),e===0?i:i===0?e:Math.sqrt(e*e+i*i)}get interfaces_(){return[Ks,_i]}}class Ut{static scroll(t,e){const i=Ut.indexOf(e,t);if(i<0)return null;const n=new Array(t.length).fill(null);Ko.arraycopy(t,i,n,0,t.length-i),Ko.arraycopy(t,0,n,t.length-i,i),Ko.arraycopy(n,0,t,0,t.length)}static removeRepeatedPoints(t){return Ut.hasRepeatedPoints(t)?new tn(t,!1).toCoordinateArray():t}static reverse(t){const e=t.length-1,i=Math.trunc(e/2);for(let n=0;n<=i;n++){const r=t[n];t[n]=t[e-n],t[e-n]=r}}static removeNull(t){let e=0;for(let r=0;r<t.length;r++)t[r]!==null&&e++;const i=new Array(e).fill(null);if(e===0)return i;let n=0;for(let r=0;r<t.length;r++)t[r]!==null&&(i[n++]=t[r]);return i}static copyDeep(){if(arguments.length===1){const t=arguments[0],e=new Array(t.length).fill(null);for(let i=0;i<t.length;i++)e[i]=t[i].copy();return e}else if(arguments.length===5){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=arguments[4];for(let o=0;o<r;o++)i[n+o]=t[e+o].copy()}}static isEqualReversed(t,e){for(let i=0;i<t.length;i++){const n=t[i],r=e[t.length-i-1];if(n.compareTo(r)!==0)return!1}return!0}static envelope(t){const e=new Ft;for(let i=0;i<t.length;i++)e.expandToInclude(t[i]);return e}static extract(t,e,i){e=vs.clamp(e,0,t.length),i=vs.clamp(i,-1,t.length);let n=i-e+1;i<0&&(n=0),e>=t.length&&(n=0),i<e&&(n=0);const r=new Array(n).fill(null);if(n===0)return r;let o=0;for(let a=e;a<=i;a++)r[o++]=t[a];return r}static isRing(t){return!(t.length<4||!t[0].equals2D(t[t.length-1]))}static ptNotInList(t,e){for(let i=0;i<t.length;i++){const n=t[i];if(Ut.indexOf(n,e)<0)return n}return null}static equals(){if(arguments.length===2){const t=arguments[0],e=arguments[1];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(let i=0;i<t.length;i++)if(!t[i].equals(e[i]))return!1;return!0}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];if(t===e)return!0;if(t===null||e===null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(i.compare(t[n],e[n])!==0)return!1;return!0}}static intersection(t,e){const i=new tn;for(let n=0;n<t.length;n++)e.intersects(t[n])&&i.add(t[n],!0);return i.toCoordinateArray()}static measures(t){if(t===null||t.length===0)return 0;let e=0;for(const i of t)e=Math.max(e,zn.measures(i));return e}static hasRepeatedPoints(t){for(let e=1;e<t.length;e++)if(t[e-1].equals(t[e]))return!0;return!1}static toCoordinateArray(t){return t.toArray(Ut.coordArrayType)}static dimension(t){if(t===null||t.length===0)return 3;let e=0;for(const i of t)e=Math.max(e,zn.dimension(i));return e}static atLeastNCoordinatesOrNothing(t,e){return e.length>=t?e:[]}static indexOf(t,e){for(let i=0;i<e.length;i++)if(t.equals(e[i]))return i;return-1}static increasingDirection(t){for(let e=0;e<Math.trunc(t.length/2);e++){const i=t.length-1-e,n=t[e].compareTo(t[i]);if(n!==0)return n}return 1}static compare(t,e){let i=0;for(;i<t.length&&i<e.length;){const n=t[i].compareTo(e[i]);if(n!==0)return n;i++}return i<e.length?-1:i<t.length?1:0}static minCoordinate(t){let e=null;for(let i=0;i<t.length;i++)(e===null||e.compareTo(t[i])>0)&&(e=t[i]);return e}}class sp{compare(t,e){const i=t,n=e;return Ut.compare(i,n)}get interfaces_(){return[bl]}}class rp{compare(t,e){const i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(i.length===0)return 0;const r=Ut.compare(i,n);return Ut.isEqualReversed(i,n)?0:r}OLDcompare(t,e){const i=t,n=e;if(i.length<n.length)return-1;if(i.length>n.length)return 1;if(i.length===0)return 0;const r=Ut.increasingDirection(i),o=Ut.increasingDirection(n);let a=r>0?0:i.length-1,l=o>0?0:i.length-1;for(let h=0;h<i.length;h++){const c=i[a].compareTo(n[l]);if(c!==0)return c;a+=r,l+=o}return 0}get interfaces_(){return[bl]}}Ut.ForwardComparator=sp;Ut.BidirectionalComparator=rp;Ut.coordArrayType=new Array(0).fill(null);class Ia{static isWhitespace(t){return t<=32&&t>=0||t===127}static toUpperCase(t){return t.toUpperCase()}}class ${static toDimensionSymbol(t){switch(t){case $.FALSE:return $.SYM_FALSE;case $.TRUE:return $.SYM_TRUE;case $.DONTCARE:return $.SYM_DONTCARE;case $.P:return $.SYM_P;case $.L:return $.SYM_L;case $.A:return $.SYM_A}throw new xt("Unknown dimension value: "+t)}static toDimensionValue(t){switch(Ia.toUpperCase(t)){case $.SYM_FALSE:return $.FALSE;case $.SYM_TRUE:return $.TRUE;case $.SYM_DONTCARE:return $.DONTCARE;case $.SYM_P:return $.P;case $.SYM_L:return $.L;case $.SYM_A:return $.A}throw new xt("Unknown dimension symbol: "+t)}}$.P=0;$.L=1;$.A=2;$.FALSE=-1;$.TRUE=-2;$.DONTCARE=-3;$.SYM_FALSE="F";$.SYM_TRUE="T";$.SYM_DONTCARE="*";$.SYM_P="0";$.SYM_L="1";$.SYM_A="2";class V{constructor(){V.constructor_.apply(this,arguments)}isGeometryCollection(){return this.getTypeCode()===V.TYPECODE_GEOMETRYCOLLECTION}getFactory(){return this._factory}getGeometryN(t){return this}getArea(){return 0}isRectangle(){return!1}equalsExact(t){return this===t||this.equalsExact(t,0)}geometryChanged(){this.apply(V.geometryChangedFilter)}geometryChangedAction(){this._envelope=null}equalsNorm(t){return t===null?!1:this.norm().equalsExact(t.norm())}getLength(){return 0}getNumGeometries(){return 1}compareTo(){let t;if(arguments.length===1){const e=arguments[0];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e)}else if(arguments.length===2){const e=arguments[0],i=arguments[1];return t=e,this.getTypeCode()!==t.getTypeCode()?this.getTypeCode()-t.getTypeCode():this.isEmpty()&&t.isEmpty()?0:this.isEmpty()?-1:t.isEmpty()?1:this.compareToSameClass(e,i)}}getUserData(){return this._userData}getSRID(){return this._SRID}getEnvelope(){return this.getFactory().toGeometry(this.getEnvelopeInternal())}static checkNotGeometryCollection(t){if(t.getTypeCode()===V.TYPECODE_GEOMETRYCOLLECTION)throw new xt("This method does not support GeometryCollection arguments")}equal(t,e,i){return i===0?t.equals(e):t.distance(e)<=i}norm(){const t=this.copy();return t.normalize(),t}reverse(){const t=this.reverseInternal();return this.envelope!=null&&(t.envelope=this.envelope.copy()),t.setSRID(this.getSRID()),t}copy(){const t=this.copyInternal();return t.envelope=this._envelope==null?null:this._envelope.copy(),t._SRID=this._SRID,t._userData=this._userData,t}getPrecisionModel(){return this._factory.getPrecisionModel()}getEnvelopeInternal(){return this._envelope===null&&(this._envelope=this.computeEnvelopeInternal()),new Ft(this._envelope)}setSRID(t){this._SRID=t}setUserData(t){this._userData=t}compare(t,e){const i=t.iterator(),n=e.iterator();for(;i.hasNext()&&n.hasNext();){const r=i.next(),o=n.next(),a=r.compareTo(o);if(a!==0)return a}return i.hasNext()?1:n.hasNext()?-1:0}hashCode(){return this.getEnvelopeInternal().hashCode()}isEquivalentClass(t){return this.getTypeCode()==t.getTypeCode()}get interfaces_(){return[oo,Ks,_i]}getClass(){return V}static hasNonEmptyElements(t){for(let e=0;e<t.length;e++)if(!t[e].isEmpty())return!0;return!1}static hasNullElements(t){for(let e=0;e<t.length;e++)if(t[e]===null)return!0;return!1}}V.constructor_=function(s){s&&(this._envelope=null,this._userData=null,this._factory=s,this._SRID=s.getSRID())};V.TYPECODE_POINT=0;V.TYPECODE_MULTIPOINT=1;V.TYPECODE_LINESTRING=2;V.TYPECODE_LINEARRING=3;V.TYPECODE_MULTILINESTRING=4;V.TYPECODE_POLYGON=5;V.TYPECODE_MULTIPOLYGON=6;V.TYPECODE_GEOMETRYCOLLECTION=7;V.TYPENAME_POINT="Point";V.TYPENAME_MULTIPOINT="MultiPoint";V.TYPENAME_LINESTRING="LineString";V.TYPENAME_LINEARRING="LinearRing";V.TYPENAME_MULTILINESTRING="MultiLineString";V.TYPENAME_POLYGON="Polygon";V.TYPENAME_MULTIPOLYGON="MultiPolygon";V.TYPENAME_GEOMETRYCOLLECTION="GeometryCollection";V.geometryChangedFilter={get interfaces_(){return[Ws]},filter(s){s.geometryChangedAction()}};class ao{filter(t){}}class ed{}class ht{getCoordinate(){}getCoordinateCopy(t){}createCoordinate(){}getDimension(){}hasM(){return this.getMeasures()>0}getX(t){}hasZ(){return this.getDimension()-this.getMeasures()>2}getMeasures(){return 0}expandEnvelope(t){}copy(){}getY(t){}toCoordinateArray(){}getM(t){if(this.hasM()){const e=this.getDimension()-this.getMeasures();return this.getOrdinate(t,e)}else return st.NaN}setOrdinate(t,e,i){}getZ(t){return this.hasZ()?this.getOrdinate(t,2):st.NaN}size(){}getOrdinate(t,e){}get interfaces_(){return[oo]}}ht.X=0;ht.Y=1;ht.Z=2;ht.M=3;class It{static scroll(){if(arguments.length===2){if(dt(arguments[0],ht)&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];It.scroll(t,e,It.isRing(t))}else if(dt(arguments[0],ht)&&arguments[1]instanceof U){const t=arguments[0],e=arguments[1],i=It.indexOf(e,t);if(i<=0)return null;It.scroll(t,i)}}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];if(e<=0)return null;const r=t.copy(),o=i?t.size()-1:t.size();for(let a=0;a<o;a++)for(let l=0;l<t.getDimension();l++)t.setOrdinate(a,l,r.getOrdinate((e+a)%o,l));if(i)for(let a=0;a<t.getDimension();a++)t.setOrdinate(o,a,t.getOrdinate(0,a))}}static isEqual(t,e){const i=t.size(),n=e.size();if(i!==n)return!1;const r=Math.min(t.getDimension(),e.getDimension());for(let o=0;o<i;o++)for(let a=0;a<r;a++){const l=t.getOrdinate(o,a),h=e.getOrdinate(o,a);if(t.getOrdinate(o,a)!==e.getOrdinate(o,a)&&!(st.isNaN(l)&&st.isNaN(h)))return!1}return!0}static minCoordinateIndex(){if(arguments.length===1){const t=arguments[0];return It.minCoordinateIndex(t,0,t.size()-1)}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];let n=-1,r=null;for(let o=e;o<=i;o++){const a=t.getCoordinate(o);(r===null||r.compareTo(a)>0)&&(r=a,n=o)}return n}}static extend(t,e,i){const n=t.create(i,e.getDimension()),r=e.size();if(It.copy(e,0,n,0,r),r>0)for(let o=r;o<i;o++)It.copy(e,r-1,n,o,1);return n}static reverse(t){const e=t.size()-1,i=Math.trunc(e/2);for(let n=0;n<=i;n++)It.swap(t,n,e-n)}static ensureValidRing(t,e){const i=e.size();return i===0?e:i<=3?It.createClosedRing(t,e,4):e.getOrdinate(0,ht.X)===e.getOrdinate(i-1,ht.X)&&e.getOrdinate(0,ht.Y)===e.getOrdinate(i-1,ht.Y)?e:It.createClosedRing(t,e,i+1)}static minCoordinate(t){let e=null;for(let i=0;i<t.size();i++){const n=t.getCoordinate(i);(e===null||e.compareTo(n)>0)&&(e=n)}return e}static copyCoord(t,e,i,n){const r=Math.min(t.getDimension(),i.getDimension());for(let o=0;o<r;o++)i.setOrdinate(n,o,t.getOrdinate(e,o))}static isRing(t){const e=t.size();return e===0?!0:e<=3?!1:t.getOrdinate(0,ht.X)===t.getOrdinate(e-1,ht.X)&&t.getOrdinate(0,ht.Y)===t.getOrdinate(e-1,ht.Y)}static swap(t,e,i){if(e===i)return null;for(let n=0;n<t.getDimension();n++){const r=t.getOrdinate(e,n);t.setOrdinate(e,n,t.getOrdinate(i,n)),t.setOrdinate(i,n,r)}}static copy(t,e,i,n,r){for(let o=0;o<r;o++)It.copyCoord(t,e+o,i,n+o)}static indexOf(t,e){for(let i=0;i<e.size();i++)if(t.x===e.getOrdinate(i,ht.X)&&t.y===e.getOrdinate(i,ht.Y))return i;return-1}static createClosedRing(t,e,i){const n=t.create(i,e.getDimension()),r=e.size();It.copy(e,0,n,0,r);for(let o=r;o<i;o++)It.copy(e,0,n,o,1);return n}}class lo{filter(t){}}class ho{filter(t,e){}isGeometryChanged(){}isDone(){}}class Ni extends V{constructor(){super(),Ni.constructor_.apply(this,arguments)}static constructor_(){if(this._points=null,arguments.length!==0){if(arguments.length===2){const t=arguments[0],e=arguments[1];V.constructor_.call(this,e),this.init(t)}}}computeEnvelopeInternal(){return this.isEmpty()?new Ft:this._points.expandEnvelope(new Ft)}isRing(){return this.isClosed()&&Ut.isRing(this.getCoordinates())}getCoordinates(){return this._points.toCoordinateArray()}copyInternal(){return new Ni(this._points.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const i=t;if(this._points.size()!==i._points.size())return!1;for(let n=0;n<this._points.size();n++)if(!this.equal(this._points.getCoordinate(n),i._points.getCoordinate(n),e))return!1;return!0}else return super.equalsExact.apply(this,arguments)}isClosed(){return this.isEmpty()?!1:this.getCoordinateN(0).equals2D(this.getCoordinateN(this.getNumPoints()-1))}reverseInternal(){const t=this._points.copy();return It.reverse(t),this.getFactory().createLineString(t)}getEndPoint(){return this.isEmpty()?null:this.getPointN(this.getNumPoints()-1)}getTypeCode(){return V.TYPECODE_LINESTRING}getDimension(){return 1}getBoundary(){throw new Xi}isEquivalentClass(t){return t instanceof Ni}getCoordinateSequence(){return this._points}getPointN(t){return this.getFactory().createPoint(this._points.getCoordinate(t))}normalize(){for(let t=0;t<Math.trunc(this._points.size()/2);t++){const e=this._points.size()-1-t;if(!this._points.getCoordinate(t).equals(this._points.getCoordinate(e))){if(this._points.getCoordinate(t).compareTo(this._points.getCoordinate(e))>0){const i=this._points.copy();It.reverse(i),this._points=i}return null}}}getCoordinate(){return this.isEmpty()?null:this._points.getCoordinate(0)}getBoundaryDimension(){return this.isClosed()?$.FALSE:0}getLength(){return ip.ofLine(this._points)}getNumPoints(){return this._points.size()}compareToSameClass(){if(arguments.length===1){const e=arguments[0];let i=0,n=0;for(;i<this._points.size()&&n<e._points.size();){const r=this._points.getCoordinate(i).compareTo(e._points.getCoordinate(n));if(r!==0)return r;i++,n++}return i<this._points.size()?1:n<e._points.size()?-1:0}else if(arguments.length===2){const t=arguments[0],e=arguments[1],i=t;return e.compare(this._points,i._points)}}apply(){if(dt(arguments[0],ao)){const t=arguments[0];for(let e=0;e<this._points.size();e++)t.filter(this._points.getCoordinate(e))}else if(dt(arguments[0],ho)){const t=arguments[0];if(this._points.size()===0)return null;for(let e=0;e<this._points.size()&&(t.filter(this._points,e),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else dt(arguments[0],lo)?arguments[0].filter(this):dt(arguments[0],Ws)&&arguments[0].filter(this)}getCoordinateN(t){return this._points.getCoordinate(t)}getGeometryType(){return V.TYPENAME_LINESTRING}isEmpty(){return this._points.size()===0}init(t){if(t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),t.size()===1)throw new xt("Invalid number of points in LineString (found "+t.size()+" - must be 0 or >= 2)");this._points=t}isCoordinate(t){for(let e=0;e<this._points.size();e++)if(this._points.getCoordinate(e).equals(t))return!0;return!1}getStartPoint(){return this.isEmpty()?null:this.getPointN(0)}get interfaces_(){return[ed]}}class nn extends Ni{constructor(){super(),nn.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Ni.constructor_.call(this,t,e),this.validateConstruction()}copyInternal(){return new nn(this._points.copy(),this._factory)}getBoundaryDimension(){return $.FALSE}isClosed(){return this.isEmpty()?!0:super.isClosed.call(this)}reverseInternal(){const t=this._points.copy();return It.reverse(t),this.getFactory().createLinearRing(t)}getTypeCode(){return V.TYPECODE_LINEARRING}validateConstruction(){if(!this.isEmpty()&&!super.isClosed.call(this))throw new xt("Points of LinearRing do not form a closed linestring");if(this.getCoordinateSequence().size()>=1&&this.getCoordinateSequence().size()<nn.MINIMUM_VALID_SIZE)throw new xt("Invalid number of points in LinearRing (found "+this.getCoordinateSequence().size()+" - must be 0 or >= 4)")}getGeometryType(){return V.TYPENAME_LINEARRING}}nn.MINIMUM_VALID_SIZE=4;class id{create(){if(arguments.length===1)arguments[0]instanceof Array||dt(arguments[0],ht);else if(arguments.length!==2){if(arguments.length===3){const t=arguments[0],e=arguments[1];return this.create(t,e)}}}}class op{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class oi{constructor(){oi.constructor_.apply(this,arguments)}static constructor_(){if(this._dimension=3,this._measures=0,this._coordinates=null,arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];oi.constructor_.call(this,t,Ut.dimension(t),Ut.measures(t))}else if(Number.isInteger(arguments[0])){const t=arguments[0];this._coordinates=new Array(t).fill(null);for(let e=0;e<t;e++)this._coordinates[e]=new U}else if(dt(arguments[0],ht)){const t=arguments[0];if(t===null)return this._coordinates=new Array(0).fill(null),null;this._dimension=t.getDimension(),this._measures=t.getMeasures(),this._coordinates=new Array(t.size()).fill(null);for(let e=0;e<this._coordinates.length;e++)this._coordinates[e]=t.getCoordinateCopy(e)}}else if(arguments.length===2){if(arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];oi.constructor_.call(this,t,e,Ut.measures(t))}else if(Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1];this._coordinates=new Array(t).fill(null),this._dimension=e;for(let i=0;i<t;i++)this._coordinates[i]=zn.create(e)}}else if(arguments.length===3){if(Number.isInteger(arguments[2])&&arguments[0]instanceof Array&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],i=arguments[2];this._dimension=e,this._measures=i,t===null?this._coordinates=new Array(0).fill(null):this._coordinates=t}else if(Number.isInteger(arguments[2])&&Number.isInteger(arguments[0])&&Number.isInteger(arguments[1])){const t=arguments[0],e=arguments[1],i=arguments[2];this._coordinates=new Array(t).fill(null),this._dimension=e,this._measures=i;for(let n=0;n<t;n++)this._coordinates[n]=this.createCoordinate()}}}getCoordinate(){if(arguments.length===1){const t=arguments[0];return this._coordinates[t]}else if(arguments.length===2){const t=arguments[0];arguments[1].setCoordinate(this._coordinates[t])}}getCoordinateCopy(t){const e=this.createCoordinate();return e.setCoordinate(this._coordinates[t]),e}createCoordinate(){return zn.create(this.getDimension(),this.getMeasures())}getDimension(){return this._dimension}getX(t){return this._coordinates[t].x}getMeasures(){return this._measures}expandEnvelope(t){for(let e=0;e<this._coordinates.length;e++)t.expandToInclude(this._coordinates[e]);return t}copy(){const t=new Array(this.size()).fill(null);for(let e=0;e<this._coordinates.length;e++){const i=this.createCoordinate();i.setCoordinate(this._coordinates[e]),t[e]=i}return new oi(t,this._dimension,this._measures)}toString(){if(this._coordinates.length>0){const t=new op(17*this._coordinates.length);t.append("("),t.append(this._coordinates[0]);for(let e=1;e<this._coordinates.length;e++)t.append(", "),t.append(this._coordinates[e]);return t.append(")"),t.toString()}else return"()"}getY(t){return this._coordinates[t].y}toCoordinateArray(){return this._coordinates}getM(t){return this.hasM()?this._coordinates[t].getM():st.NaN}setOrdinate(t,e,i){switch(e){case ht.X:this._coordinates[t].x=i;break;case ht.Y:this._coordinates[t].y=i;break;default:this._coordinates[t].setOrdinate(e,i)}}getZ(t){return this.hasZ()?this._coordinates[t].getZ():st.NaN}size(){return this._coordinates.length}getOrdinate(t,e){switch(e){case ht.X:return this._coordinates[t].x;case ht.Y:return this._coordinates[t].y;default:return this._coordinates[t].getOrdinate(e)}}get interfaces_(){return[ht,_i]}}class Yn{static instance(){return Yn.instanceObject}readResolve(){return Yn.instance()}create(){if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return new oi(t)}else if(dt(arguments[0],ht)){const t=arguments[0];return new oi(t)}}else if(arguments.length===2){let t=arguments[0],e=arguments[1];return e>3&&(e=3),e<2&&(e=2),new oi(t,e)}else if(arguments.length===3){let t=arguments[0],e=arguments[1],i=arguments[2],n=e-i;return i>1&&(i=1),n>3&&(n=3),n<2&&(n=2),new oi(t,n+i,i)}}get interfaces_(){return[id,_i]}}Yn.instanceObject=new Yn;let nd=class extends on{contains(){}};class ap extends nd{}class jh extends ap{constructor(t){super(),this.array=[],t instanceof on&&this.addAll(t)}contains(t){for(const e of this.array)if(e.compareTo(t)===0)return!0;return!1}add(t){if(this.contains(t))return!1;for(let e=0,i=this.array.length;e<i;e++)if(this.array[e].compareTo(t)===1)return!!this.array.splice(e,0,t);return this.array.push(t),!0}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new Xi}size(){return this.array.length}isEmpty(){return this.array.length===0}toArray(){return this.array.slice()}iterator(){return new lp(this.array)}}let lp=class{constructor(t){this.array=t,this.position=0}next(){if(this.position===this.array.length)throw new js;return this.array[this.position++]}hasNext(){return this.position<this.array.length}remove(){throw new Xi}};class Cr{static sort(){const t=arguments[0];if(arguments.length===1)t.sort((e,i)=>e.compareTo(i));else if(arguments.length===2)t.sort((e,i)=>arguments[1].compare(e,i));else if(arguments.length===3){const e=t.slice(arguments[1],arguments[2]);e.sort();const i=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const n of i)t.push(n)}else if(arguments.length===4){const e=t.slice(arguments[1],arguments[2]);e.sort((n,r)=>arguments[3].compare(n,r));const i=t.slice(0,arguments[1]).concat(e,t.slice(arguments[2],t.length));t.splice(0,t.length);for(const n of i)t.push(n)}}static asList(t){const e=new Zs;for(const i of t)e.add(i);return e}static copyOf(t,e){return t.slice(0,e)}}class Te extends V{constructor(){super(),Te.constructor_.apply(this,arguments)}static constructor_(){if(this._geometries=null,arguments.length!==0){if(arguments.length===2){let t=arguments[0],e=arguments[1];if(V.constructor_.call(this,e),t===null&&(t=[]),V.hasNullElements(t))throw new xt("geometries must not contain null elements");this._geometries=t}}}computeEnvelopeInternal(){const t=new Ft;for(let e=0;e<this._geometries.length;e++)t.expandToInclude(this._geometries[e].getEnvelopeInternal());return t}getGeometryN(t){return this._geometries[t]}getCoordinates(){const t=new Array(this.getNumPoints()).fill(null);let e=-1;for(let i=0;i<this._geometries.length;i++){const n=this._geometries[i].getCoordinates();for(let r=0;r<n.length;r++)e++,t[e]=n[r]}return t}getArea(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getArea();return t}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Te(t,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const i=t;if(this._geometries.length!==i._geometries.length)return!1;for(let n=0;n<this._geometries.length;n++)if(!this._geometries[n].equalsExact(i._geometries[n],e))return!1;return!0}else return super.equalsExact.apply(this,arguments)}reverseInternal(){const t=this._geometries.length,e=new Zs(t);for(let i=0;i<t;i++)e.add(this._geometries[i].reverse());return this.getFactory().buildGeometry(e)}getTypeCode(){return V.TYPECODE_GEOMETRYCOLLECTION}getDimension(){let t=$.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getDimension());return t}getNumGeometries(){return this._geometries.length}getBoundary(){return V.checkNotGeometryCollection(this),Oi.shouldNeverReachHere(),null}getGeometryType(){return V.TYPENAME_GEOMETRYCOLLECTION}isEmpty(){for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isEmpty())return!1;return!0}normalize(){for(let t=0;t<this._geometries.length;t++)this._geometries[t].normalize();Cr.sort(this._geometries)}getCoordinate(){return this.isEmpty()?null:this._geometries[0].getCoordinate()}getBoundaryDimension(){let t=$.FALSE;for(let e=0;e<this._geometries.length;e++)t=Math.max(t,this._geometries[e].getBoundaryDimension());return t}getLength(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getLength();return t}getNumPoints(){let t=0;for(let e=0;e<this._geometries.length;e++)t+=this._geometries[e].getNumPoints();return t}compareToSameClass(){if(arguments.length===1){const t=arguments[0],e=new jh(Cr.asList(this._geometries)),i=new jh(Cr.asList(t._geometries));return this.compare(e,i)}else if(arguments.length===2){const t=arguments[0],e=arguments[1],i=t,n=this.getNumGeometries(),r=i.getNumGeometries();let o=0;for(;o<n&&o<r;){const a=this.getGeometryN(o),l=i.getGeometryN(o),h=a.compareToSameClass(l,e);if(h!==0)return h;o++}return o<n?1:o<r?-1:0}}apply(){if(dt(arguments[0],ao)){const t=arguments[0];for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(dt(arguments[0],ho)){const t=arguments[0];if(this._geometries.length===0)return null;for(let e=0;e<this._geometries.length&&(this._geometries[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(dt(arguments[0],lo)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}else if(dt(arguments[0],Ws)){const t=arguments[0];t.filter(this);for(let e=0;e<this._geometries.length;e++)this._geometries[e].apply(t)}}}class sd{}class Ls extends Te{constructor(){super(),Ls.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Te.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Ls(t,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];return this.isEquivalentClass(t)?super.equalsExact.call(this,t,e):!1}else return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return 1}getTypeCode(){return V.TYPECODE_MULTIPOLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Zs;for(let i=0;i<this._geometries.length;i++){const r=this._geometries[i].getBoundary();for(let o=0;o<r.getNumGeometries();o++)t.add(r.getGeometryN(o))}const e=new Array(t.size()).fill(null);return this.getFactory().createMultiLineString(t.toArray(e))}getGeometryType(){return V.TYPENAME_MULTIPOLYGON}get interfaces_(){return[sd]}}let hp=class{get(){}put(){}size(){}values(){}entrySet(){}};class cp extends nd{constructor(t){super(),this.map=new Map,t instanceof on&&this.addAll(t)}contains(t){const e=t.hashCode?t.hashCode():t;return!!this.map.has(e)}add(t){const e=t.hashCode?t.hashCode():t;return this.map.has(e)?!1:!!this.map.set(e,t)}addAll(t){for(const e of t)this.add(e);return!0}remove(){throw new Xi}size(){return this.map.size}isEmpty(){return this.map.size===0}toArray(){return Array.from(this.map.values())}iterator(){return new up(this.map)}[Symbol.iterator](){return this.map}}class up{constructor(t){this.iterator=t.values();const{done:e,value:i}=this.iterator.next();this.done=e,this.value=i}next(){if(this.done)throw new js;const t=this.value,{done:e,value:i}=this.iterator.next();return this.done=e,this.value=i,t}hasNext(){return!this.done}remove(){throw new Xi}}class dp extends hp{constructor(){super(),this.map=new Map}get(t){return this.map.get(t)||null}put(t,e){return this.map.set(t,e),e}values(){const t=new Zs,e=this.map.values();let i=e.next();for(;!i.done;)t.add(i.value),i=e.next();return t}entrySet(){const t=new cp;return this.map.entries().forEach(e=>t.add(e)),t}size(){return this.map.size()}}class co{constructor(t){this.value=t}intValue(){return this.value}compareTo(t){return this.value<t?-1:this.value>t?1:0}static compare(t,e){return t<e?-1:t>e?1:0}static isNan(t){return Number.isNaN(t)}static valueOf(t){return new co(t)}}class pt{constructor(){pt.constructor_.apply(this,arguments)}static constructor_(){if(this._modelType=null,this._scale=null,arguments.length===0)this._modelType=pt.FLOATING;else if(arguments.length===1){if(arguments[0]instanceof Ze){const t=arguments[0];this._modelType=t,t===pt.FIXED&&this.setScale(1)}else if(typeof arguments[0]=="number"){const t=arguments[0];this._modelType=pt.FIXED,this.setScale(t)}else if(arguments[0]instanceof pt){const t=arguments[0];this._modelType=t._modelType,this._scale=t._scale}}}static mostPrecise(t,e){return t.compareTo(e)>=0?t:e}equals(t){if(!(t instanceof pt))return!1;const e=t;return this._modelType===e._modelType&&this._scale===e._scale}compareTo(t){const e=t,i=this.getMaximumSignificantDigits(),n=e.getMaximumSignificantDigits();return co.compare(i,n)}getType(){return this._modelType}toString(){let t="UNKNOWN";return this._modelType===pt.FLOATING?t="Floating":this._modelType===pt.FLOATING_SINGLE?t="Floating-Single":this._modelType===pt.FIXED&&(t="Fixed (Scale="+this.getScale()+")"),t}makePrecise(){if(typeof arguments[0]=="number"){const t=arguments[0];return st.isNaN(t)||this._modelType===pt.FLOATING_SINGLE?t:this._modelType===pt.FIXED?Math.round(t*this._scale)/this._scale:t}else if(arguments[0]instanceof U){const t=arguments[0];if(this._modelType===pt.FLOATING)return null;t.x=this.makePrecise(t.x),t.y=this.makePrecise(t.y)}}getMaximumSignificantDigits(){let t=16;return this._modelType===pt.FLOATING?t=16:this._modelType===pt.FLOATING_SINGLE?t=6:this._modelType===pt.FIXED&&(t=1+Math.trunc(Math.ceil(Math.log(this.getScale())/Math.log(10)))),t}setScale(t){this._scale=Math.abs(t)}getScale(){return this._scale}isFloating(){return this._modelType===pt.FLOATING||this._modelType===pt.FLOATING_SINGLE}get interfaces_(){return[_i,Ks]}}class Ze{constructor(){Ze.constructor_.apply(this,arguments)}static constructor_(){this._name=null;const t=arguments[0];this._name=t,Ze.nameToTypeMap.put(t,this)}readResolve(){return Ze.nameToTypeMap.get(this._name)}toString(){return this._name}get interfaces_(){return[_i]}}Ze.nameToTypeMap=new dp;pt.Type=Ze;pt.FIXED=new Ze("FIXED");pt.FLOATING=new Ze("FLOATING");pt.FLOATING_SINGLE=new Ze("FLOATING SINGLE");pt.maximumPreciseValue=9007199254740992;class Ms extends Te{constructor(){super(),Ms.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Te.constructor_.call(this,t,e)}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Ms(t,this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];return this.isEquivalentClass(t)?super.equalsExact.call(this,t,e):!1}else return super.equalsExact.apply(this,arguments)}getBoundaryDimension(){return this.isClosed()?$.FALSE:0}isClosed(){if(this.isEmpty())return!1;for(let t=0;t<this._geometries.length;t++)if(!this._geometries[t].isClosed())return!1;return!0}getTypeCode(){return V.TYPECODE_MULTILINESTRING}getDimension(){return 1}getBoundary(){throw new Xi}getGeometryType(){return V.TYPENAME_MULTILINESTRING}get interfaces_(){return[ed]}}class rd{}class Ps extends Ui{constructor(t){super(t),this.name=Object.keys({IllegalStateException:Ps})[0]}}class Fs extends V{constructor(){super(),Fs.constructor_.apply(this,arguments)}static constructor_(){this._coordinates=null;const t=arguments[0],e=arguments[1];V.constructor_.call(this,e),this.init(t)}computeEnvelopeInternal(){if(this.isEmpty())return new Ft;const t=new Ft;return t.expandToInclude(this._coordinates.getX(0),this._coordinates.getY(0)),t}getCoordinates(){return this.isEmpty()?[]:[this.getCoordinate()]}copyInternal(){return new Fs(this._coordinates.copy(),this._factory)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];return this.isEquivalentClass(t)?this.isEmpty()&&t.isEmpty()?!0:this.isEmpty()!==t.isEmpty()?!1:this.equal(t.getCoordinate(),this.getCoordinate(),e):!1}else return super.equalsExact.apply(this,arguments)}reverseInternal(){return this.getFactory().createPoint(this._coordinates.copy())}getTypeCode(){return V.TYPECODE_POINT}getDimension(){return 0}getNumPoints(){return this.isEmpty()?0:1}getX(){if(this.getCoordinate()===null)throw new Ps("getX called on empty Point");return this.getCoordinate().x}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return V.TYPENAME_POINT}getCoordinateSequence(){return this._coordinates}getY(){if(this.getCoordinate()===null)throw new Ps("getY called on empty Point");return this.getCoordinate().y}isSimple(){return!0}normalize(){}getCoordinate(){return this._coordinates.size()!==0?this._coordinates.getCoordinate(0):null}getBoundaryDimension(){return $.FALSE}compareToSameClass(){if(arguments.length===1){const e=arguments[0];return this.getCoordinate().compareTo(e.getCoordinate())}else if(arguments.length===2){const t=arguments[0],e=arguments[1],i=t;return e.compare(this._coordinates,i._coordinates)}}apply(){if(dt(arguments[0],ao)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this.getCoordinate())}else if(dt(arguments[0],ho)){const t=arguments[0];if(this.isEmpty())return null;t.filter(this._coordinates,0),t.isGeometryChanged()&&this.geometryChanged()}else dt(arguments[0],lo)?arguments[0].filter(this):dt(arguments[0],Ws)&&arguments[0].filter(this)}isEmpty(){return this._coordinates.size()===0}init(t){t===null&&(t=this.getFactory().getCoordinateSequenceFactory().create([])),Oi.isTrue(t.size()<=1),this._coordinates=t}get interfaces_(){return[rd]}}class bs{static ofRingSigned(){if(arguments[0]instanceof Array){const t=arguments[0];if(t.length<3)return 0;let e=0;const i=t[0].x;for(let n=1;n<t.length-1;n++){const r=t[n].x-i,o=t[n+1].y,a=t[n-1].y;e+=r*(a-o)}return e/2}else if(dt(arguments[0],ht)){const t=arguments[0],e=t.size();if(e<3)return 0;const i=new U,n=new U,r=new U;t.getCoordinate(0,n),t.getCoordinate(1,r);const o=n.x;r.x-=o;let a=0;for(let l=1;l<e-1;l++)i.y=n.y,n.x=r.x,n.y=r.y,t.getCoordinate(l+1,r),r.x-=o,a+=n.x*(i.y-r.y);return a/2}}static ofRing(){if(arguments[0]instanceof Array){const t=arguments[0];return Math.abs(bs.ofRingSigned(t))}else if(dt(arguments[0],ht)){const t=arguments[0];return Math.abs(bs.ofRingSigned(t))}}}class Zh{constructor(t){this.str=t}append(t){this.str+=t}setCharAt(t,e){this.str=this.str.substr(0,t)+e+this.str.substr(t+1)}toString(){return this.str}}class N{constructor(){N.constructor_.apply(this,arguments)}static constructor_(){if(this._hi=0,this._lo=0,arguments.length===0)this.init(0);else if(arguments.length===1){if(typeof arguments[0]=="number"){const t=arguments[0];this.init(t)}else if(arguments[0]instanceof N){const t=arguments[0];this.init(t)}else if(typeof arguments[0]=="string"){const t=arguments[0];N.constructor_.call(this,N.parse(t))}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];this.init(t,e)}}static determinant(){if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];return N.determinant(N.valueOf(t),N.valueOf(e),N.valueOf(i),N.valueOf(n))}else if(arguments[3]instanceof N&&arguments[2]instanceof N&&arguments[0]instanceof N&&arguments[1]instanceof N){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];return t.multiply(n).selfSubtract(e.multiply(i))}}static sqr(t){return N.valueOf(t).selfMultiply(t)}static valueOf(){if(typeof arguments[0]=="string"){const t=arguments[0];return N.parse(t)}else if(typeof arguments[0]=="number"){const t=arguments[0];return new N(t)}}static sqrt(t){return N.valueOf(t).sqrt()}static parse(t){let e=0;const i=t.length;for(;Ia.isWhitespace(t.charAt(e));)e++;let n=!1;if(e<i){const d=t.charAt(e);(d==="-"||d==="+")&&(e++,d==="-"&&(n=!0))}const r=new N;let o=0,a=0,l=0,h=!1;for(;!(e>=i);){const d=t.charAt(e);if(e++,Ia.isDigit(d)){const f=d-"0";r.selfMultiply(N.TEN),r.selfAdd(f),o++;continue}if(d==="."){a=o,h=!0;continue}if(d==="e"||d==="E"){const f=t.substring(e);try{l=co.parseInt(f)}catch(m){throw m instanceof NumberFormatException?new NumberFormatException("Invalid exponent "+f+" in string "+t):m}finally{}break}throw new NumberFormatException("Unexpected character '"+d+"' at position "+e+" in string "+t)}let c=r;h||(a=o);const u=o-a-l;if(u===0)c=r;else if(u>0){const d=N.TEN.pow(u);c=r.divide(d)}else if(u<0){const d=N.TEN.pow(-u);c=r.multiply(d)}return n?c.negate():c}static createNaN(){return new N(st.NaN,st.NaN)}static copy(t){return new N(t)}static magnitude(t){const e=Math.abs(t),i=Math.log(e)/Math.log(10);let n=Math.trunc(Math.floor(i));return Math.pow(10,n)*10<=e&&(n+=1),n}static stringOfChar(t,e){const i=new Zh;for(let n=0;n<e;n++)i.append(t);return i.toString()}le(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<=t._lo}extractSignificantDigits(t,e){let i=this.abs(),n=N.magnitude(i._hi);const r=N.TEN.pow(n);i=i.divide(r),i.gt(N.TEN)?(i=i.divide(N.TEN),n+=1):i.lt(N.ONE)&&(i=i.multiply(N.TEN),n-=1);const o=n+1,a=new Zh,l=N.MAX_PRINT_DIGITS-1;for(let h=0;h<=l;h++){t&&h===o&&a.append(".");const c=Math.trunc(i._hi);if(c<0)break;let u=!1,d=0;c>9?(u=!0,d="9"):d="0"+c,a.append(d),i=i.subtract(N.valueOf(c)).multiply(N.TEN),u&&i.selfAdd(N.TEN);let f=!0;const m=N.magnitude(i._hi);if(m<0&&Math.abs(m)>=l-h&&(f=!1),!f)break}return e[0]=n,a.toString()}sqr(){return this.multiply(this)}getSpecialNumberString(){return this.isZero()?"0.0":this.isNaN()?"NaN ":null}setValue(){if(arguments[0]instanceof N){const t=arguments[0];return this.init(t),this}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.init(t),this}}multiply(){if(arguments[0]instanceof N){const t=arguments[0];return t.isNaN()?N.createNaN():N.copy(this).selfMultiply(t)}else if(typeof arguments[0]=="number"){const t=arguments[0];return st.isNaN(t)?N.createNaN():N.copy(this).selfMultiply(t,0)}}isNaN(){return st.isNaN(this._hi)}reciprocal(){let t=null,e=null,i=null,n=null,r=null,o=null,a=null,l=null;r=1/this._hi,o=N.SPLIT*r,t=o-r,l=N.SPLIT*this._hi,t=o-t,e=r-t,i=l-this._hi,a=r*this._hi,i=l-i,n=this._hi-i,l=t*i-a+t*n+e*i+e*n,o=(1-a-l-r*this._lo)/this._hi;const h=r+o,c=r-h+o;return new N(h,c)}doubleValue(){return this._hi+this._lo}subtract(){if(arguments[0]instanceof N){const t=arguments[0];return this.add(t.negate())}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.add(-t)}}equals(){if(arguments.length===1&&arguments[0]instanceof N){const t=arguments[0];return this._hi===t._hi&&this._lo===t._lo}}isZero(){return this._hi===0&&this._lo===0}selfSubtract(){if(arguments[0]instanceof N){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t._hi,-t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.isNaN()?this:this.selfAdd(-t,0)}}min(t){return this.le(t)?this:t}selfDivide(){if(arguments.length===1){if(arguments[0]instanceof N){const t=arguments[0];return this.selfDivide(t._hi,t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.selfDivide(t,0)}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];let i=null,n=null,r=null,o=null,a=null,l=null,h=null,c=null;return a=this._hi/t,l=N.SPLIT*a,i=l-a,c=N.SPLIT*t,i=l-i,n=a-i,r=c-t,h=a*t,r=c-r,o=t-r,c=i*r-h+i*o+n*r+n*o,l=(this._hi-h-c+this._lo-a*e)/t,c=a+l,this._hi=c,this._lo=a-c+l,this}}dump(){return"DD<"+this._hi+", "+this._lo+">"}divide(){if(arguments[0]instanceof N){const t=arguments[0];let e=null,i=null,n=null,r=null,o=null,a=null,l=null,h=null;o=this._hi/t._hi,a=N.SPLIT*o,e=a-o,h=N.SPLIT*t._hi,e=a-e,i=o-e,n=h-t._hi,l=o*t._hi,n=h-n,r=t._hi-n,h=e*n-l+e*r+i*n+i*r,a=(this._hi-l-h+this._lo-o*t._lo)/t._hi,h=o+a;const c=h,u=o-h+a;return new N(c,u)}else if(typeof arguments[0]=="number"){const t=arguments[0];return st.isNaN(t)?N.createNaN():N.copy(this).selfDivide(t,0)}}ge(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>=t._lo}pow(t){if(t===0)return N.valueOf(1);let e=new N(this),i=N.valueOf(1),n=Math.abs(t);if(n>1)for(;n>0;)n%2===1&&i.selfMultiply(e),n/=2,n>0&&(e=e.sqr());else i=e;return t<0?i.reciprocal():i}ceil(){if(this.isNaN())return N.NaN;const t=Math.ceil(this._hi);let e=0;return t===this._hi&&(e=Math.ceil(this._lo)),new N(t,e)}compareTo(t){const e=t;return this._hi<e._hi?-1:this._hi>e._hi?1:this._lo<e._lo?-1:this._lo>e._lo?1:0}rint(){return this.isNaN()?this:this.add(.5).floor()}max(t){return this.ge(t)?this:t}sqrt(){if(this.isZero())return N.valueOf(0);if(this.isNegative())return N.NaN;const t=1/Math.sqrt(this._hi),e=this._hi*t,i=N.valueOf(e),r=this.subtract(i.sqr())._hi*(t*.5);return i.add(r)}selfAdd(){if(arguments.length===1){if(arguments[0]instanceof N){const t=arguments[0];return this.selfAdd(t._hi,t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];let e=null,i=null,n=null,r=null,o=null,a=null;return n=this._hi+t,o=n-this._hi,r=n-o,r=t-o+(this._hi-r),a=r+this._lo,e=n+a,i=a+(n-e),this._hi=e+i,this._lo=i+(e-this._hi),this}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];let i=null,n=null,r=null,o=null,a=null,l=null,h=null,c=null;a=this._hi+t,r=this._lo+e,h=a-this._hi,c=r-this._lo,l=a-h,o=r-c,l=t-h+(this._hi-l),o=e-c+(this._lo-o),h=l+r,i=a+h,n=h+(a-i),h=o+n;const u=i+h,d=h+(i-u);return this._hi=u,this._lo=d,this}}selfMultiply(){if(arguments.length===1){if(arguments[0]instanceof N){const t=arguments[0];return this.selfMultiply(t._hi,t._lo)}else if(typeof arguments[0]=="number"){const t=arguments[0];return this.selfMultiply(t,0)}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];let i=null,n=null,r=null,o=null,a=null,l=null;a=N.SPLIT*this._hi,i=a-this._hi,l=N.SPLIT*t,i=a-i,n=this._hi-i,r=l-t,a=this._hi*t,r=l-r,o=t-r,l=i*r-a+i*o+n*r+n*o+(this._hi*e+this._lo*t);const h=a+l;i=a-h;const c=l+i;return this._hi=h,this._lo=c,this}}selfSqr(){return this.selfMultiply(this)}floor(){if(this.isNaN())return N.NaN;const t=Math.floor(this._hi);let e=0;return t===this._hi&&(e=Math.floor(this._lo)),new N(t,e)}negate(){return this.isNaN()?this:new N(-this._hi,-this._lo)}clone(){try{return null}catch(t){if(t instanceof CloneNotSupportedException)return null;throw t}finally{}}intValue(){return Math.trunc(this._hi)}toString(){const t=N.magnitude(this._hi);return t>=-3&&t<=20?this.toStandardNotation():this.toSciNotation()}toStandardNotation(){const t=this.getSpecialNumberString();if(t!==null)return t;const e=new Array(1).fill(null),i=this.extractSignificantDigits(!0,e),n=e[0]+1;let r=i;if(i.charAt(0)===".")r="0"+i;else if(n<0)r="0."+N.stringOfChar("0",-n)+i;else if(i.indexOf(".")===-1){const o=n-i.length,a=N.stringOfChar("0",o);r=i+a+".0"}return this.isNegative()?"-"+r:r}toSciNotation(){if(this.isZero())return N.SCI_NOT_ZERO;const t=this.getSpecialNumberString();if(t!==null)return t;const e=new Array(1).fill(null),i=this.extractSignificantDigits(!1,e),n=N.SCI_NOT_EXPONENT_CHAR+e[0];if(i.charAt(0)==="0")throw new Ps("Found leading zero: "+i);let r="";i.length>1&&(r=i.substring(1));const o=i.charAt(0)+"."+r;return this.isNegative()?"-"+o+n:o+n}abs(){return this.isNaN()?N.NaN:this.isNegative()?this.negate():new N(this)}isPositive(){return this._hi>0||this._hi===0&&this._lo>0}lt(t){return this._hi<t._hi||this._hi===t._hi&&this._lo<t._lo}add(){if(arguments[0]instanceof N){const t=arguments[0];return N.copy(this).selfAdd(t)}else if(typeof arguments[0]=="number"){const t=arguments[0];return N.copy(this).selfAdd(t)}}init(){if(arguments.length===1){if(typeof arguments[0]=="number"){const t=arguments[0];this._hi=t,this._lo=0}else if(arguments[0]instanceof N){const t=arguments[0];this._hi=t._hi,this._lo=t._lo}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];this._hi=t,this._lo=e}}gt(t){return this._hi>t._hi||this._hi===t._hi&&this._lo>t._lo}isNegative(){return this._hi<0||this._hi===0&&this._lo<0}trunc(){return this.isNaN()?N.NaN:this.isPositive()?this.floor():this.ceil()}signum(){return this._hi>0?1:this._hi<0?-1:this._lo>0?1:this._lo<0?-1:0}get interfaces_(){return[_i,Ks,oo]}}N.PI=new N(3.141592653589793,12246467991473532e-32);N.TWO_PI=new N(6.283185307179586,24492935982947064e-32);N.PI_2=new N(1.5707963267948966,6123233995736766e-32);N.E=new N(2.718281828459045,14456468917292502e-32);N.NaN=new N(st.NaN,st.NaN);N.EPS=123259516440783e-46;N.SPLIT=134217729;N.MAX_PRINT_DIGITS=32;N.TEN=N.valueOf(10);N.ONE=N.valueOf(1);N.SCI_NOT_EXPONENT_CHAR="E";N.SCI_NOT_ZERO="0.0E0";class ri{static orientationIndex(t,e,i){const n=ri.orientationIndexFilter(t,e,i);if(n<=1)return n;const r=N.valueOf(e.x).selfAdd(-t.x),o=N.valueOf(e.y).selfAdd(-t.y),a=N.valueOf(i.x).selfAdd(-e.x),l=N.valueOf(i.y).selfAdd(-e.y);return r.selfMultiply(l).selfSubtract(o.selfMultiply(a)).signum()}static signOfDet2x2(){if(arguments[3]instanceof N&&arguments[2]instanceof N&&arguments[0]instanceof N&&arguments[1]instanceof N){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3];return t.multiply(n).selfSubtract(e.multiply(i)).signum()}else if(typeof arguments[3]=="number"&&typeof arguments[2]=="number"&&typeof arguments[0]=="number"&&typeof arguments[1]=="number"){const t=arguments[0],e=arguments[1],i=arguments[2],n=arguments[3],r=N.valueOf(t),o=N.valueOf(e),a=N.valueOf(i),l=N.valueOf(n);return r.multiply(l).selfSubtract(o.multiply(a)).signum()}}static intersection(t,e,i,n){const r=new N(t.y).selfSubtract(e.y),o=new N(e.x).selfSubtract(t.x),a=new N(t.x).selfMultiply(e.y).selfSubtract(new N(e.x).selfMultiply(t.y)),l=new N(i.y).selfSubtract(n.y),h=new N(n.x).selfSubtract(i.x),c=new N(i.x).selfMultiply(n.y).selfSubtract(new N(n.x).selfMultiply(i.y)),u=o.multiply(c).selfSubtract(h.multiply(a)),d=l.multiply(a).selfSubtract(r.multiply(c)),f=r.multiply(h).selfSubtract(l.multiply(o)),m=u.selfDivide(f).doubleValue(),p=d.selfDivide(f).doubleValue();return st.isNaN(m)||st.isInfinite(m)||st.isNaN(p)||st.isInfinite(p)?null:new U(m,p)}static orientationIndexFilter(t,e,i){let n=null;const r=(t.x-i.x)*(e.y-i.y),o=(t.y-i.y)*(e.x-i.x),a=r-o;if(r>0){if(o<=0)return ri.signum(a);n=r+o}else if(r<0){if(o>=0)return ri.signum(a);n=-r-o}else return ri.signum(a);const l=ri.DP_SAFE_EPSILON*n;return a>=l||-a>=l?ri.signum(a):2}static signum(t){return t>0?1:t<0?-1:0}}ri.DP_SAFE_EPSILON=1e-15;class de{static isCCW(){if(arguments[0]instanceof Array){const t=arguments[0],e=t.length-1;if(e<3)throw new xt("Ring has fewer than 4 points, so orientation cannot be determined");let i=t[0],n=0;for(let u=1;u<=e;u++){const d=t[u];d.y>i.y&&(i=d,n=u)}let r=n;do r=r-1,r<0&&(r=e);while(t[r].equals2D(i)&&r!==n);let o=n;do o=(o+1)%e;while(t[o].equals2D(i)&&o!==n);const a=t[r],l=t[o];if(a.equals2D(i)||l.equals2D(i)||a.equals2D(l))return!1;const h=de.index(a,i,l);let c=null;return h===0?c=a.x>l.x:c=h>0,c}else if(dt(arguments[0],ht)){const t=arguments[0],e=t.size()-1;if(e<3)throw new xt("Ring has fewer than 4 points, so orientation cannot be determined");let i=t.getCoordinate(0),n=0;for(let u=1;u<=e;u++){const d=t.getCoordinate(u);d.y>i.y&&(i=d,n=u)}let r=null,o=n;do o=o-1,o<0&&(o=e),r=t.getCoordinate(o);while(r.equals2D(i)&&o!==n);let a=null,l=n;do l=(l+1)%e,a=t.getCoordinate(l);while(a.equals2D(i)&&l!==n);if(r.equals2D(i)||a.equals2D(i)||r.equals2D(a))return!1;const h=de.index(r,i,a);let c=null;return h===0?c=r.x>a.x:c=h>0,c}}static index(t,e,i){return ri.orientationIndex(t,e,i)}}de.CLOCKWISE=-1;de.RIGHT=de.CLOCKWISE;de.COUNTERCLOCKWISE=1;de.LEFT=de.COUNTERCLOCKWISE;de.COLLINEAR=0;de.STRAIGHT=de.COLLINEAR;class Os extends V{constructor(){super(),Os.constructor_.apply(this,arguments)}static constructor_(){this._shell=null,this._holes=null;let t=arguments[0],e=arguments[1],i=arguments[2];if(V.constructor_.call(this,i),t===null&&(t=this.getFactory().createLinearRing()),e===null&&(e=[]),V.hasNullElements(e))throw new xt("holes must not contain null elements");if(t.isEmpty()&&V.hasNonEmptyElements(e))throw new xt("shell is empty but holes are not");this._shell=t,this._holes=e}computeEnvelopeInternal(){return this._shell.getEnvelopeInternal()}getCoordinates(){if(this.isEmpty())return[];const t=new Array(this.getNumPoints()).fill(null);let e=-1;const i=this._shell.getCoordinates();for(let n=0;n<i.length;n++)e++,t[e]=i[n];for(let n=0;n<this._holes.length;n++){const r=this._holes[n].getCoordinates();for(let o=0;o<r.length;o++)e++,t[e]=r[o]}return t}getArea(){let t=0;t+=bs.ofRing(this._shell.getCoordinateSequence());for(let e=0;e<this._holes.length;e++)t-=bs.ofRing(this._holes[e].getCoordinateSequence());return t}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];if(!this.isEquivalentClass(t))return!1;const i=t,n=this._shell,r=i._shell;if(!n.equalsExact(r,e)||this._holes.length!==i._holes.length)return!1;for(let o=0;o<this._holes.length;o++)if(!this._holes[o].equalsExact(i._holes[o],e))return!1;return!0}else return super.equalsExact.apply(this,arguments)}reverseInternal(){const t=this.getExteriorRing().reverse(),e=new Array(this.getNumInteriorRing()).fill(null);for(let i=0;i<e.length;i++)e[i]=this.getInteriorRingN(i).reverse();return this.getFactory().createPolygon(t,e)}getTypeCode(){return V.TYPECODE_POLYGON}getDimension(){return 2}getBoundary(){if(this.isEmpty())return this.getFactory().createMultiLineString();const t=new Array(this._holes.length+1).fill(null);t[0]=this._shell;for(let e=0;e<this._holes.length;e++)t[e+1]=this._holes[e];return t.length<=1?this.getFactory().createLinearRing(t[0].getCoordinateSequence()):this.getFactory().createMultiLineString(t)}getGeometryType(){return V.TYPENAME_POLYGON}getExteriorRing(){return this._shell}copyInternal(){const t=this._shell.copy(),e=new Array(this._holes.length).fill(null);for(let i=0;i<this._holes.length;i++)e[i]=this._holes[i].copy();return new Os(t,e,this._factory)}isRectangle(){if(this.getNumInteriorRing()!==0||this._shell===null||this._shell.getNumPoints()!==5)return!1;const t=this._shell.getCoordinateSequence(),e=this.getEnvelopeInternal();for(let r=0;r<5;r++){const o=t.getX(r);if(!(o===e.getMinX()||o===e.getMaxX()))return!1;const a=t.getY(r);if(!(a===e.getMinY()||a===e.getMaxY()))return!1}let i=t.getX(0),n=t.getY(0);for(let r=1;r<=4;r++){const o=t.getX(r),a=t.getY(r);if(o!==i===(a!==n))return!1;i=o,n=a}return!0}normalize(){if(arguments.length===0){this._shell=this.normalized(this._shell,!0);for(let t=0;t<this._holes.length;t++)this._holes[t]=this.normalized(this._holes[t],!1);Cr.sort(this._holes)}else if(arguments.length===2){const t=arguments[0],e=arguments[1];if(t.isEmpty())return null;const i=t.getCoordinateSequence(),n=It.minCoordinateIndex(i,0,i.size()-2);It.scroll(i,n,!0),de.isCCW(i)===e&&It.reverse(i)}}getCoordinate(){return this._shell.getCoordinate()}getNumInteriorRing(){return this._holes.length}getBoundaryDimension(){return 1}getLength(){let t=0;t+=this._shell.getLength();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getLength();return t}getNumPoints(){let t=this._shell.getNumPoints();for(let e=0;e<this._holes.length;e++)t+=this._holes[e].getNumPoints();return t}convexHull(){return this.getExteriorRing().convexHull()}normalized(t,e){const i=t.copy();return this.normalize(i,e),i}compareToSameClass(){if(arguments.length===1){const t=arguments[0],e=this._shell,i=t._shell;return e.compareToSameClass(i)}else if(arguments.length===2){const t=arguments[0],e=arguments[1],i=t,n=this._shell,r=i._shell,o=n.compareToSameClass(r,e);if(o!==0)return o;const a=this.getNumInteriorRing(),l=i.getNumInteriorRing();let h=0;for(;h<a&&h<l;){const c=this.getInteriorRingN(h),u=i.getInteriorRingN(h),d=c.compareToSameClass(u,e);if(d!==0)return d;h++}return h<a?1:h<l?-1:0}}apply(){if(dt(arguments[0],ao)){const t=arguments[0];this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}else if(dt(arguments[0],ho)){const t=arguments[0];if(this._shell.apply(t),!t.isDone())for(let e=0;e<this._holes.length&&(this._holes[e].apply(t),!t.isDone());e++);t.isGeometryChanged()&&this.geometryChanged()}else if(dt(arguments[0],lo))arguments[0].filter(this);else if(dt(arguments[0],Ws)){const t=arguments[0];t.filter(this),this._shell.apply(t);for(let e=0;e<this._holes.length;e++)this._holes[e].apply(t)}}isEmpty(){return this._shell.isEmpty()}getInteriorRingN(t){return this._holes[t]}get interfaces_(){return[sd]}}class Ns extends Te{constructor(){super(),Ns.constructor_.apply(this,arguments)}static constructor_(){const t=arguments[0],e=arguments[1];Te.constructor_.call(this,t,e)}equalsExact(){if(arguments.length===2&&typeof arguments[1]=="number"&&arguments[0]instanceof V){const t=arguments[0],e=arguments[1];return this.isEquivalentClass(t)?super.equalsExact.call(this,t,e):!1}else return super.equalsExact.apply(this,arguments)}getTypeCode(){return V.TYPECODE_MULTIPOINT}getDimension(){return 0}getBoundary(){return this.getFactory().createGeometryCollection()}getGeometryType(){return V.TYPENAME_MULTIPOINT}copyInternal(){const t=new Array(this._geometries.length).fill(null);for(let e=0;e<t.length;e++)t[e]=this._geometries[e].copy();return new Ns(t,this._factory)}isValid(){return!0}getCoordinate(){if(arguments.length===1&&Number.isInteger(arguments[0])){const t=arguments[0];return this._geometries[t].getCoordinate()}else return super.getCoordinate.apply(this,arguments)}getBoundaryDimension(){return $.FALSE}get interfaces_(){return[rd]}}class ee{constructor(){ee.constructor_.apply(this,arguments)}static constructor_(){if(this._precisionModel=null,this._coordinateSequenceFactory=null,this._SRID=null,arguments.length===0)ee.constructor_.call(this,new pt,0);else if(arguments.length===1){if(dt(arguments[0],id)){const t=arguments[0];ee.constructor_.call(this,new pt,0,t)}else if(arguments[0]instanceof pt){const t=arguments[0];ee.constructor_.call(this,t,0,ee.getDefaultCoordinateSequenceFactory())}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];ee.constructor_.call(this,t,e,ee.getDefaultCoordinateSequenceFactory())}else if(arguments.length===3){const t=arguments[0],e=arguments[1],i=arguments[2];this._precisionModel=t,this._coordinateSequenceFactory=i,this._SRID=e}}static toMultiPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toGeometryArray(t){if(t===null)return null;const e=new Array(t.size()).fill(null);return t.toArray(e)}static getDefaultCoordinateSequenceFactory(){return Yn.instance()}static toMultiLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLineStringArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toMultiPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toLinearRingArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPointArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static toPolygonArray(t){const e=new Array(t.size()).fill(null);return t.toArray(e)}static createPointFromInternalCoord(t,e){return e.getPrecisionModel().makePrecise(t),e.getFactory().createPoint(t)}createEmpty(t){switch(t){case-1:return this.createGeometryCollection();case 0:return this.createPoint();case 1:return this.createLineString();case 2:return this.createPolygon();default:throw new xt("Invalid dimension: "+t)}}toGeometry(t){return t.isNull()?this.createPoint():t.getMinX()===t.getMaxX()&&t.getMinY()===t.getMaxY()?this.createPoint(new U(t.getMinX(),t.getMinY())):t.getMinX()===t.getMaxX()||t.getMinY()===t.getMaxY()?this.createLineString([new U(t.getMinX(),t.getMinY()),new U(t.getMaxX(),t.getMaxY())]):this.createPolygon(this.createLinearRing([new U(t.getMinX(),t.getMinY()),new U(t.getMinX(),t.getMaxY()),new U(t.getMaxX(),t.getMaxY()),new U(t.getMaxX(),t.getMinY()),new U(t.getMinX(),t.getMinY())]),null)}createLineString(){if(arguments.length===0)return this.createLineString(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLineString(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(dt(arguments[0],ht)){const t=arguments[0];return new Ni(t,this)}}}createMultiLineString(){if(arguments.length===0)return new Ms(null,this);if(arguments.length===1){const t=arguments[0];return new Ms(t,this)}}createPolygon(){if(arguments.length===0)return this.createPolygon(null,null);if(arguments.length===1){if(dt(arguments[0],ht)){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof Array){const t=arguments[0];return this.createPolygon(this.createLinearRing(t))}else if(arguments[0]instanceof nn){const t=arguments[0];return this.createPolygon(t,null)}}else if(arguments.length===2){const t=arguments[0],e=arguments[1];return new Os(t,e,this)}}getSRID(){return this._SRID}createGeometryCollection(){if(arguments.length===0)return new Te(null,this);if(arguments.length===1){const t=arguments[0];return new Te(t,this)}}getPrecisionModel(){return this._precisionModel}createLinearRing(){if(arguments.length===0)return this.createLinearRing(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return this.createLinearRing(t!==null?this.getCoordinateSequenceFactory().create(t):null)}else if(dt(arguments[0],ht)){const t=arguments[0];return new nn(t,this)}}}createMultiPolygon(){if(arguments.length===0)return new Ls(null,this);if(arguments.length===1){const t=arguments[0];return new Ls(t,this)}}createMultiPoint(){if(arguments.length===0)return new Ns(null,this);if(arguments.length===1){if(arguments[0]instanceof Array){const t=arguments[0];return new Ns(t,this)}else if(dt(arguments[0],ht)){const t=arguments[0];if(t===null)return this.createMultiPoint(new Array(0).fill(null));const e=new Array(t.size()).fill(null);for(let i=0;i<t.size();i++){const n=this.getCoordinateSequenceFactory().create(1,t.getDimension(),t.getMeasures());It.copy(t,i,n,0,1),e[i]=this.createPoint(n)}return this.createMultiPoint(e)}}}buildGeometry(t){let e=null,i=!1,n=!1;for(let a=t.iterator();a.hasNext();){const l=a.next(),h=l.getTypeCode();e===null&&(e=h),h!==e&&(i=!0),l instanceof Te&&(n=!0)}if(e===null)return this.createGeometryCollection();if(i||n)return this.createGeometryCollection(ee.toGeometryArray(t));const r=t.iterator().next();if(t.size()>1){if(r instanceof Os)return this.createMultiPolygon(ee.toPolygonArray(t));if(r instanceof Ni)return this.createMultiLineString(ee.toLineStringArray(t));if(r instanceof Fs)return this.createMultiPoint(ee.toPointArray(t));Oi.shouldNeverReachHere("Unhandled geometry type: "+r.getGeometryType())}return r}createMultiPointFromCoords(t){return this.createMultiPoint(t!==null?this.getCoordinateSequenceFactory().create(t):null)}createPoint(){if(arguments.length===0)return this.createPoint(this.getCoordinateSequenceFactory().create([]));if(arguments.length===1){if(arguments[0]instanceof U){const t=arguments[0];return this.createPoint(t!==null?this.getCoordinateSequenceFactory().create([t]):null)}else if(dt(arguments[0],ht)){const t=arguments[0];return new Fs(t,this)}}}getCoordinateSequenceFactory(){return this._coordinateSequenceFactory}get interfaces_(){return[_i]}}function as(s){return[s.x,s.y]}class fp{constructor(t,e){this.geometryFactory=t||new ee,this.ol=e||typeof ol<"u"&&ol}inject(t,e,i,n,r,o,a,l){this.ol={geom:{Point:t,LineString:e,LinearRing:i,Polygon:n,MultiPoint:r,MultiLineString:o,MultiPolygon:a,GeometryCollection:l}}}read(t){const e=this.ol;if(t instanceof e.geom.Point)return this.convertFromPoint(t);if(t instanceof e.geom.LineString)return this.convertFromLineString(t);if(t instanceof e.geom.LinearRing)return this.convertFromLinearRing(t);if(t instanceof e.geom.Polygon)return this.convertFromPolygon(t);if(t instanceof e.geom.MultiPoint)return this.convertFromMultiPoint(t);if(t instanceof e.geom.MultiLineString)return this.convertFromMultiLineString(t);if(t instanceof e.geom.MultiPolygon)return this.convertFromMultiPolygon(t);if(t instanceof e.geom.GeometryCollection)return this.convertFromCollection(t)}convertFromPoint(t){const e=t.getCoordinates();return this.geometryFactory.createPoint(new U(e[0],e[1]))}convertFromLineString(t){return this.geometryFactory.createLineString(t.getCoordinates().map(function(e){return new U(e[0],e[1])}))}convertFromLinearRing(t){return this.geometryFactory.createLinearRing(t.getCoordinates().map(function(e){return new U(e[0],e[1])}))}convertFromPolygon(t){const e=t.getLinearRings();let i=null;const n=[];for(let r=0;r<e.length;r++){const o=this.convertFromLinearRing(e[r]);r===0?i=o:n.push(o)}return this.geometryFactory.createPolygon(i,n)}convertFromMultiPoint(t){const e=t.getPoints().map(function(i){return this.convertFromPoint(i)},this);return this.geometryFactory.createMultiPoint(e)}convertFromMultiLineString(t){const e=t.getLineStrings().map(function(i){return this.convertFromLineString(i)},this);return this.geometryFactory.createMultiLineString(e)}convertFromMultiPolygon(t){const e=t.getPolygons().map(function(i){return this.convertFromPolygon(i)},this);return this.geometryFactory.createMultiPolygon(e)}convertFromCollection(t){const e=t.getGeometries().map(function(i){return this.read(i)},this);return this.geometryFactory.createGeometryCollection(e)}write(t){if(t.getGeometryType()==="Point")return this.convertToPoint(t.getCoordinate());if(t.getGeometryType()==="LineString")return this.convertToLineString(t);if(t.getGeometryType()==="LinearRing")return this.convertToLinearRing(t);if(t.getGeometryType()==="Polygon")return this.convertToPolygon(t);if(t.getGeometryType()==="MultiPoint")return this.convertToMultiPoint(t);if(t.getGeometryType()==="MultiLineString")return this.convertToMultiLineString(t);if(t.getGeometryType()==="MultiPolygon")return this.convertToMultiPolygon(t);if(t.getGeometryType()==="GeometryCollection")return this.convertToCollection(t)}convertToPoint(t){return new this.ol.geom.Point([t.x,t.y])}convertToLineString(t){const e=t._points._coordinates.map(as);return new this.ol.geom.LineString(e)}convertToLinearRing(t){const e=t._points._coordinates.map(as);return new this.ol.geom.LinearRing(e)}convertToPolygon(t){const e=[t._shell._points._coordinates.map(as)];for(let i=0;i<t._holes.length;i++)e.push(t._holes[i]._points._coordinates.map(as));return new this.ol.geom.Polygon(e)}convertToMultiPoint(t){return new this.ol.geom.MultiPoint(t.getCoordinates().map(as))}convertToMultiLineString(t){const e=[];for(let i=0;i<t._geometries.length;i++)e.push(this.convertToLineString(t._geometries[i]).getCoordinates());return new this.ol.geom.MultiLineString(e)}convertToMultiPolygon(t){const e=[];for(let i=0;i<t._geometries.length;i++)e.push(this.convertToPolygon(t._geometries[i]).getCoordinates());return new this.ol.geom.MultiPolygon(e)}convertToCollection(t){const e=[];for(let i=0;i<t._geometries.length;i++){const n=t._geometries[i];e.push(this.write(n))}return new this.ol.geom.GeometryCollection(e)}}new Iu({source:new g0,zIndex:99});const gp=new m0({url:`${za}/wms`,params:{LAYERS:"bluedot:v3_base",FORMAT:"image/png8",TRANSPARENT:!0,TILED:!0}}),mp=new Iu({source:gp,zIndex:0,preload:1/0}),Qs=new Xe({projection:"EPSG:3857",center:Ba([126.97685,37.578019]),zoom:16,minZoom:2,maxZoom:22}),od=document.createElement("img");od.src=wm;const ad=new Uu({id:0,element:od,positioning:"center-center",stopEvent:!1}),ld=document.createElement("img");ld.src=Tm;const Ap=new Uu({id:1,element:ld,positioning:"bottom-center",stopEvent:!1,offset:[0,7]}),va=new jt(new Oe([[[-180,-90],[180,-90],[180,90],[-180,90],[-180,-90]].map(s=>Ba(s))])),_p=new Ge({features:[va]});new Be({source:_p,style:new At({fill:new Ct({color:"rgba(100, 100, 100, 0.6)"})})});const Nl=new Ge({wrapX:!1});new Be({source:Nl});const pp=new M_({source:Nl,type:"Circle"}),yp=new ee,xp=new fp(yp,null);xp.inject(ue,ci,qo,Oe,Us,Ys,Xs,Tl);const Qh=new ro;pp.on("drawend",s=>{var e;const t=s.feature;try{const i=Qh.writeFeatureObject(va);console.log(i.geometry.type);const n=i.geometry.type,r=i.geometry.coordinates,o=(e=xf(t.getGeometry()))==null?void 0:e.getCoordinates();if(!r||!o){console.error("Coordinate is undefined.");return}const a=Ea(n==="Polygon"?[r]:r),l=Ea([o]),h=tp(O_([a,l]));if(h){const c=Qh.readFeature(h);va.setGeometry(c.getGeometry()),Nl.clear()}}catch(i){console.error("Error during geometry processing:",i)}});const Ep=new Em({layers:[mp,I_,R_,__,x_,y_,p_,S_,Il],overlays:[ad,Ap],view:Qs,controls:[]});Vr.set(Ep);ln.on("setTo",hd);function hd(s){Qs.setCenter(s)}ln.on("setToCurrentPosition",()=>cd(hd));async function cd(s){const t=await Ud.getCurrentOrLastLocation();if(t){const e=Ba([t.longitude,t.latitude]);s(e),ad.setPosition(e)}else console.log("No location available")}ln.on("flyTo",ud);function ud(s){Qs.animate({center:s})}ln.on("flyToCurrentPosition",()=>cd(ud));ln.on("setZoom",Cp);function Cp(s){Qs.setZoom(s)}ln.on("addIcon",wp);function wp(s){q0(s)}ln.on("addIcons",Tp);function Tp(s){Q0(s)}function zp(s){Qs.animate(s)}export{Uu as O,Ap as a,mu as c,zp as f,Ep as m,Bi as s,Qs as v};
