import{s as oe,D as ie,i as N,f as p,e as D,a as j,t as _e,c as M,b as R,g as F,d as ge,v as m,h as w,y as z,j as Le,x as ee,S as He,C as $,n as J,q as Ce,r as xe,E as Ae,F as be,ac as Ge,B as Lt,J as Ue,z as De,A as Oe,P as Nt,R as nt,k as st,w as kl,U as Cl,G as xl,I as Il}from"./scheduler.DH3jNSXp.js";import{S as fe,i as ue,t as y,g as te,a as O,d as le,c as H,b as Z,m as G,e as W,f as Re}from"./index.DhGy8j-A.js";import{e as he,u as We,f as El,o as qt}from"./each.CFpgwcA3.js";import{A as Se,l as it}from"./store.BJaWoeSk.js";import{g as Ze}from"./entry.BhCHTBrT.js";import{p as yl}from"./stores.Dz8aN1FY.js";import{e as pe,C as Tl}from"./emitter.CkY1Q2mT.js";import{g as Xe,u as Dl}from"./searchParams.w9NG9FXL.js";/* empty css                                           *//* empty css                                                  */import{f as Ml,u as Vl}from"./follow.mTQ5C0g_.js";import{a as Me,b as jt,g as Ye,i as rt}from"./sign.Ct_yJkjS.js";import{C as Bl}from"./CircleImage.Cv_5FGVd.js";import{g as at}from"./color.C_Jm4JAr.js";import{s as ot}from"./s32cloudfront.CATw5Mi_.js";import{r as Ie}from"./units.BJZU6p1c.js";import"./ActionSheet.svelte_svelte_type_style_lang.C3IiHYzz.js";import"./index.ChFlND-f.js";import{a as Pl}from"./NavigationBar.D6YocESp.js";import{C as Ft}from"./Chip.ChStx0zK.js";import{B as Ol}from"./BottomNavigationPadder.Bx8LAw9j.js";import{I as Rl,a as Sl}from"./IconHeartFill.DnmDIDiM.js";import{l as Al}from"./longPress.C9F0mLoM.js";import{w as Ll,a as Nl}from"./Header.BJIqvESR.js";import{A as Ut}from"./ActionSheet.CYnvBFwH.js";import{M as ql}from"./Modal.Cd_i-wCv.js";import{f as jl,c as Fl,a as Ul}from"./ActionSheetReport.svelte_svelte_type_style_lang.C7Oujwle.js";import{F as Yl}from"./Figure.C0UNZFmW.js";import{I as zl}from"./IconLink.DJFKKX5L.js";function ft(n){let e,t,l,s,r,a,f=n[0].unique_name+"",i,o,u,_=String(n[0].user_idx)!==String(Me()),v,I,A;const g=[Hl,Xl],d=[];function h(T,E){return T[0].profile_image_url?0:1}t=h(n),l=d[t]=g[t](n);let k=_&&ut(n);return{c(){e=D("div"),l.c(),s=j(),r=D("div"),a=D("div"),i=_e(f),o=j(),u=D("div"),k&&k.c(),this.h()},l(T){e=M(T,"DIV",{class:!0});var E=R(e);l.l(E),s=F(E),r=M(E,"DIV",{class:!0});var x=R(r);a=M(x,"DIV",{class:!0});var Y=R(a);i=ge(Y,f),Y.forEach(p),o=F(x),u=M(x,"DIV",{class:!0});var B=R(u);k&&k.l(B),B.forEach(p),x.forEach(p),E.forEach(p),this.h()},h(){m(a,"class","text-sm text-white"),m(u,"class","flex gap-1 items-center"),m(r,"class","flex gap-1 items-center"),m(e,"class","flex gap-[0.625rem] justify-center items-center")},m(T,E){N(T,e,E),d[t].m(e,null),w(e,s),w(e,r),w(r,a),w(a,i),w(r,o),w(r,u),k&&k.m(u,null),v=!0,I||(A=z(a,"click",n[5]),I=!0)},p(T,E){let x=t;t=h(T),t===x?d[t].p(T,E):(te(),O(d[x],1,1,()=>{d[x]=null}),le(),l=d[t],l?l.p(T,E):(l=d[t]=g[t](T),l.c()),y(l,1),l.m(e,s)),(!v||E&1)&&f!==(f=T[0].unique_name+"")&&Le(i,f),E&1&&(_=String(T[0].user_idx)!==String(Me())),_?k?k.p(T,E):(k=ut(T),k.c(),k.m(u,null)):k&&(k.d(1),k=null)},i(T){v||(y(l),v=!0)},o(T){O(l),v=!1},d(T){T&&p(e),d[t].d(),k&&k.d(),I=!1,A()}}}function Xl(n){var f;let e,t,l=(((f=n[0].unique_name)==null?void 0:f.at(0))??"u")+"",s,r,a;return{c(){e=D("div"),t=D("span"),s=_e(l),this.h()},l(i){e=M(i,"DIV",{class:!0,style:!0});var o=R(e);t=M(o,"SPAN",{class:!0});var u=R(t);s=ge(u,l),u.forEach(p),o.forEach(p),this.h()},h(){m(t,"class","text-base font-semibold text-black"),m(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),$(e,"background-color",at(n[0].unique_name))},m(i,o){N(i,e,o),w(e,t),w(t,s),r||(a=z(e,"click",n[4]),r=!0)},p(i,o){var u;o&1&&l!==(l=(((u=i[0].unique_name)==null?void 0:u.at(0))??"u")+"")&&Le(s,l),o&1&&$(e,"background-color",at(i[0].unique_name))},i:J,o:J,d(i){i&&p(e),r=!1,a()}}}function Hl(n){let e,t;return e=new Bl({props:{src:ot(n[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",n[3]),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.src=ot(l[0].profile_image_url,500)),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function ut(n){let e,t="•",l,s,r=n[0].is_following?"팔로잉":"팔로우",a,f,i,o;return{c(){e=D("div"),e.textContent=t,l=j(),s=D("div"),a=_e(r),this.h()},l(u){e=M(u,"DIV",{class:!0,"data-svelte-h":!0}),ee(e)!=="svelte-168vif2"&&(e.textContent=t),l=F(u),s=M(u,"DIV",{class:!0});var _=R(s);a=ge(_,r),_.forEach(p),this.h()},h(){m(e,"class","text-xs text-white/60"),m(s,"class",f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(u,_){N(u,e,_),N(u,l,_),N(u,s,_),w(s,a),i||(o=z(s,"click",function(){He(n[0].is_following?n[2]:n[1])&&(n[0].is_following?n[2]:n[1]).apply(this,arguments)}),i=!0)},p(u,_){n=u,_&1&&r!==(r=n[0].is_following?"팔로잉":"팔로우")&&Le(a,r),_&1&&f!==(f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&m(s,"class",f)},d(u){u&&(p(e),p(l),p(s)),i=!1,o()}}}function Zl(n){let e,t,l=n[0].idx&&n[0].unique_name&&ft(n);return{c(){l&&l.c(),e=ie()},l(s){l&&l.l(s),e=ie()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,[r]){s[0].idx&&s[0].unique_name?l?(l.p(s,r),r&1&&y(l,1)):(l=ft(s),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(te(),O(l,1,1,()=>{l=null}),le())},i(s){t||(y(l),t=!0)},o(s){O(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function Gl(n,e,t){let{post:l}=e,s=!1;async function r(){s||(s=!0,await Ml({targetIdx:l.user_idx,subjectIdx:Me()}),t(0,l.is_following=!0,l),s=!1)}async function a(){s||(s=!0,await Vl({targetIdx:l.user_idx,subjectIdx:Me()}),t(0,l.is_following=!1,l),s=!1)}const f=()=>{Xe(`/users/${l.user_idx}`)},i=()=>{Xe(`/users/${l.user_idx}`)},o=()=>{Xe(`/users/${l.user_idx}`)};return n.$$set=u=>{"post"in u&&t(0,l=u.post)},[l,r,a,f,i,o]}class Wl extends fe{constructor(e){super(),ue(this,e,Gl,Zl,oe,{post:0})}}function Jl(n){let e,t,l,s;return{c(){e=Ce("svg"),t=Ce("path"),l=Ce("path"),this.h()},l(r){e=xe(r,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var a=R(e);t=xe(a,"path",{d:!0,fill:!0}),R(t).forEach(p),l=xe(a,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),R(l).forEach(p),a.forEach(p),this.h()},h(){m(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),m(t,"fill",n[0]),m(l,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),m(l,"stroke",n[1]),m(l,"stroke-width","2"),m(l,"stroke-linejoin","round"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width",n[2]),m(e,"height",n[2]),m(e,"viewBox",s="0 0 "+n[2]+" "+n[2]),m(e,"fill","none")},m(r,a){N(r,e,a),w(e,t),w(e,l)},p(r,[a]){a&1&&m(t,"fill",r[0]),a&2&&m(l,"stroke",r[1]),a&4&&m(e,"width",r[2]),a&4&&m(e,"height",r[2]),a&4&&s!==(s="0 0 "+r[2]+" "+r[2])&&m(e,"viewBox",s)},i:J,o:J,d(r){r&&p(e)}}}function Kl(n,e,t){let l,{fill:s="#FF4F1E"}=e,{stroke:r="#FF4F1E"}=e,{length:a=1.5}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"stroke"in f&&t(1,r=f.stroke),"length"in f&&t(3,a=f.length)},n.$$.update=()=>{n.$$.dirty&8&&t(2,l=Ie(a))},[s,r,l,a]}class Ql extends fe{constructor(e){super(),ue(this,e,Kl,Jl,oe,{fill:0,stroke:1,length:3})}}function ze(n){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const s=r=>r.stopPropagation();return n.addEventListener(l,s),{event:l,handler:s}});return{destroy(){t.forEach(({event:l,handler:s})=>{n.removeEventListener(l,s)})}}}function ct(n){let e,t;return e=new Ft({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Pl,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:n[0].name}}),e.$on("click",n[1]),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.value=l[0].name),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function $l(n){let e,t,l=n[0].idx&&ct(n);return{c(){l&&l.c(),e=ie()},l(s){l&&l.l(s),e=ie()},m(s,r){l&&l.m(s,r),N(s,e,r),t=!0},p(s,[r]){s[0].idx?l?(l.p(s,r),r&1&&y(l,1)):(l=ct(s),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(te(),O(l,1,1,()=>{l=null}),le())},i(s){t||(y(l),t=!0)},o(s){O(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function en(n,e,t){let{place:l}=e;const s=async()=>{await Ze(`/places/${l.idx}`)};return n.$$set=r=>{"place"in r&&t(0,l=r.place)},[l,s]}class tn extends fe{constructor(e){super(),ue(this,e,en,$l,oe,{place:0})}}function ln(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=xe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=R(e);t=xe(s,"path",{d:!0}),R(t).forEach(p),s.forEach(p),this.h()},h(){m(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 -960 960 960"),m(e,"width",n[1]),m(e,"height",n[1]),m(e,"fill",n[0])},m(l,s){N(l,e,s),w(e,t)},p(l,[s]){s&2&&m(e,"width",l[1]),s&2&&m(e,"height",l[1]),s&1&&m(e,"fill",l[0])},i:J,o:J,d(l){l&&p(e)}}}function nn(n,e,t){let l,{fill:s="#5f6368"}=e,{length:r="1.75"}=e,{alt:a="Edit"}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,r=f.length),"alt"in f&&t(3,a=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=Ie(r))},[s,l,r,a]}class sn extends fe{constructor(e){super(),ue(this,e,nn,ln,oe,{fill:0,length:2,alt:3})}}function rn(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=xe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=R(e);t=xe(s,"path",{d:!0}),R(t).forEach(p),s.forEach(p),this.h()},h(){m(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 -960 960 960"),m(e,"width",n[1]),m(e,"height",n[1]),m(e,"fill",n[0])},m(l,s){N(l,e,s),w(e,t)},p(l,[s]){s&2&&m(e,"width",l[1]),s&2&&m(e,"height",l[1]),s&1&&m(e,"fill",l[0])},i:J,o:J,d(l){l&&p(e)}}}function an(n,e,t){let l,{fill:s="#5f6368"}=e,{length:r="1.75"}=e,{alt:a="Delete"}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,r=f.length),"alt"in f&&t(3,a=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=Ie(r))},[s,l,r,a]}class on extends fe{constructor(e){super(),ue(this,e,an,rn,oe,{fill:0,length:2,alt:3})}}function fn(n){let e,t=(n[0].text||"")+"",l,s,r;return{c(){e=D("p"),l=_e(t),this.h()},l(a){e=M(a,"P",{class:!0,style:!0});var f=R(e);l=ge(f,t),f.forEach(p),this.h()},h(){m(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),m(e,"style",`
      overflow: hidden;
      height: ${n[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(a,f){N(a,e,f),w(e,l),s||(r=[Ae(ze.call(null,e)),z(e,"click",n[2])],s=!0)},p(a,[f]){f&1&&t!==(t=(a[0].text||"")+"")&&Le(l,t)},i:J,o:J,d(a){a&&p(e),s=!1,be(r)}}}function un(n,e,t){const l=Ge();let{post:s}=e;const r=Ie(1),a=Ie(6);function f(i){const o=i.currentTarget;if(o)if(o.style.height===`${r}px`||!o.style.height){if(o.scrollHeight>r){const u=o.scrollHeight<a?o.scrollHeight:a;o.style.height=`${u}px`,o.style.overflow="scroll",o.style.display="block",o.style.webkitLineClamp="unset",l("textExpanded",{expanded:!0})}}else o.style.height=`${r}px`,o.style.overflow="hidden",o.style.display="-webkit-box",o.style.webkitLineClamp="1",l("textExpanded",{expanded:!1})}return Lt(()=>{l("textExpanded",{expanded:!1})}),n.$$set=i=>{"post"in i&&t(0,s=i.post)},[s,r,f]}class cn extends fe{constructor(e){super(),ue(this,e,un,fn,oe,{post:0})}}function dn(n){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),R(e).forEach(p),this.h()},h(){m(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),$(e,"opacity","0.6"),$(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,l){N(t,e,l)},d(t){t&&p(e)}}}function hn(n){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),R(e).forEach(p),this.h()},h(){m(e,"class","fixed inset-0 pointer-events-none z-30"),$(e,"opacity","0.7"),$(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,l){N(t,e,l)},d(t){t&&p(e)}}}function mn(n){let e;function t(r,a){return r[0]?hn:dn}let l=t(n),s=l(n);return{c(){s.c(),e=ie()},l(r){s.l(r),e=ie()},m(r,a){s.m(r,a),N(r,e,a)},p(r,[a]){l!==(l=t(r))&&(s.d(1),s=l(r),s&&(s.c(),s.m(e.parentNode,e)))},i:J,o:J,d(r){r&&p(e),s.d(r)}}}function pn(n,e,t){let{isTextExpanded:l=!1}=e;return n.$$set=s=>{"isTextExpanded"in s&&t(0,l=s.isTextExpanded)},[l]}class _n extends fe{constructor(e){super(),ue(this,e,pn,mn,oe,{isTextExpanded:0})}}function dt(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function ht(n,e){let t,l,s,r,a,f=J;return{key:n,first:null,c(){t=D("span"),l=D("span"),r=j(),this.h()},l(i){t=M(i,"SPAN",{class:!0,style:!0});var o=R(t);l=M(o,"SPAN",{class:!0,style:!0}),R(l).forEach(p),r=F(o),o.forEach(p),this.h()},h(){m(l,"class",s=Ue(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),$(l,"transform","scale("+e[4](e[7])+")"),$(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),m(t,"class","flex items-center justify-center"),$(t,"width","0.375rem"),$(t,"height","0.375rem"),this.first=t},m(i,o){N(i,t,o),w(t,l),w(t,r)},p(i,o){e=i,o&13&&s!==(s=Ue(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&m(l,"class",s),o&8&&$(l,"transform","scale("+e[4](e[7])+")"),o&13&&$(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){a=t.getBoundingClientRect()},f(){jl(t),f()},a(){f(),f=Fl(t,a,Ul,{})},d(i){i&&p(t)}}}function gn(n){let e,t=[],l=new Map,s,r=he(n[3]);const a=f=>f[5];for(let f=0;f<r.length;f+=1){let i=dt(n,r,f),o=a(i);l.set(o,t[f]=ht(o,i))}return{c(){e=D("div");for(let f=0;f<t.length;f+=1)t[f].c();this.h()},l(f){e=M(f,"DIV",{class:!0});var i=R(e);for(let o=0;o<t.length;o+=1)t[o].l(i);i.forEach(p),this.h()},h(){m(e,"class",s=Ue(`
    ${n[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(f,i){N(f,e,i);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(f,[i]){if(i&29){r=he(f[3]);for(let o=0;o<t.length;o+=1)t[o].r();t=We(t,i,a,1,f,r,l,e,El,ht,null,dt);for(let o=0;o<t.length;o+=1)t[o].a()}i&2&&s!==(s=Ue(`
    ${f[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&m(e,"class",s)},i:J,o:J,d(f){f&&p(e);for(let i=0;i<t.length;i+=1)t[i].d()}}}const Te=7;function bn(n,e,t){let{post:l}=e,{fixed:s=!0}=e,r=[],a=0;function f(i){const o=l.mediaIdx-a,u=r.length;if(u<=1)return 1;const _=Math.max(o,u-1-o);return _===0?1:1-Math.abs(i-o)/_*.5}return n.$$set=i=>{"post"in i&&t(0,l=i.post),"fixed"in i&&t(1,s=i.fixed)},n.$$.update=()=>{n.$$.dirty&5&&(l.media.length>Te?(l.mediaIdx<=Math.floor(Te/2)?t(2,a=0):l.mediaIdx>=l.media.length-Math.ceil(Te/2)?t(2,a=l.media.length-Te):t(2,a=l.mediaIdx-Math.floor(Te/2)),t(3,r=l.media.slice(a,a+Te))):(t(2,a=0),t(3,r=l.media)))},[l,s,a,r,f]}class Yt extends fe{constructor(e){super(),ue(this,e,bn,gn,oe,{post:0,fixed:1})}}function mt(n,e,t){const l=n.slice();return l[13]=e[t].text,l[14]=e[t].value,l[15]=e[t].custom,l[17]=t,l}function pt(n){let e,t,l,s,r=n[13]+"",a,f,i,o;return{c(){e=D("label"),t=D("input"),l=j(),s=D("span"),a=_e(r),f=j(),this.h()},l(u){e=M(u,"LABEL",{class:!0});var _=R(e);t=M(_,"INPUT",{type:!0,name:!0,class:!0}),l=F(_),s=M(_,"SPAN",{class:!0});var v=R(s);a=ge(v,r),v.forEach(p),f=F(_),_.forEach(p),this.h()},h(){m(t,"type","radio"),m(t,"name","report"),m(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=n[14],m(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),m(e,"class","flex gap-2 py-2")},m(u,_){N(u,e,_),w(e,t),w(e,l),w(e,s),w(s,a),w(e,f),i||(o=z(t,"change",n[7]),i=!0)},p:J,d(u){u&&p(e),i=!1,o()}}}function _t(n){let e,t,l,s;return{c(){e=D("div"),t=D("textarea"),this.h()},l(r){e=M(r,"DIV",{class:!0});var a=R(e);t=M(a,"TEXTAREA",{class:!0,placeholder:!0}),R(t).forEach(p),a.forEach(p),this.h()},h(){m(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal"),m(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),m(e,"class","px-5 py-2.5")},m(r,a){N(r,e,a),w(e,t),nt(t,n[2]),l||(s=z(t,"input",n[8]),l=!0)},p(r,a){a&4&&nt(t,r[2])},d(r){r&&p(e),l=!1,s()}}}function vn(n){let e,t,l="게시물 신고 사유",s,r,a,f,i,o,u="취소",_,v,I="신고",A,g,d=he(n[3]),h=[];for(let T=0;T<d.length;T+=1)h[T]=pt(mt(n,d,T));let k=n[1]==="etc"&&_t(n);return{c(){e=D("div"),t=D("heading"),t.textContent=l,s=j(),r=D("div");for(let T=0;T<h.length;T+=1)h[T].c();a=j(),k&&k.c(),f=j(),i=D("div"),o=D("button"),o.textContent=u,_=j(),v=D("button"),v.textContent=I,this.h()},l(T){e=M(T,"DIV",{class:!0});var E=R(e);t=M(E,"HEADING",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-z3puxq"&&(t.textContent=l),s=F(E),r=M(E,"DIV",{class:!0});var x=R(r);for(let B=0;B<h.length;B+=1)h[B].l(x);x.forEach(p),a=F(E),k&&k.l(E),f=F(E),i=M(E,"DIV",{class:!0});var Y=R(i);o=M(Y,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(o)!=="svelte-xb8aop"&&(o.textContent=u),_=F(Y),v=M(Y,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-1fehi46"&&(v.textContent=I),Y.forEach(p),E.forEach(p),this.h()},h(){m(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),m(r,"class","px-5"),m(o,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),m(v,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),m(i,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),m(e,"class","flex flex-col gap-2.5")},m(T,E){N(T,e,E),w(e,t),w(e,s),w(e,r);for(let x=0;x<h.length;x+=1)h[x]&&h[x].m(r,null);w(e,a),k&&k.m(e,null),w(e,f),w(e,i),w(i,o),w(i,_),w(i,v),A||(g=[z(o,"click",n[9]),z(v,"click",n[4]),Ae(ze.call(null,e))],A=!0)},p(T,E){if(E&10){d=he(T[3]);let x;for(x=0;x<d.length;x+=1){const Y=mt(T,d,x);h[x]?h[x].p(Y,E):(h[x]=pt(Y),h[x].c(),h[x].m(r,null))}for(;x<h.length;x+=1)h[x].d(1);h.length=d.length}T[1]==="etc"?k?k.p(T,E):(k=_t(T),k.c(),k.m(e,f)):k&&(k.d(1),k=null)},d(T){T&&p(e),Nt(h,T),k&&k.d(),A=!1,be(g)}}}function wn(n){let e,t,l;function s(a){n[10](a)}let r={noHandle:!0,fixed:!0,$$slots:{default:[vn]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.isOpen=n[0]),e=new Ut({props:r}),De.push(()=>Re(e,"isOpen",s)),{c(){H(e.$$.fragment)},l(a){Z(e.$$.fragment,a)},m(a,f){G(e,a,f),l=!0},p(a,[f]){const i={};f&262151&&(i.$$scope={dirty:f,ctx:a}),!t&&f&1&&(t=!0,i.isOpen=a[0],Oe(()=>t=!1)),e.$set(i)},i(a){l||(y(e.$$.fragment,a),l=!0)},o(a){O(e.$$.fragment,a),l=!1},d(a){W(e,a)}}}function kn(n,e,t){const l=Ge();let{isOpen:s}=e,{selectedValue:r=""}=e,{targetTable:a=""}=e,{targetIdx:f=""}=e;const i=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let o="",u=!1;async function _(){const d=i.findIndex(h=>h.value===r);if(d===-1){alert("신고 사유를 선택해주세요.");return}if(!u){u=!0,pe.emit("loading",!0);try{const h=i[d],k=new URL(`${Se}/auth/permissions`);k.searchParams.set("targetTable",a),k.searchParams.set("targetIdx",f),k.searchParams.set("relation","reported"),k.searchParams.set("subjectTable","users"),k.searchParams.set("subjectIdx",jt().sub),k.searchParams.set("metadata",JSON.stringify({...h,customReason:o})),t(0,s=!1),t(2,o=""),await fetch(k,{method:"PUT",headers:{Authorization:`Bearer ${Ye()}`}}),l("reported")}finally{u=!1,pe.emit("loading",!1)}}}const v=d=>{t(1,r=d.target.value)};function I(){o=this.value,t(2,o)}const A=()=>{t(0,s=!1)};function g(d){s=d,t(0,s)}return n.$$set=d=>{"isOpen"in d&&t(0,s=d.isOpen),"selectedValue"in d&&t(1,r=d.selectedValue),"targetTable"in d&&t(5,a=d.targetTable),"targetIdx"in d&&t(6,f=d.targetIdx)},[s,r,o,i,_,a,f,v,I,A,g]}class Cn extends fe{constructor(e){super(),ue(this,e,kn,wn,oe,{isOpen:0,selectedValue:1,targetTable:5,targetIdx:6})}}function gt(n){let e,t,l,s="이 게시물을 신고해 주셔서 감사합니다.",r,a,f="신고 취소하기",i,o;return{c(){e=D("div"),t=D("div"),l=D("div"),l.textContent=s,r=j(),a=D("div"),a.textContent=f,this.h()},l(u){e=M(u,"DIV",{class:!0});var _=R(e);t=M(_,"DIV",{class:!0});var v=R(t);l=M(v,"DIV",{class:!0,"data-svelte-h":!0}),ee(l)!=="svelte-179ijsk"&&(l.textContent=s),r=F(v),a=M(v,"DIV",{class:!0,"data-svelte-h":!0}),ee(a)!=="svelte-1haiztv"&&(a.textContent=f),v.forEach(p),_.forEach(p),this.h()},h(){m(l,"class","text-white text-[0.9375rem] font-semibold"),m(a,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),m(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),m(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(u,_){N(u,e,_),w(e,t),w(t,l),w(t,r),w(t,a),i||(o=z(a,"click",n[1]),i=!0)},p:J,d(u){u&&p(e),i=!1,o()}}}function xn(n){let e,t=n[0]&&gt(n);return{c(){t&&t.c(),e=ie()},l(l){t&&t.l(l),e=ie()},m(l,s){t&&t.m(l,s),N(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=gt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:J,o:J,d(l){l&&p(e),t&&t.d(l)}}}function In(n,e,t){const l=Ge();let{isVisible:s=!1}=e,{targetTable:r=""}=e,{targetIdx:a=""}=e,f=!1;async function i(){if(f!==!0){f=!0,pe.emit("loading",!0);try{const o=new URL(`${Se}/auth/permissions`);o.searchParams.set("targetTable",r),o.searchParams.set("targetIdx",a),o.searchParams.set("relation","reported"),o.searchParams.set("subjectTable","users"),o.searchParams.set("subjectIdx",jt().sub),await fetch(o,{method:"DELETE",headers:{Authorization:`Bearer ${Ye()}`}}),t(0,s=!1),l("unreported")}finally{f=!1,pe.emit("loading",!1)}}}return n.$$set=o=>{"isVisible"in o&&t(0,s=o.isVisible),"targetTable"in o&&t(2,r=o.targetTable),"targetIdx"in o&&t(3,a=o.targetIdx)},[s,i,r,a]}class En extends fe{constructor(e){super(),ue(this,e,In,xn,oe,{isVisible:0,targetTable:2,targetIdx:3})}}function bt(n,e,t){const l=n.slice();return l[80]=e[t],l[81]=e,l[82]=t,l}function vt(n,e,t){const l=n.slice();return l[83]=e[t],l}function wt(n,e,t){const l=n.slice();return l[86]=e[t],l[88]=t,l}function kt(n){let e,t,l;return{c(){e=D("div"),this.h()},l(s){e=M(s,"DIV",{class:!0}),R(e).forEach(p),this.h()},h(){m(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,r){N(s,e,r),t||(l=z(e,"contextmenu",xl(n[24])),t=!0)},d(s){s&&p(e),t=!1,l()}}}function Ct(n){let e,t,l,s=[],r=new Map,a,f,i,o,u,_,v,I=he(n[80].media);const A=d=>d[86];for(let d=0;d<I.length;d+=1){let h=wt(n,I,d),k=A(h);r.set(k,s[d]=xt(k,h))}let g=!n[5]&&It(n);return{c(){e=D("section"),t=D("div"),l=D("div");for(let d=0;d<s.length;d+=1)s[d].c();f=j(),g&&g.c(),i=j(),this.h()},l(d){e=M(d,"SECTION",{class:!0,style:!0});var h=R(e);t=M(h,"DIV",{class:!0});var k=R(t);l=M(k,"DIV",{class:!0,style:!0});var T=R(l);for(let E=0;E<s.length;E+=1)s[E].l(T);T.forEach(p),k.forEach(p),f=F(h),g&&g.l(h),i=F(h),h.forEach(p),this.h()},h(){m(l,"class",a="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")),$(l,"transform","translateX("+(-n[80].mediaIdx*n[11].width+n[10])+"px)"),m(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),m(e,"class",o=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`),$(e,"top","0"),$(e,"transform","translateY("+((n[82]-n[1])*n[11].height+n[9])+"px)")},m(d,h){N(d,e,h),w(e,t),w(t,l);for(let k=0;k<s.length;k+=1)s[k]&&s[k].m(l,null);w(e,f),g&&g.m(e,null),w(e,i),u=!0,_||(v=[z(l,"transitionend",function(){He(n[80].mediaIdx===n[0][n[1]].mediaIdx?n[15]:void 0)&&(n[80].mediaIdx===n[0][n[1]].mediaIdx?n[15]:void 0).apply(this,arguments)}),z(e,"transitionend",function(){He(n[82]===n[1]?n[15]:void 0)&&(n[82]===n[1]?n[15]:void 0).apply(this,arguments)})],_=!0)},p(d,h){n=d,h[0]&16419&&(I=he(n[80].media),te(),s=We(s,h,A,1,n,I,r,l,qt,xt,null,wt),le()),(!u||h[0]&256&&a!==(a="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")))&&m(l,"class",a),(!u||h[0]&3073)&&$(l,"transform","translateX("+(-n[80].mediaIdx*n[11].width+n[10])+"px)"),n[5]?g&&(te(),O(g,1,1,()=>{g=null}),le()):g?(g.p(n,h),h[0]&32&&y(g,1)):(g=It(n),g.c(),y(g,1),g.m(e,i)),(!u||h[0]&256&&o!==(o=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`))&&m(e,"class",o),(!u||h[0]&2563)&&$(e,"transform","translateY("+((n[82]-n[1])*n[11].height+n[9])+"px)")},i(d){if(!u){for(let h=0;h<I.length;h+=1)y(s[h]);y(g),u=!0}},o(d){for(let h=0;h<s.length;h+=1)O(s[h]);O(g),u=!1},d(d){d&&p(e);for(let h=0;h<s.length;h+=1)s[h].d();g&&g.d(),_=!1,be(v)}}}function xt(n,e){let t,l,s,r,a,f;return s=new Yl({props:{src:e[86],isEdit:e[5],post:e[0][e[1]],muted:e[14],autoplay:e[1]===e[82]&&e[0][e[1]].mediaIdx===e[88],isRightOrderForYoutube:e[1]===e[82]}}),{key:n,first:null,c(){t=D("div"),l=D("div"),H(s.$$.fragment),a=j(),this.h()},l(i){t=M(i,"DIV",{class:!0});var o=R(t);l=M(o,"DIV",{class:!0});var u=R(l);Z(s.$$.fragment,u),u.forEach(p),a=F(o),o.forEach(p),this.h()},h(){m(l,"class",r=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `),m(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(i,o){N(i,t,o),w(t,l),G(s,l,null),w(t,a),f=!0},p(i,o){e=i;const u={};o[0]&1&&(u.src=e[86]),o[0]&32&&(u.isEdit=e[5]),o[0]&3&&(u.post=e[0][e[1]]),o[0]&16384&&(u.muted=e[14]),o[0]&3&&(u.autoplay=e[1]===e[82]&&e[0][e[1]].mediaIdx===e[88]),o[0]&3&&(u.isRightOrderForYoutube=e[1]===e[82]),s.$set(u),(!f||o[0]&32&&r!==(r=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `))&&m(l,"class",r)},i(i){f||(y(s.$$.fragment,i),f=!0)},o(i){O(s.$$.fragment,i),f=!1},d(i){i&&p(t),W(s)}}}function It(n){var Y;let e,t,l,s,r,a,f,i,o,u,_,v,I,A,g=n[80].media.length>1&&Et(n),d=((Y=n[80].reactions)==null?void 0:Y.length)>0&&!n[6]&&yt(n);function h(B){n[26](B,n[80],n[81],n[82])}let k={};n[80]!==void 0&&(k.post=n[80]),r=new Wl({props:k}),De.push(()=>Re(r,"post",h));function T(...B){return n[27](n[80],n[81],n[82],...B)}i=new cn({props:{post:n[80]}}),i.$on("textExpanded",T),u=new tn({props:{place:{idx:n[80].place_idx,name:n[80].place_name}}});let E=!n[6]&&Dt(n),x=n[1]===n[82]&&Vt(n);return{c(){g&&g.c(),e=j(),t=D("div"),l=D("div"),d&&d.c(),s=j(),H(r.$$.fragment),f=j(),H(i.$$.fragment),o=j(),H(u.$$.fragment),_=j(),E&&E.c(),v=j(),x&&x.c(),I=ie(),this.h()},l(B){g&&g.l(B),e=F(B),t=M(B,"DIV",{class:!0});var C=R(t);l=M(C,"DIV",{class:!0});var S=R(l);d&&d.l(S),s=F(S),Z(r.$$.fragment,S),f=F(S),Z(i.$$.fragment,S),o=F(S),Z(u.$$.fragment,S),S.forEach(p),_=F(C),E&&E.l(C),C.forEach(p),v=F(B),x&&x.l(B),I=ie(),this.h()},h(){m(l,"class","flex-grow text-white text-md flex flex-col items-start gap-2 transition-transform text-base "),m(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(B,C){g&&g.m(B,C),N(B,e,C),N(B,t,C),w(t,l),d&&d.m(l,null),w(l,s),G(r,l,null),w(l,f),G(i,l,null),w(l,o),G(u,l,null),w(t,_),E&&E.m(t,null),N(B,v,C),x&&x.m(B,C),N(B,I,C),A=!0},p(B,C){var re;n=B,n[80].media.length>1?g?(g.p(n,C),C[0]&1&&y(g,1)):(g=Et(n),g.c(),y(g,1),g.m(e.parentNode,e)):g&&(te(),O(g,1,1,()=>{g=null}),le()),((re=n[80].reactions)==null?void 0:re.length)>0&&!n[6]?d?(d.p(n,C),C[0]&65&&y(d,1)):(d=yt(n),d.c(),y(d,1),d.m(l,s)):d&&(te(),O(d,1,1,()=>{d=null}),le());const S={};!a&&C[0]&1&&(a=!0,S.post=n[80],Oe(()=>a=!1)),r.$set(S);const ne={};C[0]&1&&(ne.post=n[80]),i.$set(ne);const K={};C[0]&1&&(K.place={idx:n[80].place_idx,name:n[80].place_name}),u.$set(K),n[6]?E&&(te(),O(E,1,1,()=>{E=null}),le()):E?(E.p(n,C),C[0]&64&&y(E,1)):(E=Dt(n),E.c(),y(E,1),E.m(t,null)),n[1]===n[82]?x?(x.p(n,C),C[0]&3&&y(x,1)):(x=Vt(n),x.c(),y(x,1),x.m(I.parentNode,I)):x&&(te(),O(x,1,1,()=>{x=null}),le())},i(B){A||(y(g),y(d),y(r.$$.fragment,B),y(i.$$.fragment,B),y(u.$$.fragment,B),y(E),y(x),A=!0)},o(B){O(g),O(d),O(r.$$.fragment,B),O(i.$$.fragment,B),O(u.$$.fragment,B),O(E),O(x),A=!1},d(B){B&&(p(e),p(t),p(v),p(I)),g&&g.d(B),d&&d.d(),W(r),W(i),W(u),E&&E.d(),x&&x.d(B)}}}function Et(n){let e,t;return e=new Yt({props:{post:n[80]}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s[0]&1&&(r.post=l[80]),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function yt(n){let e,t,l=he(n[80].reactions),s=[];for(let a=0;a<l.length;a+=1)s[a]=Tt(vt(n,l,a));const r=a=>O(s[a],1,1,()=>{s[a]=null});return{c(){e=D("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var f=R(e);for(let i=0;i<s.length;i+=1)s[i].l(f);f.forEach(p),this.h()},h(){m(e,"class","flex gap-1 justify-center items-center mb-1")},m(a,f){N(a,e,f);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);t=!0},p(a,f){if(f[0]&131073){l=he(a[80].reactions);let i;for(i=0;i<l.length;i+=1){const o=vt(a,l,i);s[i]?(s[i].p(o,f),y(s[i],1)):(s[i]=Tt(o),s[i].c(),y(s[i],1),s[i].m(e,null))}for(te(),i=l.length;i<s.length;i+=1)r(i);le()}},i(a){if(!t){for(let f=0;f<l.length;f+=1)y(s[f]);t=!0}},o(a){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)O(s[f]);t=!1},d(a){a&&p(e),Nt(s,a)}}}function Tt(n){let e,t;function l(){return n[25](n[80],n[83])}return e=new Ft({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:n[83].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:n[83].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",l),{c(){H(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,r){G(e,s,r),t=!0},p(s,r){n=s;const a={};r[0]&1&&(a.prefix=n[83].type),r[0]&1&&(a.value=n[83].count),e.$set(a)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){O(e.$$.fragment,s),t=!1},d(s){W(e,s)}}}function Dt(n){var B;let e,t,l,s,r,a,f,i,o=((B=n[80].reactions)!=null&&B.length?n[80].reactions.reduce(n[33],0):0)+"",u,_,v,I,A,g,d,h=n[80].onReactionShowcase&&Mt(n);const k=[Tn,yn],T=[];function E(C,S){return C[80].myReaction?0:1}r=E(n),a=T[r]=k[r](n);function x(){return n[34](n[80])}function Y(){return n[35](n[80],n[81],n[82])}return I=new Nl({props:{fill:"white",length:1.5}}),{c(){e=D("div"),t=D("div"),h&&h.c(),l=j(),s=D("button"),a.c(),f=j(),i=D("span"),u=_e(o),_=j(),v=D("button"),H(I.$$.fragment),this.h()},l(C){e=M(C,"DIV",{class:!0});var S=R(e);t=M(S,"DIV",{class:!0});var ne=R(t);h&&h.l(ne),l=F(ne),s=M(ne,"BUTTON",{class:!0});var K=R(s);a.l(K),f=F(K),i=M(K,"SPAN",{class:!0});var re=R(i);u=ge(re,o),re.forEach(p),K.forEach(p),ne.forEach(p),_=F(S),v=M(S,"BUTTON",{});var ae=R(v);Z(I.$$.fragment,ae),ae.forEach(p),S.forEach(p),this.h()},h(){m(i,"class","text-xs text-white h-4"),m(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),m(t,"class","flex gap-4 relative"),m(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(C,S){N(C,e,S),w(e,t),h&&h.m(t,null),w(t,l),w(t,s),T[r].m(s,null),w(s,f),w(s,i),w(i,u),w(e,_),w(e,v),G(I,v,null),A=!0,g||(d=[z(s,"click",x),Ae(ze.call(null,s)),Ae(Al.call(null,s,500)),z(s,"longpress",Y),z(v,"click",n[36])],g=!0)},p(C,S){var K;n=C,n[80].onReactionShowcase?h?h.p(n,S):(h=Mt(n),h.c(),h.m(t,l)):h&&(h.d(1),h=null);let ne=r;r=E(n),r!==ne&&(te(),O(T[ne],1,1,()=>{T[ne]=null}),le(),a=T[r],a||(a=T[r]=k[r](n),a.c()),y(a,1),a.m(s,f)),(!A||S[0]&1)&&o!==(o=((K=n[80].reactions)!=null&&K.length?n[80].reactions.reduce(n[33],0):0)+"")&&Le(u,o)},i(C){A||(y(a),y(I.$$.fragment,C),A=!0)},o(C){O(a),O(I.$$.fragment,C),A=!1},d(C){C&&p(e),h&&h.d(),T[r].d(),W(I),g=!1,be(d)}}}function Mt(n){let e,t,l="👍",s,r,a="🔥",f,i,o="😍",u,_,v="😋",I,A,g="😊️️",d,h;function k(){return n[28](n[80])}function T(){return n[29](n[80])}function E(){return n[30](n[80])}function x(){return n[31](n[80])}function Y(){return n[32](n[80])}return{c(){e=D("div"),t=D("button"),t.textContent=l,s=j(),r=D("button"),r.textContent=a,f=j(),i=D("button"),i.textContent=o,u=j(),_=D("button"),_.textContent=v,I=j(),A=D("button"),A.textContent=g,this.h()},l(B){e=M(B,"DIV",{class:!0});var C=R(e);t=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-3oecln"&&(t.textContent=l),s=F(C),r=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(r)!=="svelte-131qbu2"&&(r.textContent=a),f=F(C),i=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(i)!=="svelte-lq90i3"&&(i.textContent=o),u=F(C),_=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(_)!=="svelte-l73y87"&&(_.textContent=v),I=F(C),A=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(A)!=="svelte-11szxsj"&&(A.textContent=g),C.forEach(p),this.h()},h(){m(t,"class","text-2xl/[26px]"),m(r,"class","text-2xl/[26px]"),m(i,"class","text-2xl/[26px]"),m(_,"class","text-2xl/[26px]"),m(A,"class","text-2xl/[26px]"),m(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(B,C){N(B,e,C),w(e,t),w(e,s),w(e,r),w(e,f),w(e,i),w(e,u),w(e,_),w(e,I),w(e,A),d||(h=[z(t,"click",k),z(r,"click",T),z(i,"click",E),z(_,"click",x),z(A,"click",Y)],d=!0)},p(B,C){n=B},d(B){B&&p(e),d=!1,be(h)}}}function yn(n){let e,t;return e=new Rl({props:{fill:"white",length:1.5}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Tn(n){let e,t;return e=new Sl({props:{fill:"#EA3323",length:1.5}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Vt(n){let e,t;return e=new _n({props:{isTextExpanded:n[80].isTextExpanded}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s[0]&1&&(r.isTextExpanded=l[80].isTextExpanded),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Bt(n,e){let t,l=Math.abs(e[1]-e[82])<=1,s,r,a=l&&Ct(e);return{key:n,first:null,c(){t=ie(),a&&a.c(),s=ie(),this.h()},l(f){t=ie(),a&&a.l(f),s=ie(),this.h()},h(){this.first=t},m(f,i){N(f,t,i),a&&a.m(f,i),N(f,s,i),r=!0},p(f,i){e=f,i[0]&3&&(l=Math.abs(e[1]-e[82])<=1),l?a?(a.p(e,i),i[0]&3&&y(a,1)):(a=Ct(e),a.c(),y(a,1),a.m(s.parentNode,s)):a&&(te(),O(a,1,1,()=>{a=null}),le())},i(f){r||(y(a),r=!0)},o(f){O(a),r=!1},d(f){f&&(p(t),p(s)),a&&a.d(f)}}}function Pt(n){let e,t;return e=new Yt({props:{post:n[0][n[1]],fixed:!1}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s[0]&3&&(r.post=l[0][l[1]]),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Ot(n){let e,t;return e=new Ol({}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Rt(n){let e,t,l,s,r="수정",a,f,i,o,u,_="삭제",v,I,A;return t=new sn({props:{fill:"white",length:1.5}}),i=new on({props:{fill:"white",length:1.5}}),{c(){e=D("button"),H(t.$$.fragment),l=j(),s=D("span"),s.textContent=r,a=j(),f=D("button"),H(i.$$.fragment),o=j(),u=D("span"),u.textContent=_,this.h()},l(g){e=M(g,"BUTTON",{class:!0});var d=R(e);Z(t.$$.fragment,d),l=F(d),s=M(d,"SPAN",{"data-svelte-h":!0}),ee(s)!=="svelte-17aljrl"&&(s.textContent=r),d.forEach(p),a=F(g),f=M(g,"BUTTON",{class:!0});var h=R(f);Z(i.$$.fragment,h),o=F(h),u=M(h,"SPAN",{"data-svelte-h":!0}),ee(u)!=="svelte-1k1dgz"&&(u.textContent=_),h.forEach(p),this.h()},h(){m(e,"class","flex items-center gap-2 text-white text-sm"),m(f,"class","flex items-center gap-2 text-white text-sm")},m(g,d){N(g,e,d),G(t,e,null),w(e,l),w(e,s),N(g,a,d),N(g,f,d),G(i,f,null),w(f,o),w(f,u),v=!0,I||(A=[z(e,"click",n[38]),z(f,"click",n[39])],I=!0)},p:J,i(g){v||(y(t.$$.fragment,g),y(i.$$.fragment,g),v=!0)},o(g){O(t.$$.fragment,g),O(i.$$.fragment,g),v=!1},d(g){g&&(p(e),p(a),p(f)),W(t),W(i),I=!1,be(A)}}}function St(n){let e,t,l,s,r,a;return t=new Ql({}),{c(){e=D("button"),H(t.$$.fragment),l=_e(`
        신고`),this.h()},l(f){e=M(f,"BUTTON",{class:!0});var i=R(e);Z(t.$$.fragment,i),l=ge(i,`
        신고`),i.forEach(p),this.h()},h(){m(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(f,i){N(f,e,i),G(t,e,null),w(e,l),s=!0,r||(a=z(e,"click",n[41]),r=!0)},p:J,i(f){s||(y(t.$$.fragment,f),s=!0)},o(f){O(t.$$.fragment,f),s=!1},d(f){f&&p(e),W(t),r=!1,a()}}}function Dn(n){let e,t,l,s,r,a,f,i,o,u=n[13]&&Rt(n);s=new zl({props:{length:1.5,fill:"white"}});let _=!n[13]&&St(n);return{c(){e=D("div"),u&&u.c(),t=j(),l=D("button"),H(s.$$.fragment),r=_e(`
      링크 복사`),a=j(),_&&_.c(),this.h()},l(v){e=M(v,"DIV",{id:!0,class:!0});var I=R(e);u&&u.l(I),t=F(I),l=M(I,"BUTTON",{class:!0});var A=R(l);Z(s.$$.fragment,A),r=ge(A,`
      링크 복사`),A.forEach(p),a=F(I),_&&_.l(I),I.forEach(p),this.h()},h(){m(l,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),m(e,"id","test"),m(e,"class","flex flex-col px-5 gap-3")},m(v,I){N(v,e,I),u&&u.m(e,null),w(e,t),w(e,l),G(s,l,null),w(l,r),w(e,a),_&&_.m(e,null),f=!0,i||(o=[z(l,"click",n[40]),Ae(ze.call(null,e))],i=!0)},p(v,I){v[13]?u?(u.p(v,I),I[0]&8192&&y(u,1)):(u=Rt(v),u.c(),y(u,1),u.m(e,t)):u&&(te(),O(u,1,1,()=>{u=null}),le()),v[13]?_&&(te(),O(_,1,1,()=>{_=null}),le()):_?(_.p(v,I),I[0]&8192&&y(_,1)):(_=St(v),_.c(),y(_,1),_.m(e,null))},i(v){f||(y(u),y(s.$$.fragment,v),y(_),f=!0)},o(v){O(u),O(s.$$.fragment,v),O(_),f=!1},d(v){v&&p(e),u&&u.d(),W(s),_&&_.d(),i=!1,be(o)}}}function Mn(n){let e,t,l="정말로 삭제하시겠습니까?",s,r,a="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",f,i,o,u="삭제",_,v,I="취소",A,g;return{c(){e=D("div"),t=D("h2"),t.textContent=l,s=j(),r=D("p"),r.textContent=a,f=j(),i=D("div"),o=D("button"),o.textContent=u,_=j(),v=D("button"),v.textContent=I,this.h()},l(d){e=M(d,"DIV",{class:!0});var h=R(e);t=M(h,"H2",{class:!0,"data-svelte-h":!0}),ee(t)!=="svelte-1yzhdkj"&&(t.textContent=l),s=F(h),r=M(h,"P",{class:!0,"data-svelte-h":!0}),ee(r)!=="svelte-26p028"&&(r.textContent=a),f=F(h),i=M(h,"DIV",{class:!0});var k=R(i);o=M(k,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(o)!=="svelte-1q4epan"&&(o.textContent=u),_=F(k),v=M(k,"BUTTON",{class:!0,"data-svelte-h":!0}),ee(v)!=="svelte-1rzg9yy"&&(v.textContent=I),k.forEach(p),h.forEach(p),this.h()},h(){m(t,"class","text-lg font-semibold mb-2"),m(r,"class","text-gray-600 mb-4"),m(o,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),m(v,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),m(i,"class","flex justify-center space-x-4"),m(e,"class","text-center")},m(d,h){N(d,e,h),w(e,t),w(e,s),w(e,r),w(e,f),w(e,i),w(i,o),w(i,_),w(i,v),A||(g=[z(o,"click",n[46]),z(v,"click",n[47])],A=!0)},p:J,d(d){d&&p(e),A=!1,be(g)}}}function Vn(n){var we;let e,t,l,s=[],r=new Map,a,f,i,o,u,_,v,I,A,g,d,h,k,T,E,x=!n[5]&&kt(n),Y=he(n[0]);const B=b=>b[80].idx;for(let b=0;b<Y.length;b+=1){let V=bt(n,Y,b),X=B(V);r.set(X,s[b]=Bt(X,V))}let C=n[5]&&((we=n[0][n[1]])==null?void 0:we.media.length)>1&&Pt(n),S=!n[5]&&Ot();function ne(b){n[42](b)}let K={fixed:!0,noHandle:!0,$$slots:{default:[Dn]},$$scope:{ctx:n}};n[2]!==void 0&&(K.isOpen=n[2]),u=new Ut({props:K}),De.push(()=>Re(u,"isOpen",ne));function re(b){n[43](b)}let ae={targetTable:"posts",targetIdx:n[0][n[1]].idx};n[3]!==void 0&&(ae.isOpen=n[3]),I=new Cn({props:ae}),De.push(()=>Re(I,"isOpen",re)),I.$on("reported",n[44]),d=new En({props:{isVisible:n[0][n[1]].permission_signer==="reported",targetTable:"posts",targetIdx:n[0][n[1]].idx}}),d.$on("unreported",n[45]);function ve(b){n[48](b)}let ce={$$slots:{default:[Mn]},$$scope:{ctx:n}};return n[4]!==void 0&&(ce.modalVisible=n[4]),k=new ql({props:ce}),De.push(()=>Re(k,"modalVisible",ve)),{c(){x&&x.c(),e=j(),t=D("div"),l=D("div");for(let b=0;b<s.length;b+=1)s[b].c();a=j(),C&&C.c(),f=j(),S&&S.c(),o=j(),H(u.$$.fragment),v=j(),H(I.$$.fragment),g=j(),H(d.$$.fragment),h=j(),H(k.$$.fragment),this.h()},l(b){x&&x.l(b),e=F(b),t=M(b,"DIV",{class:!0});var V=R(t);l=M(V,"DIV",{class:!0});var X=R(l);for(let Q=0;Q<s.length;Q+=1)s[Q].l(X);X.forEach(p),a=F(V),C&&C.l(V),f=F(V),S&&S.l(V),V.forEach(p),o=F(b),Z(u.$$.fragment,b),v=F(b),Z(I.$$.fragment,b),g=F(b),Z(d.$$.fragment,b),h=F(b),Z(k.$$.fragment,b),this.h()},h(){m(l,"class","flex flex-grow relative w-full h-full bg-black"),m(t,"class",i="viewer bg-black select-none flex flex-col "+(n[5]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen safe-area-pt"))},m(b,V){x&&x.m(b,V),N(b,e,V),N(b,t,V),w(t,l);for(let X=0;X<s.length;X+=1)s[X]&&s[X].m(l,null);w(t,a),C&&C.m(t,null),w(t,f),S&&S.m(t,null),n[37](t),N(b,o,V),G(u,b,V),N(b,v,V),G(I,b,V),N(b,g,V),G(d,b,V),N(b,h,V),G(k,b,V),E=!0},p(b,V){var Ne;b[5]?x&&(x.d(1),x=null):x||(x=kt(b),x.c(),x.m(e.parentNode,e)),V[0]&184167&&(Y=he(b[0]),te(),s=We(s,V,B,1,b,Y,r,l,qt,Bt,null,bt),le()),b[5]&&((Ne=b[0][b[1]])==null?void 0:Ne.media.length)>1?C?(C.p(b,V),V[0]&35&&y(C,1)):(C=Pt(b),C.c(),y(C,1),C.m(t,f)):C&&(te(),O(C,1,1,()=>{C=null}),le()),b[5]?S&&(te(),O(S,1,1,()=>{S=null}),le()):S?V[0]&32&&y(S,1):(S=Ot(),S.c(),y(S,1),S.m(t,null)),(!E||V[0]&32&&i!==(i="viewer bg-black select-none flex flex-col "+(b[5]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen safe-area-pt")))&&m(t,"class",i);const X={};V[0]&8348|V[2]&134217728&&(X.$$scope={dirty:V,ctx:b}),!_&&V[0]&4&&(_=!0,X.isOpen=b[2],Oe(()=>_=!1)),u.$set(X);const Q={};V[0]&3&&(Q.targetIdx=b[0][b[1]].idx),!A&&V[0]&8&&(A=!0,Q.isOpen=b[3],Oe(()=>A=!1)),I.$set(Q);const Ve={};V[0]&3&&(Ve.isVisible=b[0][b[1]].permission_signer==="reported"),V[0]&3&&(Ve.targetIdx=b[0][b[1]].idx),d.$set(Ve);const Be={};V[0]&16|V[2]&134217728&&(Be.$$scope={dirty:V,ctx:b}),!T&&V[0]&16&&(T=!0,Be.modalVisible=b[4],Oe(()=>T=!1)),k.$set(Be)},i(b){if(!E){for(let V=0;V<Y.length;V+=1)y(s[V]);y(C),y(S),y(u.$$.fragment,b),y(I.$$.fragment,b),y(d.$$.fragment,b),y(k.$$.fragment,b),E=!0}},o(b){for(let V=0;V<s.length;V+=1)O(s[V]);O(C),O(S),O(u.$$.fragment,b),O(I.$$.fragment,b),O(d.$$.fragment,b),O(k.$$.fragment,b),E=!1},d(b){b&&(p(e),p(t),p(o),p(v),p(g),p(h)),x&&x.d(b);for(let V=0;V<s.length;V+=1)s[V].d();C&&C.d(),S&&S.d(),n[37](null),W(u,b),W(I,b),W(d,b),W(k,b)}}}const Bn=30,Pn=10,At=150;function Pe(n){return"touches"in n||"changedTouches"in n}function On(n){return Pe(n)?[n.touches[0].clientX,n.touches[0].clientY]:[n.clientX,n.clientY]}function Rn(n,e,t){let l,s,r,a;st(n,it,c=>t(14,r=c)),st(n,yl,c=>t(7,a=c));const f=Tl.isNativePlatform();let{posts:i=[]}=e,{index:o=0}=e,{type:u=a.url.searchParams.get("type")}=e,{isEdit:_=!1}=e,{dontMoveVertically:v=!1}=e,{selectedReaction:I=void 0}=e,{hideActionButtons:A=!1}=e,g=!0,d=!1,h=!1,k=0,T=0,E={width:0,height:0},x=!1,Y=!1,{actionSheetMoreIsOpen:B=!1}=e,{actionSheetReportIsOpen:C=!1}=e,{modalVisible:S=!1}=e;function ne(c){if(!c)return!1;const P=Me();return P!==null&&String(P)===c}let K=!1,re=!1,ae=-1,ve=-1,ce,we=!1,b=[],V=[],X;async function Q(){Dl({mediaIdx:`${i[o].mediaIdx||0}`,postIdx:`${i[o].idx}`},{replace:!0})}async function Ve(){t(21,K=!0);const c=i.length,P=a.url.searchParams.get("userIdx"),L=a.url.searchParams.get("placeIdx"),q=`&offset=${c}`,U=`&limit=${Bn}`,se=P?`&userIdx=${P}`:"",ye=L?`&placeIdx=${L}`:"",de=(await fetch(`${Se}/posts?${se}${ye}${q}${U}`).then(ke=>ke.json()).then(ke=>{var lt;return((lt=ke.data)==null?void 0:lt.posts)??[]})).map(ke=>({...ke,mediaIdx:0}));de.length===0&&t(22,re=!0),t(0,i=[...i,...de]),t(21,K=!1)}function Be(c){const{height:P}=E;if(o===0&&c>0||o===i.length-1&&c<0){t(9,k=c*.3);return}t(9,k=Math.max(Math.min(c,P),-P))}function Ne(c){t(8,g=!1);const P=Ie(2),L=Pe(c)?c.changedTouches[0].clientY-ve:c.clientY-ve;L>P&&o>0?(t(1,o-=1),d=!0,Q()):-L>P&&o<i.length-1&&(t(1,o+=1),d=!0,Q()),t(9,k=0)}function zt(c){const{width:P}=E,L=i[o].mediaIdx,q=i[o].media.length-1;if(L===0&&c>0||L===q&&c<0){t(10,T=c*.3);return}t(10,T=Math.max(Math.min(c,P),-P))}function Xt(c){t(8,g=!1);const P=Ie(2),L=Pe(c)?c.changedTouches[0].clientX-ae:c.clientX-ae,q=i[o].mediaIdx,U=i[o].media.length-1;L>P&&q>0?Ee(q-1):-L>P&&q<U&&Ee(q+1),t(10,T=0)}function Ee(c){t(0,i[o]={...i[o],mediaIdx:c},i),t(0,i=[...i]),h=!0,Q()}function qe(c){d||h||(we=!0,ce=void 0,Pe(c)?(ae=c.touches[0].clientX,ve=c.touches[0].clientY):(ae=c.clientX,ve=c.clientY,window.addEventListener("mousemove",je,{passive:!1}),window.addEventListener("mouseup",Fe)))}function je(c){if(!we||d||h)return;const[P,L]=On(c),q=P-ae,U=L-ve;ce===void 0&&(ce=Math.abs(U)>=Math.abs(q)?"post":"media"),!v&&ce==="post"?Be(U):ce==="media"&&zt(q)}function Fe(c){!we||d||h||(we=!1,ce==="post"?Ne(c):ce==="media"&&Xt(c),Pe(c)||(window.removeEventListener("mousemove",je),window.removeEventListener("mouseup",Fe)))}function Je(c){if(d||h)return;c.preventDefault();const P=Date.now(),L=Math.abs(c.deltaX),q=Math.abs(c.deltaY);if(L>q){if(V.push({deltaX:c.deltaX,timestamp:P}),V=V.filter(U=>P-U.timestamp<=At),V.length>=2){const U=V[0],se=V[V.length-1];if(Math.abs(se.deltaX)-Math.abs(U.deltaX)>=0&&Math.abs(se.deltaX)>=30){const de=i[o].mediaIdx,ke=i[o].media.length-1;se.deltaX>0&&de<ke?Ee(de+1):se.deltaX<0&&de>0&&Ee(de-1),V=[],h=!0}}}else if(b.push({deltaY:c.deltaY,timestamp:P}),b=b.filter(U=>P-U.timestamp<=At),b.length>=2){const U=b[0],se=b[b.length-1];Math.abs(se.deltaY)-Math.abs(U.deltaY)>=0&&Math.abs(se.deltaY)>=30&&(se.deltaY>0&&o<i.length-1?(t(8,g=!1),t(1,o+=1),Q(),d=!0):se.deltaY<0&&o>0&&(t(8,g=!1),t(1,o-=1),Q(),d=!0),b=[])}}function Ke(c){if(d||h)return;const P=i[o].mediaIdx,L=i[o].media.length-1;switch(c.key){case"ArrowUp":o>0&&(t(8,g=!1),t(1,o--,o),d=!0,Q());break;case"ArrowDown":o<i.length-1&&(t(8,g=!1),t(1,o++,o),d=!0,Q());break;case"ArrowLeft":P>0&&(t(8,g=!1),h=!0,Ee(P-1));break;case"ArrowRight":P<L&&(t(8,g=!1),h=!0,Ee(P+1));break}}function Ht(){t(8,g=!0),d=!1,h=!1}function Qe(){X&&t(11,E={width:X.clientWidth,height:X.clientHeight})}function Zt(){var L,q;const c=Number(a.url.searchParams.get("mediaIdx")||0),P=((q=(L=i.at(o))==null?void 0:L.media)==null?void 0:q.length)||0;c&&c<P?t(0,i[o]={...i[o],mediaIdx:c},i):t(0,i[o]={...i[o],mediaIdx:0},i),t(0,i=[...i]),Q()}function Gt(){document.addEventListener("touchstart",qe,{passive:!1}),document.addEventListener("touchmove",je,{passive:!1}),document.addEventListener("touchend",Fe),document.addEventListener("mousedown",qe,{passive:!1}),document.addEventListener("wheel",Je,{passive:!1}),document.addEventListener("keydown",Ke)}function Wt(){document.removeEventListener("touchstart",qe),document.removeEventListener("touchmove",je),document.removeEventListener("touchend",Fe),document.removeEventListener("mousedown",qe),document.removeEventListener("wheel",Je),document.removeEventListener("keydown",Ke)}kl(()=>{Cl(it,r=!0,r),Qe();const c=new ResizeObserver(()=>Qe());return X&&c.observe(X),Gt(),Zt(),()=>{c.disconnect()}}),Lt(()=>{Wt()});function $e(){var q;if(Y)return;Y=!0;const c=Ye(),P=Me(),L=(q=i[o])==null?void 0:q.idx;if(!c||!P||!L)return Y=!1;fetch(`${Se}/posts/${L}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}}).then(U=>U.json()).then(()=>Ze(`/users/${P}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{Y=!1})}async function et(c){var U,se,ye;const P=(U=i[c])==null?void 0:U.idx;if(P===void 0||_||((se=i[c])==null?void 0:se.needReactionReload)!==!0&&((ye=i[c])!=null&&ye.reactions))return;const L=Ye(),q=await fetch(`${Se}/vote/reactions?targetTable=posts&targetId=${P}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+L}});if(q.ok){const de=await q.json();t(0,i[c].reactions=de.data.reactions,i),t(0,i[c].myReaction=de.data.myReaction,i)}}function me(c,P){if(x)return;x=!0;const L=o,q=i[L];if((q==null?void 0:q.idx)!==c)return x=!1;if(!rt())return q.needReactionReload=!0,x=!1,pe.emit("showSignInModal",{removable:!0,callback:f?()=>{et(L)}:void 0});q.myReaction===P?pe.emit("setReaction",{target:"posts",targetId:c,reaction:null,callback:()=>{t(0,i[L].myReaction=null,i),tt(L,P),x=!1}}):(q.myReaction&&tt(L,q.myReaction),pe.emit("setReaction",{target:"posts",targetId:c,reaction:P,callback:()=>{t(0,i[L].myReaction=P,i),i[L].reactions.some(U=>U.type===P)?t(0,i[L].reactions=i[L].reactions.map(U=>U.type===P?{...U,count:Number(U.count)+1}:U),i):t(0,i[L].reactions=[...i[L].reactions,{type:P,count:1}],i),x=!1}}))}function tt(c,P){let L=[];for(const q of i[c].reactions)if(q.type===P){const U=Number(q.count);U>1&&L.push({...q,count:U-1})}else L.push(q);t(0,i[c].reactions=L,i)}function Jt(c){Il.call(this,n,c)}const Kt=(c,P)=>{me(c.idx,P.type)};function Qt(c,P,L,q){L[q]=c,t(0,i)}const $t=(c,P,L,q)=>{t(0,P[L].isTextExpanded=q.detail.expanded,i)},el=c=>{me(c.idx,"👍")},tl=c=>{me(c.idx,"️🔥")},ll=c=>{me(c.idx,"😍")},nl=c=>{me(c.idx,"😋")},sl=c=>{me(c.idx,"😊️️")},il=(c,P)=>c+Number(P.count),rl=c=>{me(c.idx,c.myReaction||"❤️")},al=(c,P,L)=>{t(0,P[L].onReactionShowcase=!0,i);const q=()=>{t(0,P[L].onReactionShowcase=!1,i),window.removeEventListener("click",q)};setTimeout(()=>{window.addEventListener("click",q)},500)},ol=()=>{if(!rt())return pe.emit("showSignInModal",{removable:!0});t(2,B=!0)};function fl(c){De[c?"unshift":"push"](()=>{X=c,t(12,X)})}const ul=()=>{var c;t(2,B=!1),Ze(`/viewer/edit?type=patch&postIdx=${(c=window.location.search.split("postIdx=")[1])==null?void 0:c.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},cl=()=>{t(2,B=!1),t(4,S=!0)},dl=()=>{Ll(a.url),isOpenActionSheet=!1},hl=()=>{t(2,B=!1),t(3,C=!0)};function ml(c){B=c,t(2,B)}function pl(c){C=c,t(3,C)}const _l=()=>{t(0,i[o].permission_signer="reported",i)},gl=()=>{t(0,i[o].permission_signer=null,i)},bl=()=>{$e(),t(4,S=!1)},vl=()=>{t(4,S=!1)};function wl(c){S=c,t(4,S)}return n.$$set=c=>{"posts"in c&&t(0,i=c.posts),"index"in c&&t(1,o=c.index),"type"in c&&t(18,u=c.type),"isEdit"in c&&t(5,_=c.isEdit),"dontMoveVertically"in c&&t(19,v=c.dontMoveVertically),"selectedReaction"in c&&t(20,I=c.selectedReaction),"hideActionButtons"in c&&t(6,A=c.hideActionButtons),"actionSheetMoreIsOpen"in c&&t(2,B=c.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in c&&t(3,C=c.actionSheetReportIsOpen),"modalVisible"in c&&t(4,S=c.modalVisible)},n.$$.update=()=>{var c;n.$$.dirty[0]&128&&a&&Q(),n.$$.dirty[0]&1048576&&I&&me(I.postIdx,I.reaction),n.$$.dirty[0]&2&&et(o),n.$$.dirty[0]&3&&t(23,l=(c=i[o])==null?void 0:c.user_idx),n.$$.dirty[0]&8388608&&t(13,s=ne(l)),n.$$.dirty[0]&6815747&&!v&&o>=i.length-Pn&&!K&&!re&&Ve()},[i,o,B,C,S,_,A,a,g,k,T,E,X,s,r,Ht,$e,me,u,v,I,K,re,l,Jt,Kt,Qt,$t,el,tl,ll,nl,sl,il,rl,al,ol,fl,ul,cl,dl,hl,ml,pl,_l,gl,bl,vl,wl]}class us extends fe{constructor(e){super(),ue(this,e,Rn,Vn,oe,{posts:0,index:1,type:18,isEdit:5,dontMoveVertically:19,selectedReaction:20,hideActionButtons:6,actionSheetMoreIsOpen:2,actionSheetReportIsOpen:3,modalVisible:4},null,[-1,-1,-1])}}export{us as V};
