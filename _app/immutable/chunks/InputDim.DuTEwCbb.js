import{s as C,l as re,e as y,c as g,b as j,f as _,o as v,i as E,p as I,u as se,q as oe,r as ie,L as Z,a as T,g as V,m as ae,h as k,B as K,n as M,E as le,U as ee,t as ce,d as fe,y as ue,z as de,K as U,v as he,A as me}from"./scheduler.I7jjIWdo.js";import{S as L,i as R,t as A,a as D,c as W,b as F,m as H,d as q}from"./index.DN2oNe6D.js";import{o as pe,a as ve}from"./keyboard.xYhDQsCz.js";import{e as J}from"./each.Du8WEvJj.js";function _e(e){let t,n,s,i,a;const l=e[2].default,o=re(l,e,e[1],null);return{c(){t=y("div"),o&&o.c(),this.h()},l(r){t=g(r,"DIV",{class:!0});var c=j(t);o&&o.l(c),c.forEach(_),this.h()},h(){v(t,"class",n="fixed inset-0 bg-black/50 z-50 "+e[0])},m(r,c){E(r,t,c),o&&o.m(t,null),s=!0,i||(a=I(t,"click",e[3]),i=!0)},p(r,[c]){o&&o.p&&(!s||c&2)&&se(o,l,r,r[1],s?ie(l,r[1],c,null):oe(r[1]),null),(!s||c&1&&n!==(n="fixed inset-0 bg-black/50 z-50 "+r[0]))&&v(t,"class",n)},i(r){s||(A(o,r),s=!0)},o(r){D(o,r),s=!1},d(r){r&&_(t),o&&o.d(r),i=!1,a()}}}function be(e,t,n){let{$$slots:s={},$$scope:i}=t,{className:a=""}=t;function l(o){Z.call(this,e,o)}return e.$$set=o=>{"className"in o&&n(0,a=o.className),"$$scope"in o&&n(1,i=o.$$scope)},[a,i,s,l]}class ye extends L{constructor(t){super(),R(this,t,be,_e,C,{className:0})}}const ge=["local","version","cdnUrl"],we=["skins"],je=["compact","flat","shortcodes"];function ke(e,t){return Pe(e)||Ee(e,t)||Se(e,t)||Oe()}function Oe(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Se(e,t){if(e){if(typeof e=="string")return Y(e,t);var n={}.toString.call(e).slice(8,-1);return n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set"?Array.from(e):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Y(e,t):void 0}}function Y(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,s=Array(t);n<t;n++)s[n]=e[n];return s}function Ee(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var s,i,a,l,o=[],r=!0,c=!1;try{if(a=(n=n.call(e)).next,t!==0)for(;!(r=(s=a.call(n)).done)&&(o.push(s.value),o.length!==t);r=!0);}catch(m){c=!0,i=m}finally{try{if(!r&&n.return!=null&&(l=n.return(),Object(l)!==l))return}finally{if(c)throw i}}return o}}function Pe(e){if(Array.isArray(e))return e}function B(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),n.push.apply(n,s)}return n}function te(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?B(Object(n),!0).forEach(function(s){$e(e,s,n[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):B(Object(n)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(n,s))})}return e}function $e(e,t,n){return(t=Ie(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ie(e){var t=xe(e,"string");return typeof t=="symbol"?t:t+""}function xe(e,t){if(typeof e!="object"||!e)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var s=n.call(e,t||"default");if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function z(e,t){if(e==null)return{};var n,s,i=Ae(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(s=0;s<a.length;s++)n=a[s],t.indexOf(n)>=0||{}.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function Ae(e,t){if(e==null)return{};var n={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)>=0)continue;n[s]=e[s]}return n}function De(e,t,n){let s=`https://cdn.jsdelivr.net/npm/emojibase-data@${t}/${e}`;return typeof n=="function"?s=n(e,t):typeof n=="string"&&(s=`${n}/${e}`),s}async function ne(e,t={}){const n=t.local,s=n===void 0?!1:n,i=t.version,a=i===void 0?"latest":i,l=t.cdnUrl,o=z(t,ge),r=De(e,a,l),c=s?localStorage:sessionStorage,m=`emojibase/${a}/${e}`,u=c.getItem(m);if(u)return JSON.parse(u);const d=await fetch(r,te({credentials:"omit",mode:"cors",redirect:"error"},o));if(!d.ok)throw new Error("Failed to load Emojibase dataset.");const p=await d.json();try{c.setItem(m,JSON.stringify(p))}catch{}return p}const Ne={discord:"joypixels",slack:"iamcal"};async function G(e,t,n){return ne(`${e}/shortcodes/${Ne[t]??t}.json`,n)}function $(e,t){if(t.length===0)return e;const n=new Set(e.shortcodes);return t.forEach(s=>{const i=s[e.hexcode];Array.isArray(i)?i.forEach(a=>n.add(a)):i&&n.add(i)}),e.shortcodes=[...n],e.skins&&e.skins.forEach(s=>{$(s,t)}),e}function Ce(e,t=[]){const n=[];return e.forEach(s=>{if(s.skins){const i=s.skins,a=z(s,we);n.push($(a,t)),i.forEach(l=>{const o=te({},l);a.tags&&(o.tags=[...a.tags]),n.push($(o,t))})}else n.push($(s,t))}),n}function Te(e,t){return t.length===0||e.forEach(n=>{$(n,t)}),e}async function Ve(e,t={}){const n=t.compact,s=n===void 0?!1:n,i=t.flat,a=i===void 0?!1:i,l=t.shortcodes,o=l===void 0?[]:l,r=z(t,je),c=await ne(`${e}/${s?"compact":"data"}.json`,r);let m=[];return o.length>0&&(m=await Promise.all(o.map(u=>{let d;if(u.includes("/")){const p=u.split("/"),h=ke(p,2),w=h[0],O=h[1];d=G(w,O,r)}else d=G(e,u,r);return d.catch(()=>({}))}))),a?Ce(c,m):Te(c,m)}let N=[];Ve("en",{compact:!0,flat:!1}).then(e=>{N=e.slice(26).concat(e.slice(0,26))});function Q(e,t,n){const s=e.slice();return s[3]=t[n],s}function X(e){let t,n=e[3].unicode+"",s,i,a,l;function o(){return e[1](e[3])}return{c(){t=y("div"),s=ce(n),i=T(),this.h()},l(r){t=g(r,"DIV",{class:!0});var c=j(t);s=fe(c,n),i=V(c),c.forEach(_),this.h()},h(){v(t,"class","text-3xl")},m(r,c){E(r,t,c),k(t,s),k(t,i),a||(l=I(t,"click",K(o)),a=!0)},p(r,c){e=r},d(r){r&&_(t),a=!1,l()}}}function Ke(e){let t,n,s,i,a,l,o="backspace",r,c,m=J(N),u=[];for(let d=0;d<m.length;d+=1)u[d]=X(Q(e,m,d));return{c(){t=y("div"),n=y("div");for(let d=0;d<u.length;d+=1)u[d].c();s=T(),i=y("div"),a=y("div"),l=y("div"),l.textContent=o,this.h()},l(d){t=g(d,"DIV",{class:!0});var p=j(t);n=g(p,"DIV",{class:!0});var h=j(n);for(let f=0;f<u.length;f+=1)u[f].l(h);h.forEach(_),s=V(p),i=g(p,"DIV",{class:!0});var w=j(i);a=g(w,"DIV",{class:!0});var O=j(a);l=g(O,"DIV",{"data-svelte-h":!0}),ae(l)!=="svelte-1sht5tp"&&(l.textContent=o),O.forEach(_),w.forEach(_),p.forEach(_),this.h()},h(){v(n,"class","w-full flex-1 grid grid-cols-7 gap-2 justify-items-center p-4 overflow-y-auto "),v(a,"class","flex items-center justify-end"),v(i,"class","absolute bottom-0 w-full bg-white safe-area-pb p-4 h-12"),v(t,"class","w-full h-[300px] max-w-[500px] bg-white rounded-t-lg shadow-xl flex flex-col relative p-2 ")},m(d,p){E(d,t,p),k(t,n);for(let h=0;h<u.length;h+=1)u[h]&&u[h].m(n,null);k(t,s),k(t,i),k(i,a),k(a,l),r||(c=I(l,"click",K(e[2])),r=!0)},p(d,[p]){if(p&1){m=J(N);let h;for(h=0;h<m.length;h+=1){const w=Q(d,m,h);u[h]?u[h].p(w,p):(u[h]=X(w),u[h].c(),u[h].m(n,null))}for(;h<u.length;h+=1)u[h].d(1);u.length=m.length}},i:M,o:M,d(d){d&&_(t),le(u,d),r=!1,c()}}}function Le(e){const t=ee();return[t,i=>{t("click",{emoji:i})},()=>t("backspace")]}class Re extends L{constructor(t){super(),R(this,t,Le,Ke,C,{})}}function ze(e){let t,n,s,i,a,l;return{c(){t=y("div"),n=y("div"),this.h()},l(o){t=g(o,"DIV",{class:!0});var r=j(t);n=g(r,"DIV",{class:!0,contenteditable:!0,inputmode:!0}),j(n).forEach(_),r.forEach(_),this.h()},h(){v(n,"class",s="outline-none ring-0 focus:outline-none focus:ring-0 text-white transition-transform duration-300 text-center "+(e[1]==="emoji"&&e[0]?"translate-y-[-150px]":"translate-y-0")+" caret-white"),v(n,"contenteditable",!0),v(n,"inputmode",i=e[1]==="emoji"?"none":"text"),U(n,"text-2xl",e[1]==="emoji"),v(t,"class","w-full h-full flex items-center justify-center")},m(o,r){E(o,t,r),k(t,n),e[7](n),a||(l=[I(n,"click",K(e[5])),I(n,"keydown",e[6])],a=!0)},p(o,r){r&3&&s!==(s="outline-none ring-0 focus:outline-none focus:ring-0 text-white transition-transform duration-300 text-center "+(o[1]==="emoji"&&o[0]?"translate-y-[-150px]":"translate-y-0")+" caret-white")&&v(n,"class",s),r&2&&i!==(i=o[1]==="emoji"?"none":"text")&&v(n,"inputmode",i),r&3&&U(n,"text-2xl",o[1]==="emoji")},d(o){o&&_(t),e[7](null),a=!1,he(l)}}}function Me(e){let t,n,s,i,a,l;return t=new ye({props:{className:`
    transition-opacity duration-300 
    ${e[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${e[3]?"visible":"invisible"}
  `,$$slots:{default:[ze]},$$scope:{ctx:e}}}),t.$on("click",e[8]),i=new Re({}),i.$on("backspace",e[9]),i.$on("click",e[10]),{c(){W(t.$$.fragment),n=T(),s=y("div"),W(i.$$.fragment),this.h()},l(o){F(t.$$.fragment,o),n=V(o),s=g(o,"DIV",{class:!0});var r=j(s);F(i.$$.fragment,r),r.forEach(_),this.h()},h(){v(s,"class",a="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 "+(e[0]?"translate-y-0":"translate-y-[330px]")+" "+(e[1]==="emoji"&&e[3]?"visible":"invisible"))},m(o,r){H(t,o,r),E(o,n,r),E(o,s,r),H(i,s,null),l=!0},p(o,[r]){const c={};r&9&&(c.className=`
    transition-opacity duration-300 
    ${o[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${o[3]?"visible":"invisible"}
  `),r&16391&&(c.$$scope={dirty:r,ctx:o}),t.$set(c),(!l||r&11&&a!==(a="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 "+(o[0]?"translate-y-0":"translate-y-[330px]")+" "+(o[1]==="emoji"&&o[3]?"visible":"invisible")))&&v(s,"class",a)},i(o){l||(A(t.$$.fragment,o),A(i.$$.fragment,o),l=!0)},o(o){D(t.$$.fragment,o),D(i.$$.fragment,o),l=!1},d(o){o&&(_(n),_(s)),q(t,o),q(i)}}}function Ue(e,t,n){const s=ee();let{isOpen:i=!1}=t,{value:a}=t,{type:l="text"}=t,o=!1,r=null;function c(f){r==null||r.focus(),r==null||r.style.setProperty("transform",`translateY(-${f.keyboardHeight/2}px)`)}function m(){r==null||r.blur(),r==null||r.style.setProperty("transform","translateY(0px)")}ue(()=>{pe(()=>{},c,m),new MutationObserver(b=>{n(4,a=(r==null?void 0:r.innerText)||""),s("change",a)}).observe(r,{childList:!0,subtree:!0})}),de(()=>{ve()});function u(f){Z.call(this,e,f)}const d=f=>{l==="emoji"&&(f.preventDefault(),f.stopPropagation())};function p(f){me[f?"unshift":"push"](()=>{r=f,n(2,r)})}const h=f=>{f.stopPropagation(),n(0,i=!1)},w=()=>{const f=window.getSelection();if(f!=null&&f.rangeCount&&r){const b=f.getRangeAt(0);b.collapsed&&b.setStart(b.startContainer,b.startOffset-1),b.deleteContents(),f.removeAllRanges(),f.addRange(b)}},O=f=>{const b=f.detail.emoji.unicode,S=window.getSelection();if(S!=null&&S.rangeCount&&r){const P=S.getRangeAt(0);P.deleteContents();const x=document.createTextNode(b);P.insertNode(x),P.setStartAfter(x),P.setEndAfter(x),S.removeAllRanges(),S.addRange(P)}};return e.$$set=f=>{"isOpen"in f&&n(0,i=f.isOpen),"value"in f&&n(4,a=f.value),"type"in f&&n(1,l=f.type)},e.$$.update=()=>{e.$$.dirty&21&&(i?(n(3,o=!0),setTimeout(()=>{r&&r.focus()},300),setInterval(()=>{r&&r.focus()},1e3)):setTimeout(()=>{s("close",a),n(3,o=!1)},300))},[i,l,r,o,a,u,d,p,h,w,O]}class Je extends L{constructor(t){super(),R(this,t,Ue,Me,C,{isOpen:0,value:4,type:1})}}export{ye as D,Je as I};
