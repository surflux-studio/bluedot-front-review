import{s as he,D as re,i as q,f as _,e as E,a as F,t as be,c as y,b as S,g as j,d as ve,v as g,h as k,A as H,j as Ne,z as ne,K as Ze,C as ee,n as $,q as je,r as Ue,E as Se,F as we,ae as We,B as Ge,O as Xe,w as Ce,x as Oe,y as jt,U as yl,H as Ut,S as st,k as rt,Q as Tl,I as Dl,N as Ml}from"./scheduler.cMGevFK0.js";import{S as me,i as pe,t as C,g as te,a as O,e as le,c as K,d as W,m as G,f as J,b as Be}from"./index.DSosqu5f.js";import{e as de,u as Je,f as Vl,o as Xt}from"./each.BUpLmwGX.js";import{A as Re,l as ot,b as at,I as Fe}from"./store.CGvrHMmq.js";import{g as Ke}from"./entry.DIA2gAip.js";import{p as Ol}from"./stores.DqM6WIWo.js";import{e as ge}from"./emitter.E5P-NQ8u.js";import{g as He,u as Bl}from"./searchParams.CzM_Fn8q.js";/* empty css                                                     *//* empty css                                                  */import{f as Rl,u as Sl}from"./follow.CcYPbSXQ.js";import{a as Te,g as ze,i as ft}from"./sign.3vAERsXi.js";import{C as Nl}from"./CircleImage.Cb-gmTYT.js";import{g as ut}from"./color.C_Jm4JAr.js";import{s as ct}from"./s32cloudfront.z5a5b5iQ.js";import{I as Al}from"./IconAlert.B4wJNtq8.js";import"./ActionSheet.svelte_svelte_type_style_lang.3WPtczT5.js";import{i as Pl}from"./device.CFvo2wwc.js";import{r as De}from"./units.BJZU6p1c.js";import"./index.4BQPDaLN.js";import{a as Ll}from"./NavigationBar.ChkHTqrX.js";import{C as zt}from"./Chip.DwpeHyYi.js";import{B as ql}from"./BottomNavigationPadder.DY53Hbn4.js";import{C as Fl,I as jl,a as Ul}from"./ChipInstagram.TqoE0WkX.js";import{l as Xl}from"./longPress.C9F0mLoM.js";import{I as zl}from"./IconMore.CoD9sAvd.js";import{A as Yt,o as Yl,a as Hl}from"./ActionSheet.CmgiZBYl.js";import{M as Zl}from"./Modal.CgbAA1XD.js";import{f as Kl,c as Wl,a as Gl}from"./ActionSheetReport.svelte_svelte_type_style_lang.DOuuCOSp.js";import{F as Jl}from"./Figure.Bf7kuMb_.js";import{w as Ql,I as $l}from"./utils.8DJIN5de.js";function dt(n){let e,t,l,i,o,r,f=n[0].unique_name+"",s,a,c,m=String(n[0].user_idx)!==String(Te()),b,I,R;const x=[tn,en],h=[];function d(w,B){return w[0].profile_image_url?0:1}t=d(n),l=h[t]=x[t](n);let p=m&&ht(n);return{c(){e=E("div"),l.c(),i=F(),o=E("div"),r=E("div"),s=be(f),a=F(),c=E("div"),p&&p.c(),this.h()},l(w){e=y(w,"DIV",{class:!0});var B=S(e);l.l(B),i=j(B),o=y(B,"DIV",{class:!0});var V=S(o);r=y(V,"DIV",{class:!0});var A=S(r);s=ve(A,f),A.forEach(_),a=j(V),c=y(V,"DIV",{class:!0});var L=S(c);p&&p.l(L),L.forEach(_),V.forEach(_),B.forEach(_),this.h()},h(){g(r,"class","text-sm text-white"),g(c,"class","flex gap-1 items-center"),g(o,"class","flex gap-1 items-center"),g(e,"class","flex gap-[0.625rem] justify-center items-center")},m(w,B){q(w,e,B),h[t].m(e,null),k(e,i),k(e,o),k(o,r),k(r,s),k(o,a),k(o,c),p&&p.m(c,null),b=!0,I||(R=H(r,"click",n[7]),I=!0)},p(w,B){let V=t;t=d(w),t===V?h[t].p(w,B):(te(),O(h[V],1,1,()=>{h[V]=null}),le(),l=h[t],l?l.p(w,B):(l=h[t]=x[t](w),l.c()),C(l,1),l.m(e,i)),(!b||B&1)&&f!==(f=w[0].unique_name+"")&&Ne(s,f),B&1&&(m=String(w[0].user_idx)!==String(Te())),m?p?p.p(w,B):(p=ht(w),p.c(),p.m(c,null)):p&&(p.d(1),p=null)},i(w){b||(C(l),b=!0)},o(w){O(l),b=!1},d(w){w&&_(e),h[t].d(),p&&p.d(),I=!1,R()}}}function en(n){var f;let e,t,l=(((f=n[0].unique_name)==null?void 0:f.at(0))??"u")+"",i,o,r;return{c(){e=E("div"),t=E("span"),i=be(l),this.h()},l(s){e=y(s,"DIV",{class:!0,style:!0});var a=S(e);t=y(a,"SPAN",{class:!0});var c=S(t);i=ve(c,l),c.forEach(_),a.forEach(_),this.h()},h(){g(t,"class","text-base font-semibold text-black"),g(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),ee(e,"background-color",ut(n[0].unique_name))},m(s,a){q(s,e,a),k(e,t),k(t,i),o||(r=H(e,"click",n[6]),o=!0)},p(s,a){var c;a&1&&l!==(l=(((c=s[0].unique_name)==null?void 0:c.at(0))??"u")+"")&&Ne(i,l),a&1&&ee(e,"background-color",ut(s[0].unique_name))},i:$,o:$,d(s){s&&_(e),o=!1,r()}}}function tn(n){let e,t;return e=new Nl({props:{src:ct(n[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",n[5]),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},p(l,i){const o={};i&1&&(o.src=ct(l[0].profile_image_url,500)),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function ht(n){let e,t="•",l,i,o=n[0].is_following?"팔로잉":"팔로우",r,f,s,a;return{c(){e=E("div"),e.textContent=t,l=F(),i=E("div"),r=be(o),this.h()},l(c){e=y(c,"DIV",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-168vif2"&&(e.textContent=t),l=j(c),i=y(c,"DIV",{class:!0});var m=S(i);r=ve(m,o),m.forEach(_),this.h()},h(){g(e,"class","text-xs text-white/60"),g(i,"class",f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(c,m){q(c,e,m),q(c,l,m),q(c,i,m),k(i,r),s||(a=H(i,"click",function(){Ze(n[0].is_following?n[2]:n[1])&&(n[0].is_following?n[2]:n[1]).apply(this,arguments)}),s=!0)},p(c,m){n=c,m&1&&o!==(o=n[0].is_following?"팔로잉":"팔로우")&&Ne(r,o),m&1&&f!==(f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&g(i,"class",f)},d(c){c&&(_(e),_(l),_(i)),s=!1,a()}}}function ln(n){let e,t,l=n[0].idx&&n[0].unique_name&&dt(n);return{c(){l&&l.c(),e=re()},l(i){l&&l.l(i),e=re()},m(i,o){l&&l.m(i,o),q(i,e,o),t=!0},p(i,[o]){i[0].idx&&i[0].unique_name?l?(l.p(i,o),o&1&&C(l,1)):(l=dt(i),l.c(),C(l,1),l.m(e.parentNode,e)):l&&(te(),O(l,1,1,()=>{l=null}),le())},i(i){t||(C(l),t=!0)},o(i){O(l),t=!1},d(i){i&&_(e),l&&l.d(i)}}}function nn(n,e,t){let{post:l}=e,{allowFollow:i=!0}=e,{whenCancelFollow:o=()=>{}}=e,r=!1;async function f(){if(!i)return o();r||(r=!0,await Rl({targetIdx:l.user_idx,subjectIdx:Te()}),t(0,l.is_following=!0,l),r=!1)}async function s(){if(!i)return o();r||(r=!0,await Sl({targetIdx:l.user_idx,subjectIdx:Te()}),t(0,l.is_following=!1,l),r=!1)}const a=()=>{He(`/users/${l.user_idx}`)},c=()=>{He(`/users/${l.user_idx}`)},m=()=>{He(`/users/${l.user_idx}`)};return n.$$set=b=>{"post"in b&&t(0,l=b.post),"allowFollow"in b&&t(3,i=b.allowFollow),"whenCancelFollow"in b&&t(4,o=b.whenCancelFollow)},[l,f,s,i,o,a,c,m]}class sn extends me{constructor(e){super(),pe(this,e,nn,ln,he,{post:0,allowFollow:3,whenCancelFollow:4})}}function Ye(n){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const i=o=>o.stopPropagation();return n.addEventListener(l,i),{event:l,handler:i}});return{destroy(){t.forEach(({event:l,handler:i})=>{n.removeEventListener(l,i)})}}}function mt(n){let e,t;return e=new zt({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Ll,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:n[0].name}}),e.$on("click",n[1]),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},p(l,i){const o={};i&1&&(o.value=l[0].name),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function rn(n){let e,t,l=n[0].idx&&mt(n);return{c(){l&&l.c(),e=re()},l(i){l&&l.l(i),e=re()},m(i,o){l&&l.m(i,o),q(i,e,o),t=!0},p(i,[o]){i[0].idx?l?(l.p(i,o),o&1&&C(l,1)):(l=mt(i),l.c(),C(l,1),l.m(e.parentNode,e)):l&&(te(),O(l,1,1,()=>{l=null}),le())},i(i){t||(C(l),t=!0)},o(i){O(l),t=!1},d(i){i&&_(e),l&&l.d(i)}}}function on(n,e,t){let{place:l}=e;const i=async()=>{await Ke(`/places/${l.idx}`)};return n.$$set=o=>{"place"in o&&t(0,l=o.place)},[l,i]}class an extends me{constructor(e){super(),pe(this,e,on,rn,he,{place:0})}}function fn(n){let e,t;return{c(){e=je("svg"),t=je("path"),this.h()},l(l){e=Ue(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var i=S(e);t=Ue(i,"path",{d:!0}),S(t).forEach(_),i.forEach(_),this.h()},h(){g(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"viewBox","0 -960 960 960"),g(e,"width",n[1]),g(e,"height",n[1]),g(e,"fill",n[0])},m(l,i){q(l,e,i),k(e,t)},p(l,[i]){i&2&&g(e,"width",l[1]),i&2&&g(e,"height",l[1]),i&1&&g(e,"fill",l[0])},i:$,o:$,d(l){l&&_(e)}}}function un(n,e,t){let l,{fill:i="#5f6368"}=e,{length:o="1.75"}=e,{alt:r="Edit"}=e;return n.$$set=f=>{"fill"in f&&t(0,i=f.fill),"length"in f&&t(2,o=f.length),"alt"in f&&t(3,r=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=De(o))},[i,l,o,r]}class cn extends me{constructor(e){super(),pe(this,e,un,fn,he,{fill:0,length:2,alt:3})}}function dn(n){let e,t;return{c(){e=je("svg"),t=je("path"),this.h()},l(l){e=Ue(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var i=S(e);t=Ue(i,"path",{d:!0}),S(t).forEach(_),i.forEach(_),this.h()},h(){g(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),g(e,"xmlns","http://www.w3.org/2000/svg"),g(e,"viewBox","0 -960 960 960"),g(e,"width",n[1]),g(e,"height",n[1]),g(e,"fill",n[0])},m(l,i){q(l,e,i),k(e,t)},p(l,[i]){i&2&&g(e,"width",l[1]),i&2&&g(e,"height",l[1]),i&1&&g(e,"fill",l[0])},i:$,o:$,d(l){l&&_(e)}}}function hn(n,e,t){let l,{fill:i="#5f6368"}=e,{length:o="1.75"}=e,{alt:r="Delete"}=e;return n.$$set=f=>{"fill"in f&&t(0,i=f.fill),"length"in f&&t(2,o=f.length),"alt"in f&&t(3,r=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=De(o))},[i,l,o,r]}class mn extends me{constructor(e){super(),pe(this,e,hn,dn,he,{fill:0,length:2,alt:3})}}function pn(n){let e,t=(n[0].text||"")+"",l,i,o;return{c(){e=E("p"),l=be(t),this.h()},l(r){e=y(r,"P",{class:!0,style:!0});var f=S(e);l=ve(f,t),f.forEach(_),this.h()},h(){g(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),g(e,"style",`
      overflow: hidden;
      height: ${n[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(r,f){q(r,e,f),k(e,l),i||(o=[Se(Ye.call(null,e)),H(e,"click",n[2])],i=!0)},p(r,[f]){f&1&&t!==(t=(r[0].text||"")+"")&&Ne(l,t)},i:$,o:$,d(r){r&&_(e),i=!1,we(o)}}}function _n(n,e,t){const l=We();let{post:i}=e;const o=De(1),r=De(6);function f(s){const a=s.currentTarget;if(a)if(a.style.height===`${o}px`||!a.style.height){if(a.scrollHeight>o){const c=a.scrollHeight<r?a.scrollHeight:r;a.style.height=`${c}px`,a.style.overflow="scroll",a.style.display="block",a.style.webkitLineClamp="unset",l("textExpanded",{expanded:!0})}}else a.style.height=`${o}px`,a.style.overflow="hidden",a.style.display="-webkit-box",a.style.webkitLineClamp="1",l("textExpanded",{expanded:!1})}return Ge(()=>{l("textExpanded",{expanded:!1})}),n.$$set=s=>{"post"in s&&t(0,i=s.post)},[i,o,f]}class gn extends me{constructor(e){super(),pe(this,e,_n,pn,he,{post:0})}}function bn(n){let e;return{c(){e=E("div"),this.h()},l(t){e=y(t,"DIV",{class:!0,style:!0}),S(e).forEach(_),this.h()},h(){g(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),ee(e,"opacity","0.6"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,l){q(t,e,l)},d(t){t&&_(e)}}}function vn(n){let e;return{c(){e=E("div"),this.h()},l(t){e=y(t,"DIV",{class:!0,style:!0}),S(e).forEach(_),this.h()},h(){g(e,"class","fixed inset-0 pointer-events-none z-30"),ee(e,"opacity","0.7"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,l){q(t,e,l)},d(t){t&&_(e)}}}function wn(n){let e;function t(o,r){return o[0]?vn:bn}let l=t(n),i=l(n);return{c(){i.c(),e=re()},l(o){i.l(o),e=re()},m(o,r){i.m(o,r),q(o,e,r)},p(o,[r]){l!==(l=t(o))&&(i.d(1),i=l(o),i&&(i.c(),i.m(e.parentNode,e)))},i:$,o:$,d(o){o&&_(e),i.d(o)}}}function kn(n,e,t){let{isTextExpanded:l=!1}=e;return n.$$set=i=>{"isTextExpanded"in i&&t(0,l=i.isTextExpanded)},[l]}class Cn extends me{constructor(e){super(),pe(this,e,kn,wn,he,{isTextExpanded:0})}}function pt(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function _t(n,e){let t,l,i,o,r,f=$;return{key:n,first:null,c(){t=E("span"),l=E("span"),o=F(),this.h()},l(s){t=y(s,"SPAN",{class:!0,style:!0});var a=S(t);l=y(a,"SPAN",{class:!0,style:!0}),S(l).forEach(_),o=j(a),a.forEach(_),this.h()},h(){g(l,"class",i=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),ee(l,"transform","scale("+e[4](e[7])+")"),ee(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),g(t,"class","flex items-center justify-center"),ee(t,"width","0.375rem"),ee(t,"height","0.375rem"),this.first=t},m(s,a){q(s,t,a),k(t,l),k(t,o)},p(s,a){e=s,a&13&&i!==(i=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&g(l,"class",i),a&8&&ee(l,"transform","scale("+e[4](e[7])+")"),a&13&&ee(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){r=t.getBoundingClientRect()},f(){Kl(t),f()},a(){f(),f=Wl(t,r,Gl,{})},d(s){s&&_(t)}}}function In(n){let e,t=[],l=new Map,i,o=de(n[3]);const r=f=>f[5];for(let f=0;f<o.length;f+=1){let s=pt(n,o,f),a=r(s);l.set(a,t[f]=_t(a,s))}return{c(){e=E("div");for(let f=0;f<t.length;f+=1)t[f].c();this.h()},l(f){e=y(f,"DIV",{class:!0});var s=S(e);for(let a=0;a<t.length;a+=1)t[a].l(s);s.forEach(_),this.h()},h(){g(e,"class",i=Xe(`
    ${n[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(f,s){q(f,e,s);for(let a=0;a<t.length;a+=1)t[a]&&t[a].m(e,null)},p(f,[s]){if(s&29){o=de(f[3]);for(let a=0;a<t.length;a+=1)t[a].r();t=Je(t,s,r,1,f,o,l,e,Vl,_t,null,pt);for(let a=0;a<t.length;a+=1)t[a].a()}s&2&&i!==(i=Xe(`
    ${f[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&g(e,"class",i)},i:$,o:$,d(f){f&&_(e);for(let s=0;s<t.length;s+=1)t[s].d()}}}const ye=7;function xn(n,e,t){let{post:l}=e,{fixed:i=!0}=e,o=[],r=0;function f(s){const a=l.mediaIdx-r,c=o.length;if(c<=1)return 1;const m=Math.max(a,c-1-a);return m===0?1:1-Math.abs(s-a)/m*.5}return n.$$set=s=>{"post"in s&&t(0,l=s.post),"fixed"in s&&t(1,i=s.fixed)},n.$$.update=()=>{n.$$.dirty&5&&(l.media.length>ye?(l.mediaIdx<=Math.floor(ye/2)?t(2,r=0):l.mediaIdx>=l.media.length-Math.ceil(ye/2)?t(2,r=l.media.length-ye):t(2,r=l.mediaIdx-Math.floor(ye/2)),t(3,o=l.media.slice(r,r+ye))):(t(2,r=0),t(3,o=l.media)))},[l,i,r,o,f]}class Ht extends me{constructor(e){super(),pe(this,e,xn,In,he,{post:0,fixed:1})}}function gt(n,e,t){const l=n.slice();return l[16]=e[t].text,l[17]=e[t].value,l[18]=e[t].custom,l[20]=t,l}function bt(n){let e,t,l,i,o=n[16]+"",r,f,s,a;return{c(){e=E("label"),t=E("input"),l=F(),i=E("span"),r=be(o),f=F(),this.h()},l(c){e=y(c,"LABEL",{class:!0});var m=S(e);t=y(m,"INPUT",{type:!0,name:!0,class:!0}),l=j(m),i=y(m,"SPAN",{class:!0});var b=S(i);r=ve(b,o),b.forEach(_),f=j(m),m.forEach(_),this.h()},h(){g(t,"type","radio"),g(t,"name","report"),g(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=n[17],g(i,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),g(e,"class","flex gap-2 py-2")},m(c,m){q(c,e,m),k(e,t),k(e,l),k(e,i),k(i,r),k(e,f),s||(a=H(t,"change",n[8]),s=!0)},p:$,d(c){c&&_(e),s=!1,a()}}}function vt(n){let e,t,l,i;return{c(){e=E("div"),t=E("textarea"),this.h()},l(o){e=y(o,"DIV",{class:!0});var r=S(e);t=y(r,"TEXTAREA",{class:!0,style:!0,placeholder:!0}),S(t).forEach(_),r.forEach(_),this.h()},h(){g(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal focus:outline-none focus:ring-0 appearance-none "),ee(t,"-webkit-tap-highlight-color","transparent"),g(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),g(e,"class","px-5 py-2.5")},m(o,r){q(o,e,r),k(e,t),n[9](t),st(t,n[3]),l||(i=H(t,"input",n[10]),l=!0)},p(o,r){r&8&&st(t,o[3])},d(o){o&&_(e),n[9](null),l=!1,i()}}}function En(n){let e,t,l="게시물 신고 사유",i,o,r,f,s,a,c="취소",m,b,I="신고",R,x,h=de(n[4]),d=[];for(let w=0;w<h.length;w+=1)d[w]=bt(gt(n,h,w));let p=n[1]==="etc"&&vt(n);return{c(){e=E("div"),t=E("heading"),t.textContent=l,i=F(),o=E("div");for(let w=0;w<d.length;w+=1)d[w].c();r=F(),p&&p.c(),f=F(),s=E("div"),a=E("button"),a.textContent=c,m=F(),b=E("button"),b.textContent=I,this.h()},l(w){e=y(w,"DIV",{class:!0});var B=S(e);t=y(B,"HEADING",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-z3puxq"&&(t.textContent=l),i=j(B),o=y(B,"DIV",{class:!0});var V=S(o);for(let L=0;L<d.length;L+=1)d[L].l(V);V.forEach(_),r=j(B),p&&p.l(B),f=j(B),s=y(B,"DIV",{class:!0});var A=S(s);a=y(A,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(a)!=="svelte-xb8aop"&&(a.textContent=c),m=j(A),b=y(A,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(b)!=="svelte-1fehi46"&&(b.textContent=I),A.forEach(_),B.forEach(_),this.h()},h(){g(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),g(o,"class","px-5"),g(a,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),g(b,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),g(s,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),g(e,"class","flex flex-col gap-2.5")},m(w,B){q(w,e,B),k(e,t),k(e,i),k(e,o);for(let V=0;V<d.length;V+=1)d[V]&&d[V].m(o,null);k(e,r),p&&p.m(e,null),k(e,f),k(e,s),k(s,a),k(s,m),k(s,b),R||(x=[H(a,"click",n[11]),H(b,"click",n[5]),Se(Ye.call(null,e))],R=!0)},p(w,B){if(B&18){h=de(w[4]);let V;for(V=0;V<h.length;V+=1){const A=gt(w,h,V);d[V]?d[V].p(A,B):(d[V]=bt(A),d[V].c(),d[V].m(o,null))}for(;V<d.length;V+=1)d[V].d(1);d.length=h.length}w[1]==="etc"?p?p.p(w,B):(p=vt(w),p.c(),p.m(e,f)):p&&(p.d(1),p=null)},d(w){w&&_(e),Ut(d,w),p&&p.d(),R=!1,we(x)}}}function yn(n){let e,t,l;function i(r){n[12](r)}let o={noHandle:!0,fixed:!0,$$slots:{default:[En]},$$scope:{ctx:n}};return n[0]!==void 0&&(o.isOpen=n[0]),e=new Yt({props:o}),Ce.push(()=>Be(e,"isOpen",i)),{c(){K(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,f){G(e,r,f),l=!0},p(r,[f]){const s={};f&2097167&&(s.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,s.isOpen=r[0],Oe(()=>t=!1)),e.$set(s)},i(r){l||(C(e.$$.fragment,r),l=!0)},o(r){O(e.$$.fragment,r),l=!1},d(r){J(e,r)}}}function Tn(n,e,t){const l=We();let{isOpen:i}=e,{selectedValue:o=""}=e,{targetTable:r=""}=e,{targetIdx:f=""}=e,s=null;const a=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let c="",m=!1;function b(){yl().then(()=>{s==null||s.scrollIntoView({behavior:"smooth",block:"start"})})}jt(()=>{Yl(()=>{},b,()=>{})}),Ge(()=>{Hl()});async function I(){const w=a.findIndex(B=>B.value===o);if(w===-1){alert("신고 사유를 선택해주세요.");return}if(!m){m=!0,ge.emit("loading",!0);try{const B=a[w],V=new URL(`${Re}/auth/reports`);t(0,i=!1),t(3,c=""),await fetch(V,{method:"PUT",headers:{Authorization:`Bearer ${ze()}`},body:JSON.stringify({targetTable:r,targetIdx:f,relation:B.value,metadata:{...B,customReason:c}})}),l("reported")}finally{m=!1,ge.emit("loading",!1)}}}const R=w=>{t(1,o=w.target.value)};function x(w){Ce[w?"unshift":"push"](()=>{s=w,t(2,s)})}function h(){c=this.value,t(3,c)}const d=()=>{t(0,i=!1)};function p(w){i=w,t(0,i)}return n.$$set=w=>{"isOpen"in w&&t(0,i=w.isOpen),"selectedValue"in w&&t(1,o=w.selectedValue),"targetTable"in w&&t(6,r=w.targetTable),"targetIdx"in w&&t(7,f=w.targetIdx)},[i,o,s,c,a,I,r,f,R,x,h,d,p]}class Dn extends me{constructor(e){super(),pe(this,e,Tn,yn,he,{isOpen:0,selectedValue:1,targetTable:6,targetIdx:7})}}function wt(n){let e,t,l,i="이 게시물을 신고해 주셔서 감사합니다.",o,r,f="신고 취소하기",s,a;return{c(){e=E("div"),t=E("div"),l=E("div"),l.textContent=i,o=F(),r=E("div"),r.textContent=f,this.h()},l(c){e=y(c,"DIV",{class:!0});var m=S(e);t=y(m,"DIV",{class:!0});var b=S(t);l=y(b,"DIV",{class:!0,"data-svelte-h":!0}),ne(l)!=="svelte-179ijsk"&&(l.textContent=i),o=j(b),r=y(b,"DIV",{class:!0,"data-svelte-h":!0}),ne(r)!=="svelte-1haiztv"&&(r.textContent=f),b.forEach(_),m.forEach(_),this.h()},h(){g(l,"class","text-white text-[0.9375rem] font-semibold"),g(r,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),g(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),g(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(c,m){q(c,e,m),k(e,t),k(t,l),k(t,o),k(t,r),s||(a=H(r,"click",n[1]),s=!0)},p:$,d(c){c&&_(e),s=!1,a()}}}function Mn(n){let e,t=n[0]&&wt(n);return{c(){t&&t.c(),e=re()},l(l){t&&t.l(l),e=re()},m(l,i){t&&t.m(l,i),q(l,e,i)},p(l,[i]){l[0]?t?t.p(l,i):(t=wt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&_(e),t&&t.d(l)}}}function Vn(n,e,t){const l=We();let{isVisible:i=!1}=e,{targetTable:o=""}=e,{targetIdx:r=""}=e,f=!1;async function s(){if(f!==!0){f=!0,ge.emit("loading",!0);try{const a=new URL(`${Re}/auth/reports`);await fetch(a,{method:"DELETE",headers:{Authorization:`Bearer ${ze()}`},body:JSON.stringify({targetTable:o,targetIdx:r})}),t(0,i=!1),l("unreported")}finally{f=!1,ge.emit("loading",!1)}}}return n.$$set=a=>{"isVisible"in a&&t(0,i=a.isVisible),"targetTable"in a&&t(2,o=a.targetTable),"targetIdx"in a&&t(3,r=a.targetIdx)},[i,s,o,r]}class On extends me{constructor(e){super(),pe(this,e,Vn,Mn,he,{isVisible:0,targetTable:2,targetIdx:3})}}function kt(n,e,t){const l=n.slice();return l[82]=e[t],l[83]=e,l[84]=t,l}function Ct(n,e,t){const l=n.slice();return l[85]=e[t],l}function It(n,e,t){const l=n.slice();return l[88]=e[t],l[90]=t,l}function xt(n){let e,t,l;return{c(){e=E("div"),this.h()},l(i){e=y(i,"DIV",{class:!0}),S(e).forEach(_),this.h()},h(){g(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(i,o){q(i,e,o),t||(l=H(e,"contextmenu",Dl(n[25])),t=!0)},d(i){i&&_(e),t=!1,l()}}}function Et(n){let e,t,l,i=[],o=new Map,r,f,s,a,c,m,b,I=de(n[82].media);const R=h=>h[88];for(let h=0;h<I.length;h+=1){let d=It(n,I,h),p=R(d);o.set(p,i[h]=yt(p,d))}let x=!n[4]&&Tt(n);return{c(){e=E("section"),t=E("div"),l=E("div");for(let h=0;h<i.length;h+=1)i[h].c();f=F(),x&&x.c(),s=F(),this.h()},l(h){e=y(h,"SECTION",{class:!0,style:!0});var d=S(e);t=y(d,"DIV",{class:!0});var p=S(t);l=y(p,"DIV",{class:!0,style:!0});var w=S(l);for(let B=0;B<i.length;B+=1)i[B].l(w);w.forEach(_),p.forEach(_),f=j(d),x&&x.l(d),s=j(d),d.forEach(_),this.h()},h(){g(l,"class",r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")),ee(l,"transform","translateX("+(-n[82].mediaIdx*n[11].width+n[10])+"px)"),g(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),g(e,"class",a=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`),ee(e,"top","0"),ee(e,"transform","translateY("+((n[84]-n[0])*n[11].height+n[9])+"px)")},m(h,d){q(h,e,d),k(e,t),k(t,l);for(let p=0;p<i.length;p+=1)i[p]&&i[p].m(l,null);k(e,f),x&&x.m(e,null),k(e,s),c=!0,m||(b=[H(l,"transitionend",function(){Ze(n[82].mediaIdx===n[7][n[0]].mediaIdx?n[15]:void 0)&&(n[82].mediaIdx===n[7][n[0]].mediaIdx?n[15]:void 0).apply(this,arguments)}),H(e,"transitionend",function(){Ze(n[84]===n[0]?n[15]:void 0)&&(n[84]===n[0]?n[15]:void 0).apply(this,arguments)})],m=!0)},p(h,d){n=h,d[0]&16529&&(I=de(n[82].media),te(),i=Je(i,d,R,1,n,I,o,l,Xt,yt,null,It),le()),(!c||d[0]&256&&r!==(r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")))&&g(l,"class",r),(!c||d[0]&3200)&&ee(l,"transform","translateX("+(-n[82].mediaIdx*n[11].width+n[10])+"px)"),n[4]?x&&(te(),O(x,1,1,()=>{x=null}),le()):x?(x.p(n,d),d[0]&16&&C(x,1)):(x=Tt(n),x.c(),C(x,1),x.m(e,s)),(!c||d[0]&256&&a!==(a=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`))&&g(e,"class",a),(!c||d[0]&2689)&&ee(e,"transform","translateY("+((n[84]-n[0])*n[11].height+n[9])+"px)")},i(h){if(!c){for(let d=0;d<I.length;d+=1)C(i[d]);C(x),c=!0}},o(h){for(let d=0;d<i.length;d+=1)O(i[d]);O(x),c=!1},d(h){h&&_(e);for(let d=0;d<i.length;d+=1)i[d].d();x&&x.d(),m=!1,we(b)}}}function yt(n,e){let t,l,i,o,r,f;return i=new Jl({props:{src:e[88],isEdit:e[4],post:e[7][e[0]],muted:e[14],autoplay:e[0]===e[84]&&e[7][e[0]].mediaIdx===e[90],isRightOrder:e[0]===e[84]}}),{key:n,first:null,c(){t=E("div"),l=E("div"),K(i.$$.fragment),r=F(),this.h()},l(s){t=y(s,"DIV",{class:!0});var a=S(t);l=y(a,"DIV",{class:!0});var c=S(l);W(i.$$.fragment,c),c.forEach(_),r=j(a),a.forEach(_),this.h()},h(){g(l,"class",o=`
                      w-full h-full flex justify-center items-center relative
                      ${e[4]?"px-5 pt-5 pb-3":""}
                    `),g(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(s,a){q(s,t,a),k(t,l),G(i,l,null),k(t,r),f=!0},p(s,a){e=s;const c={};a[0]&128&&(c.src=e[88]),a[0]&16&&(c.isEdit=e[4]),a[0]&129&&(c.post=e[7][e[0]]),a[0]&16384&&(c.muted=e[14]),a[0]&129&&(c.autoplay=e[0]===e[84]&&e[7][e[0]].mediaIdx===e[90]),a[0]&129&&(c.isRightOrder=e[0]===e[84]),i.$set(c),(!f||a[0]&16&&o!==(o=`
                      w-full h-full flex justify-center items-center relative
                      ${e[4]?"px-5 pt-5 pb-3":""}
                    `))&&g(l,"class",o)},i(s){f||(C(i.$$.fragment,s),f=!0)},o(s){O(i.$$.fragment,s),f=!1},d(s){s&&_(t),J(i)}}}function Tt(n){var T,X;let e,t,l,i,o,r,f,s,a,c,m,b,I,R,x,h=n[82].media.length>1&&Dt(n),d=((T=n[82].reference)==null?void 0:T.origin)==="instagram"&&Mt(n),p=((X=n[82].reactions)==null?void 0:X.length)>0&&!n[5]&&Vt(n);function w(N){n[28](N,n[82],n[83],n[84])}let B={allowFollow:!Fe,whenCancelFollow:n[27]};n[82]!==void 0&&(B.post=n[82]),r=new sn({props:B}),Ce.push(()=>Be(r,"post",w));function V(...N){return n[29](n[82],n[83],n[84],...N)}a=new gn({props:{post:n[82]}}),a.$on("textExpanded",V),m=new an({props:{place:{idx:n[82].place_idx,name:n[82].place_name}}});let A=!n[5]&&Bt(n),L=n[0]===n[84]&&St(n);return{c(){h&&h.c(),e=F(),t=E("div"),l=E("div"),d&&d.c(),i=F(),p&&p.c(),o=F(),K(r.$$.fragment),s=F(),K(a.$$.fragment),c=F(),K(m.$$.fragment),b=F(),A&&A.c(),I=F(),L&&L.c(),R=re(),this.h()},l(N){h&&h.l(N),e=j(N),t=y(N,"DIV",{class:!0});var z=S(t);l=y(z,"DIV",{class:!0});var Z=S(l);d&&d.l(Z),i=j(Z),p&&p.l(Z),o=j(Z),W(r.$$.fragment,Z),s=j(Z),W(a.$$.fragment,Z),c=j(Z),W(m.$$.fragment,Z),Z.forEach(_),b=j(z),A&&A.l(z),z.forEach(_),I=j(N),L&&L.l(N),R=re(),this.h()},h(){g(l,"class","flex-grow text-white text-md flex flex-col items-start gap-3 transition-transform text-base "),g(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(N,z){h&&h.m(N,z),q(N,e,z),q(N,t,z),k(t,l),d&&d.m(l,null),k(l,i),p&&p.m(l,null),k(l,o),G(r,l,null),k(l,s),G(a,l,null),k(l,c),G(m,l,null),k(t,b),A&&A.m(t,null),q(N,I,z),L&&L.m(N,z),q(N,R,z),x=!0},p(N,z){var fe,oe;n=N,n[82].media.length>1?h?(h.p(n,z),z[0]&128&&C(h,1)):(h=Dt(n),h.c(),C(h,1),h.m(e.parentNode,e)):h&&(te(),O(h,1,1,()=>{h=null}),le()),((fe=n[82].reference)==null?void 0:fe.origin)==="instagram"?d?(d.p(n,z),z[0]&128&&C(d,1)):(d=Mt(n),d.c(),C(d,1),d.m(l,i)):d&&(te(),O(d,1,1,()=>{d=null}),le()),((oe=n[82].reactions)==null?void 0:oe.length)>0&&!n[5]?p?(p.p(n,z),z[0]&160&&C(p,1)):(p=Vt(n),p.c(),C(p,1),p.m(l,o)):p&&(te(),O(p,1,1,()=>{p=null}),le());const Z={};z[0]&64&&(Z.whenCancelFollow=n[27]),!f&&z[0]&128&&(f=!0,Z.post=n[82],Oe(()=>f=!1)),r.$set(Z);const ae={};z[0]&128&&(ae.post=n[82]),a.$set(ae);const ue={};z[0]&128&&(ue.place={idx:n[82].place_idx,name:n[82].place_name}),m.$set(ue),n[5]?A&&(te(),O(A,1,1,()=>{A=null}),le()):A?(A.p(n,z),z[0]&32&&C(A,1)):(A=Bt(n),A.c(),C(A,1),A.m(t,null)),n[0]===n[84]?L?(L.p(n,z),z[0]&129&&C(L,1)):(L=St(n),L.c(),C(L,1),L.m(R.parentNode,R)):L&&(te(),O(L,1,1,()=>{L=null}),le())},i(N){x||(C(h),C(d),C(p),C(r.$$.fragment,N),C(a.$$.fragment,N),C(m.$$.fragment,N),C(A),C(L),x=!0)},o(N){O(h),O(d),O(p),O(r.$$.fragment,N),O(a.$$.fragment,N),O(m.$$.fragment,N),O(A),O(L),x=!1},d(N){N&&(_(e),_(t),_(I),_(R)),h&&h.d(N),d&&d.d(),p&&p.d(),J(r),J(a),J(m),A&&A.d(),L&&L.d(N)}}}function Dt(n){let e,t;return e=new Ht({props:{post:n[82]}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},p(l,i){const o={};i[0]&128&&(o.post=l[82]),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Mt(n){let e,t;return e=new Fl({props:{url:n[82].reference.url,name:n[82].reference.name}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},p(l,i){const o={};i[0]&128&&(o.url=l[82].reference.url),i[0]&128&&(o.name=l[82].reference.name),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Vt(n){let e,t,l=de(n[82].reactions),i=[];for(let r=0;r<l.length;r+=1)i[r]=Ot(Ct(n,l,r));const o=r=>O(i[r],1,1,()=>{i[r]=null});return{c(){e=E("div");for(let r=0;r<i.length;r+=1)i[r].c();this.h()},l(r){e=y(r,"DIV",{class:!0});var f=S(e);for(let s=0;s<i.length;s+=1)i[s].l(f);f.forEach(_),this.h()},h(){g(e,"class","flex gap-1 justify-center items-center mb-1")},m(r,f){q(r,e,f);for(let s=0;s<i.length;s+=1)i[s]&&i[s].m(e,null);t=!0},p(r,f){if(f[0]&131200){l=de(r[82].reactions);let s;for(s=0;s<l.length;s+=1){const a=Ct(r,l,s);i[s]?(i[s].p(a,f),C(i[s],1)):(i[s]=Ot(a),i[s].c(),C(i[s],1),i[s].m(e,null))}for(te(),s=l.length;s<i.length;s+=1)o(s);le()}},i(r){if(!t){for(let f=0;f<l.length;f+=1)C(i[f]);t=!0}},o(r){i=i.filter(Boolean);for(let f=0;f<i.length;f+=1)O(i[f]);t=!1},d(r){r&&_(e),Ut(i,r)}}}function Ot(n){let e,t;function l(){return n[26](n[82],n[85])}return e=new zt({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:n[85].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:n[85].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",l),{c(){K(e.$$.fragment)},l(i){W(e.$$.fragment,i)},m(i,o){G(e,i,o),t=!0},p(i,o){n=i;const r={};o[0]&128&&(r.prefix=n[85].type),o[0]&128&&(r.value=n[85].count),e.$set(r)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){O(e.$$.fragment,i),t=!1},d(i){J(e,i)}}}function Bt(n){var L;let e,t,l,i,o,r,f,s,a=((L=n[82].reactions)!=null&&L.length?n[82].reactions.reduce(n[35],0):0)+"",c,m,b,I,R,x,h,d=n[82].onReactionShowcase&&Rt(n);const p=[Rn,Bn],w=[];function B(T,X){return T[82].myReaction?0:1}o=B(n),r=w[o]=p[o](n);function V(){return n[36](n[82])}function A(){return n[37](n[82],n[83],n[84])}return I=new zl({props:{fill:"white",length:1.5}}),{c(){e=E("div"),t=E("div"),d&&d.c(),l=F(),i=E("button"),r.c(),f=F(),s=E("span"),c=be(a),m=F(),b=E("button"),K(I.$$.fragment),this.h()},l(T){e=y(T,"DIV",{class:!0});var X=S(e);t=y(X,"DIV",{class:!0});var N=S(t);d&&d.l(N),l=j(N),i=y(N,"BUTTON",{class:!0});var z=S(i);r.l(z),f=j(z),s=y(z,"SPAN",{class:!0});var Z=S(s);c=ve(Z,a),Z.forEach(_),z.forEach(_),N.forEach(_),m=j(X),b=y(X,"BUTTON",{});var ae=S(b);W(I.$$.fragment,ae),ae.forEach(_),X.forEach(_),this.h()},h(){g(s,"class","text-xs text-white h-4"),g(i,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),g(t,"class","flex gap-4 relative"),g(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(T,X){q(T,e,X),k(e,t),d&&d.m(t,null),k(t,l),k(t,i),w[o].m(i,null),k(i,f),k(i,s),k(s,c),k(e,m),k(e,b),G(I,b,null),R=!0,x||(h=[H(i,"click",V),Se(Ye.call(null,i)),Se(Xl.call(null,i,500)),H(i,"longpress",A),H(b,"click",n[38])],x=!0)},p(T,X){var z;n=T,n[82].onReactionShowcase?d?d.p(n,X):(d=Rt(n),d.c(),d.m(t,l)):d&&(d.d(1),d=null);let N=o;o=B(n),o!==N&&(te(),O(w[N],1,1,()=>{w[N]=null}),le(),r=w[o],r||(r=w[o]=p[o](n),r.c()),C(r,1),r.m(i,f)),(!R||X[0]&128)&&a!==(a=((z=n[82].reactions)!=null&&z.length?n[82].reactions.reduce(n[35],0):0)+"")&&Ne(c,a)},i(T){R||(C(r),C(I.$$.fragment,T),R=!0)},o(T){O(r),O(I.$$.fragment,T),R=!1},d(T){T&&_(e),d&&d.d(),w[o].d(),J(I),x=!1,we(h)}}}function Rt(n){let e,t,l="👍",i,o,r="🔥",f,s,a="😍",c,m,b="😋",I,R,x="😊️️",h,d;function p(){return n[30](n[82])}function w(){return n[31](n[82])}function B(){return n[32](n[82])}function V(){return n[33](n[82])}function A(){return n[34](n[82])}return{c(){e=E("div"),t=E("button"),t.textContent=l,i=F(),o=E("button"),o.textContent=r,f=F(),s=E("button"),s.textContent=a,c=F(),m=E("button"),m.textContent=b,I=F(),R=E("button"),R.textContent=x,this.h()},l(L){e=y(L,"DIV",{class:!0});var T=S(e);t=y(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-3oecln"&&(t.textContent=l),i=j(T),o=y(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(o)!=="svelte-131qbu2"&&(o.textContent=r),f=j(T),s=y(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(s)!=="svelte-lq90i3"&&(s.textContent=a),c=j(T),m=y(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(m)!=="svelte-l73y87"&&(m.textContent=b),I=j(T),R=y(T,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(R)!=="svelte-11szxsj"&&(R.textContent=x),T.forEach(_),this.h()},h(){g(t,"class","text-2xl/[26px]"),g(o,"class","text-2xl/[26px]"),g(s,"class","text-2xl/[26px]"),g(m,"class","text-2xl/[26px]"),g(R,"class","text-2xl/[26px]"),g(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(L,T){q(L,e,T),k(e,t),k(e,i),k(e,o),k(e,f),k(e,s),k(e,c),k(e,m),k(e,I),k(e,R),h||(d=[H(t,"click",p),H(o,"click",w),H(s,"click",B),H(m,"click",V),H(R,"click",A)],h=!0)},p(L,T){n=L},d(L){L&&_(e),h=!1,we(d)}}}function Bn(n){let e,t;return e=new jl({props:{fill:"white",length:1.5}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Rn(n){let e,t;return e=new Ul({props:{fill:"#EA3323",length:1.5}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function St(n){let e,t;return e=new Cn({props:{isTextExpanded:n[82].isTextExpanded}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},p(l,i){const o={};i[0]&128&&(o.isTextExpanded=l[82].isTextExpanded),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Nt(n,e){let t,l=Math.abs(e[0]-e[84])<=5,i,o,r=l&&Et(e);return{key:n,first:null,c(){t=re(),r&&r.c(),i=re(),this.h()},l(f){t=re(),r&&r.l(f),i=re(),this.h()},h(){this.first=t},m(f,s){q(f,t,s),r&&r.m(f,s),q(f,i,s),o=!0},p(f,s){e=f,s[0]&129&&(l=Math.abs(e[0]-e[84])<=5),l?r?(r.p(e,s),s[0]&129&&C(r,1)):(r=Et(e),r.c(),C(r,1),r.m(i.parentNode,i)):r&&(te(),O(r,1,1,()=>{r=null}),le())},i(f){o||(C(r),o=!0)},o(f){O(r),o=!1},d(f){f&&(_(t),_(i)),r&&r.d(f)}}}function At(n){let e,t;return e=new Ht({props:{post:n[7][n[0]],fixed:!1}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},p(l,i){const o={};i[0]&129&&(o.post=l[7][l[0]]),e.$set(o)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Pt(n){let e,t;return e=new ql({}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,i){G(e,l,i),t=!0},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Lt(n){let e,t,l,i,o="수정",r,f,s,a,c,m="삭제",b,I,R;return t=new cn({props:{fill:"white",length:1.5}}),s=new mn({props:{fill:"white",length:1.5}}),{c(){e=E("button"),K(t.$$.fragment),l=F(),i=E("span"),i.textContent=o,r=F(),f=E("button"),K(s.$$.fragment),a=F(),c=E("span"),c.textContent=m,this.h()},l(x){e=y(x,"BUTTON",{class:!0});var h=S(e);W(t.$$.fragment,h),l=j(h),i=y(h,"SPAN",{"data-svelte-h":!0}),ne(i)!=="svelte-17aljrl"&&(i.textContent=o),h.forEach(_),r=j(x),f=y(x,"BUTTON",{class:!0});var d=S(f);W(s.$$.fragment,d),a=j(d),c=y(d,"SPAN",{"data-svelte-h":!0}),ne(c)!=="svelte-1k1dgz"&&(c.textContent=m),d.forEach(_),this.h()},h(){g(e,"class","flex items-center gap-2 text-white text-sm"),g(f,"class","flex items-center gap-2 text-white text-sm")},m(x,h){q(x,e,h),G(t,e,null),k(e,l),k(e,i),q(x,r,h),q(x,f,h),G(s,f,null),k(f,a),k(f,c),b=!0,I||(R=[H(e,"click",n[40]),H(f,"click",n[41])],I=!0)},p:$,i(x){b||(C(t.$$.fragment,x),C(s.$$.fragment,x),b=!0)},o(x){O(t.$$.fragment,x),O(s.$$.fragment,x),b=!1},d(x){x&&(_(e),_(r),_(f)),J(t),J(s),I=!1,we(R)}}}function qt(n){let e,t,l,i,o,r;return t=new Al({}),{c(){e=E("button"),K(t.$$.fragment),l=be(`
        신고`),this.h()},l(f){e=y(f,"BUTTON",{class:!0});var s=S(e);W(t.$$.fragment,s),l=ve(s,`
        신고`),s.forEach(_),this.h()},h(){g(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(f,s){q(f,e,s),G(t,e,null),k(e,l),i=!0,o||(r=H(e,"click",n[43]),o=!0)},p:$,i(f){i||(C(t.$$.fragment,f),i=!0)},o(f){O(t.$$.fragment,f),i=!1},d(f){f&&_(e),J(t),o=!1,r()}}}function Sn(n){let e,t,l,i,o,r,f,s,a,c=n[13]&&Lt(n);i=new $l({props:{length:1.5,fill:"white"}});let m=!n[13]&&qt(n);return{c(){e=E("div"),c&&c.c(),t=F(),l=E("button"),K(i.$$.fragment),o=be(`
      링크 복사`),r=F(),m&&m.c(),this.h()},l(b){e=y(b,"DIV",{id:!0,class:!0});var I=S(e);c&&c.l(I),t=j(I),l=y(I,"BUTTON",{class:!0});var R=S(l);W(i.$$.fragment,R),o=ve(R,`
      링크 복사`),R.forEach(_),r=j(I),m&&m.l(I),I.forEach(_),this.h()},h(){g(l,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),g(e,"id","test"),g(e,"class","flex flex-col px-5 gap-3")},m(b,I){q(b,e,I),c&&c.m(e,null),k(e,t),k(e,l),G(i,l,null),k(l,o),k(e,r),m&&m.m(e,null),f=!0,s||(a=[H(l,"click",n[42]),Se(Ye.call(null,e))],s=!0)},p(b,I){b[13]?c?(c.p(b,I),I[0]&8192&&C(c,1)):(c=Lt(b),c.c(),C(c,1),c.m(e,t)):c&&(te(),O(c,1,1,()=>{c=null}),le()),b[13]?m&&(te(),O(m,1,1,()=>{m=null}),le()):m?(m.p(b,I),I[0]&8192&&C(m,1)):(m=qt(b),m.c(),C(m,1),m.m(e,null))},i(b){f||(C(c),C(i.$$.fragment,b),C(m),f=!0)},o(b){O(c),O(i.$$.fragment,b),O(m),f=!1},d(b){b&&_(e),c&&c.d(),J(i),m&&m.d(),s=!1,we(a)}}}function Nn(n){let e,t,l="정말로 삭제하시겠습니까?",i,o,r="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",f,s,a,c="삭제",m,b,I="취소",R,x;return{c(){e=E("div"),t=E("h2"),t.textContent=l,i=F(),o=E("p"),o.textContent=r,f=F(),s=E("div"),a=E("button"),a.textContent=c,m=F(),b=E("button"),b.textContent=I,this.h()},l(h){e=y(h,"DIV",{class:!0});var d=S(e);t=y(d,"H2",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1yzhdkj"&&(t.textContent=l),i=j(d),o=y(d,"P",{class:!0,"data-svelte-h":!0}),ne(o)!=="svelte-26p028"&&(o.textContent=r),f=j(d),s=y(d,"DIV",{class:!0});var p=S(s);a=y(p,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(a)!=="svelte-1q4epan"&&(a.textContent=c),m=j(p),b=y(p,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(b)!=="svelte-1rzg9yy"&&(b.textContent=I),p.forEach(_),d.forEach(_),this.h()},h(){g(t,"class","text-lg font-semibold mb-2"),g(o,"class","text-gray-600 mb-4"),g(a,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),g(b,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),g(s,"class","flex justify-center space-x-4"),g(e,"class","text-center")},m(h,d){q(h,e,d),k(e,t),k(e,i),k(e,o),k(e,f),k(e,s),k(s,a),k(s,m),k(s,b),R||(x=[H(a,"click",n[48]),H(b,"click",n[49])],R=!0)},p:$,d(h){h&&_(e),R=!1,we(x)}}}function An(n){var oe;let e,t,l,i=[],o=new Map,r,f,s,a,c,m,b,I,R,x,h,d,p,w,B,V=!n[4]&&xt(n),A=de(n[7]);const L=v=>v[82].idx;for(let v=0;v<A.length;v+=1){let D=kt(n,A,v),Q=L(D);o.set(Q,i[v]=Nt(Q,D))}let T=n[4]&&((oe=n[7][n[0]])==null?void 0:oe.media.length)>1&&At(n),X=!n[4]&&Pt();function N(v){n[44](v)}let z={fixed:!0,noHandle:!0,$$slots:{default:[Sn]},$$scope:{ctx:n}};n[1]!==void 0&&(z.isOpen=n[1]),c=new Yt({props:z}),Ce.push(()=>Be(c,"isOpen",N));function Z(v){n[45](v)}let ae={targetTable:"posts",targetIdx:n[7][n[0]].idx};n[2]!==void 0&&(ae.isOpen=n[2]),I=new Dn({props:ae}),Ce.push(()=>Be(I,"isOpen",Z)),I.$on("reported",n[46]),h=new On({props:{isVisible:n[7][n[0]].is_reported===!0,targetTable:"posts",targetIdx:n[7][n[0]].idx}}),h.$on("unreported",n[47]);function ue(v){n[50](v)}let fe={$$slots:{default:[Nn]},$$scope:{ctx:n}};return n[3]!==void 0&&(fe.modalVisible=n[3]),p=new Zl({props:fe}),Ce.push(()=>Be(p,"modalVisible",ue)),{c(){V&&V.c(),e=F(),t=E("div"),l=E("div");for(let v=0;v<i.length;v+=1)i[v].c();r=F(),T&&T.c(),f=F(),X&&X.c(),a=F(),K(c.$$.fragment),b=F(),K(I.$$.fragment),x=F(),K(h.$$.fragment),d=F(),K(p.$$.fragment),this.h()},l(v){V&&V.l(v),e=j(v),t=y(v,"DIV",{class:!0});var D=S(t);l=y(D,"DIV",{class:!0});var Q=S(l);for(let ie=0;ie<i.length;ie+=1)i[ie].l(Q);Q.forEach(_),r=j(D),T&&T.l(D),f=j(D),X&&X.l(D),D.forEach(_),a=j(v),W(c.$$.fragment,v),b=j(v),W(I.$$.fragment,v),x=j(v),W(h.$$.fragment,v),d=j(v),W(p.$$.fragment,v),this.h()},h(){g(l,"class","flex flex-grow relative w-full h-full bg-black"),g(t,"class",s="viewer bg-black select-none flex flex-col "+(n[4]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh"))},m(v,D){V&&V.m(v,D),q(v,e,D),q(v,t,D),k(t,l);for(let Q=0;Q<i.length;Q+=1)i[Q]&&i[Q].m(l,null);k(t,r),T&&T.m(t,null),k(t,f),X&&X.m(t,null),n[39](t),q(v,a,D),G(c,v,D),q(v,b,D),G(I,v,D),q(v,x,D),G(h,v,D),q(v,d,D),G(p,v,D),B=!0},p(v,D){var Ae;v[4]?V&&(V.d(1),V=null):V||(V=xt(v),V.c(),V.m(e.parentNode,e)),D[0]&184307&&(A=de(v[7]),te(),i=Je(i,D,L,1,v,A,o,l,Xt,Nt,null,kt),le()),v[4]&&((Ae=v[7][v[0]])==null?void 0:Ae.media.length)>1?T?(T.p(v,D),D[0]&145&&C(T,1)):(T=At(v),T.c(),C(T,1),T.m(t,f)):T&&(te(),O(T,1,1,()=>{T=null}),le()),v[4]?X&&(te(),O(X,1,1,()=>{X=null}),le()):X?D[0]&16&&C(X,1):(X=Pt(),X.c(),C(X,1),X.m(t,null)),(!B||D[0]&16&&s!==(s="viewer bg-black select-none flex flex-col "+(v[4]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh")))&&g(t,"class",s);const Q={};D[0]&8206|D[2]&536870912&&(Q.$$scope={dirty:D,ctx:v}),!m&&D[0]&2&&(m=!0,Q.isOpen=v[1],Oe(()=>m=!1)),c.$set(Q);const ie={};D[0]&129&&(ie.targetIdx=v[7][v[0]].idx),!R&&D[0]&4&&(R=!0,ie.isOpen=v[2],Oe(()=>R=!1)),I.$set(ie);const Ie={};D[0]&129&&(Ie.isVisible=v[7][v[0]].is_reported===!0),D[0]&129&&(Ie.targetIdx=v[7][v[0]].idx),h.$set(Ie);const Me={};D[0]&8|D[2]&536870912&&(Me.$$scope={dirty:D,ctx:v}),!w&&D[0]&8&&(w=!0,Me.modalVisible=v[3],Oe(()=>w=!1)),p.$set(Me)},i(v){if(!B){for(let D=0;D<A.length;D+=1)C(i[D]);C(T),C(X),C(c.$$.fragment,v),C(I.$$.fragment,v),C(h.$$.fragment,v),C(p.$$.fragment,v),B=!0}},o(v){for(let D=0;D<i.length;D+=1)O(i[D]);O(T),O(X),O(c.$$.fragment,v),O(I.$$.fragment,v),O(h.$$.fragment,v),O(p.$$.fragment,v),B=!1},d(v){v&&(_(e),_(t),_(a),_(b),_(x),_(d)),V&&V.d(v);for(let D=0;D<i.length;D+=1)i[D].d();T&&T.d(),X&&X.d(),n[39](null),J(c,v),J(I,v),J(h,v),J(p,v)}}}const Pn=30,Ln=10,Ft=150;function Ve(n){return"touches"in n||"changedTouches"in n}function qn(n){return Ve(n)?[n.touches[0].clientX,n.touches[0].clientY]:[n.clientX,n.clientY]}function Fn(n,e,t){let l,i,o,r;rt(n,ot,u=>t(14,o=u)),rt(n,Ol,u=>t(62,r=u));let{posts:f=[]}=e,s=f,{index:a=0}=e,{type:c=r.url.searchParams.get("type")}=e,{isEdit:m=!1}=e,{dontMoveVertically:b=!1}=e,{selectedReaction:I=void 0}=e,{hideActionButtons:R=!1}=e,{whenCancelForExternalLink:x=()=>{}}=e,h=!0,d=!1,p=!1,w=0,B=0,V={width:0,height:0},A=!1,L=!1,{actionSheetMoreIsOpen:T=!1}=e,{actionSheetReportIsOpen:X=!1}=e,{modalVisible:N=!1}=e;function z(u){if(!u)return!1;const M=Te();return M!==null&&String(M)===u}let Z=!1,ae=!1,ue=-1,fe=-1,oe,v=!1,D=[],Q=[],ie;async function Ie(){var u,M;s[a]&&Bl({mediaIdx:`${((u=s[a])==null?void 0:u.mediaIdx)||0}`,postIdx:`${(M=s[a])==null?void 0:M.idx}`},{replace:!0})}async function Me(){t(22,Z=!0);const u=s.length,M=r.url.searchParams.get("userIdx"),P=r.url.searchParams.get("placeIdx"),U=`&offset=${u}`,Y=`&limit=${Pn}`,se=M?`&userIdx=${M}`:"",Ee=P?`&placeIdx=${P}`:"",ce=(await fetch(`${Re}/posts?${se}${Ee}${U}${Y}`,{headers:{"x-api-version":at.POST}}).then(ke=>ke.json()).then(ke=>{var it;return((it=ke.data)==null?void 0:it.posts)??[]})).map(ke=>({...ke,mediaIdx:0}));ce.length===0&&t(23,ae=!0),t(7,s=[...s,...ce]),t(22,Z=!1)}function Ae(u){const{height:M}=V;if(a===0&&u>0||a===s.length-1&&u<0){t(9,w=u*.3);return}t(9,w=Math.max(Math.min(u,M),-M))}function Zt(u){t(8,h=!1);const M=De(2),P=Ve(u)?u.changedTouches[0].clientY-fe:u.clientY-fe;P>M&&a>0?(t(0,a-=1),d=!0):-P>M&&a<s.length-1&&(t(0,a+=1),d=!0),t(9,w=0)}function Kt(u){const{width:M}=V,P=s[a].mediaIdx,U=s[a].media.length-1;if(P===0&&u>0||P===U&&u<0){t(10,B=u*.3);return}t(10,B=Math.max(Math.min(u,M),-M))}function Wt(u){t(8,h=!1);const M=De(2),P=Ve(u)?u.changedTouches[0].clientX-ue:u.clientX-ue,U=s[a].mediaIdx,Y=s[a].media.length-1;P>M&&U>0?xe(U-1):-P>M&&U<Y&&xe(U+1),t(10,B=0)}function xe(u){t(7,s[a]={...s[a],mediaIdx:u},s),t(7,s=[...s]),p=!0,Ie()}function Pe(u){d||p||(v=!0,oe=void 0,Ve(u)?(ue=u.touches[0].clientX,fe=u.touches[0].clientY):(ue=u.clientX,fe=u.clientY,window.addEventListener("mousemove",Le,{passive:!1}),window.addEventListener("mouseup",qe)))}function Le(u){if(!v||d||p)return;const[M,P]=qn(u),U=M-ue,Y=P-fe;oe===void 0&&(oe=Math.abs(Y)>=Math.abs(U)?"post":"media"),!b&&oe==="post"?Ae(Y):oe==="media"&&Kt(U)}function qe(u){!v||d||p||(v=!1,oe==="post"?Zt(u):oe==="media"&&Wt(u),Ve(u)||(window.removeEventListener("mousemove",Le),window.removeEventListener("mouseup",qe)))}function Qe(u){if(d||p)return;u.preventDefault();const M=Date.now(),P=Math.abs(u.deltaX),U=Math.abs(u.deltaY);if(P>U){if(Q.push({deltaX:u.deltaX,timestamp:M}),Q=Q.filter(Y=>M-Y.timestamp<=Ft),Q.length>=2){const Y=Q[0],se=Q[Q.length-1];if(Math.abs(se.deltaX)-Math.abs(Y.deltaX)>=0&&Math.abs(se.deltaX)>=30){const ce=s[a].mediaIdx,ke=s[a].media.length-1;se.deltaX>0&&ce<ke?xe(ce+1):se.deltaX<0&&ce>0&&xe(ce-1),Q=[],p=!0}}}else if(D.push({deltaY:u.deltaY,timestamp:M}),D=D.filter(Y=>M-Y.timestamp<=Ft),D.length>=2){const Y=D[0],se=D[D.length-1];Math.abs(se.deltaY)-Math.abs(Y.deltaY)>=0&&Math.abs(se.deltaY)>=30&&(se.deltaY>0&&a<s.length-1?(t(8,h=!1),t(0,a+=1),d=!0):se.deltaY<0&&a>0&&(t(8,h=!1),t(0,a-=1),d=!0),D=[])}}function $e(u){if(d||p)return;const M=s[a].mediaIdx,P=s[a].media.length-1;switch(u.key){case"ArrowUp":a>0&&(t(8,h=!1),t(0,a--,a),d=!0);break;case"ArrowDown":a<s.length-1&&(t(8,h=!1),t(0,a++,a),d=!0);break;case"ArrowLeft":M>0&&(t(8,h=!1),p=!0,xe(M-1));break;case"ArrowRight":M<P&&(t(8,h=!1),p=!0,xe(M+1));break}}function Gt(){t(8,h=!0),d=!1,p=!1}function et(){ie&&t(11,V={width:ie.clientWidth,height:ie.clientHeight})}function Jt(){var P,U;const u=Number(r.url.searchParams.get("mediaIdx")||0),M=((U=(P=s.at(a))==null?void 0:P.media)==null?void 0:U.length)||0;u&&u<M?t(7,s[a]={...s[a],mediaIdx:u},s):t(7,s[a]={...s[a],mediaIdx:0},s),t(7,s=[...s])}function Qt(){document.addEventListener("touchstart",Pe,{passive:!1}),document.addEventListener("touchmove",Le,{passive:!1}),document.addEventListener("touchend",qe),document.addEventListener("mousedown",Pe,{passive:!1}),document.addEventListener("wheel",Qe,{passive:!1}),document.addEventListener("keydown",$e)}function $t(){document.removeEventListener("touchstart",Pe),document.removeEventListener("touchmove",Le),document.removeEventListener("touchend",qe),document.removeEventListener("mousedown",Pe),document.removeEventListener("wheel",Qe),document.removeEventListener("keydown",$e)}jt(()=>{Tl(ot,o=!0,o),et();const u=new ResizeObserver(()=>et());return ie&&u.observe(ie),Qt(),Jt(),()=>{u.disconnect()}}),Ge(()=>{$t()});function tt(){var U;if(L)return;L=!0;const u=ze(),M=Te(),P=(U=s[a])==null?void 0:U.idx;if(!u||!M||!P)return L=!1;fetch(`${Re}/posts/${P}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`,"x-api-version":at.POST}}).then(Y=>Y.json()).then(()=>Ke(`/users/${M}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{L=!1})}async function lt(u){var Y,se,Ee;const M=(Y=s[u])==null?void 0:Y.idx;if(M===void 0||m||((se=s[u])==null?void 0:se.needReactionReload)!==!0&&((Ee=s[u])!=null&&Ee.reactions))return;const P=ze(),U=await fetch(`${Re}/vote/reactions?targetTable=posts&targetId=${M}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+P}});if(U.ok){const ce=await U.json();t(7,s[u].reactions=ce.data.reactions,s),t(7,s[u].myReaction=ce.data.myReaction,s)}}function _e(u,M){if(Fe)return x();if(A)return;A=!0;const P=a,U=s[P];if((U==null?void 0:U.idx)!==u)return A=!1;if(!ft())return U.needReactionReload=!0,A=!1,ge.emit("showSignInModal",{removable:!0,callback:Pl?()=>{lt(P)}:void 0});U.myReaction===M?ge.emit("setReaction",{target:"posts",targetId:u,reaction:null,callback:()=>{t(7,s[P].myReaction=null,s),nt(P,M),A=!1}}):(U.myReaction&&nt(P,U.myReaction),ge.emit("setReaction",{target:"posts",targetId:u,reaction:M,callback:()=>{t(7,s[P].myReaction=M,s),s[P].reactions.some(Y=>Y.type===M)?t(7,s[P].reactions=s[P].reactions.map(Y=>Y.type===M?{...Y,count:Number(Y.count)+1}:Y),s):t(7,s[P].reactions=[...s[P].reactions,{type:M,count:1}],s),A=!1}}))}function nt(u,M){let P=[];for(const U of s[u].reactions)if(U.type===M){const Y=Number(U.count);Y>1&&P.push({...U,count:Y-1})}else P.push(U);t(7,s[u].reactions=P,s)}function el(u){Ml.call(this,n,u)}const tl=(u,M)=>{_e(u.idx,M.type)},ll=()=>{if(Fe)return x()};function nl(u,M,P,U){P[U]=u,t(7,s)}const il=(u,M,P,U)=>{t(7,M[P].isTextExpanded=U.detail.expanded,s)},sl=u=>{_e(u.idx,"👍")},rl=u=>{_e(u.idx,"️🔥")},ol=u=>{_e(u.idx,"😍")},al=u=>{_e(u.idx,"😋")},fl=u=>{_e(u.idx,"😊️️")},ul=(u,M)=>u+Number(M.count),cl=u=>{_e(u.idx,u.myReaction||"❤️")},dl=(u,M,P)=>{t(7,M[P].onReactionShowcase=!0,s);const U=()=>{t(7,M[P].onReactionShowcase=!1,s),window.removeEventListener("click",U)};setTimeout(()=>{window.addEventListener("click",U)},500)},hl=()=>{if(Fe)return x();if(!ft())return ge.emit("showSignInModal",{removable:!0});t(1,T=!0)};function ml(u){Ce[u?"unshift":"push"](()=>{ie=u,t(12,ie)})}const pl=()=>{var u;t(1,T=!1),Ke(`/viewer/edit?type=patch&postIdx=${(u=window.location.search.split("postIdx=")[1])==null?void 0:u.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},_l=()=>{t(1,T=!1),t(3,N=!0)},gl=()=>{Ql(`${location.pathname}${location.search}`),t(1,T=!1)},bl=()=>{t(1,T=!1),t(2,X=!0)};function vl(u){T=u,t(1,T)}function wl(u){X=u,t(2,X)}const kl=()=>{t(7,s[a].is_reported=!0,s)},Cl=()=>{t(7,s[a].is_reported=!1,s)},Il=()=>{tt(),t(3,N=!1)},xl=()=>{t(3,N=!1)};function El(u){N=u,t(3,N)}return n.$$set=u=>{"posts"in u&&t(18,f=u.posts),"index"in u&&t(0,a=u.index),"type"in u&&t(19,c=u.type),"isEdit"in u&&t(4,m=u.isEdit),"dontMoveVertically"in u&&t(20,b=u.dontMoveVertically),"selectedReaction"in u&&t(21,I=u.selectedReaction),"hideActionButtons"in u&&t(5,R=u.hideActionButtons),"whenCancelForExternalLink"in u&&t(6,x=u.whenCancelForExternalLink),"actionSheetMoreIsOpen"in u&&t(1,T=u.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in u&&t(2,X=u.actionSheetReportIsOpen),"modalVisible"in u&&t(3,N=u.modalVisible)},n.$$.update=()=>{var u;n.$$.dirty[0]&1&&a!==void 0&&Ie(),n.$$.dirty[0]&2097152&&I&&_e(I.postIdx,I.reaction),n.$$.dirty[0]&1&&lt(a),n.$$.dirty[0]&129&&t(24,l=(u=s[a])==null?void 0:u.user_idx),n.$$.dirty[0]&16777216&&t(13,i=z(l)),n.$$.dirty[0]&13631617&&!b&&a>=s.length-Ln&&!Z&&!ae&&(console.log("pushPosts"),Me())},[a,T,X,N,m,R,x,s,h,w,B,V,ie,i,o,Gt,tt,_e,f,c,b,I,Z,ae,l,el,tl,ll,nl,il,sl,rl,ol,al,fl,ul,cl,dl,hl,ml,pl,_l,gl,bl,vl,wl,kl,Cl,Il,xl,El]}class bi extends me{constructor(e){super(),pe(this,e,Fn,An,he,{posts:18,index:0,type:19,isEdit:4,dontMoveVertically:20,selectedReaction:21,hideActionButtons:5,whenCancelForExternalLink:6,actionSheetMoreIsOpen:1,actionSheetReportIsOpen:2,modalVisible:3},null,[-1,-1,-1])}}export{bi as V};
