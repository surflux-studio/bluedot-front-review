import{s as de,w as je,x as De,b as j,f as m,o as h,i as O,h as E,n as K,e as C,a as H,c as b,g as N,T as Z,p as S,z as U,K as W,v as Ue,C as Ge,U as Ke,m as pe,H as X,t as me,d as ge,j as _e,F as We,y as se,I as Q,k as qe,D as Je,N as Ae,E as oe}from"./scheduler.CGPrvQej.js";import{S as ve,i as Ce,c as le,d as ae,m as ue,t as ce,a as fe,e as he}from"./index.C24WiM7b.js";import{o as Ze,a as Qe}from"./keyboard.CeCD2hiK.js";import{D as Xe}from"./Dim.C2ZicWh8.js";import{e as F}from"./each.Bquof17x.js";import{a as re,k as Ye,A as et,e as tt}from"./store.Cqlim9q2.js";import{a as nt,g as ot}from"./sign.CWFXCZ4p.js";const rt=["local","version","cdnUrl"],it=["skins"],st=["compact","flat","shortcodes"];function lt(o,e){return ft(o)||ct(o,e)||ut(o,e)||at()}function at(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ut(o,e){if(o){if(typeof o=="string")return Ie(o,e);var t={}.toString.call(o).slice(8,-1);return t==="Object"&&o.constructor&&(t=o.constructor.name),t==="Map"||t==="Set"?Array.from(o):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Ie(o,e):void 0}}function Ie(o,e){(e==null||e>o.length)&&(e=o.length);for(var t=0,n=Array(e);t<e;t++)n[t]=o[t];return n}function ct(o,e){var t=o==null?null:typeof Symbol<"u"&&o[Symbol.iterator]||o["@@iterator"];if(t!=null){var n,r,i,s,a=[],l=!0,c=!1;try{if(i=(t=t.call(o)).next,e!==0)for(;!(l=(n=i.call(t)).done)&&(a.push(n.value),a.length!==e);l=!0);}catch(u){c=!0,r=u}finally{try{if(!l&&t.return!=null&&(s=t.return(),Object(s)!==s))return}finally{if(c)throw r}}return a}}function ft(o){if(Array.isArray(o))return o}function Oe(o,e){var t=Object.keys(o);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(o);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(o,r).enumerable})),t.push.apply(t,n)}return t}function $e(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Oe(Object(t),!0).forEach(function(n){ht(o,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(t)):Oe(Object(t)).forEach(function(n){Object.defineProperty(o,n,Object.getOwnPropertyDescriptor(t,n))})}return o}function ht(o,e,t){return(e=dt(e))in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}function dt(o){var e=pt(o,"string");return typeof e=="symbol"?e:e+""}function pt(o,e){if(typeof o!="object"||!o)return o;var t=o[Symbol.toPrimitive];if(t!==void 0){var n=t.call(o,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(o)}function be(o,e){if(o==null)return{};var t,n,r=mt(o,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);for(n=0;n<i.length;n++)t=i[n],e.indexOf(t)>=0||{}.propertyIsEnumerable.call(o,t)&&(r[t]=o[t])}return r}function mt(o,e){if(o==null)return{};var t={};for(var n in o)if({}.hasOwnProperty.call(o,n)){if(e.indexOf(n)>=0)continue;t[n]=o[n]}return t}function gt(o,e,t){let n=`https://cdn.jsdelivr.net/npm/emojibase-data@${e}/${o}`;return typeof t=="function"?n=t(o,e):typeof t=="string"&&(n=`${t}/${o}`),n}async function ye(o,e={}){const t=e.local,n=t===void 0?!1:t,r=e.version,i=r===void 0?"latest":r,s=e.cdnUrl,a=be(e,rt),l=gt(o,i,s),c=n?localStorage:sessionStorage,u=`emojibase/${i}/${o}`,p=c.getItem(u);if(p)return JSON.parse(p);const y=await fetch(l,$e({credentials:"omit",mode:"cors",redirect:"error"},a));if(!y.ok)throw new Error("Failed to load Emojibase dataset.");const B=await y.json();try{c.setItem(u,JSON.stringify(B))}catch{}return B}const _t={discord:"joypixels",slack:"iamcal"};async function Be(o,e,t){return ye(`${o}/shortcodes/${_t[e]??e}.json`,t)}function q(o,e){if(e.length===0)return o;const t=new Set(o.shortcodes);return e.forEach(n=>{const r=n[o.hexcode];Array.isArray(r)?r.forEach(i=>t.add(i)):r&&t.add(r)}),o.shortcodes=[...t],o.skins&&o.skins.forEach(n=>{q(n,e)}),o}function vt(o,e=[]){const t=[];return o.forEach(n=>{if(n.skins){const r=n.skins,i=be(n,it);t.push(q(i,e)),r.forEach(s=>{const a=$e({},s);i.tags&&(a.tags=[...i.tags]),t.push(q(a,e))})}else t.push(q(n,e))}),t}function Ct(o,e){return e.length===0||o.forEach(t=>{q(t,e)}),o}async function Te(o,e={}){const t=e.compact,n=t===void 0?!1:t,r=e.flat,i=r===void 0?!1:r,s=e.shortcodes,a=s===void 0?[]:s,l=be(e,st),c=await ye(`${o}/${n?"compact":"data"}.json`,l);let u=[];return a.length>0&&(u=await Promise.all(a.map(p=>{let y;if(p.includes("/")){const B=p.split("/"),L=lt(B,2),x=L[0],V=L[1];y=Be(x,V,l)}else y=Be(o,p,l);return y.catch(()=>({}))}))),i?vt(c,u):Ct(c,u)}async function bt(o,e){return ye(`${o}/messages.json`,e)}function yt(o){let e,t;return{c(){e=je("svg"),t=je("path"),this.h()},l(n){e=De(n,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var r=j(e);t=De(r,"path",{d:!0,fill:!0}),j(t).forEach(m),r.forEach(m),this.h()},h(){h(t,"d","M25.3183 6H10.6C10.2189 6.00049 9.84232 6.08586 9.49524 6.25042C9.14815 6.41497 8.83856 6.65495 8.58708 6.95437C8.54355 7.00635 8.5053 7.0629 8.47292 7.12313L3.13692 15.4844C3.04734 15.6401 3 15.8183 3 16C3 16.1817 3.04734 16.36 3.13692 16.5156L8.46515 24.8638C8.49865 24.9281 8.53873 24.9885 8.58469 25.0438C8.83614 25.3437 9.14585 25.5841 9.49316 25.749C9.84047 25.9139 10.2174 25.9995 10.5988 26H25.3183C26.0293 25.9992 26.7109 25.7034 27.2137 25.1777C27.7164 24.652 27.9992 23.9391 28 23.1956V8.80437C27.9992 8.06086 27.7164 7.34804 27.2137 6.8223C26.7109 6.29655 26.0293 6.00083 25.3183 6ZM22.0233 19.4375C22.1142 19.5299 22.1867 19.6402 22.2364 19.7621C22.2862 19.884 22.3123 20.0151 22.3132 20.1476C22.3141 20.2802 22.2898 20.4116 22.2416 20.5342C22.1935 20.6569 22.1226 20.7683 22.033 20.862C21.9433 20.9557 21.8367 21.0298 21.7194 21.0801C21.6021 21.1303 21.4765 21.1557 21.3497 21.1547C21.223 21.1537 21.0977 21.1263 20.9811 21.0743C20.8646 21.0222 20.7591 20.9464 20.6708 20.8512L17.4613 17.5L14.2536 20.8531C14.0741 21.0408 13.8306 21.1463 13.5767 21.1463C13.3229 21.1463 13.0794 21.0408 12.8999 20.8531C12.7204 20.6654 12.6195 20.4108 12.6195 20.1453C12.6195 19.8798 12.7204 19.6252 12.8999 19.4375L16.1064 16.0831L12.8975 12.7275C12.718 12.5394 12.6174 12.2846 12.6177 12.0189C12.618 11.7532 12.7191 11.4986 12.899 11.3109C13.0788 11.1233 13.3225 11.018 13.5766 11.0183C13.8306 11.0186 14.0742 11.1244 14.2536 11.3125L17.4625 14.6687L20.6702 11.3125C20.8496 11.1249 21.093 11.0194 21.3467 11.0194C21.6005 11.0194 21.8439 11.1249 22.0233 11.3125C22.2027 11.5001 22.3035 11.7546 22.3035 12.02C22.3035 12.2854 22.2027 12.5399 22.0233 12.7275L18.8138 16.0831L22.0233 19.4375Z"),h(t,"fill","#757475"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width","32"),h(e,"height","32"),h(e,"viewBox","0 0 32 32"),h(e,"fill","none")},m(n,r){O(n,e,r),E(e,t)},p:K,i:K,o:K,d(n){n&&m(e)}}}class kt extends ve{constructor(e){super(),Ce(this,e,null,yt,de,{})}}function Se(o,e,t){const n=o.slice();return n[26]=e[t],n}function Le(o,e,t){const n=o.slice();return n[34]=e[t],n}function Pe(o,e,t){const n=o.slice();return n[29]=e[t][0],n[30]=e[t][1],n}function xe(o,e,t){const n=o.slice();return n[34]=e[t],n}function ie(o){const e=o.slice(),t=`group-${e[29]}`;return e[33]=t,e}function Ve(o){let e,t="✕",n,r;return{c(){e=C("button"),e.textContent=t,this.h()},l(i){e=b(i,"BUTTON",{class:!0,title:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1jh20in"&&(e.textContent=t),this.h()},h(){h(e,"class","absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 pointer-events-auto"),h(e,"title","검색어 지우기")},m(i,s){O(i,e,s),n||(r=S(e,"click",U(W(o[9]))),n=!0)},p:K,d(i){i&&m(e),n=!1,r()}}}function wt(o){let e,t=F(o[2]),n=[];for(let r=0;r<t.length;r+=1)n[r]=Me(Le(o,t,r));return{c(){e=C("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var i=j(e);for(let s=0;s<n.length;s+=1)n[s].l(i);i.forEach(m),this.h()},h(){h(e,"class","grid grid-cols-7 gap-2")},m(r,i){O(r,e,i);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null)},p(r,i){if(i[0]&2052){t=F(r[2]);let s;for(s=0;s<t.length;s+=1){const a=Le(r,t,s);n[s]?n[s].p(a,i):(n[s]=Me(a),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}},d(r){r&&m(e),X(n,r)}}}function Et(o){let e,t=F(Object.entries(o[0]).sort(o[15])),n=[];for(let r=0;r<t.length;r+=1)n[r]=ze(Pe(o,t,r));return{c(){for(let r=0;r<n.length;r+=1)n[r].c();e=Q()},l(r){for(let i=0;i<n.length;i+=1)n[i].l(r);e=Q()},m(r,i){for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(r,i);O(r,e,i)},p(r,i){if(i[0]&2049){t=F(Object.entries(r[0]).sort(r[15]));let s;for(s=0;s<t.length;s+=1){const a=Pe(r,t,s);n[s]?n[s].p(a,i):(n[s]=ze(a),n[s].c(),n[s].m(e.parentNode,e))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}},d(r){r&&m(e),X(n,r)}}}function jt(o){let e,t="<p>검색 결과가 없습니다.</p>";return{c(){e=C("div"),e.innerHTML=t,this.h()},l(n){e=b(n,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-1sbvlnv"&&(e.innerHTML=t),this.h()},h(){h(e,"class","flex justify-center items-center h-full")},m(n,r){O(n,e,r)},p:K,d(n){n&&m(e)}}}function Dt(o){let e,t="<p>이모지 로딩 중...</p>";return{c(){e=C("div"),e.innerHTML=t,this.h()},l(n){e=b(n,"DIV",{class:!0,"data-svelte-h":!0}),pe(e)!=="svelte-n7g9l7"&&(e.innerHTML=t),this.h()},h(){h(e,"class","flex justify-center items-center h-full")},m(n,r){O(n,e,r)},p:K,d(n){n&&m(e)}}}function Me(o){let e,t=o[34].unicode+"",n,r,i,s,a;function l(){return o[17](o[34])}return{c(){e=C("div"),n=me(t),r=H(),this.h()},l(c){e=b(c,"DIV",{class:!0,title:!0});var u=j(e);n=ge(u,t),r=N(u),u.forEach(m),this.h()},h(){h(e,"class","text-3xl pointer-events-auto hover:bg-gray-100 p-1 rounded cursor-pointer text-center"),h(e,"title",i=o[34].label)},m(c,u){O(c,e,u),E(e,n),E(e,r),s||(a=S(e,"click",U(W(l)),!0),s=!0)},p(c,u){o=c,u[0]&4&&t!==(t=o[34].unicode+"")&&_e(n,t),u[0]&4&&i!==(i=o[34].label)&&h(e,"title",i)},d(c){c&&m(e),s=!1,a()}}}function He(o){let e,t,n,r,i,s=F(o[30]),a=[];for(let l=0;l<s.length;l+=1)a[l]=Ne(xe(o,s,l));return{c(){e=C("hr"),n=H(),r=C("div");for(let l=0;l<a.length;l+=1)a[l].c();i=H(),this.h()},l(l){e=b(l,"HR",{id:!0,class:!0}),n=N(l),r=b(l,"DIV",{class:!0});var c=j(r);for(let u=0;u<a.length;u+=1)a[u].l(c);i=N(c),c.forEach(m),this.h()},h(){h(e,"id",t=o[33]),h(e,"class","opacity-0 h-0 m-0 p-0"),h(r,"class","grid grid-cols-7 gap-2 mb-4")},m(l,c){O(l,e,c),O(l,n,c),O(l,r,c);for(let u=0;u<a.length;u+=1)a[u]&&a[u].m(r,null);E(r,i)},p(l,c){if(c[0]&1&&t!==(t=l[33])&&h(e,"id",t),c[0]&2049){s=F(l[30]);let u;for(u=0;u<s.length;u+=1){const p=xe(l,s,u);a[u]?a[u].p(p,c):(a[u]=Ne(p),a[u].c(),a[u].m(r,i))}for(;u<a.length;u+=1)a[u].d(1);a.length=s.length}},d(l){l&&(m(e),m(n),m(r)),X(a,l)}}}function Ne(o){let e,t=o[34].unicode+"",n,r,i,s;function a(){return o[16](o[34])}return{c(){e=C("div"),n=me(t),this.h()},l(l){e=b(l,"DIV",{class:!0,title:!0});var c=j(e);n=ge(c,t),c.forEach(m),this.h()},h(){h(e,"class","text-3xl pointer-events-auto hover:bg-gray-100 p-1 rounded cursor-pointer text-center"),h(e,"title",r=o[34].label)},m(l,c){O(l,e,c),E(e,n),i||(s=S(e,"click",U(W(a)),!0),i=!0)},p(l,c){o=l,c[0]&1&&t!==(t=o[34].unicode+"")&&_e(n,t),c[0]&1&&r!==(r=o[34].label)&&h(e,"title",r)},d(l){l&&m(e),i=!1,s()}}}function ze(o){let e,t=o[30].length>0&&He(ie(o));return{c(){t&&t.c(),e=Q()},l(n){t&&t.l(n),e=Q()},m(n,r){t&&t.m(n,r),O(n,e,r)},p(n,r){n[30].length>0?t?t.p(ie(n),r):(t=He(ie(n)),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},d(n){n&&m(e),t&&t.d(n)}}}function Fe(o){let e,t=F(o[1]),n=[];for(let r=0;r<t.length;r+=1)n[r]=Re(Se(o,t,r));return{c(){e=C("div");for(let r=0;r<n.length;r+=1)n[r].c();this.h()},l(r){e=b(r,"DIV",{class:!0});var i=j(e);for(let s=0;s<n.length;s+=1)n[s].l(i);i.forEach(m),this.h()},h(){h(e,"class","flex items-center justify-between overflow-x-auto")},m(r,i){O(r,e,i);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null)},p(r,i){if(i[0]&1042){t=F(r[1]);let s;for(s=0;s<t.length;s+=1){const a=Se(r,t,s);n[s]?n[s].p(a,i):(n[s]=Re(a),n[s].c(),n[s].m(e,null))}for(;s<n.length;s+=1)n[s].d(1);n.length=t.length}},d(r){r&&m(e),X(n,r)}}}function Re(o){let e,t=o[26].label+"",n,r,i,s,a,l;function c(){return o[19](o[26])}return{c(){e=C("div"),n=me(t),r=H(),this.h()},l(u){e=b(u,"DIV",{class:!0,title:!0});var p=j(e);n=ge(p,t),r=N(p),p.forEach(m),this.h()},h(){h(e,"class",i="cursor-pointer pointer-events-auto px-2 text-xl "+(o[4]===o[26].key?"bg-gray-200 rounded":"")),h(e,"title",s=`Group ${o[26].groupIndex}`)},m(u,p){O(u,e,p),E(e,n),E(e,r),a||(l=S(e,"click",U(W(c))),a=!0)},p(u,p){o=u,p[0]&2&&t!==(t=o[26].label+"")&&_e(n,t),p[0]&18&&i!==(i="cursor-pointer pointer-events-auto px-2 text-xl "+(o[4]===o[26].key?"bg-gray-200 rounded":""))&&h(e,"class",i),p[0]&2&&s!==(s=`Group ${o[26].groupIndex}`)&&h(e,"title",s)},d(u){u&&m(e),a=!1,l()}}}function At(o){let e,t,n,r,i,s,a,l,c,u,p,y,B,L,x,V,k=o[3]&&Ve(o);c=new kt({});function R(_,A){return _[5]?Dt:_[2].length===0?jt:_[3]?wt:Et}let z=R(o),D=z(o),w=!o[3]&&Fe(o);return{c(){e=C("div"),t=C("div"),n=C("div"),r=C("div"),i=C("input"),s=H(),k&&k.c(),a=H(),l=C("div"),le(c.$$.fragment),u=H(),p=C("div"),D.c(),y=H(),B=C("div"),w&&w.c(),this.h()},l(_){e=b(_,"DIV",{class:!0});var A=j(e);t=b(A,"DIV",{class:!0});var d=j(t);n=b(d,"DIV",{class:!0});var P=j(n);r=b(P,"DIV",{class:!0});var G=j(r);i=b(G,"INPUT",{type:!0,class:!0,placeholder:!0}),s=N(G),k&&k.l(G),G.forEach(m),a=N(P),l=b(P,"DIV",{class:!0});var J=j(l);ae(c.$$.fragment,J),J.forEach(m),P.forEach(m),d.forEach(m),u=N(A),p=b(A,"DIV",{class:!0});var Y=j(p);D.l(Y),Y.forEach(m),y=N(A),B=b(A,"DIV",{class:!0});var f=j(B);w&&w.l(f),f.forEach(m),A.forEach(m),this.h()},h(){h(i,"type","text"),h(i,"class","w-full p-1 border border-none rounded-md pr-8 pointer-events-auto"),h(i,"placeholder","이모지 검색... (한글 가능)"),h(r,"class","grow mr-2 relative"),h(l,"class","shrink-0 pointer-events-auto"),h(n,"class","flex items-center justify-between mb-2"),h(t,"class","sticky top-0 w-full safe-area-pb p-2 h-16 z-10"),h(p,"class","w-full flex-1 p-2 overflow-y-auto "),h(B,"class","sticky bottom-0 w-full bg-white safe-area-pb p-2 h-14 z-10"),h(e,"class","w-full h-[300px] max-w-[500px] bg-[rgb(246,246,246)]/60 rounded-t-lg shadow-xl backdrop-blur-[5.32vh] flex flex-col relative p-2 ")},m(_,A){O(_,e,A),E(e,t),E(t,n),E(n,r),E(r,i),Z(i,o[3]),E(r,s),k&&k.m(r,null),E(n,a),E(n,l),ue(c,l,null),E(e,u),E(e,p),D.m(p,null),o[18](p),E(e,y),E(e,B),w&&w.m(B,null),L=!0,x||(V=[S(i,"input",o[13]),S(i,"input",o[8]),S(i,"click",U(W(o[12]))),S(l,"click",U(W(o[14])),!0),S(p,"scroll",o[7])],x=!0)},p(_,A){A[0]&8&&i.value!==_[3]&&Z(i,_[3]),_[3]?k?k.p(_,A):(k=Ve(_),k.c(),k.m(r,null)):k&&(k.d(1),k=null),z===(z=R(_))&&D?D.p(_,A):(D.d(1),D=z(_),D&&(D.c(),D.m(p,null))),_[3]?w&&(w.d(1),w=null):w?w.p(_,A):(w=Fe(_),w.c(),w.m(B,null))},i(_){L||(ce(c.$$.fragment,_),L=!0)},o(_){fe(c.$$.fragment,_),L=!1},d(_){_&&m(e),k&&k.d(),he(c),D.d(),o[18](null),w&&w.d(),x=!1,Ue(V)}}}function It(o,e,t){let n={},r=[],i=[],s=[],a="",l=null,c=!0,u,p=new Map,y={},B=[];function L(){setTimeout(()=>{p.clear(),r.forEach(f=>{const v=u.querySelector(`#${f.key}`);v&&p.set(f.key,v.offsetTop-u.offsetTop)}),console.log("동적 카테고리 위치 저장됨:",[...p.entries()])},100)}function x(){if(!u)return;const f=u.scrollTop;let v=null;for(const[T,M]of p.entries())M!==void 0&&f>=M-10&&(v=T);if(v===null&&r.length>0){const T=r[0].key,M=p.get(T);M!==void 0&&f<M&&(v=T)}v!==l&&(t(4,l=v),console.log("스크롤로 카테고리 변경:",l))}function V(){if(!a.trim()){t(2,s=i);return}const f=a.toLowerCase();t(2,s=i.filter(v=>{if(v.unicode.toLowerCase().includes(f)||v.label&&v.label.toLowerCase().includes(f)||v.tags&&v.tags.some(g=>g.toLowerCase().includes(f)))return!0;const T=B.find(g=>g.hexcode===v.hexcode);if(T&&(T.label&&T.label.toLowerCase().includes(f)||T.tags&&T.tags.some(g=>g.toLowerCase().includes(f))))return!0;const M=y[`annotation-${v.hexcode}`];if(M&&M.toLowerCase().includes(f))return!0;const $=y[`tags-${v.hexcode}`];return!!($&&$.toLowerCase().includes(f))}))}function k(){t(3,a=""),V()}function R(f){if(t(4,l=f),p.has(f)){const v=p.get(f);u.scrollTo({top:v,behavior:"smooth"}),console.log(`저장된 위치로 스크롤: ${f}:`,v)}else console.log(`저장된 위치가 없음: ${f}, 위치 다시 계산`),setTimeout(()=>{const v=u.querySelector(`#category-${f}`);if(v&&u){const T=v.offsetTop-u.offsetTop;u.scrollTo({top:T,behavior:"smooth"}),p.set(f,T),console.log(`위치 계산 및 저장: ${f}:`,T)}},10)}async function z(){try{t(5,c=!0),y=await bt("ko"),console.log("한국어 메시지 로드 완료:",Object.keys(y).length);const f=new Map;(await Te("ko",{compact:!0,flat:!0})).forEach(g=>f.set(g.hexcode,g)),i=(await Te("en",{compact:!0,flat:!0})).map(g=>{const I={...g},ee=f.get(g.hexcode);if(ee&&ee.tags){const te=new Set([...I.tags||[],...ee.tags||[]]);I.tags=Array.from(te)}const ke=y[`annotation-${g.hexcode}`];ke&&I.label&&(I.label=`${I.label} (${ke})`);const we=y[`tags-${g.hexcode}`];if(we){const te=we.split(",").map(ne=>ne.trim()),Ee=new Set(I.tags||[]);te.forEach(ne=>Ee.add(ne)),I.tags=Array.from(Ee)}return I}).sort((g,I)=>g.group===void 0&&I.group===void 0?0:g.group===void 0?1:I.group===void 0?-1:g.group===I.group?(g.order||0)-(I.order||0):g.group-I.group),t(0,n={}),t(1,r=[]);let $=-1;for(const g of i)if(g.group!==void 0&&(n[g.group]||t(0,n[g.group]=[],n),n[g.group].push(g),g.group!==$)){const I=n[g.group][0];I&&I.unicode&&(r.push({key:`group-${g.group}`,label:I.unicode,groupIndex:g.group}),$=g.group)}console.log("생성된 카테고리 헤더:",r),t(2,s=i),console.log("통합 및 그룹핑된 이모지 로드 완료 (EN 기준):",i.length)}catch(f){console.error("이모지 로딩 오류:",f)}finally{t(5,c=!1),L()}}Ge(()=>{z();const f=()=>{L()};return window.addEventListener("resize",f),()=>{window.removeEventListener("resize",f)}});const D=Ke();function w(f){We.call(this,o,f)}function _(){a=this.value,t(3,a)}const A=()=>{D("backspace")},d=([f],[v])=>parseInt(f)-parseInt(v),P=f=>{D("emojiClick",{emoji:f})},G=f=>{D("emojiClick",{emoji:f})};function J(f){se[f?"unshift":"push"](()=>{u=f,t(6,u)})}return[n,r,s,a,l,c,u,x,V,k,R,D,w,_,A,d,P,G,J,f=>R(f.key)]}class Ot extends ve{constructor(e){super(),Ce(this,e,It,At,de,{},null,[-1,-1])}}function Bt(o){let e,t,n,r,i,s;return{c(){e=C("div"),t=C("textarea"),this.h()},l(a){e=b(a,"DIV",{class:!0});var l=j(e);t=b(l,"TEXTAREA",{class:!0,inputmode:!0}),j(t).forEach(m),l.forEach(m),this.h()},h(){h(t,"class",n="resize-none outline-none ring-0 focus:outline-none focus:ring-0 border-none shadow-none text-white bg-transparent transition-transform duration-300 text-center "+(o[2]==="emoji"&&o[0]?"translate-y-[-125px]":"translate-y-0")+" caret-white w-full mx-12 min-h-6"),h(t,"inputmode",r=o[2]==="emoji"?"none":"text"),Ae(t,"text-2xl",o[2]==="emoji"),h(e,"class","flex items-center justify-center h-full")},m(a,l){O(a,e,l),E(e,t),Z(t,o[1]),o[12](t),i||(s=[S(t,"input",o[11]),S(t,"click",U(o[10])),S(t,"keydown",o[13]),S(t,"input",o[8])],i=!0)},p(a,l){l&5&&n!==(n="resize-none outline-none ring-0 focus:outline-none focus:ring-0 border-none shadow-none text-white bg-transparent transition-transform duration-300 text-center "+(a[2]==="emoji"&&a[0]?"translate-y-[-125px]":"translate-y-0")+" caret-white w-full mx-12 min-h-6")&&h(t,"class",n),l&4&&r!==(r=a[2]==="emoji"?"none":"text")&&h(t,"inputmode",r),l&2&&Z(t,a[1]),l&5&&Ae(t,"text-2xl",a[2]==="emoji")},d(a){a&&m(e),o[12](null),i=!1,Ue(s)}}}function Tt(o){let e,t,n,r,i,s,a;return e=new Xe({props:{className:`
    transition-opacity duration-300 
    ${o[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${o[5]?"visible":"invisible"}
  `,$$slots:{default:[Bt]},$$scope:{ctx:o}}}),e.$on("click",o[14]),i=new Ot({}),i.$on("backspace",o[6]),i.$on("emojiClick",o[7]),{c(){le(e.$$.fragment),t=H(),n=C("div"),r=C("div"),le(i.$$.fragment),this.h()},l(l){ae(e.$$.fragment,l),t=N(l),n=b(l,"DIV",{class:!0});var c=j(n);r=b(c,"DIV",{class:!0});var u=j(r);ae(i.$$.fragment,u),u.forEach(m),c.forEach(m),this.h()},h(){h(r,"class","transition-transform duration-300"),h(n,"class",s="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 pointer-events-none "+(o[0]?"translate-y-0":"translate-y-[330px]")+" "+(o[2]==="emoji"&&o[5]?"visible":"invisible"))},m(l,c){ue(e,l,c),O(l,t,c),O(l,n,c),E(n,r),ue(i,r,null),o[15](r),a=!0},p(l,[c]){const u={};c&33&&(u.className=`
    transition-opacity duration-300 
    ${l[0]?"opacity-100 visible pointer-events-auto":"opacity-0 pointer-events-none"}
    ${l[5]?"visible":"invisible"}
  `),c&2097167&&(u.$$scope={dirty:c,ctx:l}),e.$set(u),(!a||c&37&&s!==(s="fixed bottom-0 w-full flex items-center justify-center z-[999] transition-transform duration-300 pointer-events-none "+(l[0]?"translate-y-0":"translate-y-[330px]")+" "+(l[2]==="emoji"&&l[5]?"visible":"invisible")))&&h(n,"class",s)},i(l){a||(ce(e.$$.fragment,l),ce(i.$$.fragment,l),a=!0)},o(l){fe(e.$$.fragment,l),fe(i.$$.fragment,l),a=!1},d(l){l&&(m(t),m(n)),he(e,l),he(i),o[15](null)}}}function St(o){}function Lt(){}function Pt(o,e,t){let n;qe(o,re,d=>t(17,n=d));const r=Ke();let i=null,s=null,{isOpen:a=!1}=e,{type:l="text"}=e,{value:c=""}=e,u;Ye.subscribe(({isOpen:d,type:P})=>{if(u=n.at(-1),!!u){if(u.ownerIdx!==String(nt())){t(0,a=!1);return}t(0,a=d),t(2,l=P),k(),l==="emoji"?t(1,c=u.emoji||""):t(1,c=u.back||"")}});function p(){l==="emoji"?re.update(d=>(d.at(-1)&&(d.at(-1).emoji=c),d)):l==="text"&&re.update(d=>(d.at(-1)&&(d.at(-1).back=c),d))}let y=!1;function B(){u&&fetch(`${et}/posts/dots/${u.idx}`,{method:"PATCH",headers:{"Content-Type":"application/json",Authorization:`Bearer ${ot()}`,"x-api-version":tt.DOTS},body:JSON.stringify({emojis:u.emoji||"",text:u.back||""})}).then(d=>{d.ok&&console.log("success")})}Ge(()=>{Ze(()=>{},St,Lt)}),Je(()=>{Qe()});async function L(){i&&(i.focus(),await oe(),document.execCommand("delete"))}async function x(d){if(!i)return;const P=d.detail.emoji.unicode;i.focus(),await oe(),document.execCommand("insertText",!1,P)}function V(){i==null||i.focus()}function k(){i&&oe().then(()=>{console.log("adjustInputHeight (after tick)"),t(3,i.style.height="auto",i),t(3,i.style.height=i.scrollHeight+"px",i)})}function R(d){We.call(this,o,d)}function z(){c=this.value,t(1,c)}function D(d){se[d?"unshift":"push"](()=>{i=d,t(3,i)})}const w=d=>{if(l==="emoji"){if(d.metaKey&&d.key==="k")return;d.preventDefault(),d.stopPropagation()}},_=d=>{d.stopPropagation(),t(0,a=!1)};function A(d){se[d?"unshift":"push"](()=>{s=d,t(4,s)})}return o.$$set=d=>{"isOpen"in d&&t(0,a=d.isOpen),"type"in d&&t(2,l=d.type),"value"in d&&t(1,c=d.value)},o.$$.update=()=>{o.$$.dirty&2&&c&&p(),o.$$.dirty&3&&(a?t(5,y=!0):(B(),setTimeout(()=>{r("close",c),t(5,y=!1)},300)))},[a,c,l,i,s,y,L,x,k,V,R,z,D,w,_,A]}class Rt extends ve{constructor(e){super(),Ce(this,e,Pt,Tt,de,{isOpen:0,type:2,value:1,focusInput:9})}get focusInput(){return this.$$.ctx[9]}}export{Rt as I};
