import{g as i}from"./entry.BiFNfNKk.js";async function l(){const e="298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com",t="https://azit.surflux.studio/auth/oauth/google",s="email profile",n="code",o=window.location.href,r=`https://accounts.google.com/o/oauth2/v2/auth?response_type=${n}&client_id=${e}&redirect_uri=${t}&scope=${s}&state=${o}`;location.replace(r)}function c(){sessionStorage.removeItem("jwt"),sessionStorage.removeItem("refresh"),sessionStorage.removeItem("user")}function h(){return sessionStorage.getItem("jwt")}async function f(e){const t=e.searchParams.get("access"),s=e.searchParams.get("refresh");t&&(sessionStorage.setItem("jwt",t),sessionStorage.setItem("user",JSON.stringify(await g(Number(a()))))),s&&sessionStorage.setItem("refresh",s),e.searchParams.delete("access"),e.searchParams.delete("refresh"),(t||s)&&await i(e.toString(),{replaceState:!0,invalidateAll:!1})}function a(){try{if(!sessionStorage.getItem("jwt"))throw new Error("jwt not found");const s=(sessionStorage.getItem("jwt")||"").split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),n=decodeURIComponent(atob(s).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join("")),o=JSON.parse(n);if(o.exp&&Math.floor(Date.now()/1e3)>=o.exp)throw new Error("jwt expired");return BigInt(o.sub)}catch(e){return console.warn(e),c(),null}}function m(){return a()!==null}async function g(e){if(sessionStorage.getItem("user"))return JSON.parse(sessionStorage.getItem("user")||"{}");const t=await fetch(`https://azit.surflux.studio/auth/users/${e}`,{method:"GET",headers:{Authorization:`Bearer ${sessionStorage.getItem("jwt")}`}}).then(s=>s.json());return sessionStorage.setItem("user",JSON.stringify(t.data)),t.data}function p(){const e=sessionStorage.getItem("user");return e?JSON.parse(e):null}export{a,l as b,m as c,h as d,p as g,f as h};
