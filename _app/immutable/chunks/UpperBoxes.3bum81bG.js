import{s as O,e as x,a as V,c as w,b as y,g as B,f as _,q as v,v as q,i as S,h as g,k as $,o as ee,t as R,d as T,r as J,n as te,j as K,w as P,m as ae}from"./scheduler.BnheM4g2.js";import{S as ie,i as le,t as b,g as C,b as k,f as N,c as Q,a as W,m as X,d as Y}from"./index.CP53dWnj.js";import{e as z,u as re,o as se}from"./each.B4pMeuX4.js";import{e as ne}from"./Header.CZKMtM4x.js";import{H as Z}from"./HexImage.Cud-VRlX.js";import{a as oe}from"./map.jVgvArSA.js";import{f as ce}from"./location.B7lFEp2I.js";import{s as A}from"./s32cloudfront.CIGdx2ef.js";import{A as fe}from"./store.MRPWFVRT.js";import{s as ue}from"./searchParams.Dr3v3mbV.js";import{p as de}from"./stores.CwFfa7fL.js";/* empty css                                                 */function H(o,e,a){const s=o.slice();return s[12]=e[a],s}function L(o){let e,a,s=o[3].image,c,i,d=o[3].name+"",f,t,h,p,l=M(o);return{c(){e=x("div"),a=x("div"),l.c(),c=V(),i=x("span"),f=R(d),this.h()},l(r){e=w(r,"DIV",{class:!0,"aria-hidden":!0});var n=y(e);a=w(n,"DIV",{class:!0});var m=y(a);l.l(m),m.forEach(_),c=B(n),i=w(n,"SPAN",{class:!0});var u=y(i);f=T(u,d),u.forEach(_),n.forEach(_),this.h()},h(){v(a,"class","w-24 h-24 relative"),v(i,"class","w-24 truncate text-xs text-gray-700 text-center text-white-shadow svelte-ybt96a"),v(e,"class","flex-shrink-0 flex flex-col items-center space-y-1"),v(e,"aria-hidden","")},m(r,n){S(r,e,n),g(e,a),l.m(a,null),g(e,c),g(e,i),g(i,f),t=!0,h||(p=J(e,"click",o[5]),h=!0)},p(r,n){n&8&&O(s,s=r[3].image)?(C(),k(l,1,1,te),N(),l=M(r),l.c(),b(l,1),l.m(a,null)):l.p(r,n),(!t||n&8)&&d!==(d=r[3].name+"")&&K(f,d)},i(r){t||(b(l),t=!0)},o(r){k(l),t=!1},d(r){r&&_(e),l.d(r),h=!1,p()}}}function M(o){let e,a;return e=new Z({props:{src:o[3].image?A(o[3].image):void 0,width:96,height:96,onBorder:!0}}),{c(){Q(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,c){X(e,s,c),a=!0},p(s,c){const i={};c&8&&(i.src=s[3].image?A(s[3].image):void 0),e.$set(i)},i(s){a||(b(e.$$.fragment,s),a=!0)},o(s){k(e.$$.fragment,s),a=!1},d(s){Y(e,s)}}}function F(o){let e,a,s,c,i,d=o[12].name+"",f,t,h,p,l;s=new Z({props:{src:o[12].image?A(o[12].image):void 0,width:96,height:96}});function r(){return o[6](o[12])}return{c(){e=x("div"),a=x("div"),Q(s.$$.fragment),c=V(),i=x("span"),f=R(d),t=V(),this.h()},l(n){e=w(n,"DIV",{class:!0,"aria-hidden":!0});var m=y(e);a=w(m,"DIV",{class:!0});var u=y(a);W(s.$$.fragment,u),u.forEach(_),c=B(m),i=w(m,"SPAN",{class:!0});var I=y(i);f=T(I,d),I.forEach(_),t=B(m),m.forEach(_),this.h()},h(){v(a,"class","w-24 h-24 relative"),v(i,"class","w-24 truncate text-xs text-gray-700 text-center text-white-shadow svelte-ybt96a"),v(e,"class","flex-shrink-0 flex flex-col items-center space-y-1"),v(e,"aria-hidden","")},m(n,m){S(n,e,m),g(e,a),X(s,a,null),g(e,c),g(e,i),g(i,f),g(e,t),h=!0,p||(l=J(e,"click",r),p=!0)},p(n,m){o=n;const u={};m&2&&(u.src=o[12].image?A(o[12].image):void 0),s.$set(u),(!h||m&2)&&d!==(d=o[12].name+"")&&K(f,d)},i(n){h||(b(s.$$.fragment,n),h=!0)},o(n){k(s.$$.fragment,n),h=!1},d(n){n&&_(e),Y(s),p=!1,l()}}}function G(o,e){var d;let a,s,c,i=e[12].idx!==((d=e[3])==null?void 0:d.idx)&&F(e);return{key:o,first:null,c(){a=P(),i&&i.c(),s=P(),this.h()},l(f){a=P(),i&&i.l(f),s=P(),this.h()},h(){this.first=a},m(f,t){S(f,a,t),i&&i.m(f,t),S(f,s,t),c=!0},p(f,t){var h;e=f,e[12].idx!==((h=e[3])==null?void 0:h.idx)?i?(i.p(e,t),t&10&&b(i,1)):(i=F(e),i.c(),b(i,1),i.m(s.parentNode,s)):i&&(C(),k(i,1,1,()=>{i=null}),N())},i(f){c||(b(i),c=!0)},o(f){k(i),c=!1},d(f){f&&(_(a),_(s)),i&&i.d(f)}}}function he(o){let e,a,s,c=[],i=new Map,d,f,t=o[3]&&L(o),h=z(o[1]);const p=l=>l[12].idx;for(let l=0;l<h.length;l+=1){let r=H(o,h,l),n=p(r);i.set(n,c[l]=G(n,r))}return{c(){e=x("div"),a=x("div"),t&&t.c(),s=V();for(let l=0;l<c.length;l+=1)c[l].c();this.h()},l(l){e=w(l,"DIV",{class:!0});var r=y(e);a=w(r,"DIV",{class:!0});var n=y(a);t&&t.l(n),s=B(n);for(let m=0;m<c.length;m+=1)c[m].l(n);n.forEach(_),r.forEach(_),this.h()},h(){v(a,"class","flex space-x-4"),v(e,"class",d=q(`relative ${o[0]} left-0 overflow-x-auto p-4 z-20 scrollbar-hidden scrollbar-hidden::-webkit-scrollbar`)+" svelte-ybt96a")},m(l,r){S(l,e,r),g(e,a),t&&t.m(a,null),g(a,s);for(let n=0;n<c.length;n+=1)c[n]&&c[n].m(a,null);o[7](e),f=!0},p(l,[r]){l[3]?t?(t.p(l,r),r&8&&b(t,1)):(t=L(l),t.c(),b(t,1),t.m(a,s)):t&&(C(),k(t,1,1,()=>{t=null}),N()),r&14&&(h=z(l[1]),C(),c=re(c,r,p,1,l,h,i,a,se,G,null,H),N()),(!f||r&1&&d!==(d=q(`relative ${l[0]} left-0 overflow-x-auto p-4 z-20 scrollbar-hidden scrollbar-hidden::-webkit-scrollbar`)+" svelte-ybt96a"))&&v(e,"class",d)},i(l){if(!f){b(t);for(let r=0;r<h.length;r+=1)b(c[r]);f=!0}},o(l){k(t);for(let r=0;r<c.length;r+=1)k(c[r]);f=!1},d(l){l&&_(e),t&&t.d();for(let r=0;r<c.length;r+=1)c[r].d();o[7](null)}}}function me(o,e,a){let s;$(o,de,u=>a(9,s=u));let{top:c="top-4"}=e,{boxes:i}=e,{onBoxClick:d=u=>p(u)}=e,f=s.url.searchParams.get("box"),t,h=null;ee(()=>{f&&(p(f),f=null)});async function p(u){const I=i.find(D=>D.idx===u);if(I){if(oe.clear(),t&&t.idx===I.idx)return a(3,t=null);a(3,t=I),l(),fetch(`${fe}/boxes/${t.idx}/places`).then(D=>D.json()).then(D=>{const U=D.data;U&&U.forEach(E=>{var j;ne.emit("addIcon",{idx:Number(E.idx),coordinate:ce([E.longitude,E.latitude]),image:((j=E.media)==null?void 0:j.at(0))??"",shape:"waterdrop",type:"place",link:`/places/${E.idx}`,rank:1,name:E.name,width:56,height:61})})})}}function l(){h&&h.scrollTo({top:0,left:0,behavior:"smooth"})}const r=()=>(t==null?void 0:t.idx)&&d(t.idx),n=u=>d(u.idx);function m(u){ae[u?"unshift":"push"](()=>{h=u,a(4,h)})}return o.$$set=u=>{"top"in u&&a(0,c=u.top),"boxes"in u&&a(1,i=u.boxes),"onBoxClick"in u&&a(2,d=u.onBoxClick)},o.$$.update=()=>{o.$$.dirty&8&&t!==void 0&&ue({box:(t==null?void 0:t.idx)??""},{replaceState:!0})},[c,i,d,t,h,r,n,m]}class Se extends ie{constructor(e){super(),le(this,e,me,he,O,{top:0,boxes:1,onBoxClick:2})}}export{Se as U};
