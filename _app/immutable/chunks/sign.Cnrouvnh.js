import{w as g,g as U}from"./entry.DX9Fy2lW.js";import{_ as X}from"./preload-helper.D6kgxu3v.js";import{l as fe}from"./scheduler.CbwPF6wx.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const pe=t=>{const e=new Map;e.set("web",{name:"web"});const s=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},r=(n,i)=>{s.platforms.set(n,i)},o=n=>{s.platforms.has(n)&&(s.currentPlatform=s.platforms.get(n))};return s.addPlatform=r,s.setPlatform=o,s},ge=t=>t.CapacitorPlatforms=pe(t),Z=ge(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});Z.addPlatform;Z.setPlatform;var j;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(j||(j={}));class B extends Error{constructor(e,s,r){super(e),this.message=e,this.code=s,this.data=r}}const me=t=>{var e,s;return t!=null&&t.androidBridge?"android":!((s=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},he=t=>{var e,s,r,o,n;const i=t.CapacitorCustomPlatform||null,a=t.Capacitor||{},u=a.Plugins=a.Plugins||{},c=t.CapacitorPlatforms,O=()=>i!==null?i.name:me(t),P=((e=c==null?void 0:c.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||O,W=()=>P()!=="web",te=((s=c==null?void 0:c.currentPlatform)===null||s===void 0?void 0:s.isNativePlatform)||W,se=l=>{const d=T.get(l);return!!(d!=null&&d.platforms.has(P())||z(l))},re=((r=c==null?void 0:c.currentPlatform)===null||r===void 0?void 0:r.isPluginAvailable)||se,ne=l=>{var d;return(d=a.PluginHeaders)===null||d===void 0?void 0:d.find(L=>L.name===l)},z=((o=c==null?void 0:c.currentPlatform)===null||o===void 0?void 0:o.getPluginHeader)||ne,oe=l=>t.console.error(l),ae=(l,d,L)=>Promise.reject(`${L} does not have an implementation of "${d}".`),T=new Map,ie=(l,d={})=>{const L=T.get(l);if(L)return console.warn(`Capacitor plugin "${l}" already registered. Cannot register plugins twice.`),L.proxy;const y=P(),_=z(l);let w;const le=async()=>(!w&&y in d?w=typeof d[y]=="function"?w=await d[y]():w=d[y]:i!==null&&!w&&"web"in d&&(w=typeof d.web=="function"?w=await d.web():w=d.web),w),de=(f,p)=>{var h,b;if(_){const v=_==null?void 0:_.methods.find(m=>p===m.name);if(v)return v.rtype==="promise"?m=>a.nativePromise(l,p.toString(),m):(m,$)=>a.nativeCallback(l,p.toString(),m,$);if(f)return(h=f[p])===null||h===void 0?void 0:h.bind(f)}else{if(f)return(b=f[p])===null||b===void 0?void 0:b.bind(f);throw new B(`"${l}" plugin is not implemented on ${y}`,j.Unimplemented)}},E=f=>{let p;const h=(...b)=>{const v=le().then(m=>{const $=de(m,f);if($){const A=$(...b);return p=A==null?void 0:A.remove,A}else throw new B(`"${l}.${f}()" is not implemented on ${y}`,j.Unimplemented)});return f==="addListener"&&(v.remove=async()=>p()),v};return h.toString=()=>`${f.toString()}() { [capacitor code] }`,Object.defineProperty(h,"name",{value:f,writable:!1,configurable:!1}),h},J=E("addListener"),K=E("removeListener"),ue=(f,p)=>{const h=J({eventName:f},p),b=async()=>{const m=await h;K({eventName:f,callbackId:m},p)},v=new Promise(m=>h.then(()=>m({remove:b})));return v.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await b()},v},F=new Proxy({},{get(f,p){switch(p){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return _?ue:J;case"removeListener":return K;default:return E(p)}}});return u[l]=F,T.set(l,{name:l,proxy:F,platforms:new Set([...Object.keys(d),..._?[y]:[]])}),F},ce=((n=c==null?void 0:c.currentPlatform)===null||n===void 0?void 0:n.registerPlugin)||ie;return a.convertFileSrc||(a.convertFileSrc=l=>l),a.getPlatform=P,a.handleError=oe,a.isNativePlatform=te,a.isPluginAvailable=re,a.pluginMethodNoop=ae,a.registerPlugin=ce,a.Exception=B,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},we=t=>t.Capacitor=he(t),k=we(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),I=k.registerPlugin;k.Plugins;class N{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,s){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(s);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),r&&this.sendRetainedArgumentsForEvent(e);const i=async()=>this.removeListener(e,s);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,r){const o=this.listeners[e];if(!o){if(r){let n=this.retainedEventArguments[e];n||(n=[]),n.push(s),this.retainedEventArguments[e]=n}return}o.forEach(n=>n(s))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:r=>{this.notifyListeners(s,r)}}}unimplemented(e="not implemented"){return new k.Exception(e,j.Unimplemented)}unavailable(e="not available"){return new k.Exception(e,j.Unavailable)}async removeListener(e,s){const r=this.listeners[e];if(!r)return;const o=r.indexOf(s);this.listeners[e].splice(o,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(r=>{this.notifyListeners(e,r)}))}}const V=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),Q=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class be extends N{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[o,n]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");o=Q(o).trim(),n=Q(n).trim(),s[o]=n}),s}async setCookie(e){try{const s=V(e.key),r=V(e.value),o=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),i=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${r||""}${o}; path=${n}; ${i};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}I("CapacitorCookies",{web:()=>new be});const ve=async t=>new Promise((e,s)=>{const r=new FileReader;r.onload=()=>{const o=r.result;e(o.indexOf(",")>=0?o.split(",")[1]:o)},r.onerror=o=>s(o),r.readAsDataURL(t)}),ye=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(o=>o.toLocaleLowerCase()).reduce((o,n,i)=>(o[n]=t[e[i]],o),{})},Pe=(t,e=!0)=>t?Object.entries(t).reduce((r,o)=>{const[n,i]=o;let a,u;return Array.isArray(i)?(u="",i.forEach(c=>{a=e?encodeURIComponent(c):c,u+=`${n}=${a}&`}),u.slice(0,-1)):(a=e?encodeURIComponent(i):i,u=`${n}=${a}`),`${r}&${u}`},"").substr(1):null,Le=(t,e={})=>{const s=Object.assign({method:t.method||"GET",headers:t.headers},e),o=ye(t.headers)["content-type"]||"";if(typeof t.data=="string")s.body=t.data;else if(o.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[i,a]of Object.entries(t.data||{}))n.set(i,a);s.body=n.toString()}else if(o.includes("multipart/form-data")||t.data instanceof FormData){const n=new FormData;if(t.data instanceof FormData)t.data.forEach((a,u)=>{n.append(u,a)});else for(const a of Object.keys(t.data))n.append(a,t.data[a]);s.body=n;const i=new Headers(s.headers);i.delete("content-type"),s.headers=i}else(o.includes("application/json")||typeof t.data=="object")&&(s.body=JSON.stringify(t.data));return s};class _e extends N{async request(e){const s=Le(e,e.webFetchExtra),r=Pe(e.params,e.shouldEncodeUrlParams),o=r?`${e.url}?${r}`:e.url,n=await fetch(o,s),i=n.headers.get("content-type")||"";let{responseType:a="text"}=n.ok?e:{};i.includes("application/json")&&(a="json");let u,c;switch(a){case"arraybuffer":case"blob":c=await n.blob(),u=await ve(c);break;case"json":u=await n.json();break;case"document":case"text":default:u=await n.text()}const O={};return n.headers.forEach((P,W)=>{O[W]=P}),{data:u,headers:O,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}I("CapacitorHttp",{web:()=>new _e});const q=I("SocialLogin",{web:()=>X(()=>import("./web.DL9fLOS3.js"),[],import.meta.url).then(t=>new t.SocialLoginWeb)}),je="https://basemap.surflux.studio/geoserver",Ce=`${je}/gwc/service/tms/1.0.0/bluedot:base_building@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf`,Ie="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_railway_900913_241127.json",xe="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_station_900913_241127.json",Me="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_entrance_900913_241127.json";var Y=(t=>(t[t.MobileS=320]="MobileS",t[t.MobileM=375]="MobileM",t[t.MobileL=425]="MobileL",t[t.Tablet=768]="Tablet",t[t.Laptop=1024]="Laptop",t[t.LaptopL=1440]="LaptopL",t[t.FourK=2560]="FourK",t))(Y||{});const S="https://api.bluedot.land",We="https://d1egcbbnpo4gtd.cloudfront.net",Te={public:"공개",follower:"팔로워 공개",private:"비공개"},Ee={owner:"소유자",manager:"관리 권한",writer:"편집 권한",reader:"읽기 권한",none:"권한 없음"};function ke(t){return{all:t=t||new Map,on:function(e,s){var r=t.get(e);r?r.push(s):t.set(e,[s])},off:function(e,s){var r=t.get(e);r&&(s?r.splice(r.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var r=t.get(e);r&&r.slice().map(function(o){o(s)}),(r=t.get("*"))&&r.slice().map(function(o){o(e,s)})}}}const ee=ke(),Fe=g(void 0),Be=g(Y.MobileM),De=g([]),qe=g(""),He=g(""),Re=g(!1),Ge=g([]),ze=g([]),D=g(!1),Je=g(!1),Ke=g([]),Ve=g(!1),Se=g(!0),H=I("SecureStoragePlugin",{web:()=>X(()=>import("./web.LmmnjlCH.js"),[],import.meta.url).then(t=>new t.SecureStoragePluginWeb)}),C=k.getPlatform(),x=C==="ios"||C==="android";async function Qe(){q.initialize({google:{iOSClientId:"298551622119-6r1e3ji2e6vdioqarf2pg3g6brvd47od.apps.googleusercontent.com",webClientId:"298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com"},apple:{}})}async function Xe(t){var e;if(x){const r=(await q.login({provider:"google",options:{scopes:["email","profile"]}})).result,n=await(await fetch(`${S}/auth/social/user`,{method:"POST",body:JSON.stringify({name:r.profile.name,email:r.profile.email,picture:r.profile.imageUrl,provider:"google",keepSignin:t})})).json();if(!((e=n==null?void 0:n.data)!=null&&e.access))throw ee.emit("pushSnackbar",{message:"로그인에 실패했습니다."}),Error("Failed to sign in");M(n.data.access,n.data.refresh)}else if(C==="web"){const s="298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com",r=`${S}/auth/oauth/google`,o="email profile",n="code",i=new URL(window.location.href);i.searchParams.set("keepSignin",t.toString());const a=encodeURIComponent(i.toString()),u=`https://accounts.google.com/o/oauth2/v2/auth?response_type=${n}&client_id=${s}&redirect_uri=${r}&scope=${o}&state=${a}`;location.replace(u)}else throw Error("Not supported platform")}async function Ze(t){var a;if(C!=="ios")return;const s=(await q.login({provider:"apple",options:{}})).result;let r=s.profile.givenName??"";s.profile.familyName&&(r+=(r?" ":"")+s.profile.familyName);let o=s.profile.email;const i=await(await fetch(`${S}/auth/social/apple`,{method:"POST",body:JSON.stringify({name:r,email:o,providerId:s.profile.user,keepSignin:t})})).json();if(!((a=i==null?void 0:i.data)!=null&&a.access))throw ee.emit("pushSnackbar",{message:"로그인에 실패했습니다."}),Error("Failed to sign in");M(i.data.access,i.data.refresh)}function Ne(){sessionStorage.removeItem("jwt"),x&&H.clear()}function R(){try{const t=sessionStorage.getItem("jwt")||null;if(!t)throw new Error("jwt not found");if(fe(D)===!0&&!window.location.pathname.startsWith("/users/sign-up/")&&!window.location.pathname.startsWith("/tp/"))return console.log("A"),U("/users/sign-up/agreement"),null;const e=G(t);if(e.exp&&Math.floor(Date.now()/1e3)>e.exp)throw Se.set(!0),new Error("jwt expired");return e.sig===!1&&!window.location.pathname.startsWith("/users/sign-up")&&!window.location.pathname.startsWith("/tp")?(D.set(!0),U("/users/sign-up/agreement"),null):t}catch(t){return console.warn(t),sessionStorage.removeItem("jwt"),null}}function Oe(){const t=R();return t?G(t):null}function Ye(){const t=Oe();return t?BigInt(t.sub):null}function M(t,e){sessionStorage.setItem("jwt",t),x&&e&&H.set({key:"refresh",value:e})}async function et(){const t={credentials:"include"};if(x)try{const e=await H.get({key:"refresh"});if(!e.value)return!1;t.headers={Authorization:`Bearer ${e.value}`}}catch{return!1}try{const e=await fetch(`${S}/auth/token/refresh`,t);if(!e.ok)throw new Error("Failed to refresh token");const s=await e.json();return M(s.data.access,s.data.refresh),!0}catch{return!1}}async function tt(t){const e=t.searchParams.get("access");if(e){M(e);const s=G(e).sig;if(t.searchParams.delete("access"),s===!1){D.set(!0),await U("/users/sign-up/agreement");return}await U(t.toString(),{replaceState:!0,invalidateAll:!1})}}function G(t){const s=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),r=decodeURIComponent(atob(s).split("").map(function(o){return"%"+("00"+o.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(r)}function st(){return R()!==null}async function rt(t){return(await(await fetch(`${S}/auth/users/${t}`,{headers:{Authorization:`Bearer ${R()}`}})).json()).data}export{S as A,Ze as B,k as C,Se as D,et as E,Qe as F,Fe as G,Ie as H,xe as I,Me as J,je as K,Ce as P,Y as S,N as W,Ke as a,Ye as b,D as c,Je as d,ee as e,M as f,R as g,Ge as h,st as i,Oe as j,Te as k,Ve as l,De as m,He as n,qe as o,We as p,Ee as q,I as r,ze as s,rt as t,Ne as u,Re as v,B as w,tt as x,Be as y,Xe as z};
