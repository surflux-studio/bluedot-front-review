const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./web.DGrp_2VT.js","./Header.C-SSaVVB.js","./scheduler.BnheM4g2.js","./index.CP53dWnj.js","./searchParams.D093FyDZ.js","./entry.BdOYDfWF.js","./stores.CDPW79G6.js"])))=>i.map(i=>d[i]);
import{g as f}from"./entry.BdOYDfWF.js";import{_ as d}from"./preload-helper.D6kgxu3v.js";import{a as w,C as h,e as S}from"./Header.C-SSaVVB.js";import{d as l,A as c}from"./store.BtYvGLBK.js";const g=w("SocialLogin",{web:()=>d(()=>import("./web.DGrp_2VT.js"),__vite__mapDeps([0,1,2,3,4,5,6]),import.meta.url).then(e=>new e.SocialLoginWeb)}),n=h.getPlatform();async function P(){g.initialize({google:{iOSClientId:"298551622119-6r1e3ji2e6vdioqarf2pg3g6brvd47od.apps.googleusercontent.com",webClientId:"298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com"}})}async function U(){var e;if(n==="ios"||n==="android"){const o=(await g.login({provider:"google",options:{scopes:["email","profile"]}})).result,s=await(await fetch(`${c}/auth/oauth/google/user`,{method:"POST",body:JSON.stringify({name:o.profile.name,email:o.profile.email,picture:o.profile.imageUrl})})).json();if(!((e=s==null?void 0:s.data)!=null&&e.access))throw S.emit("pushSnackbar",{message:"로그인에 실패했습니다."}),Error("Failed to sign in");const r=s.data.access;u(r)}else if(n==="web"){const t="298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com",o=`${c}/auth/oauth/google`,a="email profile",s="code",r=window.location.href,m=`https://accounts.google.com/o/oauth2/v2/auth?response_type=${s}&client_id=${t}&redirect_uri=${o}&scope=${a}&state=${r}`;location.replace(m)}else throw Error("Not supported platform")}function I(){localStorage.removeItem("jwt"),localStorage.removeItem("saveSignLocal"),sessionStorage.removeItem("jwt")}function p(){try{const e=sessionStorage.getItem("jwt")||localStorage.getItem("jwt")||null;if(!e)throw new Error("jwt not found");const t=i(e);if(t.exp&&Math.floor(Date.now()/1e3)>=t.exp)throw new Error("jwt expired");return t.sig===!1&&l.set(!0),e}catch(e){return console.warn(e),I(),null}}function j(){const e=p();return e?i(e):null}function J(){const e=j();return e?BigInt(e.sub):null}function u(e){localStorage.getItem("saveSignLocal")=="true"&&localStorage.setItem("jwt",e),sessionStorage.setItem("jwt",e)}async function O(e){const t=e.searchParams.get("access");t&&(i(t).sig===!1&&l.set(!0),u(t)),e.searchParams.delete("access"),e.searchParams.delete("refresh"),t&&await f(e.toString(),{replaceState:!0,invalidateAll:!1})}function i(e){const o=e.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),a=decodeURIComponent(atob(o).split("").map(function(s){return"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(a)}function $(){return p()!==null}export{J as a,j as b,U as c,u as d,P as e,p as g,O as h,$ as i,I as s};
