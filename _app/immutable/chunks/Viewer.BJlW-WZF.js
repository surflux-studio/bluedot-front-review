import{s as oe,D as ie,i as S,f as p,e as D,a as q,t as be,c as M,b as R,g as j,d as ve,v as m,h as k,A as z,j as Ne,z as $,O as Ze,C as Q,n as J,q as xe,r as Ie,E as Ae,F as we,ae as We,B as St,J as Xe,w as Me,x as Oe,L as Ft,N as st,k as it,y as Il,Q as El,G as yl,I as Tl}from"./scheduler.DnGlJ4RW.js";import{S as fe,i as ue,t as y,g as ee,a as O,e as te,c as H,d as Z,m as G,f as W,b as Re}from"./index.D2MnZ5yf.js";import{e as he,u as Je,f as Dl,o as qt}from"./each.D5K8MyqL.js";import{A as Le,l as rt,I as Ue}from"./store.DENZNcr-.js";import{g as Ge}from"./entry.Cr1mRZIL.js";import{p as Ml}from"./stores.as1ujLHN.js";import{e as ge}from"./emitter.E5P-NQ8u.js";import{g as He,u as Vl}from"./searchParams.Bl21BEW_.js";/* empty css                                           *//* empty css                                                  */import{f as Bl,u as Pl}from"./follow.CNJ-qcFH.js";import{a as Ve,b as jt,g as ze,i as at}from"./sign.D9t7E-7K.js";import{C as Ol}from"./CircleImage.BKAebVv0.js";import{g as ot}from"./color.C_Jm4JAr.js";import{s as ft}from"./s32cloudfront.CRSC3KMz.js";import{r as Ee}from"./units.BJZU6p1c.js";import"./ActionSheet.svelte_svelte_type_style_lang.D0y5xGpd.js";import{C as Rl}from"./device.DOG8pcbg.js";import"./index.CODIFRwb.js";import{a as Ll}from"./NavigationBar.CKIqf98o.js";import{C as Ut}from"./Chip.BrSSFOiV.js";import{B as Al}from"./BottomNavigationPadder.D2t9qfF3.js";import{I as Nl,a as Sl}from"./IconHeartFill.B6cHHSmI.js";import{l as Fl}from"./longPress.C9F0mLoM.js";import{I as ql}from"./IconMore.BR6OOPpn.js";import{A as Xt}from"./ActionSheet.DQs9ytdW.js";import{M as jl}from"./Modal.CHPmfT-s.js";import{f as Ul,c as Xl,a as zl}from"./ActionSheetReport.svelte_svelte_type_style_lang.BKEdR94F.js";import{F as Yl}from"./Figure.DPmea2PO.js";import{w as Hl,I as Zl}from"./utils.BfwOxyvN.js";function ut(n){let e,t,l,s,r,a,f=n[0].unique_name+"",i,o,u,_=String(n[0].user_idx)!==String(Ve()),g,I,L;const b=[Wl,Gl],d=[];function h(T,E){return T[0].profile_image_url?0:1}t=h(n),l=d[t]=b[t](n);let v=_&&ct(n);return{c(){e=D("div"),l.c(),s=q(),r=D("div"),a=D("div"),i=be(f),o=q(),u=D("div"),v&&v.c(),this.h()},l(T){e=M(T,"DIV",{class:!0});var E=R(e);l.l(E),s=j(E),r=M(E,"DIV",{class:!0});var x=R(r);a=M(x,"DIV",{class:!0});var U=R(a);i=ve(U,f),U.forEach(p),o=j(x),u=M(x,"DIV",{class:!0});var P=R(u);v&&v.l(P),P.forEach(p),x.forEach(p),E.forEach(p),this.h()},h(){m(a,"class","text-sm text-white"),m(u,"class","flex gap-1 items-center"),m(r,"class","flex gap-1 items-center"),m(e,"class","flex gap-[0.625rem] justify-center items-center")},m(T,E){S(T,e,E),d[t].m(e,null),k(e,s),k(e,r),k(r,a),k(a,i),k(r,o),k(r,u),v&&v.m(u,null),g=!0,I||(L=z(a,"click",n[7]),I=!0)},p(T,E){let x=t;t=h(T),t===x?d[t].p(T,E):(ee(),O(d[x],1,1,()=>{d[x]=null}),te(),l=d[t],l?l.p(T,E):(l=d[t]=b[t](T),l.c()),y(l,1),l.m(e,s)),(!g||E&1)&&f!==(f=T[0].unique_name+"")&&Ne(i,f),E&1&&(_=String(T[0].user_idx)!==String(Ve())),_?v?v.p(T,E):(v=ct(T),v.c(),v.m(u,null)):v&&(v.d(1),v=null)},i(T){g||(y(l),g=!0)},o(T){O(l),g=!1},d(T){T&&p(e),d[t].d(),v&&v.d(),I=!1,L()}}}function Gl(n){var f;let e,t,l=(((f=n[0].unique_name)==null?void 0:f.at(0))??"u")+"",s,r,a;return{c(){e=D("div"),t=D("span"),s=be(l),this.h()},l(i){e=M(i,"DIV",{class:!0,style:!0});var o=R(e);t=M(o,"SPAN",{class:!0});var u=R(t);s=ve(u,l),u.forEach(p),o.forEach(p),this.h()},h(){m(t,"class","text-base font-semibold text-black"),m(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),Q(e,"background-color",ot(n[0].unique_name))},m(i,o){S(i,e,o),k(e,t),k(t,s),r||(a=z(e,"click",n[6]),r=!0)},p(i,o){var u;o&1&&l!==(l=(((u=i[0].unique_name)==null?void 0:u.at(0))??"u")+"")&&Ne(s,l),o&1&&Q(e,"background-color",ot(i[0].unique_name))},i:J,o:J,d(i){i&&p(e),r=!1,a()}}}function Wl(n){let e,t;return e=new Ol({props:{src:ft(n[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",n[5]),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.src=ft(l[0].profile_image_url,500)),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function ct(n){let e,t="•",l,s,r=n[0].is_following?"팔로잉":"팔로우",a,f,i,o;return{c(){e=D("div"),e.textContent=t,l=q(),s=D("div"),a=be(r),this.h()},l(u){e=M(u,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-168vif2"&&(e.textContent=t),l=j(u),s=M(u,"DIV",{class:!0});var _=R(s);a=ve(_,r),_.forEach(p),this.h()},h(){m(e,"class","text-xs text-white/60"),m(s,"class",f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(u,_){S(u,e,_),S(u,l,_),S(u,s,_),k(s,a),i||(o=z(s,"click",function(){Ze(n[0].is_following?n[2]:n[1])&&(n[0].is_following?n[2]:n[1]).apply(this,arguments)}),i=!0)},p(u,_){n=u,_&1&&r!==(r=n[0].is_following?"팔로잉":"팔로우")&&Ne(a,r),_&1&&f!==(f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&m(s,"class",f)},d(u){u&&(p(e),p(l),p(s)),i=!1,o()}}}function Jl(n){let e,t,l=n[0].idx&&n[0].unique_name&&ut(n);return{c(){l&&l.c(),e=ie()},l(s){l&&l.l(s),e=ie()},m(s,r){l&&l.m(s,r),S(s,e,r),t=!0},p(s,[r]){s[0].idx&&s[0].unique_name?l?(l.p(s,r),r&1&&y(l,1)):(l=ut(s),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(ee(),O(l,1,1,()=>{l=null}),te())},i(s){t||(y(l),t=!0)},o(s){O(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function Kl(n,e,t){let{post:l}=e,{allowFollow:s=!0}=e,{whenCancelFollow:r=()=>{}}=e,a=!1;async function f(){if(!s)return r();a||(a=!0,await Bl({targetIdx:l.user_idx,subjectIdx:Ve()}),t(0,l.is_following=!0,l),a=!1)}async function i(){if(!s)return r();a||(a=!0,await Pl({targetIdx:l.user_idx,subjectIdx:Ve()}),t(0,l.is_following=!1,l),a=!1)}const o=()=>{He(`/users/${l.user_idx}`)},u=()=>{He(`/users/${l.user_idx}`)},_=()=>{He(`/users/${l.user_idx}`)};return n.$$set=g=>{"post"in g&&t(0,l=g.post),"allowFollow"in g&&t(3,s=g.allowFollow),"whenCancelFollow"in g&&t(4,r=g.whenCancelFollow)},[l,f,i,s,r,o,u,_]}class Ql extends fe{constructor(e){super(),ue(this,e,Kl,Jl,oe,{post:0,allowFollow:3,whenCancelFollow:4})}}function $l(n){let e,t,l,s;return{c(){e=xe("svg"),t=xe("path"),l=xe("path"),this.h()},l(r){e=Ie(r,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var a=R(e);t=Ie(a,"path",{d:!0,fill:!0}),R(t).forEach(p),l=Ie(a,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),R(l).forEach(p),a.forEach(p),this.h()},h(){m(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),m(t,"fill",n[0]),m(l,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),m(l,"stroke",n[1]),m(l,"stroke-width","2"),m(l,"stroke-linejoin","round"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"width",n[2]),m(e,"height",n[2]),m(e,"viewBox",s="0 0 "+n[2]+" "+n[2]),m(e,"fill","none")},m(r,a){S(r,e,a),k(e,t),k(e,l)},p(r,[a]){a&1&&m(t,"fill",r[0]),a&2&&m(l,"stroke",r[1]),a&4&&m(e,"width",r[2]),a&4&&m(e,"height",r[2]),a&4&&s!==(s="0 0 "+r[2]+" "+r[2])&&m(e,"viewBox",s)},i:J,o:J,d(r){r&&p(e)}}}function en(n,e,t){let l,{fill:s="#FF4F1E"}=e,{stroke:r="#FF4F1E"}=e,{length:a=1.5}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"stroke"in f&&t(1,r=f.stroke),"length"in f&&t(3,a=f.length)},n.$$.update=()=>{n.$$.dirty&8&&t(2,l=Ee(a))},[s,r,l,a]}class tn extends fe{constructor(e){super(),ue(this,e,en,$l,oe,{fill:0,stroke:1,length:3})}}function Ye(n){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const s=r=>r.stopPropagation();return n.addEventListener(l,s),{event:l,handler:s}});return{destroy(){t.forEach(({event:l,handler:s})=>{n.removeEventListener(l,s)})}}}function dt(n){let e,t;return e=new Ut({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Ll,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:n[0].name}}),e.$on("click",n[1]),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s&1&&(r.value=l[0].name),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function ln(n){let e,t,l=n[0].idx&&dt(n);return{c(){l&&l.c(),e=ie()},l(s){l&&l.l(s),e=ie()},m(s,r){l&&l.m(s,r),S(s,e,r),t=!0},p(s,[r]){s[0].idx?l?(l.p(s,r),r&1&&y(l,1)):(l=dt(s),l.c(),y(l,1),l.m(e.parentNode,e)):l&&(ee(),O(l,1,1,()=>{l=null}),te())},i(s){t||(y(l),t=!0)},o(s){O(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function nn(n,e,t){let{place:l}=e;const s=async()=>{await Ge(`/places/${l.idx}`)};return n.$$set=r=>{"place"in r&&t(0,l=r.place)},[l,s]}class sn extends fe{constructor(e){super(),ue(this,e,nn,ln,oe,{place:0})}}function rn(n){let e,t;return{c(){e=xe("svg"),t=xe("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=R(e);t=Ie(s,"path",{d:!0}),R(t).forEach(p),s.forEach(p),this.h()},h(){m(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 -960 960 960"),m(e,"width",n[1]),m(e,"height",n[1]),m(e,"fill",n[0])},m(l,s){S(l,e,s),k(e,t)},p(l,[s]){s&2&&m(e,"width",l[1]),s&2&&m(e,"height",l[1]),s&1&&m(e,"fill",l[0])},i:J,o:J,d(l){l&&p(e)}}}function an(n,e,t){let l,{fill:s="#5f6368"}=e,{length:r="1.75"}=e,{alt:a="Edit"}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,r=f.length),"alt"in f&&t(3,a=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=Ee(r))},[s,l,r,a]}class on extends fe{constructor(e){super(),ue(this,e,an,rn,oe,{fill:0,length:2,alt:3})}}function fn(n){let e,t;return{c(){e=xe("svg"),t=xe("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=R(e);t=Ie(s,"path",{d:!0}),R(t).forEach(p),s.forEach(p),this.h()},h(){m(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),m(e,"xmlns","http://www.w3.org/2000/svg"),m(e,"viewBox","0 -960 960 960"),m(e,"width",n[1]),m(e,"height",n[1]),m(e,"fill",n[0])},m(l,s){S(l,e,s),k(e,t)},p(l,[s]){s&2&&m(e,"width",l[1]),s&2&&m(e,"height",l[1]),s&1&&m(e,"fill",l[0])},i:J,o:J,d(l){l&&p(e)}}}function un(n,e,t){let l,{fill:s="#5f6368"}=e,{length:r="1.75"}=e,{alt:a="Delete"}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,r=f.length),"alt"in f&&t(3,a=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=Ee(r))},[s,l,r,a]}class cn extends fe{constructor(e){super(),ue(this,e,un,fn,oe,{fill:0,length:2,alt:3})}}function dn(n){let e,t=(n[0].text||"")+"",l,s,r;return{c(){e=D("p"),l=be(t),this.h()},l(a){e=M(a,"P",{class:!0,style:!0});var f=R(e);l=ve(f,t),f.forEach(p),this.h()},h(){m(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),m(e,"style",`
      overflow: hidden;
      height: ${n[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(a,f){S(a,e,f),k(e,l),s||(r=[Ae(Ye.call(null,e)),z(e,"click",n[2])],s=!0)},p(a,[f]){f&1&&t!==(t=(a[0].text||"")+"")&&Ne(l,t)},i:J,o:J,d(a){a&&p(e),s=!1,we(r)}}}function hn(n,e,t){const l=We();let{post:s}=e;const r=Ee(1),a=Ee(6);function f(i){const o=i.currentTarget;if(o)if(o.style.height===`${r}px`||!o.style.height){if(o.scrollHeight>r){const u=o.scrollHeight<a?o.scrollHeight:a;o.style.height=`${u}px`,o.style.overflow="scroll",o.style.display="block",o.style.webkitLineClamp="unset",l("textExpanded",{expanded:!0})}}else o.style.height=`${r}px`,o.style.overflow="hidden",o.style.display="-webkit-box",o.style.webkitLineClamp="1",l("textExpanded",{expanded:!1})}return St(()=>{l("textExpanded",{expanded:!1})}),n.$$set=i=>{"post"in i&&t(0,s=i.post)},[s,r,f]}class mn extends fe{constructor(e){super(),ue(this,e,hn,dn,oe,{post:0})}}function pn(n){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),R(e).forEach(p),this.h()},h(){m(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),Q(e,"opacity","0.6"),Q(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,l){S(t,e,l)},d(t){t&&p(e)}}}function _n(n){let e;return{c(){e=D("div"),this.h()},l(t){e=M(t,"DIV",{class:!0,style:!0}),R(e).forEach(p),this.h()},h(){m(e,"class","fixed inset-0 pointer-events-none z-30"),Q(e,"opacity","0.7"),Q(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,l){S(t,e,l)},d(t){t&&p(e)}}}function gn(n){let e;function t(r,a){return r[0]?_n:pn}let l=t(n),s=l(n);return{c(){s.c(),e=ie()},l(r){s.l(r),e=ie()},m(r,a){s.m(r,a),S(r,e,a)},p(r,[a]){l!==(l=t(r))&&(s.d(1),s=l(r),s&&(s.c(),s.m(e.parentNode,e)))},i:J,o:J,d(r){r&&p(e),s.d(r)}}}function bn(n,e,t){let{isTextExpanded:l=!1}=e;return n.$$set=s=>{"isTextExpanded"in s&&t(0,l=s.isTextExpanded)},[l]}class vn extends fe{constructor(e){super(),ue(this,e,bn,gn,oe,{isTextExpanded:0})}}function ht(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function mt(n,e){let t,l,s,r,a,f=J;return{key:n,first:null,c(){t=D("span"),l=D("span"),r=q(),this.h()},l(i){t=M(i,"SPAN",{class:!0,style:!0});var o=R(t);l=M(o,"SPAN",{class:!0,style:!0}),R(l).forEach(p),r=j(o),o.forEach(p),this.h()},h(){m(l,"class",s=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),Q(l,"transform","scale("+e[4](e[7])+")"),Q(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),m(t,"class","flex items-center justify-center"),Q(t,"width","0.375rem"),Q(t,"height","0.375rem"),this.first=t},m(i,o){S(i,t,o),k(t,l),k(t,r)},p(i,o){e=i,o&13&&s!==(s=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&m(l,"class",s),o&8&&Q(l,"transform","scale("+e[4](e[7])+")"),o&13&&Q(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){a=t.getBoundingClientRect()},f(){Ul(t),f()},a(){f(),f=Xl(t,a,zl,{})},d(i){i&&p(t)}}}function wn(n){let e,t=[],l=new Map,s,r=he(n[3]);const a=f=>f[5];for(let f=0;f<r.length;f+=1){let i=ht(n,r,f),o=a(i);l.set(o,t[f]=mt(o,i))}return{c(){e=D("div");for(let f=0;f<t.length;f+=1)t[f].c();this.h()},l(f){e=M(f,"DIV",{class:!0});var i=R(e);for(let o=0;o<t.length;o+=1)t[o].l(i);i.forEach(p),this.h()},h(){m(e,"class",s=Xe(`
    ${n[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(f,i){S(f,e,i);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(f,[i]){if(i&29){r=he(f[3]);for(let o=0;o<t.length;o+=1)t[o].r();t=Je(t,i,a,1,f,r,l,e,Dl,mt,null,ht);for(let o=0;o<t.length;o+=1)t[o].a()}i&2&&s!==(s=Xe(`
    ${f[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&m(e,"class",s)},i:J,o:J,d(f){f&&p(e);for(let i=0;i<t.length;i+=1)t[i].d()}}}const De=7;function kn(n,e,t){let{post:l}=e,{fixed:s=!0}=e,r=[],a=0;function f(i){const o=l.mediaIdx-a,u=r.length;if(u<=1)return 1;const _=Math.max(o,u-1-o);return _===0?1:1-Math.abs(i-o)/_*.5}return n.$$set=i=>{"post"in i&&t(0,l=i.post),"fixed"in i&&t(1,s=i.fixed)},n.$$.update=()=>{n.$$.dirty&5&&(l.media.length>De?(l.mediaIdx<=Math.floor(De/2)?t(2,a=0):l.mediaIdx>=l.media.length-Math.ceil(De/2)?t(2,a=l.media.length-De):t(2,a=l.mediaIdx-Math.floor(De/2)),t(3,r=l.media.slice(a,a+De))):(t(2,a=0),t(3,r=l.media)))},[l,s,a,r,f]}class zt extends fe{constructor(e){super(),ue(this,e,kn,wn,oe,{post:0,fixed:1})}}function pt(n,e,t){const l=n.slice();return l[13]=e[t].text,l[14]=e[t].value,l[15]=e[t].custom,l[17]=t,l}function _t(n){let e,t,l,s,r=n[13]+"",a,f,i,o;return{c(){e=D("label"),t=D("input"),l=q(),s=D("span"),a=be(r),f=q(),this.h()},l(u){e=M(u,"LABEL",{class:!0});var _=R(e);t=M(_,"INPUT",{type:!0,name:!0,class:!0}),l=j(_),s=M(_,"SPAN",{class:!0});var g=R(s);a=ve(g,r),g.forEach(p),f=j(_),_.forEach(p),this.h()},h(){m(t,"type","radio"),m(t,"name","report"),m(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=n[14],m(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),m(e,"class","flex gap-2 py-2")},m(u,_){S(u,e,_),k(e,t),k(e,l),k(e,s),k(s,a),k(e,f),i||(o=z(t,"change",n[7]),i=!0)},p:J,d(u){u&&p(e),i=!1,o()}}}function gt(n){let e,t,l,s;return{c(){e=D("div"),t=D("textarea"),this.h()},l(r){e=M(r,"DIV",{class:!0});var a=R(e);t=M(a,"TEXTAREA",{class:!0,placeholder:!0}),R(t).forEach(p),a.forEach(p),this.h()},h(){m(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal"),m(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),m(e,"class","px-5 py-2.5")},m(r,a){S(r,e,a),k(e,t),st(t,n[2]),l||(s=z(t,"input",n[8]),l=!0)},p(r,a){a&4&&st(t,r[2])},d(r){r&&p(e),l=!1,s()}}}function Cn(n){let e,t,l="게시물 신고 사유",s,r,a,f,i,o,u="취소",_,g,I="신고",L,b,d=he(n[3]),h=[];for(let T=0;T<d.length;T+=1)h[T]=_t(pt(n,d,T));let v=n[1]==="etc"&&gt(n);return{c(){e=D("div"),t=D("heading"),t.textContent=l,s=q(),r=D("div");for(let T=0;T<h.length;T+=1)h[T].c();a=q(),v&&v.c(),f=q(),i=D("div"),o=D("button"),o.textContent=u,_=q(),g=D("button"),g.textContent=I,this.h()},l(T){e=M(T,"DIV",{class:!0});var E=R(e);t=M(E,"HEADING",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-z3puxq"&&(t.textContent=l),s=j(E),r=M(E,"DIV",{class:!0});var x=R(r);for(let P=0;P<h.length;P+=1)h[P].l(x);x.forEach(p),a=j(E),v&&v.l(E),f=j(E),i=M(E,"DIV",{class:!0});var U=R(i);o=M(U,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-xb8aop"&&(o.textContent=u),_=j(U),g=M(U,"BUTTON",{class:!0,"data-svelte-h":!0}),$(g)!=="svelte-1fehi46"&&(g.textContent=I),U.forEach(p),E.forEach(p),this.h()},h(){m(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),m(r,"class","px-5"),m(o,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),m(g,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),m(i,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),m(e,"class","flex flex-col gap-2.5")},m(T,E){S(T,e,E),k(e,t),k(e,s),k(e,r);for(let x=0;x<h.length;x+=1)h[x]&&h[x].m(r,null);k(e,a),v&&v.m(e,null),k(e,f),k(e,i),k(i,o),k(i,_),k(i,g),L||(b=[z(o,"click",n[9]),z(g,"click",n[4]),Ae(Ye.call(null,e))],L=!0)},p(T,E){if(E&10){d=he(T[3]);let x;for(x=0;x<d.length;x+=1){const U=pt(T,d,x);h[x]?h[x].p(U,E):(h[x]=_t(U),h[x].c(),h[x].m(r,null))}for(;x<h.length;x+=1)h[x].d(1);h.length=d.length}T[1]==="etc"?v?v.p(T,E):(v=gt(T),v.c(),v.m(e,f)):v&&(v.d(1),v=null)},d(T){T&&p(e),Ft(h,T),v&&v.d(),L=!1,we(b)}}}function xn(n){let e,t,l;function s(a){n[10](a)}let r={noHandle:!0,fixed:!0,$$slots:{default:[Cn]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.isOpen=n[0]),e=new Xt({props:r}),Me.push(()=>Re(e,"isOpen",s)),{c(){H(e.$$.fragment)},l(a){Z(e.$$.fragment,a)},m(a,f){G(e,a,f),l=!0},p(a,[f]){const i={};f&262151&&(i.$$scope={dirty:f,ctx:a}),!t&&f&1&&(t=!0,i.isOpen=a[0],Oe(()=>t=!1)),e.$set(i)},i(a){l||(y(e.$$.fragment,a),l=!0)},o(a){O(e.$$.fragment,a),l=!1},d(a){W(e,a)}}}function In(n,e,t){const l=We();let{isOpen:s}=e,{selectedValue:r=""}=e,{targetTable:a=""}=e,{targetIdx:f=""}=e;const i=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let o="",u=!1;async function _(){const d=i.findIndex(h=>h.value===r);if(d===-1){alert("신고 사유를 선택해주세요.");return}if(!u){u=!0,ge.emit("loading",!0);try{const h=i[d],v=new URL(`${Le}/auth/permissions`);v.searchParams.set("targetTable",a),v.searchParams.set("targetIdx",f),v.searchParams.set("relation","reported"),v.searchParams.set("subjectTable","users"),v.searchParams.set("subjectIdx",jt().sub),v.searchParams.set("metadata",JSON.stringify({...h,customReason:o})),t(0,s=!1),t(2,o=""),await fetch(v,{method:"PUT",headers:{Authorization:`Bearer ${ze()}`}}),l("reported")}finally{u=!1,ge.emit("loading",!1)}}}const g=d=>{t(1,r=d.target.value)};function I(){o=this.value,t(2,o)}const L=()=>{t(0,s=!1)};function b(d){s=d,t(0,s)}return n.$$set=d=>{"isOpen"in d&&t(0,s=d.isOpen),"selectedValue"in d&&t(1,r=d.selectedValue),"targetTable"in d&&t(5,a=d.targetTable),"targetIdx"in d&&t(6,f=d.targetIdx)},[s,r,o,i,_,a,f,g,I,L,b]}class En extends fe{constructor(e){super(),ue(this,e,In,xn,oe,{isOpen:0,selectedValue:1,targetTable:5,targetIdx:6})}}function bt(n){let e,t,l,s="이 게시물을 신고해 주셔서 감사합니다.",r,a,f="신고 취소하기",i,o;return{c(){e=D("div"),t=D("div"),l=D("div"),l.textContent=s,r=q(),a=D("div"),a.textContent=f,this.h()},l(u){e=M(u,"DIV",{class:!0});var _=R(e);t=M(_,"DIV",{class:!0});var g=R(t);l=M(g,"DIV",{class:!0,"data-svelte-h":!0}),$(l)!=="svelte-179ijsk"&&(l.textContent=s),r=j(g),a=M(g,"DIV",{class:!0,"data-svelte-h":!0}),$(a)!=="svelte-1haiztv"&&(a.textContent=f),g.forEach(p),_.forEach(p),this.h()},h(){m(l,"class","text-white text-[0.9375rem] font-semibold"),m(a,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),m(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),m(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(u,_){S(u,e,_),k(e,t),k(t,l),k(t,r),k(t,a),i||(o=z(a,"click",n[1]),i=!0)},p:J,d(u){u&&p(e),i=!1,o()}}}function yn(n){let e,t=n[0]&&bt(n);return{c(){t&&t.c(),e=ie()},l(l){t&&t.l(l),e=ie()},m(l,s){t&&t.m(l,s),S(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=bt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:J,o:J,d(l){l&&p(e),t&&t.d(l)}}}function Tn(n,e,t){const l=We();let{isVisible:s=!1}=e,{targetTable:r=""}=e,{targetIdx:a=""}=e,f=!1;async function i(){if(f!==!0){f=!0,ge.emit("loading",!0);try{const o=new URL(`${Le}/auth/permissions`);o.searchParams.set("targetTable",r),o.searchParams.set("targetIdx",a),o.searchParams.set("relation","reported"),o.searchParams.set("subjectTable","users"),o.searchParams.set("subjectIdx",jt().sub),await fetch(o,{method:"DELETE",headers:{Authorization:`Bearer ${ze()}`}}),t(0,s=!1),l("unreported")}finally{f=!1,ge.emit("loading",!1)}}}return n.$$set=o=>{"isVisible"in o&&t(0,s=o.isVisible),"targetTable"in o&&t(2,r=o.targetTable),"targetIdx"in o&&t(3,a=o.targetIdx)},[s,i,r,a]}class Dn extends fe{constructor(e){super(),ue(this,e,Tn,yn,oe,{isVisible:0,targetTable:2,targetIdx:3})}}function vt(n,e,t){const l=n.slice();return l[82]=e[t],l[83]=e,l[84]=t,l}function wt(n,e,t){const l=n.slice();return l[85]=e[t],l}function kt(n,e,t){const l=n.slice();return l[88]=e[t],l[90]=t,l}function Ct(n){let e,t,l;return{c(){e=D("div"),this.h()},l(s){e=M(s,"DIV",{class:!0}),R(e).forEach(p),this.h()},h(){m(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,r){S(s,e,r),t||(l=z(e,"contextmenu",yl(n[25])),t=!0)},d(s){s&&p(e),t=!1,l()}}}function xt(n){let e,t,l,s=[],r=new Map,a,f,i,o,u,_,g,I=he(n[82].media);const L=d=>d[88];for(let d=0;d<I.length;d+=1){let h=kt(n,I,d),v=L(h);r.set(v,s[d]=It(v,h))}let b=!n[5]&&Et(n);return{c(){e=D("section"),t=D("div"),l=D("div");for(let d=0;d<s.length;d+=1)s[d].c();f=q(),b&&b.c(),i=q(),this.h()},l(d){e=M(d,"SECTION",{class:!0,style:!0});var h=R(e);t=M(h,"DIV",{class:!0});var v=R(t);l=M(v,"DIV",{class:!0,style:!0});var T=R(l);for(let E=0;E<s.length;E+=1)s[E].l(T);T.forEach(p),v.forEach(p),f=j(h),b&&b.l(h),i=j(h),h.forEach(p),this.h()},h(){m(l,"class",a="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[9]?"duration-0 transition-duration-0":"")),Q(l,"transform","translateX("+(-n[82].mediaIdx*n[12].width+n[11])+"px)"),m(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),m(e,"class",o=`w-full h-full absolute content-center transition-transform
            ${n[9]?"duration-0 transition-duration-0":""}`),Q(e,"top","0"),Q(e,"transform","translateY("+((n[84]-n[1])*n[12].height+n[10])+"px)")},m(d,h){S(d,e,h),k(e,t),k(t,l);for(let v=0;v<s.length;v+=1)s[v]&&s[v].m(l,null);k(e,f),b&&b.m(e,null),k(e,i),u=!0,_||(g=[z(l,"transitionend",function(){Ze(n[82].mediaIdx===n[0][n[1]].mediaIdx?n[16]:void 0)&&(n[82].mediaIdx===n[0][n[1]].mediaIdx?n[16]:void 0).apply(this,arguments)}),z(e,"transitionend",function(){Ze(n[84]===n[1]?n[16]:void 0)&&(n[84]===n[1]?n[16]:void 0).apply(this,arguments)})],_=!0)},p(d,h){n=d,h[0]&32803&&(I=he(n[82].media),ee(),s=Je(s,h,L,1,n,I,r,l,qt,It,null,kt),te()),(!u||h[0]&512&&a!==(a="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[9]?"duration-0 transition-duration-0":"")))&&m(l,"class",a),(!u||h[0]&6145)&&Q(l,"transform","translateX("+(-n[82].mediaIdx*n[12].width+n[11])+"px)"),n[5]?b&&(ee(),O(b,1,1,()=>{b=null}),te()):b?(b.p(n,h),h[0]&32&&y(b,1)):(b=Et(n),b.c(),y(b,1),b.m(e,i)),(!u||h[0]&512&&o!==(o=`w-full h-full absolute content-center transition-transform
            ${n[9]?"duration-0 transition-duration-0":""}`))&&m(e,"class",o),(!u||h[0]&5123)&&Q(e,"transform","translateY("+((n[84]-n[1])*n[12].height+n[10])+"px)")},i(d){if(!u){for(let h=0;h<I.length;h+=1)y(s[h]);y(b),u=!0}},o(d){for(let h=0;h<s.length;h+=1)O(s[h]);O(b),u=!1},d(d){d&&p(e);for(let h=0;h<s.length;h+=1)s[h].d();b&&b.d(),_=!1,we(g)}}}function It(n,e){let t,l,s,r,a,f;return s=new Yl({props:{src:e[88],isEdit:e[5],post:e[0][e[1]],muted:e[15],autoplay:e[1]===e[84]&&e[0][e[1]].mediaIdx===e[90],isRightOrder:e[1]===e[84]}}),{key:n,first:null,c(){t=D("div"),l=D("div"),H(s.$$.fragment),a=q(),this.h()},l(i){t=M(i,"DIV",{class:!0});var o=R(t);l=M(o,"DIV",{class:!0});var u=R(l);Z(s.$$.fragment,u),u.forEach(p),a=j(o),o.forEach(p),this.h()},h(){m(l,"class",r=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `),m(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(i,o){S(i,t,o),k(t,l),G(s,l,null),k(t,a),f=!0},p(i,o){e=i;const u={};o[0]&1&&(u.src=e[88]),o[0]&32&&(u.isEdit=e[5]),o[0]&3&&(u.post=e[0][e[1]]),o[0]&32768&&(u.muted=e[15]),o[0]&3&&(u.autoplay=e[1]===e[84]&&e[0][e[1]].mediaIdx===e[90]),o[0]&3&&(u.isRightOrder=e[1]===e[84]),s.$set(u),(!f||o[0]&32&&r!==(r=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `))&&m(l,"class",r)},i(i){f||(y(s.$$.fragment,i),f=!0)},o(i){O(s.$$.fragment,i),f=!1},d(i){i&&p(t),W(s)}}}function Et(n){var U;let e,t,l,s,r,a,f,i,o,u,_,g,I,L,b=n[82].media.length>1&&yt(n),d=((U=n[82].reactions)==null?void 0:U.length)>0&&!n[6]&&Tt(n);function h(P){n[28](P,n[82],n[83],n[84])}let v={allowFollow:!Ue,whenCancelFollow:n[27]};n[82]!==void 0&&(v.post=n[82]),r=new Ql({props:v}),Me.push(()=>Re(r,"post",h));function T(...P){return n[29](n[82],n[83],n[84],...P)}i=new mn({props:{post:n[82]}}),i.$on("textExpanded",T),u=new sn({props:{place:{idx:n[82].place_idx,name:n[82].place_name}}});let E=!n[6]&&Mt(n),x=n[1]===n[84]&&Bt(n);return{c(){b&&b.c(),e=q(),t=D("div"),l=D("div"),d&&d.c(),s=q(),H(r.$$.fragment),f=q(),H(i.$$.fragment),o=q(),H(u.$$.fragment),_=q(),E&&E.c(),g=q(),x&&x.c(),I=ie(),this.h()},l(P){b&&b.l(P),e=j(P),t=M(P,"DIV",{class:!0});var C=R(t);l=M(C,"DIV",{class:!0});var A=R(l);d&&d.l(A),s=j(A),Z(r.$$.fragment,A),f=j(A),Z(i.$$.fragment,A),o=j(A),Z(u.$$.fragment,A),A.forEach(p),_=j(C),E&&E.l(C),C.forEach(p),g=j(P),x&&x.l(P),I=ie(),this.h()},h(){m(l,"class","flex-grow text-white text-md flex flex-col items-start gap-2 transition-transform text-base "),m(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(P,C){b&&b.m(P,C),S(P,e,C),S(P,t,C),k(t,l),d&&d.m(l,null),k(l,s),G(r,l,null),k(l,f),G(i,l,null),k(l,o),G(u,l,null),k(t,_),E&&E.m(t,null),S(P,g,C),x&&x.m(P,C),S(P,I,C),L=!0},p(P,C){var ae;n=P,n[82].media.length>1?b?(b.p(n,C),C[0]&1&&y(b,1)):(b=yt(n),b.c(),y(b,1),b.m(e.parentNode,e)):b&&(ee(),O(b,1,1,()=>{b=null}),te()),((ae=n[82].reactions)==null?void 0:ae.length)>0&&!n[6]?d?(d.p(n,C),C[0]&65&&y(d,1)):(d=Tt(n),d.c(),y(d,1),d.m(l,s)):d&&(ee(),O(d,1,1,()=>{d=null}),te());const A={};C[0]&128&&(A.whenCancelFollow=n[27]),!a&&C[0]&1&&(a=!0,A.post=n[82],Oe(()=>a=!1)),r.$set(A);const K={};C[0]&1&&(K.post=n[82]),i.$set(K);const ne={};C[0]&1&&(ne.place={idx:n[82].place_idx,name:n[82].place_name}),u.$set(ne),n[6]?E&&(ee(),O(E,1,1,()=>{E=null}),te()):E?(E.p(n,C),C[0]&64&&y(E,1)):(E=Mt(n),E.c(),y(E,1),E.m(t,null)),n[1]===n[84]?x?(x.p(n,C),C[0]&3&&y(x,1)):(x=Bt(n),x.c(),y(x,1),x.m(I.parentNode,I)):x&&(ee(),O(x,1,1,()=>{x=null}),te())},i(P){L||(y(b),y(d),y(r.$$.fragment,P),y(i.$$.fragment,P),y(u.$$.fragment,P),y(E),y(x),L=!0)},o(P){O(b),O(d),O(r.$$.fragment,P),O(i.$$.fragment,P),O(u.$$.fragment,P),O(E),O(x),L=!1},d(P){P&&(p(e),p(t),p(g),p(I)),b&&b.d(P),d&&d.d(),W(r),W(i),W(u),E&&E.d(),x&&x.d(P)}}}function yt(n){let e,t;return e=new zt({props:{post:n[82]}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s[0]&1&&(r.post=l[82]),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Tt(n){let e,t,l=he(n[82].reactions),s=[];for(let a=0;a<l.length;a+=1)s[a]=Dt(wt(n,l,a));const r=a=>O(s[a],1,1,()=>{s[a]=null});return{c(){e=D("div");for(let a=0;a<s.length;a+=1)s[a].c();this.h()},l(a){e=M(a,"DIV",{class:!0});var f=R(e);for(let i=0;i<s.length;i+=1)s[i].l(f);f.forEach(p),this.h()},h(){m(e,"class","flex gap-1 justify-center items-center mb-1")},m(a,f){S(a,e,f);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);t=!0},p(a,f){if(f[0]&262145){l=he(a[82].reactions);let i;for(i=0;i<l.length;i+=1){const o=wt(a,l,i);s[i]?(s[i].p(o,f),y(s[i],1)):(s[i]=Dt(o),s[i].c(),y(s[i],1),s[i].m(e,null))}for(ee(),i=l.length;i<s.length;i+=1)r(i);te()}},i(a){if(!t){for(let f=0;f<l.length;f+=1)y(s[f]);t=!0}},o(a){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)O(s[f]);t=!1},d(a){a&&p(e),Ft(s,a)}}}function Dt(n){let e,t;function l(){return n[26](n[82],n[85])}return e=new Ut({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:n[85].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:n[85].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",l),{c(){H(e.$$.fragment)},l(s){Z(e.$$.fragment,s)},m(s,r){G(e,s,r),t=!0},p(s,r){n=s;const a={};r[0]&1&&(a.prefix=n[85].type),r[0]&1&&(a.value=n[85].count),e.$set(a)},i(s){t||(y(e.$$.fragment,s),t=!0)},o(s){O(e.$$.fragment,s),t=!1},d(s){W(e,s)}}}function Mt(n){var P;let e,t,l,s,r,a,f,i,o=((P=n[82].reactions)!=null&&P.length?n[82].reactions.reduce(n[35],0):0)+"",u,_,g,I,L,b,d,h=n[82].onReactionShowcase&&Vt(n);const v=[Vn,Mn],T=[];function E(C,A){return C[82].myReaction?0:1}r=E(n),a=T[r]=v[r](n);function x(){return n[36](n[82])}function U(){return n[37](n[82],n[83],n[84])}return I=new ql({props:{fill:"white",length:1.5}}),{c(){e=D("div"),t=D("div"),h&&h.c(),l=q(),s=D("button"),a.c(),f=q(),i=D("span"),u=be(o),_=q(),g=D("button"),H(I.$$.fragment),this.h()},l(C){e=M(C,"DIV",{class:!0});var A=R(e);t=M(A,"DIV",{class:!0});var K=R(t);h&&h.l(K),l=j(K),s=M(K,"BUTTON",{class:!0});var ne=R(s);a.l(ne),f=j(ne),i=M(ne,"SPAN",{class:!0});var ae=R(i);u=ve(ae,o),ae.forEach(p),ne.forEach(p),K.forEach(p),_=j(A),g=M(A,"BUTTON",{});var me=R(g);Z(I.$$.fragment,me),me.forEach(p),A.forEach(p),this.h()},h(){m(i,"class","text-xs text-white h-4"),m(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),m(t,"class","flex gap-4 relative"),m(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(C,A){S(C,e,A),k(e,t),h&&h.m(t,null),k(t,l),k(t,s),T[r].m(s,null),k(s,f),k(s,i),k(i,u),k(e,_),k(e,g),G(I,g,null),L=!0,b||(d=[z(s,"click",x),Ae(Ye.call(null,s)),Ae(Fl.call(null,s,500)),z(s,"longpress",U),z(g,"click",n[38])],b=!0)},p(C,A){var ne;n=C,n[82].onReactionShowcase?h?h.p(n,A):(h=Vt(n),h.c(),h.m(t,l)):h&&(h.d(1),h=null);let K=r;r=E(n),r!==K&&(ee(),O(T[K],1,1,()=>{T[K]=null}),te(),a=T[r],a||(a=T[r]=v[r](n),a.c()),y(a,1),a.m(s,f)),(!L||A[0]&1)&&o!==(o=((ne=n[82].reactions)!=null&&ne.length?n[82].reactions.reduce(n[35],0):0)+"")&&Ne(u,o)},i(C){L||(y(a),y(I.$$.fragment,C),L=!0)},o(C){O(a),O(I.$$.fragment,C),L=!1},d(C){C&&p(e),h&&h.d(),T[r].d(),W(I),b=!1,we(d)}}}function Vt(n){let e,t,l="👍",s,r,a="🔥",f,i,o="😍",u,_,g="😋",I,L,b="😊️️",d,h;function v(){return n[30](n[82])}function T(){return n[31](n[82])}function E(){return n[32](n[82])}function x(){return n[33](n[82])}function U(){return n[34](n[82])}return{c(){e=D("div"),t=D("button"),t.textContent=l,s=q(),r=D("button"),r.textContent=a,f=q(),i=D("button"),i.textContent=o,u=q(),_=D("button"),_.textContent=g,I=q(),L=D("button"),L.textContent=b,this.h()},l(P){e=M(P,"DIV",{class:!0});var C=R(e);t=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-3oecln"&&(t.textContent=l),s=j(C),r=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-131qbu2"&&(r.textContent=a),f=j(C),i=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-lq90i3"&&(i.textContent=o),u=j(C),_=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),$(_)!=="svelte-l73y87"&&(_.textContent=g),I=j(C),L=M(C,"BUTTON",{class:!0,"data-svelte-h":!0}),$(L)!=="svelte-11szxsj"&&(L.textContent=b),C.forEach(p),this.h()},h(){m(t,"class","text-2xl/[26px]"),m(r,"class","text-2xl/[26px]"),m(i,"class","text-2xl/[26px]"),m(_,"class","text-2xl/[26px]"),m(L,"class","text-2xl/[26px]"),m(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(P,C){S(P,e,C),k(e,t),k(e,s),k(e,r),k(e,f),k(e,i),k(e,u),k(e,_),k(e,I),k(e,L),d||(h=[z(t,"click",v),z(r,"click",T),z(i,"click",E),z(_,"click",x),z(L,"click",U)],d=!0)},p(P,C){n=P},d(P){P&&p(e),d=!1,we(h)}}}function Mn(n){let e,t;return e=new Nl({props:{fill:"white",length:1.5}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Vn(n){let e,t;return e=new Sl({props:{fill:"#EA3323",length:1.5}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Bt(n){let e,t;return e=new vn({props:{isTextExpanded:n[82].isTextExpanded}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s[0]&1&&(r.isTextExpanded=l[82].isTextExpanded),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Pt(n,e){let t,l=Math.abs(e[1]-e[84])<=5,s,r,a=l&&xt(e);return{key:n,first:null,c(){t=ie(),a&&a.c(),s=ie(),this.h()},l(f){t=ie(),a&&a.l(f),s=ie(),this.h()},h(){this.first=t},m(f,i){S(f,t,i),a&&a.m(f,i),S(f,s,i),r=!0},p(f,i){e=f,i[0]&3&&(l=Math.abs(e[1]-e[84])<=5),l?a?(a.p(e,i),i[0]&3&&y(a,1)):(a=xt(e),a.c(),y(a,1),a.m(s.parentNode,s)):a&&(ee(),O(a,1,1,()=>{a=null}),te())},i(f){r||(y(a),r=!0)},o(f){O(a),r=!1},d(f){f&&(p(t),p(s)),a&&a.d(f)}}}function Ot(n){let e,t;return e=new zt({props:{post:n[0][n[1]],fixed:!1}}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const r={};s[0]&3&&(r.post=l[0][l[1]]),e.$set(r)},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Rt(n){let e,t;return e=new Al({}),{c(){H(e.$$.fragment)},l(l){Z(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(y(e.$$.fragment,l),t=!0)},o(l){O(e.$$.fragment,l),t=!1},d(l){W(e,l)}}}function Lt(n){let e,t,l,s,r="수정",a,f,i,o,u,_="삭제",g,I,L;return t=new on({props:{fill:"white",length:1.5}}),i=new cn({props:{fill:"white",length:1.5}}),{c(){e=D("button"),H(t.$$.fragment),l=q(),s=D("span"),s.textContent=r,a=q(),f=D("button"),H(i.$$.fragment),o=q(),u=D("span"),u.textContent=_,this.h()},l(b){e=M(b,"BUTTON",{class:!0});var d=R(e);Z(t.$$.fragment,d),l=j(d),s=M(d,"SPAN",{"data-svelte-h":!0}),$(s)!=="svelte-17aljrl"&&(s.textContent=r),d.forEach(p),a=j(b),f=M(b,"BUTTON",{class:!0});var h=R(f);Z(i.$$.fragment,h),o=j(h),u=M(h,"SPAN",{"data-svelte-h":!0}),$(u)!=="svelte-1k1dgz"&&(u.textContent=_),h.forEach(p),this.h()},h(){m(e,"class","flex items-center gap-2 text-white text-sm"),m(f,"class","flex items-center gap-2 text-white text-sm")},m(b,d){S(b,e,d),G(t,e,null),k(e,l),k(e,s),S(b,a,d),S(b,f,d),G(i,f,null),k(f,o),k(f,u),g=!0,I||(L=[z(e,"click",n[40]),z(f,"click",n[41])],I=!0)},p:J,i(b){g||(y(t.$$.fragment,b),y(i.$$.fragment,b),g=!0)},o(b){O(t.$$.fragment,b),O(i.$$.fragment,b),g=!1},d(b){b&&(p(e),p(a),p(f)),W(t),W(i),I=!1,we(L)}}}function At(n){let e,t,l,s,r,a;return t=new tn({}),{c(){e=D("button"),H(t.$$.fragment),l=be(`
        신고`),this.h()},l(f){e=M(f,"BUTTON",{class:!0});var i=R(e);Z(t.$$.fragment,i),l=ve(i,`
        신고`),i.forEach(p),this.h()},h(){m(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(f,i){S(f,e,i),G(t,e,null),k(e,l),s=!0,r||(a=z(e,"click",n[43]),r=!0)},p:J,i(f){s||(y(t.$$.fragment,f),s=!0)},o(f){O(t.$$.fragment,f),s=!1},d(f){f&&p(e),W(t),r=!1,a()}}}function Bn(n){let e,t,l,s,r,a,f,i,o,u=n[14]&&Lt(n);s=new Zl({props:{length:1.5,fill:"white"}});let _=!n[14]&&At(n);return{c(){e=D("div"),u&&u.c(),t=q(),l=D("button"),H(s.$$.fragment),r=be(`
      링크 복사`),a=q(),_&&_.c(),this.h()},l(g){e=M(g,"DIV",{id:!0,class:!0});var I=R(e);u&&u.l(I),t=j(I),l=M(I,"BUTTON",{class:!0});var L=R(l);Z(s.$$.fragment,L),r=ve(L,`
      링크 복사`),L.forEach(p),a=j(I),_&&_.l(I),I.forEach(p),this.h()},h(){m(l,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),m(e,"id","test"),m(e,"class","flex flex-col px-5 gap-3")},m(g,I){S(g,e,I),u&&u.m(e,null),k(e,t),k(e,l),G(s,l,null),k(l,r),k(e,a),_&&_.m(e,null),f=!0,i||(o=[z(l,"click",n[42]),Ae(Ye.call(null,e))],i=!0)},p(g,I){g[14]?u?(u.p(g,I),I[0]&16384&&y(u,1)):(u=Lt(g),u.c(),y(u,1),u.m(e,t)):u&&(ee(),O(u,1,1,()=>{u=null}),te()),g[14]?_&&(ee(),O(_,1,1,()=>{_=null}),te()):_?(_.p(g,I),I[0]&16384&&y(_,1)):(_=At(g),_.c(),y(_,1),_.m(e,null))},i(g){f||(y(u),y(s.$$.fragment,g),y(_),f=!0)},o(g){O(u),O(s.$$.fragment,g),O(_),f=!1},d(g){g&&p(e),u&&u.d(),W(s),_&&_.d(),i=!1,we(o)}}}function Pn(n){let e,t,l="정말로 삭제하시겠습니까?",s,r,a="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",f,i,o,u="삭제",_,g,I="취소",L,b;return{c(){e=D("div"),t=D("h2"),t.textContent=l,s=q(),r=D("p"),r.textContent=a,f=q(),i=D("div"),o=D("button"),o.textContent=u,_=q(),g=D("button"),g.textContent=I,this.h()},l(d){e=M(d,"DIV",{class:!0});var h=R(e);t=M(h,"H2",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-1yzhdkj"&&(t.textContent=l),s=j(h),r=M(h,"P",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-26p028"&&(r.textContent=a),f=j(h),i=M(h,"DIV",{class:!0});var v=R(i);o=M(v,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-1q4epan"&&(o.textContent=u),_=j(v),g=M(v,"BUTTON",{class:!0,"data-svelte-h":!0}),$(g)!=="svelte-1rzg9yy"&&(g.textContent=I),v.forEach(p),h.forEach(p),this.h()},h(){m(t,"class","text-lg font-semibold mb-2"),m(r,"class","text-gray-600 mb-4"),m(o,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),m(g,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),m(i,"class","flex justify-center space-x-4"),m(e,"class","text-center")},m(d,h){S(d,e,h),k(e,t),k(e,s),k(e,r),k(e,f),k(e,i),k(i,o),k(i,_),k(i,g),L||(b=[z(o,"click",n[48]),z(g,"click",n[49])],L=!0)},p:J,d(d){d&&p(e),L=!1,we(b)}}}function On(n){var ce;let e,t,l,s=[],r=new Map,a,f,i,o,u,_,g,I,L,b,d,h,v,T,E,x=!n[5]&&Ct(n),U=he(n[0]);const P=w=>w[82].idx;for(let w=0;w<U.length;w+=1){let V=vt(n,U,w),Y=P(V);r.set(Y,s[w]=Pt(Y,V))}let C=n[5]&&((ce=n[0][n[1]])==null?void 0:ce.media.length)>1&&Ot(n),A=!n[5]&&Rt();function K(w){n[44](w)}let ne={fixed:!0,noHandle:!0,$$slots:{default:[Bn]},$$scope:{ctx:n}};n[2]!==void 0&&(ne.isOpen=n[2]),u=new Xt({props:ne}),Me.push(()=>Re(u,"isOpen",K));function ae(w){n[45](w)}let me={targetTable:"posts",targetIdx:n[0][n[1]].idx};n[3]!==void 0&&(me.isOpen=n[3]),I=new En({props:me}),Me.push(()=>Re(I,"isOpen",ae)),I.$on("reported",n[46]),d=new Dn({props:{isVisible:n[0][n[1]].permission_signer==="reported",targetTable:"posts",targetIdx:n[0][n[1]].idx}}),d.$on("unreported",n[47]);function ke(w){n[50](w)}let _e={$$slots:{default:[Pn]},$$scope:{ctx:n}};return n[4]!==void 0&&(_e.modalVisible=n[4]),v=new jl({props:_e}),Me.push(()=>Re(v,"modalVisible",ke)),{c(){x&&x.c(),e=q(),t=D("div"),l=D("div");for(let w=0;w<s.length;w+=1)s[w].c();a=q(),C&&C.c(),f=q(),A&&A.c(),o=q(),H(u.$$.fragment),g=q(),H(I.$$.fragment),b=q(),H(d.$$.fragment),h=q(),H(v.$$.fragment),this.h()},l(w){x&&x.l(w),e=j(w),t=M(w,"DIV",{class:!0});var V=R(t);l=M(V,"DIV",{class:!0});var Y=R(l);for(let le=0;le<s.length;le+=1)s[le].l(Y);Y.forEach(p),a=j(V),C&&C.l(V),f=j(V),A&&A.l(V),V.forEach(p),o=j(w),Z(u.$$.fragment,w),g=j(w),Z(I.$$.fragment,w),b=j(w),Z(d.$$.fragment,w),h=j(w),Z(v.$$.fragment,w),this.h()},h(){m(l,"class","flex flex-grow relative w-full h-full bg-black"),m(t,"class",i="viewer bg-black select-none flex flex-col "+(n[5]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh"))},m(w,V){x&&x.m(w,V),S(w,e,V),S(w,t,V),k(t,l);for(let Y=0;Y<s.length;Y+=1)s[Y]&&s[Y].m(l,null);k(t,a),C&&C.m(t,null),k(t,f),A&&A.m(t,null),n[39](t),S(w,o,V),G(u,w,V),S(w,g,V),G(I,w,V),S(w,b,V),G(d,w,V),S(w,h,V),G(v,w,V),E=!0},p(w,V){var Se;w[5]?x&&(x.d(1),x=null):x||(x=Ct(w),x.c(),x.m(e.parentNode,e)),V[0]&368359&&(U=he(w[0]),ee(),s=Je(s,V,P,1,w,U,r,l,qt,Pt,null,vt),te()),w[5]&&((Se=w[0][w[1]])==null?void 0:Se.media.length)>1?C?(C.p(w,V),V[0]&35&&y(C,1)):(C=Ot(w),C.c(),y(C,1),C.m(t,f)):C&&(ee(),O(C,1,1,()=>{C=null}),te()),w[5]?A&&(ee(),O(A,1,1,()=>{A=null}),te()):A?V[0]&32&&y(A,1):(A=Rt(),A.c(),y(A,1),A.m(t,null)),(!E||V[0]&32&&i!==(i="viewer bg-black select-none flex flex-col "+(w[5]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh")))&&m(t,"class",i);const Y={};V[0]&16668|V[2]&536870912&&(Y.$$scope={dirty:V,ctx:w}),!_&&V[0]&4&&(_=!0,Y.isOpen=w[2],Oe(()=>_=!1)),u.$set(Y);const le={};V[0]&3&&(le.targetIdx=w[0][w[1]].idx),!L&&V[0]&8&&(L=!0,le.isOpen=w[3],Oe(()=>L=!1)),I.$set(le);const re={};V[0]&3&&(re.isVisible=w[0][w[1]].permission_signer==="reported"),V[0]&3&&(re.targetIdx=w[0][w[1]].idx),d.$set(re);const Be={};V[0]&16|V[2]&536870912&&(Be.$$scope={dirty:V,ctx:w}),!T&&V[0]&16&&(T=!0,Be.modalVisible=w[4],Oe(()=>T=!1)),v.$set(Be)},i(w){if(!E){for(let V=0;V<U.length;V+=1)y(s[V]);y(C),y(A),y(u.$$.fragment,w),y(I.$$.fragment,w),y(d.$$.fragment,w),y(v.$$.fragment,w),E=!0}},o(w){for(let V=0;V<s.length;V+=1)O(s[V]);O(C),O(A),O(u.$$.fragment,w),O(I.$$.fragment,w),O(d.$$.fragment,w),O(v.$$.fragment,w),E=!1},d(w){w&&(p(e),p(t),p(o),p(g),p(b),p(h)),x&&x.d(w);for(let V=0;V<s.length;V+=1)s[V].d();C&&C.d(),A&&A.d(),n[39](null),W(u,w),W(I,w),W(d,w),W(v,w)}}}const Rn=30,Ln=10,Nt=150;function Pe(n){return"touches"in n||"changedTouches"in n}function An(n){return Pe(n)?[n.touches[0].clientX,n.touches[0].clientY]:[n.clientX,n.clientY]}function Nn(n,e,t){let l,s,r,a;it(n,rt,c=>t(15,r=c)),it(n,Ml,c=>t(8,a=c));const f=Rl.isNativePlatform();let{posts:i=[]}=e,{index:o=0}=e,{type:u=a.url.searchParams.get("type")}=e,{isEdit:_=!1}=e,{dontMoveVertically:g=!1}=e,{selectedReaction:I=void 0}=e,{hideActionButtons:L=!1}=e,{whenCancelForExternalLink:b=()=>{}}=e,d=!0,h=!1,v=!1,T=0,E=0,x={width:0,height:0},U=!1,P=!1,{actionSheetMoreIsOpen:C=!1}=e,{actionSheetReportIsOpen:A=!1}=e,{modalVisible:K=!1}=e;function ne(c){if(!c)return!1;const B=Ve();return B!==null&&String(B)===c}let ae=!1,me=!1,ke=-1,_e=-1,ce,w=!1,V=[],Y=[],le;async function re(){Vl({mediaIdx:`${i[o].mediaIdx||0}`,postIdx:`${i[o].idx}`},{replace:!0})}async function Be(){t(22,ae=!0);const c=i.length,B=a.url.searchParams.get("userIdx"),N=a.url.searchParams.get("placeIdx"),F=`&offset=${c}`,X=`&limit=${Rn}`,se=B?`&userIdx=${B}`:"",Te=N?`&placeIdx=${N}`:"",de=(await fetch(`${Le}/posts?${se}${Te}${F}${X}`).then(Ce=>Ce.json()).then(Ce=>{var nt;return((nt=Ce.data)==null?void 0:nt.posts)??[]})).map(Ce=>({...Ce,mediaIdx:0}));de.length===0&&t(23,me=!0),t(0,i=[...i,...de]),t(22,ae=!1)}function Se(c){const{height:B}=x;if(o===0&&c>0||o===i.length-1&&c<0){t(10,T=c*.3);return}t(10,T=Math.max(Math.min(c,B),-B))}function Yt(c){t(9,d=!1);const B=Ee(2),N=Pe(c)?c.changedTouches[0].clientY-_e:c.clientY-_e;N>B&&o>0?(t(1,o-=1),h=!0,re()):-N>B&&o<i.length-1&&(t(1,o+=1),h=!0,re()),t(10,T=0)}function Ht(c){const{width:B}=x,N=i[o].mediaIdx,F=i[o].media.length-1;if(N===0&&c>0||N===F&&c<0){t(11,E=c*.3);return}t(11,E=Math.max(Math.min(c,B),-B))}function Zt(c){t(9,d=!1);const B=Ee(2),N=Pe(c)?c.changedTouches[0].clientX-ke:c.clientX-ke,F=i[o].mediaIdx,X=i[o].media.length-1;N>B&&F>0?ye(F-1):-N>B&&F<X&&ye(F+1),t(11,E=0)}function ye(c){t(0,i[o]={...i[o],mediaIdx:c},i),t(0,i=[...i]),v=!0,re()}function Fe(c){h||v||(w=!0,ce=void 0,Pe(c)?(ke=c.touches[0].clientX,_e=c.touches[0].clientY):(ke=c.clientX,_e=c.clientY,window.addEventListener("mousemove",qe,{passive:!1}),window.addEventListener("mouseup",je)))}function qe(c){if(!w||h||v)return;const[B,N]=An(c),F=B-ke,X=N-_e;ce===void 0&&(ce=Math.abs(X)>=Math.abs(F)?"post":"media"),!g&&ce==="post"?Se(X):ce==="media"&&Ht(F)}function je(c){!w||h||v||(w=!1,ce==="post"?Yt(c):ce==="media"&&Zt(c),Pe(c)||(window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",je)))}function Ke(c){if(h||v)return;c.preventDefault();const B=Date.now(),N=Math.abs(c.deltaX),F=Math.abs(c.deltaY);if(N>F){if(Y.push({deltaX:c.deltaX,timestamp:B}),Y=Y.filter(X=>B-X.timestamp<=Nt),Y.length>=2){const X=Y[0],se=Y[Y.length-1];if(Math.abs(se.deltaX)-Math.abs(X.deltaX)>=0&&Math.abs(se.deltaX)>=30){const de=i[o].mediaIdx,Ce=i[o].media.length-1;se.deltaX>0&&de<Ce?ye(de+1):se.deltaX<0&&de>0&&ye(de-1),Y=[],v=!0}}}else if(V.push({deltaY:c.deltaY,timestamp:B}),V=V.filter(X=>B-X.timestamp<=Nt),V.length>=2){const X=V[0],se=V[V.length-1];Math.abs(se.deltaY)-Math.abs(X.deltaY)>=0&&Math.abs(se.deltaY)>=30&&(se.deltaY>0&&o<i.length-1?(t(9,d=!1),t(1,o+=1),re(),h=!0):se.deltaY<0&&o>0&&(t(9,d=!1),t(1,o-=1),re(),h=!0),V=[])}}function Qe(c){if(h||v)return;const B=i[o].mediaIdx,N=i[o].media.length-1;switch(c.key){case"ArrowUp":o>0&&(t(9,d=!1),t(1,o--,o),h=!0,re());break;case"ArrowDown":o<i.length-1&&(t(9,d=!1),t(1,o++,o),h=!0,re());break;case"ArrowLeft":B>0&&(t(9,d=!1),v=!0,ye(B-1));break;case"ArrowRight":B<N&&(t(9,d=!1),v=!0,ye(B+1));break}}function Gt(){t(9,d=!0),h=!1,v=!1}function $e(){le&&t(12,x={width:le.clientWidth,height:le.clientHeight})}function Wt(){var N,F;const c=Number(a.url.searchParams.get("mediaIdx")||0),B=((F=(N=i.at(o))==null?void 0:N.media)==null?void 0:F.length)||0;c&&c<B?t(0,i[o]={...i[o],mediaIdx:c},i):t(0,i[o]={...i[o],mediaIdx:0},i),t(0,i=[...i]),re()}function Jt(){document.addEventListener("touchstart",Fe,{passive:!1}),document.addEventListener("touchmove",qe,{passive:!1}),document.addEventListener("touchend",je),document.addEventListener("mousedown",Fe,{passive:!1}),document.addEventListener("wheel",Ke,{passive:!1}),document.addEventListener("keydown",Qe)}function Kt(){document.removeEventListener("touchstart",Fe),document.removeEventListener("touchmove",qe),document.removeEventListener("touchend",je),document.removeEventListener("mousedown",Fe),document.removeEventListener("wheel",Ke),document.removeEventListener("keydown",Qe)}Il(()=>{El(rt,r=!0,r),$e();const c=new ResizeObserver(()=>$e());return le&&c.observe(le),Jt(),Wt(),()=>{c.disconnect()}}),St(()=>{Kt()});function et(){var F;if(P)return;P=!0;const c=ze(),B=Ve(),N=(F=i[o])==null?void 0:F.idx;if(!c||!B||!N)return P=!1;fetch(`${Le}/posts/${N}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${c}`}}).then(X=>X.json()).then(()=>Ge(`/users/${B}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{P=!1})}async function tt(c){var X,se,Te;const B=(X=i[c])==null?void 0:X.idx;if(B===void 0||_||((se=i[c])==null?void 0:se.needReactionReload)!==!0&&((Te=i[c])!=null&&Te.reactions))return;const N=ze(),F=await fetch(`${Le}/vote/reactions?targetTable=posts&targetId=${B}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+N}});if(F.ok){const de=await F.json();t(0,i[c].reactions=de.data.reactions,i),t(0,i[c].myReaction=de.data.myReaction,i)}}function pe(c,B){if(Ue)return b();if(U)return;U=!0;const N=o,F=i[N];if((F==null?void 0:F.idx)!==c)return U=!1;if(!at())return F.needReactionReload=!0,U=!1,ge.emit("showSignInModal",{removable:!0,callback:f?()=>{tt(N)}:void 0});F.myReaction===B?ge.emit("setReaction",{target:"posts",targetId:c,reaction:null,callback:()=>{t(0,i[N].myReaction=null,i),lt(N,B),U=!1}}):(F.myReaction&&lt(N,F.myReaction),ge.emit("setReaction",{target:"posts",targetId:c,reaction:B,callback:()=>{t(0,i[N].myReaction=B,i),i[N].reactions.some(X=>X.type===B)?t(0,i[N].reactions=i[N].reactions.map(X=>X.type===B?{...X,count:Number(X.count)+1}:X),i):t(0,i[N].reactions=[...i[N].reactions,{type:B,count:1}],i),U=!1}}))}function lt(c,B){let N=[];for(const F of i[c].reactions)if(F.type===B){const X=Number(F.count);X>1&&N.push({...F,count:X-1})}else N.push(F);t(0,i[c].reactions=N,i)}function Qt(c){Tl.call(this,n,c)}const $t=(c,B)=>{pe(c.idx,B.type)},el=()=>{if(Ue)return b()};function tl(c,B,N,F){N[F]=c,t(0,i)}const ll=(c,B,N,F)=>{t(0,B[N].isTextExpanded=F.detail.expanded,i)},nl=c=>{pe(c.idx,"👍")},sl=c=>{pe(c.idx,"️🔥")},il=c=>{pe(c.idx,"😍")},rl=c=>{pe(c.idx,"😋")},al=c=>{pe(c.idx,"😊️️")},ol=(c,B)=>c+Number(B.count),fl=c=>{pe(c.idx,c.myReaction||"❤️")},ul=(c,B,N)=>{t(0,B[N].onReactionShowcase=!0,i);const F=()=>{t(0,B[N].onReactionShowcase=!1,i),window.removeEventListener("click",F)};setTimeout(()=>{window.addEventListener("click",F)},500)},cl=()=>{if(Ue)return b();if(!at())return ge.emit("showSignInModal",{removable:!0});t(2,C=!0)};function dl(c){Me[c?"unshift":"push"](()=>{le=c,t(13,le)})}const hl=()=>{var c;t(2,C=!1),Ge(`/viewer/edit?type=patch&postIdx=${(c=window.location.search.split("postIdx=")[1])==null?void 0:c.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},ml=()=>{t(2,C=!1),t(4,K=!0)},pl=()=>{Hl(a.url),isOpenActionSheet=!1},_l=()=>{t(2,C=!1),t(3,A=!0)};function gl(c){C=c,t(2,C)}function bl(c){A=c,t(3,A)}const vl=()=>{t(0,i[o].permission_signer="reported",i)},wl=()=>{t(0,i[o].permission_signer=null,i)},kl=()=>{et(),t(4,K=!1)},Cl=()=>{t(4,K=!1)};function xl(c){K=c,t(4,K)}return n.$$set=c=>{"posts"in c&&t(0,i=c.posts),"index"in c&&t(1,o=c.index),"type"in c&&t(19,u=c.type),"isEdit"in c&&t(5,_=c.isEdit),"dontMoveVertically"in c&&t(20,g=c.dontMoveVertically),"selectedReaction"in c&&t(21,I=c.selectedReaction),"hideActionButtons"in c&&t(6,L=c.hideActionButtons),"whenCancelForExternalLink"in c&&t(7,b=c.whenCancelForExternalLink),"actionSheetMoreIsOpen"in c&&t(2,C=c.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in c&&t(3,A=c.actionSheetReportIsOpen),"modalVisible"in c&&t(4,K=c.modalVisible)},n.$$.update=()=>{var c;n.$$.dirty[0]&256&&a&&re(),n.$$.dirty[0]&2097152&&I&&pe(I.postIdx,I.reaction),n.$$.dirty[0]&2&&tt(o),n.$$.dirty[0]&3&&t(24,l=(c=i[o])==null?void 0:c.user_idx),n.$$.dirty[0]&16777216&&t(14,s=ne(l)),n.$$.dirty[0]&13631491&&!g&&o>=i.length-Ln&&!ae&&!me&&Be()},[i,o,C,A,K,_,L,b,a,d,T,E,x,le,s,r,Gt,et,pe,u,g,I,ae,me,l,Qt,$t,el,tl,ll,nl,sl,il,rl,al,ol,fl,ul,cl,dl,hl,ml,pl,_l,gl,bl,vl,wl,kl,Cl,xl]}class ms extends fe{constructor(e){super(),ue(this,e,Nn,On,oe,{posts:0,index:1,type:19,isEdit:5,dontMoveVertically:20,selectedReaction:21,hideActionButtons:6,whenCancelForExternalLink:7,actionSheetMoreIsOpen:2,actionSheetReportIsOpen:3,modalVisible:4},null,[-1,-1,-1])}}export{ms as V};
