import{s as ue,D as te,i as A,f as _,w as Lt,e as T,a as N,t as Te,c as D,b as B,g as j,d as De,v as c,h as v,A as X,j as Ye,B as $,T as Fe,q as ge,r as pe,n as K,ad as Xe,x as Rt,E as Ae,F as Ie,C as se,L as He,y as Be,z as Le,G as St,O as tt,k as bn,I as vn,K as wn}from"./scheduler.gYVQAJGq.js";import{S as ce,i as de,t as E,g as ne,a as P,f as le,c as Z,b as G,m as W,d as J,e as Re}from"./index.yooFAgSx.js";import{e as ve,u as Ze,a as kn,o as At}from"./each.BCRE3uX-.js";import{b as Pe,e as xe,A as Se,l as Nt,g as qe,i as nt,C as Cn}from"./sign.531M-30-.js";import{g as ze}from"./entry.d3yJd-xW.js";import{p as xn}from"./stores.B4j_QPgb.js";import{g as lt,u as In}from"./searchParams.BxMOaDIo.js";/* empty css                                           *//* empty css                                                  */import{f as En,u as yn}from"./follow.BCBqA1e0.js";import{C as Tn}from"./CircleImage.CnVKi3zl.js";import{s as st}from"./s32cloudfront.VgmCer6K.js";import{r as ke}from"./units.BJZU6p1c.js";import"./index.BKkaL0Mp.js";import{a as Dn}from"./NavigationBar.CWlQC-jq.js";import{C as jt}from"./Chip.CW8oxaF-.js";import{B as Mn}from"./BottomNavigationPadder.DuXE6D6E.js";import{I as Vn,a as Bn}from"./IconHeartFill.DIaEPFSe.js";import{l as Pn}from"./longPress.C9F0mLoM.js";import{w as On,I as Ln}from"./Header.CVUfwOnt.js";import{A as Ht}from"./ActionSheet.BW1q_vfV.js";import{M as Rn}from"./Modal.06bdeLzj.js";import{f as Sn,c as An,b as Nn}from"./ActionSheetReport.svelte_svelte_type_style_lang.BVsARDPF.js";import{F as jn}from"./Figure.DgWx69nJ.js";import{I as Hn}from"./IconLink.BnnFoKKa.js";function it(l){let e,t,n,s,r,i=l[0].unique_name+"",a,o,f,d=String(l[0].user_idx)!==String(Pe()),b,w,y;t=new Tn({props:{src:st(l[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),t.$on("click",l[3]);let x=d&&rt(l);return{c(){e=T("div"),Z(t.$$.fragment),n=N(),s=T("div"),r=T("div"),a=Te(i),o=N(),f=T("div"),x&&x.c(),this.h()},l(m){e=D(m,"DIV",{class:!0});var p=B(e);G(t.$$.fragment,p),n=j(p),s=D(p,"DIV",{class:!0});var h=B(s);r=D(h,"DIV",{class:!0});var M=B(r);a=De(M,i),M.forEach(_),o=j(h),f=D(h,"DIV",{class:!0});var R=B(f);x&&x.l(R),R.forEach(_),h.forEach(_),p.forEach(_),this.h()},h(){c(r,"class","text-sm text-white"),c(f,"class","flex gap-1 items-center"),c(s,"class","flex gap-1 items-center"),c(e,"class","flex gap-[0.625rem] justify-center items-center")},m(m,p){A(m,e,p),W(t,e,null),v(e,n),v(e,s),v(s,r),v(r,a),v(s,o),v(s,f),x&&x.m(f,null),b=!0,w||(y=X(r,"click",l[4]),w=!0)},p(m,p){const h={};p&1&&(h.src=st(m[0].profile_image_url,500)),t.$set(h),(!b||p&1)&&i!==(i=m[0].unique_name+"")&&Ye(a,i),p&1&&(d=String(m[0].user_idx)!==String(Pe())),d?x?x.p(m,p):(x=rt(m),x.c(),x.m(f,null)):x&&(x.d(1),x=null)},i(m){b||(E(t.$$.fragment,m),b=!0)},o(m){P(t.$$.fragment,m),b=!1},d(m){m&&_(e),J(t),x&&x.d(),w=!1,y()}}}function rt(l){let e,t="•",n,s,r=l[0].is_following?"팔로잉":"팔로우",i,a,o,f;return{c(){e=T("div"),e.textContent=t,n=N(),s=T("div"),i=Te(r),this.h()},l(d){e=D(d,"DIV",{class:!0,"data-svelte-h":!0}),$(e)!=="svelte-168vif2"&&(e.textContent=t),n=j(d),s=D(d,"DIV",{class:!0});var b=B(s);i=De(b,r),b.forEach(_),this.h()},h(){c(e,"class","text-xs text-white/60"),c(s,"class",a=`text-[0.8125rem] ${l[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(d,b){A(d,e,b),A(d,n,b),A(d,s,b),v(s,i),o||(f=X(s,"click",function(){Fe(l[0].is_following?l[2]:l[1])&&(l[0].is_following?l[2]:l[1]).apply(this,arguments)}),o=!0)},p(d,b){l=d,b&1&&r!==(r=l[0].is_following?"팔로잉":"팔로우")&&Ye(i,r),b&1&&a!==(a=`text-[0.8125rem] ${l[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&c(s,"class",a)},d(d){d&&(_(e),_(n),_(s)),o=!1,f()}}}function qn(l){let e,t,n=l[0].idx&&it(l);return{c(){n&&n.c(),e=te()},l(s){n&&n.l(s),e=te()},m(s,r){n&&n.m(s,r),A(s,e,r),t=!0},p(s,[r]){s[0].idx?n?(n.p(s,r),r&1&&E(n,1)):(n=it(s),n.c(),E(n,1),n.m(e.parentNode,e)):n&&(ne(),P(n,1,1,()=>{n=null}),le())},i(s){t||(E(n),t=!0)},o(s){P(n),t=!1},d(s){s&&_(e),n&&n.d(s)}}}function Yn(l,e,t){let{post:n}=e;async function s(){await En({targetIdx:n.user_idx,subjectIdx:Pe()}),t(0,n.is_following=!0,n)}async function r(){await yn({targetIdx:n.user_idx,subjectIdx:Pe()}),t(0,n.is_following=!1,n)}Lt(()=>{console.log(n)});const i=()=>{lt(`/users/${n.user_idx}`)},a=()=>{lt(`/users/${n.user_idx}`)};return l.$$set=o=>{"post"in o&&t(0,n=o.post)},[n,s,r,i,a]}class Un extends ce{constructor(e){super(),de(this,e,Yn,qn,ue,{post:0})}}function Fn(l){let e,t,n,s;return{c(){e=ge("svg"),t=ge("path"),n=ge("path"),this.h()},l(r){e=pe(r,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var i=B(e);t=pe(i,"path",{d:!0,fill:!0}),B(t).forEach(_),n=pe(i,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),B(n).forEach(_),i.forEach(_),this.h()},h(){c(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),c(t,"fill",l[0]),c(n,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),c(n,"stroke",l[1]),c(n,"stroke-width","2"),c(n,"stroke-linejoin","round"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"width",l[2]),c(e,"height",l[2]),c(e,"viewBox",s="0 0 "+l[2]+" "+l[2]),c(e,"fill","none")},m(r,i){A(r,e,i),v(e,t),v(e,n)},p(r,[i]){i&1&&c(t,"fill",r[0]),i&2&&c(n,"stroke",r[1]),i&4&&c(e,"width",r[2]),i&4&&c(e,"height",r[2]),i&4&&s!==(s="0 0 "+r[2]+" "+r[2])&&c(e,"viewBox",s)},i:K,o:K,d(r){r&&_(e)}}}function zn(l,e,t){let n,{fill:s="#FF4F1E"}=e,{stroke:r="#FF4F1E"}=e,{length:i=1.5}=e;return l.$$set=a=>{"fill"in a&&t(0,s=a.fill),"stroke"in a&&t(1,r=a.stroke),"length"in a&&t(3,i=a.length)},l.$$.update=()=>{l.$$.dirty&8&&t(2,n=ke(i))},[s,r,n,i]}class Xn extends ce{constructor(e){super(),de(this,e,zn,Fn,ue,{fill:0,stroke:1,length:3})}}function Ue(l){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(n=>{const s=r=>r.stopPropagation();return l.addEventListener(n,s),{event:n,handler:s}});return{destroy(){t.forEach(({event:n,handler:s})=>{l.removeEventListener(n,s)})}}}function at(l){let e,t;return e=new jt({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Dn,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:l[0].name}}),e.$on("click",l[1]),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},p(n,s){const r={};s&1&&(r.value=n[0].name),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Zn(l){let e,t,n=l[0].idx&&at(l);return{c(){n&&n.c(),e=te()},l(s){n&&n.l(s),e=te()},m(s,r){n&&n.m(s,r),A(s,e,r),t=!0},p(s,[r]){s[0].idx?n?(n.p(s,r),r&1&&E(n,1)):(n=at(s),n.c(),E(n,1),n.m(e.parentNode,e)):n&&(ne(),P(n,1,1,()=>{n=null}),le())},i(s){t||(E(n),t=!0)},o(s){P(n),t=!1},d(s){s&&_(e),n&&n.d(s)}}}function Gn(l,e,t){let{place:n}=e;const s=async()=>{await ze(`/places/${n.idx}`)};return l.$$set=r=>{"place"in r&&t(0,n=r.place)},[n,s]}class Wn extends ce{constructor(e){super(),de(this,e,Gn,Zn,ue,{place:0})}}function Jn(l){let e,t;return{c(){e=ge("svg"),t=ge("path"),this.h()},l(n){e=pe(n,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0,stroke:!0});var s=B(e);t=pe(s,"path",{d:!0}),B(t).forEach(_),s.forEach(_),this.h()},h(){c(t,"d","M37.8592 6.49005C37.7847 6.34198 37.6704 6.21766 37.529 6.13108C37.3877 6.04451 37.2249 5.99913 37.0592 6.00005H2.89919C2.71505 5.99813 2.53497 6.05404 2.38427 6.15988C2.23358 6.26573 2.11987 6.41618 2.0592 6.59005C1.99343 6.76227 1.98217 6.95054 2.02688 7.12938C2.07159 7.30823 2.17013 7.46903 2.3092 7.59005L14.3092 17.86V36.05C14.3103 36.2389 14.3708 36.4225 14.4821 36.5751C14.5933 36.7276 14.7497 36.8413 14.9292 36.9C15.022 36.9143 15.1164 36.9143 15.2092 36.9C15.3489 36.9 15.4867 36.8675 15.6117 36.805C15.7367 36.7426 15.8454 36.6518 15.9292 36.5401L37.7492 7.40005C37.8464 7.27167 37.9078 7.11978 37.9271 6.95991C37.9465 6.80004 37.923 6.6379 37.8592 6.49005ZM5.32922 7.81005H33.1292L15.3592 16.38L5.32922 7.81005ZM16.1292 18L34.1292 9.31005L16.1292 33.31V18Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 0 40 40"),c(e,"width",l[1]),c(e,"height",l[1]),c(e,"fill",l[0]),c(e,"stroke",l[0])},m(n,s){A(n,e,s),v(e,t)},p(n,[s]){s&2&&c(e,"width",n[1]),s&2&&c(e,"height",n[1]),s&1&&c(e,"fill",n[0]),s&1&&c(e,"stroke",n[0])},i:K,o:K,d(n){n&&_(e)}}}function Kn(l,e,t){let n,{fill:s="#5f6368"}=e,{length:r="1.75"}=e;return l.$$set=i=>{"fill"in i&&t(0,s=i.fill),"length"in i&&t(2,r=i.length)},l.$$.update=()=>{l.$$.dirty&4&&t(1,n=ke(r))},[s,n,r]}class Qn extends ce{constructor(e){super(),de(this,e,Kn,Jn,ue,{fill:0,length:2})}}function $n(l){let e,t;return{c(){e=ge("svg"),t=ge("path"),this.h()},l(n){e=pe(n,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=B(e);t=pe(s,"path",{d:!0}),B(t).forEach(_),s.forEach(_),this.h()},h(){c(t,"d","M10.7584 31.6667L3.33337 37.5V6.66667C3.33337 6.22464 3.50897 5.80072 3.82153 5.48816C4.13409 5.17559 4.55801 5 5.00004 5H35C35.4421 5 35.866 5.17559 36.1786 5.48816C36.4911 5.80072 36.6667 6.22464 36.6667 6.66667V30C36.6667 30.442 36.4911 30.866 36.1786 31.1785C35.866 31.4911 35.4421 31.6667 35 31.6667H10.7584ZM9.60504 28.3333H33.3334V8.33333H6.66671V30.6417L9.60504 28.3333ZM18.3334 16.6667H21.6667V20H18.3334V16.6667ZM11.6667 16.6667H15V20H11.6667V16.6667ZM25 16.6667H28.3334V20H25V16.6667Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 0 40 40"),c(e,"width",l[1]),c(e,"height",l[1]),c(e,"fill",l[0])},m(n,s){A(n,e,s),v(e,t)},p(n,[s]){s&2&&c(e,"width",n[1]),s&2&&c(e,"height",n[1]),s&1&&c(e,"fill",n[0])},i:K,o:K,d(n){n&&_(e)}}}function el(l,e,t){let n,{fill:s="#5f6368"}=e,{length:r="1.75"}=e;return l.$$set=i=>{"fill"in i&&t(0,s=i.fill),"length"in i&&t(2,r=i.length)},l.$$.update=()=>{l.$$.dirty&4&&t(1,n=ke(r))},[s,n,r]}class tl extends ce{constructor(e){super(),de(this,e,el,$n,ue,{fill:0,length:2})}}function nl(l){let e,t;return{c(){e=ge("svg"),t=ge("path"),this.h()},l(n){e=pe(n,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=B(e);t=pe(s,"path",{d:!0}),B(t).forEach(_),s.forEach(_),this.h()},h(){c(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 -960 960 960"),c(e,"width",l[1]),c(e,"height",l[1]),c(e,"fill",l[0])},m(n,s){A(n,e,s),v(e,t)},p(n,[s]){s&2&&c(e,"width",n[1]),s&2&&c(e,"height",n[1]),s&1&&c(e,"fill",n[0])},i:K,o:K,d(n){n&&_(e)}}}function ll(l,e,t){let n,{fill:s="#5f6368"}=e,{length:r="1.75"}=e,{alt:i="Edit"}=e;return l.$$set=a=>{"fill"in a&&t(0,s=a.fill),"length"in a&&t(2,r=a.length),"alt"in a&&t(3,i=a.alt)},l.$$.update=()=>{l.$$.dirty&4&&t(1,n=ke(r))},[s,n,r,i]}class sl extends ce{constructor(e){super(),de(this,e,ll,nl,ue,{fill:0,length:2,alt:3})}}function il(l){let e,t;return{c(){e=ge("svg"),t=ge("path"),this.h()},l(n){e=pe(n,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=B(e);t=pe(s,"path",{d:!0}),B(t).forEach(_),s.forEach(_),this.h()},h(){c(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),c(e,"xmlns","http://www.w3.org/2000/svg"),c(e,"viewBox","0 -960 960 960"),c(e,"width",l[1]),c(e,"height",l[1]),c(e,"fill",l[0])},m(n,s){A(n,e,s),v(e,t)},p(n,[s]){s&2&&c(e,"width",n[1]),s&2&&c(e,"height",n[1]),s&1&&c(e,"fill",n[0])},i:K,o:K,d(n){n&&_(e)}}}function rl(l,e,t){let n,{fill:s="#5f6368"}=e,{length:r="1.75"}=e,{alt:i="Delete"}=e;return l.$$set=a=>{"fill"in a&&t(0,s=a.fill),"length"in a&&t(2,r=a.length),"alt"in a&&t(3,i=a.alt)},l.$$.update=()=>{l.$$.dirty&4&&t(1,n=ke(r))},[s,n,r,i]}class al extends ce{constructor(e){super(),de(this,e,rl,il,ue,{fill:0,length:2,alt:3})}}function ot(l){let e,t=l[0].text+"",n,s,r;return{c(){e=T("p"),n=Te(t),this.h()},l(i){e=D(i,"P",{class:!0,style:!0});var a=B(e);n=De(a,t),a.forEach(_),this.h()},h(){c(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),c(e,"style",`
      overflow: hidden;
      height: ${l[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(i,a){A(i,e,a),v(e,n),s||(r=[Ae(Ue.call(null,e)),X(e,"click",l[2])],s=!0)},p(i,a){a&1&&t!==(t=i[0].text+"")&&Ye(n,t)},d(i){i&&_(e),s=!1,Ie(r)}}}function ol(l){var s;let e=((s=l[0])==null?void 0:s.text)&&l[0].text.trim().length>0,t,n=e&&ot(l);return{c(){n&&n.c(),t=te()},l(r){n&&n.l(r),t=te()},m(r,i){n&&n.m(r,i),A(r,t,i)},p(r,[i]){var a;i&1&&(e=((a=r[0])==null?void 0:a.text)&&r[0].text.trim().length>0),e?n?n.p(r,i):(n=ot(r),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},i:K,o:K,d(r){r&&_(t),n&&n.d(r)}}}function fl(l,e,t){const n=Xe();let{post:s}=e;const r=ke(1),i=ke(6);function a(o){const f=o.currentTarget;if(f)if(f.style.height===`${r}px`||!f.style.height){if(f.scrollHeight>r){const d=f.scrollHeight<i?f.scrollHeight:i;f.style.height=`${d}px`,f.style.overflow="scroll",f.style.display="block",f.style.webkitLineClamp="unset",n("textExpanded",{expanded:!0})}}else f.style.height=`${r}px`,f.style.overflow="hidden",f.style.display="-webkit-box",f.style.webkitLineClamp="1",n("textExpanded",{expanded:!1})}return Rt(()=>{n("textExpanded",{expanded:!1})}),l.$$set=o=>{"post"in o&&t(0,s=o.post)},[s,r,a]}class ul extends ce{constructor(e){super(),de(this,e,fl,ol,ue,{post:0})}}function cl(l){let e;return{c(){e=T("div"),this.h()},l(t){e=D(t,"DIV",{class:!0,style:!0}),B(e).forEach(_),this.h()},h(){c(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),se(e,"opacity","0.6"),se(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,n){A(t,e,n)},d(t){t&&_(e)}}}function dl(l){let e;return{c(){e=T("div"),this.h()},l(t){e=D(t,"DIV",{class:!0,style:!0}),B(e).forEach(_),this.h()},h(){c(e,"class","fixed inset-0 pointer-events-none z-30"),se(e,"opacity","0.7"),se(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,n){A(t,e,n)},d(t){t&&_(e)}}}function hl(l){let e;function t(r,i){return r[0]?dl:cl}let n=t(l),s=n(l);return{c(){s.c(),e=te()},l(r){s.l(r),e=te()},m(r,i){s.m(r,i),A(r,e,i)},p(r,[i]){n!==(n=t(r))&&(s.d(1),s=n(r),s&&(s.c(),s.m(e.parentNode,e)))},i:K,o:K,d(r){r&&_(e),s.d(r)}}}function ml(l,e,t){let{isTextExpanded:n=!1}=e;return l.$$set=s=>{"isTextExpanded"in s&&t(0,n=s.isTextExpanded)},[n]}class gl extends ce{constructor(e){super(),de(this,e,ml,hl,ue,{isTextExpanded:0})}}function ft(l,e,t){const n=l.slice();return n[5]=e[t],n[7]=t,n}function ut(l,e){let t,n,s,r,i,a=K;return{key:l,first:null,c(){t=T("span"),n=T("span"),r=N(),this.h()},l(o){t=D(o,"SPAN",{class:!0,style:!0});var f=B(t);n=D(f,"SPAN",{class:!0,style:!0}),B(n).forEach(_),r=j(f),f.forEach(_),this.h()},h(){c(n,"class",s=He(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),se(n,"transform","scale("+e[4](e[7])+")"),se(n,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),c(t,"class","flex items-center justify-center"),se(t,"width","0.375rem"),se(t,"height","0.375rem"),this.first=t},m(o,f){A(o,t,f),v(t,n),v(t,r)},p(o,f){e=o,f&13&&s!==(s=He(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&c(n,"class",s),f&8&&se(n,"transform","scale("+e[4](e[7])+")"),f&13&&se(n,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){i=t.getBoundingClientRect()},f(){Sn(t),a()},a(){a(),a=An(t,i,Nn,{})},d(o){o&&_(t)}}}function pl(l){let e,t=[],n=new Map,s,r=ve(l[3]);const i=a=>a[5];for(let a=0;a<r.length;a+=1){let o=ft(l,r,a),f=i(o);n.set(f,t[a]=ut(f,o))}return{c(){e=T("div");for(let a=0;a<t.length;a+=1)t[a].c();this.h()},l(a){e=D(a,"DIV",{class:!0});var o=B(e);for(let f=0;f<t.length;f+=1)t[f].l(o);o.forEach(_),this.h()},h(){c(e,"class",s=He(`
    ${l[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(a,o){A(a,e,o);for(let f=0;f<t.length;f+=1)t[f]&&t[f].m(e,null)},p(a,[o]){if(o&29){r=ve(a[3]);for(let f=0;f<t.length;f+=1)t[f].r();t=Ze(t,o,i,1,a,r,n,e,kn,ut,null,ft);for(let f=0;f<t.length;f+=1)t[f].a()}o&2&&s!==(s=He(`
    ${a[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&c(e,"class",s)},i:K,o:K,d(a){a&&_(e);for(let o=0;o<t.length;o+=1)t[o].d()}}}const Ve=7;function _l(l,e,t){let{post:n}=e,{fixed:s=!0}=e,r=[],i=0;function a(o){const f=n.mediaIdx-i,d=r.length;if(d<=1)return 1;const b=Math.max(f,d-1-f);return b===0?1:1-Math.abs(o-f)/b*.5}return l.$$set=o=>{"post"in o&&t(0,n=o.post),"fixed"in o&&t(1,s=o.fixed)},l.$$.update=()=>{l.$$.dirty&5&&(n.media.length>Ve?(n.mediaIdx<=Math.floor(Ve/2)?t(2,i=0):n.mediaIdx>=n.media.length-Math.ceil(Ve/2)?t(2,i=n.media.length-Ve):t(2,i=n.mediaIdx-Math.floor(Ve/2)),t(3,r=n.media.slice(i,i+Ve))):(t(2,i=0),t(3,r=n.media)))},[n,s,i,r,a]}class qt extends ce{constructor(e){super(),de(this,e,_l,pl,ue,{post:0,fixed:1})}}function ct(l,e,t){const n=l.slice();return n[13]=e[t].text,n[14]=e[t].value,n[15]=e[t].custom,n[17]=t,n}function dt(l){let e,t,n,s,r=l[13]+"",i,a,o,f;return{c(){e=T("label"),t=T("input"),n=N(),s=T("span"),i=Te(r),a=N(),this.h()},l(d){e=D(d,"LABEL",{class:!0});var b=B(e);t=D(b,"INPUT",{type:!0,name:!0,class:!0}),n=j(b),s=D(b,"SPAN",{class:!0});var w=B(s);i=De(w,r),w.forEach(_),a=j(b),b.forEach(_),this.h()},h(){c(t,"type","radio"),c(t,"name","report"),c(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=l[14],c(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),c(e,"class","flex gap-2 py-2")},m(d,b){A(d,e,b),v(e,t),v(e,n),v(e,s),v(s,i),v(e,a),o||(f=X(t,"change",l[7]),o=!0)},p:K,d(d){d&&_(e),o=!1,f()}}}function ht(l){let e,t,n,s;return{c(){e=T("div"),t=T("textarea"),this.h()},l(r){e=D(r,"DIV",{class:!0});var i=B(e);t=D(i,"TEXTAREA",{class:!0,placeholder:!0}),B(t).forEach(_),i.forEach(_),this.h()},h(){c(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal"),c(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),c(e,"class","px-5 py-2.5")},m(r,i){A(r,e,i),v(e,t),tt(t,l[2]),n||(s=X(t,"input",l[8]),n=!0)},p(r,i){i&4&&tt(t,r[2])},d(r){r&&_(e),n=!1,s()}}}function bl(l){let e,t,n="게시물 신고 사유",s,r,i,a,o,f,d="취소",b,w,y="신고",x,m,p=ve(l[3]),h=[];for(let R=0;R<p.length;R+=1)h[R]=dt(ct(l,p,R));let M=l[1]==="etc"&&ht(l);return{c(){e=T("div"),t=T("heading"),t.textContent=n,s=N(),r=T("div");for(let R=0;R<h.length;R+=1)h[R].c();i=N(),M&&M.c(),a=N(),o=T("div"),f=T("button"),f.textContent=d,b=N(),w=T("button"),w.textContent=y,this.h()},l(R){e=D(R,"DIV",{class:!0});var q=B(e);t=D(q,"HEADING",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-z3puxq"&&(t.textContent=n),s=j(q),r=D(q,"DIV",{class:!0});var C=B(r);for(let F=0;F<h.length;F+=1)h[F].l(C);C.forEach(_),i=j(q),M&&M.l(q),a=j(q),o=D(q,"DIV",{class:!0});var O=B(o);f=D(O,"BUTTON",{class:!0,"data-svelte-h":!0}),$(f)!=="svelte-xb8aop"&&(f.textContent=d),b=j(O),w=D(O,"BUTTON",{class:!0,"data-svelte-h":!0}),$(w)!=="svelte-1fehi46"&&(w.textContent=y),O.forEach(_),q.forEach(_),this.h()},h(){c(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),c(r,"class","px-5"),c(f,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),c(w,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),c(o,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),c(e,"class","flex flex-col gap-2.5")},m(R,q){A(R,e,q),v(e,t),v(e,s),v(e,r);for(let C=0;C<h.length;C+=1)h[C]&&h[C].m(r,null);v(e,i),M&&M.m(e,null),v(e,a),v(e,o),v(o,f),v(o,b),v(o,w),x||(m=[X(f,"click",l[9]),X(w,"click",l[4]),Ae(Ue.call(null,e))],x=!0)},p(R,q){if(q&10){p=ve(R[3]);let C;for(C=0;C<p.length;C+=1){const O=ct(R,p,C);h[C]?h[C].p(O,q):(h[C]=dt(O),h[C].c(),h[C].m(r,null))}for(;C<h.length;C+=1)h[C].d(1);h.length=p.length}R[1]==="etc"?M?M.p(R,q):(M=ht(R),M.c(),M.m(e,a)):M&&(M.d(1),M=null)},d(R){R&&_(e),St(h,R),M&&M.d(),x=!1,Ie(m)}}}function vl(l){let e,t,n;function s(i){l[10](i)}let r={noHandle:!0,fixed:!0,$$slots:{default:[bl]},$$scope:{ctx:l}};return l[0]!==void 0&&(r.isOpen=l[0]),e=new Ht({props:r}),Be.push(()=>Re(e,"isOpen",s)),{c(){Z(e.$$.fragment)},l(i){G(e.$$.fragment,i)},m(i,a){W(e,i,a),n=!0},p(i,[a]){const o={};a&262151&&(o.$$scope={dirty:a,ctx:i}),!t&&a&1&&(t=!0,o.isOpen=i[0],Le(()=>t=!1)),e.$set(o)},i(i){n||(E(e.$$.fragment,i),n=!0)},o(i){P(e.$$.fragment,i),n=!1},d(i){J(e,i)}}}function wl(l,e,t){const n=Xe();let{isOpen:s}=e,{selectedValue:r=""}=e,{targetTable:i=""}=e,{targetIdx:a=""}=e;const o=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let f="";async function d(){const m=o.findIndex(p=>p.value===r);if(m===-1){alert("신고 사유를 선택해주세요.");return}xe.emit("loading",!0);try{const p=o[m],h=new URL(`${Se}/auth/permissions`);h.searchParams.set("targetTable",i),h.searchParams.set("targetIdx",a),h.searchParams.set("relation","reported"),h.searchParams.set("subjectTable","users"),h.searchParams.set("subjectIdx",Nt().sub),h.searchParams.set("metadata",JSON.stringify({...p,customReason:f})),t(0,s=!1),t(2,f=""),await fetch(h,{method:"PUT",headers:{Authorization:`Bearer ${qe()}`}}),n("reported")}finally{xe.emit("loading",!1)}}const b=m=>{t(1,r=m.target.value)};function w(){f=this.value,t(2,f)}const y=()=>{t(0,s=!1)};function x(m){s=m,t(0,s)}return l.$$set=m=>{"isOpen"in m&&t(0,s=m.isOpen),"selectedValue"in m&&t(1,r=m.selectedValue),"targetTable"in m&&t(5,i=m.targetTable),"targetIdx"in m&&t(6,a=m.targetIdx)},[s,r,f,o,d,i,a,b,w,y,x]}class kl extends ce{constructor(e){super(),de(this,e,wl,vl,ue,{isOpen:0,selectedValue:1,targetTable:5,targetIdx:6})}}function mt(l){let e,t,n,s="이 게시물을 신고해 주셔서 감사합니다.",r,i,a="신고 취소하기",o,f;return{c(){e=T("div"),t=T("div"),n=T("div"),n.textContent=s,r=N(),i=T("div"),i.textContent=a,this.h()},l(d){e=D(d,"DIV",{class:!0});var b=B(e);t=D(b,"DIV",{class:!0});var w=B(t);n=D(w,"DIV",{class:!0,"data-svelte-h":!0}),$(n)!=="svelte-179ijsk"&&(n.textContent=s),r=j(w),i=D(w,"DIV",{class:!0,"data-svelte-h":!0}),$(i)!=="svelte-1haiztv"&&(i.textContent=a),w.forEach(_),b.forEach(_),this.h()},h(){c(n,"class","text-white text-[0.9375rem] font-semibold"),c(i,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),c(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),c(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(d,b){A(d,e,b),v(e,t),v(t,n),v(t,r),v(t,i),o||(f=X(i,"click",l[1]),o=!0)},p:K,d(d){d&&_(e),o=!1,f()}}}function Cl(l){let e,t=l[0]&&mt(l);return{c(){t&&t.c(),e=te()},l(n){t&&t.l(n),e=te()},m(n,s){t&&t.m(n,s),A(n,e,s)},p(n,[s]){n[0]?t?t.p(n,s):(t=mt(n),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:K,o:K,d(n){n&&_(e),t&&t.d(n)}}}function xl(l,e,t){const n=Xe();let{isVisible:s=!1}=e,{targetTable:r=""}=e,{targetIdx:i=""}=e,a=!1;async function o(){if(a!==!0){a=!0,xe.emit("loading",!0);try{const f=new URL(`${Se}/auth/permissions`);f.searchParams.set("targetTable",r),f.searchParams.set("targetIdx",i),f.searchParams.set("relation","reported"),f.searchParams.set("subjectTable","users"),f.searchParams.set("subjectIdx",Nt().sub),await fetch(f,{method:"DELETE",headers:{Authorization:`Bearer ${qe()}`}}),t(0,s=!1),n("unreported")}finally{a=!1,xe.emit("loading",!1)}}}return l.$$set=f=>{"isVisible"in f&&t(0,s=f.isVisible),"targetTable"in f&&t(2,r=f.targetTable),"targetIdx"in f&&t(3,i=f.targetIdx)},[s,o,r,i]}class Il extends ce{constructor(e){super(),de(this,e,xl,Cl,ue,{isVisible:0,targetTable:2,targetIdx:3})}}function gt(l,e,t){const n=l.slice();return n[77]=e[t],n[78]=e,n[79]=t,n}function pt(l,e,t){const n=l.slice();return n[80]=e[t],n}function _t(l,e,t){const n=l.slice();return n[83]=e[t],n[85]=t,n}function bt(l){let e,t,n;return{c(){e=T("div"),this.h()},l(s){e=D(s,"DIV",{class:!0}),B(e).forEach(_),this.h()},h(){c(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,r){A(s,e,r),t||(n=X(e,"contextmenu",vn(l[24])),t=!0)},d(s){s&&_(e),t=!1,n()}}}function vt(l){let e,t,n,s=[],r=new Map,i,a,o,f,d,b,w,y=ve(l[77].media);const x=p=>p[83];for(let p=0;p<y.length;p+=1){let h=_t(l,y,p),M=x(h);r.set(M,s[p]=wt(M,h))}let m=!l[5]&&kt(l);return{c(){e=T("section"),t=T("div"),n=T("div");for(let p=0;p<s.length;p+=1)s[p].c();a=N(),m&&m.c(),o=N(),this.h()},l(p){e=D(p,"SECTION",{class:!0,style:!0});var h=B(e);t=D(h,"DIV",{class:!0});var M=B(t);n=D(M,"DIV",{class:!0,style:!0});var R=B(n);for(let q=0;q<s.length;q+=1)s[q].l(R);R.forEach(_),M.forEach(_),a=j(h),m&&m.l(h),o=j(h),h.forEach(_),this.h()},h(){c(n,"class",i="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(l[9]?"duration-0 transition-duration-0":"")),se(n,"transform","translateX("+(-l[77].mediaIdx*l[12].width+l[11])+"px)"),c(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),c(e,"class",f=`w-full h-full absolute content-center transition-transform
            ${l[9]?"duration-0 transition-duration-0":""}`),se(e,"top","0"),se(e,"transform","translateY("+((l[79]-l[1])*l[12].height+l[10])+"px)")},m(p,h){A(p,e,h),v(e,t),v(t,n);for(let M=0;M<s.length;M+=1)s[M]&&s[M].m(n,null);v(e,a),m&&m.m(e,null),v(e,o),d=!0,b||(w=[X(n,"transitionend",function(){Fe(l[77].mediaIdx===l[0][l[1]].mediaIdx?l[15]:void 0)&&(l[77].mediaIdx===l[0][l[1]].mediaIdx?l[15]:void 0).apply(this,arguments)}),X(e,"transitionend",function(){Fe(l[79]===l[1]?l[15]:void 0)&&(l[79]===l[1]?l[15]:void 0).apply(this,arguments)})],b=!0)},p(p,h){l=p,h[0]&35&&(y=ve(l[77].media),ne(),s=Ze(s,h,x,1,l,y,r,n,At,wt,null,_t),le()),(!d||h[0]&512&&i!==(i="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(l[9]?"duration-0 transition-duration-0":"")))&&c(n,"class",i),(!d||h[0]&6145)&&se(n,"transform","translateX("+(-l[77].mediaIdx*l[12].width+l[11])+"px)"),l[5]?m&&(ne(),P(m,1,1,()=>{m=null}),le()):m?(m.p(l,h),h[0]&32&&E(m,1)):(m=kt(l),m.c(),E(m,1),m.m(e,o)),(!d||h[0]&512&&f!==(f=`w-full h-full absolute content-center transition-transform
            ${l[9]?"duration-0 transition-duration-0":""}`))&&c(e,"class",f),(!d||h[0]&5123)&&se(e,"transform","translateY("+((l[79]-l[1])*l[12].height+l[10])+"px)")},i(p){if(!d){for(let h=0;h<y.length;h+=1)E(s[h]);E(m),d=!0}},o(p){for(let h=0;h<s.length;h+=1)P(s[h]);P(m),d=!1},d(p){p&&_(e);for(let h=0;h<s.length;h+=1)s[h].d();m&&m.d(),b=!1,Ie(w)}}}function wt(l,e){let t,n,s,r,i,a;return s=new jn({props:{src:e[83],isEdit:e[5],post:e[0][e[1]],autoplay:e[1]===e[79]&&e[0][e[1]].mediaIdx===e[85],isRightOrderForYoutube:e[1]===e[79]}}),{key:l,first:null,c(){t=T("div"),n=T("div"),Z(s.$$.fragment),i=N(),this.h()},l(o){t=D(o,"DIV",{class:!0});var f=B(t);n=D(f,"DIV",{class:!0});var d=B(n);G(s.$$.fragment,d),d.forEach(_),i=j(f),f.forEach(_),this.h()},h(){c(n,"class",r=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `),c(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(o,f){A(o,t,f),v(t,n),W(s,n,null),v(t,i),a=!0},p(o,f){e=o;const d={};f[0]&1&&(d.src=e[83]),f[0]&32&&(d.isEdit=e[5]),f[0]&3&&(d.post=e[0][e[1]]),f[0]&3&&(d.autoplay=e[1]===e[79]&&e[0][e[1]].mediaIdx===e[85]),f[0]&3&&(d.isRightOrderForYoutube=e[1]===e[79]),s.$set(d),(!a||f[0]&32&&r!==(r=`
                      w-full h-full flex justify-center items-center relative
                      ${e[5]?"px-5 pt-5 pb-3":""}
                    `))&&c(n,"class",r)},i(o){a||(E(s.$$.fragment,o),a=!0)},o(o){P(s.$$.fragment,o),a=!1},d(o){o&&_(t),J(s)}}}function kt(l){var F;let e,t,n,s,r,i,a,o,f,d,b,w,y,x,m,p=l[77].media.length>1&&Ct(l),h=((F=l[77].reactions)==null?void 0:F.length)>0&&!l[7]&&xt(l);function M(k){l[26](k,l[77],l[78],l[79])}let R={};l[77]!==void 0&&(R.post=l[77]),r=new Un({props:R}),Be.push(()=>Re(r,"post",M));function q(...k){return l[27](l[77],l[78],l[79],...k)}o=new ul({props:{post:l[77]}}),o.$on("textExpanded",q),d=new Wn({props:{place:{idx:l[77].place_idx,name:l[77].place_name}}});let C=!l[7]&&Et(l),O=l[1]===l[79]&&Tt(l);return{c(){p&&p.c(),e=N(),t=T("div"),n=T("div"),h&&h.c(),s=N(),Z(r.$$.fragment),a=N(),Z(o.$$.fragment),f=N(),Z(d.$$.fragment),w=N(),C&&C.c(),y=N(),O&&O.c(),x=te(),this.h()},l(k){p&&p.l(k),e=j(k),t=D(k,"DIV",{class:!0});var L=B(t);n=D(L,"DIV",{class:!0,style:!0});var Y=B(n);h&&h.l(Y),s=j(Y),G(r.$$.fragment,Y),a=j(Y),G(o.$$.fragment,Y),f=j(Y),G(d.$$.fragment,Y),Y.forEach(_),w=j(L),C&&C.l(L),L.forEach(_),y=j(k),O&&O.l(k),x=te(),this.h()},h(){c(n,"class","relative flex-grow text-white text-md flex flex-col items-start gap-2 transition-transform text-base "),c(n,"style",b=`transform: translateY(${l[6]}px);`),c(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(k,L){p&&p.m(k,L),A(k,e,L),A(k,t,L),v(t,n),h&&h.m(n,null),v(n,s),W(r,n,null),v(n,a),W(o,n,null),v(n,f),W(d,n,null),v(t,w),C&&C.m(t,null),A(k,y,L),O&&O.m(k,L),A(k,x,L),m=!0},p(k,L){var oe;l=k,l[77].media.length>1?p?(p.p(l,L),L[0]&1&&E(p,1)):(p=Ct(l),p.c(),E(p,1),p.m(e.parentNode,e)):p&&(ne(),P(p,1,1,()=>{p=null}),le()),((oe=l[77].reactions)==null?void 0:oe.length)>0&&!l[7]?h?(h.p(l,L),L[0]&129&&E(h,1)):(h=xt(l),h.c(),E(h,1),h.m(n,s)):h&&(ne(),P(h,1,1,()=>{h=null}),le());const Y={};!i&&L[0]&1&&(i=!0,Y.post=l[77],Le(()=>i=!1)),r.$set(Y);const ie={};L[0]&1&&(ie.post=l[77]),o.$set(ie);const Q={};L[0]&1&&(Q.place={idx:l[77].place_idx,name:l[77].place_name}),d.$set(Q),(!m||L[0]&64&&b!==(b=`transform: translateY(${l[6]}px);`))&&c(n,"style",b),l[7]?C&&(ne(),P(C,1,1,()=>{C=null}),le()):C?(C.p(l,L),L[0]&128&&E(C,1)):(C=Et(l),C.c(),E(C,1),C.m(t,null)),l[1]===l[79]?O?(O.p(l,L),L[0]&3&&E(O,1)):(O=Tt(l),O.c(),E(O,1),O.m(x.parentNode,x)):O&&(ne(),P(O,1,1,()=>{O=null}),le())},i(k){m||(E(p),E(h),E(r.$$.fragment,k),E(o.$$.fragment,k),E(d.$$.fragment,k),E(C),E(O),m=!0)},o(k){P(p),P(h),P(r.$$.fragment,k),P(o.$$.fragment,k),P(d.$$.fragment,k),P(C),P(O),m=!1},d(k){k&&(_(e),_(t),_(y),_(x)),p&&p.d(k),h&&h.d(),J(r),J(o),J(d),C&&C.d(),O&&O.d(k)}}}function Ct(l){let e,t;return e=new qt({props:{post:l[77]}}),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},p(n,s){const r={};s[0]&1&&(r.post=n[77]),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function xt(l){let e,t,n=ve(l[77].reactions),s=[];for(let i=0;i<n.length;i+=1)s[i]=It(pt(l,n,i));const r=i=>P(s[i],1,1,()=>{s[i]=null});return{c(){e=T("div");for(let i=0;i<s.length;i+=1)s[i].c();this.h()},l(i){e=D(i,"DIV",{class:!0});var a=B(e);for(let o=0;o<s.length;o+=1)s[o].l(a);a.forEach(_),this.h()},h(){c(e,"class","flex gap-1 justify-center items-center mb-1")},m(i,a){A(i,e,a);for(let o=0;o<s.length;o+=1)s[o]&&s[o].m(e,null);t=!0},p(i,a){if(a[0]&131073){n=ve(i[77].reactions);let o;for(o=0;o<n.length;o+=1){const f=pt(i,n,o);s[o]?(s[o].p(f,a),E(s[o],1)):(s[o]=It(f),s[o].c(),E(s[o],1),s[o].m(e,null))}for(ne(),o=n.length;o<s.length;o+=1)r(o);le()}},i(i){if(!t){for(let a=0;a<n.length;a+=1)E(s[a]);t=!0}},o(i){s=s.filter(Boolean);for(let a=0;a<s.length;a+=1)P(s[a]);t=!1},d(i){i&&_(e),St(s,i)}}}function It(l){let e,t;function n(){return l[25](l[77],l[80])}return e=new jt({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:l[80].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:l[80].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",n),{c(){Z(e.$$.fragment)},l(s){G(e.$$.fragment,s)},m(s,r){W(e,s,r),t=!0},p(s,r){l=s;const i={};r[0]&1&&(i.prefix=l[80].type),r[0]&1&&(i.value=l[80].count),e.$set(i)},i(s){t||(E(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){J(e,s)}}}function Et(l){var re;let e,t,n,s,r,i,a,o,f=((re=l[77].reactions)!=null&&re.length?l[77].reactions.reduce(l[33],0):"")+"",d,b,w,y,x,m,p="0",h,M,R,q,C,O,F,k,L,Y=l[77].onReactionShowcase&&yt(l);const ie=[yl,El],Q=[];function oe(g,I){return g[77].myReaction?0:1}r=oe(l),i=Q[r]=ie[r](l);function he(){return l[34](l[77])}function fe(){return l[35](l[77],l[78],l[79])}return y=new tl({props:{fill:"white",length:1.5}}),R=new Qn({props:{fill:"white",length:1.5}}),O=new Ln({props:{fill:"white",length:1.5}}),{c(){e=T("div"),t=T("div"),Y&&Y.c(),n=N(),s=T("button"),i.c(),a=N(),o=T("span"),d=Te(f),b=N(),w=T("button"),Z(y.$$.fragment),x=N(),m=T("span"),m.textContent=p,h=N(),M=T("button"),Z(R.$$.fragment),q=N(),C=T("button"),Z(O.$$.fragment),this.h()},l(g){e=D(g,"DIV",{class:!0});var I=B(e);t=D(I,"DIV",{class:!0});var z=B(t);Y&&Y.l(z),n=j(z),s=D(z,"BUTTON",{class:!0});var ee=B(s);i.l(ee),a=j(ee),o=D(ee,"SPAN",{class:!0});var Ce=B(o);d=De(Ce,f),Ce.forEach(_),ee.forEach(_),z.forEach(_),b=j(I),w=D(I,"BUTTON",{class:!0});var _e=B(w);G(y.$$.fragment,_e),x=j(_e),m=D(_e,"SPAN",{class:!0,"data-svelte-h":!0}),$(m)!=="svelte-1mtud4s"&&(m.textContent=p),_e.forEach(_),h=j(I),M=D(I,"BUTTON",{});var me=B(M);G(R.$$.fragment,me),me.forEach(_),q=j(I),C=D(I,"BUTTON",{});var Ee=B(C);G(O.$$.fragment,Ee),Ee.forEach(_),I.forEach(_),this.h()},h(){c(o,"class","text-xs text-white h-4"),c(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),c(t,"class","flex gap-4 relative"),c(m,"class","text-xs text-white h-4"),c(w,"class","flex flex-col gap-[0.3125rem] items-center justify-center"),c(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(g,I){A(g,e,I),v(e,t),Y&&Y.m(t,null),v(t,n),v(t,s),Q[r].m(s,null),v(s,a),v(s,o),v(o,d),v(e,b),v(e,w),W(y,w,null),v(w,x),v(w,m),v(e,h),v(e,M),W(R,M,null),v(e,q),v(e,C),W(O,C,null),F=!0,k||(L=[X(s,"click",he),Ae(Ue.call(null,s)),Ae(Pn.call(null,s,500)),X(s,"longpress",fe),X(C,"click",l[36])],k=!0)},p(g,I){var ee;l=g,l[77].onReactionShowcase?Y?Y.p(l,I):(Y=yt(l),Y.c(),Y.m(t,n)):Y&&(Y.d(1),Y=null);let z=r;r=oe(l),r!==z&&(ne(),P(Q[z],1,1,()=>{Q[z]=null}),le(),i=Q[r],i||(i=Q[r]=ie[r](l),i.c()),E(i,1),i.m(s,a)),(!F||I[0]&1)&&f!==(f=((ee=l[77].reactions)!=null&&ee.length?l[77].reactions.reduce(l[33],0):"")+"")&&Ye(d,f)},i(g){F||(E(i),E(y.$$.fragment,g),E(R.$$.fragment,g),E(O.$$.fragment,g),F=!0)},o(g){P(i),P(y.$$.fragment,g),P(R.$$.fragment,g),P(O.$$.fragment,g),F=!1},d(g){g&&_(e),Y&&Y.d(),Q[r].d(),J(y),J(R),J(O),k=!1,Ie(L)}}}function yt(l){let e,t,n="👍",s,r,i="🔥",a,o,f="😍",d,b,w="😋",y,x,m="😊️️",p,h;function M(){return l[28](l[77])}function R(){return l[29](l[77])}function q(){return l[30](l[77])}function C(){return l[31](l[77])}function O(){return l[32](l[77])}return{c(){e=T("div"),t=T("button"),t.textContent=n,s=N(),r=T("button"),r.textContent=i,a=N(),o=T("button"),o.textContent=f,d=N(),b=T("button"),b.textContent=w,y=N(),x=T("button"),x.textContent=m,this.h()},l(F){e=D(F,"DIV",{class:!0});var k=B(e);t=D(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-3oecln"&&(t.textContent=n),s=j(k),r=D(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-131qbu2"&&(r.textContent=i),a=j(k),o=D(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$(o)!=="svelte-lq90i3"&&(o.textContent=f),d=j(k),b=D(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$(b)!=="svelte-l73y87"&&(b.textContent=w),y=j(k),x=D(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$(x)!=="svelte-11szxsj"&&(x.textContent=m),k.forEach(_),this.h()},h(){c(t,"class","text-2xl/[26px]"),c(r,"class","text-2xl/[26px]"),c(o,"class","text-2xl/[26px]"),c(b,"class","text-2xl/[26px]"),c(x,"class","text-2xl/[26px]"),c(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(F,k){A(F,e,k),v(e,t),v(e,s),v(e,r),v(e,a),v(e,o),v(e,d),v(e,b),v(e,y),v(e,x),p||(h=[X(t,"click",M),X(r,"click",R),X(o,"click",q),X(b,"click",C),X(x,"click",O)],p=!0)},p(F,k){l=F},d(F){F&&_(e),p=!1,Ie(h)}}}function El(l){let e,t;return e=new Vn({props:{fill:"white",length:1.5}}),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function yl(l){let e,t;return e=new Bn({props:{fill:"#EA3323",length:1.5}}),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Tt(l){let e,t;return e=new gl({props:{isTextExpanded:l[77].isTextExpanded}}),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},p(n,s){const r={};s[0]&1&&(r.isTextExpanded=n[77].isTextExpanded),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Dt(l,e){let t,n=Math.abs(e[1]-e[79])<=1,s,r,i=n&&vt(e);return{key:l,first:null,c(){t=te(),i&&i.c(),s=te(),this.h()},l(a){t=te(),i&&i.l(a),s=te(),this.h()},h(){this.first=t},m(a,o){A(a,t,o),i&&i.m(a,o),A(a,s,o),r=!0},p(a,o){e=a,o[0]&3&&(n=Math.abs(e[1]-e[79])<=1),n?i?(i.p(e,o),o[0]&3&&E(i,1)):(i=vt(e),i.c(),E(i,1),i.m(s.parentNode,s)):i&&(ne(),P(i,1,1,()=>{i=null}),le())},i(a){r||(E(i),r=!0)},o(a){P(i),r=!1},d(a){a&&(_(t),_(s)),i&&i.d(a)}}}function Mt(l){let e,t;return e=new qt({props:{post:l[0][l[1]],fixed:!1}}),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},p(n,s){const r={};s[0]&3&&(r.post=n[0][n[1]]),e.$set(r)},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Vt(l){let e,t;return e=new Mn({}),{c(){Z(e.$$.fragment)},l(n){G(e.$$.fragment,n)},m(n,s){W(e,n,s),t=!0},i(n){t||(E(e.$$.fragment,n),t=!0)},o(n){P(e.$$.fragment,n),t=!1},d(n){J(e,n)}}}function Bt(l){let e,t,n,s,r="수정",i,a,o,f,d,b="삭제",w,y,x;return t=new sl({props:{fill:"white",length:1.5}}),o=new al({props:{fill:"white",length:1.5}}),{c(){e=T("button"),Z(t.$$.fragment),n=N(),s=T("span"),s.textContent=r,i=N(),a=T("button"),Z(o.$$.fragment),f=N(),d=T("span"),d.textContent=b,this.h()},l(m){e=D(m,"BUTTON",{class:!0});var p=B(e);G(t.$$.fragment,p),n=j(p),s=D(p,"SPAN",{"data-svelte-h":!0}),$(s)!=="svelte-17aljrl"&&(s.textContent=r),p.forEach(_),i=j(m),a=D(m,"BUTTON",{class:!0});var h=B(a);G(o.$$.fragment,h),f=j(h),d=D(h,"SPAN",{"data-svelte-h":!0}),$(d)!=="svelte-1k1dgz"&&(d.textContent=b),h.forEach(_),this.h()},h(){c(e,"class","flex items-center gap-2 text-white text-sm"),c(a,"class","flex items-center gap-2 text-white text-sm")},m(m,p){A(m,e,p),W(t,e,null),v(e,n),v(e,s),A(m,i,p),A(m,a,p),W(o,a,null),v(a,f),v(a,d),w=!0,y||(x=[X(e,"click",l[38]),X(a,"click",l[39])],y=!0)},p:K,i(m){w||(E(t.$$.fragment,m),E(o.$$.fragment,m),w=!0)},o(m){P(t.$$.fragment,m),P(o.$$.fragment,m),w=!1},d(m){m&&(_(e),_(i),_(a)),J(t),J(o),y=!1,Ie(x)}}}function Pt(l){let e,t,n,s,r,i;return t=new Xn({}),{c(){e=T("button"),Z(t.$$.fragment),n=Te(`
        신고`),this.h()},l(a){e=D(a,"BUTTON",{class:!0});var o=B(e);G(t.$$.fragment,o),n=De(o,`
        신고`),o.forEach(_),this.h()},h(){c(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(a,o){A(a,e,o),W(t,e,null),v(e,n),s=!0,r||(i=X(e,"click",l[41]),r=!0)},p:K,i(a){s||(E(t.$$.fragment,a),s=!0)},o(a){P(t.$$.fragment,a),s=!1},d(a){a&&_(e),J(t),r=!1,i()}}}function Tl(l){let e,t,n,s,r,i,a,o,f,d=l[14]&&Bt(l);s=new Hn({props:{length:1.5,fill:"white"}});let b=!l[14]&&Pt(l);return{c(){e=T("div"),d&&d.c(),t=N(),n=T("button"),Z(s.$$.fragment),r=Te(`
      프로필 URL 복사`),i=N(),b&&b.c(),this.h()},l(w){e=D(w,"DIV",{id:!0,class:!0});var y=B(e);d&&d.l(y),t=j(y),n=D(y,"BUTTON",{class:!0});var x=B(n);G(s.$$.fragment,x),r=De(x,`
      프로필 URL 복사`),x.forEach(_),i=j(y),b&&b.l(y),y.forEach(_),this.h()},h(){c(n,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),c(e,"id","test"),c(e,"class","flex flex-col px-5 gap-3")},m(w,y){A(w,e,y),d&&d.m(e,null),v(e,t),v(e,n),W(s,n,null),v(n,r),v(e,i),b&&b.m(e,null),a=!0,o||(f=[X(n,"click",l[40]),Ae(Ue.call(null,e))],o=!0)},p(w,y){w[14]?d?(d.p(w,y),y[0]&16384&&E(d,1)):(d=Bt(w),d.c(),E(d,1),d.m(e,t)):d&&(ne(),P(d,1,1,()=>{d=null}),le()),w[14]?b&&(ne(),P(b,1,1,()=>{b=null}),le()):b?(b.p(w,y),y[0]&16384&&E(b,1)):(b=Pt(w),b.c(),E(b,1),b.m(e,null))},i(w){a||(E(d),E(s.$$.fragment,w),E(b),a=!0)},o(w){P(d),P(s.$$.fragment,w),P(b),a=!1},d(w){w&&_(e),d&&d.d(),J(s),b&&b.d(),o=!1,Ie(f)}}}function Dl(l){let e,t,n="정말로 삭제하시겠습니까?",s,r,i="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",a,o,f,d="삭제",b,w,y="취소",x,m;return{c(){e=T("div"),t=T("h2"),t.textContent=n,s=N(),r=T("p"),r.textContent=i,a=N(),o=T("div"),f=T("button"),f.textContent=d,b=N(),w=T("button"),w.textContent=y,this.h()},l(p){e=D(p,"DIV",{class:!0});var h=B(e);t=D(h,"H2",{class:!0,"data-svelte-h":!0}),$(t)!=="svelte-1yzhdkj"&&(t.textContent=n),s=j(h),r=D(h,"P",{class:!0,"data-svelte-h":!0}),$(r)!=="svelte-26p028"&&(r.textContent=i),a=j(h),o=D(h,"DIV",{class:!0});var M=B(o);f=D(M,"BUTTON",{class:!0,"data-svelte-h":!0}),$(f)!=="svelte-1q4epan"&&(f.textContent=d),b=j(M),w=D(M,"BUTTON",{class:!0,"data-svelte-h":!0}),$(w)!=="svelte-1rzg9yy"&&(w.textContent=y),M.forEach(_),h.forEach(_),this.h()},h(){c(t,"class","text-lg font-semibold mb-2"),c(r,"class","text-gray-600 mb-4"),c(f,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),c(w,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),c(o,"class","flex justify-center space-x-4"),c(e,"class","text-center")},m(p,h){A(p,e,h),v(e,t),v(e,s),v(e,r),v(e,a),v(e,o),v(o,f),v(o,b),v(o,w),x||(m=[X(f,"click",l[46]),X(w,"click",l[47])],x=!0)},p:K,d(p){p&&_(e),x=!1,Ie(m)}}}function Ml(l){var re;let e,t,n,s=[],r=new Map,i,a,o,f,d,b,w,y,x,m,p,h,M,R,q,C=!l[5]&&bt(l),O=ve(l[0]);const F=g=>g[77].idx;for(let g=0;g<O.length;g+=1){let I=gt(l,O,g),z=F(I);r.set(z,s[g]=Dt(z,I))}let k=l[5]&&((re=l[0][l[1]])==null?void 0:re.media.length)>1&&Mt(l),L=!l[5]&&Vt();function Y(g){l[42](g)}let ie={fixed:!0,noHandle:!0,$$slots:{default:[Tl]},$$scope:{ctx:l}};l[2]!==void 0&&(ie.isOpen=l[2]),d=new Ht({props:ie}),Be.push(()=>Re(d,"isOpen",Y));function Q(g){l[43](g)}let oe={targetTable:"posts",targetIdx:l[0][l[1]].idx};l[3]!==void 0&&(oe.isOpen=l[3]),y=new kl({props:oe}),Be.push(()=>Re(y,"isOpen",Q)),y.$on("reported",l[44]),p=new Il({props:{isVisible:l[0][l[1]].permission_signer==="reported",targetTable:"posts",targetIdx:l[0][l[1]].idx}}),p.$on("unreported",l[45]);function he(g){l[48](g)}let fe={$$slots:{default:[Dl]},$$scope:{ctx:l}};return l[4]!==void 0&&(fe.modalVisible=l[4]),M=new Rn({props:fe}),Be.push(()=>Re(M,"modalVisible",he)),{c(){C&&C.c(),e=N(),t=T("div"),n=T("div");for(let g=0;g<s.length;g+=1)s[g].c();i=N(),k&&k.c(),a=N(),L&&L.c(),f=N(),Z(d.$$.fragment),w=N(),Z(y.$$.fragment),m=N(),Z(p.$$.fragment),h=N(),Z(M.$$.fragment),this.h()},l(g){C&&C.l(g),e=j(g),t=D(g,"DIV",{class:!0});var I=B(t);n=D(I,"DIV",{class:!0});var z=B(n);for(let ee=0;ee<s.length;ee+=1)s[ee].l(z);z.forEach(_),i=j(I),k&&k.l(I),a=j(I),L&&L.l(I),I.forEach(_),f=j(g),G(d.$$.fragment,g),w=j(g),G(y.$$.fragment,g),m=j(g),G(p.$$.fragment,g),h=j(g),G(M.$$.fragment,g),this.h()},h(){c(n,"class","flex flex-grow relative w-full h-full bg-black"),c(t,"class",o="viewer bg-black select-none flex flex-col "+(l[5]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen safe-area-pt"))},m(g,I){C&&C.m(g,I),A(g,e,I),A(g,t,I),v(t,n);for(let z=0;z<s.length;z+=1)s[z]&&s[z].m(n,null);v(t,i),k&&k.m(t,null),v(t,a),L&&L.m(t,null),l[37](t),A(g,f,I),W(d,g,I),A(g,w,I),W(y,g,I),A(g,m,I),W(p,g,I),A(g,h,I),W(M,g,I),q=!0},p(g,I){var me;g[5]?C&&(C.d(1),C=null):C||(C=bt(g),C.c(),C.m(e.parentNode,e)),I[0]&171751&&(O=ve(g[0]),ne(),s=Ze(s,I,F,1,g,O,r,n,At,Dt,null,gt),le()),g[5]&&((me=g[0][g[1]])==null?void 0:me.media.length)>1?k?(k.p(g,I),I[0]&35&&E(k,1)):(k=Mt(g),k.c(),E(k,1),k.m(t,a)):k&&(ne(),P(k,1,1,()=>{k=null}),le()),g[5]?L&&(ne(),P(L,1,1,()=>{L=null}),le()):L?I[0]&32&&E(L,1):(L=Vt(),L.c(),E(L,1),L.m(t,null)),(!q||I[0]&32&&o!==(o="viewer bg-black select-none flex flex-col "+(g[5]?"static w-full h-full":"fixed top-0 left-0 w-screen h-screen safe-area-pt")))&&c(t,"class",o);const z={};I[0]&16668|I[2]&16777216&&(z.$$scope={dirty:I,ctx:g}),!b&&I[0]&4&&(b=!0,z.isOpen=g[2],Le(()=>b=!1)),d.$set(z);const ee={};I[0]&3&&(ee.targetIdx=g[0][g[1]].idx),!x&&I[0]&8&&(x=!0,ee.isOpen=g[3],Le(()=>x=!1)),y.$set(ee);const Ce={};I[0]&3&&(Ce.isVisible=g[0][g[1]].permission_signer==="reported"),I[0]&3&&(Ce.targetIdx=g[0][g[1]].idx),p.$set(Ce);const _e={};I[0]&16|I[2]&16777216&&(_e.$$scope={dirty:I,ctx:g}),!R&&I[0]&16&&(R=!0,_e.modalVisible=g[4],Le(()=>R=!1)),M.$set(_e)},i(g){if(!q){for(let I=0;I<O.length;I+=1)E(s[I]);E(k),E(L),E(d.$$.fragment,g),E(y.$$.fragment,g),E(p.$$.fragment,g),E(M.$$.fragment,g),q=!0}},o(g){for(let I=0;I<s.length;I+=1)P(s[I]);P(k),P(L),P(d.$$.fragment,g),P(y.$$.fragment,g),P(p.$$.fragment,g),P(M.$$.fragment,g),q=!1},d(g){g&&(_(e),_(t),_(f),_(w),_(m),_(h)),C&&C.d(g);for(let I=0;I<s.length;I+=1)s[I].d();k&&k.d(),L&&L.d(),l[37](null),J(d,g),J(y,g),J(p,g),J(M,g)}}}const Vl=30,Bl=10,Ot=150;function Oe(l){return"touches"in l||"changedTouches"in l}function Pl(l){return Oe(l)?[l.touches[0].clientX,l.touches[0].clientY]:[l.clientX,l.clientY]}function Ol(l,e,t){let n,s,r;bn(l,xn,u=>t(8,r=u));let{posts:i=[]}=e,{index:a=0}=e,{type:o=r.url.searchParams.get("type")}=e,{isEdit:f=!1}=e,{dontMoveVertically:d=!1}=e,{keyboardY:b=0}=e,{selectedReaction:w=void 0}=e,{hideActionButtons:y=!1}=e,x=!0,m=!1,p=!1,h=0,M=0,R={width:0,height:0},{actionSheetMoreIsOpen:q=!1}=e,{actionSheetReportIsOpen:C=!1}=e,{modalVisible:O=!1}=e;function F(u){if(!u)return!1;const V=Pe();return V!==null&&String(V)===u}let k=!1,L=!1,Y=-1,ie=-1,Q,oe=!1,he=[],fe=[],re;async function g(){In({mediaIdx:`${i[a].mediaIdx||0}`,postIdx:`${i[a].idx}`},{replace:!0})}async function I(){t(21,k=!0);const u=i.length,V=r.url.searchParams.get("userIdx"),S=r.url.searchParams.get("placeIdx"),H=`&offset=${u}`,U=`&limit=${Vl}`,ae=V?`&userIdx=${V}`:"",Me=S?`&placeIdx=${S}`:"",be=(await fetch(`${Se}/posts?${ae}${Me}${H}${U}`).then(ye=>ye.json()).then(ye=>{var et;return((et=ye.data)==null?void 0:et.posts)??[]})).map(ye=>({...ye,mediaIdx:0}));be.length===0&&t(22,L=!0),t(0,i=[...i,...be]),t(21,k=!1)}function z(u){const{height:V}=R;if(a===0&&u>0||a===i.length-1&&u<0){t(10,h=u*.3);return}t(10,h=Math.max(Math.min(u,V),-V))}function ee(u){t(9,x=!1);const V=ke(2),S=Oe(u)?u.changedTouches[0].clientY-ie:u.clientY-ie;S>V&&a>0?(t(1,a-=1),m=!0,g()):-S>V&&a<i.length-1&&(t(1,a+=1),m=!0,g()),t(10,h=0)}function Ce(u){const{width:V}=R,S=i[a].mediaIdx,H=i[a].media.length-1;if(S===0&&u>0||S===H&&u<0){t(11,M=u*.3);return}t(11,M=Math.max(Math.min(u,V),-V))}function _e(u){t(9,x=!1);const V=ke(2),S=Oe(u)?u.changedTouches[0].clientX-Y:u.clientX-Y,H=i[a].mediaIdx,U=i[a].media.length-1;S>V&&H>0?me(H-1):-S>V&&H<U&&me(H+1),t(11,M=0)}function me(u){t(0,i[a]={...i[a],mediaIdx:u},i),t(0,i=[...i]),p=!0,g()}function Ee(u){m||p||(oe=!0,Q=void 0,Oe(u)?(Y=u.touches[0].clientX,ie=u.touches[0].clientY):(Y=u.clientX,ie=u.clientY,window.addEventListener("mousemove",Ne,{passive:!1}),window.addEventListener("mouseup",je)))}function Ne(u){if(!oe||m||p)return;const[V,S]=Pl(u),H=V-Y,U=S-ie;Q===void 0&&(Q=Math.abs(U)>=Math.abs(H)?"post":"media"),!d&&Q==="post"?z(U):Q==="media"&&Ce(H)}function je(u){!oe||m||p||(oe=!1,Q==="post"?ee(u):Q==="media"&&_e(u),Oe(u)||(window.removeEventListener("mousemove",Ne),window.removeEventListener("mouseup",je)))}function Ge(u){if(m||p)return;u.preventDefault();const V=Date.now(),S=Math.abs(u.deltaX),H=Math.abs(u.deltaY);if(S>H){if(fe.push({deltaX:u.deltaX,timestamp:V}),fe=fe.filter(U=>V-U.timestamp<=Ot),fe.length>=2){const U=fe[0],ae=fe[fe.length-1];if(Math.abs(ae.deltaX)-Math.abs(U.deltaX)>=0&&Math.abs(ae.deltaX)>=30){const be=i[a].mediaIdx,ye=i[a].media.length-1;ae.deltaX>0&&be<ye?me(be+1):ae.deltaX<0&&be>0&&me(be-1),fe=[],p=!0}}}else if(he.push({deltaY:u.deltaY,timestamp:V}),he=he.filter(U=>V-U.timestamp<=Ot),he.length>=2){const U=he[0],ae=he[he.length-1];Math.abs(ae.deltaY)-Math.abs(U.deltaY)>=0&&Math.abs(ae.deltaY)>=30&&(ae.deltaY>0&&a<i.length-1?(t(9,x=!1),t(1,a+=1),g(),m=!0):ae.deltaY<0&&a>0&&(t(9,x=!1),t(1,a-=1),g(),m=!0),he=[])}}function We(u){if(m||p)return;const V=i[a].mediaIdx,S=i[a].media.length-1;switch(u.key){case"ArrowUp":a>0&&(t(9,x=!1),t(1,a--,a),m=!0,g());break;case"ArrowDown":a<i.length-1&&(t(9,x=!1),t(1,a++,a),m=!0,g());break;case"ArrowLeft":V>0&&(t(9,x=!1),p=!0,me(V-1));break;case"ArrowRight":V<S&&(t(9,x=!1),p=!0,me(V+1));break}}function Yt(){t(9,x=!0),m=!1,p=!1}function Je(){re&&t(12,R={width:re.clientWidth,height:re.clientHeight})}function Ut(){var S,H;const u=Number(r.url.searchParams.get("mediaIdx")||0),V=((H=(S=i.at(a))==null?void 0:S.media)==null?void 0:H.length)||0;u&&u<V?t(0,i[a]={...i[a],mediaIdx:u},i):t(0,i[a]={...i[a],mediaIdx:0},i),t(0,i=[...i]),g()}function Ft(){document.addEventListener("touchstart",Ee,{passive:!1}),document.addEventListener("touchmove",Ne,{passive:!1}),document.addEventListener("touchend",je),document.addEventListener("mousedown",Ee,{passive:!1}),document.addEventListener("wheel",Ge,{passive:!1}),document.addEventListener("keydown",We)}function zt(){document.removeEventListener("touchstart",Ee),document.removeEventListener("touchmove",Ne),document.removeEventListener("touchend",je),document.removeEventListener("mousedown",Ee),document.removeEventListener("wheel",Ge),document.removeEventListener("keydown",We)}Lt(()=>{Je();const u=new ResizeObserver(()=>Je());return re&&u.observe(re),Ft(),Ut(),()=>{u.disconnect()}}),Rt(()=>{zt()});function Ke(){var H;const u=qe(),V=Pe(),S=(H=i[a])==null?void 0:H.idx;!u||!V||!S||fetch(`${Se}/posts/${S}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}}).then(U=>U.json()).then(()=>ze(`/users/${V}`,{replaceState:!0,invalidateAll:!0}))}async function Qe(u){var U,ae,Me;const V=(U=i[u])==null?void 0:U.idx;if(V===void 0||f||((ae=i[u])==null?void 0:ae.needReactionReload)!==!0&&((Me=i[u])!=null&&Me.reactions))return;const S=qe(),H=await fetch(`${Se}/vote/reactions?targetTable=posts&targetId=${V}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+S}});if(H.ok){const be=await H.json();t(0,i[u].reactions=be.data.reactions,i),t(0,i[u].myReaction=be.data.myReaction,i)}}function we(u,V){const S=a,H=i[S];if((H==null?void 0:H.idx)===u){if(!nt())return H.needReactionReload=!0,xe.emit("showSignInModal",{removable:!0,callback:Cn.isNativePlatform()?()=>{Qe(S)}:void 0});H.myReaction===V?xe.emit("setReaction",{target:"posts",targetId:u,reaction:null,callback:()=>{t(0,i[S].myReaction=null,i),$e(S,V)}}):(H.myReaction&&$e(S,H.myReaction),xe.emit("setReaction",{target:"posts",targetId:u,reaction:V,callback:()=>{t(0,i[S].myReaction=V,i),i[S].reactions.some(U=>U.type===V)?t(0,i[S].reactions=i[S].reactions.map(U=>U.type===V?{...U,count:Number(U.count)+1}:U),i):t(0,i[S].reactions=[...i[S].reactions,{type:V,count:1}],i)}}))}}function $e(u,V){let S=[];for(const H of i[u].reactions)if(H.type===V){const U=Number(H.count);U>1&&S.push({...H,count:U-1})}else S.push(H);t(0,i[u].reactions=S,i)}function Xt(u){wn.call(this,l,u)}const Zt=(u,V)=>{we(u.idx,V.type)};function Gt(u,V,S,H){S[H]=u,t(0,i)}const Wt=(u,V,S,H)=>{t(0,V[S].isTextExpanded=H.detail.expanded,i)},Jt=u=>{we(u.idx,"👍")},Kt=u=>{we(u.idx,"️🔥")},Qt=u=>{we(u.idx,"😍")},$t=u=>{we(u.idx,"😋")},en=u=>{we(u.idx,"😊️️")},tn=(u,V)=>u+Number(V.count),nn=u=>{we(u.idx,u.myReaction||"❤️")},ln=(u,V,S)=>{t(0,V[S].onReactionShowcase=!0,i);const H=()=>{t(0,V[S].onReactionShowcase=!1,i),window.removeEventListener("click",H)};setTimeout(()=>{window.addEventListener("click",H)},500)},sn=()=>{if(!nt())return xe.emit("showSignInModal",{removable:!0});t(2,q=!0)};function rn(u){Be[u?"unshift":"push"](()=>{re=u,t(13,re)})}const an=()=>{var u;t(2,q=!1),ze(`/viewer/edit?type=patch&postIdx=${(u=window.location.search.split("postIdx=")[1])==null?void 0:u.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},on=()=>{t(2,q=!1),t(4,O=!0)},fn=()=>{On(r.url),isOpenActionSheet=!1},un=()=>{t(2,q=!1),t(3,C=!0)};function cn(u){q=u,t(2,q)}function dn(u){C=u,t(3,C)}const hn=()=>{t(0,i[a].permission_signer="reported",i)},mn=()=>{t(0,i[a].permission_signer=null,i)},gn=()=>{Ke(),t(4,O=!1)},pn=()=>{t(4,O=!1)};function _n(u){O=u,t(4,O)}return l.$$set=u=>{"posts"in u&&t(0,i=u.posts),"index"in u&&t(1,a=u.index),"type"in u&&t(18,o=u.type),"isEdit"in u&&t(5,f=u.isEdit),"dontMoveVertically"in u&&t(19,d=u.dontMoveVertically),"keyboardY"in u&&t(6,b=u.keyboardY),"selectedReaction"in u&&t(20,w=u.selectedReaction),"hideActionButtons"in u&&t(7,y=u.hideActionButtons),"actionSheetMoreIsOpen"in u&&t(2,q=u.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in u&&t(3,C=u.actionSheetReportIsOpen),"modalVisible"in u&&t(4,O=u.modalVisible)},l.$$.update=()=>{var u;l.$$.dirty[0]&256&&r&&g(),l.$$.dirty[0]&1048576&&w&&we(w.postIdx,w.reaction),l.$$.dirty[0]&2&&Qe(a),l.$$.dirty[0]&3&&t(23,n=(u=i[a])==null?void 0:u.user_idx),l.$$.dirty[0]&8388608&&t(14,s=F(n)),l.$$.dirty[0]&6815747&&!d&&a>=i.length-Bl&&!k&&!L&&I()},[i,a,q,C,O,f,b,y,r,x,h,M,R,re,s,Yt,Ke,we,o,d,w,k,L,n,Xt,Zt,Gt,Wt,Jt,Kt,Qt,$t,en,tn,nn,ln,sn,rn,an,on,fn,un,cn,dn,hn,mn,gn,pn,_n]}class is extends ce{constructor(e){super(),de(this,e,Ol,Ml,ue,{posts:0,index:1,type:18,isEdit:5,dontMoveVertically:19,keyboardY:6,selectedReaction:20,hideActionButtons:7,actionSheetMoreIsOpen:2,actionSheetReportIsOpen:3,modalVisible:4},null,[-1,-1,-1])}}export{is as V};
