import{w as h,g as $}from"./entry.C9m624fl.js";import{_ as le}from"./preload-helper.D6kgxu3v.js";import{l as ce}from"./scheduler.BTWb34i-.js";/*! Capacitor: https://capacitorjs.com/ - MIT License */const de=t=>{const e=new Map;e.set("web",{name:"web"});const s=t.CapacitorPlatforms||{currentPlatform:{name:"web"},platforms:e},o=(n,i)=>{s.platforms.set(n,i)},r=n=>{s.platforms.has(n)&&(s.currentPlatform=s.platforms.get(n))};return s.addPlatform=o,s.setPlatform=r,s},ue=t=>t.CapacitorPlatforms=de(t),J=ue(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});J.addPlatform;J.setPlatform;var _;(function(t){t.Unimplemented="UNIMPLEMENTED",t.Unavailable="UNAVAILABLE"})(_||(_={}));class M extends Error{constructor(e,s,o){super(e),this.message=e,this.code=s,this.data=o}}const fe=t=>{var e,s;return t!=null&&t.androidBridge?"android":!((s=(e=t==null?void 0:t.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||s===void 0)&&s.bridge?"ios":"web"},ge=t=>{var e,s,o,r,n;const i=t.CapacitorCustomPlatform||null,a=t.Capacitor||{},f=a.Plugins=a.Plugins||{},l=t.CapacitorPlatforms,S=()=>i!==null?i.name:fe(t),P=((e=l==null?void 0:l.currentPlatform)===null||e===void 0?void 0:e.getPlatform)||S,U=()=>P()!=="web",Z=((s=l==null?void 0:l.currentPlatform)===null||s===void 0?void 0:s.isNativePlatform)||U,Y=c=>{const d=k.get(c);return!!(d!=null&&d.platforms.has(P())||T(c))},N=((o=l==null?void 0:l.currentPlatform)===null||o===void 0?void 0:o.isPluginAvailable)||Y,ee=c=>{var d;return(d=a.PluginHeaders)===null||d===void 0?void 0:d.find(L=>L.name===c)},T=((r=l==null?void 0:l.currentPlatform)===null||r===void 0?void 0:r.getPluginHeader)||ee,te=c=>t.console.error(c),se=(c,d,L)=>Promise.reject(`${L} does not have an implementation of "${d}".`),k=new Map,oe=(c,d={})=>{const L=k.get(c);if(L)return console.warn(`Capacitor plugin "${c}" already registered. Cannot register plugins twice.`),L.proxy;const y=P(),j=T(c);let w;const re=async()=>(!w&&y in d?w=typeof d[y]=="function"?w=await d[y]():w=d[y]:i!==null&&!w&&"web"in d&&(w=typeof d.web=="function"?w=await d.web():w=d.web),w),ae=(u,g)=>{var m,b;if(j){const v=j==null?void 0:j.methods.find(p=>g===p.name);if(v)return v.rtype==="promise"?p=>a.nativePromise(c,g.toString(),p):(p,A)=>a.nativeCallback(c,g.toString(),p,A);if(u)return(m=u[g])===null||m===void 0?void 0:m.bind(u)}else{if(u)return(b=u[g])===null||b===void 0?void 0:b.bind(u);throw new M(`"${c}" plugin is not implemented on ${y}`,_.Unimplemented)}},C=u=>{let g;const m=(...b)=>{const v=re().then(p=>{const A=ae(p,u);if(A){const O=A(...b);return g=O==null?void 0:O.remove,O}else throw new M(`"${c}.${u}()" is not implemented on ${y}`,_.Unimplemented)});return u==="addListener"&&(v.remove=async()=>g()),v};return m.toString=()=>`${u.toString()}() { [capacitor code] }`,Object.defineProperty(m,"name",{value:u,writable:!1,configurable:!1}),m},G=C("addListener"),H=C("removeListener"),ie=(u,g)=>{const m=G({eventName:u},g),b=async()=>{const p=await m;H({eventName:u,callbackId:p},g)},v=new Promise(p=>m.then(()=>p({remove:b})));return v.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await b()},v},x=new Proxy({},{get(u,g){switch(g){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return j?ie:G;case"removeListener":return H;default:return C(g)}}});return f[c]=x,k.set(c,{name:c,proxy:x,platforms:new Set([...Object.keys(d),...j?[y]:[]])}),x},ne=((n=l==null?void 0:l.currentPlatform)===null||n===void 0?void 0:n.registerPlugin)||oe;return a.convertFileSrc||(a.convertFileSrc=c=>c),a.getPlatform=P,a.handleError=te,a.isNativePlatform=Z,a.isPluginAvailable=N,a.pluginMethodNoop=se,a.registerPlugin=ne,a.Exception=M,a.DEBUG=!!a.DEBUG,a.isLoggingEnabled=!!a.isLoggingEnabled,a.platform=a.getPlatform(),a.isNative=a.isNativePlatform(),a},pe=t=>t.Capacitor=ge(t),I=pe(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),q=I.registerPlugin;I.Plugins;class K{constructor(e){this.listeners={},this.retainedEventArguments={},this.windowListeners={},e&&(console.warn(`Capacitor WebPlugin "${e.name}" config object was deprecated in v3 and will be removed in v4.`),this.config=e)}addListener(e,s){let o=!1;this.listeners[e]||(this.listeners[e]=[],o=!0),this.listeners[e].push(s);const n=this.windowListeners[e];n&&!n.registered&&this.addWindowListener(n),o&&this.sendRetainedArgumentsForEvent(e);const i=async()=>this.removeListener(e,s);return Promise.resolve({remove:i})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,s,o){const r=this.listeners[e];if(!r){if(o){let n=this.retainedEventArguments[e];n||(n=[]),n.push(s),this.retainedEventArguments[e]=n}return}r.forEach(n=>n(s))}hasListeners(e){return!!this.listeners[e].length}registerWindowListener(e,s){this.windowListeners[s]={registered:!1,windowEventName:e,pluginEventName:s,handler:o=>{this.notifyListeners(s,o)}}}unimplemented(e="not implemented"){return new I.Exception(e,_.Unimplemented)}unavailable(e="not available"){return new I.Exception(e,_.Unavailable)}async removeListener(e,s){const o=this.listeners[e];if(!o)return;const r=o.indexOf(s);this.listeners[e].splice(r,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const s=this.retainedEventArguments[e];s&&(delete this.retainedEventArguments[e],s.forEach(o=>{this.notifyListeners(e,o)}))}}const R=t=>encodeURIComponent(t).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),z=t=>t.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class me extends K{async getCookies(){const e=document.cookie,s={};return e.split(";").forEach(o=>{if(o.length<=0)return;let[r,n]=o.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");r=z(r).trim(),n=z(n).trim(),s[r]=n}),s}async setCookie(e){try{const s=R(e.key),o=R(e.value),r=`; expires=${(e.expires||"").replace("expires=","")}`,n=(e.path||"/").replace("path=",""),i=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${s}=${o||""}${r}; path=${n}; ${i};`}catch(s){return Promise.reject(s)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(s){return Promise.reject(s)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const s of e)document.cookie=s.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}q("CapacitorCookies",{web:()=>new me});const he=async t=>new Promise((e,s)=>{const o=new FileReader;o.onload=()=>{const r=o.result;e(r.indexOf(",")>=0?r.split(",")[1]:r)},o.onerror=r=>s(r),o.readAsDataURL(t)}),we=(t={})=>{const e=Object.keys(t);return Object.keys(t).map(r=>r.toLocaleLowerCase()).reduce((r,n,i)=>(r[n]=t[e[i]],r),{})},be=(t,e=!0)=>t?Object.entries(t).reduce((o,r)=>{const[n,i]=r;let a,f;return Array.isArray(i)?(f="",i.forEach(l=>{a=e?encodeURIComponent(l):l,f+=`${n}=${a}&`}),f.slice(0,-1)):(a=e?encodeURIComponent(i):i,f=`${n}=${a}`),`${o}&${f}`},"").substr(1):null,ve=(t,e={})=>{const s=Object.assign({method:t.method||"GET",headers:t.headers},e),r=we(t.headers)["content-type"]||"";if(typeof t.data=="string")s.body=t.data;else if(r.includes("application/x-www-form-urlencoded")){const n=new URLSearchParams;for(const[i,a]of Object.entries(t.data||{}))n.set(i,a);s.body=n.toString()}else if(r.includes("multipart/form-data")||t.data instanceof FormData){const n=new FormData;if(t.data instanceof FormData)t.data.forEach((a,f)=>{n.append(f,a)});else for(const a of Object.keys(t.data))n.append(a,t.data[a]);s.body=n;const i=new Headers(s.headers);i.delete("content-type"),s.headers=i}else(r.includes("application/json")||typeof t.data=="object")&&(s.body=JSON.stringify(t.data));return s};class ye extends K{async request(e){const s=ve(e,e.webFetchExtra),o=be(e.params,e.shouldEncodeUrlParams),r=o?`${e.url}?${o}`:e.url,n=await fetch(r,s),i=n.headers.get("content-type")||"";let{responseType:a="text"}=n.ok?e:{};i.includes("application/json")&&(a="json");let f,l;switch(a){case"arraybuffer":case"blob":l=await n.blob(),f=await he(l);break;case"json":f=await n.json();break;case"document":case"text":default:f=await n.text()}const S={};return n.headers.forEach((P,U)=>{S[U]=P}),{data:f,headers:S,status:n.status,url:n.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}q("CapacitorHttp",{web:()=>new ye});const V=q("SocialLogin",{web:()=>le(()=>import("./web.C1mvpO5y.js"),[],import.meta.url).then(t=>new t.SocialLoginWeb)}),Pe="https://basemap.surflux.studio/geoserver",Oe=`${Pe}/gwc/service/tms/1.0.0/bluedot:base_building@EPSG%3A900913@pbf/{z}/{x}/{-y}.pbf`,$e="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_railway_900913_241127.json",Ue="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_station_900913_241127.json",ke="https://bluedot-subway.s3.ap-northeast-2.amazonaws.com/base_subway_entrance_900913_241127.json";var Q=(t=>(t[t.MobileS=320]="MobileS",t[t.MobileM=375]="MobileM",t[t.MobileL=425]="MobileL",t[t.Tablet=768]="Tablet",t[t.Laptop=1024]="Laptop",t[t.LaptopL=1440]="LaptopL",t[t.FourK=2560]="FourK",t))(Q||{});const B="https://api.bluedot.land",Ce="https://d1egcbbnpo4gtd.cloudfront.net",xe={public:"공개",follower:"팔로워 공개",private:"비공개"},Me={owner:"소유자",manager:"관리 권한",writer:"편집 권한",reader:"읽기 권한",none:"권한 없음"};function Le(t){return{all:t=t||new Map,on:function(e,s){var o=t.get(e);o?o.push(s):t.set(e,[s])},off:function(e,s){var o=t.get(e);o&&(s?o.splice(o.indexOf(s)>>>0,1):t.set(e,[]))},emit:function(e,s){var o=t.get(e);o&&o.slice().map(function(r){r(s)}),(o=t.get("*"))&&o.slice().map(function(r){r(e,s)})}}}const je=Le(),We=h(void 0),Be=h(Q.MobileM),De=h([]),qe=h(!1),Ee=h([]),Fe=h([]),D=h(!1),Te=h(!1),Ge=h([]),He=h(!1),W=I.getPlatform();async function Re(){V.initialize({google:{iOSClientId:"298551622119-6r1e3ji2e6vdioqarf2pg3g6brvd47od.apps.googleusercontent.com",webClientId:"298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com"}})}async function ze(){var t;if(W==="ios"||W==="android"){const s=(await V.login({provider:"google",options:{scopes:["email","profile"]}})).result,r=await(await fetch(`${B}/auth/oauth/google/user`,{method:"POST",body:JSON.stringify({name:s.profile.name,email:s.profile.email,picture:s.profile.imageUrl})})).json();if(!((t=r==null?void 0:r.data)!=null&&t.access))throw je.emit("pushSnackbar",{message:"로그인에 실패했습니다."}),Error("Failed to sign in");const n=r.data.access;X(n)}else if(W==="web"){const e="298551622119-gg1fqk381om4384l71ju7ip4857cqbh1.apps.googleusercontent.com",s=`${B}/auth/oauth/google`,o="email profile",r="code",n=encodeURIComponent(window.location.href),i=`https://accounts.google.com/o/oauth2/v2/auth?response_type=${r}&client_id=${e}&redirect_uri=${s}&scope=${o}&state=${n}`;location.replace(i)}else throw Error("Not supported platform")}function Je(){localStorage.removeItem("jwt"),localStorage.removeItem("saveSignLocal"),sessionStorage.removeItem("jwt")}function E(){try{const t=sessionStorage.getItem("jwt")||localStorage.getItem("jwt")||null;if(!t)throw new Error("jwt not found");if(ce(D)===!0&&!window.location.pathname.startsWith("/users/sign-up/")&&!window.location.pathname.startsWith("/tp/"))return console.log("A"),$("/users/sign-up/agreement"),null;const e=F(t);if(e.exp&&Math.floor(Date.now()/1e3)>e.exp)throw new Error("jwt expired");return e.sig===!1&&!window.location.pathname.startsWith("/users/sign-up")&&!window.location.pathname.startsWith("/tp")?(D.set(!0),console.log("B"),$("/users/sign-up/agreement"),null):t}catch(t){return console.warn(t),localStorage.removeItem("jwt"),sessionStorage.removeItem("jwt"),null}}function _e(){const t=E();return t?F(t):null}function Ke(){const t=_e();return t?BigInt(t.sub):null}function X(t){localStorage.getItem("saveSignLocal")==="true"&&localStorage.setItem("jwt",t),sessionStorage.setItem("jwt",t)}async function Ve(t){const e=t.searchParams.get("access");if(e){X(e);const s=F(e).sig;if(t.searchParams.delete("access"),t.searchParams.delete("refresh"),s===!1){D.set(!0),await $("/users/sign-up/agreement");return}await $(t.toString(),{replaceState:!0,invalidateAll:!1})}}function F(t){const s=t.split(".")[1].replace(/-/g,"+").replace(/_/g,"/"),o=decodeURIComponent(atob(s).split("").map(function(r){return"%"+("00"+r.charCodeAt(0).toString(16)).slice(-2)}).join(""));return JSON.parse(o)}function Qe(){return E()!==null}async function Xe(t){return(await(await fetch(`${B}/auth/users/${t}`,{headers:{Authorization:`Bearer ${E()}`}})).json()).data}export{B as A,$e as B,I as C,Ue as D,ke as E,Pe as G,Oe as P,Q as S,K as W,Ge as a,Ke as b,D as c,Te as d,je as e,X as f,E as g,Ee as h,Qe as i,He as j,_e as k,Me as l,xe as m,De as n,Ce as o,Xe as p,Je as q,q as r,Fe as s,qe as t,M as u,Ve as v,Be as w,ze as x,Re as y,We as z};
