import{s as ue,D as re,i as F,f as _,e as y,a as q,t as be,c as T,b as O,g as j,d as ve,v as h,h as w,A as H,j as Ae,z as ne,I as Ze,C as ee,n as $,q as Ce,r as Ie,E as Se,F as we,ae as We,B as Ge,K as Xe,w as Ee,x as Oe,y as qt,T as yl,M as jt,Q as it,k as rt,U as Tl,G as Dl,J as Ml}from"./scheduler.CIbz-4tf.js";import{S as ce,i as de,t as C,g as te,a as P,e as le,c as K,d as W,m as G,f as J,b as Re}from"./index.gvaMc9LH.js";import{e as pe,u as Je,f as Vl,o as Ut}from"./each.Cdd7o6io.js";import{e as _e,A as Le,l as at,I as Ue}from"./store.BzckxxOx.js";import{g as Ke}from"./entry.RcmwbxGf.js";import{p as Pl}from"./stores.OtNRuzR7.js";import{g as He,u as Bl}from"./searchParams.C2Y2YKdR.js";/* empty css                                                     *//* empty css                                                  */import{f as Ol,u as Rl}from"./follow.BUqMJ0gL.js";import{a as Ve,b as Xt,g as ze,i as ot}from"./sign.wYJIuXCh.js";import{C as Ll}from"./CircleImage.CZpdYjea.js";import{g as ft}from"./color.C_Jm4JAr.js";import{s as ut}from"./s32cloudfront.B2Ym_IS4.js";import{r as xe}from"./units.BJZU6p1c.js";import"./ActionSheet.svelte_svelte_type_style_lang.BTYINn54.js";import{i as Sl}from"./device.f1MsHf-I.js";import"./index.BPRJxokv.js";import{a as Al}from"./NavigationBar.DpgCmbT4.js";import{C as zt}from"./Chip.Bhn0E_B1.js";import{B as Nl}from"./BottomNavigationPadder.DZXK5bTM.js";import{C as Fl,I as ql,a as jl}from"./ChipInstagram.CIMm6hR7.js";import{l as Ul}from"./longPress.C9F0mLoM.js";import{I as Xl}from"./IconMore.BQ1nArCe.js";import{A as Yt,o as zl,a as Yl}from"./ActionSheet.BmkAg57H.js";import{M as Hl}from"./Modal.BvZgPIL7.js";import{f as Zl,c as Kl,a as Wl}from"./ActionSheetReport.svelte_svelte_type_style_lang.Bi0biItC.js";import{F as Gl}from"./Figure.DPxCDW48.js";import{w as Jl,I as Ql}from"./utils.CbERlKJc.js";function ct(n){let e,t,l,s,a,r,f=n[0].unique_name+"",i,o,c,p=String(n[0].user_idx)!==String(Ve()),b,I,R;const E=[en,$l],m=[];function d(k,B){return k[0].profile_image_url?0:1}t=d(n),l=m[t]=E[t](n);let g=p&&dt(n);return{c(){e=y("div"),l.c(),s=q(),a=y("div"),r=y("div"),i=be(f),o=q(),c=y("div"),g&&g.c(),this.h()},l(k){e=T(k,"DIV",{class:!0});var B=O(e);l.l(B),s=j(B),a=T(B,"DIV",{class:!0});var x=O(a);r=T(x,"DIV",{class:!0});var S=O(r);i=ve(S,f),S.forEach(_),o=j(x),c=T(x,"DIV",{class:!0});var N=O(c);g&&g.l(N),N.forEach(_),x.forEach(_),B.forEach(_),this.h()},h(){h(r,"class","text-sm text-white"),h(c,"class","flex gap-1 items-center"),h(a,"class","flex gap-1 items-center"),h(e,"class","flex gap-[0.625rem] justify-center items-center")},m(k,B){F(k,e,B),m[t].m(e,null),w(e,s),w(e,a),w(a,r),w(r,i),w(a,o),w(a,c),g&&g.m(c,null),b=!0,I||(R=H(r,"click",n[7]),I=!0)},p(k,B){let x=t;t=d(k),t===x?m[t].p(k,B):(te(),P(m[x],1,1,()=>{m[x]=null}),le(),l=m[t],l?l.p(k,B):(l=m[t]=E[t](k),l.c()),C(l,1),l.m(e,s)),(!b||B&1)&&f!==(f=k[0].unique_name+"")&&Ae(i,f),B&1&&(p=String(k[0].user_idx)!==String(Ve())),p?g?g.p(k,B):(g=dt(k),g.c(),g.m(c,null)):g&&(g.d(1),g=null)},i(k){b||(C(l),b=!0)},o(k){P(l),b=!1},d(k){k&&_(e),m[t].d(),g&&g.d(),I=!1,R()}}}function $l(n){var f;let e,t,l=(((f=n[0].unique_name)==null?void 0:f.at(0))??"u")+"",s,a,r;return{c(){e=y("div"),t=y("span"),s=be(l),this.h()},l(i){e=T(i,"DIV",{class:!0,style:!0});var o=O(e);t=T(o,"SPAN",{class:!0});var c=O(t);s=ve(c,l),c.forEach(_),o.forEach(_),this.h()},h(){h(t,"class","text-base font-semibold text-black"),h(e,"class","w-[1.625rem] h-[1.625rem] flex items-center justify-center rounded-full"),ee(e,"background-color",ft(n[0].unique_name))},m(i,o){F(i,e,o),w(e,t),w(t,s),a||(r=H(e,"click",n[6]),a=!0)},p(i,o){var c;o&1&&l!==(l=(((c=i[0].unique_name)==null?void 0:c.at(0))??"u")+"")&&Ae(s,l),o&1&&ee(e,"background-color",ft(i[0].unique_name))},i:$,o:$,d(i){i&&_(e),a=!1,r()}}}function en(n){let e,t;return e=new Ll({props:{src:ut(n[0].profile_image_url,500),width:"1.625rem",strokeColor:"white",strokeWidth:"0"}}),e.$on("click",n[5]),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.src=ut(l[0].profile_image_url,500)),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function dt(n){let e,t="•",l,s,a=n[0].is_following?"팔로잉":"팔로우",r,f,i,o;return{c(){e=y("div"),e.textContent=t,l=q(),s=y("div"),r=be(a),this.h()},l(c){e=T(c,"DIV",{class:!0,"data-svelte-h":!0}),ne(e)!=="svelte-168vif2"&&(e.textContent=t),l=j(c),s=T(c,"DIV",{class:!0});var p=O(s);r=ve(p,a),p.forEach(_),this.h()},h(){h(e,"class","text-xs text-white/60"),h(s,"class",f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)},m(c,p){F(c,e,p),F(c,l,p),F(c,s,p),w(s,r),i||(o=H(s,"click",function(){Ze(n[0].is_following?n[2]:n[1])&&(n[0].is_following?n[2]:n[1]).apply(this,arguments)}),i=!0)},p(c,p){n=c,p&1&&a!==(a=n[0].is_following?"팔로잉":"팔로우")&&Ae(r,a),p&1&&f!==(f=`text-[0.8125rem] ${n[0].is_following?"text-gray-500":"text-[#3490FF]"}`)&&h(s,"class",f)},d(c){c&&(_(e),_(l),_(s)),i=!1,o()}}}function tn(n){let e,t,l=n[0].idx&&n[0].unique_name&&ct(n);return{c(){l&&l.c(),e=re()},l(s){l&&l.l(s),e=re()},m(s,a){l&&l.m(s,a),F(s,e,a),t=!0},p(s,[a]){s[0].idx&&s[0].unique_name?l?(l.p(s,a),a&1&&C(l,1)):(l=ct(s),l.c(),C(l,1),l.m(e.parentNode,e)):l&&(te(),P(l,1,1,()=>{l=null}),le())},i(s){t||(C(l),t=!0)},o(s){P(l),t=!1},d(s){s&&_(e),l&&l.d(s)}}}function ln(n,e,t){let{post:l}=e,{allowFollow:s=!0}=e,{whenCancelFollow:a=()=>{}}=e,r=!1;async function f(){if(!s)return a();r||(r=!0,await Ol({targetIdx:l.user_idx,subjectIdx:Ve()}),t(0,l.is_following=!0,l),r=!1)}async function i(){if(!s)return a();r||(r=!0,await Rl({targetIdx:l.user_idx,subjectIdx:Ve()}),t(0,l.is_following=!1,l),r=!1)}const o=()=>{He(`/users/${l.user_idx}`)},c=()=>{He(`/users/${l.user_idx}`)},p=()=>{He(`/users/${l.user_idx}`)};return n.$$set=b=>{"post"in b&&t(0,l=b.post),"allowFollow"in b&&t(3,s=b.allowFollow),"whenCancelFollow"in b&&t(4,a=b.whenCancelFollow)},[l,f,i,s,a,o,c,p]}class nn extends ce{constructor(e){super(),de(this,e,ln,tn,ue,{post:0,allowFollow:3,whenCancelFollow:4})}}function sn(n){let e,t,l,s;return{c(){e=Ce("svg"),t=Ce("path"),l=Ce("path"),this.h()},l(a){e=Ie(a,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0,fill:!0});var r=O(e);t=Ie(r,"path",{d:!0,fill:!0}),O(t).forEach(_),l=Ie(r,"path",{d:!0,stroke:!0,"stroke-width":!0,"stroke-linejoin":!0}),O(l).forEach(_),r.forEach(_),this.h()},h(){h(t,"d","M11.9996 14.3636C11.7585 14.3636 11.5273 14.2679 11.3568 14.0974C11.1863 13.9269 11.0906 13.6957 11.0906 13.4545L11.0906 8.90909C11.0906 8.66798 11.1863 8.43675 11.3568 8.26627C11.5273 8.09578 11.7585 8 11.9996 8C12.2408 8 12.472 8.09578 12.6425 8.26627C12.813 8.43675 12.9087 8.66798 12.9087 8.90909L12.9087 13.4545C12.9087 13.6957 12.813 13.9269 12.6425 14.0974C12.472 14.2679 12.2408 14.3636 11.9996 14.3636ZM10.636 16.6364C10.636 16.2747 10.7797 15.9279 11.0354 15.6721C11.2911 15.4164 11.638 15.2727 11.9996 15.2727C12.3613 15.2727 12.7082 15.4164 12.9639 15.6721C13.2196 15.9279 13.3633 16.2747 13.3633 16.6364C13.3633 16.998 13.2196 17.3449 12.9639 17.6006C12.7082 17.8563 12.3613 18 11.9996 18C11.638 18 11.2911 17.8563 11.0354 17.6006C10.7797 17.3449 10.636 16.998 10.636 16.6364Z"),h(t,"fill",n[0]),h(l,"d","M13.732 4C12.9623 2.66667 11.0378 2.66667 10.268 4L2.47372 17.5C1.70392 18.8333 2.66617 20.5 4.20577 20.5H19.7942C21.3338 20.5 22.2961 18.8333 21.5263 17.5L13.732 4Z"),h(l,"stroke",n[1]),h(l,"stroke-width","2"),h(l,"stroke-linejoin","round"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"width",n[2]),h(e,"height",n[2]),h(e,"viewBox",s="0 0 "+n[2]+" "+n[2]),h(e,"fill","none")},m(a,r){F(a,e,r),w(e,t),w(e,l)},p(a,[r]){r&1&&h(t,"fill",a[0]),r&2&&h(l,"stroke",a[1]),r&4&&h(e,"width",a[2]),r&4&&h(e,"height",a[2]),r&4&&s!==(s="0 0 "+a[2]+" "+a[2])&&h(e,"viewBox",s)},i:$,o:$,d(a){a&&_(e)}}}function rn(n,e,t){let l,{fill:s="#FF4F1E"}=e,{stroke:a="#FF4F1E"}=e,{length:r=1.5}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"stroke"in f&&t(1,a=f.stroke),"length"in f&&t(3,r=f.length)},n.$$.update=()=>{n.$$.dirty&8&&t(2,l=xe(r))},[s,a,l,r]}class an extends ce{constructor(e){super(),de(this,e,rn,sn,ue,{fill:0,stroke:1,length:3})}}function Ye(n){const t=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const s=a=>a.stopPropagation();return n.addEventListener(l,s),{event:l,handler:s}});return{destroy(){t.forEach(({event:l,handler:s})=>{n.removeEventListener(l,s)})}}}function ht(n){let e,t;return e=new zt({props:{prefixLength:1.25,textSize:"text-xs",textColor:"text-white",backgroundColor:"bg-[rgb(56,56,56)]/30",borderColor:"border-[rgb(56,56,56)]/10",border:!0,pointer:!0,prefixIconComponent:Al,fill:"white",padding:"px-[0.88rem] py-[0.5rem]",value:n[0].name}}),e.$on("click",n[1]),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s&1&&(a.value=l[0].name),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function on(n){let e,t,l=n[0].idx&&ht(n);return{c(){l&&l.c(),e=re()},l(s){l&&l.l(s),e=re()},m(s,a){l&&l.m(s,a),F(s,e,a),t=!0},p(s,[a]){s[0].idx?l?(l.p(s,a),a&1&&C(l,1)):(l=ht(s),l.c(),C(l,1),l.m(e.parentNode,e)):l&&(te(),P(l,1,1,()=>{l=null}),le())},i(s){t||(C(l),t=!0)},o(s){P(l),t=!1},d(s){s&&_(e),l&&l.d(s)}}}function fn(n,e,t){let{place:l}=e;const s=async()=>{await Ke(`/places/${l.idx}`)};return n.$$set=a=>{"place"in a&&t(0,l=a.place)},[l,s]}class un extends ce{constructor(e){super(),de(this,e,fn,on,ue,{place:0})}}function cn(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=O(e);t=Ie(s,"path",{d:!0}),O(t).forEach(_),s.forEach(_),this.h()},h(){h(t,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",n[1]),h(e,"height",n[1]),h(e,"fill",n[0])},m(l,s){F(l,e,s),w(e,t)},p(l,[s]){s&2&&h(e,"width",l[1]),s&2&&h(e,"height",l[1]),s&1&&h(e,"fill",l[0])},i:$,o:$,d(l){l&&_(e)}}}function dn(n,e,t){let l,{fill:s="#5f6368"}=e,{length:a="1.75"}=e,{alt:r="Edit"}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,a=f.length),"alt"in f&&t(3,r=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=xe(a))},[s,l,a,r]}class hn extends ce{constructor(e){super(),de(this,e,dn,cn,ue,{fill:0,length:2,alt:3})}}function mn(n){let e,t;return{c(){e=Ce("svg"),t=Ce("path"),this.h()},l(l){e=Ie(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var s=O(e);t=Ie(s,"path",{d:!0}),O(t).forEach(_),s.forEach(_),this.h()},h(){h(t,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),h(e,"xmlns","http://www.w3.org/2000/svg"),h(e,"viewBox","0 -960 960 960"),h(e,"width",n[1]),h(e,"height",n[1]),h(e,"fill",n[0])},m(l,s){F(l,e,s),w(e,t)},p(l,[s]){s&2&&h(e,"width",l[1]),s&2&&h(e,"height",l[1]),s&1&&h(e,"fill",l[0])},i:$,o:$,d(l){l&&_(e)}}}function pn(n,e,t){let l,{fill:s="#5f6368"}=e,{length:a="1.75"}=e,{alt:r="Delete"}=e;return n.$$set=f=>{"fill"in f&&t(0,s=f.fill),"length"in f&&t(2,a=f.length),"alt"in f&&t(3,r=f.alt)},n.$$.update=()=>{n.$$.dirty&4&&t(1,l=xe(a))},[s,l,a,r]}class gn extends ce{constructor(e){super(),de(this,e,pn,mn,ue,{fill:0,length:2,alt:3})}}function _n(n){let e,t=(n[0].text||"")+"",l,s,a;return{c(){e=y("p"),l=be(t),this.h()},l(r){e=T(r,"P",{class:!0,style:!0});var f=O(e);l=ve(f,t),f.forEach(_),this.h()},h(){h(e,"class","text-xs text-shadow whitespace-pre-line w-full overflow-hidden max-w-full break-words"),h(e,"style",`
      overflow: hidden;
      height: ${n[1]}px;
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 1;
      max-width: 100%;
      width: 100%;
      word-break: break-all;
    `)},m(r,f){F(r,e,f),w(e,l),s||(a=[Se(Ye.call(null,e)),H(e,"click",n[2])],s=!0)},p(r,[f]){f&1&&t!==(t=(r[0].text||"")+"")&&Ae(l,t)},i:$,o:$,d(r){r&&_(e),s=!1,we(a)}}}function bn(n,e,t){const l=We();let{post:s}=e;const a=xe(1),r=xe(6);function f(i){const o=i.currentTarget;if(o)if(o.style.height===`${a}px`||!o.style.height){if(o.scrollHeight>a){const c=o.scrollHeight<r?o.scrollHeight:r;o.style.height=`${c}px`,o.style.overflow="scroll",o.style.display="block",o.style.webkitLineClamp="unset",l("textExpanded",{expanded:!0})}}else o.style.height=`${a}px`,o.style.overflow="hidden",o.style.display="-webkit-box",o.style.webkitLineClamp="1",l("textExpanded",{expanded:!1})}return Ge(()=>{l("textExpanded",{expanded:!1})}),n.$$set=i=>{"post"in i&&t(0,s=i.post)},[s,a,f]}class vn extends ce{constructor(e){super(),de(this,e,bn,_n,ue,{post:0})}}function wn(n){let e;return{c(){e=y("div"),this.h()},l(t){e=T(t,"DIV",{class:!0,style:!0}),O(e).forEach(_),this.h()},h(){h(e,"class","fixed left-0 top-0 w-full h-full pointer-events-none z-30"),ee(e,"opacity","0.6"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.16) -55.96%, rgba(0, 0, 0, 0.00) 55.55%), linear-gradient(180deg, rgba(0, 0, 0, 0.00) 58.49%, rgba(0, 0, 0, 0.50) 140.82%)")},m(t,l){F(t,e,l)},d(t){t&&_(e)}}}function kn(n){let e;return{c(){e=y("div"),this.h()},l(t){e=T(t,"DIV",{class:!0,style:!0}),O(e).forEach(_),this.h()},h(){h(e,"class","fixed inset-0 pointer-events-none z-30"),ee(e,"opacity","0.7"),ee(e,"background","linear-gradient(180deg, rgba(0, 0, 0, 0.00) 0%, #000 100%)")},m(t,l){F(t,e,l)},d(t){t&&_(e)}}}function Cn(n){let e;function t(a,r){return a[0]?kn:wn}let l=t(n),s=l(n);return{c(){s.c(),e=re()},l(a){s.l(a),e=re()},m(a,r){s.m(a,r),F(a,e,r)},p(a,[r]){l!==(l=t(a))&&(s.d(1),s=l(a),s&&(s.c(),s.m(e.parentNode,e)))},i:$,o:$,d(a){a&&_(e),s.d(a)}}}function In(n,e,t){let{isTextExpanded:l=!1}=e;return n.$$set=s=>{"isTextExpanded"in s&&t(0,l=s.isTextExpanded)},[l]}class En extends ce{constructor(e){super(),de(this,e,In,Cn,ue,{isTextExpanded:0})}}function mt(n,e,t){const l=n.slice();return l[5]=e[t],l[7]=t,l}function pt(n,e){let t,l,s,a,r,f=$;return{key:n,first:null,c(){t=y("span"),l=y("span"),a=q(),this.h()},l(i){t=T(i,"SPAN",{class:!0,style:!0});var o=O(t);l=T(o,"SPAN",{class:!0,style:!0}),O(l).forEach(_),a=j(o),o.forEach(_),this.h()},h(){h(l,"class",s=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd"),ee(l,"transform","scale("+e[4](e[7])+")"),ee(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s"),h(t,"class","flex items-center justify-center"),ee(t,"width","0.375rem"),ee(t,"height","0.375rem"),this.first=t},m(i,o){F(i,t,o),w(t,l),w(t,a)},p(i,o){e=i,o&13&&s!==(s=Xe(`carousel-dot block w-full h-full rounded-full transition-transform duration-300 ${e[0].mediaIdx===e[2]+e[7]?"bg-white z-10":"bg-white/50"}`)+" svelte-m8istd")&&h(l,"class",s),o&8&&ee(l,"transform","scale("+e[4](e[7])+")"),o&13&&ee(l,"transition-delay",e[0].mediaIdx===e[2]+e[7]?"0s":"0.1s")},r(){r=t.getBoundingClientRect()},f(){Zl(t),f()},a(){f(),f=Kl(t,r,Wl,{})},d(i){i&&_(t)}}}function xn(n){let e,t=[],l=new Map,s,a=pe(n[3]);const r=f=>f[5];for(let f=0;f<a.length;f+=1){let i=mt(n,a,f),o=r(i);l.set(o,t[f]=pt(o,i))}return{c(){e=y("div");for(let f=0;f<t.length;f+=1)t[f].c();this.h()},l(f){e=T(f,"DIV",{class:!0});var i=O(e);for(let o=0;o<t.length;o+=1)t[o].l(i);i.forEach(_),this.h()},h(){h(e,"class",s=Xe(`
    ${n[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")},m(f,i){F(f,e,i);for(let o=0;o<t.length;o+=1)t[o]&&t[o].m(e,null)},p(f,[i]){if(i&29){a=pe(f[3]);for(let o=0;o<t.length;o+=1)t[o].r();t=Je(t,i,r,1,f,a,l,e,Vl,pt,null,mt);for(let o=0;o<t.length;o+=1)t[o].a()}i&2&&s!==(s=Xe(`
    ${f[1]?"fixed left-1/2 -translate-x-1/2 bottom-[10.3125rem]":""} 
    flex justify-center gap-1.5
  `)+" svelte-m8istd")&&h(e,"class",s)},i:$,o:$,d(f){f&&_(e);for(let i=0;i<t.length;i+=1)t[i].d()}}}const Me=7;function yn(n,e,t){let{post:l}=e,{fixed:s=!0}=e,a=[],r=0;function f(i){const o=l.mediaIdx-r,c=a.length;if(c<=1)return 1;const p=Math.max(o,c-1-o);return p===0?1:1-Math.abs(i-o)/p*.5}return n.$$set=i=>{"post"in i&&t(0,l=i.post),"fixed"in i&&t(1,s=i.fixed)},n.$$.update=()=>{n.$$.dirty&5&&(l.media.length>Me?(l.mediaIdx<=Math.floor(Me/2)?t(2,r=0):l.mediaIdx>=l.media.length-Math.ceil(Me/2)?t(2,r=l.media.length-Me):t(2,r=l.mediaIdx-Math.floor(Me/2)),t(3,a=l.media.slice(r,r+Me))):(t(2,r=0),t(3,a=l.media)))},[l,s,r,a,f]}class Ht extends ce{constructor(e){super(),de(this,e,yn,xn,ue,{post:0,fixed:1})}}function gt(n,e,t){const l=n.slice();return l[16]=e[t].text,l[17]=e[t].value,l[18]=e[t].custom,l[20]=t,l}function _t(n){let e,t,l,s,a=n[16]+"",r,f,i,o;return{c(){e=y("label"),t=y("input"),l=q(),s=y("span"),r=be(a),f=q(),this.h()},l(c){e=T(c,"LABEL",{class:!0});var p=O(e);t=T(p,"INPUT",{type:!0,name:!0,class:!0}),l=j(p),s=T(p,"SPAN",{class:!0});var b=O(s);r=ve(b,a),b.forEach(_),f=j(p),p.forEach(_),this.h()},h(){h(t,"type","radio"),h(t,"name","report"),h(t,"class","w-6 h-6 svelte-1wjrpwl"),t.value=n[17],h(s,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"class","flex gap-2 py-2")},m(c,p){F(c,e,p),w(e,t),w(e,l),w(e,s),w(s,r),w(e,f),i||(o=H(t,"change",n[8]),i=!0)},p:$,d(c){c&&_(e),i=!1,o()}}}function bt(n){let e,t,l,s;return{c(){e=y("div"),t=y("textarea"),this.h()},l(a){e=T(a,"DIV",{class:!0});var r=O(e);t=T(r,"TEXTAREA",{class:!0,style:!0,placeholder:!0}),O(t).forEach(_),r.forEach(_),this.h()},h(){h(t,"class","w-full p-3.5 border-0 rounded-[0.25rem] bg-[#2C2C2E] text-white placeholder:text-[#757D86] text-sm font-normal focus:outline-none focus:ring-0 appearance-none "),ee(t,"-webkit-tap-highlight-color","transparent"),h(t,"placeholder","이 게시물을 신고하는 다른 이유가 있다면 자유롭게 적어주세요. (선택)"),h(e,"class","px-5 py-2.5")},m(a,r){F(a,e,r),w(e,t),n[9](t),it(t,n[3]),l||(s=H(t,"input",n[10]),l=!0)},p(a,r){r&8&&it(t,a[3])},d(a){a&&_(e),n[9](null),l=!1,s()}}}function Tn(n){let e,t,l="게시물 신고 사유",s,a,r,f,i,o,c="취소",p,b,I="신고",R,E,m=pe(n[4]),d=[];for(let k=0;k<m.length;k+=1)d[k]=_t(gt(n,m,k));let g=n[1]==="etc"&&bt(n);return{c(){e=y("div"),t=y("heading"),t.textContent=l,s=q(),a=y("div");for(let k=0;k<d.length;k+=1)d[k].c();r=q(),g&&g.c(),f=q(),i=y("div"),o=y("button"),o.textContent=c,p=q(),b=y("button"),b.textContent=I,this.h()},l(k){e=T(k,"DIV",{class:!0});var B=O(e);t=T(B,"HEADING",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-z3puxq"&&(t.textContent=l),s=j(B),a=T(B,"DIV",{class:!0});var x=O(a);for(let N=0;N<d.length;N+=1)d[N].l(x);x.forEach(_),r=j(B),g&&g.l(B),f=j(B),i=T(B,"DIV",{class:!0});var S=O(i);o=T(S,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(o)!=="svelte-xb8aop"&&(o.textContent=c),p=j(S),b=T(S,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(b)!=="svelte-1fehi46"&&(b.textContent=I),S.forEach(_),B.forEach(_),this.h()},h(){h(t,"class","px-5 py-2.5 font-semibold text-white text-[0.9375rem]"),h(a,"class","px-5"),h(o,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#F1F1F1] text-sm"),h(b,"class","bg-[#2C2C2E] w-full px-5 py-2.5 rounded-[3.125rem] flex justify-center items-center text-[#FF4F1E] text-sm"),h(i,"class","flex gap-2.5 w-full px-5 py-2.5 justify-between"),h(e,"class","flex flex-col gap-2.5")},m(k,B){F(k,e,B),w(e,t),w(e,s),w(e,a);for(let x=0;x<d.length;x+=1)d[x]&&d[x].m(a,null);w(e,r),g&&g.m(e,null),w(e,f),w(e,i),w(i,o),w(i,p),w(i,b),R||(E=[H(o,"click",n[11]),H(b,"click",n[5]),Se(Ye.call(null,e))],R=!0)},p(k,B){if(B&18){m=pe(k[4]);let x;for(x=0;x<m.length;x+=1){const S=gt(k,m,x);d[x]?d[x].p(S,B):(d[x]=_t(S),d[x].c(),d[x].m(a,null))}for(;x<d.length;x+=1)d[x].d(1);d.length=m.length}k[1]==="etc"?g?g.p(k,B):(g=bt(k),g.c(),g.m(e,f)):g&&(g.d(1),g=null)},d(k){k&&_(e),jt(d,k),g&&g.d(),R=!1,we(E)}}}function Dn(n){let e,t,l;function s(r){n[12](r)}let a={noHandle:!0,fixed:!0,$$slots:{default:[Tn]},$$scope:{ctx:n}};return n[0]!==void 0&&(a.isOpen=n[0]),e=new Yt({props:a}),Ee.push(()=>Re(e,"isOpen",s)),{c(){K(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,f){G(e,r,f),l=!0},p(r,[f]){const i={};f&2097167&&(i.$$scope={dirty:f,ctx:r}),!t&&f&1&&(t=!0,i.isOpen=r[0],Oe(()=>t=!1)),e.$set(i)},i(r){l||(C(e.$$.fragment,r),l=!0)},o(r){P(e.$$.fragment,r),l=!1},d(r){J(e,r)}}}function Mn(n,e,t){const l=We();let{isOpen:s}=e,{selectedValue:a=""}=e,{targetTable:r=""}=e,{targetIdx:f=""}=e,i=null;const o=[{text:"스팸, 사기 또는 악용",value:"spam"},{text:"허위 정보",value:"false"},{text:"부적절한 내용",value:"inappropriate"},{text:"저작권 침해",value:"copyright"},{text:"개인정보 유출 또는 사생활 침해",value:"privacy"},{text:"폭력, 혐오 또는 학대",value:"violence"},{text:"불법 행위 조장",value:"illegal"},{text:"성적 행위",value:"sexual"},{text:"아동 학대 및 착취",value:"child"},{text:"기타",value:"etc"}];let c="",p=!1;function b(){yl().then(()=>{i==null||i.scrollIntoView({behavior:"smooth",block:"start"})})}qt(()=>{zl(()=>{},b,()=>{})}),Ge(()=>{Yl()});async function I(){const k=o.findIndex(B=>B.value===a);if(k===-1){alert("신고 사유를 선택해주세요.");return}if(!p){p=!0,_e.emit("loading",!0);try{const B=o[k],x=new URL(`${Le}/auth/permissions`);x.searchParams.set("targetTable",r),x.searchParams.set("targetIdx",f),x.searchParams.set("relation","reported"),x.searchParams.set("subjectTable","users"),x.searchParams.set("subjectIdx",Xt().sub),x.searchParams.set("metadata",JSON.stringify({...B,customReason:c})),t(0,s=!1),t(3,c=""),await fetch(x,{method:"PUT",headers:{Authorization:`Bearer ${ze()}`}}),l("reported")}finally{p=!1,_e.emit("loading",!1)}}}const R=k=>{t(1,a=k.target.value)};function E(k){Ee[k?"unshift":"push"](()=>{i=k,t(2,i)})}function m(){c=this.value,t(3,c)}const d=()=>{t(0,s=!1)};function g(k){s=k,t(0,s)}return n.$$set=k=>{"isOpen"in k&&t(0,s=k.isOpen),"selectedValue"in k&&t(1,a=k.selectedValue),"targetTable"in k&&t(6,r=k.targetTable),"targetIdx"in k&&t(7,f=k.targetIdx)},[s,a,i,c,o,I,r,f,R,E,m,d,g]}class Vn extends ce{constructor(e){super(),de(this,e,Mn,Dn,ue,{isOpen:0,selectedValue:1,targetTable:6,targetIdx:7})}}function vt(n){let e,t,l,s="이 게시물을 신고해 주셔서 감사합니다.",a,r,f="신고 취소하기",i,o;return{c(){e=y("div"),t=y("div"),l=y("div"),l.textContent=s,a=q(),r=y("div"),r.textContent=f,this.h()},l(c){e=T(c,"DIV",{class:!0});var p=O(e);t=T(p,"DIV",{class:!0});var b=O(t);l=T(b,"DIV",{class:!0,"data-svelte-h":!0}),ne(l)!=="svelte-179ijsk"&&(l.textContent=s),a=j(b),r=T(b,"DIV",{class:!0,"data-svelte-h":!0}),ne(r)!=="svelte-1haiztv"&&(r.textContent=f),b.forEach(_),p.forEach(_),this.h()},h(){h(l,"class","text-white text-[0.9375rem] font-semibold"),h(r,"class","text-primary-500 text-sm font-medium pointer-events-auto cursor-pointer"),h(t,"class","flex flex-col gap-2.5 items-center justify-center w-full h-full"),h(e,"class","fixed w-screen h-screen bg-black/80 backdrop-blur-[5px] z-10")},m(c,p){F(c,e,p),w(e,t),w(t,l),w(t,a),w(t,r),i||(o=H(r,"click",n[1]),i=!0)},p:$,d(c){c&&_(e),i=!1,o()}}}function Pn(n){let e,t=n[0]&&vt(n);return{c(){t&&t.c(),e=re()},l(l){t&&t.l(l),e=re()},m(l,s){t&&t.m(l,s),F(l,e,s)},p(l,[s]){l[0]?t?t.p(l,s):(t=vt(l),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:$,o:$,d(l){l&&_(e),t&&t.d(l)}}}function Bn(n,e,t){const l=We();let{isVisible:s=!1}=e,{targetTable:a=""}=e,{targetIdx:r=""}=e,f=!1;async function i(){if(f!==!0){f=!0,_e.emit("loading",!0);try{const o=new URL(`${Le}/auth/permissions`);o.searchParams.set("targetTable",a),o.searchParams.set("targetIdx",r),o.searchParams.set("relation","reported"),o.searchParams.set("subjectTable","users"),o.searchParams.set("subjectIdx",Xt().sub),await fetch(o,{method:"DELETE",headers:{Authorization:`Bearer ${ze()}`}}),t(0,s=!1),l("unreported")}finally{f=!1,_e.emit("loading",!1)}}}return n.$$set=o=>{"isVisible"in o&&t(0,s=o.isVisible),"targetTable"in o&&t(2,a=o.targetTable),"targetIdx"in o&&t(3,r=o.targetIdx)},[s,i,a,r]}class On extends ce{constructor(e){super(),de(this,e,Bn,Pn,ue,{isVisible:0,targetTable:2,targetIdx:3})}}function wt(n,e,t){const l=n.slice();return l[82]=e[t],l[83]=e,l[84]=t,l}function kt(n,e,t){const l=n.slice();return l[85]=e[t],l}function Ct(n,e,t){const l=n.slice();return l[88]=e[t],l[90]=t,l}function It(n){let e,t,l;return{c(){e=y("div"),this.h()},l(s){e=T(s,"DIV",{class:!0}),O(e).forEach(_),this.h()},h(){h(e,"class","fixed top-0 left-0 w-screen h-screen bg-black")},m(s,a){F(s,e,a),t||(l=H(e,"contextmenu",Dl(n[25])),t=!0)},d(s){s&&_(e),t=!1,l()}}}function Et(n){let e,t,l,s=[],a=new Map,r,f,i,o,c,p,b,I=pe(n[82].media);const R=m=>m[88];for(let m=0;m<I.length;m+=1){let d=Ct(n,I,m),g=R(d);a.set(g,s[m]=xt(g,d))}let E=!n[4]&&yt(n);return{c(){e=y("section"),t=y("div"),l=y("div");for(let m=0;m<s.length;m+=1)s[m].c();f=q(),E&&E.c(),i=q(),this.h()},l(m){e=T(m,"SECTION",{class:!0,style:!0});var d=O(e);t=T(d,"DIV",{class:!0});var g=O(t);l=T(g,"DIV",{class:!0,style:!0});var k=O(l);for(let B=0;B<s.length;B+=1)s[B].l(k);k.forEach(_),g.forEach(_),f=j(d),E&&E.l(d),i=j(d),d.forEach(_),this.h()},h(){h(l,"class",r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")),ee(l,"transform","translateX("+(-n[82].mediaIdx*n[11].width+n[10])+"px)"),h(t,"class","carousel-container w-full h-full overflow-hidden relative select-none"),h(e,"class",o=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`),ee(e,"top","0"),ee(e,"transform","translateY("+((n[84]-n[0])*n[11].height+n[9])+"px)")},m(m,d){F(m,e,d),w(e,t),w(t,l);for(let g=0;g<s.length;g+=1)s[g]&&s[g].m(l,null);w(e,f),E&&E.m(e,null),w(e,i),c=!0,p||(b=[H(l,"transitionend",function(){Ze(n[82].mediaIdx===n[7][n[0]].mediaIdx?n[15]:void 0)&&(n[82].mediaIdx===n[7][n[0]].mediaIdx?n[15]:void 0).apply(this,arguments)}),H(e,"transitionend",function(){Ze(n[84]===n[0]?n[15]:void 0)&&(n[84]===n[0]?n[15]:void 0).apply(this,arguments)})],p=!0)},p(m,d){n=m,d[0]&16529&&(I=pe(n[82].media),te(),s=Je(s,d,R,1,n,I,a,l,Ut,xt,null,Ct),le()),(!c||d[0]&256&&r!==(r="carousel-track flex w-full h-full select-none transition-transform duration-300 ease-in-out "+(n[8]?"duration-0 transition-duration-0":"")))&&h(l,"class",r),(!c||d[0]&3200)&&ee(l,"transform","translateX("+(-n[82].mediaIdx*n[11].width+n[10])+"px)"),n[4]?E&&(te(),P(E,1,1,()=>{E=null}),le()):E?(E.p(n,d),d[0]&16&&C(E,1)):(E=yt(n),E.c(),C(E,1),E.m(e,i)),(!c||d[0]&256&&o!==(o=`w-full h-full absolute content-center transition-transform
            ${n[8]?"duration-0 transition-duration-0":""}`))&&h(e,"class",o),(!c||d[0]&2689)&&ee(e,"transform","translateY("+((n[84]-n[0])*n[11].height+n[9])+"px)")},i(m){if(!c){for(let d=0;d<I.length;d+=1)C(s[d]);C(E),c=!0}},o(m){for(let d=0;d<s.length;d+=1)P(s[d]);P(E),c=!1},d(m){m&&_(e);for(let d=0;d<s.length;d+=1)s[d].d();E&&E.d(),p=!1,we(b)}}}function xt(n,e){let t,l,s,a,r,f;return s=new Gl({props:{src:e[88],isEdit:e[4],post:e[7][e[0]],muted:e[14],autoplay:e[0]===e[84]&&e[7][e[0]].mediaIdx===e[90],isRightOrder:e[0]===e[84]}}),{key:n,first:null,c(){t=y("div"),l=y("div"),K(s.$$.fragment),r=q(),this.h()},l(i){t=T(i,"DIV",{class:!0});var o=O(t);l=T(o,"DIV",{class:!0});var c=O(l);W(s.$$.fragment,c),c.forEach(_),r=j(o),o.forEach(_),this.h()},h(){h(l,"class",a=`
                      w-full h-full flex justify-center items-center relative
                      ${e[4]?"px-5 pt-5 pb-3":""}
                    `),h(t,"class","carousel-slide flex justify-center items-center min-w-full h-full select-none"),this.first=t},m(i,o){F(i,t,o),w(t,l),G(s,l,null),w(t,r),f=!0},p(i,o){e=i;const c={};o[0]&128&&(c.src=e[88]),o[0]&16&&(c.isEdit=e[4]),o[0]&129&&(c.post=e[7][e[0]]),o[0]&16384&&(c.muted=e[14]),o[0]&129&&(c.autoplay=e[0]===e[84]&&e[7][e[0]].mediaIdx===e[90]),o[0]&129&&(c.isRightOrder=e[0]===e[84]),s.$set(c),(!f||o[0]&16&&a!==(a=`
                      w-full h-full flex justify-center items-center relative
                      ${e[4]?"px-5 pt-5 pb-3":""}
                    `))&&h(l,"class",a)},i(i){f||(C(s.$$.fragment,i),f=!0)},o(i){P(s.$$.fragment,i),f=!1},d(i){i&&_(t),J(s)}}}function yt(n){var D,X;let e,t,l,s,a,r,f,i,o,c,p,b,I,R,E,m=n[82].media.length>1&&Tt(n),d=((D=n[82].reference)==null?void 0:D.origin)==="instagram"&&Dt(n),g=((X=n[82].reactions)==null?void 0:X.length)>0&&!n[5]&&Mt(n);function k(L){n[28](L,n[82],n[83],n[84])}let B={allowFollow:!Ue,whenCancelFollow:n[27]};n[82]!==void 0&&(B.post=n[82]),r=new nn({props:B}),Ee.push(()=>Re(r,"post",k));function x(...L){return n[29](n[82],n[83],n[84],...L)}o=new vn({props:{post:n[82]}}),o.$on("textExpanded",x),p=new un({props:{place:{idx:n[82].place_idx,name:n[82].place_name}}});let S=!n[5]&&Pt(n),N=n[0]===n[84]&&Ot(n);return{c(){m&&m.c(),e=q(),t=y("div"),l=y("div"),d&&d.c(),s=q(),g&&g.c(),a=q(),K(r.$$.fragment),i=q(),K(o.$$.fragment),c=q(),K(p.$$.fragment),b=q(),S&&S.c(),I=q(),N&&N.c(),R=re(),this.h()},l(L){m&&m.l(L),e=j(L),t=T(L,"DIV",{class:!0});var z=O(t);l=T(z,"DIV",{class:!0});var Z=O(l);d&&d.l(Z),s=j(Z),g&&g.l(Z),a=j(Z),W(r.$$.fragment,Z),i=j(Z),W(o.$$.fragment,Z),c=j(Z),W(p.$$.fragment,Z),Z.forEach(_),b=j(z),S&&S.l(z),z.forEach(_),I=j(L),N&&N.l(L),R=re(),this.h()},h(){h(l,"class","flex-grow text-white text-md flex flex-col items-start gap-3 transition-transform text-base "),h(t,"class","absolute bottom-4 px-5 py-4 w-full flex flex-row z-40 items-end justify-between")},m(L,z){m&&m.m(L,z),F(L,e,z),F(L,t,z),w(t,l),d&&d.m(l,null),w(l,s),g&&g.m(l,null),w(l,a),G(r,l,null),w(l,i),G(o,l,null),w(l,c),G(p,l,null),w(t,b),S&&S.m(t,null),F(L,I,z),N&&N.m(L,z),F(L,R,z),E=!0},p(L,z){var fe,ae;n=L,n[82].media.length>1?m?(m.p(n,z),z[0]&128&&C(m,1)):(m=Tt(n),m.c(),C(m,1),m.m(e.parentNode,e)):m&&(te(),P(m,1,1,()=>{m=null}),le()),((fe=n[82].reference)==null?void 0:fe.origin)==="instagram"?d?(d.p(n,z),z[0]&128&&C(d,1)):(d=Dt(n),d.c(),C(d,1),d.m(l,s)):d&&(te(),P(d,1,1,()=>{d=null}),le()),((ae=n[82].reactions)==null?void 0:ae.length)>0&&!n[5]?g?(g.p(n,z),z[0]&160&&C(g,1)):(g=Mt(n),g.c(),C(g,1),g.m(l,a)):g&&(te(),P(g,1,1,()=>{g=null}),le());const Z={};z[0]&64&&(Z.whenCancelFollow=n[27]),!f&&z[0]&128&&(f=!0,Z.post=n[82],Oe(()=>f=!1)),r.$set(Z);const oe={};z[0]&128&&(oe.post=n[82]),o.$set(oe);const he={};z[0]&128&&(he.place={idx:n[82].place_idx,name:n[82].place_name}),p.$set(he),n[5]?S&&(te(),P(S,1,1,()=>{S=null}),le()):S?(S.p(n,z),z[0]&32&&C(S,1)):(S=Pt(n),S.c(),C(S,1),S.m(t,null)),n[0]===n[84]?N?(N.p(n,z),z[0]&129&&C(N,1)):(N=Ot(n),N.c(),C(N,1),N.m(R.parentNode,R)):N&&(te(),P(N,1,1,()=>{N=null}),le())},i(L){E||(C(m),C(d),C(g),C(r.$$.fragment,L),C(o.$$.fragment,L),C(p.$$.fragment,L),C(S),C(N),E=!0)},o(L){P(m),P(d),P(g),P(r.$$.fragment,L),P(o.$$.fragment,L),P(p.$$.fragment,L),P(S),P(N),E=!1},d(L){L&&(_(e),_(t),_(I),_(R)),m&&m.d(L),d&&d.d(),g&&g.d(),J(r),J(o),J(p),S&&S.d(),N&&N.d(L)}}}function Tt(n){let e,t;return e=new Ht({props:{post:n[82]}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&128&&(a.post=l[82]),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Dt(n){let e,t;return e=new Fl({props:{url:n[82].reference.url,name:n[82].reference.name}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&128&&(a.url=l[82].reference.url),s[0]&128&&(a.name=l[82].reference.name),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Mt(n){let e,t,l=pe(n[82].reactions),s=[];for(let r=0;r<l.length;r+=1)s[r]=Vt(kt(n,l,r));const a=r=>P(s[r],1,1,()=>{s[r]=null});return{c(){e=y("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=T(r,"DIV",{class:!0});var f=O(e);for(let i=0;i<s.length;i+=1)s[i].l(f);f.forEach(_),this.h()},h(){h(e,"class","flex gap-1 justify-center items-center mb-1")},m(r,f){F(r,e,f);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);t=!0},p(r,f){if(f[0]&131200){l=pe(r[82].reactions);let i;for(i=0;i<l.length;i+=1){const o=kt(r,l,i);s[i]?(s[i].p(o,f),C(s[i],1)):(s[i]=Vt(o),s[i].c(),C(s[i],1),s[i].m(e,null))}for(te(),i=l.length;i<s.length;i+=1)a(i);le()}},i(r){if(!t){for(let f=0;f<l.length;f+=1)C(s[f]);t=!0}},o(r){s=s.filter(Boolean);for(let f=0;f<s.length;f+=1)P(s[f]);t=!1},d(r){r&&_(e),jt(s,r)}}}function Vt(n){let e,t;function l(){return n[26](n[82],n[85])}return e=new zt({props:{gap:"gap-0.5",textColor:"text-white",backgroundColor:"bg-[rgba(56,56,56,0.7)]",fill:"white",padding:"px-2.5 py-1.5",prefixTextSize:"text-[0.9375rem] leading-normal font-medium",prefix:n[85].type,textSize:"text-[0.8125rem] leading-[1.25rem]",value:n[85].count,height:"h-7",rounded:"rounded-[3.75rem]"}}),e.$on("click",l),{c(){K(e.$$.fragment)},l(s){W(e.$$.fragment,s)},m(s,a){G(e,s,a),t=!0},p(s,a){n=s;const r={};a[0]&128&&(r.prefix=n[85].type),a[0]&128&&(r.value=n[85].count),e.$set(r)},i(s){t||(C(e.$$.fragment,s),t=!0)},o(s){P(e.$$.fragment,s),t=!1},d(s){J(e,s)}}}function Pt(n){var N;let e,t,l,s,a,r,f,i,o=((N=n[82].reactions)!=null&&N.length?n[82].reactions.reduce(n[35],0):0)+"",c,p,b,I,R,E,m,d=n[82].onReactionShowcase&&Bt(n);const g=[Ln,Rn],k=[];function B(D,X){return D[82].myReaction?0:1}a=B(n),r=k[a]=g[a](n);function x(){return n[36](n[82])}function S(){return n[37](n[82],n[83],n[84])}return I=new Xl({props:{fill:"white",length:1.5}}),{c(){e=y("div"),t=y("div"),d&&d.c(),l=q(),s=y("button"),r.c(),f=q(),i=y("span"),c=be(o),p=q(),b=y("button"),K(I.$$.fragment),this.h()},l(D){e=T(D,"DIV",{class:!0});var X=O(e);t=T(X,"DIV",{class:!0});var L=O(t);d&&d.l(L),l=j(L),s=T(L,"BUTTON",{class:!0});var z=O(s);r.l(z),f=j(z),i=T(z,"SPAN",{class:!0});var Z=O(i);c=ve(Z,o),Z.forEach(_),z.forEach(_),L.forEach(_),p=j(X),b=T(X,"BUTTON",{});var oe=O(b);W(I.$$.fragment,oe),oe.forEach(_),X.forEach(_),this.h()},h(){h(i,"class","text-xs text-white h-4"),h(s,"class","relative bg-transparent flex flex-col gap-[0.3125rem] items-center justify-center"),h(t,"class","flex gap-4 relative"),h(e,"class","flex-shrink flex flex-col gap-4 pl-8")},m(D,X){F(D,e,X),w(e,t),d&&d.m(t,null),w(t,l),w(t,s),k[a].m(s,null),w(s,f),w(s,i),w(i,c),w(e,p),w(e,b),G(I,b,null),R=!0,E||(m=[H(s,"click",x),Se(Ye.call(null,s)),Se(Ul.call(null,s,500)),H(s,"longpress",S),H(b,"click",n[38])],E=!0)},p(D,X){var z;n=D,n[82].onReactionShowcase?d?d.p(n,X):(d=Bt(n),d.c(),d.m(t,l)):d&&(d.d(1),d=null);let L=a;a=B(n),a!==L&&(te(),P(k[L],1,1,()=>{k[L]=null}),le(),r=k[a],r||(r=k[a]=g[a](n),r.c()),C(r,1),r.m(s,f)),(!R||X[0]&128)&&o!==(o=((z=n[82].reactions)!=null&&z.length?n[82].reactions.reduce(n[35],0):0)+"")&&Ae(c,o)},i(D){R||(C(r),C(I.$$.fragment,D),R=!0)},o(D){P(r),P(I.$$.fragment,D),R=!1},d(D){D&&_(e),d&&d.d(),k[a].d(),J(I),E=!1,we(m)}}}function Bt(n){let e,t,l="👍",s,a,r="🔥",f,i,o="😍",c,p,b="😋",I,R,E="😊️️",m,d;function g(){return n[30](n[82])}function k(){return n[31](n[82])}function B(){return n[32](n[82])}function x(){return n[33](n[82])}function S(){return n[34](n[82])}return{c(){e=y("div"),t=y("button"),t.textContent=l,s=q(),a=y("button"),a.textContent=r,f=q(),i=y("button"),i.textContent=o,c=q(),p=y("button"),p.textContent=b,I=q(),R=y("button"),R.textContent=E,this.h()},l(N){e=T(N,"DIV",{class:!0});var D=O(e);t=T(D,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-3oecln"&&(t.textContent=l),s=j(D),a=T(D,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(a)!=="svelte-131qbu2"&&(a.textContent=r),f=j(D),i=T(D,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(i)!=="svelte-lq90i3"&&(i.textContent=o),c=j(D),p=T(D,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(p)!=="svelte-l73y87"&&(p.textContent=b),I=j(D),R=T(D,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(R)!=="svelte-11szxsj"&&(R.textContent=E),D.forEach(_),this.h()},h(){h(t,"class","text-2xl/[26px]"),h(a,"class","text-2xl/[26px]"),h(i,"class","text-2xl/[26px]"),h(p,"class","text-2xl/[26px]"),h(R,"class","text-2xl/[26px]"),h(e,"class","absolute right-10 bottom-2.5 bg-[rgba(56,56,56,0.7)] px-5 py-2 rounded-[3.75rem] flex gap-4 items-center justify-center backdrop-blur-[2px] pointer-events-auto text-white text-[1.375rem] leading-normal font-medium ")},m(N,D){F(N,e,D),w(e,t),w(e,s),w(e,a),w(e,f),w(e,i),w(e,c),w(e,p),w(e,I),w(e,R),m||(d=[H(t,"click",g),H(a,"click",k),H(i,"click",B),H(p,"click",x),H(R,"click",S)],m=!0)},p(N,D){n=N},d(N){N&&_(e),m=!1,we(d)}}}function Rn(n){let e,t;return e=new ql({props:{fill:"white",length:1.5}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Ln(n){let e,t;return e=new jl({props:{fill:"#EA3323",length:1.5}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Ot(n){let e,t;return e=new En({props:{isTextExpanded:n[82].isTextExpanded}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&128&&(a.isTextExpanded=l[82].isTextExpanded),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function Rt(n,e){let t,l=Math.abs(e[0]-e[84])<=5,s,a,r=l&&Et(e);return{key:n,first:null,c(){t=re(),r&&r.c(),s=re(),this.h()},l(f){t=re(),r&&r.l(f),s=re(),this.h()},h(){this.first=t},m(f,i){F(f,t,i),r&&r.m(f,i),F(f,s,i),a=!0},p(f,i){e=f,i[0]&129&&(l=Math.abs(e[0]-e[84])<=5),l?r?(r.p(e,i),i[0]&129&&C(r,1)):(r=Et(e),r.c(),C(r,1),r.m(s.parentNode,s)):r&&(te(),P(r,1,1,()=>{r=null}),le())},i(f){a||(C(r),a=!0)},o(f){P(r),a=!1},d(f){f&&(_(t),_(s)),r&&r.d(f)}}}function Lt(n){let e,t;return e=new Ht({props:{post:n[7][n[0]],fixed:!1}}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},p(l,s){const a={};s[0]&129&&(a.post=l[7][l[0]]),e.$set(a)},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function St(n){let e,t;return e=new Nl({}),{c(){K(e.$$.fragment)},l(l){W(e.$$.fragment,l)},m(l,s){G(e,l,s),t=!0},i(l){t||(C(e.$$.fragment,l),t=!0)},o(l){P(e.$$.fragment,l),t=!1},d(l){J(e,l)}}}function At(n){let e,t,l,s,a="수정",r,f,i,o,c,p="삭제",b,I,R;return t=new hn({props:{fill:"white",length:1.5}}),i=new gn({props:{fill:"white",length:1.5}}),{c(){e=y("button"),K(t.$$.fragment),l=q(),s=y("span"),s.textContent=a,r=q(),f=y("button"),K(i.$$.fragment),o=q(),c=y("span"),c.textContent=p,this.h()},l(E){e=T(E,"BUTTON",{class:!0});var m=O(e);W(t.$$.fragment,m),l=j(m),s=T(m,"SPAN",{"data-svelte-h":!0}),ne(s)!=="svelte-17aljrl"&&(s.textContent=a),m.forEach(_),r=j(E),f=T(E,"BUTTON",{class:!0});var d=O(f);W(i.$$.fragment,d),o=j(d),c=T(d,"SPAN",{"data-svelte-h":!0}),ne(c)!=="svelte-1k1dgz"&&(c.textContent=p),d.forEach(_),this.h()},h(){h(e,"class","flex items-center gap-2 text-white text-sm"),h(f,"class","flex items-center gap-2 text-white text-sm")},m(E,m){F(E,e,m),G(t,e,null),w(e,l),w(e,s),F(E,r,m),F(E,f,m),G(i,f,null),w(f,o),w(f,c),b=!0,I||(R=[H(e,"click",n[40]),H(f,"click",n[41])],I=!0)},p:$,i(E){b||(C(t.$$.fragment,E),C(i.$$.fragment,E),b=!0)},o(E){P(t.$$.fragment,E),P(i.$$.fragment,E),b=!1},d(E){E&&(_(e),_(r),_(f)),J(t),J(i),I=!1,we(R)}}}function Nt(n){let e,t,l,s,a,r;return t=new an({}),{c(){e=y("button"),K(t.$$.fragment),l=be(`
        신고`),this.h()},l(f){e=T(f,"BUTTON",{class:!0});var i=O(e);W(t.$$.fragment,i),l=ve(i,`
        신고`),i.forEach(_),this.h()},h(){h(e,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium")},m(f,i){F(f,e,i),G(t,e,null),w(e,l),s=!0,a||(r=H(e,"click",n[43]),a=!0)},p:$,i(f){s||(C(t.$$.fragment,f),s=!0)},o(f){P(t.$$.fragment,f),s=!1},d(f){f&&_(e),J(t),a=!1,r()}}}function Sn(n){let e,t,l,s,a,r,f,i,o,c=n[13]&&At(n);s=new Ql({props:{length:1.5,fill:"white"}});let p=!n[13]&&Nt(n);return{c(){e=y("div"),c&&c.c(),t=q(),l=y("button"),K(s.$$.fragment),a=be(`
      링크 복사`),r=q(),p&&p.c(),this.h()},l(b){e=T(b,"DIV",{id:!0,class:!0});var I=O(e);c&&c.l(I),t=j(I),l=T(I,"BUTTON",{class:!0});var R=O(l);W(s.$$.fragment,R),a=ve(R,`
      링크 복사`),R.forEach(_),r=j(I),p&&p.l(I),I.forEach(_),this.h()},h(){h(l,"class","flex gap-2 items-center text-white text-sm leading-4 font-medium"),h(e,"id","test"),h(e,"class","flex flex-col px-5 gap-3")},m(b,I){F(b,e,I),c&&c.m(e,null),w(e,t),w(e,l),G(s,l,null),w(l,a),w(e,r),p&&p.m(e,null),f=!0,i||(o=[H(l,"click",n[42]),Se(Ye.call(null,e))],i=!0)},p(b,I){b[13]?c?(c.p(b,I),I[0]&8192&&C(c,1)):(c=At(b),c.c(),C(c,1),c.m(e,t)):c&&(te(),P(c,1,1,()=>{c=null}),le()),b[13]?p&&(te(),P(p,1,1,()=>{p=null}),le()):p?(p.p(b,I),I[0]&8192&&C(p,1)):(p=Nt(b),p.c(),C(p,1),p.m(e,null))},i(b){f||(C(c),C(s.$$.fragment,b),C(p),f=!0)},o(b){P(c),P(s.$$.fragment,b),P(p),f=!1},d(b){b&&_(e),c&&c.d(),J(s),p&&p.d(),i=!1,we(o)}}}function An(n){let e,t,l="정말로 삭제하시겠습니까?",s,a,r="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",f,i,o,c="삭제",p,b,I="취소",R,E;return{c(){e=y("div"),t=y("h2"),t.textContent=l,s=q(),a=y("p"),a.textContent=r,f=q(),i=y("div"),o=y("button"),o.textContent=c,p=q(),b=y("button"),b.textContent=I,this.h()},l(m){e=T(m,"DIV",{class:!0});var d=O(e);t=T(d,"H2",{class:!0,"data-svelte-h":!0}),ne(t)!=="svelte-1yzhdkj"&&(t.textContent=l),s=j(d),a=T(d,"P",{class:!0,"data-svelte-h":!0}),ne(a)!=="svelte-26p028"&&(a.textContent=r),f=j(d),i=T(d,"DIV",{class:!0});var g=O(i);o=T(g,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(o)!=="svelte-1q4epan"&&(o.textContent=c),p=j(g),b=T(g,"BUTTON",{class:!0,"data-svelte-h":!0}),ne(b)!=="svelte-1rzg9yy"&&(b.textContent=I),g.forEach(_),d.forEach(_),this.h()},h(){h(t,"class","text-lg font-semibold mb-2"),h(a,"class","text-gray-600 mb-4"),h(o,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),h(b,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),h(i,"class","flex justify-center space-x-4"),h(e,"class","text-center")},m(m,d){F(m,e,d),w(e,t),w(e,s),w(e,a),w(e,f),w(e,i),w(i,o),w(i,p),w(i,b),R||(E=[H(o,"click",n[48]),H(b,"click",n[49])],R=!0)},p:$,d(m){m&&_(e),R=!1,we(E)}}}function Nn(n){var ae;let e,t,l,s=[],a=new Map,r,f,i,o,c,p,b,I,R,E,m,d,g,k,B,x=!n[4]&&It(n),S=pe(n[7]);const N=v=>v[82].idx;for(let v=0;v<S.length;v+=1){let M=wt(n,S,v),Q=N(M);a.set(Q,s[v]=Rt(Q,M))}let D=n[4]&&((ae=n[7][n[0]])==null?void 0:ae.media.length)>1&&Lt(n),X=!n[4]&&St();function L(v){n[44](v)}let z={fixed:!0,noHandle:!0,$$slots:{default:[Sn]},$$scope:{ctx:n}};n[1]!==void 0&&(z.isOpen=n[1]),c=new Yt({props:z}),Ee.push(()=>Re(c,"isOpen",L));function Z(v){n[45](v)}let oe={targetTable:"posts",targetIdx:n[7][n[0]].idx};n[2]!==void 0&&(oe.isOpen=n[2]),I=new Vn({props:oe}),Ee.push(()=>Re(I,"isOpen",Z)),I.$on("reported",n[46]),m=new On({props:{isVisible:n[7][n[0]].permission_signer==="reported",targetTable:"posts",targetIdx:n[7][n[0]].idx}}),m.$on("unreported",n[47]);function he(v){n[50](v)}let fe={$$slots:{default:[An]},$$scope:{ctx:n}};return n[3]!==void 0&&(fe.modalVisible=n[3]),g=new Hl({props:fe}),Ee.push(()=>Re(g,"modalVisible",he)),{c(){x&&x.c(),e=q(),t=y("div"),l=y("div");for(let v=0;v<s.length;v+=1)s[v].c();r=q(),D&&D.c(),f=q(),X&&X.c(),o=q(),K(c.$$.fragment),b=q(),K(I.$$.fragment),E=q(),K(m.$$.fragment),d=q(),K(g.$$.fragment),this.h()},l(v){x&&x.l(v),e=j(v),t=T(v,"DIV",{class:!0});var M=O(t);l=T(M,"DIV",{class:!0});var Q=O(l);for(let se=0;se<s.length;se+=1)s[se].l(Q);Q.forEach(_),r=j(M),D&&D.l(M),f=j(M),X&&X.l(M),M.forEach(_),o=j(v),W(c.$$.fragment,v),b=j(v),W(I.$$.fragment,v),E=j(v),W(m.$$.fragment,v),d=j(v),W(g.$$.fragment,v),this.h()},h(){h(l,"class","flex flex-grow relative w-full h-full bg-black"),h(t,"class",i="viewer bg-black select-none flex flex-col "+(n[4]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh"))},m(v,M){x&&x.m(v,M),F(v,e,M),F(v,t,M),w(t,l);for(let Q=0;Q<s.length;Q+=1)s[Q]&&s[Q].m(l,null);w(t,r),D&&D.m(t,null),w(t,f),X&&X.m(t,null),n[39](t),F(v,o,M),G(c,v,M),F(v,b,M),G(I,v,M),F(v,E,M),G(m,v,M),F(v,d,M),G(g,v,M),B=!0},p(v,M){var Ne;v[4]?x&&(x.d(1),x=null):x||(x=It(v),x.c(),x.m(e.parentNode,e)),M[0]&184307&&(S=pe(v[7]),te(),s=Je(s,M,N,1,v,S,a,l,Ut,Rt,null,wt),le()),v[4]&&((Ne=v[7][v[0]])==null?void 0:Ne.media.length)>1?D?(D.p(v,M),M[0]&145&&C(D,1)):(D=Lt(v),D.c(),C(D,1),D.m(t,f)):D&&(te(),P(D,1,1,()=>{D=null}),le()),v[4]?X&&(te(),P(X,1,1,()=>{X=null}),le()):X?M[0]&16&&C(X,1):(X=St(),X.c(),C(X,1),X.m(t,null)),(!B||M[0]&16&&i!==(i="viewer bg-black select-none flex flex-col "+(v[4]?"static w-full h-full":"fixed top-0 left-0 w-dvw h-dvh")))&&h(t,"class",i);const Q={};M[0]&8206|M[2]&536870912&&(Q.$$scope={dirty:M,ctx:v}),!p&&M[0]&2&&(p=!0,Q.isOpen=v[1],Oe(()=>p=!1)),c.$set(Q);const se={};M[0]&129&&(se.targetIdx=v[7][v[0]].idx),!R&&M[0]&4&&(R=!0,se.isOpen=v[2],Oe(()=>R=!1)),I.$set(se);const ye={};M[0]&129&&(ye.isVisible=v[7][v[0]].permission_signer==="reported"),M[0]&129&&(ye.targetIdx=v[7][v[0]].idx),m.$set(ye);const Pe={};M[0]&8|M[2]&536870912&&(Pe.$$scope={dirty:M,ctx:v}),!k&&M[0]&8&&(k=!0,Pe.modalVisible=v[3],Oe(()=>k=!1)),g.$set(Pe)},i(v){if(!B){for(let M=0;M<S.length;M+=1)C(s[M]);C(D),C(X),C(c.$$.fragment,v),C(I.$$.fragment,v),C(m.$$.fragment,v),C(g.$$.fragment,v),B=!0}},o(v){for(let M=0;M<s.length;M+=1)P(s[M]);P(D),P(X),P(c.$$.fragment,v),P(I.$$.fragment,v),P(m.$$.fragment,v),P(g.$$.fragment,v),B=!1},d(v){v&&(_(e),_(t),_(o),_(b),_(E),_(d)),x&&x.d(v);for(let M=0;M<s.length;M+=1)s[M].d();D&&D.d(),X&&X.d(),n[39](null),J(c,v),J(I,v),J(m,v),J(g,v)}}}const Fn=30,qn=10,Ft=150;function Be(n){return"touches"in n||"changedTouches"in n}function jn(n){return Be(n)?[n.touches[0].clientX,n.touches[0].clientY]:[n.clientX,n.clientY]}function Un(n,e,t){let l,s,a,r;rt(n,at,u=>t(14,a=u)),rt(n,Pl,u=>t(62,r=u));let{posts:f=[]}=e,i=f,{index:o=0}=e,{type:c=r.url.searchParams.get("type")}=e,{isEdit:p=!1}=e,{dontMoveVertically:b=!1}=e,{selectedReaction:I=void 0}=e,{hideActionButtons:R=!1}=e,{whenCancelForExternalLink:E=()=>{}}=e,m=!0,d=!1,g=!1,k=0,B=0,x={width:0,height:0},S=!1,N=!1,{actionSheetMoreIsOpen:D=!1}=e,{actionSheetReportIsOpen:X=!1}=e,{modalVisible:L=!1}=e;function z(u){if(!u)return!1;const V=Ve();return V!==null&&String(V)===u}let Z=!1,oe=!1,he=-1,fe=-1,ae,v=!1,M=[],Q=[],se;async function ye(){var u,V;i[o]&&(console.log("updateParams",i[o]),Bl({mediaIdx:`${((u=i[o])==null?void 0:u.mediaIdx)||0}`,postIdx:`${(V=i[o])==null?void 0:V.idx}`},{replace:!0}))}async function Pe(){t(22,Z=!0);const u=i.length,V=r.url.searchParams.get("userIdx"),A=r.url.searchParams.get("placeIdx"),U=`&offset=${u}`,Y=`&limit=${Fn}`,ie=V?`&userIdx=${V}`:"",De=A?`&placeIdx=${A}`:"",me=(await fetch(`${Le}/posts?${ie}${De}${U}${Y}`).then(ke=>ke.json()).then(ke=>{var st;return((st=ke.data)==null?void 0:st.posts)??[]})).map(ke=>({...ke,mediaIdx:0}));me.length===0&&t(23,oe=!0),t(7,i=[...i,...me]),t(22,Z=!1)}function Ne(u){const{height:V}=x;if(o===0&&u>0||o===i.length-1&&u<0){t(9,k=u*.3);return}t(9,k=Math.max(Math.min(u,V),-V))}function Zt(u){t(8,m=!1);const V=xe(2),A=Be(u)?u.changedTouches[0].clientY-fe:u.clientY-fe;A>V&&o>0?(t(0,o-=1),d=!0):-A>V&&o<i.length-1&&(t(0,o+=1),d=!0),t(9,k=0)}function Kt(u){const{width:V}=x,A=i[o].mediaIdx,U=i[o].media.length-1;if(A===0&&u>0||A===U&&u<0){t(10,B=u*.3);return}t(10,B=Math.max(Math.min(u,V),-V))}function Wt(u){t(8,m=!1);const V=xe(2),A=Be(u)?u.changedTouches[0].clientX-he:u.clientX-he,U=i[o].mediaIdx,Y=i[o].media.length-1;A>V&&U>0?Te(U-1):-A>V&&U<Y&&Te(U+1),t(10,B=0)}function Te(u){t(7,i[o]={...i[o],mediaIdx:u},i),t(7,i=[...i]),g=!0,ye()}function Fe(u){d||g||(v=!0,ae=void 0,Be(u)?(he=u.touches[0].clientX,fe=u.touches[0].clientY):(he=u.clientX,fe=u.clientY,window.addEventListener("mousemove",qe,{passive:!1}),window.addEventListener("mouseup",je)))}function qe(u){if(!v||d||g)return;const[V,A]=jn(u),U=V-he,Y=A-fe;ae===void 0&&(ae=Math.abs(Y)>=Math.abs(U)?"post":"media"),!b&&ae==="post"?Ne(Y):ae==="media"&&Kt(U)}function je(u){!v||d||g||(v=!1,ae==="post"?Zt(u):ae==="media"&&Wt(u),Be(u)||(window.removeEventListener("mousemove",qe),window.removeEventListener("mouseup",je)))}function Qe(u){if(d||g)return;u.preventDefault();const V=Date.now(),A=Math.abs(u.deltaX),U=Math.abs(u.deltaY);if(A>U){if(Q.push({deltaX:u.deltaX,timestamp:V}),Q=Q.filter(Y=>V-Y.timestamp<=Ft),Q.length>=2){const Y=Q[0],ie=Q[Q.length-1];if(Math.abs(ie.deltaX)-Math.abs(Y.deltaX)>=0&&Math.abs(ie.deltaX)>=30){const me=i[o].mediaIdx,ke=i[o].media.length-1;ie.deltaX>0&&me<ke?Te(me+1):ie.deltaX<0&&me>0&&Te(me-1),Q=[],g=!0}}}else if(M.push({deltaY:u.deltaY,timestamp:V}),M=M.filter(Y=>V-Y.timestamp<=Ft),M.length>=2){const Y=M[0],ie=M[M.length-1];Math.abs(ie.deltaY)-Math.abs(Y.deltaY)>=0&&Math.abs(ie.deltaY)>=30&&(ie.deltaY>0&&o<i.length-1?(t(8,m=!1),t(0,o+=1),d=!0):ie.deltaY<0&&o>0&&(t(8,m=!1),t(0,o-=1),d=!0),M=[])}}function $e(u){if(d||g)return;const V=i[o].mediaIdx,A=i[o].media.length-1;switch(u.key){case"ArrowUp":o>0&&(t(8,m=!1),t(0,o--,o),d=!0);break;case"ArrowDown":o<i.length-1&&(t(8,m=!1),t(0,o++,o),d=!0);break;case"ArrowLeft":V>0&&(t(8,m=!1),g=!0,Te(V-1));break;case"ArrowRight":V<A&&(t(8,m=!1),g=!0,Te(V+1));break}}function Gt(){t(8,m=!0),d=!1,g=!1}function et(){se&&t(11,x={width:se.clientWidth,height:se.clientHeight})}function Jt(){var A,U;const u=Number(r.url.searchParams.get("mediaIdx")||0),V=((U=(A=i.at(o))==null?void 0:A.media)==null?void 0:U.length)||0;u&&u<V?t(7,i[o]={...i[o],mediaIdx:u},i):t(7,i[o]={...i[o],mediaIdx:0},i),t(7,i=[...i])}function Qt(){document.addEventListener("touchstart",Fe,{passive:!1}),document.addEventListener("touchmove",qe,{passive:!1}),document.addEventListener("touchend",je),document.addEventListener("mousedown",Fe,{passive:!1}),document.addEventListener("wheel",Qe,{passive:!1}),document.addEventListener("keydown",$e)}function $t(){document.removeEventListener("touchstart",Fe),document.removeEventListener("touchmove",qe),document.removeEventListener("touchend",je),document.removeEventListener("mousedown",Fe),document.removeEventListener("wheel",Qe),document.removeEventListener("keydown",$e)}qt(()=>{Tl(at,a=!0,a),et();const u=new ResizeObserver(()=>et());return se&&u.observe(se),Qt(),Jt(),()=>{u.disconnect()}}),Ge(()=>{$t()});function tt(){var U;if(N)return;N=!0;const u=ze(),V=Ve(),A=(U=i[o])==null?void 0:U.idx;if(!u||!V||!A)return N=!1;fetch(`${Le}/posts/${A}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${u}`}}).then(Y=>Y.json()).then(()=>Ke(`/users/${V}`,{replaceState:!0,invalidateAll:!0})).finally(()=>{N=!1})}async function lt(u){var Y,ie,De;const V=(Y=i[u])==null?void 0:Y.idx;if(V===void 0||p||((ie=i[u])==null?void 0:ie.needReactionReload)!==!0&&((De=i[u])!=null&&De.reactions))return;const A=ze(),U=await fetch(`${Le}/vote/reactions?targetTable=posts&targetId=${V}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+A}});if(U.ok){const me=await U.json();t(7,i[u].reactions=me.data.reactions,i),t(7,i[u].myReaction=me.data.myReaction,i)}}function ge(u,V){if(Ue)return E();if(S)return;S=!0;const A=o,U=i[A];if((U==null?void 0:U.idx)!==u)return S=!1;if(!ot())return U.needReactionReload=!0,S=!1,_e.emit("showSignInModal",{removable:!0,callback:Sl?()=>{lt(A)}:void 0});U.myReaction===V?_e.emit("setReaction",{target:"posts",targetId:u,reaction:null,callback:()=>{t(7,i[A].myReaction=null,i),nt(A,V),S=!1}}):(U.myReaction&&nt(A,U.myReaction),_e.emit("setReaction",{target:"posts",targetId:u,reaction:V,callback:()=>{t(7,i[A].myReaction=V,i),i[A].reactions.some(Y=>Y.type===V)?t(7,i[A].reactions=i[A].reactions.map(Y=>Y.type===V?{...Y,count:Number(Y.count)+1}:Y),i):t(7,i[A].reactions=[...i[A].reactions,{type:V,count:1}],i),S=!1}}))}function nt(u,V){let A=[];for(const U of i[u].reactions)if(U.type===V){const Y=Number(U.count);Y>1&&A.push({...U,count:Y-1})}else A.push(U);t(7,i[u].reactions=A,i)}function el(u){Ml.call(this,n,u)}const tl=(u,V)=>{ge(u.idx,V.type)},ll=()=>{if(Ue)return E()};function nl(u,V,A,U){A[U]=u,t(7,i)}const sl=(u,V,A,U)=>{t(7,V[A].isTextExpanded=U.detail.expanded,i)},il=u=>{ge(u.idx,"👍")},rl=u=>{ge(u.idx,"️🔥")},al=u=>{ge(u.idx,"😍")},ol=u=>{ge(u.idx,"😋")},fl=u=>{ge(u.idx,"😊️️")},ul=(u,V)=>u+Number(V.count),cl=u=>{ge(u.idx,u.myReaction||"❤️")},dl=(u,V,A)=>{t(7,V[A].onReactionShowcase=!0,i);const U=()=>{t(7,V[A].onReactionShowcase=!1,i),window.removeEventListener("click",U)};setTimeout(()=>{window.addEventListener("click",U)},500)},hl=()=>{if(Ue)return E();if(!ot())return _e.emit("showSignInModal",{removable:!0});t(1,D=!0)};function ml(u){Ee[u?"unshift":"push"](()=>{se=u,t(12,se)})}const pl=()=>{var u;t(1,D=!1),Ke(`/viewer/edit?type=patch&postIdx=${(u=window.location.search.split("postIdx=")[1])==null?void 0:u.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},gl=()=>{t(1,D=!1),t(3,L=!0)},_l=()=>{Jl(`${location.pathname}${location.search}`),t(1,D=!1)},bl=()=>{t(1,D=!1),t(2,X=!0)};function vl(u){D=u,t(1,D)}function wl(u){X=u,t(2,X)}const kl=()=>{t(7,i[o].permission_signer="reported",i)},Cl=()=>{t(7,i[o].permission_signer=null,i)},Il=()=>{tt(),t(3,L=!1)},El=()=>{t(3,L=!1)};function xl(u){L=u,t(3,L)}return n.$$set=u=>{"posts"in u&&t(18,f=u.posts),"index"in u&&t(0,o=u.index),"type"in u&&t(19,c=u.type),"isEdit"in u&&t(4,p=u.isEdit),"dontMoveVertically"in u&&t(20,b=u.dontMoveVertically),"selectedReaction"in u&&t(21,I=u.selectedReaction),"hideActionButtons"in u&&t(5,R=u.hideActionButtons),"whenCancelForExternalLink"in u&&t(6,E=u.whenCancelForExternalLink),"actionSheetMoreIsOpen"in u&&t(1,D=u.actionSheetMoreIsOpen),"actionSheetReportIsOpen"in u&&t(2,X=u.actionSheetReportIsOpen),"modalVisible"in u&&t(3,L=u.modalVisible)},n.$$.update=()=>{var u;n.$$.dirty[0]&1&&o&&ye(),n.$$.dirty[0]&2097152&&I&&ge(I.postIdx,I.reaction),n.$$.dirty[0]&1&&lt(o),n.$$.dirty[0]&129&&t(24,l=(u=i[o])==null?void 0:u.user_idx),n.$$.dirty[0]&16777216&&t(13,s=z(l)),n.$$.dirty[0]&13631617&&!b&&o>=i.length-qn&&!Z&&!oe&&(console.log("pushPosts"),Pe())},[o,D,X,L,p,R,E,i,m,k,B,x,se,s,a,Gt,tt,ge,f,c,b,I,Z,oe,l,el,tl,ll,nl,sl,il,rl,al,ol,fl,ul,cl,dl,hl,ml,pl,gl,_l,bl,vl,wl,kl,Cl,Il,El,xl]}class bs extends ce{constructor(e){super(),de(this,e,Un,Nn,ue,{posts:18,index:0,type:19,isEdit:4,dontMoveVertically:20,selectedReaction:21,hideActionButtons:5,whenCancelForExternalLink:6,actionSheetMoreIsOpen:1,actionSheetReportIsOpen:2,modalVisible:3},null,[-1,-1,-1])}}export{bs as V};
