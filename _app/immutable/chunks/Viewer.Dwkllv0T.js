import{s as Me,E as _e,F as pe,b as T,f as _,x as a,i as G,h as g,n as ue,v as Ge,e as C,a as B,c as x,g as Y,y as W,H as Ot,w as Fe,P as Xe,k as jt,q as Zt,T as Xt,r as Ut,A as Je,I as zt,t as Ne,d as Be,B as Ce,U as Ke,j as Ye,D as Ve,N as Qe,L as $e,C as wt,z as de}from"./scheduler.B69fKoFa.js";import{S as Le,i as De,c as ie,b as re,m as oe,t as N,a as X,d as ae,e as et,g as xe,f as Te}from"./index.dtT_z20O.js";import{e as we}from"./each.CwS2ZKx_.js";import{e as qe,d as tt,A as Ue,m as ze,g as Wt,i as nt,l as Gt,j as Ft}from"./sign.BxCoe6p8.js";import{g as We}from"./entry.rxoMCqBw.js";import{u as Jt,g as Kt}from"./searchParams.CxTvUzzR.js";/* empty css                                                     */import{C as Qt}from"./CircleImage.BtJSRtBU.js";import{p as $t}from"./stores.B0I4f_9d.js";import{r as ye,a as en,b as tn,c as nn}from"./Header.CWwfNqbM.js";import"./index.BqcJK9xU.js";import{s as Ze}from"./s32cloudfront.BwHITURH.js";import{I as ln,a as sn}from"./IconHeartFill.BTzZHrHh.js";import{l as rn}from"./longPress.C9F0mLoM.js";import{A as on}from"./ActionSheet.of5Fe97F.js";import{M as an}from"./Modal.Dz1rGaAP.js";/* empty css                                             */function cn(t){const n=["touchstart","touchmove","touchend","mousedown","mousemove","mouseup","wheel"].map(l=>{const i=r=>r.stopPropagation();return t.addEventListener(l,i),{event:l,handler:i}});return{destroy(){n.forEach(({event:l,handler:i})=>{t.removeEventListener(l,i)})}}}function fn(t){let e,n;return{c(){e=_e("svg"),n=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0,stroke:!0});var i=T(e);n=pe(i,"path",{d:!0}),T(n).forEach(_),i.forEach(_),this.h()},h(){a(n,"d","M37.8592 6.49005C37.7847 6.34198 37.6704 6.21766 37.529 6.13108C37.3877 6.04451 37.2249 5.99913 37.0592 6.00005H2.89919C2.71505 5.99813 2.53497 6.05404 2.38427 6.15988C2.23358 6.26573 2.11987 6.41618 2.0592 6.59005C1.99343 6.76227 1.98217 6.95054 2.02688 7.12938C2.07159 7.30823 2.17013 7.46903 2.3092 7.59005L14.3092 17.86V36.05C14.3103 36.2389 14.3708 36.4225 14.4821 36.5751C14.5933 36.7276 14.7497 36.8413 14.9292 36.9C15.022 36.9143 15.1164 36.9143 15.2092 36.9C15.3489 36.9 15.4867 36.8675 15.6117 36.805C15.7367 36.7426 15.8454 36.6518 15.9292 36.5401L37.7492 7.40005C37.8464 7.27167 37.9078 7.11978 37.9271 6.95991C37.9465 6.80004 37.923 6.6379 37.8592 6.49005ZM5.32922 7.81005H33.1292L15.3592 16.38L5.32922 7.81005ZM16.1292 18L34.1292 9.31005L16.1292 33.31V18Z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 40 40"),a(e,"width",t[1]),a(e,"height",t[1]),a(e,"fill",t[0]),a(e,"stroke",t[0])},m(l,i){G(l,e,i),g(e,n)},p(l,[i]){i&2&&a(e,"width",l[1]),i&2&&a(e,"height",l[1]),i&1&&a(e,"fill",l[0]),i&1&&a(e,"stroke",l[0])},i:ue,o:ue,d(l){l&&_(e)}}}function un(t,e,n){let l,{fill:i="#5f6368"}=e,{length:r="1.75"}=e;return t.$$set=s=>{"fill"in s&&n(0,i=s.fill),"length"in s&&n(2,r=s.length)},t.$$.update=()=>{t.$$.dirty&4&&n(1,l=ye(r))},[i,l,r]}class hn extends Le{constructor(e){super(),De(this,e,un,fn,Me,{fill:0,length:2})}}function dn(t){let e,n;return{c(){e=_e("svg"),n=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var i=T(e);n=pe(i,"path",{d:!0}),T(n).forEach(_),i.forEach(_),this.h()},h(){a(n,"d","M10.7584 31.6667L3.33337 37.5V6.66667C3.33337 6.22464 3.50897 5.80072 3.82153 5.48816C4.13409 5.17559 4.55801 5 5.00004 5H35C35.4421 5 35.866 5.17559 36.1786 5.48816C36.4911 5.80072 36.6667 6.22464 36.6667 6.66667V30C36.6667 30.442 36.4911 30.866 36.1786 31.1785C35.866 31.4911 35.4421 31.6667 35 31.6667H10.7584ZM9.60504 28.3333H33.3334V8.33333H6.66671V30.6417L9.60504 28.3333ZM18.3334 16.6667H21.6667V20H18.3334V16.6667ZM11.6667 16.6667H15V20H11.6667V16.6667ZM25 16.6667H28.3334V20H25V16.6667Z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 0 40 40"),a(e,"width",t[1]),a(e,"height",t[1]),a(e,"fill",t[0])},m(l,i){G(l,e,i),g(e,n)},p(l,[i]){i&2&&a(e,"width",l[1]),i&2&&a(e,"height",l[1]),i&1&&a(e,"fill",l[0])},i:ue,o:ue,d(l){l&&_(e)}}}function mn(t,e,n){let l,{fill:i="#5f6368"}=e,{length:r="1.75"}=e;return t.$$set=s=>{"fill"in s&&n(0,i=s.fill),"length"in s&&n(2,r=s.length)},t.$$.update=()=>{t.$$.dirty&4&&n(1,l=ye(r))},[i,l,r]}class gn extends Le{constructor(e){super(),De(this,e,mn,dn,Me,{fill:0,length:2})}}function _n(t){let e,n;return{c(){e=_e("svg"),n=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var i=T(e);n=pe(i,"path",{d:!0}),T(n).forEach(_),i.forEach(_),this.h()},h(){a(n,"d","M200-200h57l391-391-57-57-391 391v57Zm-40 80q-17 0-28.5-11.5T120-160v-97q0-16 6-30.5t17-25.5l505-504q12-11 26.5-17t30.5-6q16 0 31 6t26 18l55 56q12 11 17.5 26t5.5 30q0 16-5.5 30.5T817-647L313-143q-11 11-25.5 17t-30.5 6h-97Zm600-584-56-56 56 56Zm-141 85-28-29 57 57-29-28Z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 -960 960 960"),a(e,"width",t[1]),a(e,"height",t[1]),a(e,"fill",t[0])},m(l,i){G(l,e,i),g(e,n)},p(l,[i]){i&2&&a(e,"width",l[1]),i&2&&a(e,"height",l[1]),i&1&&a(e,"fill",l[0])},i:ue,o:ue,d(l){l&&_(e)}}}function pn(t,e,n){let l,{fill:i="#5f6368"}=e,{length:r="1.75"}=e,{alt:s="Edit"}=e;return t.$$set=f=>{"fill"in f&&n(0,i=f.fill),"length"in f&&n(2,r=f.length),"alt"in f&&n(3,s=f.alt)},t.$$.update=()=>{t.$$.dirty&4&&n(1,l=ye(r))},[i,l,r,s]}class vn extends Le{constructor(e){super(),De(this,e,pn,_n,Me,{fill:0,length:2,alt:3})}}function bn(t){let e,n;return{c(){e=_e("svg"),n=_e("path"),this.h()},l(l){e=pe(l,"svg",{xmlns:!0,viewBox:!0,width:!0,height:!0,fill:!0});var i=T(e);n=pe(i,"path",{d:!0}),T(n).forEach(_),i.forEach(_),this.h()},h(){a(n,"d","M280-120q-33 0-56.5-23.5T200-200v-520q-17 0-28.5-11.5T160-760q0-17 11.5-28.5T200-800h160q0-17 11.5-28.5T400-840h160q17 0 28.5 11.5T600-800h160q17 0 28.5 11.5T800-760q0 17-11.5 28.5T760-720v520q0 33-23.5 56.5T680-120H280Zm400-600H280v520h400v-520ZM400-280q17 0 28.5-11.5T440-320v-280q0-17-11.5-28.5T400-640q-17 0-28.5 11.5T360-600v280q0 17 11.5 28.5T400-280Zm160 0q17 0 28.5-11.5T600-320v-280q0-17-11.5-28.5T560-640q-17 0-28.5 11.5T520-600v280q0 17 11.5 28.5T560-280ZM280-720v520-520Z"),a(e,"xmlns","http://www.w3.org/2000/svg"),a(e,"viewBox","0 -960 960 960"),a(e,"width",t[1]),a(e,"height",t[1]),a(e,"fill",t[0])},m(l,i){G(l,e,i),g(e,n)},p(l,[i]){i&2&&a(e,"width",l[1]),i&2&&a(e,"height",l[1]),i&1&&a(e,"fill",l[0])},i:ue,o:ue,d(l){l&&_(e)}}}function wn(t,e,n){let l,{fill:i="#5f6368"}=e,{length:r="1.75"}=e,{alt:s="Delete"}=e;return t.$$set=f=>{"fill"in f&&n(0,i=f.fill),"length"in f&&n(2,r=f.length),"alt"in f&&n(3,s=f.alt)},t.$$.update=()=>{t.$$.dirty&4&&n(1,l=ye(r))},[i,l,r,s]}class kn extends Le{constructor(e){super(),De(this,e,wn,bn,Me,{fill:0,length:2,alt:3})}}function In(t){let e;return{c(){e=_e("path"),this.h()},l(n){e=pe(n,"path",{d:!0}),T(e).forEach(_),this.h()},h(){a(e,"d","M12 21.3999L16.95 16.4499C17.9289 15.4709 18.5955 14.2236 18.8656 12.8658C19.1356 11.5079 18.9969 10.1005 18.4671 8.82148C17.9373 7.54244 17.04 6.44923 15.8889 5.68009C14.7378 4.91095 13.3844 4.50043 12 4.50043C10.6156 4.50043 9.26222 4.91095 8.11109 5.68009C6.95996 6.44923 6.06275 7.54244 5.53292 8.82148C5.00308 10.1005 4.86442 11.5079 5.13445 12.8658C5.40449 14.2236 6.07111 15.4709 7.05 16.4499L12 21.3999ZM12 24.2279L5.636 17.8639C4.37734 16.6052 3.52019 15.0016 3.17293 13.2558C2.82567 11.5099 3.00391 9.70035 3.6851 8.05582C4.36629 6.41129 5.51984 5.00569 6.99988 4.01677C8.47992 3.02784 10.22 2.5 12 2.5C13.78 2.5 15.5201 3.02784 17.0001 4.01677C18.4802 5.00569 19.6337 6.41129 20.3149 8.05582C20.9961 9.70035 21.1743 11.5099 20.8271 13.2558C20.4798 15.0016 19.6227 16.6052 18.364 17.8639L12 24.2279ZM12 13.4999C12.5304 13.4999 13.0391 13.2892 13.4142 12.9141C13.7893 12.5391 14 12.0304 14 11.4999C14 10.9695 13.7893 10.4608 13.4142 10.0857C13.0391 9.71064 12.5304 9.49992 12 9.49992C11.4696 9.49992 10.9609 9.71064 10.5858 10.0857C10.2107 10.4608 10 10.9695 10 11.4999C10 12.0304 10.2107 12.5391 10.5858 12.9141C10.9609 13.2892 11.4696 13.4999 12 13.4999ZM12 15.4999C10.9391 15.4999 9.92172 15.0785 9.17158 14.3283C8.42143 13.5782 8 12.5608 8 11.4999C8 10.4391 8.42143 9.42164 9.17158 8.67149C9.92172 7.92135 10.9391 7.49992 12 7.49992C13.0609 7.49992 14.0783 7.92135 14.8284 8.67149C15.5786 9.42164 16 10.4391 16 11.4999C16 12.5608 15.5786 13.5782 14.8284 14.3283C14.0783 15.0785 13.0609 15.4999 12 15.4999Z")},m(n,l){G(n,e,l)},p:ue,d(n){n&&_(e)}}}function En(t){let e,n;return e=new en({props:{width:t[0],height:t[1],viewBox:"0 0 24 25",fill:t[2],alt:t[3],$$slots:{default:[In]},$$scope:{ctx:t}}}),{c(){ie(e.$$.fragment)},l(l){re(e.$$.fragment,l)},m(l,i){oe(e,l,i),n=!0},p(l,[i]){const r={};i&1&&(r.width=l[0]),i&2&&(r.height=l[1]),i&4&&(r.fill=l[2]),i&8&&(r.alt=l[3]),i&16&&(r.$$scope={dirty:i,ctx:l}),e.$set(r)},i(l){n||(N(e.$$.fragment,l),n=!0)},o(l){X(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function Cn(t,e,n){let{width:l=24}=e,{height:i=25}=e,{fill:r="#21242C"}=e,{alt:s="Location"}=e;return t.$$set=f=>{"width"in f&&n(0,l=f.width),"height"in f&&n(1,i=f.height),"fill"in f&&n(2,r=f.fill),"alt"in f&&n(3,s=f.alt)},[l,i,r,s]}class xn extends Le{constructor(e){super(),De(this,e,Cn,En,Me,{width:0,height:1,fill:2,alt:3})}}function lt(t,e,n){const l=t.slice();return l[69]=e[n],l[70]=e,l[71]=n,l}function st(t,e,n){const l=t.slice();return l[72]=e[n],l}function it(t,e,n){const l=t.slice();return l[75]=e[n],l[77]=n,l}function rt(t,e,n){const l=t.slice();return l[78]=e[n],l}function ot(t){var te,Re,Se;let e,n,l,i,r,s,f,d,m,c,b,h,w,v,y,E,L,u=(t[69].place_name||"")+"",I,H,J,q,k,z,K,$,ke,fe,ee=we(t[69].media),M=[];for(let j=0;j<ee.length;j+=1)M[j]=at(rt(t,ee,j));let V=t[69].media.length>1&&ct(t),A=!t[2]&&((te=t[69].reactions)==null?void 0:te.length)>0&&ut(t),S=t[69].user_idx&&dt(t),U=(t[10]==="post"||t[10]==="patch"||((Se=(Re=t[69])==null?void 0:Re.text)==null?void 0:Se.length)>0)&&mt(t);y=new xn({props:{width:20,height:20,fill:"white"}});function me(){return t[25](t[69])}let P=!t[2]&&gt(t);return{c(){e=C("div"),n=C("div"),l=C("div");for(let j=0;j<M.length;j+=1)M[j].c();s=B(),f=C("div"),d=C("div"),m=C("div"),V&&V.c(),c=B(),A&&A.c(),b=B(),S&&S.c(),h=B(),U&&U.c(),w=B(),v=C("button"),ie(y.$$.fragment),E=B(),L=C("div"),I=Ne(u),J=B(),q=C("div"),P&&P.c(),k=B(),this.h()},l(j){e=x(j,"DIV",{class:!0,style:!0});var Z=T(e);n=x(Z,"DIV",{class:!0});var ce=T(n);l=x(ce,"DIV",{class:!0,style:!0});var Ie=T(l);for(let He=0;He<M.length;He+=1)M[He].l(Ie);Ie.forEach(_),ce.forEach(_),s=Y(Z),f=x(Z,"DIV",{class:!0});var ge=T(f);d=x(ge,"DIV",{class:!0});var F=T(d);m=x(F,"DIV",{class:!0,style:!0});var Q=T(m);V&&V.l(Q),c=Y(Q),A&&A.l(Q),b=Y(Q),S&&S.l(Q),h=Y(Q),U&&U.l(Q),w=Y(Q),v=x(Q,"BUTTON",{class:!0});var ne=T(v);re(y.$$.fragment,ne),E=Y(ne),L=x(ne,"DIV",{});var Pe=T(L);I=Be(Pe,u),Pe.forEach(_),ne.forEach(_),Q.forEach(_),F.forEach(_),J=Y(ge),q=x(ge,"DIV",{class:!0});var Oe=T(q);P&&P.l(Oe),Oe.forEach(_),ge.forEach(_),k=Y(Z),Z.forEach(_),this.h()},h(){a(l,"class",i=Ce(`carousel-track transition-transform ${t[4]?"duration-0":""}`)+" svelte-1xgvwrg"),a(l,"style",r=`transform: translateX(${-t[69].mediaIdx*t[7].width+t[6]}px);`),a(n,"class","carousel-container svelte-1xgvwrg"),a(v,"class","bg-black/60 px-3.5 py-2 rounded-[50px] text-shadow text-center flex gap-2 justify-center items-center backdrop-blur-[2px] svelte-1xgvwrg"),a(m,"class","text-white text-md flex flex-col items-start gap-2 transition-transform svelte-1xgvwrg"),a(m,"style",H=`transform: translateY(${t[3]}px);`),a(d,"class","flex-auto"),a(q,"class","flex-none"),a(f,"class","absolute bottom-24 px-4 w-full flex z-40 items-end"),a(e,"class",z=Ce(`w-full h-full gradient-overlay absolute content-center transition-transform ${t[4]?"duration-0":""}`)+" svelte-1xgvwrg"),a(e,"style",K=`top: 0; transform: translateY(${(t[71]-t[1])*t[7].height+t[5]}px);`)},m(j,Z){G(j,e,Z),g(e,n),g(n,l);for(let ce=0;ce<M.length;ce+=1)M[ce]&&M[ce].m(l,null);g(e,s),g(e,f),g(f,d),g(d,m),V&&V.m(m,null),g(m,c),A&&A.m(m,null),g(m,b),S&&S.m(m,null),g(m,h),U&&U.m(m,null),g(m,w),g(m,v),oe(y,v,null),g(v,E),g(v,L),g(L,I),g(f,J),g(f,q),P&&P.m(q,null),g(e,k),$=!0,ke||(fe=[W(l,"transitionend",function(){Ke(t[69].mediaIdx===t[0][t[1]].mediaIdx?t[11]:void 0)&&(t[69].mediaIdx===t[0][t[1]].mediaIdx?t[11]:void 0).apply(this,arguments)}),W(v,"click",me),W(e,"transitionend",function(){Ke(t[71]===t[1]?t[11]:void 0)&&(t[71]===t[1]?t[11]:void 0).apply(this,arguments)})],ke=!0)},p(j,Z){var ce,Ie,ge;if(t=j,Z[0]&1){ee=we(t[69].media);let F;for(F=0;F<ee.length;F+=1){const Q=rt(t,ee,F);M[F]?M[F].p(Q,Z):(M[F]=at(Q),M[F].c(),M[F].m(l,null))}for(;F<M.length;F+=1)M[F].d(1);M.length=ee.length}(!$||Z[0]&16&&i!==(i=Ce(`carousel-track transition-transform ${t[4]?"duration-0":""}`)+" svelte-1xgvwrg"))&&a(l,"class",i),(!$||Z[0]&193&&r!==(r=`transform: translateX(${-t[69].mediaIdx*t[7].width+t[6]}px);`))&&a(l,"style",r),t[69].media.length>1?V?V.p(t,Z):(V=ct(t),V.c(),V.m(m,c)):V&&(V.d(1),V=null),!t[2]&&((ce=t[69].reactions)==null?void 0:ce.length)>0?A?A.p(t,Z):(A=ut(t),A.c(),A.m(m,b)):A&&(A.d(1),A=null),t[69].user_idx?S?(S.p(t,Z),Z[0]&1&&N(S,1)):(S=dt(t),S.c(),N(S,1),S.m(m,h)):S&&(xe(),X(S,1,1,()=>{S=null}),Te()),t[10]==="post"||t[10]==="patch"||((ge=(Ie=t[69])==null?void 0:Ie.text)==null?void 0:ge.length)>0?U?U.p(t,Z):(U=mt(t),U.c(),U.m(m,w)):U&&(U.d(1),U=null),(!$||Z[0]&1)&&u!==(u=(t[69].place_name||"")+"")&&Ye(I,u),(!$||Z[0]&8&&H!==(H=`transform: translateY(${t[3]}px);`))&&a(m,"style",H),t[2]?P&&(xe(),X(P,1,1,()=>{P=null}),Te()):P?(P.p(t,Z),Z[0]&4&&N(P,1)):(P=gt(t),P.c(),N(P,1),P.m(q,null)),(!$||Z[0]&16&&z!==(z=Ce(`w-full h-full gradient-overlay absolute content-center transition-transform ${t[4]?"duration-0":""}`)+" svelte-1xgvwrg"))&&a(e,"class",z),(!$||Z[0]&162&&K!==(K=`top: 0; transform: translateY(${(t[71]-t[1])*t[7].height+t[5]}px);`))&&a(e,"style",K)},i(j){$||(N(S),N(y.$$.fragment,j),N(P),$=!0)},o(j){X(S),X(y.$$.fragment,j),X(P),$=!1},d(j){j&&_(e),Xe(M,j),V&&V.d(),A&&A.d(),S&&S.d(),U&&U.d(),ae(y),P&&P.d(),ke=!1,Ve(fe)}}}function at(t){let e,n,l,i,r;return{c(){e=C("div"),n=C("img"),r=B(),this.h()},l(s){e=x(s,"DIV",{class:!0});var f=T(e);n=x(f,"IMG",{src:!0,alt:!0,class:!0,draggable:!0}),r=Y(f),f.forEach(_),this.h()},h(){Qe(n.src,l=Ze(t[78]))||a(n,"src",l),a(n,"alt",i=t[69].place_name),a(n,"class","w-full h-full object-contain svelte-1xgvwrg"),a(n,"draggable","false"),a(e,"class","carousel-slide svelte-1xgvwrg")},m(s,f){G(s,e,f),g(e,n),g(e,r)},p(s,f){f[0]&1&&!Qe(n.src,l=Ze(s[78]))&&a(n,"src",l),f[0]&1&&i!==(i=s[69].place_name)&&a(n,"alt",i)},d(s){s&&_(e)}}}function ct(t){let e,n=we(t[69].media),l=[];for(let i=0;i<n.length;i+=1)l[i]=ft(it(t,n,i));return{c(){e=C("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=x(i,"DIV",{class:!0});var r=T(e);for(let s=0;s<l.length;s+=1)l[s].l(r);r.forEach(_),this.h()},h(){a(e,"class","carousel-nav svelte-1xgvwrg")},m(i,r){G(i,e,r);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(e,null)},p(i,r){if(r[0]&1){n=we(i[69].media);let s;for(s=0;s<n.length;s+=1){const f=it(i,n,s);l[s]?l[s].p(f,r):(l[s]=ft(f),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(i){i&&_(e),Xe(l,i)}}}function ft(t){let e,n;return{c(){e=C("span"),this.h()},l(l){e=x(l,"SPAN",{class:!0}),T(e).forEach(_),this.h()},h(){a(e,"class",n="carousel-dot "+(t[69].mediaIdx===t[77]?"active":"")+" svelte-1xgvwrg")},m(l,i){G(l,e,i)},p(l,i){i[0]&1&&n!==(n="carousel-dot "+(l[69].mediaIdx===l[77]?"active":"")+" svelte-1xgvwrg")&&a(e,"class",n)},d(l){l&&_(e)}}}function ut(t){let e,n=we(t[69].reactions),l=[];for(let i=0;i<n.length;i+=1)l[i]=ht(st(t,n,i));return{c(){e=C("div");for(let i=0;i<l.length;i+=1)l[i].c();this.h()},l(i){e=x(i,"DIV",{class:!0});var r=T(e);for(let s=0;s<l.length;s+=1)l[s].l(r);r.forEach(_),this.h()},h(){a(e,"class","flex gap-3 justify-center items-center")},m(i,r){G(i,e,r);for(let s=0;s<l.length;s+=1)l[s]&&l[s].m(e,null)},p(i,r){if(r[0]&8193){n=we(i[69].reactions);let s;for(s=0;s<n.length;s+=1){const f=st(i,n,s);l[s]?l[s].p(f,r):(l[s]=ht(f),l[s].c(),l[s].m(e,null))}for(;s<l.length;s+=1)l[s].d(1);l.length=n.length}},d(i){i&&_(e),Xe(l,i)}}}function ht(t){let e,n,l=t[72].type+"",i,r,s,f=t[72].count+"",d,m,c,b;function h(){return t[20](t[69],t[72])}return{c(){e=C("button"),n=C("span"),i=Ne(l),r=B(),s=C("span"),d=Ne(f),m=B(),this.h()},l(w){e=x(w,"BUTTON",{class:!0});var v=T(e);n=x(v,"SPAN",{});var y=T(n);i=Be(y,l),y.forEach(_),r=Y(v),s=x(v,"SPAN",{});var E=T(s);d=Be(E,f),E.forEach(_),m=Y(v),v.forEach(_),this.h()},h(){a(e,"class","bg-black/50 text-white px-2.5 py-2 rounded-[60px] flex gap-0.5 items-center justify-center backdrop-blur-[2px]")},m(w,v){G(w,e,v),g(e,n),g(n,i),g(e,r),g(e,s),g(s,d),g(e,m),c||(b=W(e,"click",h),c=!0)},p(w,v){t=w,v[0]&1&&l!==(l=t[72].type+"")&&Ye(i,l),v[0]&1&&f!==(f=t[72].count+"")&&Ye(d,f)},d(w){w&&_(e),c=!1,b()}}}function dt(t){let e,n,l,i,r,s=t[69].unique_name+"",f,d,m,c;l=new Qt({props:{src:Ze(t[69].profile_image_url,500),width:"2rem",strokeColor:"white",strokeWidth:"13"}});function b(){return t[21](t[69])}return{c(){e=C("div"),n=C("div"),ie(l.$$.fragment),i=B(),r=C("div"),f=Ne(s),this.h()},l(h){e=x(h,"DIV",{class:!0});var w=T(e);n=x(w,"DIV",{class:!0});var v=T(n);re(l.$$.fragment,v),i=Y(v),r=x(v,"DIV",{});var y=T(r);f=Be(y,s),y.forEach(_),v.forEach(_),w.forEach(_),this.h()},h(){a(n,"class","text-shadow text-center flex gap-2 justify-center items-center svelte-1xgvwrg"),a(e,"class","flex gap-2 justify-center items-center")},m(h,w){G(h,e,w),g(e,n),oe(l,n,null),g(n,i),g(n,r),g(r,f),d=!0,m||(c=W(n,"click",b),m=!0)},p(h,w){t=h;const v={};w[0]&1&&(v.src=Ze(t[69].profile_image_url,500)),l.$set(v),(!d||w[0]&1)&&s!==(s=t[69].unique_name+"")&&Ye(f,s)},i(h){d||(N(l.$$.fragment,h),d=!0)},o(h){X(l.$$.fragment,h),d=!1},d(h){h&&_(e),ae(l),m=!1,c()}}}function mt(t){let e,n,l,i,r;function s(){t[22].call(e,t[70],t[71])}function f(...d){return t[24](t[69],t[70],t[71],...d)}return{c(){e=C("textarea"),this.h()},l(d){e=x(d,"TEXTAREA",{rows:!0,class:!0,placeholder:!0}),T(e).forEach(_),this.h()},h(){a(e,"rows",n=t[69].expandText||t[10]==="post"||t[10]==="patch"?void 0:1),a(e,"class",l=Ce(`
                    w-full p-0 resize-none
                    outline-0 focus:outline-none focus:ring-0 border-none
                    bg-transparent
                    text-sm text-shadow
                    placeholder:text-white/75
                    placeholder:text-base
                    box-content
                    read-only:cursor-pointer
                    ${t[69].expandText||t[10]==="post"||t[10]==="patch"?void 0:"line-clamp-1"}
                  `)+" svelte-1xgvwrg"),e.readOnly=t[10]!=="post"&&t[10]!=="patch",a(e,"placeholder",t[10]==="post"||t[10]==="patch"?"✎ 텍스트 입력하기":"")},m(d,m){G(d,e,m),$e(e,t[69].text),i||(r=[W(e,"input",s),wt(cn.call(null,e)),W(e,"input",t[23]),W(e,"click",f)],i=!0)},p(d,m){t=d,m[0]&1&&n!==(n=t[69].expandText||t[10]==="post"||t[10]==="patch"?void 0:1)&&a(e,"rows",n),m[0]&1&&l!==(l=Ce(`
                    w-full p-0 resize-none
                    outline-0 focus:outline-none focus:ring-0 border-none
                    bg-transparent
                    text-sm text-shadow
                    placeholder:text-white/75
                    placeholder:text-base
                    box-content
                    read-only:cursor-pointer
                    ${t[69].expandText||t[10]==="post"||t[10]==="patch"?void 0:"line-clamp-1"}
                  `)+" svelte-1xgvwrg")&&a(e,"class",l),m[0]&1&&$e(e,t[69].text)},d(d){d&&_(e),i=!1,Ve(r)}}}function gt(t){var ee;let e,n,l,i,r,s,f,d,m=((ee=t[69].reactions)!=null&&ee.length?t[69].reactions.reduce(t[31],0):"")+"",c,b,h,w,v,y,E,L,u,I,H,J,q,k=t[69].onReactionShowcase&&_t(t);const z=[yn,Tn],K=[];function $(M,V){return M[69].myReaction?0:1}r=$(t),s=K[r]=z[r](t);function ke(){return t[32](t[69])}function fe(){return t[33](t[69],t[70],t[71])}return w=new gn({props:{fill:"white"}}),E=new hn({props:{fill:"white"}}),I=new tn({props:{fill:"white"}}),{c(){e=C("div"),n=C("div"),k&&k.c(),l=B(),i=C("button"),s.c(),f=B(),d=C("span"),c=Ne(m),b=B(),h=C("button"),ie(w.$$.fragment),v=B(),y=C("button"),ie(E.$$.fragment),L=B(),u=C("button"),ie(I.$$.fragment),this.h()},l(M){e=x(M,"DIV",{class:!0});var V=T(e);n=x(V,"DIV",{class:!0});var A=T(n);k&&k.l(A),l=Y(A),i=x(A,"BUTTON",{class:!0});var S=T(i);s.l(S),f=Y(S),d=x(S,"SPAN",{class:!0});var U=T(d);c=Be(U,m),U.forEach(_),S.forEach(_),A.forEach(_),b=Y(V),h=x(V,"BUTTON",{class:!0});var me=T(h);re(w.$$.fragment,me),me.forEach(_),v=Y(V),y=x(V,"BUTTON",{class:!0});var P=T(y);re(E.$$.fragment,P),P.forEach(_),L=Y(V),u=x(V,"BUTTON",{class:!0});var te=T(u);re(I.$$.fragment,te),te.forEach(_),V.forEach(_),this.h()},h(){a(d,"class","text-sm text-white absolute -bottom-2"),a(i,"class","relative bg-transparent p-2 flex flex-col items-center justify-center"),a(n,"class","flex gap-4 relative"),a(h,"class","p-2"),a(y,"class","p-2"),a(u,"class","p-2"),a(e,"class","flex flex-col gap-4")},m(M,V){G(M,e,V),g(e,n),k&&k.m(n,null),g(n,l),g(n,i),K[r].m(i,null),g(i,f),g(i,d),g(d,c),g(e,b),g(e,h),oe(w,h,null),g(e,v),g(e,y),oe(E,y,null),g(e,L),g(e,u),oe(I,u,null),H=!0,J||(q=[W(i,"click",ke),wt(rn.call(null,i,500)),W(i,"longpress",fe),W(u,"click",t[34])],J=!0)},p(M,V){var S;t=M,t[69].onReactionShowcase?k?(k.p(t,V),V[0]&1&&N(k,1)):(k=_t(t),k.c(),N(k,1),k.m(n,l)):k&&(xe(),X(k,1,1,()=>{k=null}),Te());let A=r;r=$(t),r!==A&&(xe(),X(K[A],1,1,()=>{K[A]=null}),Te(),s=K[r],s||(s=K[r]=z[r](t),s.c()),N(s,1),s.m(i,f)),(!H||V[0]&1)&&m!==(m=((S=t[69].reactions)!=null&&S.length?t[69].reactions.reduce(t[31],0):"")+"")&&Ye(c,m)},i(M){H||(N(k),N(s),N(w.$$.fragment,M),N(E.$$.fragment,M),N(I.$$.fragment,M),H=!0)},o(M){X(k),X(s),X(w.$$.fragment,M),X(E.$$.fragment,M),X(I.$$.fragment,M),H=!1},d(M){M&&_(e),k&&k.d(),K[r].d(),ae(w),ae(E),ae(I),J=!1,Ve(q)}}}function _t(t){let e,n,l="❤️",i,r,s="😊️️",f,d,m="😍",c,b,h="🥺️️",w,v,y,E,L,u;function I(){return t[26](t[69])}function H(){return t[27](t[69])}function J(){return t[28](t[69])}function q(){return t[29](t[69])}return y=new nn({props:{width:18,height:18}}),{c(){e=C("div"),n=C("button"),n.textContent=l,i=B(),r=C("button"),r.textContent=s,f=B(),d=C("button"),d.textContent=m,c=B(),b=C("button"),b.textContent=h,w=B(),v=C("button"),ie(y.$$.fragment),this.h()},l(k){e=x(k,"DIV",{class:!0});var z=T(e);n=x(z,"BUTTON",{class:!0,"data-svelte-h":!0}),de(n)!=="svelte-kv6r7j"&&(n.textContent=l),i=Y(z),r=x(z,"BUTTON",{class:!0,"data-svelte-h":!0}),de(r)!=="svelte-vakclv"&&(r.textContent=s),f=Y(z),d=x(z,"BUTTON",{class:!0,"data-svelte-h":!0}),de(d)!=="svelte-ez3y8b"&&(d.textContent=m),c=Y(z),b=x(z,"BUTTON",{class:!0,"data-svelte-h":!0}),de(b)!=="svelte-1ifcqqr"&&(b.textContent=h),w=Y(z),v=x(z,"BUTTON",{});var K=T(v);re(y.$$.fragment,K),K.forEach(_),z.forEach(_),this.h()},h(){a(n,"class","text-2xl/[26px]"),a(r,"class","text-2xl/[26px]"),a(d,"class","text-2xl/[26px]"),a(b,"class","text-2xl/[26px]"),a(e,"class","absolute right-12 bg-black/50 text-white px-2.5 py-2 rounded-[60px] flex gap-4 items-center justify-center backdrop-blur-[2px]")},m(k,z){G(k,e,z),g(e,n),g(e,i),g(e,r),g(e,f),g(e,d),g(e,c),g(e,b),g(e,w),g(e,v),oe(y,v,null),E=!0,L||(u=[W(n,"click",I),W(r,"click",H),W(d,"click",J),W(b,"click",q),W(v,"click",t[30])],L=!0)},p(k,z){t=k},i(k){E||(N(y.$$.fragment,k),E=!0)},o(k){X(y.$$.fragment,k),E=!1},d(k){k&&_(e),ae(y),L=!1,Ve(u)}}}function Tn(t){let e,n;return e=new ln({props:{fill:"white"}}),{c(){ie(e.$$.fragment)},l(l){re(e.$$.fragment,l)},m(l,i){oe(e,l,i),n=!0},i(l){n||(N(e.$$.fragment,l),n=!0)},o(l){X(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function yn(t){let e,n;return e=new sn({props:{fill:"#EA3323"}}),{c(){ie(e.$$.fragment)},l(l){re(e.$$.fragment,l)},m(l,i){oe(e,l,i),n=!0},i(l){n||(N(e.$$.fragment,l),n=!0)},o(l){X(e.$$.fragment,l),n=!1},d(l){ae(e,l)}}}function pt(t){let e=Math.abs(t[1]-t[71])<=1,n,l,i=e&&ot(t);return{c(){i&&i.c(),n=Je()},l(r){i&&i.l(r),n=Je()},m(r,s){i&&i.m(r,s),G(r,n,s),l=!0},p(r,s){s[0]&2&&(e=Math.abs(r[1]-r[71])<=1),e?i?(i.p(r,s),s[0]&2&&N(i,1)):(i=ot(r),i.c(),N(i,1),i.m(n.parentNode,n)):i&&(xe(),X(i,1,1,()=>{i=null}),Te())},i(r){l||(N(i),l=!0)},o(r){X(i),l=!1},d(r){r&&_(n),i&&i.d(r)}}}function Mn(t){let e,n,l,i,r,s="수정",f,d,m,c,b,h="삭제",w,v,y;return l=new vn({props:{fill:"white",length:1.4}}),m=new kn({props:{fill:"red",length:1.4}}),{c(){e=C("div"),n=C("button"),ie(l.$$.fragment),i=B(),r=C("span"),r.textContent=s,f=B(),d=C("button"),ie(m.$$.fragment),c=B(),b=C("span"),b.textContent=h,this.h()},l(E){e=x(E,"DIV",{class:!0});var L=T(e);n=x(L,"BUTTON",{class:!0});var u=T(n);re(l.$$.fragment,u),i=Y(u),r=x(u,"SPAN",{"data-svelte-h":!0}),de(r)!=="svelte-17aljrl"&&(r.textContent=s),u.forEach(_),f=Y(L),d=x(L,"BUTTON",{class:!0});var I=T(d);re(m.$$.fragment,I),c=Y(I),b=x(I,"SPAN",{"data-svelte-h":!0}),de(b)!=="svelte-1k1dgz"&&(b.textContent=h),I.forEach(_),L.forEach(_),this.h()},h(){a(n,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-white rounded-t-xl bg-[#3335] border-b border-[#333] border-collapse"),a(d,"class","w-full py-3 flex items-center gap-2 justify-center text-base font-medium tracking-wider text-[red] rounded-b-xl bg-[#3336] border-t border-[#333] border-collapse"),a(e,"class","flex flex-col items-center px-6 py-4")},m(E,L){G(E,e,L),g(e,n),oe(l,n,null),g(n,i),g(n,r),g(e,f),g(e,d),oe(m,d,null),g(d,c),g(d,b),w=!0,v||(y=[W(n,"click",t[35]),W(d,"click",t[36])],v=!0)},p:ue,i(E){w||(N(l.$$.fragment,E),N(m.$$.fragment,E),w=!0)},o(E){X(l.$$.fragment,E),X(m.$$.fragment,E),w=!1},d(E){E&&_(e),ae(l),ae(m),v=!1,Ve(y)}}}function Vn(t){let e,n,l="정말로 삭제하시겠습니까?",i,r,s="이 작업은 취소할 수 없습니다. 계속 진행하시겠습니까?",f,d,m,c="삭제",b,h,w="취소",v,y;return{c(){e=C("div"),n=C("h2"),n.textContent=l,i=B(),r=C("p"),r.textContent=s,f=B(),d=C("div"),m=C("button"),m.textContent=c,b=B(),h=C("button"),h.textContent=w,this.h()},l(E){e=x(E,"DIV",{class:!0});var L=T(e);n=x(L,"H2",{class:!0,"data-svelte-h":!0}),de(n)!=="svelte-1yzhdkj"&&(n.textContent=l),i=Y(L),r=x(L,"P",{class:!0,"data-svelte-h":!0}),de(r)!=="svelte-26p028"&&(r.textContent=s),f=Y(L),d=x(L,"DIV",{class:!0});var u=T(d);m=x(u,"BUTTON",{class:!0,"data-svelte-h":!0}),de(m)!=="svelte-1q4epan"&&(m.textContent=c),b=Y(u),h=x(u,"BUTTON",{class:!0,"data-svelte-h":!0}),de(h)!=="svelte-1rzg9yy"&&(h.textContent=w),u.forEach(_),L.forEach(_),this.h()},h(){a(n,"class","text-lg font-semibold mb-2"),a(r,"class","text-gray-600 mb-4"),a(m,"class","bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 transition"),a(h,"class","bg-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-400 transition"),a(d,"class","flex justify-center space-x-4"),a(e,"class","text-center")},m(E,L){G(E,e,L),g(e,n),g(e,i),g(e,r),g(e,f),g(e,d),g(d,m),g(d,b),g(d,h),v||(y=[W(m,"click",t[38]),W(h,"click",t[39])],v=!0)},p:ue,d(E){E&&_(e),v=!1,Ve(y)}}}function Ln(t){let e,n,l,i,r,s,f,d,m,c,b=we(t[0]),h=[];for(let u=0;u<b.length;u+=1)h[u]=pt(lt(t,b,u));const w=u=>X(h[u],1,1,()=>{h[u]=null});function v(u){t[37](u)}let y={defaultHeight:16*16,maxHeight:16*16,$$slots:{default:[Mn]},$$scope:{ctx:t}};t[8]!==void 0&&(y.isOpen=t[8]),l=new on({props:y}),Ge.push(()=>et(l,"isOpen",v));function E(u){t[40](u)}let L={$$slots:{default:[Vn]},$$scope:{ctx:t}};return t[9]!==void 0&&(L.modalVisible=t[9]),s=new an({props:L}),Ge.push(()=>et(s,"modalVisible",E)),{c(){e=C("div");for(let u=0;u<h.length;u+=1)h[u].c();n=B(),ie(l.$$.fragment),r=B(),ie(s.$$.fragment),this.h()},l(u){e=x(u,"DIV",{class:!0});var I=T(e);for(let H=0;H<h.length;H+=1)h[H].l(I);I.forEach(_),n=Y(u),re(l.$$.fragment,u),r=Y(u),re(s.$$.fragment,u),this.h()},h(){a(e,"class","bg-black w-screen h-screen")},m(u,I){G(u,e,I);for(let H=0;H<h.length;H+=1)h[H]&&h[H].m(e,null);G(u,n,I),oe(l,u,I),G(u,r,I),oe(s,u,I),d=!0,m||(c=W(e,"contextmenu",Ot(t[19])),m=!0)},p(u,I){if(I[0]&11775){b=we(u[0]);let q;for(q=0;q<b.length;q+=1){const k=lt(u,b,q);h[q]?(h[q].p(k,I),N(h[q],1)):(h[q]=pt(k),h[q].c(),N(h[q],1),h[q].m(e,null))}for(xe(),q=b.length;q<h.length;q+=1)w(q);Te()}const H={};I[0]&768|I[2]&524288&&(H.$$scope={dirty:I,ctx:u}),!i&&I[0]&256&&(i=!0,H.isOpen=u[8],Fe(()=>i=!1)),l.$set(H);const J={};I[0]&512|I[2]&524288&&(J.$$scope={dirty:I,ctx:u}),!f&&I[0]&512&&(f=!0,J.modalVisible=u[9],Fe(()=>f=!1)),s.$set(J)},i(u){if(!d){for(let I=0;I<b.length;I+=1)N(h[I]);N(l.$$.fragment,u),N(s.$$.fragment,u),d=!0}},o(u){h=h.filter(Boolean);for(let I=0;I<h.length;I+=1)X(h[I]);X(l.$$.fragment,u),X(s.$$.fragment,u),d=!1},d(u){u&&(_(e),_(n),_(r)),Xe(h,u),ae(l,u),ae(s,u),m=!1,c()}}}const Dn=30,Rn=10,vt=10,bt=300;function Ae(t){return"touches"in t||"changedTouches"in t}function je(t,e=!0){const n=t.target;if(!e)return n.style.height="";n.style.height="16px";let l=n.scrollHeight;l>window.innerHeight/3&&(l=window.innerHeight/3),n.style.height=`${l}px`}function Sn(t,e,n){let l,i;jt(t,$t,o=>n(18,i=o));let r=i.url.searchParams.get("type"),{posts:s=[]}=e,{dontMoveVertically:f=!1}=e,{keyboardY:d=0}=e,{selectedReaction:m}=e,{index:c=0}=e,b=!0,h=!1,w=!1,v=0,y=0,E={width:0,height:0},L=!1,u=!1;function I(o){if(!o)return!1;const p=tt();return p!==null&&String(p)===o}let H=!1,J=!1;async function q(){n(15,H=!0);const o=i.url.searchParams.get("userIdx"),p=i.url.searchParams.get("placeIdx"),D=s.length,R=Dn,O=o?`&userIdx=${o}`:"",le=p?`&placeIdx=${p}`:"",ve=`&offset=${D}`,he=`&limit=${R}`,be=(await fetch(`${Ue}/posts?${O}${le}${ve}${he}`).then(se=>se.json()).then(se=>{var Ee;return((Ee=se.data)==null?void 0:Ee.posts)??[]})).map(se=>({...se,mediaIdx:0}));be.length===0&&n(16,J=!0),n(0,s=[...s,...be]),n(15,H=!1)}async function k(){Jt({mediaIdx:`${s[c].mediaIdx}`,postIdx:`${s[c].idx}`},{replace:!0})}function z(o){const p=E.height;if(c===0&&o>0){n(5,v=o*.3);return}if(c===s.length-1&&o<0){n(5,v=o*.3);return}n(5,v=Math.max(Math.min(o,p),-p))}function K(o){(r==="post"||r==="patch")&&document.querySelectorAll("textarea").forEach(R=>{je({target:R})}),n(4,b=!1),E.height;let p=0;Ae(o)?p=o.changedTouches[0].clientY-M:p=o.clientY-M;const D=ye(2);p>D&&c>0?(n(1,c-=1),h=!0,k()):-p>D&&c<s.length-1&&(n(1,c+=1),h=!0,k()),n(5,v=0)}function $(o){const p=E.width;if(o=Math.max(Math.min(o,p),-p),s[c].mediaIdx===0&&o>0||s[c].mediaIdx===s[c].media.length-1&&o<0){n(6,y=o*.3);return}n(6,y=o)}function ke(o){E.width,n(4,b=!1);let p=0;Ae(o)?p=o.changedTouches[0].clientX-ee:p=o.clientX-ee;const D=ye(2);if(p>D&&s[c].mediaIdx>0){const R=s[c].mediaIdx-1;n(0,s[c]={...s[c],mediaIdx:R},s),n(0,s=[...s]),w=!0,k()}else if(-p>D&&s[c].mediaIdx<s[c].media.length-1){const R=s[c].mediaIdx+1;n(0,s[c]={...s[c],mediaIdx:R},s),n(0,s=[...s]),w=!0,k()}n(6,y=0)}let fe=!1,ee=-1,M=-1,V,A=!1;qe.on("blockSwipeInViewer",o=>fe=o);function S(o){fe||h||w||(A=!0,V=void 0,ze.set(!0),Ae(o)?(ee=o.touches[0].clientX,M=o.touches[0].clientY):(ee=o.clientX,M=o.clientY,window.addEventListener("mousemove",U,{passive:!1}),window.addEventListener("mouseup",me)))}function U(o){if(fe||!A||h||w)return;let p=0,D=0;Ae(o)?(p=o.touches[0].clientX,D=o.touches[0].clientY):(p=o.clientX,D=o.clientY);let R=p-ee,O=D-M;V===void 0&&(V=Math.abs(O)>=Math.abs(R)?"post":"media"),!f&&V==="post"?z(O):V==="media"&&$(R)}function me(o){fe||!A||h||w||(A=!1,V==="post"?K(o):V==="media"?ke(o):ze.set(!1),Ae(o)||(window.removeEventListener("mousemove",U),window.removeEventListener("mouseup",me)))}let P=[],te=[];function Re(o){if(fe||h||w)return;o.preventDefault();const p=Date.now(),D=Math.abs(o.deltaX),R=Math.abs(o.deltaY);if(D>R){if(te.push({deltaX:o.deltaX,timestamp:p}),te=te.filter(O=>p-O.timestamp<=bt),te.length>=2){const O=te[0],le=te[te.length-1],ve=Math.abs(O.deltaX),he=Math.abs(le.deltaX),be=he-ve;if(be<0)return;if(be>=0&&he>=vt){let se=!1;if(le.deltaX>0&&s[c].mediaIdx<s[c].media.length-1){const Ee=s[c].mediaIdx+1;n(0,s[c]={...s[c],mediaIdx:Ee},s),n(0,s=[...s]),n(4,b=!1),k(),se=!0}else if(le.deltaX<0&&s[c].mediaIdx>0){const Ee=s[c].mediaIdx-1;n(0,s[c]={...s[c],mediaIdx:Ee},s),n(0,s=[...s]),n(4,b=!1),k(),se=!0}te=[],se&&(w=!0)}}}else if(P.push({deltaY:o.deltaY,timestamp:p}),P=P.filter(O=>p-O.timestamp<=bt),P.length>=2){const O=P[0],le=P[P.length-1],ve=Math.abs(O.deltaY),he=Math.abs(le.deltaY),be=he-ve;if(be<0)return;if(be>=0&&he>=vt){let se=!1;le.deltaY>0&&c<s.length-1?(n(4,b=!1),n(1,c+=1),k(),se=!0):le.deltaY<0&&c>0&&(n(4,b=!1),n(1,c-=1),k(),se=!0),P=[],se&&(h=!0)}}}function Se(o){if(!(fe||h||w))switch(o.key){case"ArrowUp":c>0&&(n(4,b=!1),n(1,c-=1),h=!0,k());break;case"ArrowDown":c<s.length-1&&(n(4,b=!1),n(1,c+=1),h=!0,k());break;case"ArrowLeft":if(s[c].mediaIdx>0){const p=s[c].mediaIdx-1;n(0,s[c]={...s[c],mediaIdx:p},s),n(0,s=[...s]),n(4,b=!1),w=!0,k()}break;case"ArrowRight":if(s[c].mediaIdx<s[c].media.length-1){const p=s[c].mediaIdx+1;n(0,s[c]={...s[c],mediaIdx:p},s),n(0,s=[...s]),n(4,b=!1),w=!0,k()}break}}function j(){n(7,E={width:document.body.clientWidth,height:document.body.clientHeight})}function Z(){const o=Number(i.url.searchParams.get("mediaIdx")||0);o&&s[c].media[o]?(n(0,s[c]={...s[c],mediaIdx:o},s),n(0,s=[...s])):(n(0,s[c]={...s[c],mediaIdx:0},s),n(0,s=[...s])),k()}Zt(async()=>{j(),window.addEventListener("resize",j),ce(),Z(),!(r!=="post"&&r!=="patch")&&(await Xt(),document.querySelectorAll("textarea").forEach(o=>{je({target:o})}))}),Ut(()=>{window.removeEventListener("resize",j),Ie()});function ce(){document.addEventListener("touchstart",S,{passive:!1}),document.addEventListener("touchmove",U,{passive:!1}),document.addEventListener("touchend",me),document.addEventListener("mousedown",S,{passive:!1}),document.addEventListener("wheel",Re,{passive:!1}),document.addEventListener("keydown",Se)}function Ie(){document.removeEventListener("touchstart",S),document.removeEventListener("touchmove",U),document.removeEventListener("touchend",me),document.removeEventListener("mousedown",S),document.removeEventListener("wheel",Re),document.removeEventListener("keydown",Se)}function ge(){n(4,b=!0),h=!1,w=!1,ze.set(!1)}function F(){var R;const o=sessionStorage.getItem("jwt"),p=tt(),D=(R=s[c])==null?void 0:R.idx;!o||!p||!D||fetch(`${Ue}/posts/${D}`,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o}`}}).then(O=>O.json()).then(()=>We(`/users/${p}`,{replaceState:!0,invalidateAll:!0}))}async function Q(o){var O,le,ve;const p=(O=s[o])==null?void 0:O.idx;if(p===void 0||f||((le=s[o])==null?void 0:le.needReactionReload)!==!0&&((ve=s[o])!=null&&ve.reactions))return;const D=Wt(),R=await fetch(`${Ue}/vote/reactions?targetTable=posts&targetId=${p}&byType=true`,{method:"GET",headers:{Authorization:"Bearer "+D}});if(R.ok){const he=await R.json();n(0,s[o].reactions=he.data.reactions,s),n(0,s[o].myReaction=he.data.myReaction,s)}}function ne(o,p){const D=c,R=s[D];if((R==null?void 0:R.idx)===o){if(!nt())return R.needReactionReload=!0,qe.emit("showSignInModal",{removable:!0,callback:Gt.isNativePlatform()?()=>{Q(D)}:void 0});R.myReaction===p?qe.emit("setReaction",{target:"posts",targetId:o,reaction:null,callback:()=>{n(0,s[D].myReaction=null,s),Pe(D,p)}}):(R.myReaction&&Pe(D,R.myReaction),qe.emit("setReaction",{target:"posts",targetId:o,reaction:p,callback:()=>{n(0,s[D].myReaction=p,s),s[D].reactions.some(O=>O.type===p)?n(0,s[D].reactions=s[D].reactions.map(O=>O.type===p?{...O,count:Number(O.count)+1}:O),s):n(0,s[D].reactions=[...s[D].reactions,{type:p,count:1}],s)}}))}}function Pe(o,p){let D=[];for(const R of s[o].reactions)if(R.type===p){const O=Number(R.count);O>1&&D.push({...R,count:O-1})}else D.push(R);n(0,s[o].reactions=D,s)}function Oe(o){zt.call(this,t,o)}const He=(o,p)=>{ne(o.idx,p.type)},kt=o=>{o.user_idx&&Kt(`/users/${o.user_idx}`)};function It(o,p){o[p].text=this.value,n(0,s)}const Et=o=>je(o),Ct=(o,p,D,R)=>{r==="post"||r==="patch"||(n(0,p[D].expandText=o.expandText===void 0?!0:!o.expandText,s),je(R,o.expandText))},xt=o=>{o.place_idx&&We(`/places/${o.place_idx}`)},Tt=o=>{ne(o.idx,"❤️")},yt=o=>{ne(o.idx,"😊️️")},Mt=o=>{ne(o.idx,"😍")},Vt=o=>{ne(o.idx,"🥺️️")},Lt=()=>{if(!nt())return qe.emit("showSignInModal",{removable:!0});Ft.set(!0)},Dt=(o,p)=>o+Number(p.count),Rt=o=>{ne(o.idx,o.myReaction||"❤️")},St=(o,p,D)=>{n(0,p[D].onReactionShowcase=!0,s);const R=()=>{n(0,p[D].onReactionShowcase=!1,s),window.removeEventListener("click",R)};window.addEventListener("click",R)},Pt=()=>{n(8,L=!0)},Ht=()=>{var o;n(8,L=!1),We(`/viewer/edit?type=patch&postIdx=${(o=window.location.search.split("postIdx=")[1])==null?void 0:o.split("&")[0]}`,{replaceState:!1,invalidateAll:!1})},qt=()=>{n(8,L=!1),n(9,u=!0)};function At(o){L=o,n(8,L)}const Nt=()=>{F(),n(9,u=!1)},Bt=()=>{n(9,u=!1)};function Yt(o){u=o,n(9,u)}return t.$$set=o=>{"posts"in o&&n(0,s=o.posts),"dontMoveVertically"in o&&n(2,f=o.dontMoveVertically),"keyboardY"in o&&n(3,d=o.keyboardY),"selectedReaction"in o&&n(14,m=o.selectedReaction),"index"in o&&n(1,c=o.index)},t.$$.update=()=>{var o;t.$$.dirty[0]&262144&&i&&k(),t.$$.dirty[0]&16384&&m&&ne(m.postIdx,m.reaction),t.$$.dirty[0]&2&&Q(c),t.$$.dirty[0]&3&&n(17,l=(o=s[c])==null?void 0:o.user_idx),t.$$.dirty[0]&131072&&I(l),t.$$.dirty[0]&98311&&!f&&c>=s.length-Rn&&!H&&!J&&q()},[s,c,f,d,b,v,y,E,L,u,r,ge,F,ne,m,H,J,l,i,Oe,He,kt,It,Et,Ct,xt,Tt,yt,Mt,Vt,Lt,Dt,Rt,St,Pt,Ht,qt,At,Nt,Bt,Yt]}class Kn extends Le{constructor(e){super(),De(this,e,Sn,Ln,Me,{posts:0,dontMoveVertically:2,keyboardY:3,selectedReaction:14,index:1},null,[-1,-1,-1])}}export{Kn as V};
